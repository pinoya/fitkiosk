function EPe(){import.meta.url,import("_").catch(()=>1);async function*e(){}}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();function Ip(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Gj(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function r(){if(this instanceof r){var a=[null];a.push.apply(a,arguments);var i=Function.bind.apply(t,a);return new i}return t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var a=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,a.get?a:{enumerable:!0,get:function(){return e[r]}})}),n}var BD={exports:{}},Jv={},WD={exports:{}},rt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vm=Symbol.for("react.element"),qj=Symbol.for("react.portal"),Kj=Symbol.for("react.fragment"),Xj=Symbol.for("react.strict_mode"),Yj=Symbol.for("react.profiler"),Zj=Symbol.for("react.provider"),Qj=Symbol.for("react.context"),Jj=Symbol.for("react.forward_ref"),e6=Symbol.for("react.suspense"),t6=Symbol.for("react.memo"),n6=Symbol.for("react.lazy"),gN=Symbol.iterator;function r6(e){return e===null||typeof e!="object"?null:(e=gN&&e[gN]||e["@@iterator"],typeof e=="function"?e:null)}var UD={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},VD=Object.assign,HD={};function $p(e,t,n){this.props=e,this.context=t,this.refs=HD,this.updater=n||UD}$p.prototype.isReactComponent={};$p.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};$p.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function jD(){}jD.prototype=$p.prototype;function eI(e,t,n){this.props=e,this.context=t,this.refs=HD,this.updater=n||UD}var tI=eI.prototype=new jD;tI.constructor=eI;VD(tI,$p.prototype);tI.isPureReactComponent=!0;var yN=Array.isArray,GD=Object.prototype.hasOwnProperty,nI={current:null},qD={key:!0,ref:!0,__self:!0,__source:!0};function KD(e,t,n){var r,a={},i=null,s=null;if(t!=null)for(r in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(i=""+t.key),t)GD.call(t,r)&&!qD.hasOwnProperty(r)&&(a[r]=t[r]);var o=arguments.length-2;if(o===1)a.children=n;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];a.children=l}if(e&&e.defaultProps)for(r in o=e.defaultProps,o)a[r]===void 0&&(a[r]=o[r]);return{$$typeof:Vm,type:e,key:i,ref:s,props:a,_owner:nI.current}}function a6(e,t){return{$$typeof:Vm,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function rI(e){return typeof e=="object"&&e!==null&&e.$$typeof===Vm}function i6(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var bN=/\/+/g;function Ew(e,t){return typeof e=="object"&&e!==null&&e.key!=null?i6(""+e.key):t.toString(36)}function sb(e,t,n,r,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(i){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case Vm:case qj:s=!0}}if(s)return s=e,a=a(s),e=r===""?"."+Ew(s,0):r,yN(a)?(n="",e!=null&&(n=e.replace(bN,"$&/")+"/"),sb(a,t,n,"",function(c){return c})):a!=null&&(rI(a)&&(a=a6(a,n+(!a.key||s&&s.key===a.key?"":(""+a.key).replace(bN,"$&/")+"/")+e)),t.push(a)),1;if(s=0,r=r===""?".":r+":",yN(e))for(var o=0;o<e.length;o++){i=e[o];var l=r+Ew(i,o);s+=sb(i,t,n,l,a)}else if(l=r6(e),typeof l=="function")for(e=l.call(e),o=0;!(i=e.next()).done;)i=i.value,l=r+Ew(i,o++),s+=sb(i,t,n,l,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function by(e,t,n){if(e==null)return e;var r=[],a=0;return sb(e,r,"","",function(i){return t.call(n,i,a++)}),r}function s6(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var qr={current:null},ob={transition:null},o6={ReactCurrentDispatcher:qr,ReactCurrentBatchConfig:ob,ReactCurrentOwner:nI};rt.Children={map:by,forEach:function(e,t,n){by(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return by(e,function(){t++}),t},toArray:function(e){return by(e,function(t){return t})||[]},only:function(e){if(!rI(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};rt.Component=$p;rt.Fragment=Kj;rt.Profiler=Yj;rt.PureComponent=eI;rt.StrictMode=Xj;rt.Suspense=e6;rt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=o6;rt.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=VD({},e.props),a=e.key,i=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,s=nI.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)GD.call(t,l)&&!qD.hasOwnProperty(l)&&(r[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];r.children=o}return{$$typeof:Vm,type:e.type,key:a,ref:i,props:r,_owner:s}};rt.createContext=function(e){return e={$$typeof:Qj,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Zj,_context:e},e.Consumer=e};rt.createElement=KD;rt.createFactory=function(e){var t=KD.bind(null,e);return t.type=e,t};rt.createRef=function(){return{current:null}};rt.forwardRef=function(e){return{$$typeof:Jj,render:e}};rt.isValidElement=rI;rt.lazy=function(e){return{$$typeof:n6,_payload:{_status:-1,_result:e},_init:s6}};rt.memo=function(e,t){return{$$typeof:t6,type:e,compare:t===void 0?null:t}};rt.startTransition=function(e){var t=ob.transition;ob.transition={};try{e()}finally{ob.transition=t}};rt.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};rt.useCallback=function(e,t){return qr.current.useCallback(e,t)};rt.useContext=function(e){return qr.current.useContext(e)};rt.useDebugValue=function(){};rt.useDeferredValue=function(e){return qr.current.useDeferredValue(e)};rt.useEffect=function(e,t){return qr.current.useEffect(e,t)};rt.useId=function(){return qr.current.useId()};rt.useImperativeHandle=function(e,t,n){return qr.current.useImperativeHandle(e,t,n)};rt.useInsertionEffect=function(e,t){return qr.current.useInsertionEffect(e,t)};rt.useLayoutEffect=function(e,t){return qr.current.useLayoutEffect(e,t)};rt.useMemo=function(e,t){return qr.current.useMemo(e,t)};rt.useReducer=function(e,t,n){return qr.current.useReducer(e,t,n)};rt.useRef=function(e){return qr.current.useRef(e)};rt.useState=function(e){return qr.current.useState(e)};rt.useSyncExternalStore=function(e,t,n){return qr.current.useSyncExternalStore(e,t,n)};rt.useTransition=function(){return qr.current.useTransition()};rt.version="18.2.0";WD.exports=rt;var _e=WD.exports;const oe=Ip(_e);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l6=_e,u6=Symbol.for("react.element"),c6=Symbol.for("react.fragment"),d6=Object.prototype.hasOwnProperty,p6=l6.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,h6={key:!0,ref:!0,__self:!0,__source:!0};function XD(e,t,n){var r,a={},i=null,s=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(s=t.ref);for(r in t)d6.call(t,r)&&!h6.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)a[r]===void 0&&(a[r]=t[r]);return{$$typeof:u6,type:e,key:i,ref:s,props:a,_owner:p6.current}}Jv.Fragment=c6;Jv.jsx=XD;Jv.jsxs=XD;BD.exports=Jv;var ee=BD.exports,YD={exports:{}},Ma={},ZD={exports:{}},QD={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(F,z){var B=F.length;F.push(z);e:for(;0<B;){var j=B-1>>>1,Y=F[j];if(0<a(Y,z))F[j]=z,F[B]=Y,B=j;else break e}}function n(F){return F.length===0?null:F[0]}function r(F){if(F.length===0)return null;var z=F[0],B=F.pop();if(B!==z){F[0]=B;e:for(var j=0,Y=F.length,Q=Y>>>1;j<Q;){var ae=2*(j+1)-1,se=F[ae],fe=ae+1,me=F[fe];if(0>a(se,B))fe<Y&&0>a(me,se)?(F[j]=me,F[fe]=B,j=fe):(F[j]=se,F[ae]=B,j=ae);else if(fe<Y&&0>a(me,B))F[j]=me,F[fe]=B,j=fe;else break e}}return z}function a(F,z){var B=F.sortIndex-z.sortIndex;return B!==0?B:F.id-z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var s=Date,o=s.now();e.unstable_now=function(){return s.now()-o}}var l=[],c=[],u=1,d=null,p=3,h=!1,f=!1,m=!1,g=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(F){for(var z=n(c);z!==null;){if(z.callback===null)r(c);else if(z.startTime<=F)r(c),z.sortIndex=z.expirationTime,t(l,z);else break;z=n(c)}}function x(F){if(m=!1,v(F),!f)if(n(l)!==null)f=!0,U(w);else{var z=n(c);z!==null&&D(x,z.startTime-F)}}function w(F,z){f=!1,m&&(m=!1,y(E),E=-1),h=!0;var B=p;try{for(v(z),d=n(l);d!==null&&(!(d.expirationTime>z)||F&&!N());){var j=d.callback;if(typeof j=="function"){d.callback=null,p=d.priorityLevel;var Y=j(d.expirationTime<=z);z=e.unstable_now(),typeof Y=="function"?d.callback=Y:d===n(l)&&r(l),v(z)}else r(l);d=n(l)}if(d!==null)var Q=!0;else{var ae=n(c);ae!==null&&D(x,ae.startTime-z),Q=!1}return Q}finally{d=null,p=B,h=!1}}var $=!1,C=null,E=-1,_=5,R=-1;function N(){return!(e.unstable_now()-R<_)}function I(){if(C!==null){var F=e.unstable_now();R=F;var z=!0;try{z=C(!0,F)}finally{z?O():($=!1,C=null)}}else $=!1}var O;if(typeof b=="function")O=function(){b(I)};else if(typeof MessageChannel<"u"){var P=new MessageChannel,L=P.port2;P.port1.onmessage=I,O=function(){L.postMessage(null)}}else O=function(){g(I,0)};function U(F){C=F,$||($=!0,O())}function D(F,z){E=g(function(){F(e.unstable_now())},z)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(F){F.callback=null},e.unstable_continueExecution=function(){f||h||(f=!0,U(w))},e.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<F?Math.floor(1e3/F):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return n(l)},e.unstable_next=function(F){switch(p){case 1:case 2:case 3:var z=3;break;default:z=p}var B=p;p=z;try{return F()}finally{p=B}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(F,z){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var B=p;p=F;try{return z()}finally{p=B}},e.unstable_scheduleCallback=function(F,z,B){var j=e.unstable_now();switch(typeof B=="object"&&B!==null?(B=B.delay,B=typeof B=="number"&&0<B?j+B:j):B=j,F){case 1:var Y=-1;break;case 2:Y=250;break;case 5:Y=1073741823;break;case 4:Y=1e4;break;default:Y=5e3}return Y=B+Y,F={id:u++,callback:z,priorityLevel:F,startTime:B,expirationTime:Y,sortIndex:-1},B>j?(F.sortIndex=B,t(c,F),n(l)===null&&F===n(c)&&(m?(y(E),E=-1):m=!0,D(x,B-j))):(F.sortIndex=Y,t(l,F),f||h||(f=!0,U(w))),F},e.unstable_shouldYield=N,e.unstable_wrapCallback=function(F){var z=p;return function(){var B=p;p=z;try{return F.apply(this,arguments)}finally{p=B}}}})(QD);ZD.exports=QD;var f6=ZD.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var JD=_e,Aa=f6;function ce(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var eF=new Set,Jf={};function gu(e,t){Hd(e,t),Hd(e+"Capture",t)}function Hd(e,t){for(Jf[e]=t,e=0;e<t.length;e++)eF.add(t[e])}var _s=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),M1=Object.prototype.hasOwnProperty,m6=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,vN={},xN={};function g6(e){return M1.call(xN,e)?!0:M1.call(vN,e)?!1:m6.test(e)?xN[e]=!0:(vN[e]=!0,!1)}function y6(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function b6(e,t,n,r){if(t===null||typeof t>"u"||y6(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Kr(e,t,n,r,a,i,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=s}var sr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){sr[e]=new Kr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];sr[t]=new Kr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){sr[e]=new Kr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){sr[e]=new Kr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){sr[e]=new Kr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){sr[e]=new Kr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){sr[e]=new Kr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){sr[e]=new Kr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){sr[e]=new Kr(e,5,!1,e.toLowerCase(),null,!1,!1)});var aI=/[\-:]([a-z])/g;function iI(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(aI,iI);sr[t]=new Kr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(aI,iI);sr[t]=new Kr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(aI,iI);sr[t]=new Kr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){sr[e]=new Kr(e,1,!1,e.toLowerCase(),null,!1,!1)});sr.xlinkHref=new Kr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){sr[e]=new Kr(e,1,!1,e.toLowerCase(),null,!0,!0)});function sI(e,t,n,r){var a=sr.hasOwnProperty(t)?sr[t]:null;(a!==null?a.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(b6(t,n,a,r)&&(n=null),r||a===null?g6(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=n===null?a.type===3?!1:"":n:(t=a.attributeName,r=a.attributeNamespace,n===null?e.removeAttribute(t):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Ps=JD.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,vy=Symbol.for("react.element"),bd=Symbol.for("react.portal"),vd=Symbol.for("react.fragment"),oI=Symbol.for("react.strict_mode"),O1=Symbol.for("react.profiler"),tF=Symbol.for("react.provider"),nF=Symbol.for("react.context"),lI=Symbol.for("react.forward_ref"),L1=Symbol.for("react.suspense"),P1=Symbol.for("react.suspense_list"),uI=Symbol.for("react.memo"),Js=Symbol.for("react.lazy"),rF=Symbol.for("react.offscreen"),wN=Symbol.iterator;function af(e){return e===null||typeof e!="object"?null:(e=wN&&e[wN]||e["@@iterator"],typeof e=="function"?e:null)}var Jt=Object.assign,Tw;function vf(e){if(Tw===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Tw=t&&t[1]||""}return"\n"+Tw+e}var Nw=!1;function _w(e,t){if(!e||Nw)return"";Nw=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var a=c.stack.split("\n"),i=r.stack.split("\n"),s=a.length-1,o=i.length-1;1<=s&&0<=o&&a[s]!==i[o];)o--;for(;1<=s&&0<=o;s--,o--)if(a[s]!==i[o]){if(s!==1||o!==1)do if(s--,o--,0>o||a[s]!==i[o]){var l="\n"+a[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=s&&0<=o);break}}}finally{Nw=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?vf(e):""}function v6(e){switch(e.tag){case 5:return vf(e.type);case 16:return vf("Lazy");case 13:return vf("Suspense");case 19:return vf("SuspenseList");case 0:case 2:case 15:return e=_w(e.type,!1),e;case 11:return e=_w(e.type.render,!1),e;case 1:return e=_w(e.type,!0),e;default:return""}}function z1(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case vd:return"Fragment";case bd:return"Portal";case O1:return"Profiler";case oI:return"StrictMode";case L1:return"Suspense";case P1:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case nF:return(e.displayName||"Context")+".Consumer";case tF:return(e._context.displayName||"Context")+".Provider";case lI:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case uI:return t=e.displayName||null,t!==null?t:z1(e.type)||"Memo";case Js:t=e._payload,e=e._init;try{return z1(e(t))}catch(n){}}return null}function x6(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return z1(t);case 8:return t===oI?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Co(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function aF(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function w6(e){var t=aF(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(s){r=""+s,i.call(this,s)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function xy(e){e._valueTracker||(e._valueTracker=w6(e))}function iF(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=aF(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Nb(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch(t){return e.body}}function B1(e,t){var n=t.checked;return Jt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n!=null?n:e._wrapperState.initialChecked})}function kN(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Co(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function sF(e,t){t=t.checked,t!=null&&sI(e,"checked",t,!1)}function W1(e,t){sF(e,t);var n=Co(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?U1(e,t.type,n):t.hasOwnProperty("defaultValue")&&U1(e,t.type,Co(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function SN(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function U1(e,t,n){(t!=="number"||Nb(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var xf=Array.isArray;function Ad(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Co(n),t=null,a=0;a<e.length;a++){if(e[a].value===n){e[a].selected=!0,r&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function V1(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ce(91));return Jt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function IN(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(ce(92));if(xf(n)){if(1<n.length)throw Error(ce(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Co(n)}}function oF(e,t){var n=Co(t.value),r=Co(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function $N(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function lF(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function H1(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?lF(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var wy,uF=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,a){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(wy=wy||document.createElement("div"),wy.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=wy.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function em(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Ff={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},k6=["Webkit","ms","Moz","O"];Object.keys(Ff).forEach(function(e){k6.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Ff[t]=Ff[e]})});function cF(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Ff.hasOwnProperty(e)&&Ff[e]?(""+t).trim():t+"px"}function dF(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,a=cF(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}var S6=Jt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function j1(e,t){if(t){if(S6[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ce(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ce(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ce(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ce(62))}}function G1(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var q1=null;function cI(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var K1=null,Rd=null,Dd=null;function CN(e){if(e=Gm(e)){if(typeof K1!="function")throw Error(ce(280));var t=e.stateNode;t&&(t=a0(t),K1(e.stateNode,e.type,t))}}function pF(e){Rd?Dd?Dd.push(e):Dd=[e]:Rd=e}function hF(){if(Rd){var e=Rd,t=Dd;if(Dd=Rd=null,CN(e),t)for(e=0;e<t.length;e++)CN(t[e])}}function fF(e,t){return e(t)}function mF(){}var Aw=!1;function gF(e,t,n){if(Aw)return e(t,n);Aw=!0;try{return fF(e,t,n)}finally{Aw=!1,(Rd!==null||Dd!==null)&&(mF(),hF())}}function tm(e,t){var n=e.stateNode;if(n===null)return null;var r=a0(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(ce(231,t,typeof n));return n}var X1=!1;if(_s)try{var sf={};Object.defineProperty(sf,"passive",{get:function(){X1=!0}}),window.addEventListener("test",sf,sf),window.removeEventListener("test",sf,sf)}catch(e){X1=!1}function I6(e,t,n,r,a,i,s,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Mf=!1,_b=null,Ab=!1,Y1=null,$6={onError:function(e){Mf=!0,_b=e}};function C6(e,t,n,r,a,i,s,o,l){Mf=!1,_b=null,I6.apply($6,arguments)}function E6(e,t,n,r,a,i,s,o,l){if(C6.apply(this,arguments),Mf){if(Mf){var c=_b;Mf=!1,_b=null}else throw Error(ce(198));Ab||(Ab=!0,Y1=c)}}function yu(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function yF(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function EN(e){if(yu(e)!==e)throw Error(ce(188))}function T6(e){var t=e.alternate;if(!t){if(t=yu(e),t===null)throw Error(ce(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(a===null)break;var i=a.alternate;if(i===null){if(r=a.return,r!==null){n=r;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===n)return EN(a),e;if(i===r)return EN(a),t;i=i.sibling}throw Error(ce(188))}if(n.return!==r.return)n=a,r=i;else{for(var s=!1,o=a.child;o;){if(o===n){s=!0,n=a,r=i;break}if(o===r){s=!0,r=a,n=i;break}o=o.sibling}if(!s){for(o=i.child;o;){if(o===n){s=!0,n=i,r=a;break}if(o===r){s=!0,r=i,n=a;break}o=o.sibling}if(!s)throw Error(ce(189))}}if(n.alternate!==r)throw Error(ce(190))}if(n.tag!==3)throw Error(ce(188));return n.stateNode.current===n?e:t}function bF(e){return e=T6(e),e!==null?vF(e):null}function vF(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=vF(e);if(t!==null)return t;e=e.sibling}return null}var xF=Aa.unstable_scheduleCallback,TN=Aa.unstable_cancelCallback,N6=Aa.unstable_shouldYield,_6=Aa.unstable_requestPaint,cn=Aa.unstable_now,A6=Aa.unstable_getCurrentPriorityLevel,dI=Aa.unstable_ImmediatePriority,wF=Aa.unstable_UserBlockingPriority,Rb=Aa.unstable_NormalPriority,R6=Aa.unstable_LowPriority,kF=Aa.unstable_IdlePriority,e0=null,Qi=null;function D6(e){if(Qi&&typeof Qi.onCommitFiberRoot=="function")try{Qi.onCommitFiberRoot(e0,e,void 0,(e.current.flags&128)===128)}catch(t){}}var ki=Math.clz32?Math.clz32:O6,F6=Math.log,M6=Math.LN2;function O6(e){return e>>>=0,e===0?32:31-(F6(e)/M6|0)|0}var ky=64,Sy=4194304;function wf(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Db(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,a=e.suspendedLanes,i=e.pingedLanes,s=n&268435455;if(s!==0){var o=s&~a;o!==0?r=wf(o):(i&=s,i!==0&&(r=wf(i)))}else s=n&~a,s!==0?r=wf(s):i!==0&&(r=wf(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&a)&&(a=r&-r,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-ki(t),a=1<<n,r|=e[n],t&=~a;return r}function L6(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function P6(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var s=31-ki(i),o=1<<s,l=a[s];l===-1?(!(o&n)||o&r)&&(a[s]=L6(o,t)):l<=t&&(e.expiredLanes|=o),i&=~o}}function Z1(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function SF(){var e=ky;return ky<<=1,!(ky&4194240)&&(ky=64),e}function Rw(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Hm(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-ki(t),e[t]=n}function z6(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-ki(n),i=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~i}}function pI(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-ki(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var xt=0;function IF(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var $F,hI,CF,EF,TF,Q1=!1,Iy=[],fo=null,mo=null,go=null,nm=new Map,rm=new Map,no=[],B6="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function NN(e,t){switch(e){case"focusin":case"focusout":fo=null;break;case"dragenter":case"dragleave":mo=null;break;case"mouseover":case"mouseout":go=null;break;case"pointerover":case"pointerout":nm.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":rm.delete(t.pointerId)}}function of(e,t,n,r,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},t!==null&&(t=Gm(t),t!==null&&hI(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function W6(e,t,n,r,a){switch(t){case"focusin":return fo=of(fo,e,t,n,r,a),!0;case"dragenter":return mo=of(mo,e,t,n,r,a),!0;case"mouseover":return go=of(go,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return nm.set(i,of(nm.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,rm.set(i,of(rm.get(i)||null,e,t,n,r,a)),!0}return!1}function NF(e){var t=$l(e.target);if(t!==null){var n=yu(t);if(n!==null){if(t=n.tag,t===13){if(t=yF(n),t!==null){e.blockedOn=t,TF(e.priority,function(){CF(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function lb(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=J1(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);q1=r,n.target.dispatchEvent(r),q1=null}else return t=Gm(n),t!==null&&hI(t),e.blockedOn=n,!1;t.shift()}return!0}function _N(e,t,n){lb(e)&&n.delete(t)}function U6(){Q1=!1,fo!==null&&lb(fo)&&(fo=null),mo!==null&&lb(mo)&&(mo=null),go!==null&&lb(go)&&(go=null),nm.forEach(_N),rm.forEach(_N)}function lf(e,t){e.blockedOn===t&&(e.blockedOn=null,Q1||(Q1=!0,Aa.unstable_scheduleCallback(Aa.unstable_NormalPriority,U6)))}function am(e){function t(a){return lf(a,e)}if(0<Iy.length){lf(Iy[0],e);for(var n=1;n<Iy.length;n++){var r=Iy[n];r.blockedOn===e&&(r.blockedOn=null)}}for(fo!==null&&lf(fo,e),mo!==null&&lf(mo,e),go!==null&&lf(go,e),nm.forEach(t),rm.forEach(t),n=0;n<no.length;n++)r=no[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<no.length&&(n=no[0],n.blockedOn===null);)NF(n),n.blockedOn===null&&no.shift()}var Fd=Ps.ReactCurrentBatchConfig,Fb=!0;function V6(e,t,n,r){var a=xt,i=Fd.transition;Fd.transition=null;try{xt=1,fI(e,t,n,r)}finally{xt=a,Fd.transition=i}}function H6(e,t,n,r){var a=xt,i=Fd.transition;Fd.transition=null;try{xt=4,fI(e,t,n,r)}finally{xt=a,Fd.transition=i}}function fI(e,t,n,r){if(Fb){var a=J1(e,t,n,r);if(a===null)Uw(e,t,r,Mb,n),NN(e,r);else if(W6(a,e,t,n,r))r.stopPropagation();else if(NN(e,r),t&4&&-1<B6.indexOf(e)){for(;a!==null;){var i=Gm(a);if(i!==null&&$F(i),i=J1(e,t,n,r),i===null&&Uw(e,t,r,Mb,n),i===a)break;a=i}a!==null&&r.stopPropagation()}else Uw(e,t,r,null,n)}}var Mb=null;function J1(e,t,n,r){if(Mb=null,e=cI(r),e=$l(e),e!==null)if(t=yu(e),t===null)e=null;else if(n=t.tag,n===13){if(e=yF(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Mb=e,null}function _F(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(A6()){case dI:return 1;case wF:return 4;case Rb:case R6:return 16;case kF:return 536870912;default:return 16}default:return 16}}var io=null,mI=null,ub=null;function AF(){if(ub)return ub;var e,t=mI,n=t.length,r,a="value"in io?io.value:io.textContent,i=a.length;for(e=0;e<n&&t[e]===a[e];e++);var s=n-e;for(r=1;r<=s&&t[n-r]===a[i-r];r++);return ub=a.slice(e,1<r?1-r:void 0)}function cb(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function $y(){return!0}function AN(){return!1}function Oa(e){function t(n,r,a,i,s){this._reactName=n,this._targetInst=a,this.type=r,this.nativeEvent=i,this.target=s,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(n=e[o],this[o]=n?n(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?$y:AN,this.isPropagationStopped=AN,this}return Jt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=$y)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=$y)},persist:function(){},isPersistent:$y}),t}var Cp={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},gI=Oa(Cp),jm=Jt({},Cp,{view:0,detail:0}),j6=Oa(jm),Dw,Fw,uf,t0=Jt({},jm,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yI,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==uf&&(uf&&e.type==="mousemove"?(Dw=e.screenX-uf.screenX,Fw=e.screenY-uf.screenY):Fw=Dw=0,uf=e),Dw)},movementY:function(e){return"movementY"in e?e.movementY:Fw}}),RN=Oa(t0),G6=Jt({},t0,{dataTransfer:0}),q6=Oa(G6),K6=Jt({},jm,{relatedTarget:0}),Mw=Oa(K6),X6=Jt({},Cp,{animationName:0,elapsedTime:0,pseudoElement:0}),Y6=Oa(X6),Z6=Jt({},Cp,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Q6=Oa(Z6),J6=Jt({},Cp,{data:0}),DN=Oa(J6),eG={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},tG={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},nG={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function rG(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=nG[e])?!!t[e]:!1}function yI(){return rG}var aG=Jt({},jm,{key:function(e){if(e.key){var t=eG[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=cb(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?tG[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yI,charCode:function(e){return e.type==="keypress"?cb(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?cb(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),iG=Oa(aG),sG=Jt({},t0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),FN=Oa(sG),oG=Jt({},jm,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yI}),lG=Oa(oG),uG=Jt({},Cp,{propertyName:0,elapsedTime:0,pseudoElement:0}),cG=Oa(uG),dG=Jt({},t0,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),pG=Oa(dG),hG=[9,13,27,32],bI=_s&&"CompositionEvent"in window,Of=null;_s&&"documentMode"in document&&(Of=document.documentMode);var fG=_s&&"TextEvent"in window&&!Of,RF=_s&&(!bI||Of&&8<Of&&11>=Of),MN=String.fromCharCode(32),ON=!1;function DF(e,t){switch(e){case"keyup":return hG.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function FF(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var xd=!1;function mG(e,t){switch(e){case"compositionend":return FF(t);case"keypress":return t.which!==32?null:(ON=!0,MN);case"textInput":return e=t.data,e===MN&&ON?null:e;default:return null}}function gG(e,t){if(xd)return e==="compositionend"||!bI&&DF(e,t)?(e=AF(),ub=mI=io=null,xd=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return RF&&t.locale!=="ko"?null:t.data;default:return null}}var yG={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function LN(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!yG[e.type]:t==="textarea"}function MF(e,t,n,r){pF(r),t=Ob(t,"onChange"),0<t.length&&(n=new gI("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Lf=null,im=null;function bG(e){GF(e,0)}function n0(e){var t=Sd(e);if(iF(t))return e}function vG(e,t){if(e==="change")return t}var OF=!1;if(_s){var Ow;if(_s){var Lw="oninput"in document;if(!Lw){var PN=document.createElement("div");PN.setAttribute("oninput","return;"),Lw=typeof PN.oninput=="function"}Ow=Lw}else Ow=!1;OF=Ow&&(!document.documentMode||9<document.documentMode)}function zN(){Lf&&(Lf.detachEvent("onpropertychange",LF),im=Lf=null)}function LF(e){if(e.propertyName==="value"&&n0(im)){var t=[];MF(t,im,e,cI(e)),gF(bG,t)}}function xG(e,t,n){e==="focusin"?(zN(),Lf=t,im=n,Lf.attachEvent("onpropertychange",LF)):e==="focusout"&&zN()}function wG(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return n0(im)}function kG(e,t){if(e==="click")return n0(t)}function SG(e,t){if(e==="input"||e==="change")return n0(t)}function IG(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ai=typeof Object.is=="function"?Object.is:IG;function sm(e,t){if(Ai(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!M1.call(t,a)||!Ai(e[a],t[a]))return!1}return!0}function BN(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function WN(e,t){var n=BN(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=BN(n)}}function PF(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?PF(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function zF(){for(var e=window,t=Nb();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch(r){n=!1}if(n)e=t.contentWindow;else break;t=Nb(e.document)}return t}function vI(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function $G(e){var t=zF(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&PF(n.ownerDocument.documentElement,n)){if(r!==null&&vI(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=n.textContent.length,i=Math.min(r.start,a);r=r.end===void 0?i:Math.min(r.end,a),!e.extend&&i>r&&(a=r,r=i,i=a),a=WN(n,i);var s=WN(n,r);a&&s&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var CG=_s&&"documentMode"in document&&11>=document.documentMode,wd=null,ek=null,Pf=null,tk=!1;function UN(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;tk||wd==null||wd!==Nb(r)||(r=wd,"selectionStart"in r&&vI(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Pf&&sm(Pf,r)||(Pf=r,r=Ob(ek,"onSelect"),0<r.length&&(t=new gI("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=wd)))}function Cy(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var kd={animationend:Cy("Animation","AnimationEnd"),animationiteration:Cy("Animation","AnimationIteration"),animationstart:Cy("Animation","AnimationStart"),transitionend:Cy("Transition","TransitionEnd")},Pw={},BF={};_s&&(BF=document.createElement("div").style,"AnimationEvent"in window||(delete kd.animationend.animation,delete kd.animationiteration.animation,delete kd.animationstart.animation),"TransitionEvent"in window||delete kd.transitionend.transition);function r0(e){if(Pw[e])return Pw[e];if(!kd[e])return e;var t=kd[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in BF)return Pw[e]=t[n];return e}var WF=r0("animationend"),UF=r0("animationiteration"),VF=r0("animationstart"),HF=r0("transitionend"),jF=new Map,VN="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Uo(e,t){jF.set(e,t),gu(t,[e])}for(var zw=0;zw<VN.length;zw++){var Bw=VN[zw],EG=Bw.toLowerCase(),TG=Bw[0].toUpperCase()+Bw.slice(1);Uo(EG,"on"+TG)}Uo(WF,"onAnimationEnd");Uo(UF,"onAnimationIteration");Uo(VF,"onAnimationStart");Uo("dblclick","onDoubleClick");Uo("focusin","onFocus");Uo("focusout","onBlur");Uo(HF,"onTransitionEnd");Hd("onMouseEnter",["mouseout","mouseover"]);Hd("onMouseLeave",["mouseout","mouseover"]);Hd("onPointerEnter",["pointerout","pointerover"]);Hd("onPointerLeave",["pointerout","pointerover"]);gu("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));gu("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));gu("onBeforeInput",["compositionend","keypress","textInput","paste"]);gu("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));gu("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));gu("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var kf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),NG=new Set("cancel close invalid load scroll toggle".split(" ").concat(kf));function HN(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,E6(r,t,void 0,e),e.currentTarget=null}function GF(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var s=r.length-1;0<=s;s--){var o=r[s],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==i&&a.isPropagationStopped())break e;HN(a,o,c),i=l}else for(s=0;s<r.length;s++){if(o=r[s],l=o.instance,c=o.currentTarget,o=o.listener,l!==i&&a.isPropagationStopped())break e;HN(a,o,c),i=l}}}if(Ab)throw e=Y1,Ab=!1,Y1=null,e}function Lt(e,t){var n=t[sk];n===void 0&&(n=t[sk]=new Set);var r=e+"__bubble";n.has(r)||(qF(t,e,2,!1),n.add(r))}function Ww(e,t,n){var r=0;t&&(r|=4),qF(n,e,r,t)}var Ey="_reactListening"+Math.random().toString(36).slice(2);function om(e){if(!e[Ey]){e[Ey]=!0,eF.forEach(function(n){n!=="selectionchange"&&(NG.has(n)||Ww(n,!1,e),Ww(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ey]||(t[Ey]=!0,Ww("selectionchange",!1,t))}}function qF(e,t,n,r){switch(_F(t)){case 1:var a=V6;break;case 4:a=H6;break;default:a=fI}n=a.bind(null,t,n,e),a=void 0,!X1||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),r?a!==void 0?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):a!==void 0?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Uw(e,t,n,r,a){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var o=r.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(s===4)for(s=r.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===a||l.nodeType===8&&l.parentNode===a))return;s=s.return}for(;o!==null;){if(s=$l(o),s===null)return;if(l=s.tag,l===5||l===6){r=i=s;continue e}o=o.parentNode}}r=r.return}gF(function(){var c=i,u=cI(n),d=[];e:{var p=jF.get(e);if(p!==void 0){var h=gI,f=e;switch(e){case"keypress":if(cb(n)===0)break e;case"keydown":case"keyup":h=iG;break;case"focusin":f="focus",h=Mw;break;case"focusout":f="blur",h=Mw;break;case"beforeblur":case"afterblur":h=Mw;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=RN;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=q6;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=lG;break;case WF:case UF:case VF:h=Y6;break;case HF:h=cG;break;case"scroll":h=j6;break;case"wheel":h=pG;break;case"copy":case"cut":case"paste":h=Q6;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=FN}var m=(t&4)!==0,g=!m&&e==="scroll",y=m?p!==null?p+"Capture":null:p;m=[];for(var b=c,v;b!==null;){v=b;var x=v.stateNode;if(v.tag===5&&x!==null&&(v=x,y!==null&&(x=tm(b,y),x!=null&&m.push(lm(b,x,v)))),g)break;b=b.return}0<m.length&&(p=new h(p,f,null,n,u),d.push({event:p,listeners:m}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",p&&n!==q1&&(f=n.relatedTarget||n.fromElement)&&($l(f)||f[As]))break e;if((h||p)&&(p=u.window===u?u:(p=u.ownerDocument)?p.defaultView||p.parentWindow:window,h?(f=n.relatedTarget||n.toElement,h=c,f=f?$l(f):null,f!==null&&(g=yu(f),f!==g||f.tag!==5&&f.tag!==6)&&(f=null)):(h=null,f=c),h!==f)){if(m=RN,x="onMouseLeave",y="onMouseEnter",b="mouse",(e==="pointerout"||e==="pointerover")&&(m=FN,x="onPointerLeave",y="onPointerEnter",b="pointer"),g=h==null?p:Sd(h),v=f==null?p:Sd(f),p=new m(x,b+"leave",h,n,u),p.target=g,p.relatedTarget=v,x=null,$l(u)===c&&(m=new m(y,b+"enter",f,n,u),m.target=v,m.relatedTarget=g,x=m),g=x,h&&f)t:{for(m=h,y=f,b=0,v=m;v;v=id(v))b++;for(v=0,x=y;x;x=id(x))v++;for(;0<b-v;)m=id(m),b--;for(;0<v-b;)y=id(y),v--;for(;b--;){if(m===y||y!==null&&m===y.alternate)break t;m=id(m),y=id(y)}m=null}else m=null;h!==null&&jN(d,p,h,m,!1),f!==null&&g!==null&&jN(d,g,f,m,!0)}}e:{if(p=c?Sd(c):window,h=p.nodeName&&p.nodeName.toLowerCase(),h==="select"||h==="input"&&p.type==="file")var w=vG;else if(LN(p))if(OF)w=SG;else{w=wG;var $=xG}else(h=p.nodeName)&&h.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(w=kG);if(w&&(w=w(e,c))){MF(d,w,n,u);break e}$&&$(e,p,c),e==="focusout"&&($=p._wrapperState)&&$.controlled&&p.type==="number"&&U1(p,"number",p.value)}switch($=c?Sd(c):window,e){case"focusin":(LN($)||$.contentEditable==="true")&&(wd=$,ek=c,Pf=null);break;case"focusout":Pf=ek=wd=null;break;case"mousedown":tk=!0;break;case"contextmenu":case"mouseup":case"dragend":tk=!1,UN(d,n,u);break;case"selectionchange":if(CG)break;case"keydown":case"keyup":UN(d,n,u)}var C;if(bI)e:{switch(e){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else xd?DF(e,n)&&(E="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(E="onCompositionStart");E&&(RF&&n.locale!=="ko"&&(xd||E!=="onCompositionStart"?E==="onCompositionEnd"&&xd&&(C=AF()):(io=u,mI="value"in io?io.value:io.textContent,xd=!0)),$=Ob(c,E),0<$.length&&(E=new DN(E,e,null,n,u),d.push({event:E,listeners:$}),C?E.data=C:(C=FF(n),C!==null&&(E.data=C)))),(C=fG?mG(e,n):gG(e,n))&&(c=Ob(c,"onBeforeInput"),0<c.length&&(u=new DN("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:c}),u.data=C))}GF(d,t)})}function lm(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Ob(e,t){for(var n=t+"Capture",r=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=tm(e,n),i!=null&&r.unshift(lm(e,i,a)),i=tm(e,t),i!=null&&r.push(lm(e,i,a))),e=e.return}return r}function id(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function jN(e,t,n,r,a){for(var i=t._reactName,s=[];n!==null&&n!==r;){var o=n,l=o.alternate,c=o.stateNode;if(l!==null&&l===r)break;o.tag===5&&c!==null&&(o=c,a?(l=tm(n,i),l!=null&&s.unshift(lm(n,l,o))):a||(l=tm(n,i),l!=null&&s.push(lm(n,l,o)))),n=n.return}s.length!==0&&e.push({event:t,listeners:s})}var _G=/\r\n?/g,AG=/\u0000|\uFFFD/g;function GN(e){return(typeof e=="string"?e:""+e).replace(_G,"\n").replace(AG,"")}function Ty(e,t,n){if(t=GN(t),GN(e)!==t&&n)throw Error(ce(425))}function Lb(){}var nk=null,rk=null;function ak(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var ik=typeof setTimeout=="function"?setTimeout:void 0,RG=typeof clearTimeout=="function"?clearTimeout:void 0,qN=typeof Promise=="function"?Promise:void 0,DG=typeof queueMicrotask=="function"?queueMicrotask:typeof qN<"u"?function(e){return qN.resolve(null).then(e).catch(FG)}:ik;function FG(e){setTimeout(function(){throw e})}function Vw(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(r===0){e.removeChild(a),am(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=a}while(n);am(t)}function yo(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function KN(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Ep=Math.random().toString(36).slice(2),Yi="__reactFiber$"+Ep,um="__reactProps$"+Ep,As="__reactContainer$"+Ep,sk="__reactEvents$"+Ep,MG="__reactListeners$"+Ep,OG="__reactHandles$"+Ep;function $l(e){var t=e[Yi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[As]||n[Yi]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=KN(e);e!==null;){if(n=e[Yi])return n;e=KN(e)}return t}e=n,n=e.parentNode}return null}function Gm(e){return e=e[Yi]||e[As],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Sd(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ce(33))}function a0(e){return e[um]||null}var ok=[],Id=-1;function Vo(e){return{current:e}}function Pt(e){0>Id||(e.current=ok[Id],ok[Id]=null,Id--)}function Mt(e,t){Id++,ok[Id]=e.current,e.current=t}var Eo={},kr=Vo(Eo),la=Vo(!1),Bl=Eo;function jd(e,t){var n=e.type.contextTypes;if(!n)return Eo;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in n)a[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function ua(e){return e=e.childContextTypes,e!=null}function Pb(){Pt(la),Pt(kr)}function XN(e,t,n){if(kr.current!==Eo)throw Error(ce(168));Mt(kr,t),Mt(la,n)}function KF(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var a in r)if(!(a in t))throw Error(ce(108,x6(e)||"Unknown",a));return Jt({},n,r)}function zb(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Eo,Bl=kr.current,Mt(kr,e),Mt(la,la.current),!0}function YN(e,t,n){var r=e.stateNode;if(!r)throw Error(ce(169));n?(e=KF(e,t,Bl),r.__reactInternalMemoizedMergedChildContext=e,Pt(la),Pt(kr),Mt(kr,e)):Pt(la),Mt(la,n)}var gs=null,i0=!1,Hw=!1;function XF(e){gs===null?gs=[e]:gs.push(e)}function LG(e){i0=!0,XF(e)}function Ho(){if(!Hw&&gs!==null){Hw=!0;var e=0,t=xt;try{var n=gs;for(xt=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}gs=null,i0=!1}catch(a){throw gs!==null&&(gs=gs.slice(e+1)),xF(dI,Ho),a}finally{xt=t,Hw=!1}}return null}var $d=[],Cd=0,Bb=null,Wb=0,Ka=[],Xa=0,Wl=null,Ss=1,Is="";function fl(e,t){$d[Cd++]=Wb,$d[Cd++]=Bb,Bb=e,Wb=t}function YF(e,t,n){Ka[Xa++]=Ss,Ka[Xa++]=Is,Ka[Xa++]=Wl,Wl=e;var r=Ss;e=Is;var a=32-ki(r)-1;r&=~(1<<a),n+=1;var i=32-ki(t)+a;if(30<i){var s=a-a%5;i=(r&(1<<s)-1).toString(32),r>>=s,a-=s,Ss=1<<32-ki(t)+a|n<<a|r,Is=i+e}else Ss=1<<i|n<<a|r,Is=e}function xI(e){e.return!==null&&(fl(e,1),YF(e,1,0))}function wI(e){for(;e===Bb;)Bb=$d[--Cd],$d[Cd]=null,Wb=$d[--Cd],$d[Cd]=null;for(;e===Wl;)Wl=Ka[--Xa],Ka[Xa]=null,Is=Ka[--Xa],Ka[Xa]=null,Ss=Ka[--Xa],Ka[Xa]=null}var Na=null,Ia=null,jt=!1,mi=null;function ZF(e,t){var n=Ya(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function ZN(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Na=e,Ia=yo(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Na=e,Ia=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Wl!==null?{id:Ss,overflow:Is}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Ya(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Na=e,Ia=null,!0):!1;default:return!1}}function lk(e){return(e.mode&1)!==0&&(e.flags&128)===0}function uk(e){if(jt){var t=Ia;if(t){var n=t;if(!ZN(e,t)){if(lk(e))throw Error(ce(418));t=yo(n.nextSibling);var r=Na;t&&ZN(e,t)?ZF(r,n):(e.flags=e.flags&-4097|2,jt=!1,Na=e)}}else{if(lk(e))throw Error(ce(418));e.flags=e.flags&-4097|2,jt=!1,Na=e}}}function QN(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Na=e}function Ny(e){if(e!==Na)return!1;if(!jt)return QN(e),jt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!ak(e.type,e.memoizedProps)),t&&(t=Ia)){if(lk(e))throw QF(),Error(ce(418));for(;t;)ZF(e,t),t=yo(t.nextSibling)}if(QN(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ce(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Ia=yo(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Ia=null}}else Ia=Na?yo(e.stateNode.nextSibling):null;return!0}function QF(){for(var e=Ia;e;)e=yo(e.nextSibling)}function Gd(){Ia=Na=null,jt=!1}function kI(e){mi===null?mi=[e]:mi.push(e)}var PG=Ps.ReactCurrentBatchConfig;function pi(e,t){if(e&&e.defaultProps){t=Jt({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}var Ub=Vo(null),Vb=null,Ed=null,SI=null;function II(){SI=Ed=Vb=null}function $I(e){var t=Ub.current;Pt(Ub),e._currentValue=t}function ck(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Md(e,t){Vb=e,SI=Ed=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(aa=!0),e.firstContext=null)}function Ja(e){var t=e._currentValue;if(SI!==e)if(e={context:e,memoizedValue:t,next:null},Ed===null){if(Vb===null)throw Error(ce(308));Ed=e,Vb.dependencies={lanes:0,firstContext:e}}else Ed=Ed.next=e;return t}var Cl=null;function CI(e){Cl===null?Cl=[e]:Cl.push(e)}function JF(e,t,n,r){var a=t.interleaved;return a===null?(n.next=n,CI(t)):(n.next=a.next,a.next=n),t.interleaved=n,Rs(e,r)}function Rs(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var eo=!1;function EI(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function eM(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function $s(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function bo(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,dt&2){var a=r.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),r.pending=t,Rs(e,n)}return a=r.interleaved,a===null?(t.next=t,CI(r)):(t.next=a.next,a.next=t),r.interleaved=t,Rs(e,n)}function db(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,pI(e,n)}}function JN(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var a=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?a=i=s:i=i.next=s,n=n.next}while(n!==null);i===null?a=i=t:i=i.next=t}else a=i=t;n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Hb(e,t,n,r){var a=e.updateQueue;eo=!1;var i=a.firstBaseUpdate,s=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var l=o,c=l.next;l.next=null,s===null?i=c:s.next=c,s=l;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==s&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(i!==null){var d=a.baseState;s=0,u=c=l=null,o=i;do{var p=o.lane,h=o.eventTime;if((r&p)===p){u!==null&&(u=u.next={eventTime:h,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var f=e,m=o;switch(p=t,h=n,m.tag){case 1:if(f=m.payload,typeof f=="function"){d=f.call(h,d,p);break e}d=f;break e;case 3:f.flags=f.flags&-65537|128;case 0:if(f=m.payload,p=typeof f=="function"?f.call(h,d,p):f,p==null)break e;d=Jt({},d,p);break e;case 2:eo=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,p=a.effects,p===null?a.effects=[o]:p.push(o))}else h={eventTime:h,lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=h,l=d):u=u.next=h,s|=p;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;p=o,o=p.next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}while(1);if(u===null&&(l=d),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=u,t=a.shared.interleaved,t!==null){a=t;do s|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);Vl|=s,e.lanes=s,e.memoizedState=d}}function e_(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(a!==null){if(r.callback=null,r=n,typeof a!="function")throw Error(ce(191,a));a.call(r)}}}var tM=new JD.Component().refs;function dk(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Jt({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var s0={isMounted:function(e){return(e=e._reactInternals)?yu(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Wr(),a=xo(e),i=$s(r,a);i.payload=t,n!=null&&(i.callback=n),t=bo(e,i,a),t!==null&&(Si(t,e,a,r),db(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Wr(),a=xo(e),i=$s(r,a);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=bo(e,i,a),t!==null&&(Si(t,e,a,r),db(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Wr(),r=xo(e),a=$s(n,r);a.tag=2,t!=null&&(a.callback=t),t=bo(e,a,r),t!==null&&(Si(t,e,r,n),db(t,e,r))}};function t_(e,t,n,r,a,i,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,s):t.prototype&&t.prototype.isPureReactComponent?!sm(n,r)||!sm(a,i):!0}function nM(e,t,n){var r=!1,a=Eo,i=t.contextType;return typeof i=="object"&&i!==null?i=Ja(i):(a=ua(t)?Bl:kr.current,r=t.contextTypes,i=(r=r!=null)?jd(e,a):Eo),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=s0,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function n_(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&s0.enqueueReplaceState(t,t.state,null)}function pk(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs=tM,EI(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=Ja(i):(i=ua(t)?Bl:kr.current,a.context=jd(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(dk(e,t,i,n),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&s0.enqueueReplaceState(a,a.state,null),Hb(e,n,a,r),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function cf(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ce(309));var r=n.stateNode}if(!r)throw Error(ce(147,e));var a=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(s){var o=a.refs;o===tM&&(o=a.refs={}),s===null?delete o[i]:o[i]=s},t._stringRef=i,t)}if(typeof e!="string")throw Error(ce(284));if(!n._owner)throw Error(ce(290,e))}return e}function _y(e,t){throw e=Object.prototype.toString.call(t),Error(ce(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function r_(e){var t=e._init;return t(e._payload)}function rM(e){function t(y,b){if(e){var v=y.deletions;v===null?(y.deletions=[b],y.flags|=16):v.push(b)}}function n(y,b){if(!e)return null;for(;b!==null;)t(y,b),b=b.sibling;return null}function r(y,b){for(y=new Map;b!==null;)b.key!==null?y.set(b.key,b):y.set(b.index,b),b=b.sibling;return y}function a(y,b){return y=wo(y,b),y.index=0,y.sibling=null,y}function i(y,b,v){return y.index=v,e?(v=y.alternate,v!==null?(v=v.index,v<b?(y.flags|=2,b):v):(y.flags|=2,b)):(y.flags|=1048576,b)}function s(y){return e&&y.alternate===null&&(y.flags|=2),y}function o(y,b,v,x){return b===null||b.tag!==6?(b=Zw(v,y.mode,x),b.return=y,b):(b=a(b,v),b.return=y,b)}function l(y,b,v,x){var w=v.type;return w===vd?u(y,b,v.props.children,x,v.key):b!==null&&(b.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===Js&&r_(w)===b.type)?(x=a(b,v.props),x.ref=cf(y,b,v),x.return=y,x):(x=yb(v.type,v.key,v.props,null,y.mode,x),x.ref=cf(y,b,v),x.return=y,x)}function c(y,b,v,x){return b===null||b.tag!==4||b.stateNode.containerInfo!==v.containerInfo||b.stateNode.implementation!==v.implementation?(b=Qw(v,y.mode,x),b.return=y,b):(b=a(b,v.children||[]),b.return=y,b)}function u(y,b,v,x,w){return b===null||b.tag!==7?(b=Fl(v,y.mode,x,w),b.return=y,b):(b=a(b,v),b.return=y,b)}function d(y,b,v){if(typeof b=="string"&&b!==""||typeof b=="number")return b=Zw(""+b,y.mode,v),b.return=y,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case vy:return v=yb(b.type,b.key,b.props,null,y.mode,v),v.ref=cf(y,null,b),v.return=y,v;case bd:return b=Qw(b,y.mode,v),b.return=y,b;case Js:var x=b._init;return d(y,x(b._payload),v)}if(xf(b)||af(b))return b=Fl(b,y.mode,v,null),b.return=y,b;_y(y,b)}return null}function p(y,b,v,x){var w=b!==null?b.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return w!==null?null:o(y,b,""+v,x);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case vy:return v.key===w?l(y,b,v,x):null;case bd:return v.key===w?c(y,b,v,x):null;case Js:return w=v._init,p(y,b,w(v._payload),x)}if(xf(v)||af(v))return w!==null?null:u(y,b,v,x,null);_y(y,v)}return null}function h(y,b,v,x,w){if(typeof x=="string"&&x!==""||typeof x=="number")return y=y.get(v)||null,o(b,y,""+x,w);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case vy:return y=y.get(x.key===null?v:x.key)||null,l(b,y,x,w);case bd:return y=y.get(x.key===null?v:x.key)||null,c(b,y,x,w);case Js:var $=x._init;return h(y,b,v,$(x._payload),w)}if(xf(x)||af(x))return y=y.get(v)||null,u(b,y,x,w,null);_y(b,x)}return null}function f(y,b,v,x){for(var w=null,$=null,C=b,E=b=0,_=null;C!==null&&E<v.length;E++){C.index>E?(_=C,C=null):_=C.sibling;var R=p(y,C,v[E],x);if(R===null){C===null&&(C=_);break}e&&C&&R.alternate===null&&t(y,C),b=i(R,b,E),$===null?w=R:$.sibling=R,$=R,C=_}if(E===v.length)return n(y,C),jt&&fl(y,E),w;if(C===null){for(;E<v.length;E++)C=d(y,v[E],x),C!==null&&(b=i(C,b,E),$===null?w=C:$.sibling=C,$=C);return jt&&fl(y,E),w}for(C=r(y,C);E<v.length;E++)_=h(C,y,E,v[E],x),_!==null&&(e&&_.alternate!==null&&C.delete(_.key===null?E:_.key),b=i(_,b,E),$===null?w=_:$.sibling=_,$=_);return e&&C.forEach(function(N){return t(y,N)}),jt&&fl(y,E),w}function m(y,b,v,x){var w=af(v);if(typeof w!="function")throw Error(ce(150));if(v=w.call(v),v==null)throw Error(ce(151));for(var $=w=null,C=b,E=b=0,_=null,R=v.next();C!==null&&!R.done;E++,R=v.next()){C.index>E?(_=C,C=null):_=C.sibling;var N=p(y,C,R.value,x);if(N===null){C===null&&(C=_);break}e&&C&&N.alternate===null&&t(y,C),b=i(N,b,E),$===null?w=N:$.sibling=N,$=N,C=_}if(R.done)return n(y,C),jt&&fl(y,E),w;if(C===null){for(;!R.done;E++,R=v.next())R=d(y,R.value,x),R!==null&&(b=i(R,b,E),$===null?w=R:$.sibling=R,$=R);return jt&&fl(y,E),w}for(C=r(y,C);!R.done;E++,R=v.next())R=h(C,y,E,R.value,x),R!==null&&(e&&R.alternate!==null&&C.delete(R.key===null?E:R.key),b=i(R,b,E),$===null?w=R:$.sibling=R,$=R);return e&&C.forEach(function(I){return t(y,I)}),jt&&fl(y,E),w}function g(y,b,v,x){if(typeof v=="object"&&v!==null&&v.type===vd&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case vy:e:{for(var w=v.key,$=b;$!==null;){if($.key===w){if(w=v.type,w===vd){if($.tag===7){n(y,$.sibling),b=a($,v.props.children),b.return=y,y=b;break e}}else if($.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===Js&&r_(w)===$.type){n(y,$.sibling),b=a($,v.props),b.ref=cf(y,$,v),b.return=y,y=b;break e}n(y,$);break}else t(y,$);$=$.sibling}v.type===vd?(b=Fl(v.props.children,y.mode,x,v.key),b.return=y,y=b):(x=yb(v.type,v.key,v.props,null,y.mode,x),x.ref=cf(y,b,v),x.return=y,y=x)}return s(y);case bd:e:{for($=v.key;b!==null;){if(b.key===$)if(b.tag===4&&b.stateNode.containerInfo===v.containerInfo&&b.stateNode.implementation===v.implementation){n(y,b.sibling),b=a(b,v.children||[]),b.return=y,y=b;break e}else{n(y,b);break}else t(y,b);b=b.sibling}b=Qw(v,y.mode,x),b.return=y,y=b}return s(y);case Js:return $=v._init,g(y,b,$(v._payload),x)}if(xf(v))return f(y,b,v,x);if(af(v))return m(y,b,v,x);_y(y,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,b!==null&&b.tag===6?(n(y,b.sibling),b=a(b,v),b.return=y,y=b):(n(y,b),b=Zw(v,y.mode,x),b.return=y,y=b),s(y)):n(y,b)}return g}var qd=rM(!0),aM=rM(!1),qm={},Ji=Vo(qm),cm=Vo(qm),dm=Vo(qm);function El(e){if(e===qm)throw Error(ce(174));return e}function TI(e,t){switch(Mt(dm,t),Mt(cm,e),Mt(Ji,qm),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:H1(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=H1(t,e)}Pt(Ji),Mt(Ji,t)}function Kd(){Pt(Ji),Pt(cm),Pt(dm)}function iM(e){El(dm.current);var t=El(Ji.current),n=H1(t,e.type);t!==n&&(Mt(cm,e),Mt(Ji,n))}function NI(e){cm.current===e&&(Pt(Ji),Pt(cm))}var Zt=Vo(0);function jb(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var jw=[];function _I(){for(var e=0;e<jw.length;e++)jw[e]._workInProgressVersionPrimary=null;jw.length=0}var pb=Ps.ReactCurrentDispatcher,Gw=Ps.ReactCurrentBatchConfig,Ul=0,Qt=null,Dn=null,Un=null,Gb=!1,zf=!1,pm=0,zG=0;function fr(){throw Error(ce(321))}function AI(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Ai(e[n],t[n]))return!1;return!0}function RI(e,t,n,r,a,i){if(Ul=i,Qt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,pb.current=e===null||e.memoizedState===null?VG:HG,e=n(r,a),zf){i=0;do{if(zf=!1,pm=0,25<=i)throw Error(ce(301));i+=1,Un=Dn=null,t.updateQueue=null,pb.current=jG,e=n(r,a)}while(zf)}if(pb.current=qb,t=Dn!==null&&Dn.next!==null,Ul=0,Un=Dn=Qt=null,Gb=!1,t)throw Error(ce(300));return e}function DI(){var e=pm!==0;return pm=0,e}function ji(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Un===null?Qt.memoizedState=Un=e:Un=Un.next=e,Un}function ei(){if(Dn===null){var e=Qt.alternate;e=e!==null?e.memoizedState:null}else e=Dn.next;var t=Un===null?Qt.memoizedState:Un.next;if(t!==null)Un=t,Dn=e;else{if(e===null)throw Error(ce(310));Dn=e,e={memoizedState:Dn.memoizedState,baseState:Dn.baseState,baseQueue:Dn.baseQueue,queue:Dn.queue,next:null},Un===null?Qt.memoizedState=Un=e:Un=Un.next=e}return Un}function hm(e,t){return typeof t=="function"?t(e):t}function qw(e){var t=ei(),n=t.queue;if(n===null)throw Error(ce(311));n.lastRenderedReducer=e;var r=Dn,a=r.baseQueue,i=n.pending;if(i!==null){if(a!==null){var s=a.next;a.next=i.next,i.next=s}r.baseQueue=a=i,n.pending=null}if(a!==null){i=a.next,r=r.baseState;var o=s=null,l=null,c=i;do{var u=c.lane;if((Ul&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:e(r,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=d,s=r):l=l.next=d,Qt.lanes|=u,Vl|=u}c=c.next}while(c!==null&&c!==i);l===null?s=r:l.next=o,Ai(r,t.memoizedState)||(aa=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=l,n.lastRenderedState=r}if(e=n.interleaved,e!==null){a=e;do i=a.lane,Qt.lanes|=i,Vl|=i,a=a.next;while(a!==e)}else a===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Kw(e){var t=ei(),n=t.queue;if(n===null)throw Error(ce(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,i=t.memoizedState;if(a!==null){n.pending=null;var s=a=a.next;do i=e(i,s.action),s=s.next;while(s!==a);Ai(i,t.memoizedState)||(aa=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function sM(){}function oM(e,t){var n=Qt,r=ei(),a=t(),i=!Ai(r.memoizedState,a);if(i&&(r.memoizedState=a,aa=!0),r=r.queue,FI(cM.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||Un!==null&&Un.memoizedState.tag&1){if(n.flags|=2048,fm(9,uM.bind(null,n,r,a,t),void 0,null),qn===null)throw Error(ce(349));Ul&30||lM(n,t,a)}return a}function lM(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Qt.updateQueue,t===null?(t={lastEffect:null,stores:null},Qt.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function uM(e,t,n,r){t.value=n,t.getSnapshot=r,dM(t)&&pM(e)}function cM(e,t,n){return n(function(){dM(t)&&pM(e)})}function dM(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Ai(e,n)}catch(r){return!0}}function pM(e){var t=Rs(e,1);t!==null&&Si(t,e,1,-1)}function a_(e){var t=ji();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:hm,lastRenderedState:e},t.queue=e,e=e.dispatch=UG.bind(null,Qt,e),[t.memoizedState,e]}function fm(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Qt.updateQueue,t===null?(t={lastEffect:null,stores:null},Qt.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function hM(){return ei().memoizedState}function hb(e,t,n,r){var a=ji();Qt.flags|=e,a.memoizedState=fm(1|t,n,void 0,r===void 0?null:r)}function o0(e,t,n,r){var a=ei();r=r===void 0?null:r;var i=void 0;if(Dn!==null){var s=Dn.memoizedState;if(i=s.destroy,r!==null&&AI(r,s.deps)){a.memoizedState=fm(t,n,i,r);return}}Qt.flags|=e,a.memoizedState=fm(1|t,n,i,r)}function i_(e,t){return hb(8390656,8,e,t)}function FI(e,t){return o0(2048,8,e,t)}function fM(e,t){return o0(4,2,e,t)}function mM(e,t){return o0(4,4,e,t)}function gM(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function yM(e,t,n){return n=n!=null?n.concat([e]):null,o0(4,4,gM.bind(null,t,e),n)}function MI(){}function bM(e,t){var n=ei();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&AI(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function vM(e,t){var n=ei();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&AI(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function xM(e,t,n){return Ul&21?(Ai(n,t)||(n=SF(),Qt.lanes|=n,Vl|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,aa=!0),e.memoizedState=n)}function BG(e,t){var n=xt;xt=n!==0&&4>n?n:4,e(!0);var r=Gw.transition;Gw.transition={};try{e(!1),t()}finally{xt=n,Gw.transition=r}}function wM(){return ei().memoizedState}function WG(e,t,n){var r=xo(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},kM(e))SM(t,n);else if(n=JF(e,t,n,r),n!==null){var a=Wr();Si(n,e,r,a),IM(n,t,r)}}function UG(e,t,n){var r=xo(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(kM(e))SM(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var s=t.lastRenderedState,o=i(s,n);if(a.hasEagerState=!0,a.eagerState=o,Ai(o,s)){var l=t.interleaved;l===null?(a.next=a,CI(t)):(a.next=l.next,l.next=a),t.interleaved=a;return}}catch(c){}finally{}n=JF(e,t,a,r),n!==null&&(a=Wr(),Si(n,e,r,a),IM(n,t,r))}}function kM(e){var t=e.alternate;return e===Qt||t!==null&&t===Qt}function SM(e,t){zf=Gb=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function IM(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,pI(e,n)}}var qb={readContext:Ja,useCallback:fr,useContext:fr,useEffect:fr,useImperativeHandle:fr,useInsertionEffect:fr,useLayoutEffect:fr,useMemo:fr,useReducer:fr,useRef:fr,useState:fr,useDebugValue:fr,useDeferredValue:fr,useTransition:fr,useMutableSource:fr,useSyncExternalStore:fr,useId:fr,unstable_isNewReconciler:!1},VG={readContext:Ja,useCallback:function(e,t){return ji().memoizedState=[e,t===void 0?null:t],e},useContext:Ja,useEffect:i_,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,hb(4194308,4,gM.bind(null,t,e),n)},useLayoutEffect:function(e,t){return hb(4194308,4,e,t)},useInsertionEffect:function(e,t){return hb(4,2,e,t)},useMemo:function(e,t){var n=ji();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=ji();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=WG.bind(null,Qt,e),[r.memoizedState,e]},useRef:function(e){var t=ji();return e={current:e},t.memoizedState=e},useState:a_,useDebugValue:MI,useDeferredValue:function(e){return ji().memoizedState=e},useTransition:function(){var e=a_(!1),t=e[0];return e=BG.bind(null,e[1]),ji().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Qt,a=ji();if(jt){if(n===void 0)throw Error(ce(407));n=n()}else{if(n=t(),qn===null)throw Error(ce(349));Ul&30||lM(r,t,n)}a.memoizedState=n;var i={value:n,getSnapshot:t};return a.queue=i,i_(cM.bind(null,r,i,e),[e]),r.flags|=2048,fm(9,uM.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=ji(),t=qn.identifierPrefix;if(jt){var n=Is,r=Ss;n=(r&~(1<<32-ki(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=pm++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=zG++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},HG={readContext:Ja,useCallback:bM,useContext:Ja,useEffect:FI,useImperativeHandle:yM,useInsertionEffect:fM,useLayoutEffect:mM,useMemo:vM,useReducer:qw,useRef:hM,useState:function(){return qw(hm)},useDebugValue:MI,useDeferredValue:function(e){var t=ei();return xM(t,Dn.memoizedState,e)},useTransition:function(){var e=qw(hm)[0],t=ei().memoizedState;return[e,t]},useMutableSource:sM,useSyncExternalStore:oM,useId:wM,unstable_isNewReconciler:!1},jG={readContext:Ja,useCallback:bM,useContext:Ja,useEffect:FI,useImperativeHandle:yM,useInsertionEffect:fM,useLayoutEffect:mM,useMemo:vM,useReducer:Kw,useRef:hM,useState:function(){return Kw(hm)},useDebugValue:MI,useDeferredValue:function(e){var t=ei();return Dn===null?t.memoizedState=e:xM(t,Dn.memoizedState,e)},useTransition:function(){var e=Kw(hm)[0],t=ei().memoizedState;return[e,t]},useMutableSource:sM,useSyncExternalStore:oM,useId:wM,unstable_isNewReconciler:!1};function Xd(e,t){try{var n="",r=t;do n+=v6(r),r=r.return;while(r);var a=n}catch(i){a="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:a,digest:null}}function Xw(e,t,n){return{value:e,source:null,stack:n!=null?n:null,digest:t!=null?t:null}}function hk(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var GG=typeof WeakMap=="function"?WeakMap:Map;function $M(e,t,n){n=$s(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Xb||(Xb=!0,Sk=r),hk(e,t)},n}function CM(e,t,n){n=$s(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){hk(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){hk(e,t),typeof r!="function"&&(vo===null?vo=new Set([this]):vo.add(this));var s=t.stack;this.componentDidCatch(t.value,{componentStack:s!==null?s:""})}),n}function s_(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new GG;var a=new Set;r.set(t,a)}else a=r.get(t),a===void 0&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=s5.bind(null,e,t,n),t.then(e,e))}function o_(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function l_(e,t,n,r,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=$s(-1,1),t.tag=2,bo(n,t,1))),n.lanes|=1),e)}var qG=Ps.ReactCurrentOwner,aa=!1;function Lr(e,t,n,r){t.child=e===null?aM(t,null,n,r):qd(t,e.child,n,r)}function u_(e,t,n,r,a){n=n.render;var i=t.ref;return Md(t,a),r=RI(e,t,n,r,i,a),n=DI(),e!==null&&!aa?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Ds(e,t,a)):(jt&&n&&xI(t),t.flags|=1,Lr(e,t,r,a),t.child)}function c_(e,t,n,r,a){if(e===null){var i=n.type;return typeof i=="function"&&!VI(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,EM(e,t,i,r,a)):(e=yb(n.type,null,r,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var s=i.memoizedProps;if(n=n.compare,n=n!==null?n:sm,n(s,r)&&e.ref===t.ref)return Ds(e,t,a)}return t.flags|=1,e=wo(i,r),e.ref=t.ref,e.return=t,t.child=e}function EM(e,t,n,r,a){if(e!==null){var i=e.memoizedProps;if(sm(i,r)&&e.ref===t.ref)if(aa=!1,t.pendingProps=r=i,(e.lanes&a)!==0)e.flags&131072&&(aa=!0);else return t.lanes=e.lanes,Ds(e,t,a)}return fk(e,t,n,r,a)}function TM(e,t,n){var r=t.pendingProps,a=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Mt(Nd,wa),wa|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Mt(Nd,wa),wa|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Mt(Nd,wa),wa|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,Mt(Nd,wa),wa|=r;return Lr(e,t,a,n),t.child}function NM(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function fk(e,t,n,r,a){var i=ua(n)?Bl:kr.current;return i=jd(t,i),Md(t,a),n=RI(e,t,n,r,i,a),r=DI(),e!==null&&!aa?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Ds(e,t,a)):(jt&&r&&xI(t),t.flags|=1,Lr(e,t,n,a),t.child)}function d_(e,t,n,r,a){if(ua(n)){var i=!0;zb(t)}else i=!1;if(Md(t,a),t.stateNode===null)fb(e,t),nM(t,n,r),pk(t,n,r,a),r=!0;else if(e===null){var s=t.stateNode,o=t.memoizedProps;s.props=o;var l=s.context,c=n.contextType;typeof c=="object"&&c!==null?c=Ja(c):(c=ua(n)?Bl:kr.current,c=jd(t,c));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof s.getSnapshotBeforeUpdate=="function";d||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==r||l!==c)&&n_(t,s,r,c),eo=!1;var p=t.memoizedState;s.state=p,Hb(t,r,s,a),l=t.memoizedState,o!==r||p!==l||la.current||eo?(typeof u=="function"&&(dk(t,n,u,r),l=t.memoizedState),(o=eo||t_(t,n,o,r,p,l,c))?(d||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),s.props=r,s.state=l,s.context=c,r=o):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,eM(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:pi(t.type,o),s.props=c,d=t.pendingProps,p=s.context,l=n.contextType,typeof l=="object"&&l!==null?l=Ja(l):(l=ua(n)?Bl:kr.current,l=jd(t,l));var h=n.getDerivedStateFromProps;(u=typeof h=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==d||p!==l)&&n_(t,s,r,l),eo=!1,p=t.memoizedState,s.state=p,Hb(t,r,s,a);var f=t.memoizedState;o!==d||p!==f||la.current||eo?(typeof h=="function"&&(dk(t,n,h,r),f=t.memoizedState),(c=eo||t_(t,n,c,r,p,f,l)||!1)?(u||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,f,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,f,l)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),s.props=r,s.state=f,s.context=l,r=c):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),r=!1)}return mk(e,t,n,r,i,a)}function mk(e,t,n,r,a,i){NM(e,t);var s=(t.flags&128)!==0;if(!r&&!s)return a&&YN(t,n,!1),Ds(e,t,i);r=t.stateNode,qG.current=t;var o=s&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&s?(t.child=qd(t,e.child,null,i),t.child=qd(t,null,o,i)):Lr(e,t,o,i),t.memoizedState=r.state,a&&YN(t,n,!0),t.child}function _M(e){var t=e.stateNode;t.pendingContext?XN(e,t.pendingContext,t.pendingContext!==t.context):t.context&&XN(e,t.context,!1),TI(e,t.containerInfo)}function p_(e,t,n,r,a){return Gd(),kI(a),t.flags|=256,Lr(e,t,n,r),t.child}var gk={dehydrated:null,treeContext:null,retryLane:0};function yk(e){return{baseLanes:e,cachePool:null,transitions:null}}function AM(e,t,n){var r=t.pendingProps,a=Zt.current,i=!1,s=(t.flags&128)!==0,o;if((o=s)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),Mt(Zt,a&1),e===null)return uk(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(s=r.children,e=r.fallback,i?(r=t.mode,i=t.child,s={mode:"hidden",children:s},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=s):i=c0(s,r,0,null),e=Fl(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=yk(n),t.memoizedState=gk,e):OI(t,s));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return KG(e,t,s,r,o,a,n);if(i){i=r.fallback,s=t.mode,a=e.child,o=a.sibling;var l={mode:"hidden",children:r.children};return!(s&1)&&t.child!==a?(r=t.child,r.childLanes=0,r.pendingProps=l,t.deletions=null):(r=wo(a,l),r.subtreeFlags=a.subtreeFlags&14680064),o!==null?i=wo(o,i):(i=Fl(i,s,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,s=e.child.memoizedState,s=s===null?yk(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},i.memoizedState=s,i.childLanes=e.childLanes&~n,t.memoizedState=gk,r}return i=e.child,e=i.sibling,r=wo(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function OI(e,t){return t=c0({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Ay(e,t,n,r){return r!==null&&kI(r),qd(t,e.child,null,n),e=OI(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function KG(e,t,n,r,a,i,s){if(n)return t.flags&256?(t.flags&=-257,r=Xw(Error(ce(422))),Ay(e,t,s,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,a=t.mode,r=c0({mode:"visible",children:r.children},a,0,null),i=Fl(i,a,s,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&qd(t,e.child,null,s),t.child.memoizedState=yk(s),t.memoizedState=gk,i);if(!(t.mode&1))return Ay(e,t,s,null);if(a.data==="$!"){if(r=a.nextSibling&&a.nextSibling.dataset,r)var o=r.dgst;return r=o,i=Error(ce(419)),r=Xw(i,r,void 0),Ay(e,t,s,r)}if(o=(s&e.childLanes)!==0,aa||o){if(r=qn,r!==null){switch(s&-s){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(r.suspendedLanes|s)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,Rs(e,a),Si(r,e,a,-1))}return UI(),r=Xw(Error(ce(421))),Ay(e,t,s,r)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=o5.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,Ia=yo(a.nextSibling),Na=t,jt=!0,mi=null,e!==null&&(Ka[Xa++]=Ss,Ka[Xa++]=Is,Ka[Xa++]=Wl,Ss=e.id,Is=e.overflow,Wl=t),t=OI(t,r.children),t.flags|=4096,t)}function h_(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),ck(e.return,t,n)}function Yw(e,t,n,r,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function RM(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;if(Lr(e,t,r.children,n),r=Zt.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&h_(e,n,t);else if(e.tag===19)h_(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Mt(Zt,r),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;n!==null;)e=n.alternate,e!==null&&jb(e)===null&&(a=n),n=n.sibling;n=a,n===null?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),Yw(t,!1,a,n,i);break;case"backwards":for(n=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&jb(e)===null){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}Yw(t,!0,n,null,i);break;case"together":Yw(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function fb(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ds(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Vl|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ce(153));if(t.child!==null){for(e=t.child,n=wo(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=wo(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function XG(e,t,n){switch(t.tag){case 3:_M(t),Gd();break;case 5:iM(t);break;case 1:ua(t.type)&&zb(t);break;case 4:TI(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;Mt(Ub,r._currentValue),r._currentValue=a;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Mt(Zt,Zt.current&1),t.flags|=128,null):n&t.child.childLanes?AM(e,t,n):(Mt(Zt,Zt.current&1),e=Ds(e,t,n),e!==null?e.sibling:null);Mt(Zt,Zt.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return RM(e,t,n);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Mt(Zt,Zt.current),r)break;return null;case 22:case 23:return t.lanes=0,TM(e,t,n)}return Ds(e,t,n)}var DM,bk,FM,MM;DM=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};bk=function(){};FM=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,El(Ji.current);var i=null;switch(n){case"input":a=B1(e,a),r=B1(e,r),i=[];break;case"select":a=Jt({},a,{value:void 0}),r=Jt({},r,{value:void 0}),i=[];break;case"textarea":a=V1(e,a),r=V1(e,r),i=[];break;default:typeof a.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Lb)}j1(n,r);var s;n=null;for(c in a)if(!r.hasOwnProperty(c)&&a.hasOwnProperty(c)&&a[c]!=null)if(c==="style"){var o=a[c];for(s in o)o.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Jf.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in r){var l=r[c];if(o=a!=null?a[c]:void 0,r.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(s in o)!o.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in l)l.hasOwnProperty(s)&&o[s]!==l[s]&&(n||(n={}),n[s]=l[s])}else n||(i||(i=[]),i.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Jf.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Lt("scroll",e),i||o===l||(i=[])):(i=i||[]).push(c,l))}n&&(i=i||[]).push("style",n);var c=i;(t.updateQueue=c)&&(t.flags|=4)}};MM=function(e,t,n,r){n!==r&&(t.flags|=4)};function df(e,t){if(!jt)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function mr(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags&14680064,r|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function YG(e,t,n){var r=t.pendingProps;switch(wI(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return mr(t),null;case 1:return ua(t.type)&&Pb(),mr(t),null;case 3:return r=t.stateNode,Kd(),Pt(la),Pt(kr),_I(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Ny(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,mi!==null&&(Ck(mi),mi=null))),bk(e,t),mr(t),null;case 5:NI(t);var a=El(dm.current);if(n=t.type,e!==null&&t.stateNode!=null)FM(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(ce(166));return mr(t),null}if(e=El(Ji.current),Ny(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[Yi]=t,r[um]=i,e=(t.mode&1)!==0,n){case"dialog":Lt("cancel",r),Lt("close",r);break;case"iframe":case"object":case"embed":Lt("load",r);break;case"video":case"audio":for(a=0;a<kf.length;a++)Lt(kf[a],r);break;case"source":Lt("error",r);break;case"img":case"image":case"link":Lt("error",r),Lt("load",r);break;case"details":Lt("toggle",r);break;case"input":kN(r,i),Lt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Lt("invalid",r);break;case"textarea":IN(r,i),Lt("invalid",r)}j1(n,i),a=null;for(var s in i)if(i.hasOwnProperty(s)){var o=i[s];s==="children"?typeof o=="string"?r.textContent!==o&&(i.suppressHydrationWarning!==!0&&Ty(r.textContent,o,e),a=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&Ty(r.textContent,o,e),a=["children",""+o]):Jf.hasOwnProperty(s)&&o!=null&&s==="onScroll"&&Lt("scroll",r)}switch(n){case"input":xy(r),SN(r,i,!0);break;case"textarea":xy(r),$N(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Lb)}r=a,t.updateQueue=r,r!==null&&(t.flags|=4)}else{s=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=lF(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=s.createElement(n,{is:r.is}):(e=s.createElement(n),n==="select"&&(s=e,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):e=s.createElementNS(e,n),e[Yi]=t,e[um]=r,DM(e,t,!1,!1),t.stateNode=e;e:{switch(s=G1(n,r),n){case"dialog":Lt("cancel",e),Lt("close",e),a=r;break;case"iframe":case"object":case"embed":Lt("load",e),a=r;break;case"video":case"audio":for(a=0;a<kf.length;a++)Lt(kf[a],e);a=r;break;case"source":Lt("error",e),a=r;break;case"img":case"image":case"link":Lt("error",e),Lt("load",e),a=r;break;case"details":Lt("toggle",e),a=r;break;case"input":kN(e,r),a=B1(e,r),Lt("invalid",e);break;case"option":a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=Jt({},r,{value:void 0}),Lt("invalid",e);break;case"textarea":IN(e,r),a=V1(e,r),Lt("invalid",e);break;default:a=r}j1(n,a),o=a;for(i in o)if(o.hasOwnProperty(i)){var l=o[i];i==="style"?dF(e,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&uF(e,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&em(e,l):typeof l=="number"&&em(e,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Jf.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Lt("scroll",e):l!=null&&sI(e,i,l,s))}switch(n){case"input":xy(e),SN(e,r,!1);break;case"textarea":xy(e),$N(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Co(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?Ad(e,!!r.multiple,i,!1):r.defaultValue!=null&&Ad(e,!!r.multiple,r.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Lb)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return mr(t),null;case 6:if(e&&t.stateNode!=null)MM(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(ce(166));if(n=El(dm.current),El(Ji.current),Ny(t)){if(r=t.stateNode,n=t.memoizedProps,r[Yi]=t,(i=r.nodeValue!==n)&&(e=Na,e!==null))switch(e.tag){case 3:Ty(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Ty(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Yi]=t,t.stateNode=r}return mr(t),null;case 13:if(Pt(Zt),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(jt&&Ia!==null&&t.mode&1&&!(t.flags&128))QF(),Gd(),t.flags|=98560,i=!1;else if(i=Ny(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(ce(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(ce(317));i[Yi]=t}else Gd(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;mr(t),i=!1}else mi!==null&&(Ck(mi),mi=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Zt.current&1?On===0&&(On=3):UI())),t.updateQueue!==null&&(t.flags|=4),mr(t),null);case 4:return Kd(),bk(e,t),e===null&&om(t.stateNode.containerInfo),mr(t),null;case 10:return $I(t.type._context),mr(t),null;case 17:return ua(t.type)&&Pb(),mr(t),null;case 19:if(Pt(Zt),i=t.memoizedState,i===null)return mr(t),null;if(r=(t.flags&128)!==0,s=i.rendering,s===null)if(r)df(i,!1);else{if(On!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=jb(e),s!==null){for(t.flags|=128,df(i,!1),r=s.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,s=i.alternate,s===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=s.childLanes,i.lanes=s.lanes,i.child=s.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=s.memoizedProps,i.memoizedState=s.memoizedState,i.updateQueue=s.updateQueue,i.type=s.type,e=s.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Mt(Zt,Zt.current&1|2),t.child}e=e.sibling}i.tail!==null&&cn()>Yd&&(t.flags|=128,r=!0,df(i,!1),t.lanes=4194304)}else{if(!r)if(e=jb(s),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),df(i,!0),i.tail===null&&i.tailMode==="hidden"&&!s.alternate&&!jt)return mr(t),null}else 2*cn()-i.renderingStartTime>Yd&&n!==1073741824&&(t.flags|=128,r=!0,df(i,!1),t.lanes=4194304);i.isBackwards?(s.sibling=t.child,t.child=s):(n=i.last,n!==null?n.sibling=s:t.child=s,i.last=s)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=cn(),t.sibling=null,n=Zt.current,Mt(Zt,r?n&1|2:n&1),t):(mr(t),null);case 22:case 23:return WI(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?wa&1073741824&&(mr(t),t.subtreeFlags&6&&(t.flags|=8192)):mr(t),null;case 24:return null;case 25:return null}throw Error(ce(156,t.tag))}function ZG(e,t){switch(wI(t),t.tag){case 1:return ua(t.type)&&Pb(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Kd(),Pt(la),Pt(kr),_I(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return NI(t),null;case 13:if(Pt(Zt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ce(340));Gd()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Pt(Zt),null;case 4:return Kd(),null;case 10:return $I(t.type._context),null;case 22:case 23:return WI(),null;case 24:return null;default:return null}}var Ry=!1,yr=!1,QG=typeof WeakSet=="function"?WeakSet:Set,Ie=null;function Td(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){tn(e,t,r)}else n.current=null}function vk(e,t,n){try{n()}catch(r){tn(e,t,r)}}var f_=!1;function JG(e,t){if(nk=Fb,e=zF(),vI(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var a=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch(x){n=null;break e}var s=0,o=-1,l=-1,c=0,u=0,d=e,p=null;t:for(;;){for(var h;d!==n||a!==0&&d.nodeType!==3||(o=s+a),d!==i||r!==0&&d.nodeType!==3||(l=s+r),d.nodeType===3&&(s+=d.nodeValue.length),(h=d.firstChild)!==null;)p=d,d=h;for(;;){if(d===e)break t;if(p===n&&++c===a&&(o=s),p===i&&++u===r&&(l=s),(h=d.nextSibling)!==null)break;d=p,p=d.parentNode}d=h}n=o===-1||l===-1?null:{start:o,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(rk={focusedElem:e,selectionRange:n},Fb=!1,Ie=t;Ie!==null;)if(t=Ie,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ie=e;else for(;Ie!==null;){t=Ie;try{var f=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(f!==null){var m=f.memoizedProps,g=f.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?m:pi(t.type,m),g);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var v=t.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ce(163))}}catch(x){tn(t,t.return,x)}if(e=t.sibling,e!==null){e.return=t.return,Ie=e;break}Ie=t.return}return f=f_,f_=!1,f}function Bf(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var a=r=r.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&vk(t,n,i)}a=a.next}while(a!==r)}}function l0(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function xk(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function OM(e){var t=e.alternate;t!==null&&(e.alternate=null,OM(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Yi],delete t[um],delete t[sk],delete t[MG],delete t[OG])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function LM(e){return e.tag===5||e.tag===3||e.tag===4}function m_(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||LM(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function wk(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Lb));else if(r!==4&&(e=e.child,e!==null))for(wk(e,t,n),e=e.sibling;e!==null;)wk(e,t,n),e=e.sibling}function kk(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(kk(e,t,n),e=e.sibling;e!==null;)kk(e,t,n),e=e.sibling}var nr=null,fi=!1;function Ks(e,t,n){for(n=n.child;n!==null;)PM(e,t,n),n=n.sibling}function PM(e,t,n){if(Qi&&typeof Qi.onCommitFiberUnmount=="function")try{Qi.onCommitFiberUnmount(e0,n)}catch(o){}switch(n.tag){case 5:yr||Td(n,t);case 6:var r=nr,a=fi;nr=null,Ks(e,t,n),nr=r,fi=a,nr!==null&&(fi?(e=nr,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):nr.removeChild(n.stateNode));break;case 18:nr!==null&&(fi?(e=nr,n=n.stateNode,e.nodeType===8?Vw(e.parentNode,n):e.nodeType===1&&Vw(e,n),am(e)):Vw(nr,n.stateNode));break;case 4:r=nr,a=fi,nr=n.stateNode.containerInfo,fi=!0,Ks(e,t,n),nr=r,fi=a;break;case 0:case 11:case 14:case 15:if(!yr&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){a=r=r.next;do{var i=a,s=i.destroy;i=i.tag,s!==void 0&&(i&2||i&4)&&vk(n,t,s),a=a.next}while(a!==r)}Ks(e,t,n);break;case 1:if(!yr&&(Td(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){tn(n,t,o)}Ks(e,t,n);break;case 21:Ks(e,t,n);break;case 22:n.mode&1?(yr=(r=yr)||n.memoizedState!==null,Ks(e,t,n),yr=r):Ks(e,t,n);break;default:Ks(e,t,n)}}function g_(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new QG),t.forEach(function(r){var a=l5.bind(null,e,r);n.has(r)||(n.add(r),r.then(a,a))})}}function ui(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var a=n[r];try{var i=e,s=t,o=s;e:for(;o!==null;){switch(o.tag){case 5:nr=o.stateNode,fi=!1;break e;case 3:nr=o.stateNode.containerInfo,fi=!0;break e;case 4:nr=o.stateNode.containerInfo,fi=!0;break e}o=o.return}if(nr===null)throw Error(ce(160));PM(i,s,a),nr=null,fi=!1;var l=a.alternate;l!==null&&(l.return=null),a.return=null}catch(c){tn(a,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)zM(t,e),t=t.sibling}function zM(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ui(t,e),Ui(e),r&4){try{Bf(3,e,e.return),l0(3,e)}catch(m){tn(e,e.return,m)}try{Bf(5,e,e.return)}catch(m){tn(e,e.return,m)}}break;case 1:ui(t,e),Ui(e),r&512&&n!==null&&Td(n,n.return);break;case 5:if(ui(t,e),Ui(e),r&512&&n!==null&&Td(n,n.return),e.flags&32){var a=e.stateNode;try{em(a,"")}catch(m){tn(e,e.return,m)}}if(r&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,s=n!==null?n.memoizedProps:i,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&sF(a,i),G1(o,s);var c=G1(o,i);for(s=0;s<l.length;s+=2){var u=l[s],d=l[s+1];u==="style"?dF(a,d):u==="dangerouslySetInnerHTML"?uF(a,d):u==="children"?em(a,d):sI(a,u,d,c)}switch(o){case"input":W1(a,i);break;case"textarea":oF(a,i);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var h=i.value;h!=null?Ad(a,!!i.multiple,h,!1):p!==!!i.multiple&&(i.defaultValue!=null?Ad(a,!!i.multiple,i.defaultValue,!0):Ad(a,!!i.multiple,i.multiple?[]:"",!1))}a[um]=i}catch(m){tn(e,e.return,m)}}break;case 6:if(ui(t,e),Ui(e),r&4){if(e.stateNode===null)throw Error(ce(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(m){tn(e,e.return,m)}}break;case 3:if(ui(t,e),Ui(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{am(t.containerInfo)}catch(m){tn(e,e.return,m)}break;case 4:ui(t,e),Ui(e);break;case 13:ui(t,e),Ui(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(zI=cn())),r&4&&g_(e);break;case 22:if(u=n!==null&&n.memoizedState!==null,e.mode&1?(yr=(c=yr)||u,ui(t,e),yr=c):ui(t,e),Ui(e),r&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(Ie=e,u=e.child;u!==null;){for(d=Ie=u;Ie!==null;){switch(p=Ie,h=p.child,p.tag){case 0:case 11:case 14:case 15:Bf(4,p,p.return);break;case 1:Td(p,p.return);var f=p.stateNode;if(typeof f.componentWillUnmount=="function"){r=p,n=p.return;try{t=r,f.props=t.memoizedProps,f.state=t.memoizedState,f.componentWillUnmount()}catch(m){tn(r,n,m)}}break;case 5:Td(p,p.return);break;case 22:if(p.memoizedState!==null){b_(d);continue}}h!==null?(h.return=p,Ie=h):b_(d)}u=u.sibling}e:for(u=null,d=e;;){if(d.tag===5){if(u===null){u=d;try{a=d.stateNode,c?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=d.stateNode,l=d.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=cF("display",s))}catch(m){tn(e,e.return,m)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(m){tn(e,e.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ui(t,e),Ui(e),r&4&&g_(e);break;case 21:break;default:ui(t,e),Ui(e)}}function Ui(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(LM(n)){var r=n;break e}n=n.return}throw Error(ce(160))}switch(r.tag){case 5:var a=r.stateNode;r.flags&32&&(em(a,""),r.flags&=-33);var i=m_(e);kk(e,i,a);break;case 3:case 4:var s=r.stateNode.containerInfo,o=m_(e);wk(e,o,s);break;default:throw Error(ce(161))}}catch(l){tn(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function e5(e,t,n){Ie=e,BM(e)}function BM(e,t,n){for(var r=(e.mode&1)!==0;Ie!==null;){var a=Ie,i=a.child;if(a.tag===22&&r){var s=a.memoizedState!==null||Ry;if(!s){var o=a.alternate,l=o!==null&&o.memoizedState!==null||yr;o=Ry;var c=yr;if(Ry=s,(yr=l)&&!c)for(Ie=a;Ie!==null;)s=Ie,l=s.child,s.tag===22&&s.memoizedState!==null?v_(a):l!==null?(l.return=s,Ie=l):v_(a);for(;i!==null;)Ie=i,BM(i),i=i.sibling;Ie=a,Ry=o,yr=c}y_(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,Ie=i):y_(e)}}function y_(e){for(;Ie!==null;){var t=Ie;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:yr||l0(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!yr)if(n===null)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:pi(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&e_(t,i,r);break;case 3:var s=t.updateQueue;if(s!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}e_(t,s,n)}break;case 5:var o=t.stateNode;if(n===null&&t.flags&4){n=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&am(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ce(163))}yr||t.flags&512&&xk(t)}catch(p){tn(t,t.return,p)}}if(t===e){Ie=null;break}if(n=t.sibling,n!==null){n.return=t.return,Ie=n;break}Ie=t.return}}function b_(e){for(;Ie!==null;){var t=Ie;if(t===e){Ie=null;break}var n=t.sibling;if(n!==null){n.return=t.return,Ie=n;break}Ie=t.return}}function v_(e){for(;Ie!==null;){var t=Ie;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{l0(4,t)}catch(l){tn(t,n,l)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var a=t.return;try{r.componentDidMount()}catch(l){tn(t,a,l)}}var i=t.return;try{xk(t)}catch(l){tn(t,i,l)}break;case 5:var s=t.return;try{xk(t)}catch(l){tn(t,s,l)}}}catch(l){tn(t,t.return,l)}if(t===e){Ie=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Ie=o;break}Ie=t.return}}var t5=Math.ceil,Kb=Ps.ReactCurrentDispatcher,LI=Ps.ReactCurrentOwner,Za=Ps.ReactCurrentBatchConfig,dt=0,qn=null,xn=null,ar=0,wa=0,Nd=Vo(0),On=0,mm=null,Vl=0,u0=0,PI=0,Wf=null,na=null,zI=0,Yd=1/0,ms=null,Xb=!1,Sk=null,vo=null,Dy=!1,so=null,Yb=0,Uf=0,Ik=null,mb=-1,gb=0;function Wr(){return dt&6?cn():mb!==-1?mb:mb=cn()}function xo(e){return e.mode&1?dt&2&&ar!==0?ar&-ar:PG.transition!==null?(gb===0&&(gb=SF()),gb):(e=xt,e!==0||(e=window.event,e=e===void 0?16:_F(e.type)),e):1}function Si(e,t,n,r){if(50<Uf)throw Uf=0,Ik=null,Error(ce(185));Hm(e,n,r),(!(dt&2)||e!==qn)&&(e===qn&&(!(dt&2)&&(u0|=n),On===4&&ro(e,ar)),ca(e,r),n===1&&dt===0&&!(t.mode&1)&&(Yd=cn()+500,i0&&Ho()))}function ca(e,t){var n=e.callbackNode;P6(e,t);var r=Db(e,e===qn?ar:0);if(r===0)n!==null&&TN(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&TN(n),t===1)e.tag===0?LG(x_.bind(null,e)):XF(x_.bind(null,e)),DG(function(){!(dt&6)&&Ho()}),n=null;else{switch(IF(r)){case 1:n=dI;break;case 4:n=wF;break;case 16:n=Rb;break;case 536870912:n=kF;break;default:n=Rb}n=KM(n,WM.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function WM(e,t){if(mb=-1,gb=0,dt&6)throw Error(ce(327));var n=e.callbackNode;if(Od()&&e.callbackNode!==n)return null;var r=Db(e,e===qn?ar:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Zb(e,r);else{t=r;var a=dt;dt|=2;var i=VM();(qn!==e||ar!==t)&&(ms=null,Yd=cn()+500,Dl(e,t));do try{a5();break}catch(o){UM(e,o)}while(1);II(),Kb.current=i,dt=a,xn!==null?t=0:(qn=null,ar=0,t=On)}if(t!==0){if(t===2&&(a=Z1(e),a!==0&&(r=a,t=$k(e,a))),t===1)throw n=mm,Dl(e,0),ro(e,r),ca(e,cn()),n;if(t===6)ro(e,r);else{if(a=e.current.alternate,!(r&30)&&!n5(a)&&(t=Zb(e,r),t===2&&(i=Z1(e),i!==0&&(r=i,t=$k(e,i))),t===1))throw n=mm,Dl(e,0),ro(e,r),ca(e,cn()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(ce(345));case 2:ml(e,na,ms);break;case 3:if(ro(e,r),(r&130023424)===r&&(t=zI+500-cn(),10<t)){if(Db(e,0)!==0)break;if(a=e.suspendedLanes,(a&r)!==r){Wr(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=ik(ml.bind(null,e,na,ms),t);break}ml(e,na,ms);break;case 4:if(ro(e,r),(r&4194240)===r)break;for(t=e.eventTimes,a=-1;0<r;){var s=31-ki(r);i=1<<s,s=t[s],s>a&&(a=s),r&=~i}if(r=a,r=cn()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*t5(r/1960))-r,10<r){e.timeoutHandle=ik(ml.bind(null,e,na,ms),r);break}ml(e,na,ms);break;case 5:ml(e,na,ms);break;default:throw Error(ce(329))}}}return ca(e,cn()),e.callbackNode===n?WM.bind(null,e):null}function $k(e,t){var n=Wf;return e.current.memoizedState.isDehydrated&&(Dl(e,t).flags|=256),e=Zb(e,t),e!==2&&(t=na,na=n,t!==null&&Ck(t)),e}function Ck(e){na===null?na=e:na.push.apply(na,e)}function n5(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!Ai(i(),a))return!1}catch(s){return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ro(e,t){for(t&=~PI,t&=~u0,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ki(t),r=1<<n;e[n]=-1,t&=~r}}function x_(e){if(dt&6)throw Error(ce(327));Od();var t=Db(e,0);if(!(t&1))return ca(e,cn()),null;var n=Zb(e,t);if(e.tag!==0&&n===2){var r=Z1(e);r!==0&&(t=r,n=$k(e,r))}if(n===1)throw n=mm,Dl(e,0),ro(e,t),ca(e,cn()),n;if(n===6)throw Error(ce(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ml(e,na,ms),ca(e,cn()),null}function BI(e,t){var n=dt;dt|=1;try{return e(t)}finally{dt=n,dt===0&&(Yd=cn()+500,i0&&Ho())}}function Hl(e){so!==null&&so.tag===0&&!(dt&6)&&Od();var t=dt;dt|=1;var n=Za.transition,r=xt;try{if(Za.transition=null,xt=1,e)return e()}finally{xt=r,Za.transition=n,dt=t,!(dt&6)&&Ho()}}function WI(){wa=Nd.current,Pt(Nd)}function Dl(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,RG(n)),xn!==null)for(n=xn.return;n!==null;){var r=n;switch(wI(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Pb();break;case 3:Kd(),Pt(la),Pt(kr),_I();break;case 5:NI(r);break;case 4:Kd();break;case 13:Pt(Zt);break;case 19:Pt(Zt);break;case 10:$I(r.type._context);break;case 22:case 23:WI()}n=n.return}if(qn=e,xn=e=wo(e.current,null),ar=wa=t,On=0,mm=null,PI=u0=Vl=0,na=Wf=null,Cl!==null){for(t=0;t<Cl.length;t++)if(n=Cl[t],r=n.interleaved,r!==null){n.interleaved=null;var a=r.next,i=n.pending;if(i!==null){var s=i.next;i.next=a,r.next=s}n.pending=r}Cl=null}return e}function UM(e,t){do{var n=xn;try{if(II(),pb.current=qb,Gb){for(var r=Qt.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}Gb=!1}if(Ul=0,Un=Dn=Qt=null,zf=!1,pm=0,LI.current=null,n===null||n.return===null){On=1,mm=t,xn=null;break}e:{var i=e,s=n.return,o=n,l=t;if(t=ar,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=o_(s);if(h!==null){h.flags&=-257,l_(h,s,o,i,t),h.mode&1&&s_(i,c,t),t=h,l=c;var f=t.updateQueue;if(f===null){var m=new Set;m.add(l),t.updateQueue=m}else f.add(l);break e}else{if(!(t&1)){s_(i,c,t),UI();break e}l=Error(ce(426))}}else if(jt&&o.mode&1){var g=o_(s);if(g!==null){!(g.flags&65536)&&(g.flags|=256),l_(g,s,o,i,t),kI(Xd(l,o));break e}}i=l=Xd(l,o),On!==4&&(On=2),Wf===null?Wf=[i]:Wf.push(i),i=s;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var y=$M(i,l,t);JN(i,y);break e;case 1:o=l;var b=i.type,v=i.stateNode;if(!(i.flags&128)&&(typeof b.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(vo===null||!vo.has(v)))){i.flags|=65536,t&=-t,i.lanes|=t;var x=CM(i,o,t);JN(i,x);break e}}i=i.return}while(i!==null)}jM(n)}catch(w){t=w,xn===n&&n!==null&&(xn=n=n.return);continue}break}while(1)}function VM(){var e=Kb.current;return Kb.current=qb,e===null?qb:e}function UI(){(On===0||On===3||On===2)&&(On=4),qn===null||!(Vl&268435455)&&!(u0&268435455)||ro(qn,ar)}function Zb(e,t){var n=dt;dt|=2;var r=VM();(qn!==e||ar!==t)&&(ms=null,Dl(e,t));do try{r5();break}catch(a){UM(e,a)}while(1);if(II(),dt=n,Kb.current=r,xn!==null)throw Error(ce(261));return qn=null,ar=0,On}function r5(){for(;xn!==null;)HM(xn)}function a5(){for(;xn!==null&&!N6();)HM(xn)}function HM(e){var t=qM(e.alternate,e,wa);e.memoizedProps=e.pendingProps,t===null?jM(e):xn=t,LI.current=null}function jM(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=ZG(n,t),n!==null){n.flags&=32767,xn=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{On=6,xn=null;return}}else if(n=YG(n,t,wa),n!==null){xn=n;return}if(t=t.sibling,t!==null){xn=t;return}xn=t=e}while(t!==null);On===0&&(On=5)}function ml(e,t,n){var r=xt,a=Za.transition;try{Za.transition=null,xt=1,i5(e,t,n,r)}finally{Za.transition=a,xt=r}return null}function i5(e,t,n,r){do Od();while(so!==null);if(dt&6)throw Error(ce(327));n=e.finishedWork;var a=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(ce(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(z6(e,i),e===qn&&(xn=qn=null,ar=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Dy||(Dy=!0,KM(Rb,function(){return Od(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Za.transition,Za.transition=null;var s=xt;xt=1;var o=dt;dt|=4,LI.current=null,JG(e,n),zM(n,e),$G(rk),Fb=!!nk,rk=nk=null,e.current=n,e5(n),_6(),dt=o,xt=s,Za.transition=i}else e.current=n;if(Dy&&(Dy=!1,so=e,Yb=a),i=e.pendingLanes,i===0&&(vo=null),D6(n.stateNode),ca(e,cn()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(Xb)throw Xb=!1,e=Sk,Sk=null,e;return Yb&1&&e.tag!==0&&Od(),i=e.pendingLanes,i&1?e===Ik?Uf++:(Uf=0,Ik=e):Uf=0,Ho(),null}function Od(){if(so!==null){var e=IF(Yb),t=Za.transition,n=xt;try{if(Za.transition=null,xt=16>e?16:e,so===null)var r=!1;else{if(e=so,so=null,Yb=0,dt&6)throw Error(ce(331));var a=dt;for(dt|=4,Ie=e.current;Ie!==null;){var i=Ie,s=i.child;if(Ie.flags&16){var o=i.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(Ie=c;Ie!==null;){var u=Ie;switch(u.tag){case 0:case 11:case 15:Bf(8,u,i)}var d=u.child;if(d!==null)d.return=u,Ie=d;else for(;Ie!==null;){u=Ie;var p=u.sibling,h=u.return;if(OM(u),u===c){Ie=null;break}if(p!==null){p.return=h,Ie=p;break}Ie=h}}}var f=i.alternate;if(f!==null){var m=f.child;if(m!==null){f.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(m!==null)}}Ie=i}}if(i.subtreeFlags&2064&&s!==null)s.return=i,Ie=s;else e:for(;Ie!==null;){if(i=Ie,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Bf(9,i,i.return)}var y=i.sibling;if(y!==null){y.return=i.return,Ie=y;break e}Ie=i.return}}var b=e.current;for(Ie=b;Ie!==null;){s=Ie;var v=s.child;if(s.subtreeFlags&2064&&v!==null)v.return=s,Ie=v;else e:for(s=b;Ie!==null;){if(o=Ie,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:l0(9,o)}}catch(w){tn(o,o.return,w)}if(o===s){Ie=null;break e}var x=o.sibling;if(x!==null){x.return=o.return,Ie=x;break e}Ie=o.return}}if(dt=a,Ho(),Qi&&typeof Qi.onPostCommitFiberRoot=="function")try{Qi.onPostCommitFiberRoot(e0,e)}catch(w){}r=!0}return r}finally{xt=n,Za.transition=t}}return!1}function w_(e,t,n){t=Xd(n,t),t=$M(e,t,1),e=bo(e,t,1),t=Wr(),e!==null&&(Hm(e,1,t),ca(e,t))}function tn(e,t,n){if(e.tag===3)w_(e,e,n);else for(;t!==null;){if(t.tag===3){w_(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(vo===null||!vo.has(r))){e=Xd(n,e),e=CM(t,e,1),t=bo(t,e,1),e=Wr(),t!==null&&(Hm(t,1,e),ca(t,e));break}}t=t.return}}function s5(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Wr(),e.pingedLanes|=e.suspendedLanes&n,qn===e&&(ar&n)===n&&(On===4||On===3&&(ar&130023424)===ar&&500>cn()-zI?Dl(e,0):PI|=n),ca(e,t)}function GM(e,t){t===0&&(e.mode&1?(t=Sy,Sy<<=1,!(Sy&130023424)&&(Sy=4194304)):t=1);var n=Wr();e=Rs(e,t),e!==null&&(Hm(e,t,n),ca(e,n))}function o5(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),GM(e,n)}function l5(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;a!==null&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(ce(314))}r!==null&&r.delete(t),GM(e,n)}var qM;qM=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||la.current)aa=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return aa=!1,XG(e,t,n);aa=!!(e.flags&131072)}else aa=!1,jt&&t.flags&1048576&&YF(t,Wb,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;fb(e,t),e=t.pendingProps;var a=jd(t,kr.current);Md(t,n),a=RI(null,t,r,e,a,n);var i=DI();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,ua(r)?(i=!0,zb(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,EI(t),a.updater=s0,t.stateNode=a,a._reactInternals=t,pk(t,r,e,n),t=mk(null,t,r,!0,i,n)):(t.tag=0,jt&&i&&xI(t),Lr(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(fb(e,t),e=t.pendingProps,a=r._init,r=a(r._payload),t.type=r,a=t.tag=c5(r),e=pi(r,e),a){case 0:t=fk(null,t,r,e,n);break e;case 1:t=d_(null,t,r,e,n);break e;case 11:t=u_(null,t,r,e,n);break e;case 14:t=c_(null,t,r,pi(r.type,e),n);break e}throw Error(ce(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:pi(r,a),fk(e,t,r,a,n);case 1:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:pi(r,a),d_(e,t,r,a,n);case 3:e:{if(_M(t),e===null)throw Error(ce(387));r=t.pendingProps,i=t.memoizedState,a=i.element,eM(e,t),Hb(t,r,null,n);var s=t.memoizedState;if(r=s.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=Xd(Error(ce(423)),t),t=p_(e,t,r,n,a);break e}else if(r!==a){a=Xd(Error(ce(424)),t),t=p_(e,t,r,n,a);break e}else for(Ia=yo(t.stateNode.containerInfo.firstChild),Na=t,jt=!0,mi=null,n=aM(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Gd(),r===a){t=Ds(e,t,n);break e}Lr(e,t,r,n)}t=t.child}return t;case 5:return iM(t),e===null&&uk(t),r=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,s=a.children,ak(r,a)?s=null:i!==null&&ak(r,i)&&(t.flags|=32),NM(e,t),Lr(e,t,s,n),t.child;case 6:return e===null&&uk(t),null;case 13:return AM(e,t,n);case 4:return TI(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=qd(t,null,r,n):Lr(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:pi(r,a),u_(e,t,r,a,n);case 7:return Lr(e,t,t.pendingProps,n),t.child;case 8:return Lr(e,t,t.pendingProps.children,n),t.child;case 12:return Lr(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,i=t.memoizedProps,s=a.value,Mt(Ub,r._currentValue),r._currentValue=s,i!==null)if(Ai(i.value,s)){if(i.children===a.children&&!la.current){t=Ds(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var o=i.dependencies;if(o!==null){s=i.child;for(var l=o.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=$s(-1,n&-n),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),ck(i.return,n,t),o.lanes|=n;break}l=l.next}}else if(i.tag===10)s=i.type===t.type?null:i.child;else if(i.tag===18){if(s=i.return,s===null)throw Error(ce(341));s.lanes|=n,o=s.alternate,o!==null&&(o.lanes|=n),ck(s,n,t),s=i.sibling}else s=i.child;if(s!==null)s.return=i;else for(s=i;s!==null;){if(s===t){s=null;break}if(i=s.sibling,i!==null){i.return=s.return,s=i;break}s=s.return}i=s}Lr(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,Md(t,n),a=Ja(a),r=r(a),t.flags|=1,Lr(e,t,r,n),t.child;case 14:return r=t.type,a=pi(r,t.pendingProps),a=pi(r.type,a),c_(e,t,r,a,n);case 15:return EM(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:pi(r,a),fb(e,t),t.tag=1,ua(r)?(e=!0,zb(t)):e=!1,Md(t,n),nM(t,r,a),pk(t,r,a,n),mk(null,t,r,!0,e,n);case 19:return RM(e,t,n);case 22:return TM(e,t,n)}throw Error(ce(156,t.tag))};function KM(e,t){return xF(e,t)}function u5(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ya(e,t,n,r){return new u5(e,t,n,r)}function VI(e){return e=e.prototype,!(!e||!e.isReactComponent)}function c5(e){if(typeof e=="function")return VI(e)?1:0;if(e!=null){if(e=e.$$typeof,e===lI)return 11;if(e===uI)return 14}return 2}function wo(e,t){var n=e.alternate;return n===null?(n=Ya(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function yb(e,t,n,r,a,i){var s=2;if(r=e,typeof e=="function")VI(e)&&(s=1);else if(typeof e=="string")s=5;else e:switch(e){case vd:return Fl(n.children,a,i,t);case oI:s=8,a|=8;break;case O1:return e=Ya(12,n,t,a|2),e.elementType=O1,e.lanes=i,e;case L1:return e=Ya(13,n,t,a),e.elementType=L1,e.lanes=i,e;case P1:return e=Ya(19,n,t,a),e.elementType=P1,e.lanes=i,e;case rF:return c0(n,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case tF:s=10;break e;case nF:s=9;break e;case lI:s=11;break e;case uI:s=14;break e;case Js:s=16,r=null;break e}throw Error(ce(130,e==null?e:typeof e,""))}return t=Ya(s,n,t,a),t.elementType=e,t.type=r,t.lanes=i,t}function Fl(e,t,n,r){return e=Ya(7,e,r,t),e.lanes=n,e}function c0(e,t,n,r){return e=Ya(22,e,r,t),e.elementType=rF,e.lanes=n,e.stateNode={isHidden:!1},e}function Zw(e,t,n){return e=Ya(6,e,null,t),e.lanes=n,e}function Qw(e,t,n){return t=Ya(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function d5(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Rw(0),this.expirationTimes=Rw(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Rw(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function HI(e,t,n,r,a,i,s,o,l){return e=new d5(e,t,n,o,l),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Ya(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},EI(i),e}function p5(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:bd,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function XM(e){if(!e)return Eo;e=e._reactInternals;e:{if(yu(e)!==e||e.tag!==1)throw Error(ce(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(ua(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ce(171))}if(e.tag===1){var n=e.type;if(ua(n))return KF(e,n,t)}return t}function YM(e,t,n,r,a,i,s,o,l){return e=HI(n,r,!0,e,a,i,s,o,l),e.context=XM(null),n=e.current,r=Wr(),a=xo(n),i=$s(r,a),i.callback=t!=null?t:null,bo(n,i,a),e.current.lanes=a,Hm(e,a,r),ca(e,r),e}function d0(e,t,n,r){var a=t.current,i=Wr(),s=xo(a);return n=XM(n),t.context===null?t.context=n:t.pendingContext=n,t=$s(i,s),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=bo(a,t,s),e!==null&&(Si(e,a,s,i),db(e,a,s)),s}function Qb(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function k_(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function jI(e,t){k_(e,t),(e=e.alternate)&&k_(e,t)}function h5(){return null}var ZM=typeof reportError=="function"?reportError:function(e){console.error(e)};function GI(e){this._internalRoot=e}p0.prototype.render=GI.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ce(409));d0(e,t,null,null)};p0.prototype.unmount=GI.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Hl(function(){d0(null,e,null,null)}),t[As]=null}};function p0(e){this._internalRoot=e}p0.prototype.unstable_scheduleHydration=function(e){if(e){var t=EF();e={blockedOn:null,target:e,priority:t};for(var n=0;n<no.length&&t!==0&&t<no[n].priority;n++);no.splice(n,0,e),n===0&&NF(e)}};function qI(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function h0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function S_(){}function f5(e,t,n,r,a){if(a){if(typeof r=="function"){var i=r;r=function(){var c=Qb(s);i.call(c)}}var s=YM(t,r,e,0,null,!1,!1,"",S_);return e._reactRootContainer=s,e[As]=s.current,om(e.nodeType===8?e.parentNode:e),Hl(),s}for(;a=e.lastChild;)e.removeChild(a);if(typeof r=="function"){var o=r;r=function(){var c=Qb(l);o.call(c)}}var l=HI(e,0,!1,null,null,!1,!1,"",S_);return e._reactRootContainer=l,e[As]=l.current,om(e.nodeType===8?e.parentNode:e),Hl(function(){d0(t,l,n,r)}),l}function f0(e,t,n,r,a){var i=n._reactRootContainer;if(i){var s=i;if(typeof a=="function"){var o=a;a=function(){var l=Qb(s);o.call(l)}}d0(t,s,e,a)}else s=f5(n,t,e,a,r);return Qb(s)}$F=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=wf(t.pendingLanes);n!==0&&(pI(t,n|1),ca(t,cn()),!(dt&6)&&(Yd=cn()+500,Ho()))}break;case 13:Hl(function(){var r=Rs(e,1);if(r!==null){var a=Wr();Si(r,e,1,a)}}),jI(e,1)}};hI=function(e){if(e.tag===13){var t=Rs(e,134217728);if(t!==null){var n=Wr();Si(t,e,134217728,n)}jI(e,134217728)}};CF=function(e){if(e.tag===13){var t=xo(e),n=Rs(e,t);if(n!==null){var r=Wr();Si(n,e,t,r)}jI(e,t)}};EF=function(){return xt};TF=function(e,t){var n=xt;try{return xt=e,t()}finally{xt=n}};K1=function(e,t,n){switch(t){case"input":if(W1(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=a0(r);if(!a)throw Error(ce(90));iF(r),W1(r,a)}}}break;case"textarea":oF(e,n);break;case"select":t=n.value,t!=null&&Ad(e,!!n.multiple,t,!1)}};fF=BI;mF=Hl;var m5={usingClientEntryPoint:!1,Events:[Gm,Sd,a0,pF,hF,BI]},pf={findFiberByHostInstance:$l,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},g5={bundleType:pf.bundleType,version:pf.version,rendererPackageName:pf.rendererPackageName,rendererConfig:pf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ps.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=bF(e),e===null?null:e.stateNode},findFiberByHostInstance:pf.findFiberByHostInstance||h5,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Fy=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Fy.isDisabled&&Fy.supportsFiber)try{e0=Fy.inject(g5),Qi=Fy}catch(e){}}Ma.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=m5;Ma.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!qI(t))throw Error(ce(200));return p5(e,t,null,n)};Ma.createRoot=function(e,t){if(!qI(e))throw Error(ce(299));var n=!1,r="",a=ZM;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=HI(e,1,!1,null,null,n,!1,r,a),e[As]=t.current,om(e.nodeType===8?e.parentNode:e),new GI(t)};Ma.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ce(188)):(e=Object.keys(e).join(","),Error(ce(268,e)));return e=bF(t),e=e===null?null:e.stateNode,e};Ma.flushSync=function(e){return Hl(e)};Ma.hydrate=function(e,t,n){if(!h0(t))throw Error(ce(200));return f0(null,e,t,!0,n)};Ma.hydrateRoot=function(e,t,n){if(!qI(e))throw Error(ce(405));var r=n!=null&&n.hydratedSources||null,a=!1,i="",s=ZM;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(s=n.onRecoverableError)),t=YM(t,null,e,1,n!=null?n:null,a,!1,i,s),e[As]=t.current,om(e),r)for(e=0;e<r.length;e++)n=r[e],a=n._getVersion,a=a(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new p0(t)};Ma.render=function(e,t,n){if(!h0(t))throw Error(ce(200));return f0(null,e,t,!1,n)};Ma.unmountComponentAtNode=function(e){if(!h0(e))throw Error(ce(40));return e._reactRootContainer?(Hl(function(){f0(null,null,e,!1,function(){e._reactRootContainer=null,e[As]=null})}),!0):!1};Ma.unstable_batchedUpdates=BI;Ma.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!h0(n))throw Error(ce(200));if(e==null||e._reactInternals===void 0)throw Error(ce(38));return f0(e,t,n,!1,r)};Ma.version="18.2.0-next-9e3b772b8-20220608";function QM(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(QM)}catch(e){console.error(e)}}QM(),YD.exports=Ma;var m0=YD.exports;const y5=Ip(m0);var JM,I_=m0;JM=I_.createRoot,I_.hydrateRoot;function Ek(e,t){return Ek=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},Ek(e,t)}function To(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Ek(e,t)}var eO={exports:{}},b5="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",v5=b5,x5=v5;function tO(){}function nO(){}nO.resetWarningCache=tO;var w5=function(){function e(r,a,i,s,o,l){if(l!==x5){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}e.isRequired=e;function t(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:nO,resetWarningCache:tO};return n.PropTypes=n,n};eO.exports=w5();var KI=eO.exports;const $_=Ip(KI);function pa(){return pa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},pa.apply(this,arguments)}function My(e){return e.charAt(0)==="/"}function Jw(e,t){for(var n=t,r=n+1,a=e.length;r<a;n+=1,r+=1)e[n]=e[r];e.pop()}function k5(e,t){t===void 0&&(t="");var n=e&&e.split("/")||[],r=t&&t.split("/")||[],a=e&&My(e),i=t&&My(t),s=a||i;if(e&&My(e)?r=n:n.length&&(r.pop(),r=r.concat(n)),!r.length)return"/";var o;if(r.length){var l=r[r.length-1];o=l==="."||l===".."||l===""}else o=!1;for(var c=0,u=r.length;u>=0;u--){var d=r[u];d==="."?Jw(r,u):d===".."?(Jw(r,u),c++):c&&(Jw(r,u),c--)}if(!s)for(;c--;c)r.unshift("..");s&&r[0]!==""&&(!r[0]||!My(r[0]))&&r.unshift("");var p=r.join("/");return o&&p.substr(-1)!=="/"&&(p+="/"),p}function C_(e){return e.valueOf?e.valueOf():Object.prototype.valueOf.call(e)}function bb(e,t){if(e===t)return!0;if(e==null||t==null)return!1;if(Array.isArray(e))return Array.isArray(t)&&e.length===t.length&&e.every(function(a,i){return bb(a,t[i])});if(typeof e=="object"||typeof t=="object"){var n=C_(e),r=C_(t);return n!==e||r!==t?bb(n,r):Object.keys(Object.assign({},e,t)).every(function(a){return bb(e[a],t[a])})}return!1}var S5=!0,e1="Invariant failed";function bu(e,t){if(!e){if(S5)throw new Error(e1);var n=typeof t=="function"?t():t,r=n?"".concat(e1,": ").concat(n):e1;throw new Error(r)}}function Vf(e){return e.charAt(0)==="/"?e:"/"+e}function E_(e){return e.charAt(0)==="/"?e.substr(1):e}function I5(e,t){return e.toLowerCase().indexOf(t.toLowerCase())===0&&"/?#".indexOf(e.charAt(t.length))!==-1}function rO(e,t){return I5(e,t)?e.substr(t.length):e}function aO(e){return e.charAt(e.length-1)==="/"?e.slice(0,-1):e}function $5(e){var t=e||"/",n="",r="",a=t.indexOf("#");a!==-1&&(r=t.substr(a),t=t.substr(0,a));var i=t.indexOf("?");return i!==-1&&(n=t.substr(i),t=t.substr(0,i)),{pathname:t,search:n==="?"?"":n,hash:r==="#"?"":r}}function Va(e){var t=e.pathname,n=e.search,r=e.hash,a=t||"/";return n&&n!=="?"&&(a+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(a+=r.charAt(0)==="#"?r:"#"+r),a}function ia(e,t,n,r){var a;typeof e=="string"?(a=$5(e),a.state=t):(a=pa({},e),a.pathname===void 0&&(a.pathname=""),a.search?a.search.charAt(0)!=="?"&&(a.search="?"+a.search):a.search="",a.hash?a.hash.charAt(0)!=="#"&&(a.hash="#"+a.hash):a.hash="",t!==void 0&&a.state===void 0&&(a.state=t));try{a.pathname=decodeURI(a.pathname)}catch(i){throw i instanceof URIError?new URIError('Pathname "'+a.pathname+'" could not be decoded. This is likely caused by an invalid percent-encoding.'):i}return n&&(a.key=n),r?a.pathname?a.pathname.charAt(0)!=="/"&&(a.pathname=k5(a.pathname,r.pathname)):a.pathname=r.pathname:a.pathname||(a.pathname="/"),a}function C5(e,t){return e.pathname===t.pathname&&e.search===t.search&&e.hash===t.hash&&e.key===t.key&&bb(e.state,t.state)}function XI(){var e=null;function t(s){return e=s,function(){e===s&&(e=null)}}function n(s,o,l,c){if(e!=null){var u=typeof e=="function"?e(s,o):e;typeof u=="string"?typeof l=="function"?l(u,c):c(!0):c(u!==!1)}else c(!0)}var r=[];function a(s){var o=!0;function l(){o&&s.apply(void 0,arguments)}return r.push(l),function(){o=!1,r=r.filter(function(c){return c!==l})}}function i(){for(var s=arguments.length,o=new Array(s),l=0;l<s;l++)o[l]=arguments[l];r.forEach(function(c){return c.apply(void 0,o)})}return{setPrompt:t,confirmTransitionTo:n,appendListener:a,notifyListeners:i}}var iO=!!(typeof window<"u"&&window.document&&window.document.createElement);function sO(e,t){t(window.confirm(e))}function E5(){var e=window.navigator.userAgent;return(e.indexOf("Android 2.")!==-1||e.indexOf("Android 4.0")!==-1)&&e.indexOf("Mobile Safari")!==-1&&e.indexOf("Chrome")===-1&&e.indexOf("Windows Phone")===-1?!1:window.history&&"pushState"in window.history}function T5(){return window.navigator.userAgent.indexOf("Trident")===-1}function N5(){return window.navigator.userAgent.indexOf("Firefox")===-1}function _5(e){return e.state===void 0&&navigator.userAgent.indexOf("CriOS")===-1}var T_="popstate",N_="hashchange";function __(){try{return window.history.state||{}}catch(e){return{}}}function A5(e){e===void 0&&(e={}),iO||bu(!1);var t=window.history,n=E5(),r=!T5(),a=e,i=a.forceRefresh,s=i===void 0?!1:i,o=a.getUserConfirmation,l=o===void 0?sO:o,c=a.keyLength,u=c===void 0?6:c,d=e.basename?aO(Vf(e.basename)):"";function p(z){var B=z||{},j=B.key,Y=B.state,Q=window.location,ae=Q.pathname,se=Q.search,fe=Q.hash,me=ae+se+fe;return d&&(me=rO(me,d)),ia(me,Y,j)}function h(){return Math.random().toString(36).substr(2,u)}var f=XI();function m(z){pa(F,z),F.length=t.length,f.notifyListeners(F.location,F.action)}function g(z){_5(z)||v(p(z.state))}function y(){v(p(__()))}var b=!1;function v(z){if(b)b=!1,m();else{var B="POP";f.confirmTransitionTo(z,B,l,function(j){j?m({action:B,location:z}):x(z)})}}function x(z){var B=F.location,j=$.indexOf(B.key);j===-1&&(j=0);var Y=$.indexOf(z.key);Y===-1&&(Y=0);var Q=j-Y;Q&&(b=!0,R(Q))}var w=p(__()),$=[w.key];function C(z){return d+Va(z)}function E(z,B){var j="PUSH",Y=ia(z,B,h(),F.location);f.confirmTransitionTo(Y,j,l,function(Q){if(Q){var ae=C(Y),se=Y.key,fe=Y.state;if(n)if(t.pushState({key:se,state:fe},null,ae),s)window.location.href=ae;else{var me=$.indexOf(F.location.key),he=$.slice(0,me+1);he.push(Y.key),$=he,m({action:j,location:Y})}else window.location.href=ae}})}function _(z,B){var j="REPLACE",Y=ia(z,B,h(),F.location);f.confirmTransitionTo(Y,j,l,function(Q){if(Q){var ae=C(Y),se=Y.key,fe=Y.state;if(n)if(t.replaceState({key:se,state:fe},null,ae),s)window.location.replace(ae);else{var me=$.indexOf(F.location.key);me!==-1&&($[me]=Y.key),m({action:j,location:Y})}else window.location.replace(ae)}})}function R(z){t.go(z)}function N(){R(-1)}function I(){R(1)}var O=0;function P(z){O+=z,O===1&&z===1?(window.addEventListener(T_,g),r&&window.addEventListener(N_,y)):O===0&&(window.removeEventListener(T_,g),r&&window.removeEventListener(N_,y))}var L=!1;function U(z){z===void 0&&(z=!1);var B=f.setPrompt(z);return L||(P(1),L=!0),function(){return L&&(L=!1,P(-1)),B()}}function D(z){var B=f.appendListener(z);return P(1),function(){P(-1),B()}}var F={length:t.length,action:"POP",location:w,createHref:C,push:E,replace:_,go:R,goBack:N,goForward:I,block:U,listen:D};return F}var A_="hashchange",R5={hashbang:{encodePath:function(t){return t.charAt(0)==="!"?t:"!/"+E_(t)},decodePath:function(t){return t.charAt(0)==="!"?t.substr(1):t}},noslash:{encodePath:E_,decodePath:Vf},slash:{encodePath:Vf,decodePath:Vf}};function oO(e){var t=e.indexOf("#");return t===-1?e:e.slice(0,t)}function hf(){var e=window.location.href,t=e.indexOf("#");return t===-1?"":e.substring(t+1)}function D5(e){window.location.hash=e}function t1(e){window.location.replace(oO(window.location.href)+"#"+e)}function F5(e){e===void 0&&(e={}),iO||bu(!1);var t=window.history;N5();var n=e,r=n.getUserConfirmation,a=r===void 0?sO:r,i=n.hashType,s=i===void 0?"slash":i,o=e.basename?aO(Vf(e.basename)):"",l=R5[s],c=l.encodePath,u=l.decodePath;function d(){var B=u(hf());return o&&(B=rO(B,o)),ia(B)}var p=XI();function h(B){pa(z,B),z.length=t.length,p.notifyListeners(z.location,z.action)}var f=!1,m=null;function g(B,j){return B.pathname===j.pathname&&B.search===j.search&&B.hash===j.hash}function y(){var B=hf(),j=c(B);if(B!==j)t1(j);else{var Y=d(),Q=z.location;if(!f&&g(Q,Y)||m===Va(Y))return;m=null,b(Y)}}function b(B){if(f)f=!1,h();else{var j="POP";p.confirmTransitionTo(B,j,a,function(Y){Y?h({action:j,location:B}):v(B)})}}function v(B){var j=z.location,Y=C.lastIndexOf(Va(j));Y===-1&&(Y=0);var Q=C.lastIndexOf(Va(B));Q===-1&&(Q=0);var ae=Y-Q;ae&&(f=!0,N(ae))}var x=hf(),w=c(x);x!==w&&t1(w);var $=d(),C=[Va($)];function E(B){var j=document.querySelector("base"),Y="";return j&&j.getAttribute("href")&&(Y=oO(window.location.href)),Y+"#"+c(o+Va(B))}function _(B,j){var Y="PUSH",Q=ia(B,void 0,void 0,z.location);p.confirmTransitionTo(Q,Y,a,function(ae){if(ae){var se=Va(Q),fe=c(o+se),me=hf()!==fe;if(me){m=se,D5(fe);var he=C.lastIndexOf(Va(z.location)),Te=C.slice(0,he+1);Te.push(se),C=Te,h({action:Y,location:Q})}else h()}})}function R(B,j){var Y="REPLACE",Q=ia(B,void 0,void 0,z.location);p.confirmTransitionTo(Q,Y,a,function(ae){if(ae){var se=Va(Q),fe=c(o+se),me=hf()!==fe;me&&(m=se,t1(fe));var he=C.indexOf(Va(z.location));he!==-1&&(C[he]=se),h({action:Y,location:Q})}})}function N(B){t.go(B)}function I(){N(-1)}function O(){N(1)}var P=0;function L(B){P+=B,P===1&&B===1?window.addEventListener(A_,y):P===0&&window.removeEventListener(A_,y)}var U=!1;function D(B){B===void 0&&(B=!1);var j=p.setPrompt(B);return U||(L(1),U=!0),function(){return U&&(U=!1,L(-1)),j()}}function F(B){var j=p.appendListener(B);return L(1),function(){L(-1),j()}}var z={length:t.length,action:"POP",location:$,createHref:E,push:_,replace:R,go:N,goBack:I,goForward:O,block:D,listen:F};return z}function R_(e,t,n){return Math.min(Math.max(e,t),n)}function M5(e){e===void 0&&(e={});var t=e,n=t.getUserConfirmation,r=t.initialEntries,a=r===void 0?["/"]:r,i=t.initialIndex,s=i===void 0?0:i,o=t.keyLength,l=o===void 0?6:o,c=XI();function u(E){pa(C,E),C.length=C.entries.length,c.notifyListeners(C.location,C.action)}function d(){return Math.random().toString(36).substr(2,l)}var p=R_(s,0,a.length-1),h=a.map(function(E){return typeof E=="string"?ia(E,void 0,d()):ia(E,void 0,E.key||d())}),f=Va;function m(E,_){var R="PUSH",N=ia(E,_,d(),C.location);c.confirmTransitionTo(N,R,n,function(I){if(I){var O=C.index,P=O+1,L=C.entries.slice(0);L.length>P?L.splice(P,L.length-P,N):L.push(N),u({action:R,location:N,index:P,entries:L})}})}function g(E,_){var R="REPLACE",N=ia(E,_,d(),C.location);c.confirmTransitionTo(N,R,n,function(I){I&&(C.entries[C.index]=N,u({action:R,location:N}))})}function y(E){var _=R_(C.index+E,0,C.entries.length-1),R="POP",N=C.entries[_];c.confirmTransitionTo(N,R,n,function(I){I?u({action:R,location:N,index:_}):u()})}function b(){y(-1)}function v(){y(1)}function x(E){var _=C.index+E;return _>=0&&_<C.entries.length}function w(E){return E===void 0&&(E=!1),c.setPrompt(E)}function $(E){return c.appendListener(E)}var C={length:h.length,action:"POP",location:h[p],index:p,entries:h,createHref:f,push:m,replace:g,go:y,goBack:b,goForward:v,canGo:x,block:w,listen:$};return C}var Tp={exports:{}},O5=Array.isArray||function(e){return Object.prototype.toString.call(e)=="[object Array]"},Jb=O5;Tp.exports=cO;Tp.exports.parse=YI;Tp.exports.compile=P5;Tp.exports.tokensToFunction=lO;Tp.exports.tokensToRegExp=uO;var L5=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function YI(e,t){for(var n=[],r=0,a=0,i="",s=t&&t.delimiter||"/",o;(o=L5.exec(e))!=null;){var l=o[0],c=o[1],u=o.index;if(i+=e.slice(a,u),a=u+l.length,c){i+=c[1];continue}var d=e[a],p=o[2],h=o[3],f=o[4],m=o[5],g=o[6],y=o[7];i&&(n.push(i),i="");var b=p!=null&&d!=null&&d!==p,v=g==="+"||g==="*",x=g==="?"||g==="*",w=o[2]||s,$=f||m;n.push({name:h||r++,prefix:p||"",delimiter:w,optional:x,repeat:v,partial:b,asterisk:!!y,pattern:$?W5($):y?".*":"[^"+vb(w)+"]+?"})}return a<e.length&&(i+=e.substr(a)),i&&n.push(i),n}function P5(e,t){return lO(YI(e,t),t)}function z5(e){return encodeURI(e).replace(/[\/?#]/g,function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()})}function B5(e){return encodeURI(e).replace(/[?#]/g,function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()})}function lO(e,t){for(var n=new Array(e.length),r=0;r<e.length;r++)typeof e[r]=="object"&&(n[r]=new RegExp("^(?:"+e[r].pattern+")$",QI(t)));return function(a,i){for(var s="",o=a||{},l=i||{},c=l.pretty?z5:encodeURIComponent,u=0;u<e.length;u++){var d=e[u];if(typeof d=="string"){s+=d;continue}var p=o[d.name],h;if(p==null)if(d.optional){d.partial&&(s+=d.prefix);continue}else throw new TypeError('Expected "'+d.name+'" to be defined');if(Jb(p)){if(!d.repeat)throw new TypeError('Expected "'+d.name+'" to not repeat, but received `'+JSON.stringify(p)+"`");if(p.length===0){if(d.optional)continue;throw new TypeError('Expected "'+d.name+'" to not be empty')}for(var f=0;f<p.length;f++){if(h=c(p[f]),!n[u].test(h))throw new TypeError('Expected all "'+d.name+'" to match "'+d.pattern+'", but received `'+JSON.stringify(h)+"`");s+=(f===0?d.prefix:d.delimiter)+h}continue}if(h=d.asterisk?B5(p):c(p),!n[u].test(h))throw new TypeError('Expected "'+d.name+'" to match "'+d.pattern+'", but received "'+h+'"');s+=d.prefix+h}return s}}function vb(e){return e.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function W5(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function ZI(e,t){return e.keys=t,e}function QI(e){return e&&e.sensitive?"":"i"}function U5(e,t){var n=e.source.match(/\((?!\?)/g);if(n)for(var r=0;r<n.length;r++)t.push({name:r,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return ZI(e,t)}function V5(e,t,n){for(var r=[],a=0;a<e.length;a++)r.push(cO(e[a],t,n).source);var i=new RegExp("(?:"+r.join("|")+")",QI(n));return ZI(i,t)}function H5(e,t,n){return uO(YI(e,n),t,n)}function uO(e,t,n){Jb(t)||(n=t||n,t=[]),n=n||{};for(var r=n.strict,a=n.end!==!1,i="",s=0;s<e.length;s++){var o=e[s];if(typeof o=="string")i+=vb(o);else{var l=vb(o.prefix),c="(?:"+o.pattern+")";t.push(o),o.repeat&&(c+="(?:"+l+c+")*"),o.optional?o.partial?c=l+"("+c+")?":c="(?:"+l+"("+c+"))?":c=l+"("+c+")",i+=c}}var u=vb(n.delimiter||"/"),d=i.slice(-u.length)===u;return r||(i=(d?i.slice(0,-u.length):i)+"(?:"+u+"(?=$))?"),a?i+="$":i+=r&&d?"":"(?="+u+"|$)",ZI(new RegExp("^"+i,QI(n)),t)}function cO(e,t,n){return Jb(t)||(n=t||n,t=[]),n=n||{},e instanceof RegExp?U5(e,t):Jb(e)?V5(e,t,n):H5(e,t,n)}var j5=Tp.exports;const dO=Ip(j5);var Et={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xn=typeof Symbol=="function"&&Symbol.for,JI=Xn?Symbol.for("react.element"):60103,e$=Xn?Symbol.for("react.portal"):60106,g0=Xn?Symbol.for("react.fragment"):60107,y0=Xn?Symbol.for("react.strict_mode"):60108,b0=Xn?Symbol.for("react.profiler"):60114,v0=Xn?Symbol.for("react.provider"):60109,x0=Xn?Symbol.for("react.context"):60110,t$=Xn?Symbol.for("react.async_mode"):60111,w0=Xn?Symbol.for("react.concurrent_mode"):60111,k0=Xn?Symbol.for("react.forward_ref"):60112,S0=Xn?Symbol.for("react.suspense"):60113,G5=Xn?Symbol.for("react.suspense_list"):60120,I0=Xn?Symbol.for("react.memo"):60115,$0=Xn?Symbol.for("react.lazy"):60116,q5=Xn?Symbol.for("react.block"):60121,K5=Xn?Symbol.for("react.fundamental"):60117,X5=Xn?Symbol.for("react.responder"):60118,Y5=Xn?Symbol.for("react.scope"):60119;function La(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case JI:switch(e=e.type,e){case t$:case w0:case g0:case b0:case y0:case S0:return e;default:switch(e=e&&e.$$typeof,e){case x0:case k0:case $0:case I0:case v0:return e;default:return t}}case e$:return t}}}function pO(e){return La(e)===w0}Et.AsyncMode=t$;Et.ConcurrentMode=w0;Et.ContextConsumer=x0;Et.ContextProvider=v0;Et.Element=JI;Et.ForwardRef=k0;Et.Fragment=g0;Et.Lazy=$0;Et.Memo=I0;Et.Portal=e$;Et.Profiler=b0;Et.StrictMode=y0;Et.Suspense=S0;Et.isAsyncMode=function(e){return pO(e)||La(e)===t$};Et.isConcurrentMode=pO;Et.isContextConsumer=function(e){return La(e)===x0};Et.isContextProvider=function(e){return La(e)===v0};Et.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===JI};Et.isForwardRef=function(e){return La(e)===k0};Et.isFragment=function(e){return La(e)===g0};Et.isLazy=function(e){return La(e)===$0};Et.isMemo=function(e){return La(e)===I0};Et.isPortal=function(e){return La(e)===e$};Et.isProfiler=function(e){return La(e)===b0};Et.isStrictMode=function(e){return La(e)===y0};Et.isSuspense=function(e){return La(e)===S0};Et.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===g0||e===w0||e===b0||e===y0||e===S0||e===G5||typeof e=="object"&&e!==null&&(e.$$typeof===$0||e.$$typeof===I0||e.$$typeof===v0||e.$$typeof===x0||e.$$typeof===k0||e.$$typeof===K5||e.$$typeof===X5||e.$$typeof===Y5||e.$$typeof===q5)};Et.typeOf=La;function hO(e,t){if(e==null)return{};var n={},r=Object.keys(e),a,i;for(i=0;i<r.length;i++)a=r[i],!(t.indexOf(a)>=0)&&(n[a]=e[a]);return n}var fO={exports:{}},It={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yn=typeof Symbol=="function"&&Symbol.for,n$=Yn?Symbol.for("react.element"):60103,r$=Yn?Symbol.for("react.portal"):60106,C0=Yn?Symbol.for("react.fragment"):60107,E0=Yn?Symbol.for("react.strict_mode"):60108,T0=Yn?Symbol.for("react.profiler"):60114,N0=Yn?Symbol.for("react.provider"):60109,_0=Yn?Symbol.for("react.context"):60110,a$=Yn?Symbol.for("react.async_mode"):60111,A0=Yn?Symbol.for("react.concurrent_mode"):60111,R0=Yn?Symbol.for("react.forward_ref"):60112,D0=Yn?Symbol.for("react.suspense"):60113,Z5=Yn?Symbol.for("react.suspense_list"):60120,F0=Yn?Symbol.for("react.memo"):60115,M0=Yn?Symbol.for("react.lazy"):60116,Q5=Yn?Symbol.for("react.block"):60121,J5=Yn?Symbol.for("react.fundamental"):60117,e8=Yn?Symbol.for("react.responder"):60118,t8=Yn?Symbol.for("react.scope"):60119;function Pa(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case n$:switch(e=e.type,e){case a$:case A0:case C0:case T0:case E0:case D0:return e;default:switch(e=e&&e.$$typeof,e){case _0:case R0:case M0:case F0:case N0:return e;default:return t}}case r$:return t}}}function mO(e){return Pa(e)===A0}It.AsyncMode=a$;It.ConcurrentMode=A0;It.ContextConsumer=_0;It.ContextProvider=N0;It.Element=n$;It.ForwardRef=R0;It.Fragment=C0;It.Lazy=M0;It.Memo=F0;It.Portal=r$;It.Profiler=T0;It.StrictMode=E0;It.Suspense=D0;It.isAsyncMode=function(e){return mO(e)||Pa(e)===a$};It.isConcurrentMode=mO;It.isContextConsumer=function(e){return Pa(e)===_0};It.isContextProvider=function(e){return Pa(e)===N0};It.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===n$};It.isForwardRef=function(e){return Pa(e)===R0};It.isFragment=function(e){return Pa(e)===C0};It.isLazy=function(e){return Pa(e)===M0};It.isMemo=function(e){return Pa(e)===F0};It.isPortal=function(e){return Pa(e)===r$};It.isProfiler=function(e){return Pa(e)===T0};It.isStrictMode=function(e){return Pa(e)===E0};It.isSuspense=function(e){return Pa(e)===D0};It.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===C0||e===A0||e===T0||e===E0||e===D0||e===Z5||typeof e=="object"&&e!==null&&(e.$$typeof===M0||e.$$typeof===F0||e.$$typeof===N0||e.$$typeof===_0||e.$$typeof===R0||e.$$typeof===J5||e.$$typeof===e8||e.$$typeof===t8||e.$$typeof===Q5)};It.typeOf=Pa;fO.exports=It;var n8=fO.exports,i$=n8,r8={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},a8={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},i8={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},gO={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s$={};s$[i$.ForwardRef]=i8;s$[i$.Memo]=gO;function D_(e){return i$.isMemo(e)?gO:s$[e.$$typeof]||r8}var s8=Object.defineProperty,o8=Object.getOwnPropertyNames,F_=Object.getOwnPropertySymbols,l8=Object.getOwnPropertyDescriptor,u8=Object.getPrototypeOf,M_=Object.prototype;function yO(e,t,n){if(typeof t!="string"){if(M_){var r=u8(t);r&&r!==M_&&yO(e,r,n)}var a=o8(t);F_&&(a=a.concat(F_(t)));for(var i=D_(e),s=D_(t),o=0;o<a.length;++o){var l=a[o];if(!a8[l]&&!(n&&n[l])&&!(s&&s[l])&&!(i&&i[l])){var c=l8(t,l);try{s8(e,l,c)}catch(u){}}}}return e}var c8=yO;const d8=Ip(c8);var n1=1073741823,O_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{};function p8(){var e="__global_unique_id__";return O_[e]=(O_[e]||0)+1}function h8(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function f8(e){var t=[];return{on:function(r){t.push(r)},off:function(r){t=t.filter(function(a){return a!==r})},get:function(){return e},set:function(r,a){e=r,t.forEach(function(i){return i(e,a)})}}}function m8(e){return Array.isArray(e)?e[0]:e}function g8(e,t){var n,r,a="__create-react-context-"+p8()+"__",i=function(o){To(l,o);function l(){for(var u,d=arguments.length,p=new Array(d),h=0;h<d;h++)p[h]=arguments[h];return u=o.call.apply(o,[this].concat(p))||this,u.emitter=f8(u.props.value),u}var c=l.prototype;return c.getChildContext=function(){var d;return d={},d[a]=this.emitter,d},c.componentWillReceiveProps=function(d){if(this.props.value!==d.value){var p=this.props.value,h=d.value,f;h8(p,h)?f=0:(f=typeof t=="function"?t(p,h):n1,f|=0,f!==0&&this.emitter.set(d.value,f))}},c.render=function(){return this.props.children},l}(oe.Component);i.childContextTypes=(n={},n[a]=$_.object.isRequired,n);var s=function(o){To(l,o);function l(){for(var u,d=arguments.length,p=new Array(d),h=0;h<d;h++)p[h]=arguments[h];return u=o.call.apply(o,[this].concat(p))||this,u.observedBits=void 0,u.state={value:u.getValue()},u.onUpdate=function(f,m){var g=u.observedBits|0;g&m&&u.setState({value:u.getValue()})},u}var c=l.prototype;return c.componentWillReceiveProps=function(d){var p=d.observedBits;this.observedBits=p==null?n1:p},c.componentDidMount=function(){this.context[a]&&this.context[a].on(this.onUpdate);var d=this.props.observedBits;this.observedBits=d==null?n1:d},c.componentWillUnmount=function(){this.context[a]&&this.context[a].off(this.onUpdate)},c.getValue=function(){return this.context[a]?this.context[a].get():e},c.render=function(){return m8(this.props.children)(this.state.value)},l}(oe.Component);return s.contextTypes=(r={},r[a]=$_.object,r),{Provider:i,Consumer:s}}var y8=oe.createContext||g8,bO=function(t){var n=y8();return n.displayName=t,n},b8=bO("Router-History"),Zd=bO("Router"),Km=function(e){To(t,e),t.computeRootMatch=function(a){return{path:"/",url:"/",params:{},isExact:a==="/"}};function t(r){var a;return a=e.call(this,r)||this,a.state={location:r.history.location},a._isMounted=!1,a._pendingLocation=null,r.staticContext||(a.unlisten=r.history.listen(function(i){a._pendingLocation=i})),a}var n=t.prototype;return n.componentDidMount=function(){var a=this;this._isMounted=!0,this.unlisten&&this.unlisten(),this.props.staticContext||(this.unlisten=this.props.history.listen(function(i){a._isMounted&&a.setState({location:i})})),this._pendingLocation&&this.setState({location:this._pendingLocation})},n.componentWillUnmount=function(){this.unlisten&&(this.unlisten(),this._isMounted=!1,this._pendingLocation=null)},n.render=function(){return oe.createElement(Zd.Provider,{value:{history:this.props.history,location:this.state.location,match:t.computeRootMatch(this.state.location.pathname),staticContext:this.props.staticContext}},oe.createElement(b8.Provider,{children:this.props.children||null,value:this.props.history}))},t}(oe.Component);oe.Component;var v8=function(e){To(t,e);function t(){return e.apply(this,arguments)||this}var n=t.prototype;return n.componentDidMount=function(){this.props.onMount&&this.props.onMount.call(this,this)},n.componentDidUpdate=function(a){this.props.onUpdate&&this.props.onUpdate.call(this,this,a)},n.componentWillUnmount=function(){this.props.onUnmount&&this.props.onUnmount.call(this,this)},n.render=function(){return null},t}(oe.Component),r1={},x8=1e4,L_=0;function w8(e){if(r1[e])return r1[e];var t=dO.compile(e);return L_<x8&&(r1[e]=t,L_++),t}function P_(e,t){return e===void 0&&(e="/"),t===void 0&&(t={}),e==="/"?e:w8(e)(t,{pretty:!0})}function k8(e){var t=e.computedMatch,n=e.to,r=e.push,a=r===void 0?!1:r;return oe.createElement(Zd.Consumer,null,function(i){i||bu(!1);var s=i.history,o=i.staticContext,l=a?s.push:s.replace,c=ia(t?typeof n=="string"?P_(n,t.params):pa({},n,{pathname:P_(n.pathname,t.params)}):n);return o?(l(c),null):oe.createElement(v8,{onMount:function(){l(c)},onUpdate:function(d,p){var h=ia(p.to);C5(h,pa({},c,{key:h.key}))||l(c)},to:n})})}var z_={},S8=1e4,B_=0;function I8(e,t){var n=""+t.end+t.strict+t.sensitive,r=z_[n]||(z_[n]={});if(r[e])return r[e];var a=[],i=dO(e,a,t),s={regexp:i,keys:a};return B_<S8&&(r[e]=s,B_++),s}function jl(e,t){t===void 0&&(t={}),(typeof t=="string"||Array.isArray(t))&&(t={path:t});var n=t,r=n.path,a=n.exact,i=a===void 0?!1:a,s=n.strict,o=s===void 0?!1:s,l=n.sensitive,c=l===void 0?!1:l,u=[].concat(r);return u.reduce(function(d,p){if(!p&&p!=="")return null;if(d)return d;var h=I8(p,{end:i,strict:o,sensitive:c}),f=h.regexp,m=h.keys,g=f.exec(e);if(!g)return null;var y=g[0],b=g.slice(1),v=e===y;return i&&!v?null:{path:p,url:p==="/"&&y===""?"/":y,isExact:v,params:m.reduce(function(x,w,$){return x[w.name]=b[$],x},{})}},null)}function $8(e){return oe.Children.count(e)===0}var gl=function(e){To(t,e);function t(){return e.apply(this,arguments)||this}var n=t.prototype;return n.render=function(){var a=this;return oe.createElement(Zd.Consumer,null,function(i){i||bu(!1);var s=a.props.location||i.location,o=a.props.computedMatch?a.props.computedMatch:a.props.path?jl(s.pathname,a.props):i.match,l=pa({},i,{location:s,match:o}),c=a.props,u=c.children,d=c.component,p=c.render;return Array.isArray(u)&&$8(u)&&(u=null),oe.createElement(Zd.Provider,{value:l},l.match?u?typeof u=="function"?u(l):u:d?oe.createElement(d,l):p?p(l):null:typeof u=="function"?u(l):null)})},t}(oe.Component);function o$(e){return e.charAt(0)==="/"?e:"/"+e}function C8(e,t){return e?pa({},t,{pathname:o$(e)+t.pathname}):t}function E8(e,t){if(!e)return t;var n=o$(e);return t.pathname.indexOf(n)!==0?t:pa({},t,{pathname:t.pathname.substr(n.length)})}function W_(e){return typeof e=="string"?e:Va(e)}function a1(e){return function(){bu(!1)}}function U_(){}oe.Component;oe.Component;function T8(e){var t="withRouter("+(e.displayName||e.name)+")",n=function(a){var i=a.wrappedComponentRef,s=hO(a,["wrappedComponentRef"]);return oe.createElement(Zd.Consumer,null,function(o){return o||bu(!1),oe.createElement(e,pa({},s,o,{ref:i}))})};return n.displayName=t,n.WrappedComponent=e,d8(n,e)}oe.useContext;const N8="modulepreload",_8=function(e){return"/"+e},V_={},gi=function(t,n,r){if(!n||n.length===0)return t();const a=document.getElementsByTagName("link");return Promise.all(n.map(i=>{if(i=_8(i),i in V_)return;V_[i]=!0;const s=i.endsWith(".css"),o=s?'[rel="stylesheet"]':"";if(!!r)for(let u=a.length-1;u>=0;u--){const d=a[u];if(d.href===i&&(!s||d.rel==="stylesheet"))return}else if(document.querySelector('link[href="'.concat(i,'"]').concat(o)))return;const c=document.createElement("link");if(c.rel=s?"stylesheet":N8,s||(c.as="script",c.crossOrigin=""),c.href=i,document.head.appendChild(c),s)return new Promise((u,d)=>{c.addEventListener("load",u),c.addEventListener("error",()=>d(new Error("Unable to preload CSS for ".concat(i))))})})).then(()=>t()).catch(i=>{const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=i,window.dispatchEvent(s),!s.defaultPrevented)throw i})},ud={allRenderFn:!1,cmpDidLoad:!0,cmpDidUnload:!1,cmpDidUpdate:!0,cmpDidRender:!0,cmpWillLoad:!0,cmpWillUpdate:!0,cmpWillRender:!0,connectedCallback:!0,disconnectedCallback:!0,element:!0,event:!0,hasRenderFn:!0,lifecycle:!0,hostListener:!0,hostListenerTargetWindow:!0,hostListenerTargetDocument:!0,hostListenerTargetBody:!0,hostListenerTargetParent:!1,hostListenerTarget:!0,member:!0,method:!0,mode:!0,observeAttribute:!0,prop:!0,propMutable:!0,reflect:!0,scoped:!0,shadowDom:!0,slot:!0,cssAnnotations:!0,state:!0,style:!0,svg:!0,updatable:!0,vdomAttribute:!0,vdomXlink:!0,vdomClass:!0,vdomFunctional:!0,vdomKey:!0,vdomListener:!0,vdomRef:!0,vdomPropOrAttr:!0,vdomRender:!0,vdomStyle:!0,vdomText:!0,watchCallback:!0,taskQueue:!0,hotModuleReplacement:!1,isDebug:!1,isDev:!1,isTesting:!1,hydrateServerSide:!1,hydrateClientSide:!1,lifecycleDOMEvents:!1,lazyLoad:!1,profile:!1,slotRelocation:!0,appendChildSlotFix:!1,cloneNodeFix:!1,hydratedAttribute:!1,hydratedClass:!0,safari10:!1,scriptDataOpts:!1,scopedSlotTextContentFix:!1,shadowDomShim:!1,slotChildNodesFix:!1,invisiblePrehydration:!0,propBoolean:!0,propNumber:!0,propString:!0,cssVarShim:!1,constructableCSS:!0,cmpShouldUpdate:!0,devTools:!1,dynamicImportShim:!1,shadowDelegatesFocus:!0,initializeNextTick:!1,asyncLoading:!1,asyncQueue:!1,transformTagName:!1,attachStyles:!0};let cd,vO,O0,xO=!1,ev=!1,l$=!1,ka=!1,H_=null,Tk=!1;const A8={isDev:!1,isBrowser:!0,isServer:!1,isTesting:!1},Gl=(e,t="")=>()=>{},j_="http://www.w3.org/1999/xlink",G_={},R8="http://www.w3.org/2000/svg",D8="http://www.w3.org/1999/xhtml",F8=e=>e!=null,u$=e=>(e=typeof e,e==="object"||e==="function");function M8(e){var t,n,r;return(r=(n=(t=e.head)===null||t===void 0?void 0:t.querySelector('meta[name="csp-nonce"]'))===null||n===void 0?void 0:n.getAttribute("content"))!==null&&r!==void 0?r:void 0}const De=(e,t,...n)=>{let r=null,a=null,i=null,s=!1,o=!1;const l=[],c=d=>{for(let p=0;p<d.length;p++)r=d[p],Array.isArray(r)?c(r):r!=null&&typeof r!="boolean"&&((s=typeof e!="function"&&!u$(r))&&(r=String(r)),s&&o?l[l.length-1].$text$+=r:l.push(s?tv(null,r):r),o=s)};if(c(n),t){t.key&&(a=t.key),t.name&&(i=t.name);{const d=t.className||t.class;d&&(t.class=typeof d!="object"?d:Object.keys(d).filter(p=>d[p]).join(" "))}}if(typeof e=="function")return e(t===null?{}:t,l,L8);const u=tv(e,null);return u.$attrs$=t,l.length>0&&(u.$children$=l),u.$key$=a,u.$name$=i,u},tv=(e,t)=>{const n={$flags$:0,$tag$:e,$text$:t,$elm$:null,$children$:null};return n.$attrs$=null,n.$key$=null,n.$name$=null,n},_r={},O8=e=>e&&e.$tag$===_r,L8={forEach:(e,t)=>e.map(q_).forEach(t),map:(e,t)=>e.map(q_).map(t).map(P8)},q_=e=>({vattrs:e.$attrs$,vchildren:e.$children$,vkey:e.$key$,vname:e.$name$,vtag:e.$tag$,vtext:e.$text$}),P8=e=>{if(typeof e.vtag=="function"){const n=Object.assign({},e.vattrs);return e.vkey&&(n.key=e.vkey),e.vname&&(n.name=e.vname),De(e.vtag,n,...e.vchildren||[])}const t=tv(e.vtag,e.vtext);return t.$attrs$=e.vattrs,t.$children$=e.vchildren,t.$key$=e.vkey,t.$name$=e.vname,t},z8=e=>AO.map(t=>t(e)).find(t=>!!t),B8=e=>AO.push(e),W8=e=>Np(e).$modeName$,U8=(e,t)=>e!=null&&!u$(e)?t&4?e==="false"?!1:e===""||!!e:t&2?parseFloat(e):t&1?String(e):e:e,V8=e=>e,bt=(e,t,n)=>{const r=V8(e);return{emit:a=>H8(r,t,{bubbles:!!(n&4),composed:!!(n&2),cancelable:!!(n&1),detail:a})}},H8=(e,t,n)=>{const r=or.ce(t,n);return e.dispatchEvent(r),r},K_=new WeakMap,j8=(e,t,n)=>{let r=av.get(e);bq&&n?(r=r||new CSSStyleSheet,typeof r=="string"?r=t:r.replaceSync(t)):r=t,av.set(e,r)},G8=(e,t,n,r)=>{var a;let i=wO(t,n);const s=av.get(i);if(e=e.nodeType===11?e:Ii,s)if(typeof s=="string"){e=e.head||e;let o=K_.get(e),l;if(o||K_.set(e,o=new Set),!o.has(i)){{l=Ii.createElement("style"),l.innerHTML=s;const c=(a=or.$nonce$)!==null&&a!==void 0?a:M8(Ii);c!=null&&l.setAttribute("nonce",c),e.insertBefore(l,e.querySelector("link"))}o&&o.add(i)}}else e.adoptedStyleSheets.includes(s)||(e.adoptedStyleSheets=[...e.adoptedStyleSheets,s]);return i},q8=e=>{const t=e.$cmpMeta$,n=e.$hostElement$,r=t.$flags$,a=Gl("attachStyles",t.$tagName$),i=G8(n.shadowRoot?n.shadowRoot:n.getRootNode(),t,e.$modeName$);r&10&&(n["s-sc"]=i,n.classList.add(i+"-h"),r&2&&n.classList.add(i+"-s")),a()},wO=(e,t)=>"sc-"+(t&&e.$flags$&32?e.$tagName$+"-"+t:e.$tagName$),X_=(e,t,n,r,a,i)=>{if(n!==r){let s=J_(e,t),o=t.toLowerCase();if(t==="class"){const l=e.classList,c=Y_(n),u=Y_(r);l.remove(...c.filter(d=>d&&!u.includes(d))),l.add(...u.filter(d=>d&&!c.includes(d)))}else if(t==="style"){for(const l in n)(!r||r[l]==null)&&(l.includes("-")?e.style.removeProperty(l):e.style[l]="");for(const l in r)(!n||r[l]!==n[l])&&(l.includes("-")?e.style.setProperty(l,r[l]):e.style[l]=r[l])}else if(t!=="key")if(t==="ref")r&&r(e);else if(!e.__lookupSetter__(t)&&t[0]==="o"&&t[1]==="n")t[2]==="-"?t=t.slice(3):J_(L0,o)?t=o.slice(2):t=o[2]+t.slice(3),n&&or.rel(e,t,n,!1),r&&or.ael(e,t,r,!1);else{const l=u$(r);if((s||l&&r!==null)&&!a)try{if(e.tagName.includes("-"))e[t]=r;else{const u=r==null?"":r;t==="list"?s=!1:(n==null||e[t]!=u)&&(e[t]=u)}}catch(u){}let c=!1;o!==(o=o.replace(/^xlink\:?/,""))&&(t=o,c=!0),r==null||r===!1?(r!==!1||e.getAttribute(t)==="")&&(c?e.removeAttributeNS(j_,t):e.removeAttribute(t)):(!s||i&4||a)&&!l&&(r=r===!0?"":r,c?e.setAttributeNS(j_,t,r):e.setAttribute(t,r))}}},K8=/\s/,Y_=e=>e?e.split(K8):[],kO=(e,t,n,r)=>{const a=t.$elm$.nodeType===11&&t.$elm$.host?t.$elm$.host:t.$elm$,i=e&&e.$attrs$||G_,s=t.$attrs$||G_;for(r in i)r in s||X_(a,r,i[r],void 0,n,t.$flags$);for(r in s)X_(a,r,i[r],s[r],n,t.$flags$)},nv=(e,t,n,r)=>{const a=t.$children$[n];let i=0,s,o,l;if(xO||(l$=!0,a.$tag$==="slot"&&(cd&&r.classList.add(cd+"-s"),a.$flags$|=a.$children$?2:1)),a.$text$!==null)s=a.$elm$=Ii.createTextNode(a.$text$);else if(a.$flags$&1)s=a.$elm$=Ii.createTextNode("");else{if(ka||(ka=a.$tag$==="svg"),s=a.$elm$=Ii.createElementNS(ka?R8:D8,a.$flags$&2?"slot-fb":a.$tag$),ka&&a.$tag$==="foreignObject"&&(ka=!1),kO(null,a,ka),F8(cd)&&s["s-si"]!==cd&&s.classList.add(s["s-si"]=cd),a.$children$)for(i=0;i<a.$children$.length;++i)o=nv(e,a,i,s),o&&s.appendChild(o);a.$tag$==="svg"?ka=!1:s.tagName==="foreignObject"&&(ka=!0)}return s["s-hn"]=O0,a.$flags$&3&&(s["s-sr"]=!0,s["s-cr"]=vO,s["s-sn"]=a.$name$||"",l=e&&e.$children$&&e.$children$[n],l&&l.$tag$===a.$tag$&&e.$elm$&&gm(e.$elm$,!1)),s},gm=(e,t)=>{or.$flags$|=1;const n=e.childNodes;for(let r=n.length-1;r>=0;r--){const a=n[r];a["s-hn"]!==O0&&a["s-ol"]&&($O(a).insertBefore(a,c$(a)),a["s-ol"].remove(),a["s-ol"]=void 0,l$=!0),t&&gm(a,t)}or.$flags$&=-2},SO=(e,t,n,r,a,i)=>{let s=e["s-cr"]&&e["s-cr"].parentNode||e,o;for(s.shadowRoot&&s.tagName===O0&&(s=s.shadowRoot);a<=i;++a)r[a]&&(o=nv(null,n,a,e),o&&(r[a].$elm$=o,s.insertBefore(o,c$(t))))},IO=(e,t,n)=>{for(let r=t;r<=n;++r){const a=e[r];if(a){const i=a.$elm$;TO(a),i&&(ev=!0,i["s-ol"]?i["s-ol"].remove():gm(i,!0),i.remove())}}},X8=(e,t,n,r)=>{let a=0,i=0,s=0,o=0,l=t.length-1,c=t[0],u=t[l],d=r.length-1,p=r[0],h=r[d],f,m;for(;a<=l&&i<=d;)if(c==null)c=t[++a];else if(u==null)u=t[--l];else if(p==null)p=r[++i];else if(h==null)h=r[--d];else if(Oy(c,p))dd(c,p),c=t[++a],p=r[++i];else if(Oy(u,h))dd(u,h),u=t[--l],h=r[--d];else if(Oy(c,h))(c.$tag$==="slot"||h.$tag$==="slot")&&gm(c.$elm$.parentNode,!1),dd(c,h),e.insertBefore(c.$elm$,u.$elm$.nextSibling),c=t[++a],h=r[--d];else if(Oy(u,p))(c.$tag$==="slot"||h.$tag$==="slot")&&gm(u.$elm$.parentNode,!1),dd(u,p),e.insertBefore(u.$elm$,c.$elm$),u=t[--l],p=r[++i];else{for(s=-1,o=a;o<=l;++o)if(t[o]&&t[o].$key$!==null&&t[o].$key$===p.$key$){s=o;break}s>=0?(m=t[s],m.$tag$!==p.$tag$?f=nv(t&&t[i],n,s,e):(dd(m,p),t[s]=void 0,f=m.$elm$),p=r[++i]):(f=nv(t&&t[i],n,i,e),p=r[++i]),f&&$O(c.$elm$).insertBefore(f,c$(c.$elm$))}a>l?SO(e,r[d+1]==null?null:r[d+1].$elm$,n,r,i,d):i>d&&IO(t,a,l)},Oy=(e,t)=>e.$tag$===t.$tag$?e.$tag$==="slot"?e.$name$===t.$name$:e.$key$===t.$key$:!1,c$=e=>e&&e["s-ol"]||e,$O=e=>(e["s-ol"]?e["s-ol"]:e).parentNode,dd=(e,t)=>{const n=t.$elm$=e.$elm$,r=e.$children$,a=t.$children$,i=t.$tag$,s=t.$text$;let o;s===null?(ka=i==="svg"?!0:i==="foreignObject"?!1:ka,i==="slot"||kO(e,t,ka),r!==null&&a!==null?X8(n,r,t,a):a!==null?(e.$text$!==null&&(n.textContent=""),SO(n,null,t,a,0,a.length-1)):r!==null&&IO(r,0,r.length-1),ka&&i==="svg"&&(ka=!1)):(o=n["s-cr"])?o.parentNode.textContent=s:e.$text$!==s&&(n.data=s)},CO=e=>{const t=e.childNodes;let n,r,a,i,s,o;for(r=0,a=t.length;r<a;r++)if(n=t[r],n.nodeType===1){if(n["s-sr"]){for(s=n["s-sn"],n.hidden=!1,i=0;i<a;i++)if(o=t[i].nodeType,t[i]["s-hn"]!==n["s-hn"]||s!==""){if(o===1&&s===t[i].getAttribute("slot")){n.hidden=!0;break}}else if(o===1||o===3&&t[i].textContent.trim()!==""){n.hidden=!0;break}}CO(n)}},yi=[],EO=e=>{let t,n,r,a,i,s,o=0;const l=e.childNodes,c=l.length;for(;o<c;o++){if(t=l[o],t["s-sr"]&&(n=t["s-cr"])&&n.parentNode)for(r=n.parentNode.childNodes,a=t["s-sn"],s=r.length-1;s>=0;s--)n=r[s],!n["s-cn"]&&!n["s-nr"]&&n["s-hn"]!==t["s-hn"]&&(Z_(n,a)?(i=yi.find(u=>u.$nodeToRelocate$===n),ev=!0,n["s-sn"]=n["s-sn"]||a,i?i.$slotRefNode$=t:yi.push({$slotRefNode$:t,$nodeToRelocate$:n}),n["s-sr"]&&yi.map(u=>{Z_(u.$nodeToRelocate$,n["s-sn"])&&(i=yi.find(d=>d.$nodeToRelocate$===n),i&&!u.$slotRefNode$&&(u.$slotRefNode$=i.$slotRefNode$))})):yi.some(u=>u.$nodeToRelocate$===n)||yi.push({$nodeToRelocate$:n}));t.nodeType===1&&EO(t)}},Z_=(e,t)=>e.nodeType===1?e.getAttribute("slot")===null&&t===""||e.getAttribute("slot")===t:e["s-sn"]===t?!0:t==="",TO=e=>{e.$attrs$&&e.$attrs$.ref&&e.$attrs$.ref(null),e.$children$&&e.$children$.map(TO)},Y8=(e,t)=>{const n=e.$hostElement$,r=e.$cmpMeta$,a=e.$vnode$||tv(null,null),i=O8(t)?t:De(null,null,t);O0=n.tagName,r.$attrsToReflect$&&(i.$attrs$=i.$attrs$||{},r.$attrsToReflect$.map(([s,o])=>i.$attrs$[o]=n[s])),i.$tag$=null,i.$flags$|=4,e.$vnode$=i,i.$elm$=a.$elm$=n.shadowRoot||n,cd=n["s-sc"],vO=n["s-cr"],xO=(r.$flags$&1)!==0,ev=!1,dd(a,i);{if(or.$flags$|=1,l$){EO(i.$elm$);let s,o,l,c,u,d,p=0;for(;p<yi.length;p++)s=yi[p],o=s.$nodeToRelocate$,o["s-ol"]||(l=Ii.createTextNode(""),l["s-nr"]=o,o.parentNode.insertBefore(o["s-ol"]=l,o));for(p=0;p<yi.length;p++)if(s=yi[p],o=s.$nodeToRelocate$,s.$slotRefNode$){for(c=s.$slotRefNode$.parentNode,u=s.$slotRefNode$.nextSibling,l=o["s-ol"];l=l.previousSibling;)if(d=l["s-nr"],d&&d["s-sn"]===o["s-sn"]&&c===d.parentNode&&(d=d.nextSibling,!d||!d["s-nr"])){u=d;break}(!u&&c!==o.parentNode||o.nextSibling!==u)&&o!==u&&(!o["s-hn"]&&o["s-ol"]&&(o["s-hn"]=o["s-ol"].parentNode.nodeName),c.insertBefore(o,u))}else o.nodeType===1&&(o.hidden=!0)}ev&&CO(i.$elm$),or.$flags$&=-2,yi.length=0}},Z8=(e,t)=>{},d$=(e,t)=>(e.$flags$|=16,Z8(e,e.$ancestorComponent$),Ri(()=>Q8(e,t))),Q8=(e,t)=>{const n=e.$hostElement$,r=Gl("scheduleUpdate",e.$cmpMeta$.$tagName$),a=n;let i;return t?i=Ld(a,"componentWillLoad"):i=Ld(a,"componentWillUpdate"),i=Q_(i,()=>Ld(a,"componentWillRender")),r(),Q_(i,()=>eq(e,a,t))},Q_=(e,t)=>J8(e)?e.then(t):t(),J8=e=>e instanceof Promise||e&&e.then&&typeof e.then=="function",eq=async(e,t,n)=>{const r=e.$hostElement$,a=Gl("update",e.$cmpMeta$.$tagName$);r["s-rc"],n&&q8(e);const i=Gl("render",e.$cmpMeta$.$tagName$);tq(e,t,r),i(),a(),nq(e)},tq=(e,t,n)=>{try{H_=t,t=t.render&&t.render(),e.$flags$&=-17,e.$flags$|=2,(ud.hasRenderFn||ud.reflect)&&(ud.vdomRender||ud.reflect)&&(ud.hydrateServerSide||Y8(e,t))}catch(o){Xm(o,e.$hostElement$)}return H_=null,null},nq=e=>{const t=e.$cmpMeta$.$tagName$,n=e.$hostElement$,r=Gl("postUpdate",t),a=n;e.$ancestorComponent$,Ld(a,"componentDidRender"),e.$flags$&64?(Ld(a,"componentDidUpdate"),r()):(e.$flags$|=64,Ld(a,"componentDidLoad"),r())},rv=e=>{{const t=Np(e),n=t.$hostElement$.isConnected;return n&&(t.$flags$&18)===2&&d$(t,!1),n}},Ld=(e,t,n)=>{if(e&&e[t])try{return e[t](n)}catch(r){Xm(r)}},rq=(e,t)=>Np(e).$instanceValues$.get(t),aq=(e,t,n,r)=>{const a=Np(e),i=e,s=a.$instanceValues$.get(t),o=a.$flags$,l=i;n=U8(n,r.$members$[t][0]);const c=Number.isNaN(s)&&Number.isNaN(n);if(n!==s&&!c){a.$instanceValues$.set(t,n);{if(r.$watchers$&&o&128){const d=r.$watchers$[t];d&&d.map(p=>{try{l[p](n,s,t)}catch(h){Xm(h,i)}})}if((o&18)===2){if(l.componentShouldUpdate&&l.componentShouldUpdate(n,s,t)===!1)return;d$(a,!1)}}}},iq=(e,t,n)=>{if(t.$members$){e.watchers&&(t.$watchers$=e.watchers);const r=Object.entries(t.$members$),a=e.prototype;r.map(([i,[s]])=>{(s&31||s&32)&&Object.defineProperty(a,i,{get(){return rq(this,i)},set(o){aq(this,i,o,t)},configurable:!0,enumerable:!0})});{const i=new Map;a.attributeChangedCallback=function(s,o,l){or.jmp(()=>{const c=i.get(s);if(this.hasOwnProperty(c))l=this[c],delete this[c];else if(a.hasOwnProperty(c)&&typeof this[c]=="number"&&this[c]==l)return;this[c]=l===null&&typeof this[c]=="boolean"?!1:l})},e.observedAttributes=r.filter(([s,o])=>o[0]&15).map(([s,o])=>{const l=o[1]||s;return i.set(l,s),o[0]&512&&t.$attrsToReflect$.push([s,l]),l})}}return e},sq=async(e,t,n,r,a)=>{if(!(t.$flags$&32)&&(t.$flags$|=32,a=e.constructor,customElements.whenDefined(n.$tagName$).then(()=>t.$flags$|=128),a.style)){let s=a.style;typeof s!="string"&&(s=s[t.$modeName$=z8(e)]);const o=wO(n,t.$modeName$);if(!av.has(o)){const l=Gl("registerStyles",n.$tagName$);j8(o,s,!!(n.$flags$&1)),l()}}t.$ancestorComponent$,(()=>d$(t,!0))()},oq=e=>{},lq=e=>{if(!(or.$flags$&1)){const t=Np(e),n=t.$cmpMeta$,r=Gl("connectedCallback",n.$tagName$);t.$flags$&1?(NO(e,t,n.$listeners$),oq(t.$lazyInstance$)):(t.$flags$|=1,n.$flags$&12&&uq(e),n.$members$&&Object.entries(n.$members$).map(([a,[i]])=>{if(i&31&&e.hasOwnProperty(a)){const s=e[a];delete e[a],e[a]=s}}),sq(e,t,n)),r()}},uq=e=>{const t=e["s-cr"]=Ii.createComment("");t["s-cn"]=!0,e.insertBefore(t,e.firstChild)},cq=e=>{if(!(or.$flags$&1)){const t=Np(e);t.$rmListeners$&&(t.$rmListeners$.map(n=>n()),t.$rmListeners$=void 0)}},ur=(e,t)=>{const n={$flags$:t[0],$tagName$:t[1]};n.$members$=t[2],n.$listeners$=t[3],n.$watchers$=e.$watchers$,n.$attrsToReflect$=[];const r=e.prototype.connectedCallback,a=e.prototype.disconnectedCallback;return Object.assign(e.prototype,{__registerHost(){fq(this,n)},connectedCallback(){lq(this),r&&r.call(this)},disconnectedCallback(){cq(this),a&&a.call(this)},__attachShadow(){this.attachShadow({mode:"open",delegatesFocus:!!(n.$flags$&16)})}}),e.is=n.$tagName$,iq(e,n)},NO=(e,t,n,r)=>{n&&n.map(([a,i,s])=>{const o=pq(e,a),l=dq(t,s),c=hq(a);or.ael(o,i,l,c),(t.$rmListeners$=t.$rmListeners$||[]).push(()=>or.rel(o,i,l,c))})},dq=(e,t)=>n=>{try{ud.lazyLoad||e.$hostElement$[t](n)}catch(r){Xm(r)}},pq=(e,t)=>t&4?Ii:t&8?L0:t&16?Ii.body:e,hq=e=>gq?{passive:(e&1)!==0,capture:(e&2)!==0}:(e&2)!==0,_O=new WeakMap,Np=e=>_O.get(e),fq=(e,t)=>{const n={$flags$:0,$hostElement$:e,$cmpMeta$:t,$instanceValues$:new Map};return NO(e,n,t.$listeners$),_O.set(e,n)},J_=(e,t)=>t in e,Xm=(e,t)=>(0,console.error)(e,t),av=new Map,AO=[],L0=typeof window<"u"?window:{},Ii=L0.document||{head:{}},cr=L0.HTMLElement||class{},or={$flags$:0,$resourcesUrl$:"",jmp:e=>e(),raf:e=>requestAnimationFrame(e),ael:(e,t,n,r)=>e.addEventListener(t,n,r),rel:(e,t,n,r)=>e.removeEventListener(t,n,r),ce:(e,t)=>new CustomEvent(e,t)},mq=e=>{Object.assign(or,e)},gq=(()=>{let e=!1;try{Ii.addEventListener("e",null,Object.defineProperty({},"passive",{get(){e=!0}}))}catch(t){}return e})(),yq=e=>Promise.resolve(e),bq=(()=>{try{return new CSSStyleSheet,typeof new CSSStyleSheet().replaceSync=="function"}catch(e){}return!1})(),Nk=[],RO=[],DO=(e,t)=>n=>{e.push(n),Tk||(Tk=!0,t&&or.$flags$&4?vq(_k):or.raf(_k))},eA=e=>{for(let t=0;t<e.length;t++)try{e[t](performance.now())}catch(n){Xm(n)}e.length=0},_k=()=>{eA(Nk),eA(RO),(Tk=Nk.length>0)&&or.raf(_k)},vq=e=>yq().then(e),ym=DO(Nk,!1),Ri=DO(RO,!0);/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const ct=typeof window<"u"?window:void 0,i1=typeof document<"u"?document:void 0;/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const Qd=(e,t)=>{e.componentOnReady?e.componentOnReady().then(n=>t(n)):Pr(()=>t(e))},FO=e=>e.componentOnReady!==void 0,P0=(e,t=[])=>{const n={};return t.forEach(r=>{e.hasAttribute(r)&&(e.getAttribute(r)!==null&&(n[r]=e.getAttribute(r)),e.removeAttribute(r))}),n},xq=["role","aria-activedescendant","aria-atomic","aria-autocomplete","aria-braillelabel","aria-brailleroledescription","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colindextext","aria-colspan","aria-controls","aria-current","aria-describedby","aria-description","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowindextext","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext"],MO=(e,t)=>{let n=xq;return t&&t.length>0&&(n=n.filter(r=>!t.includes(r))),P0(e,n)},Ak=(e,t,n,r)=>{var a;if(typeof window<"u"){const i=window,s=(a=i==null?void 0:i.Ionic)===null||a===void 0?void 0:a.config;if(s){const o=s.get("_ael");if(o)return o(e,t,n,r);if(s._ael)return s._ael(e,t,n,r)}}return e.addEventListener(t,n,r)},Rk=(e,t,n,r)=>{var a;if(typeof window<"u"){const i=window,s=(a=i==null?void 0:i.Ionic)===null||a===void 0?void 0:a.config;if(s){const o=s.get("_rel");if(o)return o(e,t,n,r);if(s._rel)return s._rel(e,t,n,r)}}return e.removeEventListener(t,n,r)},No=(e,t=e)=>e.shadowRoot||t,Pr=e=>typeof __zone_symbol__requestAnimationFrame=="function"?__zone_symbol__requestAnimationFrame(e):typeof requestAnimationFrame=="function"?requestAnimationFrame(e):setTimeout(e),wq=e=>!!e.shadowRoot&&!!e.attachShadow,kq=e=>{if(e.focus(),e.classList.contains("ion-focusable")){const t=e.closest("ion-app");t&&t.setFocus([e])}},Jd=(e,t,n)=>Math.max(e,Math.min(t,n)),Jr=(e,t)=>{if(!e){const n="ASSERT: "+t;console.error(n);debugger;throw new Error(n)}},TPe=e=>e.timeStamp||Date.now(),NPe=e=>{if(e){const t=e.changedTouches;if(t&&t.length>0){const n=t[0];return{x:n.clientX,y:n.clientY}}if(e.pageX!==void 0)return{x:e.pageX,y:e.pageY}}return{x:0,y:0}},OO=(e,t)=>{if(e!=null||(e={}),t!=null||(t={}),e===t)return!0;const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!(r in t)||e[r]!==t[r])return!1;return!0};/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */let s1;const Sq=e=>(e.forEach(t=>{for(const n in t)if(t.hasOwnProperty(n)){const r=t[n];if(n==="easing"){const a="animation-timing-function";t[a]=r,delete t[n]}else{const a=Iq(n);a!==n&&(t[a]=r,delete t[n])}}}),e),Iq=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),p$=e=>{if(s1===void 0){const t=e.style.animationName!==void 0,n=e.style.webkitAnimationName!==void 0;s1=!t&&n?"-webkit-":""}return s1},Ht=(e,t,n)=>{const r=t.startsWith("animation")?p$(e):"";e.style.setProperty(r+t,n)},ci=(e,t)=>{const n=t.startsWith("animation")?p$(e):"";e.style.removeProperty(n+t)},$q=(e,t)=>{let n;const r={passive:!0},a=()=>{n&&n()},i=s=>{e===s.target&&(a(),t(s))};return e&&(e.addEventListener("webkitAnimationEnd",i,r),e.addEventListener("animationend",i,r),n=()=>{e.removeEventListener("webkitAnimationEnd",i,r),e.removeEventListener("animationend",i,r)}),a},Cq=(e=[])=>e.map(t=>{const n=t.offset,r=[];for(const a in t)t.hasOwnProperty(a)&&a!=="offset"&&r.push("".concat(a,": ").concat(t[a],";"));return"".concat(n*100,"% { ").concat(r.join(" ")," }")}).join(" "),tA=[],Eq=e=>{let t=tA.indexOf(e);return t<0&&(t=tA.push(e)-1),"ion-animation-".concat(t)},Tq=e=>{const t=e.getRootNode!==void 0?e.getRootNode():e;return t.head||t},Nq=(e,t,n)=>{var r;const a=Tq(n),i=p$(n),s=a.querySelector("#"+e);if(s)return s;const o=((r=n.ownerDocument)!==null&&r!==void 0?r:document).createElement("style");return o.id=e,o.textContent="@".concat(i,"keyframes ").concat(e," { ").concat(t," } @").concat(i,"keyframes ").concat(e,"-alt { ").concat(t," }"),a.appendChild(o),o},Ly=(e=[],t)=>{if(t!==void 0){const n=Array.isArray(t)?t:[t];return[...e,...n]}return e},pn=e=>{let t,n,r,a,i,s,o=[],l=[],c=[],u=!1,d,p={},h=[],f=[],m={},g=0,y=!1,b=!1,v,x,w,$,C=!0,E=!1,_=!0,R,N,I=!1;const O=e,P=[],L=[],U=[],D=[],F=[],z=[],B=[],j=[],Y=[],Q=[],ae=typeof AnimationEffect=="function"||ct!==void 0&&typeof ct.AnimationEffect=="function",se=typeof Element=="function"&&typeof Element.prototype.animate=="function"&&ae,fe=100,me=()=>Q,he=te=>(D.forEach(ge=>{ge.destroy(te)}),Te(te),U.length=0,D.length=0,o.length=0,pt(),u=!1,_=!0,N),Te=te=>{Je(),te&&tt()},Fe=()=>{y=!1,b=!1,_=!0,x=void 0,w=void 0,$=void 0,g=0,E=!1,C=!0,I=!1},Ve=()=>g!==0&&!I,Pe=(te,ge)=>((ge!=null&&ge.oneTimeCallback?L:P).push({c:te,o:ge}),N),pt=()=>(P.length=0,L.length=0,N),Je=()=>{if(se)Q.forEach(te=>{te.cancel()}),Q.length=0;else{const te=U.slice();Pr(()=>{te.forEach(ge=>{ci(ge,"animation-name"),ci(ge,"animation-duration"),ci(ge,"animation-timing-function"),ci(ge,"animation-iteration-count"),ci(ge,"animation-delay"),ci(ge,"animation-play-state"),ci(ge,"animation-fill-mode"),ci(ge,"animation-direction")})})}},tt=()=>{F.forEach(te=>{te!=null&&te.parentNode&&te.parentNode.removeChild(te)}),F.length=0},Le=te=>(z.push(te),N),st=te=>(B.push(te),N),gt=te=>(j.push(te),N),pr=te=>(Y.push(te),N),Ot=te=>(l=Ly(l,te),N),Qn=te=>(c=Ly(c,te),N),yn=(te={})=>(p=te,N),Jn=(te=[])=>{for(const ge of te)p[ge]="";return N},Yr=te=>(h=Ly(h,te),N),hr=te=>(f=Ly(f,te),N),er=(te={})=>(m=te,N),bn=(te=[])=>{for(const ge of te)m[ge]="";return N},Tn=()=>i!==void 0?i:d?d.getFill():"both",Mr=()=>x!==void 0?x:s!==void 0?s:d?d.getDirection():"normal",ii=()=>y?"linear":r!==void 0?r:d?d.getEasing():"linear",on=()=>b?0:w!==void 0?w:n!==void 0?n:d?d.getDuration():0,Zr=()=>a!==void 0?a:d?d.getIterations():1,tr=()=>$!==void 0?$:t!==void 0?t:d?d.getDelay():0,Bi=()=>o,vn=te=>(s=te,Rt(!0),N),Zc=te=>(i=te,Rt(!0),N),Qc=te=>(t=te,Rt(!0),N),Jc=te=>(r=te,Rt(!0),N),ed=te=>(!se&&te===0&&(te=1),n=te,Rt(!0),N),si=te=>(a=te,Rt(!0),N),Gs=te=>(d=te,N),td=te=>{if(te!=null)if(te.nodeType===1)U.push(te);else if(te.length>=0)for(let ge=0;ge<te.length;ge++)U.push(te[ge]);else console.error("Invalid addElement value");return N},ps=te=>{if(te!=null)if(Array.isArray(te))for(const ge of te)ge.parent(N),D.push(ge);else te.parent(N),D.push(te);return N},hs=te=>{const ge=o!==te;return o=te,ge&&nd(o),N},nd=te=>{se?me().forEach(ge=>{if(ge.effect.setKeyframes)ge.effect.setKeyframes(te);else{const Ne=new KeyframeEffect(ge.effect.target,te,ge.effect.getTiming());ge.effect=Ne}}):ve()},ie=()=>{z.forEach(ln=>ln()),B.forEach(ln=>ln());const te=l,ge=c,Ne=p;U.forEach(ln=>{const Nn=ln.classList;te.forEach(_n=>Nn.add(_n)),ge.forEach(_n=>Nn.remove(_n));for(const _n in Ne)Ne.hasOwnProperty(_n)&&Ht(ln,_n,Ne[_n])})},ue=()=>{qs(),j.forEach(Nn=>Nn()),Y.forEach(Nn=>Nn());const te=C?1:0,ge=h,Ne=f,ln=m;U.forEach(Nn=>{const _n=Nn.classList;ge.forEach(li=>_n.add(li)),Ne.forEach(li=>_n.remove(li));for(const li in ln)ln.hasOwnProperty(li)&&Ht(Nn,li,ln[li])}),P.forEach(Nn=>Nn.c(te,N)),L.forEach(Nn=>Nn.c(te,N)),L.length=0,_=!0,C&&(E=!0),C=!0},Ce=()=>{g!==0&&(g--,g===0&&(ue(),d&&d.animationFinish()))},ve=(te=!0)=>{tt();const ge=Sq(o);U.forEach(Ne=>{if(ge.length>0){const ln=Cq(ge);R=e!==void 0?e:Eq(ln);const Nn=Nq(R,ln,Ne);F.push(Nn),Ht(Ne,"animation-duration","".concat(on(),"ms")),Ht(Ne,"animation-timing-function",ii()),Ht(Ne,"animation-delay","".concat(tr(),"ms")),Ht(Ne,"animation-fill-mode",Tn()),Ht(Ne,"animation-direction",Mr());const _n=Zr()===1/0?"infinite":Zr().toString();Ht(Ne,"animation-iteration-count",_n),Ht(Ne,"animation-play-state","paused"),te&&Ht(Ne,"animation-name","".concat(Nn.id,"-alt")),Pr(()=>{Ht(Ne,"animation-name",Nn.id||null)})}})},yt=()=>{U.forEach(te=>{const ge=te.animate(o,{id:O,delay:tr(),duration:on(),easing:ii(),iterations:Zr(),fill:Tn(),direction:Mr()});ge.pause(),Q.push(ge)}),Q.length>0&&(Q[0].onfinish=()=>{Ce()})},$t=(te=!0)=>{ie(),o.length>0&&(se?yt():ve(te)),u=!0},ze=te=>{if(te=Math.min(Math.max(te,0),.9999),se)Q.forEach(ge=>{ge.currentTime=ge.effect.getComputedTiming().delay+on()*te,ge.pause()});else{const ge="-".concat(on()*te,"ms");U.forEach(Ne=>{o.length>0&&(Ht(Ne,"animation-delay",ge),Ht(Ne,"animation-play-state","paused"))})}},Be=te=>{Q.forEach(ge=>{ge.effect.updateTiming({delay:tr(),duration:on(),easing:ii(),iterations:Zr(),fill:Tn(),direction:Mr()})}),te!==void 0&&ze(te)},Ut=(te=!0,ge)=>{Pr(()=>{U.forEach(Ne=>{Ht(Ne,"animation-name",R||null),Ht(Ne,"animation-duration","".concat(on(),"ms")),Ht(Ne,"animation-timing-function",ii()),Ht(Ne,"animation-delay",ge!==void 0?"-".concat(ge*on(),"ms"):"".concat(tr(),"ms")),Ht(Ne,"animation-fill-mode",Tn()||null),Ht(Ne,"animation-direction",Mr()||null);const ln=Zr()===1/0?"infinite":Zr().toString();Ht(Ne,"animation-iteration-count",ln),te&&Ht(Ne,"animation-name","".concat(R,"-alt")),Pr(()=>{Ht(Ne,"animation-name",R||null)})})})},Rt=(te=!1,ge=!0,Ne)=>(te&&D.forEach(ln=>{ln.update(te,ge,Ne)}),se?Be(Ne):Ut(ge,Ne),N),oi=(te=!1,ge)=>(D.forEach(Ne=>{Ne.progressStart(te,ge)}),ul(),y=te,u||$t(),Rt(!1,!0,ge),N),rd=te=>(D.forEach(ge=>{ge.progressStep(te)}),ze(te),N),ll=(te,ge,Ne)=>(y=!1,D.forEach(ln=>{ln.progressEnd(te,ge,Ne)}),Ne!==void 0&&(w=Ne),E=!1,C=!0,te===0?(x=Mr()==="reverse"?"normal":"reverse",x==="reverse"&&(C=!1),se?(Rt(),ze(1-ge)):($=(1-ge)*on()*-1,Rt(!1,!1))):te===1&&(se?(Rt(),ze(ge)):($=ge*on()*-1,Rt(!1,!1))),te!==void 0&&(Pe(()=>{w=void 0,x=void 0,$=void 0},{oneTimeCallback:!0}),d||cy()),N),ul=()=>{u&&(se?Q.forEach(te=>{te.pause()}):U.forEach(te=>{Ht(te,"animation-play-state","paused")}),I=!0)},Wn=()=>(D.forEach(te=>{te.pause()}),ul(),N),Wi=()=>{v=void 0,Ce()},qs=()=>{v&&clearTimeout(v)},xw=()=>{if(qs(),Pr(()=>{U.forEach(te=>{o.length>0&&Ht(te,"animation-play-state","running")})}),o.length===0||U.length===0)Ce();else{const te=tr()||0,ge=on()||0,Ne=Zr()||1;isFinite(Ne)&&(v=setTimeout(Wi,te+ge*Ne+fe)),$q(U[0],()=>{qs(),Pr(()=>{rf(),Pr(Ce)})})}},rf=()=>{U.forEach(te=>{ci(te,"animation-duration"),ci(te,"animation-delay"),ci(te,"animation-play-state")})},ww=()=>{Q.forEach(te=>{te.play()}),(o.length===0||U.length===0)&&Ce()},kw=()=>{se?(ze(0),Be()):Ut()},cy=te=>new Promise(ge=>{te!=null&&te.sync&&(b=!0,Pe(()=>b=!1,{oneTimeCallback:!0})),u||$t(),E&&(kw(),E=!1),_&&(g=D.length+1,_=!1),Pe(()=>ge(),{oneTimeCallback:!0}),D.forEach(Ne=>{Ne.play()}),se?ww():xw(),I=!1}),cl=()=>{D.forEach(te=>{te.stop()}),u&&(Je(),u=!1),Fe()},dy=(te,ge)=>{const Ne=o[0];return Ne!==void 0&&(Ne.offset===void 0||Ne.offset===0)?Ne[te]=ge:o=[{offset:0,[te]:ge},...o],N};return N={parentAnimation:d,elements:U,childAnimations:D,id:O,animationFinish:Ce,from:dy,to:(te,ge)=>{const Ne=o[o.length-1];return Ne!==void 0&&(Ne.offset===void 0||Ne.offset===1)?Ne[te]=ge:o=[...o,{offset:1,[te]:ge}],N},fromTo:(te,ge,Ne)=>dy(te,ge).to(te,Ne),parent:Gs,play:cy,pause:Wn,stop:cl,destroy:he,keyframes:hs,addAnimation:ps,addElement:td,update:Rt,fill:Zc,direction:vn,iterations:si,duration:ed,easing:Jc,delay:Qc,getWebAnimations:me,getKeyframes:Bi,getFill:Tn,getDirection:Mr,getDelay:tr,getIterations:Zr,getEasing:ii,getDuration:on,afterAddRead:gt,afterAddWrite:pr,afterClearStyles:bn,afterStyles:er,afterRemoveClass:hr,afterAddClass:Yr,beforeAddRead:Le,beforeAddWrite:st,beforeClearStyles:Jn,beforeStyles:yn,beforeRemoveClass:Qn,beforeAddClass:Ot,onFinish:Pe,isRunning:Ve,progressStart:oi,progressStep:rd,progressEnd:ll}},_q="ionViewWillEnter",Aq="ionViewDidEnter",LO="ionViewWillLeave",PO="ionViewDidLeave",o1="ionViewWillUnload",Rq=()=>gi(()=>import("./ios.transition-3d1e843e.js"),[]),Dq=()=>gi(()=>import("./md.transition-5512d6d0.js"),[]),zO=e=>new Promise((t,n)=>{Ri(()=>{Fq(e),Mq(e).then(r=>{r.animation&&r.animation.destroy(),nA(e),t(r)},r=>{nA(e),n(r)})})}),Fq=e=>{const t=e.enteringEl,n=e.leavingEl;Uq(t,n,e.direction),e.showGoBack?t.classList.add("can-go-back"):t.classList.remove("can-go-back"),Dk(t,!1),t.style.setProperty("pointer-events","none"),n&&(Dk(n,!1),n.style.setProperty("pointer-events","none"))},Mq=async e=>{const t=await Oq(e);return t&&A8.isBrowser?Lq(t,e):Pq(e)},nA=e=>{const t=e.enteringEl,n=e.leavingEl;t.classList.remove("ion-page-invisible"),t.style.removeProperty("pointer-events"),n!==void 0&&(n.classList.remove("ion-page-invisible"),n.style.removeProperty("pointer-events"))},Oq=async e=>!e.leavingEl||!e.animated||e.duration===0?void 0:e.animationBuilder?e.animationBuilder:e.mode==="ios"?(await Rq()).iosTransitionAnimation:(await Dq()).mdTransitionAnimation,Lq=async(e,t)=>{await BO(t,!0);const n=e(t.baseEl,t);WO(t.enteringEl,t.leavingEl);const r=await Bq(n,t);return t.progressCallback&&t.progressCallback(void 0),r&&UO(t.enteringEl,t.leavingEl),{hasCompleted:r,animation:n}},Pq=async e=>{const t=e.enteringEl,n=e.leavingEl;return await BO(e,!1),WO(t,n),UO(t,n),{hasCompleted:!0}},BO=async(e,t)=>{(e.deepWait!==void 0?e.deepWait:t)&&await Promise.all([iv(e.enteringEl),iv(e.leavingEl)]),await zq(e.viewIsReady,e.enteringEl)},zq=async(e,t)=>{e&&await e(t)},Bq=(e,t)=>{const n=t.progressCallback,r=new Promise(a=>{e.onFinish(i=>a(i===1))});return n?(e.progressStart(!0),n(e)):e.play(),r},WO=(e,t)=>{ws(t,LO),ws(e,_q)},UO=(e,t)=>{ws(e,Aq),ws(t,PO)},ws=(e,t)=>{if(e){const n=new CustomEvent(t,{bubbles:!1,cancelable:!1});e.dispatchEvent(n)}},Wq=()=>new Promise(e=>Pr(()=>Pr(()=>e()))),iv=async e=>{const t=e;if(t){if(t.componentOnReady!=null){if(await t.componentOnReady()!=null)return}else if(t.__registerHost!=null){await new Promise(r=>Pr(r));return}await Promise.all(Array.from(t.children).map(iv))}},Dk=(e,t)=>{t?(e.setAttribute("aria-hidden","true"),e.classList.add("ion-page-hidden")):(e.hidden=!1,e.removeAttribute("aria-hidden"),e.classList.remove("ion-page-hidden"))},Uq=(e,t,n)=>{e!==void 0&&(e.style.zIndex=n==="back"?"99":"101"),t!==void 0&&(t.style.zIndex="100")},_Pe=e=>{if(e.classList.contains("ion-page"))return e;const t=e.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs");return t||e};/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const ep=(e,t,n,r,a)=>Hq(e[1],t[1],n[1],r[1],a).map(i=>Vq(e[0],t[0],n[0],r[0],i)),Vq=(e,t,n,r,a)=>{const i=3*t*Math.pow(a-1,2),s=-3*n*a+3*n+r*a,o=e*Math.pow(a-1,3);return a*(i+a*s)-o},Hq=(e,t,n,r,a)=>(e-=a,t-=a,n-=a,r-=a,Gq(r-3*n+3*t-e,3*n-6*t+3*e,3*t-3*e,e).filter(s=>s>=0&&s<=1)),jq=(e,t,n)=>{const r=t*t-4*e*n;return r<0?[]:[(-t+Math.sqrt(r))/(2*e),(-t-Math.sqrt(r))/(2*e)]},Gq=(e,t,n,r)=>{if(e===0)return jq(t,n,r);t/=e,n/=e,r/=e;const a=(3*n-t*t)/3,i=(2*t*t*t-9*t*n+27*r)/27;if(a===0)return[Math.pow(-i,1/3)];if(i===0)return[Math.sqrt(-a),-Math.sqrt(-a)];const s=Math.pow(i/2,2)+Math.pow(a/3,3);if(s===0)return[Math.pow(i/2,1/2)-t/3];if(s>0)return[Math.pow(-(i/2)+Math.sqrt(s),1/3)-Math.pow(i/2+Math.sqrt(s),1/3)-t/3];const o=Math.sqrt(Math.pow(-(a/3),3)),l=Math.acos(-(i/(2*Math.sqrt(Math.pow(-(a/3),3))))),c=2*Math.pow(o,1/3);return[c*Math.cos(l/3)-t/3,c*Math.cos((l+2*Math.PI)/3)-t/3,c*Math.cos((l+4*Math.PI)/3)-t/3]};/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */class qq{constructor(){this.gestureId=0,this.requestedStart=new Map,this.disabledGestures=new Map,this.disabledScroll=new Set}createGesture(t){var n;return new Kq(this,this.newID(),t.name,(n=t.priority)!==null&&n!==void 0?n:0,!!t.disableScroll)}createBlocker(t={}){return new Xq(this,this.newID(),t.disable,!!t.disableScroll)}start(t,n,r){return this.canStart(t)?(this.requestedStart.set(n,r),!0):(this.requestedStart.delete(n),!1)}capture(t,n,r){if(!this.start(t,n,r))return!1;const a=this.requestedStart;let i=-1e4;if(a.forEach(s=>{i=Math.max(i,s)}),i===r){this.capturedId=n,a.clear();const s=new CustomEvent("ionGestureCaptured",{detail:{gestureName:t}});return document.dispatchEvent(s),!0}return a.delete(n),!1}release(t){this.requestedStart.delete(t),this.capturedId===t&&(this.capturedId=void 0)}disableGesture(t,n){let r=this.disabledGestures.get(t);r===void 0&&(r=new Set,this.disabledGestures.set(t,r)),r.add(n)}enableGesture(t,n){const r=this.disabledGestures.get(t);r!==void 0&&r.delete(n)}disableScroll(t){this.disabledScroll.add(t),this.disabledScroll.size===1&&document.body.classList.add(rA)}enableScroll(t){this.disabledScroll.delete(t),this.disabledScroll.size===0&&document.body.classList.remove(rA)}canStart(t){return!(this.capturedId!==void 0||this.isDisabled(t))}isCaptured(){return this.capturedId!==void 0}isScrollDisabled(){return this.disabledScroll.size>0}isDisabled(t){const n=this.disabledGestures.get(t);return!!(n&&n.size>0)}newID(){return this.gestureId++,this.gestureId}}class Kq{constructor(t,n,r,a,i){this.id=n,this.name=r,this.disableScroll=i,this.priority=a*1e6+n,this.ctrl=t}canStart(){return this.ctrl?this.ctrl.canStart(this.name):!1}start(){return this.ctrl?this.ctrl.start(this.name,this.id,this.priority):!1}capture(){if(!this.ctrl)return!1;const t=this.ctrl.capture(this.name,this.id,this.priority);return t&&this.disableScroll&&this.ctrl.disableScroll(this.id),t}release(){this.ctrl&&(this.ctrl.release(this.id),this.disableScroll&&this.ctrl.enableScroll(this.id))}destroy(){this.release(),this.ctrl=void 0}}class Xq{constructor(t,n,r,a){this.id=n,this.disable=r,this.disableScroll=a,this.ctrl=t}block(){if(this.ctrl){if(this.disable)for(const t of this.disable)this.ctrl.disableGesture(t,this.id);this.disableScroll&&this.ctrl.disableScroll(this.id)}}unblock(){if(this.ctrl){if(this.disable)for(const t of this.disable)this.ctrl.enableGesture(t,this.id);this.disableScroll&&this.ctrl.enableScroll(this.id)}}destroy(){this.unblock(),this.ctrl=void 0}}const rA="backdrop-no-scroll",h$=new qq;/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const dl=(e,t,n,r)=>{const a=Yq(e)?{capture:!!r.capture,passive:!!r.passive}:!!r.capture;let i,s;return e.__zone_symbol__addEventListener?(i="__zone_symbol__addEventListener",s="__zone_symbol__removeEventListener"):(i="addEventListener",s="removeEventListener"),e[i](t,n,a),()=>{e[s](t,n,a)}},Yq=e=>{if(Py===void 0)try{const t=Object.defineProperty({},"passive",{get:()=>{Py=!0}});e.addEventListener("optsTest",()=>{},t)}catch(t){Py=!1}return!!Py};let Py;const Zq=2e3,Qq=(e,t,n,r,a)=>{let i,s,o,l,c,u,d,p=0;const h=$=>{p=Date.now()+Zq,t($)&&(!s&&n&&(s=dl(e,"touchmove",n,a)),o||(o=dl($.target,"touchend",m,a)),l||(l=dl($.target,"touchcancel",m,a)))},f=$=>{p>Date.now()||t($)&&(!u&&n&&(u=dl(aA(e),"mousemove",n,a)),d||(d=dl(aA(e),"mouseup",g,a)))},m=$=>{y(),r&&r($)},g=$=>{b(),r&&r($)},y=()=>{s&&s(),o&&o(),l&&l(),s=o=l=void 0},b=()=>{u&&u(),d&&d(),u=d=void 0},v=()=>{y(),b()},x=($=!0)=>{$?(i||(i=dl(e,"touchstart",h,a)),c||(c=dl(e,"mousedown",f,a))):(i&&i(),c&&c(),i=c=void 0,v())};return{enable:x,stop:v,destroy:()=>{x(!1),r=n=t=void 0}}},aA=e=>e instanceof Document?e:e.ownerDocument,Jq=(e,t,n)=>{const r=n*(Math.PI/180),a=e==="x",i=Math.cos(r),s=t*t;let o=0,l=0,c=!1,u=0;return{start(d,p){o=d,l=p,u=0,c=!0},detect(d,p){if(!c)return!1;const h=d-o,f=p-l,m=h*h+f*f;if(m<s)return!1;const g=Math.sqrt(m),y=(a?h:f)/g;return y>i?u=1:y<-i?u=-1:u=0,c=!1,!0},isGesture(){return u!==0},getDirection(){return u}}},f$=e=>{let t=!1,n=!1,r=!0,a=!1;const i=Object.assign({disableScroll:!1,direction:"x",gesturePriority:0,passive:!0,maxAngle:40,threshold:10},e),s=i.canStart,o=i.onWillStart,l=i.onStart,c=i.onEnd,u=i.notCaptured,d=i.onMove,p=i.threshold,h=i.passive,f=i.blurOnStart,m={type:"pan",startX:0,startY:0,startTime:0,currentX:0,currentY:0,velocityX:0,velocityY:0,deltaX:0,deltaY:0,currentTime:0,event:void 0,data:void 0},g=Jq(i.direction,i.threshold,i.maxAngle),y=h$.createGesture({name:e.gestureName,priority:e.gesturePriority,disableScroll:e.disableScroll}),b=I=>{const O=HO(I);return n||!r||(VO(I,m),m.startX=m.currentX,m.startY=m.currentY,m.startTime=m.currentTime=O,m.velocityX=m.velocityY=m.deltaX=m.deltaY=0,m.event=I,s&&s(m)===!1)||(y.release(),!y.start())?!1:(n=!0,p===0?w():(g.start(m.startX,m.startY),!0))},v=I=>{if(t){!a&&r&&(a=!0,l1(m,I),requestAnimationFrame(x));return}l1(m,I),g.detect(m.currentX,m.currentY)&&(!g.isGesture()||!w())&&N()},x=()=>{t&&(a=!1,d&&d(m))},w=()=>y.capture()?(t=!0,r=!1,m.startX=m.currentX,m.startY=m.currentY,m.startTime=m.currentTime,o?o(m).then(C):C(),!0):!1,$=()=>{if(typeof document<"u"){const I=document.activeElement;I!=null&&I.blur&&I.blur()}},C=()=>{f&&$(),l&&l(m),r=!0},E=()=>{t=!1,n=!1,a=!1,r=!0,y.release()},_=I=>{const O=t,P=r;if(E(),!!P){if(l1(m,I),O){c&&c(m);return}u&&u(m)}},R=Qq(i.el,b,v,_,{capture:!1,passive:h}),N=()=>{E(),R.stop(),u&&u(m)};return{enable(I=!0){I||(t&&_(void 0),E()),R.enable(I)},destroy(){y.destroy(),R.destroy()}}},l1=(e,t)=>{if(!t)return;const n=e.currentX,r=e.currentY,a=e.currentTime;VO(t,e);const i=e.currentX,s=e.currentY,l=(e.currentTime=HO(t))-a;if(l>0&&l<100){const c=(i-n)/l,u=(s-r)/l;e.velocityX=c*.7+e.velocityX*.3,e.velocityY=u*.7+e.velocityY*.3}e.deltaX=i-e.startX,e.deltaY=s-e.startY,e.event=t},VO=(e,t)=>{let n=0,r=0;if(e){const a=e.changedTouches;if(a&&a.length>0){const i=a[0];n=i.clientX,r=i.clientY}else e.pageX!==void 0&&(n=e.pageX,r=e.pageY)}t.currentX=n,t.currentY=r},HO=e=>e.timeStamp||Date.now(),eK=Object.freeze(Object.defineProperty({__proto__:null,GESTURE_CONTROLLER:h$,createGesture:f$},Symbol.toStringTag,{value:"Module"}));/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */class tK{constructor(){this.m=new Map}reset(t){this.m=new Map(Object.entries(t))}get(t,n){const r=this.m.get(t);return r!==void 0?r:n}getBoolean(t,n=!1){const r=this.m.get(t);return r===void 0?n:typeof r=="string"?r==="true":!!r}getNumber(t,n){const r=parseFloat(this.m.get(t));return isNaN(r)?n!==void 0?n:NaN:r}set(t,n){this.m.set(t,n)}}const Ft=new tK,nK=e=>{try{const t=e.sessionStorage.getItem(jO);return t!==null?JSON.parse(t):{}}catch(t){return{}}},rK=(e,t)=>{try{e.sessionStorage.setItem(jO,JSON.stringify(t))}catch(n){return}},aK=e=>{const t={};return e.location.search.slice(1).split("&").map(n=>n.split("=")).map(([n,r])=>[decodeURIComponent(n),decodeURIComponent(r)]).filter(([n])=>iK(n,iA)).map(([n,r])=>[n.slice(iA.length),r]).forEach(([n,r])=>{t[n]=r}),t},iK=(e,t)=>e.substr(0,t.length)===t,iA="ionic:",jO="ionic-persist-config",sK=e=>GO(e),oo=(e,t)=>(typeof e=="string"&&(t=e,e=void 0),sK(e).includes(t)),GO=(e=window)=>{if(typeof e>"u")return[];e.Ionic=e.Ionic||{};let t=e.Ionic.platforms;return t==null&&(t=e.Ionic.platforms=oK(e),t.forEach(n=>e.document.documentElement.classList.add("plt-".concat(n)))),t},oK=e=>{const t=Ft.get("platform");return Object.keys(sA).filter(n=>{const r=t==null?void 0:t[n];return typeof r=="function"?r(e):sA[n](e)})},lK=e=>z0(e)&&!KO(e),m$=e=>!!(ql(e,/iPad/i)||ql(e,/Macintosh/i)&&z0(e)),uK=e=>ql(e,/iPhone/i),cK=e=>ql(e,/iPhone|iPod/i)||m$(e),qO=e=>ql(e,/android|sink/i),dK=e=>qO(e)&&!ql(e,/mobile/i),pK=e=>{const t=e.innerWidth,n=e.innerHeight,r=Math.min(t,n),a=Math.max(t,n);return r>390&&r<520&&a>620&&a<800},hK=e=>{const t=e.innerWidth,n=e.innerHeight,r=Math.min(t,n),a=Math.max(t,n);return m$(e)||dK(e)||r>460&&r<820&&a>780&&a<1400},z0=e=>yK(e,"(any-pointer:coarse)"),fK=e=>!z0(e),KO=e=>XO(e)||YO(e),XO=e=>!!(e.cordova||e.phonegap||e.PhoneGap),YO=e=>{const t=e.Capacitor;return!!(t!=null&&t.isNative)},mK=e=>ql(e,/electron/i),gK=e=>{var t;return!!(!((t=e.matchMedia)===null||t===void 0)&&t.call(e,"(display-mode: standalone)").matches||e.navigator.standalone)},ql=(e,t)=>t.test(e.navigator.userAgent),yK=(e,t)=>{var n;return(n=e.matchMedia)===null||n===void 0?void 0:n.call(e,t).matches},sA={ipad:m$,iphone:uK,ios:cK,android:qO,phablet:pK,tablet:hK,cordova:XO,capacitor:YO,electron:mK,pwa:gK,mobile:z0,mobileweb:lK,desktop:fK,hybrid:KO};let pd;const zt=e=>e&&W8(e)||pd,bK=(e={})=>{if(typeof window>"u")return;const t=window.document,n=window,r=n.Ionic=n.Ionic||{},a={};e._ael&&(a.ael=e._ael),e._rel&&(a.rel=e._rel),e._ce&&(a.ce=e._ce),mq(a);const i=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},nK(n)),{persistConfig:!1}),r.config),aK(n)),e);Ft.reset(i),Ft.getBoolean("persistConfig")&&rK(n,i),GO(n),r.config=Ft,r.mode=pd=Ft.get("mode",t.documentElement.getAttribute("mode")||(oo(n,"ios")?"ios":"md")),Ft.set("mode",pd),t.documentElement.setAttribute("mode",pd),t.documentElement.classList.add(pd),Ft.getBoolean("_testing")&&Ft.set("animated",!1);const s=l=>{var c;return(c=l.tagName)===null||c===void 0?void 0:c.startsWith("ION-")},o=l=>["ios","md"].includes(l);B8(l=>{for(;l;){const c=l.mode||l.getAttribute("mode");if(c){if(o(c))return c;s(l)&&console.warn('Invalid ionic mode: "'+c+'", expected: "ios" or "md"')}l=l.parentElement}return pd})};/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const vK=()=>{document.addEventListener("backbutton",()=>{})},xK=()=>{const e=document;let t=!1;e.addEventListener("backbutton",()=>{if(t)return;let n=0,r=[];const a=new CustomEvent("ionBackButton",{bubbles:!1,detail:{register(o,l){r.push({priority:o,handler:l,id:n++})}}});e.dispatchEvent(a);const i=async o=>{try{if(o!=null&&o.handler){const l=o.handler(s);l!=null&&await l}}catch(l){console.error(l)}},s=()=>{if(r.length>0){let o={priority:Number.MIN_SAFE_INTEGER,handler:()=>{},id:-1};r.forEach(l=>{l.priority>=o.priority&&(o=l)}),t=!0,r=r.filter(l=>l.id!==o.id),i(o).then(()=>t=!1)}};s()})},ZO=100,wK=99,kK=Object.freeze(Object.defineProperty({__proto__:null,MENU_BACK_BUTTON_PRIORITY:wK,OVERLAY_BACK_BUTTON_PRIORITY:ZO,blockHardwareBackButton:vK,startHardwareBackButton:xK},Symbol.toStringTag,{value:"Module"}));/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const g$=async(e,t,n,r,a,i)=>{var s;if(e)return e.attachViewToDom(t,n,a,r);if(!i&&typeof n!="string"&&!(n instanceof HTMLElement))throw new Error("framework delegate is missing");const o=typeof n=="string"?(s=t.ownerDocument)===null||s===void 0?void 0:s.createElement(n):n;return r&&r.forEach(l=>o.classList.add(l)),a&&Object.assign(o,a),t.appendChild(o),await new Promise(l=>Qd(o,l)),o},QO=(e,t)=>{if(t){if(e){const n=t.parentElement;return e.removeViewFromDom(n,t)}t.remove()}return Promise.resolve()},SK=()=>{let e,t;return{attachViewToDom:async(a,i,s={},o=[])=>{var l,c;if(e=a,i){const d=typeof i=="string"?(l=e.ownerDocument)===null||l===void 0?void 0:l.createElement(i):i;o.forEach(p=>d.classList.add(p)),Object.assign(d,s),e.appendChild(d),await new Promise(p=>Qd(d,p))}else if(e.children.length>0&&(e.tagName==="ION-MODAL"||e.tagName==="ION-POPOVER")&&!e.children[0].classList.contains("ion-delegate-host")){const p=(c=e.ownerDocument)===null||c===void 0?void 0:c.createElement("div");p.classList.add("ion-delegate-host"),o.forEach(h=>p.classList.add(h)),p.append(...e.children),e.appendChild(p)}const u=document.querySelector("ion-app")||document.body;return t=document.createComment("ionic teleport"),e.parentNode.insertBefore(t,e),u.appendChild(e),e},removeViewFromDom:()=>(e&&t&&(t.parentNode.insertBefore(e,t),t.remove()),Promise.resolve())}};/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const Pd=(e,...t)=>console.warn("[Ionic Warning]: ".concat(e),...t),IK=(e,...t)=>console.error("<".concat(e.tagName.toLowerCase(),"> must be used inside ").concat(t.join(" or "),"."));/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */let Fk=0,$K=0;const sv=new WeakMap,CK=e=>{typeof document<"u"&&_K(document);const t=Fk++;e.overlayIndex=t},EK=e=>(e.hasAttribute("id")||(e.id="ion-overlay-".concat(++$K)),e.id),bm='[tabindex]:not([tabindex^="-"]):not([hidden]):not([disabled]), input:not([type=hidden]):not([tabindex^="-"]):not([hidden]):not([disabled]), textarea:not([tabindex^="-"]):not([hidden]):not([disabled]), button:not([tabindex^="-"]):not([hidden]):not([disabled]), select:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable[disabled="false"]:not([tabindex^="-"]):not([hidden])',oA=(e,t)=>{let n=e.querySelector(bm);const r=n==null?void 0:n.shadowRoot;r&&(n=r.querySelector(bm)||n),n?kq(n):t.focus()},TK=e=>e.classList.contains("overlay-hidden"),lA=(e,t)=>{const n=Array.from(e.querySelectorAll(bm));let r=n.length>0?n[n.length-1]:null;const a=r==null?void 0:r.shadowRoot;a&&(r=a.querySelector(bm)||r),r?r.focus():t.focus()},NK=(e,t)=>{const n=Mk(t,"ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker,ion-popover"),r=e.target;if(!n||!r||n.classList.contains("ion-disable-focus-trap"))return;const a=()=>{if(n===r)n.lastFocus=void 0;else{const s=No(n);if(!s.contains(r))return;const o=s.querySelector(".ion-overlay-wrapper");if(!o)return;if(o.contains(r)||r===s.querySelector("ion-backdrop"))n.lastFocus=r;else{const l=n.lastFocus;oA(o,n),l===t.activeElement&&lA(o,n),n.lastFocus=t.activeElement}}},i=()=>{if(n.contains(r))n.lastFocus=r;else{const s=n.lastFocus;oA(n,n),s===t.activeElement&&lA(n,n),n.lastFocus=t.activeElement}};n.shadowRoot?i():a()},_K=e=>{Fk===0&&(Fk=1,e.addEventListener("focus",t=>{NK(t,e)},!0),e.addEventListener("ionBackButton",t=>{const n=Mk(e);n!=null&&n.backdropDismiss&&t.detail.register(ZO,()=>n.dismiss(void 0,Ok))}),e.addEventListener("keydown",t=>{if(t.key==="Escape"){const n=Mk(e);n!=null&&n.backdropDismiss&&n.dismiss(void 0,Ok)}}))},AK=(e,t)=>(t===void 0&&(t="ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker,ion-popover,ion-toast"),Array.from(e.querySelectorAll(t)).filter(n=>n.overlayIndex>0)),Mk=(e,t,n)=>{const r=AK(e,t).filter(a=>!TK(a));return n===void 0?r[r.length-1]:r.find(a=>a.id===n)},JO=(e=!1)=>{const n=MK(document).querySelector("ion-router-outlet, ion-nav, #ion-view-container-root");n&&(e?n.setAttribute("aria-hidden","true"):n.removeAttribute("aria-hidden"))},RK=async(e,t,n,r,a)=>{var i,s;if(e.presented)return;JO(!0),e.presented=!0,e.willPresent.emit(),(i=e.willPresentShorthand)===null||i===void 0||i.emit();const o=zt(e),l=e.enterAnimation?e.enterAnimation:Ft.get(t,o==="ios"?n:r);await eL(e,l,e.el,a)&&(e.didPresent.emit(),(s=e.didPresentShorthand)===null||s===void 0||s.emit()),e.el.tagName!=="ION-TOAST"&&DK(e.el),e.keyboardClose&&(document.activeElement===null||!e.el.contains(document.activeElement))&&e.el.focus()},DK=async e=>{let t=document.activeElement;if(!t)return;const n=t==null?void 0:t.shadowRoot;n&&(t=n.querySelector(bm)||t),await e.onDidDismiss(),t.focus()},FK=async(e,t,n,r,a,i,s)=>{var o,l;if(!e.presented)return!1;JO(!1),e.presented=!1;try{e.el.style.setProperty("pointer-events","none"),e.willDismiss.emit({data:t,role:n}),(o=e.willDismissShorthand)===null||o===void 0||o.emit({data:t,role:n});const c=zt(e),u=e.leaveAnimation?e.leaveAnimation:Ft.get(r,c==="ios"?a:i);n!==Hf&&await eL(e,u,e.el,s),e.didDismiss.emit({data:t,role:n}),(l=e.didDismissShorthand)===null||l===void 0||l.emit({data:t,role:n}),sv.delete(e),e.el.classList.add("overlay-hidden"),e.el.style.removeProperty("pointer-events"),e.el.lastFocus!==void 0&&(e.el.lastFocus=void 0)}catch(c){console.error(c)}return e.el.remove(),!0},MK=e=>e.querySelector("ion-app")||e.body,eL=async(e,t,n,r)=>{n.classList.remove("overlay-hidden");const a=e.el,i=t(a,r);(!e.animated||!Ft.getBoolean("animated",!0))&&i.duration(0),e.keyboardClose&&i.beforeAddWrite(()=>{const o=n.ownerDocument.activeElement;o!=null&&o.matches("input,ion-input, ion-textarea")&&o.blur()});const s=sv.get(e)||[];return sv.set(e,[...s,i]),await i.play(),!0},uA=(e,t)=>{let n;const r=new Promise(a=>n=a);return OK(e,t,a=>{n(a.detail)}),r},OK=(e,t,n)=>{const r=a=>{Rk(e,t,r),n(a)};Ak(e,t,r)},Ok="backdrop",Hf="gesture",LK=()=>{let e;const t=()=>{e&&(e(),e=void 0)};return{addClickListener:(r,a)=>{t();const i=a!==void 0?document.getElementById(a):null;if(!i){Pd('A trigger element with the ID "'.concat(a,'" was not found in the DOM. The trigger element must be in the DOM when the "trigger" property is set on an overlay component.'),r);return}e=((o,l)=>{const c=()=>{l.present()};return o.addEventListener("click",c),()=>{o.removeEventListener("click",c)}})(i,r)},removeClickListener:t}};function Sr(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n}/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const PK=":host{left:0;right:0;top:0;bottom:0;display:block;position:absolute;-webkit-transform:translateZ(0);transform:translateZ(0);contain:strict;cursor:pointer;opacity:0.01;-ms-touch-action:none;touch-action:none;z-index:2}:host(.backdrop-hide){background:transparent}:host(.backdrop-no-tappable){cursor:auto}:host{background-color:var(--ion-backdrop-color, #000)}",zK=":host{left:0;right:0;top:0;bottom:0;display:block;position:absolute;-webkit-transform:translateZ(0);transform:translateZ(0);contain:strict;cursor:pointer;opacity:0.01;-ms-touch-action:none;touch-action:none;z-index:2}:host(.backdrop-hide){background:transparent}:host(.backdrop-no-tappable){cursor:auto}:host{background-color:var(--ion-backdrop-color, #000)}",BK=ur(class extends cr{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.ionBackdropTap=bt(this,"ionBackdropTap",7),this.blocker=h$.createBlocker({disableScroll:!0}),this.visible=!0,this.tappable=!0,this.stopPropagation=!0}connectedCallback(){this.stopPropagation&&this.blocker.block()}disconnectedCallback(){this.blocker.unblock()}onMouseDown(t){this.emitTap(t)}emitTap(t){this.stopPropagation&&(t.preventDefault(),t.stopPropagation()),this.tappable&&this.ionBackdropTap.emit()}render(){const t=zt(this);return De(_r,{tabindex:"-1","aria-hidden":"true",class:{[t]:!0,"backdrop-hide":!this.visible,"backdrop-no-tappable":!this.tappable}})}static get style(){return{ios:PK,md:zK}}},[33,"ion-backdrop",{visible:[4],tappable:[4],stopPropagation:[4,"stop-propagation"]},[[2,"click","onMouseDown"]]]);function WK(){if(typeof customElements>"u")return;["ion-backdrop"].forEach(t=>{switch(t){case"ion-backdrop":customElements.get(t)||customElements.define(t,BK);break}})}/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const $i=(e,t)=>t.closest(e)!==null,Ym=(e,t)=>typeof e=="string"&&e.length>0?Object.assign({"ion-color":!0,["ion-color-".concat(e)]:!0},t):t,UK=e=>e!==void 0?(Array.isArray(e)?e:e.split(" ")).filter(n=>n!=null).map(n=>n.trim()).filter(n=>n!==""):[],VK=e=>{const t={};return UK(e).forEach(n=>t[n]=!0),t},HK=/^[a-z][a-z0-9+\-.]*:/,jK=async(e,t,n,r)=>{if(e!=null&&e[0]!=="#"&&!HK.test(e)){const a=document.querySelector("ion-router");if(a)return t!=null&&t.preventDefault(),a.push(e,n,r)}return!1};/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const GK=":host{left:0;right:0;top:0;bottom:0;position:absolute;contain:strict;pointer-events:none}:host(.unbounded){contain:layout size style}.ripple-effect{border-radius:50%;position:absolute;background-color:currentColor;color:inherit;contain:strict;opacity:0;-webkit-animation:225ms rippleAnimation forwards, 75ms fadeInAnimation forwards;animation:225ms rippleAnimation forwards, 75ms fadeInAnimation forwards;will-change:transform, opacity;pointer-events:none}.fade-out{-webkit-transform:translate(var(--translate-end)) scale(var(--final-scale, 1));transform:translate(var(--translate-end)) scale(var(--final-scale, 1));-webkit-animation:150ms fadeOutAnimation forwards;animation:150ms fadeOutAnimation forwards}@-webkit-keyframes rippleAnimation{from{-webkit-animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);-webkit-transform:scale(1);transform:scale(1)}to{-webkit-transform:translate(var(--translate-end)) scale(var(--final-scale, 1));transform:translate(var(--translate-end)) scale(var(--final-scale, 1))}}@keyframes rippleAnimation{from{-webkit-animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);-webkit-transform:scale(1);transform:scale(1)}to{-webkit-transform:translate(var(--translate-end)) scale(var(--final-scale, 1));transform:translate(var(--translate-end)) scale(var(--final-scale, 1))}}@-webkit-keyframes fadeInAnimation{from{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0}to{opacity:0.16}}@keyframes fadeInAnimation{from{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0}to{opacity:0.16}}@-webkit-keyframes fadeOutAnimation{from{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0.16}to{opacity:0}}@keyframes fadeOutAnimation{from{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0.16}to{opacity:0}}",qK=ur(class extends cr{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.type="bounded"}async addRipple(t,n){return new Promise(r=>{ym(()=>{const a=this.el.getBoundingClientRect(),i=a.width,s=a.height,o=Math.sqrt(i*i+s*s),l=Math.max(s,i),c=this.unbounded?l:o+XK,u=Math.floor(l*YK),d=c/u;let p=t-a.left,h=n-a.top;this.unbounded&&(p=i*.5,h=s*.5);const f=p-u*.5,m=h-u*.5,g=i*.5-p,y=s*.5-h;Ri(()=>{const b=document.createElement("div");b.classList.add("ripple-effect");const v=b.style;v.top=m+"px",v.left=f+"px",v.width=v.height=u+"px",v.setProperty("--final-scale","".concat(d)),v.setProperty("--translate-end","".concat(g,"px, ").concat(y,"px")),(this.el.shadowRoot||this.el).appendChild(b),setTimeout(()=>{r(()=>{KK(b)})},225+100)})})})}get unbounded(){return this.type==="unbounded"}render(){const t=zt(this);return De(_r,{role:"presentation",class:{[t]:!0,unbounded:this.unbounded}})}get el(){return this}static get style(){return GK}},[1,"ion-ripple-effect",{type:[1],addRipple:[64]}]),KK=e=>{e.classList.add("fade-out"),setTimeout(()=>{e.remove()},200)},XK=10,YK=.5;function tL(){if(typeof customElements>"u")return;["ion-ripple-effect"].forEach(t=>{switch(t){case"ion-ripple-effect":customElements.get(t)||customElements.define(t,qK);break}})}/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const ZK={xs:"(min-width: 0px)",sm:"(min-width: 576px)",md:"(min-width: 768px)",lg:"(min-width: 992px)",xl:"(min-width: 1200px)"},QK=e=>{if(e===void 0||e==="")return!0;if(window.matchMedia){const t=ZK[e];return window.matchMedia(t).matches}return!1},JK=":host{-webkit-padding-start:var(--ion-grid-column-padding-xs, var(--ion-grid-column-padding, 5px));padding-inline-start:var(--ion-grid-column-padding-xs, var(--ion-grid-column-padding, 5px));-webkit-padding-end:var(--ion-grid-column-padding-xs, var(--ion-grid-column-padding, 5px));padding-inline-end:var(--ion-grid-column-padding-xs, var(--ion-grid-column-padding, 5px));padding-top:var(--ion-grid-column-padding-xs, var(--ion-grid-column-padding, 5px));padding-bottom:var(--ion-grid-column-padding-xs, var(--ion-grid-column-padding, 5px));margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-box-sizing:border-box;box-sizing:border-box;position:relative;-ms-flex-preferred-size:0;flex-basis:0;-ms-flex-positive:1;flex-grow:1;width:100%;max-width:100%;min-height:1px}@media (min-width: 576px){:host{-webkit-padding-start:var(--ion-grid-column-padding-sm, var(--ion-grid-column-padding, 5px));padding-inline-start:var(--ion-grid-column-padding-sm, var(--ion-grid-column-padding, 5px));-webkit-padding-end:var(--ion-grid-column-padding-sm, var(--ion-grid-column-padding, 5px));padding-inline-end:var(--ion-grid-column-padding-sm, var(--ion-grid-column-padding, 5px));padding-top:var(--ion-grid-column-padding-sm, var(--ion-grid-column-padding, 5px));padding-bottom:var(--ion-grid-column-padding-sm, var(--ion-grid-column-padding, 5px))}}@media (min-width: 768px){:host{-webkit-padding-start:var(--ion-grid-column-padding-md, var(--ion-grid-column-padding, 5px));padding-inline-start:var(--ion-grid-column-padding-md, var(--ion-grid-column-padding, 5px));-webkit-padding-end:var(--ion-grid-column-padding-md, var(--ion-grid-column-padding, 5px));padding-inline-end:var(--ion-grid-column-padding-md, var(--ion-grid-column-padding, 5px));padding-top:var(--ion-grid-column-padding-md, var(--ion-grid-column-padding, 5px));padding-bottom:var(--ion-grid-column-padding-md, var(--ion-grid-column-padding, 5px))}}@media (min-width: 992px){:host{-webkit-padding-start:var(--ion-grid-column-padding-lg, var(--ion-grid-column-padding, 5px));padding-inline-start:var(--ion-grid-column-padding-lg, var(--ion-grid-column-padding, 5px));-webkit-padding-end:var(--ion-grid-column-padding-lg, var(--ion-grid-column-padding, 5px));padding-inline-end:var(--ion-grid-column-padding-lg, var(--ion-grid-column-padding, 5px));padding-top:var(--ion-grid-column-padding-lg, var(--ion-grid-column-padding, 5px));padding-bottom:var(--ion-grid-column-padding-lg, var(--ion-grid-column-padding, 5px))}}@media (min-width: 1200px){:host{-webkit-padding-start:var(--ion-grid-column-padding-xl, var(--ion-grid-column-padding, 5px));padding-inline-start:var(--ion-grid-column-padding-xl, var(--ion-grid-column-padding, 5px));-webkit-padding-end:var(--ion-grid-column-padding-xl, var(--ion-grid-column-padding, 5px));padding-inline-end:var(--ion-grid-column-padding-xl, var(--ion-grid-column-padding, 5px));padding-top:var(--ion-grid-column-padding-xl, var(--ion-grid-column-padding, 5px));padding-bottom:var(--ion-grid-column-padding-xl, var(--ion-grid-column-padding, 5px))}}",zy=typeof window<"u"?window:void 0,cA=zy&&!!(zy.CSS&&zy.CSS.supports&&zy.CSS.supports("--a: 0")),e7=["","xs","sm","md","lg","xl"],t7=ur(class extends cr{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.offset=void 0,this.offsetXs=void 0,this.offsetSm=void 0,this.offsetMd=void 0,this.offsetLg=void 0,this.offsetXl=void 0,this.pull=void 0,this.pullXs=void 0,this.pullSm=void 0,this.pullMd=void 0,this.pullLg=void 0,this.pullXl=void 0,this.push=void 0,this.pushXs=void 0,this.pushSm=void 0,this.pushMd=void 0,this.pushLg=void 0,this.pushXl=void 0,this.size=void 0,this.sizeXs=void 0,this.sizeSm=void 0,this.sizeMd=void 0,this.sizeLg=void 0,this.sizeXl=void 0}onResize(){rv(this)}getColumns(t){let n;for(const r of e7){const a=QK(r),i=this[t+r.charAt(0).toUpperCase()+r.slice(1)];a&&i!==void 0&&(n=i)}return n}calculateSize(){const t=this.getColumns("size");if(!t||t==="")return;const n=t==="auto"?"auto":cA?"calc(calc(".concat(t," / var(--ion-grid-columns, 12)) * 100%)"):t/12*100+"%";return{flex:"0 0 ".concat(n),width:"".concat(n),"max-width":"".concat(n)}}calculatePosition(t,n){const r=this.getColumns(t);if(!r)return;const a=cA?"calc(calc(".concat(r," / var(--ion-grid-columns, 12)) * 100%)"):r>0&&r<12?r/12*100+"%":"auto";return{[n]:a}}calculateOffset(t){return this.calculatePosition("offset",t?"margin-right":"margin-left")}calculatePull(t){return this.calculatePosition("pull",t?"left":"right")}calculatePush(t){return this.calculatePosition("push",t?"right":"left")}render(){const t=document.dir==="rtl",n=zt(this);return De(_r,{class:{[n]:!0},style:Object.assign(Object.assign(Object.assign(Object.assign({},this.calculateOffset(t)),this.calculatePull(t)),this.calculatePush(t)),this.calculateSize())},De("slot",null))}static get style(){return JK}},[1,"ion-col",{offset:[1],offsetXs:[1,"offset-xs"],offsetSm:[1,"offset-sm"],offsetMd:[1,"offset-md"],offsetLg:[1,"offset-lg"],offsetXl:[1,"offset-xl"],pull:[1],pullXs:[1,"pull-xs"],pullSm:[1,"pull-sm"],pullMd:[1,"pull-md"],pullLg:[1,"pull-lg"],pullXl:[1,"pull-xl"],push:[1],pushXs:[1,"push-xs"],pushSm:[1,"push-sm"],pushMd:[1,"push-md"],pushLg:[1,"push-lg"],pushXl:[1,"push-xl"],size:[1],sizeXs:[1,"size-xs"],sizeSm:[1,"size-sm"],sizeMd:[1,"size-md"],sizeLg:[1,"size-lg"],sizeXl:[1,"size-xl"]},[[9,"resize","onResize"]]]);function n7(){if(typeof customElements>"u")return;["ion-col"].forEach(t=>{switch(t){case"ion-col":customElements.get(t)||customElements.define(t,t7);break}})}const r7=n7;/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const Lk=e=>e&&e.dir!==""?e.dir.toLowerCase()==="rtl":(document==null?void 0:document.dir.toLowerCase())==="rtl";/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const a7=':host{--background:var(--ion-background-color, #fff);--color:var(--ion-text-color, #000);--padding-top:0px;--padding-bottom:0px;--padding-start:0px;--padding-end:0px;--keyboard-offset:0px;--offset-top:0px;--offset-bottom:0px;--overflow:auto;display:block;position:relative;-ms-flex:1;flex:1;width:100%;height:100%;margin:0 !important;padding:0 !important;font-family:var(--ion-font-family, inherit);contain:size style}:host(.ion-color) .inner-scroll{background:var(--ion-color-base);color:var(--ion-color-contrast)}:host(.outer-content){--background:var(--ion-color-step-50, #f2f2f2)}#background-content{left:0px;right:0px;top:calc(var(--offset-top) * -1);bottom:calc(var(--offset-bottom) * -1);position:absolute;background:var(--background)}.inner-scroll{left:0px;right:0px;top:calc(var(--offset-top) * -1);bottom:calc(var(--offset-bottom) * -1);-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:calc(var(--padding-top) + var(--offset-top));padding-bottom:calc(var(--padding-bottom) + var(--keyboard-offset) + var(--offset-bottom));position:absolute;color:var(--color);-webkit-box-sizing:border-box;box-sizing:border-box;overflow:hidden;-ms-touch-action:pan-x pan-y pinch-zoom;touch-action:pan-x pan-y pinch-zoom}.scroll-y,.scroll-x{-webkit-overflow-scrolling:touch;z-index:0;will-change:scroll-position}.scroll-y{overflow-y:var(--overflow);overscroll-behavior-y:contain}.scroll-x{overflow-x:var(--overflow);overscroll-behavior-x:contain}.overscroll::before,.overscroll::after{position:absolute;width:1px;height:1px;content:""}.overscroll::before{bottom:-1px}.overscroll::after{top:-1px}:host(.content-sizing){display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;min-height:0;contain:none}:host(.content-sizing) .inner-scroll{position:relative;top:0;bottom:0;margin-top:calc(var(--offset-top) * -1);margin-bottom:calc(var(--offset-bottom) * -1)}.transition-effect{display:none;position:absolute;width:100%;height:100vh;opacity:0;pointer-events:none}:host(.content-ltr) .transition-effect{left:-100%;}:host(.content-rtl) .transition-effect{right:-100%;}.transition-cover{position:absolute;right:0;width:100%;height:100%;background:black;opacity:0.1}.transition-shadow{display:block;position:absolute;width:100%;height:100%;-webkit-box-shadow:inset -9px 0 9px 0 rgba(0, 0, 100, 0.03);box-shadow:inset -9px 0 9px 0 rgba(0, 0, 100, 0.03)}:host(.content-ltr) .transition-shadow{right:0;}:host(.content-rtl) .transition-shadow{left:0;-webkit-transform:scaleX(-1);transform:scaleX(-1)}::slotted([slot=fixed]){position:absolute;-webkit-transform:translateZ(0);transform:translateZ(0)}',i7=ur(class extends cr{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.ionScrollStart=bt(this,"ionScrollStart",7),this.ionScroll=bt(this,"ionScroll",7),this.ionScrollEnd=bt(this,"ionScrollEnd",7),this.watchDog=null,this.isScrolling=!1,this.lastScroll=0,this.queued=!1,this.cTop=-1,this.cBottom=-1,this.isMainContent=!0,this.resizeTimeout=null,this.detail={scrollTop:0,scrollLeft:0,type:"scroll",event:void 0,startX:0,startY:0,startTime:0,currentX:0,currentY:0,velocityX:0,velocityY:0,deltaX:0,deltaY:0,currentTime:0,data:void 0,isScrolling:!0},this.color=void 0,this.fullscreen=!1,this.forceOverscroll=void 0,this.scrollX=!1,this.scrollY=!0,this.scrollEvents=!1}connectedCallback(){this.isMainContent=this.el.closest("ion-menu, ion-popover, ion-modal")===null}disconnectedCallback(){this.onScrollEnd()}onAppLoad(){this.resize()}onResize(){this.resizeTimeout&&(clearTimeout(this.resizeTimeout),this.resizeTimeout=null),this.resizeTimeout=setTimeout(()=>{this.el.offsetParent!==null&&this.resize()},100)}shouldForceOverscroll(){const{forceOverscroll:t}=this,n=zt(this);return t===void 0?n==="ios"&&oo("ios"):t}resize(){this.fullscreen?ym(()=>this.readDimensions()):(this.cTop!==0||this.cBottom!==0)&&(this.cTop=this.cBottom=0,rv(this))}readDimensions(){const t=o7(this.el),n=Math.max(this.el.offsetTop,0),r=Math.max(t.offsetHeight-n-this.el.offsetHeight,0);(n!==this.cTop||r!==this.cBottom)&&(this.cTop=n,this.cBottom=r,rv(this))}onScroll(t){const n=Date.now(),r=!this.isScrolling;this.lastScroll=n,r&&this.onScrollStart(),!this.queued&&this.scrollEvents&&(this.queued=!0,ym(a=>{this.queued=!1,this.detail.event=t,l7(this.detail,this.scrollEl,a,r),this.ionScroll.emit(this.detail)}))}async getScrollElement(){return this.scrollEl||await new Promise(t=>Qd(this.el,t)),Promise.resolve(this.scrollEl)}async getBackgroundElement(){return this.backgroundContentEl||await new Promise(t=>Qd(this.el,t)),Promise.resolve(this.backgroundContentEl)}scrollToTop(t=0){return this.scrollToPoint(void 0,0,t)}async scrollToBottom(t=0){const n=await this.getScrollElement(),r=n.scrollHeight-n.clientHeight;return this.scrollToPoint(void 0,r,t)}async scrollByPoint(t,n,r){const a=await this.getScrollElement();return this.scrollToPoint(t+a.scrollLeft,n+a.scrollTop,r)}async scrollToPoint(t,n,r=0){const a=await this.getScrollElement();if(r<32){n!=null&&(a.scrollTop=n),t!=null&&(a.scrollLeft=t);return}let i,s=0;const o=new Promise(h=>i=h),l=a.scrollTop,c=a.scrollLeft,u=n!=null?n-l:0,d=t!=null?t-c:0,p=h=>{const f=Math.min(1,(h-s)/r)-1,m=Math.pow(f,3)+1;u!==0&&(a.scrollTop=Math.floor(m*u+l)),d!==0&&(a.scrollLeft=Math.floor(m*d+c)),m<1?requestAnimationFrame(p):i()};return requestAnimationFrame(h=>{s=h,p(h)}),o}onScrollStart(){this.isScrolling=!0,this.ionScrollStart.emit({isScrolling:!0}),this.watchDog&&clearInterval(this.watchDog),this.watchDog=setInterval(()=>{this.lastScroll<Date.now()-120&&this.onScrollEnd()},100)}onScrollEnd(){this.watchDog&&clearInterval(this.watchDog),this.watchDog=null,this.isScrolling&&(this.isScrolling=!1,this.ionScrollEnd.emit({isScrolling:!1}))}render(){const{isMainContent:t,scrollX:n,scrollY:r,el:a}=this,i=Lk(a)?"rtl":"ltr",s=zt(this),o=this.shouldForceOverscroll(),l=s==="ios",c=t?"main":"div";return this.resize(),De(_r,{class:Ym(this.color,{[s]:!0,"content-sizing":$i("ion-popover",this.el),overscroll:o,["content-".concat(i)]:!0}),style:{"--offset-top":"".concat(this.cTop,"px"),"--offset-bottom":"".concat(this.cBottom,"px")}},De("div",{ref:u=>this.backgroundContentEl=u,id:"background-content",part:"background"}),De(c,{class:{"inner-scroll":!0,"scroll-x":n,"scroll-y":r,overscroll:(n||r)&&o},ref:u=>this.scrollEl=u,onScroll:this.scrollEvents?u=>this.onScroll(u):void 0,part:"scroll"},De("slot",null)),l?De("div",{class:"transition-effect"},De("div",{class:"transition-cover"}),De("div",{class:"transition-shadow"})):null,De("slot",{name:"fixed"}))}get el(){return this}static get style(){return a7}},[1,"ion-content",{color:[513],fullscreen:[4],forceOverscroll:[1028,"force-overscroll"],scrollX:[4,"scroll-x"],scrollY:[4,"scroll-y"],scrollEvents:[4,"scroll-events"],getScrollElement:[64],getBackgroundElement:[64],scrollToTop:[64],scrollToBottom:[64],scrollByPoint:[64],scrollToPoint:[64]},[[8,"appload","onAppLoad"],[9,"resize","onResize"]]]),s7=e=>{var t;return e.parentElement?e.parentElement:!((t=e.parentNode)===null||t===void 0)&&t.host?e.parentNode.host:null},o7=e=>{const t=e.closest("ion-tabs");if(t)return t;const n=e.closest("ion-app, ion-page, .ion-page, page-inner, .popover-content");return n||s7(e)},l7=(e,t,n,r)=>{const a=e.currentX,i=e.currentY,s=e.currentTime,o=t.scrollLeft,l=t.scrollTop,c=n-s;if(r&&(e.startTime=n,e.startX=o,e.startY=l,e.velocityX=e.velocityY=0),e.currentTime=n,e.currentX=e.scrollLeft=o,e.currentY=e.scrollTop=l,e.deltaX=o-e.startX,e.deltaY=l-e.startY,c>0&&c<100){const u=(o-a)/c,d=(l-i)/c;e.velocityX=u*.7+e.velocityX*.3,e.velocityY=d*.7+e.velocityY*.3}};function u7(){if(typeof customElements>"u")return;["ion-content"].forEach(t=>{switch(t){case"ion-content":customElements.get(t)||customElements.define(t,i7);break}})}const c7=u7;/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const d7=':host{--overflow:hidden;--ripple-color:currentColor;--border-width:initial;--border-color:initial;--border-style:initial;--color-activated:var(--color);--color-focused:var(--color);--color-hover:var(--color);--box-shadow:none;display:inline-block;width:auto;color:var(--color);font-family:var(--ion-font-family, inherit);text-align:center;text-decoration:none;text-overflow:ellipsis;white-space:nowrap;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:top;vertical-align:-webkit-baseline-middle;-webkit-font-kerning:none;font-kerning:none}:host(.button-disabled){cursor:default;opacity:0.5;pointer-events:none}:host(.button-solid){--background:var(--ion-color-primary, #3880ff);--color:var(--ion-color-primary-contrast, #fff)}:host(.button-outline){--border-color:var(--ion-color-primary, #3880ff);--background:transparent;--color:var(--ion-color-primary, #3880ff)}:host(.button-clear){--border-width:0;--background:transparent;--color:var(--ion-color-primary, #3880ff)}:host(.button-block){display:block}:host(.button-block) .button-native{margin-left:0;margin-right:0;display:block;width:100%;clear:both;contain:content}:host(.button-block) .button-native::after{clear:both}:host(.button-full){display:block}:host(.button-full) .button-native{margin-left:0;margin-right:0;display:block;width:100%;contain:content}:host(.button-full:not(.button-round)) .button-native{border-radius:0;border-right-width:0;border-left-width:0}.button-native{border-radius:var(--border-radius);-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:block;position:relative;width:100%;height:100%;-webkit-transition:var(--transition);transition:var(--transition);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);outline:none;background:var(--background);line-height:1;-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);contain:layout style;cursor:pointer;opacity:var(--opacity);overflow:var(--overflow);z-index:0;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-appearance:none;-moz-appearance:none;appearance:none}.button-native::-moz-focus-inner{border:0}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%;z-index:1}::slotted(ion-icon){font-size:1.4em;pointer-events:none}::slotted(ion-icon[slot=start]){-webkit-margin-start:-0.3em;margin-inline-start:-0.3em;-webkit-margin-end:0.3em;margin-inline-end:0.3em;margin-top:0;margin-bottom:0}::slotted(ion-icon[slot=end]){-webkit-margin-start:0.3em;margin-inline-start:0.3em;-webkit-margin-end:-0.2em;margin-inline-end:-0.2em;margin-top:0;margin-bottom:0}::slotted(ion-icon[slot=icon-only]){font-size:1.8em}ion-ripple-effect{color:var(--ripple-color)}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}:host(.ion-focused){color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}@media (any-hover: hover){:host(:hover){color:var(--color-hover)}:host(:hover) .button-native::after{background:var(--background-hover);opacity:var(--background-hover-opacity)}}:host(.ion-activated){color:var(--color-activated)}:host(.ion-activated) .button-native::after{background:var(--background-activated);opacity:var(--background-activated-opacity)}:host(.button-solid.ion-color) .button-native{background:var(--ion-color-base);color:var(--ion-color-contrast)}:host(.button-outline.ion-color) .button-native{border-color:var(--ion-color-base);background:transparent;color:var(--ion-color-base)}:host(.button-clear.ion-color) .button-native{background:transparent;color:var(--ion-color-base)}:host(.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native{color:var(--ion-toolbar-color, var(--color))}:host(.button-outline.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native{border-color:var(--ion-toolbar-color, var(--color, var(--border-color)))}:host(.button-solid.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native{background:var(--ion-toolbar-color, var(--background));color:var(--ion-toolbar-background, var(--color))}:host(.button-outline.ion-activated.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native{background:var(--ion-toolbar-color, var(--color));color:var(--ion-toolbar-background, var(--background), var(--ion-color-primary-contrast, #fff))}:host{--border-radius:14px;--padding-top:0;--padding-bottom:0;--padding-start:1em;--padding-end:1em;--transition:background-color, opacity 100ms linear;-webkit-margin-start:2px;margin-inline-start:2px;-webkit-margin-end:2px;margin-inline-end:2px;margin-top:4px;margin-bottom:4px;height:3.1em;font-size:16px;font-weight:500;letter-spacing:0}:host(.in-buttons){font-size:17px;font-weight:400}:host(.button-solid){--background-activated:var(--ion-color-primary-shade, #3171e0);--background-focused:var(--ion-color-primary-shade, #3171e0);--background-hover:var(--ion-color-primary-tint, #4c8dff);--background-activated-opacity:1;--background-focused-opacity:1;--background-hover-opacity:1}:host(.button-outline){--border-radius:14px;--border-width:1px;--border-style:solid;--background-activated:var(--ion-color-primary, #3880ff);--background-focused:var(--ion-color-primary, #3880ff);--background-hover:transparent;--background-focused-opacity:.1;--color-activated:var(--ion-color-primary-contrast, #fff)}:host(.button-clear){--background-activated:transparent;--background-activated-opacity:0;--background-focused:var(--ion-color-primary, #3880ff);--background-hover:transparent;--background-focused-opacity:.1;font-size:17px;font-weight:normal}:host(.button-large){--border-radius:16px;--padding-top:0;--padding-start:1em;--padding-end:1em;--padding-bottom:0;height:3.1em;font-size:20px}:host(.button-small){--border-radius:6px;--padding-top:0;--padding-start:0.9em;--padding-end:0.9em;--padding-bottom:0;height:2.1em;font-size:13px}:host(.button-round){--border-radius:64px;--padding-top:0;--padding-start:26px;--padding-end:26px;--padding-bottom:0}:host(.button-strong){font-weight:600}:host(.button-outline.ion-focused.ion-color) .button-native,:host(.button-clear.ion-focused.ion-color) .button-native{color:var(--ion-color-base)}:host(.button-outline.ion-focused.ion-color) .button-native::after,:host(.button-clear.ion-focused.ion-color) .button-native::after{background:var(--ion-color-base)}:host(.button-solid.ion-color.ion-focused) .button-native::after{background:var(--ion-color-shade)}@media (any-hover: hover){:host(.button-clear:not(.ion-activated):hover),:host(.button-outline:not(.ion-activated):hover){opacity:0.6}:host(.button-clear.ion-color:hover) .button-native,:host(.button-outline.ion-color:hover) .button-native{color:var(--ion-color-base)}:host(.button-clear.ion-color:hover) .button-native::after,:host(.button-outline.ion-color:hover) .button-native::after{background:transparent}:host(.button-solid.ion-color:hover) .button-native::after{background:var(--ion-color-tint)}:host(:hover.button-solid.in-toolbar:not(.ion-color):not(.in-toolbar-color):not(.ion-activated)) .button-native::after{background:#fff;opacity:0.1}}:host(.button-clear.ion-activated){opacity:0.4}:host(.button-outline.ion-activated.ion-color) .button-native{color:var(--ion-color-contrast)}:host(.button-outline.ion-activated.ion-color) .button-native::after{background:var(--ion-color-base)}:host(.button-solid.ion-color.ion-activated) .button-native::after{background:var(--ion-color-shade)}',p7=':host{--overflow:hidden;--ripple-color:currentColor;--border-width:initial;--border-color:initial;--border-style:initial;--color-activated:var(--color);--color-focused:var(--color);--color-hover:var(--color);--box-shadow:none;display:inline-block;width:auto;color:var(--color);font-family:var(--ion-font-family, inherit);text-align:center;text-decoration:none;text-overflow:ellipsis;white-space:nowrap;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:top;vertical-align:-webkit-baseline-middle;-webkit-font-kerning:none;font-kerning:none}:host(.button-disabled){cursor:default;opacity:0.5;pointer-events:none}:host(.button-solid){--background:var(--ion-color-primary, #3880ff);--color:var(--ion-color-primary-contrast, #fff)}:host(.button-outline){--border-color:var(--ion-color-primary, #3880ff);--background:transparent;--color:var(--ion-color-primary, #3880ff)}:host(.button-clear){--border-width:0;--background:transparent;--color:var(--ion-color-primary, #3880ff)}:host(.button-block){display:block}:host(.button-block) .button-native{margin-left:0;margin-right:0;display:block;width:100%;clear:both;contain:content}:host(.button-block) .button-native::after{clear:both}:host(.button-full){display:block}:host(.button-full) .button-native{margin-left:0;margin-right:0;display:block;width:100%;contain:content}:host(.button-full:not(.button-round)) .button-native{border-radius:0;border-right-width:0;border-left-width:0}.button-native{border-radius:var(--border-radius);-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:block;position:relative;width:100%;height:100%;-webkit-transition:var(--transition);transition:var(--transition);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);outline:none;background:var(--background);line-height:1;-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);contain:layout style;cursor:pointer;opacity:var(--opacity);overflow:var(--overflow);z-index:0;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-appearance:none;-moz-appearance:none;appearance:none}.button-native::-moz-focus-inner{border:0}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%;z-index:1}::slotted(ion-icon){font-size:1.4em;pointer-events:none}::slotted(ion-icon[slot=start]){-webkit-margin-start:-0.3em;margin-inline-start:-0.3em;-webkit-margin-end:0.3em;margin-inline-end:0.3em;margin-top:0;margin-bottom:0}::slotted(ion-icon[slot=end]){-webkit-margin-start:0.3em;margin-inline-start:0.3em;-webkit-margin-end:-0.2em;margin-inline-end:-0.2em;margin-top:0;margin-bottom:0}::slotted(ion-icon[slot=icon-only]){font-size:1.8em}ion-ripple-effect{color:var(--ripple-color)}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}:host(.ion-focused){color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}@media (any-hover: hover){:host(:hover){color:var(--color-hover)}:host(:hover) .button-native::after{background:var(--background-hover);opacity:var(--background-hover-opacity)}}:host(.ion-activated){color:var(--color-activated)}:host(.ion-activated) .button-native::after{background:var(--background-activated);opacity:var(--background-activated-opacity)}:host(.button-solid.ion-color) .button-native{background:var(--ion-color-base);color:var(--ion-color-contrast)}:host(.button-outline.ion-color) .button-native{border-color:var(--ion-color-base);background:transparent;color:var(--ion-color-base)}:host(.button-clear.ion-color) .button-native{background:transparent;color:var(--ion-color-base)}:host(.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native{color:var(--ion-toolbar-color, var(--color))}:host(.button-outline.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native{border-color:var(--ion-toolbar-color, var(--color, var(--border-color)))}:host(.button-solid.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native{background:var(--ion-toolbar-color, var(--background));color:var(--ion-toolbar-background, var(--color))}:host(.button-outline.ion-activated.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native{background:var(--ion-toolbar-color, var(--color));color:var(--ion-toolbar-background, var(--background), var(--ion-color-primary-contrast, #fff))}:host{--border-radius:4px;--padding-top:0;--padding-bottom:0;--padding-start:1.1em;--padding-end:1.1em;--transition:box-shadow 280ms cubic-bezier(.4, 0, .2, 1),\n                background-color 15ms linear,\n                color 15ms linear;-webkit-margin-start:2px;margin-inline-start:2px;-webkit-margin-end:2px;margin-inline-end:2px;margin-top:4px;margin-bottom:4px;height:36px;font-size:14px;font-weight:500;letter-spacing:0.06em;text-transform:uppercase}:host(.button-solid){--background-activated:transparent;--background-hover:var(--ion-color-primary-contrast, #fff);--background-focused:var(--ion-color-primary-contrast, #fff);--background-activated-opacity:0;--background-focused-opacity:.24;--background-hover-opacity:.08;--box-shadow:0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12)}:host(.button-solid.ion-activated){--box-shadow:0 5px 5px -3px rgba(0, 0, 0, 0.2), 0 8px 10px 1px rgba(0, 0, 0, 0.14), 0 3px 14px 2px rgba(0, 0, 0, 0.12)}:host(.button-outline){--border-width:2px;--border-style:solid;--box-shadow:none;--background-activated:transparent;--background-focused:var(--ion-color-primary, #3880ff);--background-hover:var(--ion-color-primary, #3880ff);--background-activated-opacity:0;--background-focused-opacity:.12;--background-hover-opacity:.04}:host(.button-outline.ion-activated.ion-color) .button-native{background:transparent}:host(.button-clear){--background-activated:transparent;--background-focused:var(--ion-color-primary, #3880ff);--background-hover:var(--ion-color-primary, #3880ff);--background-activated-opacity:0;--background-focused-opacity:.12;--background-hover-opacity:.04}:host(.button-round){--border-radius:64px;--padding-top:0;--padding-start:26px;--padding-end:26px;--padding-bottom:0}:host(.button-large){--padding-top:0;--padding-start:1em;--padding-end:1em;--padding-bottom:0;height:2.8em;font-size:20px}:host(.button-small){--padding-top:0;--padding-start:0.9em;--padding-end:0.9em;--padding-bottom:0;height:2.1em;font-size:13px}:host(.button-strong){font-weight:bold}::slotted(ion-icon[slot=icon-only]){padding-left:0;padding-right:0;padding-top:0;padding-bottom:0}:host(.button-solid.ion-color.ion-focused) .button-native::after{background:var(--ion-color-contrast)}:host(.button-clear.ion-color.ion-focused) .button-native::after,:host(.button-outline.ion-color.ion-focused) .button-native::after{background:var(--ion-color-base)}@media (any-hover: hover){:host(.button-solid.ion-color:hover) .button-native::after{background:var(--ion-color-contrast)}:host(.button-clear.ion-color:hover) .button-native::after,:host(.button-outline.ion-color:hover) .button-native::after{background:var(--ion-color-base)}}',h7=ur(class extends cr{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.ionFocus=bt(this,"ionFocus",7),this.ionBlur=bt(this,"ionBlur",7),this.inItem=!1,this.inListHeader=!1,this.inToolbar=!1,this.inheritedAttributes={},this.handleClick=t=>{const{el:n}=this;if(this.type==="button")jK(this.href,t,this.routerDirection,this.routerAnimation);else if(wq(n)){let r=this.findForm();const{form:a}=this;if(!r&&a!==void 0){Pd(typeof a=="string"?'Form with selector: "#'.concat(a,'" could not be found. Verify that the id is correct and the form is rendered in the DOM.'):'The provided "form" element is invalid. Verify that the form is a HTMLFormElement and rendered in the DOM.',n);return}if(r||(r=n.closest("form")),r){t.preventDefault();const i=document.createElement("button");i.type=this.type,i.style.display="none",r.appendChild(i),i.click(),i.remove()}}},this.onFocus=()=>{this.ionFocus.emit()},this.onBlur=()=>{this.ionBlur.emit()},this.color=void 0,this.buttonType="button",this.disabled=!1,this.expand=void 0,this.fill=void 0,this.routerDirection="forward",this.routerAnimation=void 0,this.download=void 0,this.href=void 0,this.rel=void 0,this.shape=void 0,this.size=void 0,this.strong=!1,this.target=void 0,this.type="button",this.form=void 0}componentWillLoad(){this.inToolbar=!!this.el.closest("ion-buttons"),this.inListHeader=!!this.el.closest("ion-list-header"),this.inItem=!!this.el.closest("ion-item")||!!this.el.closest("ion-item-divider"),this.inheritedAttributes=MO(this.el)}get hasIconOnly(){return!!this.el.querySelector('[slot="icon-only"]')}get rippleType(){return(this.fill===void 0||this.fill==="clear")&&this.hasIconOnly&&this.inToolbar?"unbounded":"bounded"}findForm(){const{form:t}=this;if(t instanceof HTMLFormElement)return t;if(typeof t=="string"){const n=document.getElementById(t);if(n instanceof HTMLFormElement)return n}return null}render(){const t=zt(this),{buttonType:n,type:r,disabled:a,rel:i,target:s,size:o,href:l,color:c,expand:u,hasIconOnly:d,shape:p,strong:h,inheritedAttributes:f}=this,m=o===void 0&&this.inItem?"small":o,g=l===void 0?"button":"a",y=g==="button"?{type:r}:{download:this.download,href:l,rel:i,target:s};let b=this.fill;return b==null&&(b=this.inToolbar||this.inListHeader?"clear":"solid"),De(_r,{onClick:this.handleClick,"aria-disabled":a?"true":null,class:Ym(c,{[t]:!0,[n]:!0,["".concat(n,"-").concat(u)]:u!==void 0,["".concat(n,"-").concat(m)]:m!==void 0,["".concat(n,"-").concat(p)]:p!==void 0,["".concat(n,"-").concat(b)]:!0,["".concat(n,"-strong")]:h,"in-toolbar":$i("ion-toolbar",this.el),"in-toolbar-color":$i("ion-toolbar[color]",this.el),"in-buttons":$i("ion-buttons",this.el),"button-has-icon-only":d,"button-disabled":a,"ion-activatable":!0,"ion-focusable":!0})},De(g,Object.assign({},y,{class:"button-native",part:"native",disabled:a,onFocus:this.onFocus,onBlur:this.onBlur},f),De("span",{class:"button-inner"},De("slot",{name:"icon-only"}),De("slot",{name:"start"}),De("slot",null),De("slot",{name:"end"})),t==="md"&&De("ion-ripple-effect",{type:this.rippleType})))}get el(){return this}static get style(){return{ios:d7,md:p7}}},[33,"ion-button",{color:[513],buttonType:[1025,"button-type"],disabled:[516],expand:[513],fill:[1537],routerDirection:[1,"router-direction"],routerAnimation:[16],download:[1],href:[1],rel:[1],shape:[513],size:[513],strong:[4],target:[1],type:[1],form:[1]}]);/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const f7=".item.sc-ion-label-ios-h,.item .sc-ion-label-ios-h{--color:initial;display:block;color:var(--color);font-family:var(--ion-font-family, inherit);font-size:inherit;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box}.ion-color.sc-ion-label-ios-h{color:var(--ion-color-base)}.ion-text-wrap.sc-ion-label-ios-h,[text-wrap].sc-ion-label-ios-h{white-space:normal}.item-interactive-disabled.sc-ion-label-ios-h:not(.item-multiple-inputs),.item-interactive-disabled:not(.item-multiple-inputs) .sc-ion-label-ios-h{cursor:default;opacity:0.3;pointer-events:none}.item-input.sc-ion-label-ios-h,.item-input .sc-ion-label-ios-h{-ms-flex:initial;flex:initial;max-width:200px;pointer-events:none}.item-textarea.sc-ion-label-ios-h,.item-textarea .sc-ion-label-ios-h{-ms-flex-item-align:baseline;align-self:baseline}.label-fixed.sc-ion-label-ios-h{-ms-flex:0 0 100px;flex:0 0 100px;width:100px;min-width:100px;max-width:200px}.label-stacked.sc-ion-label-ios-h,.label-floating.sc-ion-label-ios-h{margin-bottom:0;-ms-flex-item-align:stretch;align-self:stretch;width:auto;max-width:100%}.label-no-animate.label-floating.sc-ion-label-ios-h{-webkit-transition:none;transition:none}.sc-ion-label-ios-s h1,.sc-ion-label-ios-s h2,.sc-ion-label-ios-s h3,.sc-ion-label-ios-s h4,.sc-ion-label-ios-s h5,.sc-ion-label-ios-s h6{text-overflow:inherit;overflow:inherit}.ion-text-wrap.sc-ion-label-ios-h,[text-wrap].sc-ion-label-ios-h{font-size:14px;line-height:1.5}.label-stacked.sc-ion-label-ios-h{margin-bottom:4px;font-size:14px}.label-floating.sc-ion-label-ios-h{margin-bottom:0;-webkit-transform:translate(0, 29px);transform:translate(0, 29px);-webkit-transform-origin:left top;transform-origin:left top;-webkit-transition:-webkit-transform 150ms ease-in-out;transition:-webkit-transform 150ms ease-in-out;transition:transform 150ms ease-in-out;transition:transform 150ms ease-in-out, -webkit-transform 150ms ease-in-out}[dir=rtl].sc-ion-label-ios-h -no-combinator.label-floating.sc-ion-label-ios-h,[dir=rtl] .sc-ion-label-ios-h -no-combinator.label-floating.sc-ion-label-ios-h,[dir=rtl].label-floating.sc-ion-label-ios-h,[dir=rtl] .label-floating.sc-ion-label-ios-h{-webkit-transform-origin:right top;transform-origin:right top}@supports selector(:dir(rtl)){.label-floating.sc-ion-label-ios-h:dir(rtl){-webkit-transform-origin:right top;transform-origin:right top}}.item-textarea.label-floating.sc-ion-label-ios-h,.item-textarea .label-floating.sc-ion-label-ios-h{-webkit-transform:translate(0, 28px);transform:translate(0, 28px)}.item-has-focus.label-floating.sc-ion-label-ios-h,.item-has-focus .label-floating.sc-ion-label-ios-h,.item-has-placeholder.sc-ion-label-ios-h:not(.item-input).label-floating,.item-has-placeholder:not(.item-input) .label-floating.sc-ion-label-ios-h,.item-has-value.label-floating.sc-ion-label-ios-h,.item-has-value .label-floating.sc-ion-label-ios-h{-webkit-transform:scale(0.82);transform:scale(0.82)}.sc-ion-label-ios-s h1{margin-left:0;margin-right:0;margin-top:3px;margin-bottom:2px;font-size:22px;font-weight:normal}.sc-ion-label-ios-s h2{margin-left:0;margin-right:0;margin-top:0;margin-bottom:2px;font-size:17px;font-weight:normal}.sc-ion-label-ios-s h3,.sc-ion-label-ios-s h4,.sc-ion-label-ios-s h5,.sc-ion-label-ios-s h6{margin-left:0;margin-right:0;margin-top:0;margin-bottom:3px;font-size:14px;font-weight:normal;line-height:normal}.sc-ion-label-ios-s p{margin-left:0;margin-right:0;margin-top:0;margin-bottom:2px;font-size:14px;line-height:normal;text-overflow:inherit;overflow:inherit}.sc-ion-label-ios-s>p{color:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.4)}.sc-ion-label-ios-h.in-item-color.sc-ion-label-ios-s>p{color:inherit}.sc-ion-label-ios-s h2:last-child,.sc-ion-label-ios-s h3:last-child,.sc-ion-label-ios-s h4:last-child,.sc-ion-label-ios-s h5:last-child,.sc-ion-label-ios-s h6:last-child,.sc-ion-label-ios-s p:last-child{margin-bottom:0}",m7='.item.sc-ion-label-md-h,.item .sc-ion-label-md-h{--color:initial;display:block;color:var(--color);font-family:var(--ion-font-family, inherit);font-size:inherit;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box}.ion-color.sc-ion-label-md-h{color:var(--ion-color-base)}.ion-text-wrap.sc-ion-label-md-h,[text-wrap].sc-ion-label-md-h{white-space:normal}.item-interactive-disabled.sc-ion-label-md-h:not(.item-multiple-inputs),.item-interactive-disabled:not(.item-multiple-inputs) .sc-ion-label-md-h{cursor:default;opacity:0.3;pointer-events:none}.item-input.sc-ion-label-md-h,.item-input .sc-ion-label-md-h{-ms-flex:initial;flex:initial;max-width:200px;pointer-events:none}.item-textarea.sc-ion-label-md-h,.item-textarea .sc-ion-label-md-h{-ms-flex-item-align:baseline;align-self:baseline}.label-fixed.sc-ion-label-md-h{-ms-flex:0 0 100px;flex:0 0 100px;width:100px;min-width:100px;max-width:200px}.label-stacked.sc-ion-label-md-h,.label-floating.sc-ion-label-md-h{margin-bottom:0;-ms-flex-item-align:stretch;align-self:stretch;width:auto;max-width:100%}.label-no-animate.label-floating.sc-ion-label-md-h{-webkit-transition:none;transition:none}.sc-ion-label-md-s h1,.sc-ion-label-md-s h2,.sc-ion-label-md-s h3,.sc-ion-label-md-s h4,.sc-ion-label-md-s h5,.sc-ion-label-md-s h6{text-overflow:inherit;overflow:inherit}.ion-text-wrap.sc-ion-label-md-h,[text-wrap].sc-ion-label-md-h{line-height:1.5}.label-stacked.sc-ion-label-md-h,.label-floating.sc-ion-label-md-h{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-transform-origin:top left;transform-origin:top left}.label-stacked.label-rtl.sc-ion-label-md-h,.label-floating.label-rtl.sc-ion-label-md-h{-webkit-transform-origin:top right;transform-origin:top right}.label-stacked.sc-ion-label-md-h{-webkit-transform:translateY(50%) scale(0.75);transform:translateY(50%) scale(0.75);-webkit-transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1);transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1)}.label-floating.sc-ion-label-md-h{-webkit-transform:translateY(96%);transform:translateY(96%);-webkit-transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1), -webkit-transform 150ms cubic-bezier(0.4, 0, 0.2, 1);transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1), -webkit-transform 150ms cubic-bezier(0.4, 0, 0.2, 1);transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1), transform 150ms cubic-bezier(0.4, 0, 0.2, 1);transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1), transform 150ms cubic-bezier(0.4, 0, 0.2, 1), -webkit-transform 150ms cubic-bezier(0.4, 0, 0.2, 1)}.ion-focused.label-floating.sc-ion-label-md-h,.ion-focused .label-floating.sc-ion-label-md-h,.item-has-focus.label-floating.sc-ion-label-md-h,.item-has-focus .label-floating.sc-ion-label-md-h,.item-has-placeholder.sc-ion-label-md-h:not(.item-input).label-floating,.item-has-placeholder:not(.item-input) .label-floating.sc-ion-label-md-h,.item-has-value.label-floating.sc-ion-label-md-h,.item-has-value .label-floating.sc-ion-label-md-h{-webkit-transform:translateY(50%) scale(0.75);transform:translateY(50%) scale(0.75)}.item-fill-outline.ion-focused.label-floating.sc-ion-label-md-h,.item-fill-outline.ion-focused .label-floating.sc-ion-label-md-h,.item-fill-outline.item-has-focus.label-floating.sc-ion-label-md-h,.item-fill-outline.item-has-focus .label-floating.sc-ion-label-md-h,.item-fill-outline.item-has-placeholder.sc-ion-label-md-h:not(.item-input).label-floating,.item-fill-outline.item-has-placeholder:not(.item-input) .label-floating.sc-ion-label-md-h,.item-fill-outline.item-has-value.label-floating.sc-ion-label-md-h,.item-fill-outline.item-has-value .label-floating.sc-ion-label-md-h{-webkit-transform:translateY(-6px) scale(0.75);transform:translateY(-6px) scale(0.75);position:relative;max-width:-webkit-min-content;max-width:-moz-min-content;max-width:min-content;background-color:var(--ion-item-background, var(--ion-background-color, #fff));overflow:visible;z-index:3}.item-fill-outline.ion-focused.label-floating.sc-ion-label-md-h::before,.item-fill-outline.ion-focused .label-floating.sc-ion-label-md-h::before,.item-fill-outline.ion-focused.label-floating.sc-ion-label-md-h::after,.item-fill-outline.ion-focused .label-floating.sc-ion-label-md-h::after,.item-fill-outline.item-has-focus.label-floating.sc-ion-label-md-h::before,.item-fill-outline.item-has-focus .label-floating.sc-ion-label-md-h::before,.item-fill-outline.item-has-focus.label-floating.sc-ion-label-md-h::after,.item-fill-outline.item-has-focus .label-floating.sc-ion-label-md-h::after,.item-fill-outline.item-has-placeholder.sc-ion-label-md-h:not(.item-input).label-floating::before,.item-fill-outline.item-has-placeholder:not(.item-input) .label-floating.sc-ion-label-md-h::before,.item-fill-outline.item-has-placeholder.sc-ion-label-md-h:not(.item-input).label-floating::after,.item-fill-outline.item-has-placeholder:not(.item-input) .label-floating.sc-ion-label-md-h::after,.item-fill-outline.item-has-value.label-floating.sc-ion-label-md-h::before,.item-fill-outline.item-has-value .label-floating.sc-ion-label-md-h::before,.item-fill-outline.item-has-value.label-floating.sc-ion-label-md-h::after,.item-fill-outline.item-has-value .label-floating.sc-ion-label-md-h::after{position:absolute;width:4px;height:100%;background-color:var(--ion-item-background, var(--ion-background-color, #fff));content:""}.item-fill-outline.ion-focused.label-floating.sc-ion-label-md-h::before,.item-fill-outline.ion-focused .label-floating.sc-ion-label-md-h::before,.item-fill-outline.item-has-focus.label-floating.sc-ion-label-md-h::before,.item-fill-outline.item-has-focus .label-floating.sc-ion-label-md-h::before,.item-fill-outline.item-has-placeholder.sc-ion-label-md-h:not(.item-input).label-floating::before,.item-fill-outline.item-has-placeholder:not(.item-input) .label-floating.sc-ion-label-md-h::before,.item-fill-outline.item-has-value.label-floating.sc-ion-label-md-h::before,.item-fill-outline.item-has-value .label-floating.sc-ion-label-md-h::before{left:calc(-1 * 4px)}.item-fill-outline.ion-focused.label-floating.sc-ion-label-md-h::after,.item-fill-outline.ion-focused .label-floating.sc-ion-label-md-h::after,.item-fill-outline.item-has-focus.label-floating.sc-ion-label-md-h::after,.item-fill-outline.item-has-focus .label-floating.sc-ion-label-md-h::after,.item-fill-outline.item-has-placeholder.sc-ion-label-md-h:not(.item-input).label-floating::after,.item-fill-outline.item-has-placeholder:not(.item-input) .label-floating.sc-ion-label-md-h::after,.item-fill-outline.item-has-value.label-floating.sc-ion-label-md-h::after,.item-fill-outline.item-has-value .label-floating.sc-ion-label-md-h::after{right:calc(-1 * 4px)}.item-fill-outline.ion-focused.item-has-start-slot.label-floating.sc-ion-label-md-h,.item-fill-outline.ion-focused.item-has-start-slot .label-floating.sc-ion-label-md-h,.item-fill-outline.item-has-focus.item-has-start-slot.label-floating.sc-ion-label-md-h,.item-fill-outline.item-has-focus.item-has-start-slot .label-floating.sc-ion-label-md-h,.item-fill-outline.item-has-placeholder.sc-ion-label-md-h:not(.item-input).item-has-start-slot.label-floating,.item-fill-outline.item-has-placeholder:not(.item-input).item-has-start-slot .label-floating.sc-ion-label-md-h,.item-fill-outline.item-has-value.item-has-start-slot.label-floating.sc-ion-label-md-h,.item-fill-outline.item-has-value.item-has-start-slot .label-floating.sc-ion-label-md-h{-webkit-transform:translateX(-32px) translateY(-6px) scale(0.75);transform:translateX(-32px) translateY(-6px) scale(0.75)}.item-fill-outline.ion-focused.item-has-start-slot.label-floating.label-rtl.sc-ion-label-md-h,.item-fill-outline.ion-focused.item-has-start-slot .label-floating.label-rtl.sc-ion-label-md-h,.item-fill-outline.item-has-focus.item-has-start-slot.label-floating.label-rtl.sc-ion-label-md-h,.item-fill-outline.item-has-focus.item-has-start-slot .label-floating.label-rtl.sc-ion-label-md-h,.item-fill-outline.item-has-placeholder.sc-ion-label-md-h:not(.item-input).item-has-start-slot.label-floating.label-rtl,.item-fill-outline.item-has-placeholder:not(.item-input).item-has-start-slot .label-floating.label-rtl.sc-ion-label-md-h,.item-fill-outline.item-has-value.item-has-start-slot.label-floating.label-rtl.sc-ion-label-md-h,.item-fill-outline.item-has-value.item-has-start-slot .label-floating.label-rtl.sc-ion-label-md-h{-webkit-transform:translateX(calc(-1 * -32px)) translateY(-6px) scale(0.75);transform:translateX(calc(-1 * -32px)) translateY(-6px) scale(0.75)}.ion-focused.label-stacked.sc-ion-label-md-h:not(.ion-color),.ion-focused .label-stacked.sc-ion-label-md-h:not(.ion-color),.ion-focused.label-floating.sc-ion-label-md-h:not(.ion-color),.ion-focused .label-floating.sc-ion-label-md-h:not(.ion-color),.item-has-focus.label-stacked.sc-ion-label-md-h:not(.ion-color),.item-has-focus .label-stacked.sc-ion-label-md-h:not(.ion-color),.item-has-focus.label-floating.sc-ion-label-md-h:not(.ion-color),.item-has-focus .label-floating.sc-ion-label-md-h:not(.ion-color){color:var(--ion-color-primary, #3880ff)}.ion-focused.ion-color.label-stacked.sc-ion-label-md-h:not(.ion-color),.ion-focused.ion-color .label-stacked.sc-ion-label-md-h:not(.ion-color),.ion-focused.ion-color.label-floating.sc-ion-label-md-h:not(.ion-color),.ion-focused.ion-color .label-floating.sc-ion-label-md-h:not(.ion-color),.item-has-focus.ion-color.label-stacked.sc-ion-label-md-h:not(.ion-color),.item-has-focus.ion-color .label-stacked.sc-ion-label-md-h:not(.ion-color),.item-has-focus.ion-color.label-floating.sc-ion-label-md-h:not(.ion-color),.item-has-focus.ion-color .label-floating.sc-ion-label-md-h:not(.ion-color){color:var(--ion-color-contrast)}.item-fill-solid.ion-focused.ion-color.label-stacked.sc-ion-label-md-h:not(.ion-color),.item-fill-solid.ion-focused.ion-color .label-stacked.sc-ion-label-md-h:not(.ion-color),.item-fill-solid.ion-focused.ion-color.label-floating.sc-ion-label-md-h:not(.ion-color),.item-fill-solid.ion-focused.ion-color .label-floating.sc-ion-label-md-h:not(.ion-color),.item-fill-outline.ion-focused.ion-color.label-stacked.sc-ion-label-md-h:not(.ion-color),.item-fill-outline.ion-focused.ion-color .label-stacked.sc-ion-label-md-h:not(.ion-color),.item-fill-outline.ion-focused.ion-color.label-floating.sc-ion-label-md-h:not(.ion-color),.item-fill-outline.ion-focused.ion-color .label-floating.sc-ion-label-md-h:not(.ion-color),.item-fill-solid.item-has-focus.ion-color.label-stacked.sc-ion-label-md-h:not(.ion-color),.item-fill-solid.item-has-focus.ion-color .label-stacked.sc-ion-label-md-h:not(.ion-color),.item-fill-solid.item-has-focus.ion-color.label-floating.sc-ion-label-md-h:not(.ion-color),.item-fill-solid.item-has-focus.ion-color .label-floating.sc-ion-label-md-h:not(.ion-color),.item-fill-outline.item-has-focus.ion-color.label-stacked.sc-ion-label-md-h:not(.ion-color),.item-fill-outline.item-has-focus.ion-color .label-stacked.sc-ion-label-md-h:not(.ion-color),.item-fill-outline.item-has-focus.ion-color.label-floating.sc-ion-label-md-h:not(.ion-color),.item-fill-outline.item-has-focus.ion-color .label-floating.sc-ion-label-md-h:not(.ion-color){color:var(--ion-color-base)}.ion-invalid.ion-touched.label-stacked.sc-ion-label-md-h:not(.ion-color),.ion-invalid.ion-touched .label-stacked.sc-ion-label-md-h:not(.ion-color),.ion-invalid.ion-touched.label-floating.sc-ion-label-md-h:not(.ion-color),.ion-invalid.ion-touched .label-floating.sc-ion-label-md-h:not(.ion-color){color:var(--highlight-color-invalid)}.sc-ion-label-md-s h1{margin-left:0;margin-right:0;margin-top:0;margin-bottom:2px;font-size:24px;font-weight:normal}.sc-ion-label-md-s h2{margin-left:0;margin-right:0;margin-top:2px;margin-bottom:2px;font-size:16px;font-weight:normal}.sc-ion-label-md-s h3,.sc-ion-label-md-s h4,.sc-ion-label-md-s h5,.sc-ion-label-md-s h6{margin-left:0;margin-right:0;margin-top:2px;margin-bottom:2px;font-size:14px;font-weight:normal;line-height:normal}.sc-ion-label-md-s p{margin-left:0;margin-right:0;margin-top:0;margin-bottom:2px;font-size:14px;line-height:20px;text-overflow:inherit;overflow:inherit}.sc-ion-label-md-s>p{color:var(--ion-color-step-600, #666666)}.sc-ion-label-md-h.in-item-color.sc-ion-label-md-s>p{color:inherit}',g7=ur(class extends cr{constructor(){super(),this.__registerHost(),this.ionColor=bt(this,"ionColor",7),this.ionStyle=bt(this,"ionStyle",7),this.inRange=!1,this.color=void 0,this.position=void 0,this.noAnimate=!1}componentWillLoad(){this.inRange=!!this.el.closest("ion-range"),this.noAnimate=this.position==="floating",this.emitStyle(),this.emitColor()}componentDidLoad(){this.noAnimate&&setTimeout(()=>{this.noAnimate=!1},1e3)}colorChanged(){this.emitColor()}positionChanged(){this.emitStyle()}emitColor(){const{color:t}=this;this.ionColor.emit({"item-label-color":t!==void 0,["ion-color-".concat(t)]:t!==void 0})}emitStyle(){const{inRange:t,position:n}=this;t||this.ionStyle.emit({label:!0,["label-".concat(n)]:n!==void 0})}render(){const t=this.position,n=zt(this);return De(_r,{class:Ym(this.color,{[n]:!0,"in-item-color":$i("ion-item.ion-color",this.el),["label-".concat(t)]:t!==void 0,"label-no-animate":this.noAnimate,"label-rtl":document.dir==="rtl"})})}get el(){return this}static get watchers(){return{color:["colorChanged"],position:["positionChanged"]}}static get style(){return{ios:f7,md:m7}}},[34,"ion-label",{color:[513],position:[1],noAnimate:[32]}]);function y7(){if(typeof customElements>"u")return;["ion-label"].forEach(t=>{switch(t){case"ion-label":customElements.get(t)||customElements.define(t,g7);break}})}/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const b7="ION-CONTENT",nL="ion-content",rL=".ion-content-scroll-host",aL="".concat(nL,", ").concat(rL),Kl=e=>e.tagName===b7,dA=async e=>Kl(e)?(await new Promise(t=>Qd(e,t)),e.getScrollElement()):e,Pk=e=>{const t=e.querySelector(rL);return t||e.querySelector(aL)},v7=e=>e.closest(aL),LPe=(e,t)=>Kl(e)?e.scrollToTop(t):Promise.resolve(e.scrollTo({top:0,left:0,behavior:t>0?"smooth":"auto"})),PPe=(e,t,n,r)=>Kl(e)?e.scrollByPoint(t,n,r):Promise.resolve(e.scrollBy({top:n,left:t,behavior:r>0?"smooth":"auto"})),zk=e=>IK(e,nL),pA=e=>{if(Kl(e)){const t=e,n=t.scrollY;return t.scrollY=!1,n}else return e.style.setProperty("overflow","hidden"),!0},x7=(e,t)=>{Kl(e)?e.scrollY=t:e.style.removeProperty("overflow")};/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */var Bk;(function(e){e.Body="body",e.Ionic="ionic",e.Native="native",e.None="none"})(Bk||(Bk={}));const iL={getEngine(){var e;return((e=ct==null?void 0:ct.Capacitor)===null||e===void 0?void 0:e.isPluginAvailable("Keyboard"))&&(ct==null?void 0:ct.Capacitor.Plugins.Keyboard)},getResizeMode(){const e=this.getEngine();return e!=null&&e.getResizeMode?e.getResizeMode().catch(t=>{if(t.code!=="UNIMPLEMENTED")throw t}):Promise.resolve(void 0)}};/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const sL=e=>{if(i1===void 0||e===Bk.None||e===void 0)return null;const t=i1.querySelector("ion-app");return t!=null?t:i1.body},hA=e=>{const t=sL(e);return t===null?0:t.clientHeight},w7=async e=>{let t,n,r,a;const i=async()=>{const u=await iL.getResizeMode(),d=u===void 0?void 0:u.mode;t=()=>{a===void 0&&(a=hA(d)),r=!0,s(r,d)},n=()=>{r=!1,s(r,d)},ct==null||ct.addEventListener("keyboardWillShow",t),ct==null||ct.addEventListener("keyboardWillHide",n)},s=(u,d)=>{e&&e(u,o(d))},o=u=>{if(a===0||a===hA(u))return;const d=sL(u);if(d!==null)return new Promise(p=>{const h=()=>{d.clientHeight===a&&(f.disconnect(),p())},f=new ResizeObserver(h);f.observe(d)})},l=()=>{ct==null||ct.removeEventListener("keyboardWillShow",t),ct==null||ct.removeEventListener("keyboardWillHide",n),t=n=void 0},c=()=>r;return await i(),{init:i,destroy:l,isKeyboardVisible:c}};/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const k7=":host{-webkit-padding-start:var(--ion-grid-padding-xs, var(--ion-grid-padding, 5px));padding-inline-start:var(--ion-grid-padding-xs, var(--ion-grid-padding, 5px));-webkit-padding-end:var(--ion-grid-padding-xs, var(--ion-grid-padding, 5px));padding-inline-end:var(--ion-grid-padding-xs, var(--ion-grid-padding, 5px));padding-top:var(--ion-grid-padding-xs, var(--ion-grid-padding, 5px));padding-bottom:var(--ion-grid-padding-xs, var(--ion-grid-padding, 5px));-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;display:block;-ms-flex:1;flex:1}@media (min-width: 576px){:host{-webkit-padding-start:var(--ion-grid-padding-sm, var(--ion-grid-padding, 5px));padding-inline-start:var(--ion-grid-padding-sm, var(--ion-grid-padding, 5px));-webkit-padding-end:var(--ion-grid-padding-sm, var(--ion-grid-padding, 5px));padding-inline-end:var(--ion-grid-padding-sm, var(--ion-grid-padding, 5px));padding-top:var(--ion-grid-padding-sm, var(--ion-grid-padding, 5px));padding-bottom:var(--ion-grid-padding-sm, var(--ion-grid-padding, 5px))}}@media (min-width: 768px){:host{-webkit-padding-start:var(--ion-grid-padding-md, var(--ion-grid-padding, 5px));padding-inline-start:var(--ion-grid-padding-md, var(--ion-grid-padding, 5px));-webkit-padding-end:var(--ion-grid-padding-md, var(--ion-grid-padding, 5px));padding-inline-end:var(--ion-grid-padding-md, var(--ion-grid-padding, 5px));padding-top:var(--ion-grid-padding-md, var(--ion-grid-padding, 5px));padding-bottom:var(--ion-grid-padding-md, var(--ion-grid-padding, 5px))}}@media (min-width: 992px){:host{-webkit-padding-start:var(--ion-grid-padding-lg, var(--ion-grid-padding, 5px));padding-inline-start:var(--ion-grid-padding-lg, var(--ion-grid-padding, 5px));-webkit-padding-end:var(--ion-grid-padding-lg, var(--ion-grid-padding, 5px));padding-inline-end:var(--ion-grid-padding-lg, var(--ion-grid-padding, 5px));padding-top:var(--ion-grid-padding-lg, var(--ion-grid-padding, 5px));padding-bottom:var(--ion-grid-padding-lg, var(--ion-grid-padding, 5px))}}@media (min-width: 1200px){:host{-webkit-padding-start:var(--ion-grid-padding-xl, var(--ion-grid-padding, 5px));padding-inline-start:var(--ion-grid-padding-xl, var(--ion-grid-padding, 5px));-webkit-padding-end:var(--ion-grid-padding-xl, var(--ion-grid-padding, 5px));padding-inline-end:var(--ion-grid-padding-xl, var(--ion-grid-padding, 5px));padding-top:var(--ion-grid-padding-xl, var(--ion-grid-padding, 5px));padding-bottom:var(--ion-grid-padding-xl, var(--ion-grid-padding, 5px))}}:host(.grid-fixed){width:var(--ion-grid-width-xs, var(--ion-grid-width, 100%));max-width:100%}@media (min-width: 576px){:host(.grid-fixed){width:var(--ion-grid-width-sm, var(--ion-grid-width, 540px))}}@media (min-width: 768px){:host(.grid-fixed){width:var(--ion-grid-width-md, var(--ion-grid-width, 720px))}}@media (min-width: 992px){:host(.grid-fixed){width:var(--ion-grid-width-lg, var(--ion-grid-width, 960px))}}@media (min-width: 1200px){:host(.grid-fixed){width:var(--ion-grid-width-xl, var(--ion-grid-width, 1140px))}}:host(.ion-no-padding){--ion-grid-column-padding:0;--ion-grid-column-padding-xs:0;--ion-grid-column-padding-sm:0;--ion-grid-column-padding-md:0;--ion-grid-column-padding-lg:0;--ion-grid-column-padding-xl:0}",S7=ur(class extends cr{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.fixed=!1}render(){const t=zt(this);return De(_r,{class:{[t]:!0,"grid-fixed":this.fixed}},De("slot",null))}static get style(){return k7}},[1,"ion-grid",{fixed:[4]}]);function I7(){if(typeof customElements>"u")return;["ion-grid"].forEach(t=>{switch(t){case"ion-grid":customElements.get(t)||customElements.define(t,S7);break}})}const $7=I7;/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const C7="all 0.2s ease-in-out",fA=e=>{const t=document.querySelector("".concat(e,".ion-cloned-element"));if(t!==null)return t;const n=document.createElement(e);return n.classList.add("ion-cloned-element"),n.style.setProperty("display","none"),document.body.appendChild(n),n},mA=e=>{if(!e)return;const t=e.querySelectorAll("ion-toolbar");return{el:e,toolbars:Array.from(t).map(n=>{const r=n.querySelector("ion-title");return{el:n,background:n.shadowRoot.querySelector(".toolbar-background"),ionTitleEl:r,innerTitleEl:r?r.shadowRoot.querySelector(".toolbar-title"):null,ionButtonsEl:Array.from(n.querySelectorAll("ion-buttons"))}})}},E7=(e,t,n)=>{ym(()=>{const r=e.scrollTop,a=Jd(1,1+-r/500,1.1);n.querySelector("ion-refresher.refresher-native")===null&&Ri(()=>{_7(t.toolbars,a)})})},y$=(e,t)=>{e.collapse!=="fade"&&(t===void 0?e.style.removeProperty("--opacity-scale"):e.style.setProperty("--opacity-scale",t.toString()))},T7=(e,t,n)=>{if(!e[0].isIntersecting)return;const r=e[0].intersectionRatio>.9||n<=0?0:(1-e[0].intersectionRatio)*100/75;y$(t.el,r===1?void 0:r)},N7=(e,t,n,r)=>{Ri(()=>{const a=r.scrollTop;T7(e,t,a);const i=e[0],s=i.intersectionRect,o=s.width*s.height,l=i.rootBounds.width*i.rootBounds.height,c=o===0&&l===0,u=Math.abs(s.left-i.boundingClientRect.left),d=Math.abs(s.right-i.boundingClientRect.right),p=o>0&&(u>=5||d>=5);c||p||(i.isIntersecting?(Sf(t,!1),Sf(n)):(s.x===0&&s.y===0||s.width!==0&&s.height!==0)&&a>0&&(Sf(t),Sf(n,!1),y$(t.el)))})},Sf=(e,t=!0)=>{const n=e.el;t?(n.classList.remove("header-collapse-condense-inactive"),n.removeAttribute("aria-hidden")):(n.classList.add("header-collapse-condense-inactive"),n.setAttribute("aria-hidden","true"))},_7=(e=[],t=1,n=!1)=>{e.forEach(r=>{const a=r.ionTitleEl,i=r.innerTitleEl;!a||a.size!=="large"||(i.style.transition=n?C7:"",i.style.transform="scale3d(".concat(t,", ").concat(t,", 1)"))})},gA=(e,t,n)=>{ym(()=>{const r=e.scrollTop,a=t.clientHeight,i=n?n.clientHeight:0;if(n!==null&&r<i){t.style.setProperty("--opacity-scale","0"),e.style.setProperty("clip-path","inset(".concat(a,"px 0px 0px 0px)"));return}const s=r-i,l=Jd(0,s/10,1);Ri(()=>{e.style.removeProperty("clip-path"),t.style.setProperty("--opacity-scale",l.toString())})})},A7="ion-header{display:block;position:relative;-ms-flex-order:-1;order:-1;width:100%;z-index:10}ion-header ion-toolbar:first-of-type{padding-top:var(--ion-safe-area-top, 0)}.header-ios ion-toolbar:last-of-type{--border-width:0 0 0.55px}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){.header-background{left:0;right:0;top:0;bottom:0;position:absolute;-webkit-backdrop-filter:saturate(180%) blur(20px);backdrop-filter:saturate(180%) blur(20px)}.header-translucent-ios ion-toolbar{--opacity:.8}.header-collapse-condense-inactive .header-background{-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px)}}.header-ios.ion-no-border ion-toolbar:last-of-type{--border-width:0}.header-collapse-fade ion-toolbar{--opacity-scale:inherit}.header-collapse-condense{z-index:9}.header-collapse-condense ion-toolbar{position:-webkit-sticky;position:sticky;top:0}.header-collapse-condense ion-toolbar:first-of-type{padding-top:7px;z-index:1}.header-collapse-condense ion-toolbar{--background:var(--ion-background-color, #fff);z-index:0}.header-collapse-condense ion-toolbar:last-of-type{--border-width:0px}.header-collapse-condense ion-toolbar ion-searchbar{height:48px;padding-top:0px;padding-bottom:13px}.header-collapse-main{--opacity-scale:1}.header-collapse-main ion-toolbar{--opacity-scale:inherit}.header-collapse-main ion-toolbar.in-toolbar ion-title,.header-collapse-main ion-toolbar.in-toolbar ion-buttons{-webkit-transition:all 0.2s ease-in-out;transition:all 0.2s ease-in-out}.header-collapse-condense-inactive:not(.header-collapse-condense) ion-toolbar.in-toolbar ion-title,.header-collapse-condense-inactive:not(.header-collapse-condense) ion-toolbar.in-toolbar ion-buttons.buttons-collapse{opacity:0;pointer-events:none}.header-collapse-condense-inactive.header-collapse-condense ion-toolbar.in-toolbar ion-title,.header-collapse-condense-inactive.header-collapse-condense ion-toolbar.in-toolbar ion-buttons.buttons-collapse{visibility:hidden}",R7="ion-header{display:block;position:relative;-ms-flex-order:-1;order:-1;width:100%;z-index:10}ion-header ion-toolbar:first-of-type{padding-top:var(--ion-safe-area-top, 0)}.header-md{-webkit-box-shadow:0 2px 4px -1px rgba(0, 0, 0, 0.2), 0 4px 5px 0 rgba(0, 0, 0, 0.14), 0 1px 10px 0 rgba(0, 0, 0, 0.12);box-shadow:0 2px 4px -1px rgba(0, 0, 0, 0.2), 0 4px 5px 0 rgba(0, 0, 0, 0.14), 0 1px 10px 0 rgba(0, 0, 0, 0.12)}.header-collapse-condense{display:none}.header-md.ion-no-border{-webkit-box-shadow:none;box-shadow:none}",D7=ur(class extends cr{constructor(){super(),this.__registerHost(),this.inheritedAttributes={},this.setupFadeHeader=async(t,n)=>{const r=this.scrollEl=await dA(t);this.contentScrollCallback=()=>{gA(this.scrollEl,this.el,n)},r.addEventListener("scroll",this.contentScrollCallback),gA(this.scrollEl,this.el,n)},this.collapse=void 0,this.translucent=!1}componentWillLoad(){this.inheritedAttributes=MO(this.el)}componentDidLoad(){this.checkCollapsibleHeader()}componentDidUpdate(){this.checkCollapsibleHeader()}disconnectedCallback(){this.destroyCollapsibleHeader()}async checkCollapsibleHeader(){if(zt(this)!=="ios")return;const{collapse:n}=this,r=n==="condense",a=n==="fade";if(this.destroyCollapsibleHeader(),r){const i=this.el.closest("ion-app,ion-page,.ion-page,page-inner"),s=i?Pk(i):null;Ri(()=>{const o=fA("ion-title");o.size="large",fA("ion-back-button")}),await this.setupCondenseHeader(s,i)}else if(a){const i=this.el.closest("ion-app,ion-page,.ion-page,page-inner"),s=i?Pk(i):null;if(!s){zk(this.el);return}const o=s.querySelector('ion-header[collapse="condense"]');await this.setupFadeHeader(s,o)}}destroyCollapsibleHeader(){this.intersectionObserver&&(this.intersectionObserver.disconnect(),this.intersectionObserver=void 0),this.scrollEl&&this.contentScrollCallback&&(this.scrollEl.removeEventListener("scroll",this.contentScrollCallback),this.contentScrollCallback=void 0),this.collapsibleMainHeader&&(this.collapsibleMainHeader.classList.remove("header-collapse-main"),this.collapsibleMainHeader=void 0)}async setupCondenseHeader(t,n){if(!t||!n){zk(this.el);return}if(typeof IntersectionObserver>"u")return;this.scrollEl=await dA(t);const r=n.querySelectorAll("ion-header");if(this.collapsibleMainHeader=Array.from(r).find(o=>o.collapse!=="condense"),!this.collapsibleMainHeader)return;const a=mA(this.collapsibleMainHeader),i=mA(this.el);if(!a||!i)return;Sf(a,!1),y$(a.el,0);const s=o=>{N7(o,a,i,this.scrollEl)};this.intersectionObserver=new IntersectionObserver(s,{root:t,threshold:[.25,.3,.4,.5,.6,.7,.8,.9,1]}),this.intersectionObserver.observe(i.toolbars[i.toolbars.length-1].el),this.contentScrollCallback=()=>{E7(this.scrollEl,i,t)},this.scrollEl.addEventListener("scroll",this.contentScrollCallback),Ri(()=>{this.collapsibleMainHeader!==void 0&&this.collapsibleMainHeader.classList.add("header-collapse-main")})}render(){const{translucent:t,inheritedAttributes:n}=this,r=zt(this),a=this.collapse||"none",i=$i("ion-menu",this.el)?"none":"banner";return De(_r,Object.assign({role:i,class:{[r]:!0,["header-".concat(r)]:!0,"header-translucent":this.translucent,["header-collapse-".concat(a)]:!0,["header-translucent-".concat(r)]:this.translucent}},n),r==="ios"&&t&&De("div",{class:"header-background"}),De("slot",null))}get el(){return this}static get style(){return{ios:A7,md:R7}}},[36,"ion-header",{collapse:[1],translucent:[4]}]);function F7(){if(typeof customElements>"u")return;["ion-header"].forEach(t=>{switch(t){case"ion-header":customElements.get(t)||customElements.define(t,D7);break}})}const M7=F7;/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const O7=y7,oL=1,lL=2,ov=3;class Wk{constructor(t,n){this.component=t,this.params=n,this.state=oL}async init(t){if(this.state=lL,!this.element){const n=this.component;this.element=await g$(this.delegate,t,n,["ion-page","ion-page-invisible"],this.params)}}_destroy(){Jr(this.state!==ov,"view state must be ATTACHED");const t=this.element;t&&(this.delegate?this.delegate.removeViewFromDom(t.parentElement,t):t.remove()),this.nav=void 0,this.state=ov}}const yA=(e,t,n)=>!e||e.component!==t?!1:OO(e.params,n),bA=(e,t)=>e?e instanceof Wk?e:new Wk(e,t):null,L7=e=>e.map(t=>t instanceof Wk?t:"component"in t?bA(t.component,t.componentProps===null?void 0:t.componentProps):bA(t,void 0)).filter(t=>t!==null),P7=":host{left:0;right:0;top:0;bottom:0;position:absolute;contain:layout size style;overflow:hidden;z-index:0}",z7=ur(class extends cr{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.ionNavWillLoad=bt(this,"ionNavWillLoad",7),this.ionNavWillChange=bt(this,"ionNavWillChange",3),this.ionNavDidChange=bt(this,"ionNavDidChange",3),this.transInstr=[],this.animationEnabled=!0,this.useRouter=!1,this.isTransitioning=!1,this.destroyed=!1,this.views=[],this.didLoad=!1,this.delegate=void 0,this.swipeGesture=void 0,this.animated=!0,this.animation=void 0,this.rootParams=void 0,this.root=void 0}swipeGestureChanged(){this.gesture&&this.gesture.enable(this.swipeGesture===!0)}rootChanged(){this.root!==void 0&&this.didLoad!==!1&&(this.useRouter||this.root!==void 0&&this.setRoot(this.root,this.rootParams))}componentWillLoad(){if(this.useRouter=document.querySelector("ion-router")!==null&&this.el.closest("[no-router]")===null,this.swipeGesture===void 0){const t=zt(this);this.swipeGesture=Ft.getBoolean("swipeBackEnabled",t==="ios")}this.ionNavWillLoad.emit()}async componentDidLoad(){this.didLoad=!0,this.rootChanged(),this.gesture=(await gi(()=>import("./swipe-back-66ffc96b.js"),[])).createSwipeBackGesture(this.el,this.canStart.bind(this),this.onStart.bind(this),this.onMove.bind(this),this.onEnd.bind(this)),this.swipeGestureChanged()}connectedCallback(){this.destroyed=!1}disconnectedCallback(){for(const t of this.views)ws(t.element,o1),t._destroy();this.gesture&&(this.gesture.destroy(),this.gesture=void 0),this.transInstr.length=0,this.views.length=0,this.destroyed=!0}push(t,n,r,a){return this.insert(-1,t,n,r,a)}insert(t,n,r,a,i){return this.insertPages(t,[{component:n,componentProps:r}],a,i)}insertPages(t,n,r,a){return this.queueTrns({insertStart:t,insertViews:n,opts:r},a)}pop(t,n){return this.removeIndex(-1,1,t,n)}popTo(t,n,r){const a={removeStart:-1,removeCount:-1,opts:n};return typeof t=="object"&&t.component?(a.removeView=t,a.removeStart=1):typeof t=="number"&&(a.removeStart=t+1),this.queueTrns(a,r)}popToRoot(t,n){return this.removeIndex(1,-1,t,n)}removeIndex(t,n=1,r,a){return this.queueTrns({removeStart:t,removeCount:n,opts:r},a)}setRoot(t,n,r,a){return this.setPages([{component:t,componentProps:n}],r,a)}setPages(t,n,r){return n!=null||(n={}),n.animated!==!0&&(n.animated=!1),this.queueTrns({insertStart:0,insertViews:t,removeStart:0,removeCount:-1,opts:n},r)}setRouteId(t,n,r,a){const i=this.getActiveSync();if(yA(i,t,n))return Promise.resolve({changed:!1,element:i.element});let s;const o=new Promise(u=>s=u);let l;const c={updateURL:!1,viewIsReady:u=>{let d;const p=new Promise(h=>d=h);return s({changed:!0,element:u,markVisible:async()=>{d(),await l}}),p}};if(r==="root")l=this.setRoot(t,n,c);else{const u=this.views.find(d=>yA(d,t,n));u?l=this.popTo(u,Object.assign(Object.assign({},c),{direction:"back",animationBuilder:a})):r==="forward"?l=this.push(t,n,Object.assign(Object.assign({},c),{animationBuilder:a})):r==="back"&&(l=this.setRoot(t,n,Object.assign(Object.assign({},c),{direction:"back",animated:!0,animationBuilder:a})))}return o}async getRouteId(){const t=this.getActiveSync();if(t)return{id:t.element.tagName,params:t.params,element:t.element}}async getActive(){return this.getActiveSync()}async getByIndex(t){return this.views[t]}async canGoBack(t){return this.canGoBackSync(t)}async getPrevious(t){return this.getPreviousSync(t)}getLength(){return this.views.length}getActiveSync(){return this.views[this.views.length-1]}canGoBackSync(t=this.getActiveSync()){return!!(t&&this.getPreviousSync(t))}getPreviousSync(t=this.getActiveSync()){if(!t)return;const n=this.views,r=n.indexOf(t);return r>0?n[r-1]:void 0}async queueTrns(t,n){var r,a;if(this.isTransitioning&&(!((r=t.opts)===null||r===void 0)&&r.skipIfBusy))return!1;const i=new Promise((s,o)=>{t.resolve=s,t.reject=o});if(t.done=n,t.opts&&t.opts.updateURL!==!1&&this.useRouter){const s=document.querySelector("ion-router");if(s){const o=await s.canTransition();if(o===!1)return!1;if(typeof o=="string")return s.push(o,t.opts.direction||"back"),!1}}return((a=t.insertViews)===null||a===void 0?void 0:a.length)===0&&(t.insertViews=void 0),this.transInstr.push(t),this.nextTrns(),i}success(t,n){if(this.destroyed){this.fireError("nav controller was destroyed",n);return}if(n.done&&n.done(t.hasCompleted,t.requiresTransition,t.enteringView,t.leavingView,t.direction),n.resolve(t.hasCompleted),n.opts.updateURL!==!1&&this.useRouter){const r=document.querySelector("ion-router");if(r){const a=t.direction==="back"?"back":"forward";r.navChanged(a)}}}failed(t,n){if(this.destroyed){this.fireError("nav controller was destroyed",n);return}this.transInstr.length=0,this.fireError(t,n)}fireError(t,n){n.done&&n.done(!1,!1,t),n.reject&&!this.destroyed?n.reject(t):n.resolve(!1)}nextTrns(){if(this.isTransitioning)return!1;const t=this.transInstr.shift();return t?(this.runTransition(t),!0):!1}async runTransition(t){try{this.ionNavWillChange.emit(),this.isTransitioning=!0,this.prepareTI(t);const n=this.getActiveSync(),r=this.getEnteringView(t,n);if(!n&&!r)throw new Error("no views in the stack to be removed");r&&r.state===oL&&await r.init(this.el),this.postViewInit(r,n,t);const a=(t.enteringRequiresTransition||t.leavingRequiresTransition)&&r!==n;a&&t.opts&&n&&(t.opts.direction==="back"&&(t.opts.animationBuilder=t.opts.animationBuilder||(r==null?void 0:r.animationBuilder)),n.animationBuilder=t.opts.animationBuilder);let i;a?i=await this.transition(r,n,t):i={hasCompleted:!0,requiresTransition:!1},this.success(i,t),this.ionNavDidChange.emit()}catch(n){this.failed(n,t)}this.isTransitioning=!1,this.nextTrns()}prepareTI(t){var n,r,a;const i=this.views.length;if((n=t.opts)!==null&&n!==void 0||(t.opts={}),(r=(a=t.opts).delegate)!==null&&r!==void 0||(a.delegate=this.delegate),t.removeView!==void 0){Jr(t.removeStart!==void 0,"removeView needs removeStart"),Jr(t.removeCount!==void 0,"removeView needs removeCount");const l=this.views.indexOf(t.removeView);if(l<0)throw new Error("removeView was not found");t.removeStart+=l}t.removeStart!==void 0&&(t.removeStart<0&&(t.removeStart=i-1),t.removeCount<0&&(t.removeCount=i-t.removeStart),t.leavingRequiresTransition=t.removeCount>0&&t.removeStart+t.removeCount===i),t.insertViews&&((t.insertStart<0||t.insertStart>i)&&(t.insertStart=i),t.enteringRequiresTransition=t.insertStart===i);const s=t.insertViews;if(!s)return;Jr(s.length>0,"length can not be zero");const o=L7(s);if(o.length===0)throw new Error("invalid views to insert");for(const l of o){l.delegate=t.opts.delegate;const c=l.nav;if(c&&c!==this)throw new Error("inserted view was already inserted");if(l.state===ov)throw new Error("inserted view was already destroyed")}t.insertViews=o}getEnteringView(t,n){const r=t.insertViews;if(r!==void 0)return r[r.length-1];const a=t.removeStart;if(a!==void 0){const i=this.views,s=a+t.removeCount;for(let o=i.length-1;o>=0;o--){const l=i[o];if((o<a||o>=s)&&l!==n)return l}}}postViewInit(t,n,r){var a,i,s;Jr(n||t,"Both leavingView and enteringView are null"),Jr(r.resolve,"resolve must be valid"),Jr(r.reject,"reject must be valid");const o=r.opts,{insertViews:l,removeStart:c,removeCount:u}=r;let d;if(c!==void 0&&u!==void 0){Jr(c>=0,"removeStart can not be negative"),Jr(u>=0,"removeCount can not be negative"),d=[];for(let h=c;h<c+u;h++){const f=this.views[h];f!==void 0&&f!==t&&f!==n&&d.push(f)}(a=o.direction)!==null&&a!==void 0||(o.direction="back")}const p=this.views.length+((i=l==null?void 0:l.length)!==null&&i!==void 0?i:0)-(u!=null?u:0);if(Jr(p>=0,"final balance can not be negative"),p===0)throw console.warn("You can't remove all the pages in the navigation stack. nav.pop() is probably called too many times.",this,this.el),new Error("navigation stack needs at least one root page");if(l){let h=r.insertStart;for(const f of l)this.insertViewAt(f,h),h++;r.enteringRequiresTransition&&((s=o.direction)!==null&&s!==void 0||(o.direction="forward"))}if(d&&d.length>0){for(const h of d)ws(h.element,LO),ws(h.element,PO),ws(h.element,o1);for(const h of d)this.destroyView(h)}}async transition(t,n,r){const a=r.opts,i=a.progressAnimation?d=>this.sbAni=d:void 0,s=zt(this),o=t.element,l=n&&n.element,c=Object.assign(Object.assign({mode:s,showGoBack:this.canGoBackSync(t),baseEl:this.el,progressCallback:i,animated:this.animated&&Ft.getBoolean("animated",!0),enteringEl:o,leavingEl:l},a),{animationBuilder:a.animationBuilder||this.animation||Ft.get("navAnimation")}),{hasCompleted:u}=await zO(c);return this.transitionFinish(u,t,n,a)}transitionFinish(t,n,r,a){const i=t?n:r;return i&&this.unmountInactiveViews(i),{hasCompleted:t,requiresTransition:!0,enteringView:n,leavingView:r,direction:a.direction}}insertViewAt(t,n){const r=this.views,a=r.indexOf(t);a>-1?(Jr(t.nav===this,"view is not part of the nav"),r.splice(a,1),r.splice(n,0,t)):(Jr(!t.nav,"nav is used"),t.nav=this,r.splice(n,0,t))}removeView(t){Jr(t.state===lL||t.state===ov,"view state should be loaded or destroyed");const n=this.views,r=n.indexOf(t);Jr(r>-1,"view must be part of the stack"),r>=0&&n.splice(r,1)}destroyView(t){t._destroy(),this.removeView(t)}unmountInactiveViews(t){if(this.destroyed)return;const n=this.views,r=n.indexOf(t);for(let a=n.length-1;a>=0;a--){const i=n[a],s=i.element;s&&(a>r?(ws(s,o1),this.destroyView(i)):a<r&&Dk(s,!0))}}canStart(){return!!this.swipeGesture&&!this.isTransitioning&&this.transInstr.length===0&&this.animationEnabled&&this.canGoBackSync()}onStart(){this.pop({direction:"back",progressAnimation:!0})}onMove(t){this.sbAni&&this.sbAni.progressStep(t)}onEnd(t,n,r){if(this.sbAni){this.animationEnabled=!1,this.sbAni.onFinish(()=>{this.animationEnabled=!0},{oneTimeCallback:!0});let a=t?-.001:.001;t?a+=ep([0,0],[.32,.72],[0,1],[1,1],n)[0]:(this.sbAni.easing("cubic-bezier(1, 0, 0.68, 0.28)"),a+=ep([0,0],[1,0],[.68,.28],[1,1],n)[0]),this.sbAni.progressEnd(t?1:0,a,r)}}render(){return De("slot",null)}get el(){return this}static get watchers(){return{swipeGesture:["swipeGestureChanged"],root:["rootChanged"]}}static get style(){return P7}},[1,"ion-nav",{delegate:[16],swipeGesture:[1028,"swipe-gesture"],animated:[4],animation:[16],rootParams:[16],root:[1],push:[64],insert:[64],insertPages:[64],pop:[64],popTo:[64],popToRoot:[64],removeIndex:[64],setRoot:[64],setPages:[64],setRouteId:[64],getRouteId:[64],getActive:[64],getByIndex:[64],canGoBack:[64],getPrevious:[64]}]);function B7(){if(typeof customElements>"u")return;["ion-nav"].forEach(t=>{switch(t){case"ion-nav":customElements.get(t)||customElements.define(t,z7);break}})}const W7=B7;/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const U7=":host{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}",V7=ur(class extends cr{constructor(){super(),this.__registerHost(),this.__attachShadow()}render(){return De(_r,{class:zt(this)},De("slot",null))}static get style(){return U7}},[1,"ion-row"]);function H7(){if(typeof customElements>"u")return;["ion-row"].forEach(t=>{switch(t){case"ion-row":customElements.get(t)||customElements.define(t,V7);break}})}const j7=H7,G7=":host{--ripple-color:currentColor;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:grid;grid-auto-columns:1fr;position:relative;-ms-flex-align:stretch;align-items:stretch;-ms-flex-pack:center;justify-content:center;width:100%;background:var(--background);font-family:var(--ion-font-family, inherit);text-align:center;contain:paint;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}:host(.segment-scrollable){-ms-flex-pack:start;justify-content:start;width:auto;overflow-x:auto;grid-auto-columns:minmax(-webkit-min-content, 1fr);grid-auto-columns:minmax(min-content, 1fr)}:host(.segment-scrollable::-webkit-scrollbar){display:none}:host{--background:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.065);border-radius:8px;overflow:hidden;z-index:0}:host(.ion-color){background:rgba(var(--ion-color-base-rgb), 0.065)}:host(.in-toolbar){-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;margin-top:0;margin-bottom:0;width:auto}:host(.in-toolbar:not(.ion-color)){background:var(--ion-toolbar-segment-background, var(--background))}:host(.in-toolbar-color:not(.ion-color)){background:rgba(var(--ion-color-contrast-rgb), 0.11)}",q7=":host{--ripple-color:currentColor;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:grid;grid-auto-columns:1fr;position:relative;-ms-flex-align:stretch;align-items:stretch;-ms-flex-pack:center;justify-content:center;width:100%;background:var(--background);font-family:var(--ion-font-family, inherit);text-align:center;contain:paint;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}:host(.segment-scrollable){-ms-flex-pack:start;justify-content:start;width:auto;overflow-x:auto;grid-auto-columns:minmax(-webkit-min-content, 1fr);grid-auto-columns:minmax(min-content, 1fr)}:host(.segment-scrollable::-webkit-scrollbar){display:none}:host{--background:transparent;grid-auto-columns:minmax(auto, 360px)}:host(.in-toolbar){min-height:var(--min-height)}:host(.segment-scrollable) ::slotted(ion-segment-button){min-width:auto}",K7=ur(class extends cr{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.ionChange=bt(this,"ionChange",7),this.ionSelect=bt(this,"ionSelect",7),this.ionStyle=bt(this,"ionStyle",7),this.onClick=t=>{const n=t.target,r=this.checked;n.tagName!=="ION-SEGMENT"&&(this.value=n.value,n!==r&&this.emitValueChange(),(this.scrollable||!this.swipeGesture)&&(r?this.checkButton(r,n):this.setCheckedClasses()))},this.getSegmentButton=t=>{var n,r;const a=this.getButtons().filter(s=>!s.disabled),i=a.findIndex(s=>s===document.activeElement);switch(t){case"first":return a[0];case"last":return a[a.length-1];case"next":return(n=a[i+1])!==null&&n!==void 0?n:a[0];case"previous":return(r=a[i-1])!==null&&r!==void 0?r:a[a.length-1];default:return null}},this.activated=!1,this.color=void 0,this.disabled=!1,this.scrollable=!1,this.swipeGesture=!0,this.value=void 0,this.selectOnFocus=!1}colorChanged(t,n){(n===void 0&&t!==void 0||n!==void 0&&t===void 0)&&this.emitStyle()}swipeGestureChanged(){this.gestureChanged()}valueChanged(t){if(this.ionSelect.emit({value:t}),this.scrollable){const r=this.getButtons().find(a=>a.value===t);r!==void 0&&r.scrollIntoView({behavior:"smooth",inline:"center",block:"nearest"})}}disabledChanged(){this.gestureChanged();const t=this.getButtons();for(const n of t)n.disabled=this.disabled}gestureChanged(){this.gesture&&this.gesture.enable(!this.scrollable&&!this.disabled&&this.swipeGesture)}connectedCallback(){this.emitStyle()}componentWillLoad(){this.emitStyle()}async componentDidLoad(){this.setCheckedClasses(),this.gesture=(await gi(()=>Promise.resolve().then(()=>eK),void 0)).createGesture({el:this.el,gestureName:"segment",gesturePriority:100,threshold:0,passive:!1,onStart:t=>this.onStart(t),onMove:t=>this.onMove(t),onEnd:t=>this.onEnd(t)}),this.gestureChanged(),this.disabled&&this.disabledChanged()}onStart(t){this.valueBeforeGesture=this.value,this.activate(t)}onMove(t){this.setNextIndex(t)}onEnd(t){this.setActivated(!1),this.setNextIndex(t,!0),t.event.stopImmediatePropagation();const n=this.value;n!==void 0&&this.valueBeforeGesture!==n&&this.emitValueChange(),this.valueBeforeGesture=void 0}emitValueChange(){const{value:t}=this;this.ionChange.emit({value:t})}getButtons(){return Array.from(this.el.querySelectorAll("ion-segment-button"))}get checked(){return this.getButtons().find(t=>t.value===this.value)}setActivated(t){this.getButtons().forEach(r=>{t?r.classList.add("segment-button-activated"):r.classList.remove("segment-button-activated")}),this.activated=t}activate(t){const n=t.event.target,a=this.getButtons().find(i=>i.value===this.value);n.tagName==="ION-SEGMENT-BUTTON"&&(a||(this.value=n.value,this.setCheckedClasses()),this.value===n.value&&this.setActivated(!0))}getIndicator(t){return(t.shadowRoot||t).querySelector(".segment-button-indicator")}checkButton(t,n){const r=this.getIndicator(t),a=this.getIndicator(n);if(r===null||a===null)return;const i=r.getBoundingClientRect(),s=a.getBoundingClientRect(),o=i.width/s.width,l=i.left-s.left,c="translate3d(".concat(l,"px, 0, 0) scaleX(").concat(o,")");Ri(()=>{a.classList.remove("segment-button-indicator-animated"),a.style.setProperty("transform",c),a.getBoundingClientRect(),a.classList.add("segment-button-indicator-animated"),a.style.setProperty("transform","")}),this.value=n.value,this.setCheckedClasses()}setCheckedClasses(){const t=this.getButtons(),r=t.findIndex(a=>a.value===this.value)+1;for(const a of t)a.classList.remove("segment-button-after-checked");r<t.length&&t[r].classList.add("segment-button-after-checked")}setNextIndex(t,n=!1){const r=Lk(this.el),a=this.activated,i=this.getButtons(),s=i.findIndex(v=>v.value===this.value),o=i[s];let l,c;if(s===-1)return;const u=o.getBoundingClientRect(),d=u.left,p=u.width,h=t.currentX,f=u.top+u.height/2,g=this.el.getRootNode().elementFromPoint(h,f),y=r?h>d+p:h<d,b=r?h<d:h>d+p;if(a&&!n){if(y){const v=s-1;v>=0&&(c=v)}else if(b&&a&&!n){const v=s+1;v<i.length&&(c=v)}c!==void 0&&!i[c].disabled&&(l=i[c])}if(!a&&n&&(l=g),l!=null){if(l.tagName==="ION-SEGMENT")return!1;o!==l&&this.checkButton(o,l)}return!0}emitStyle(){this.ionStyle.emit({segment:!0})}onKeyDown(t){const n=Lk(this.el);let r=this.selectOnFocus,a;switch(t.key){case"ArrowRight":t.preventDefault(),a=n?this.getSegmentButton("previous"):this.getSegmentButton("next");break;case"ArrowLeft":t.preventDefault(),a=n?this.getSegmentButton("next"):this.getSegmentButton("previous");break;case"Home":t.preventDefault(),a=this.getSegmentButton("first");break;case"End":t.preventDefault(),a=this.getSegmentButton("last");break;case" ":case"Enter":t.preventDefault(),a=document.activeElement,r=!0}if(a){if(r){const i=this.checked;this.checkButton(i||a,a),a!==i&&this.emitValueChange()}a.setFocus()}}render(){const t=zt(this);return De(_r,{role:"tablist",onClick:this.onClick,class:Ym(this.color,{[t]:!0,"in-toolbar":$i("ion-toolbar",this.el),"in-toolbar-color":$i("ion-toolbar[color]",this.el),"segment-activated":this.activated,"segment-disabled":this.disabled,"segment-scrollable":this.scrollable})},De("slot",null))}get el(){return this}static get watchers(){return{color:["colorChanged"],swipeGesture:["swipeGestureChanged"],value:["valueChanged"],disabled:["disabledChanged"]}}static get style(){return{ios:G7,md:q7}}},[33,"ion-segment",{color:[513],disabled:[4],scrollable:[4],swipeGesture:[4,"swipe-gesture"],value:[1032],selectOnFocus:[4,"select-on-focus"],activated:[32]},[[0,"keydown","onKeyDown"]]]);function X7(){if(typeof customElements>"u")return;["ion-segment"].forEach(t=>{switch(t){case"ion-segment":customElements.get(t)||customElements.define(t,K7);break}})}const Y7=X7;/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const Z7=':host{--color:initial;--color-hover:var(--color);--color-checked:var(--color);--color-disabled:var(--color);--padding-start:0;--padding-end:0;--padding-top:0;--padding-bottom:0;border-radius:var(--border-radius);display:-ms-flexbox;display:flex;position:relative;-ms-flex-direction:column;flex-direction:column;height:auto;background:var(--background);color:var(--color);text-decoration:none;text-overflow:ellipsis;white-space:nowrap;cursor:pointer;grid-row:1;-webkit-font-kerning:none;font-kerning:none}.button-native{border-radius:0;font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;-webkit-margin-start:var(--margin-start);margin-inline-start:var(--margin-start);-webkit-margin-end:var(--margin-end);margin-inline-end:var(--margin-end);margin-top:var(--margin-top);margin-bottom:var(--margin-bottom);-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);-webkit-transform:translate3d(0,  0,  0);transform:translate3d(0,  0,  0);display:-ms-flexbox;display:flex;position:relative;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-positive:1;flex-grow:1;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;min-width:inherit;max-width:inherit;height:auto;min-height:inherit;max-height:inherit;-webkit-transition:var(--transition);transition:var(--transition);border:none;outline:none;background:transparent;contain:content;pointer-events:none;overflow:hidden;z-index:2}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:inherit;flex-flow:inherit;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%;z-index:1}:host(.segment-button-checked){background:var(--background-checked);color:var(--color-checked)}:host(.segment-button-disabled){cursor:default;pointer-events:none}:host(.ion-focused) .button-native{color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}:host(:focus){outline:none}@media (any-hover: hover){:host(:hover) .button-native{color:var(--color-hover)}:host(:hover) .button-native::after{background:var(--background-hover);opacity:var(--background-hover-opacity)}:host(.segment-button-checked:hover) .button-native{color:var(--color-checked)}}::slotted(ion-icon){-ms-flex-negative:0;flex-shrink:0;-ms-flex-order:-1;order:-1;pointer-events:none}::slotted(ion-label){display:block;-ms-flex-item-align:center;align-self:center;max-width:100%;line-height:22px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box;pointer-events:none}:host(.segment-button-layout-icon-top) .button-native{-ms-flex-direction:column;flex-direction:column}:host(.segment-button-layout-icon-start) .button-native{-ms-flex-direction:row;flex-direction:row}:host(.segment-button-layout-icon-end) .button-native{-ms-flex-direction:row-reverse;flex-direction:row-reverse}:host(.segment-button-layout-icon-bottom) .button-native{-ms-flex-direction:column-reverse;flex-direction:column-reverse}:host(.segment-button-layout-icon-hide) ::slotted(ion-icon){display:none}:host(.segment-button-layout-label-hide) ::slotted(ion-label){display:none}ion-ripple-effect{color:var(--ripple-color, var(--color-checked))}.segment-button-indicator{-webkit-transform-origin:left;transform-origin:left;position:absolute;opacity:0;-webkit-box-sizing:border-box;box-sizing:border-box;will-change:transform, opacity;pointer-events:none}.segment-button-indicator-background{width:100%;height:var(--indicator-height);-webkit-transform:var(--indicator-transform);transform:var(--indicator-transform);-webkit-box-shadow:var(--indicator-box-shadow);box-shadow:var(--indicator-box-shadow);pointer-events:none}.segment-button-indicator-animated{-webkit-transition:var(--indicator-transition);transition:var(--indicator-transition)}:host(.segment-button-checked) .segment-button-indicator{opacity:1}@media (prefers-reduced-motion: reduce){.segment-button-indicator-background{-webkit-transform:none;transform:none}.segment-button-indicator-animated{-webkit-transition:none;transition:none}}:host{--background:none;--background-checked:none;--background-hover:none;--background-hover-opacity:0;--background-focused:none;--background-focused-opacity:0;--border-radius:7px;--border-width:1px;--border-color:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.12);--border-style:solid;--indicator-box-shadow:0 0 5px rgba(0, 0, 0, 0.16);--indicator-color:var(--ion-color-step-350, var(--ion-background-color, #fff));--indicator-height:100%;--indicator-transition:transform 260ms cubic-bezier(0.4, 0, 0.2, 1);--indicator-transform:none;--transition:100ms all linear;--padding-top:0;--padding-end:13px;--padding-bottom:0;--padding-start:13px;margin-top:2px;margin-bottom:2px;position:relative;-ms-flex-direction:row;flex-direction:row;min-width:70px;min-height:28px;-webkit-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);font-size:13px;font-weight:450;line-height:37px}:host::before{margin-left:0;margin-right:0;margin-top:5px;margin-bottom:5px;-webkit-transition:160ms opacity ease-in-out;transition:160ms opacity ease-in-out;-webkit-transition-delay:100ms;transition-delay:100ms;border-left:var(--border-width) var(--border-style) var(--border-color);content:"";opacity:1;will-change:opacity}:host(:first-of-type)::before{border-left-color:transparent}:host(.segment-button-disabled){opacity:0.3}::slotted(ion-icon){font-size:24px}:host(.segment-button-layout-icon-start) ::slotted(ion-label){-webkit-margin-start:2px;margin-inline-start:2px;-webkit-margin-end:0;margin-inline-end:0}:host(.segment-button-layout-icon-end) ::slotted(ion-label){-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:2px;margin-inline-end:2px}.segment-button-indicator{-webkit-padding-start:2px;padding-inline-start:2px;-webkit-padding-end:2px;padding-inline-end:2px;left:0;right:0;top:0;bottom:0}.segment-button-indicator-background{border-radius:var(--border-radius);background:var(--indicator-color)}.segment-button-indicator-background{-webkit-transition:var(--indicator-transition);transition:var(--indicator-transition)}:host(.segment-button-checked)::before,:host(.segment-button-after-checked)::before{opacity:0}:host(.segment-button-checked){z-index:-1}:host(.segment-button-activated){--indicator-transform:scale(0.95)}:host(.ion-focused) .button-native{opacity:0.7}@media (any-hover: hover){:host(:hover) .button-native{opacity:0.5}:host(.segment-button-checked:hover) .button-native{opacity:1}}:host(.in-segment-color){background:none;color:var(--ion-text-color, #000)}:host(.in-segment-color) .segment-button-indicator-background{background:var(--ion-color-step-350, var(--ion-background-color, #fff))}@media (any-hover: hover){:host(.in-segment-color:hover) .button-native,:host(.in-segment-color.segment-button-checked:hover) .button-native{color:var(--ion-text-color, #000)}}:host(.in-toolbar:not(.in-segment-color)){--background-checked:var(--ion-toolbar-segment-background-checked, none);--color:var(--ion-toolbar-segment-color, var(--ion-toolbar-color), initial);--color-checked:var(--ion-toolbar-segment-color-checked, var(--ion-toolbar-color), initial);--indicator-color:var(--ion-toolbar-segment-indicator-color, var(--ion-color-step-350, var(--ion-background-color, #fff)))}:host(.in-toolbar-color) .segment-button-indicator-background{background:var(--ion-color-contrast)}:host(.in-toolbar-color:not(.in-segment-color)) .button-native{color:var(--ion-color-contrast)}:host(.in-toolbar-color.segment-button-checked:not(.in-segment-color)) .button-native{color:var(--ion-color-base)}@media (any-hover: hover){:host(.in-toolbar-color:not(.in-segment-color):hover) .button-native{color:var(--ion-color-contrast)}:host(.in-toolbar-color.segment-button-checked:not(.in-segment-color):hover) .button-native{color:var(--ion-color-base)}}',Q7=':host{--color:initial;--color-hover:var(--color);--color-checked:var(--color);--color-disabled:var(--color);--padding-start:0;--padding-end:0;--padding-top:0;--padding-bottom:0;border-radius:var(--border-radius);display:-ms-flexbox;display:flex;position:relative;-ms-flex-direction:column;flex-direction:column;height:auto;background:var(--background);color:var(--color);text-decoration:none;text-overflow:ellipsis;white-space:nowrap;cursor:pointer;grid-row:1;-webkit-font-kerning:none;font-kerning:none}.button-native{border-radius:0;font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;-webkit-margin-start:var(--margin-start);margin-inline-start:var(--margin-start);-webkit-margin-end:var(--margin-end);margin-inline-end:var(--margin-end);margin-top:var(--margin-top);margin-bottom:var(--margin-bottom);-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);-webkit-transform:translate3d(0,  0,  0);transform:translate3d(0,  0,  0);display:-ms-flexbox;display:flex;position:relative;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-positive:1;flex-grow:1;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;min-width:inherit;max-width:inherit;height:auto;min-height:inherit;max-height:inherit;-webkit-transition:var(--transition);transition:var(--transition);border:none;outline:none;background:transparent;contain:content;pointer-events:none;overflow:hidden;z-index:2}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:inherit;flex-flow:inherit;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%;z-index:1}:host(.segment-button-checked){background:var(--background-checked);color:var(--color-checked)}:host(.segment-button-disabled){cursor:default;pointer-events:none}:host(.ion-focused) .button-native{color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}:host(:focus){outline:none}@media (any-hover: hover){:host(:hover) .button-native{color:var(--color-hover)}:host(:hover) .button-native::after{background:var(--background-hover);opacity:var(--background-hover-opacity)}:host(.segment-button-checked:hover) .button-native{color:var(--color-checked)}}::slotted(ion-icon){-ms-flex-negative:0;flex-shrink:0;-ms-flex-order:-1;order:-1;pointer-events:none}::slotted(ion-label){display:block;-ms-flex-item-align:center;align-self:center;max-width:100%;line-height:22px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box;pointer-events:none}:host(.segment-button-layout-icon-top) .button-native{-ms-flex-direction:column;flex-direction:column}:host(.segment-button-layout-icon-start) .button-native{-ms-flex-direction:row;flex-direction:row}:host(.segment-button-layout-icon-end) .button-native{-ms-flex-direction:row-reverse;flex-direction:row-reverse}:host(.segment-button-layout-icon-bottom) .button-native{-ms-flex-direction:column-reverse;flex-direction:column-reverse}:host(.segment-button-layout-icon-hide) ::slotted(ion-icon){display:none}:host(.segment-button-layout-label-hide) ::slotted(ion-label){display:none}ion-ripple-effect{color:var(--ripple-color, var(--color-checked))}.segment-button-indicator{-webkit-transform-origin:left;transform-origin:left;position:absolute;opacity:0;-webkit-box-sizing:border-box;box-sizing:border-box;will-change:transform, opacity;pointer-events:none}.segment-button-indicator-background{width:100%;height:var(--indicator-height);-webkit-transform:var(--indicator-transform);transform:var(--indicator-transform);-webkit-box-shadow:var(--indicator-box-shadow);box-shadow:var(--indicator-box-shadow);pointer-events:none}.segment-button-indicator-animated{-webkit-transition:var(--indicator-transition);transition:var(--indicator-transition)}:host(.segment-button-checked) .segment-button-indicator{opacity:1}@media (prefers-reduced-motion: reduce){.segment-button-indicator-background{-webkit-transform:none;transform:none}.segment-button-indicator-animated{-webkit-transition:none;transition:none}}:host{--background:none;--background-checked:none;--background-hover:var(--color-checked);--background-focused:var(--color-checked);--background-activated-opacity:0;--background-focused-opacity:.12;--background-hover-opacity:.04;--color:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.6);--color-checked:var(--ion-color-primary, #3880ff);--indicator-box-shadow:none;--indicator-color:var(--color-checked);--indicator-height:2px;--indicator-transition:transform 250ms cubic-bezier(0.4, 0, 0.2, 1);--indicator-transform:none;--padding-top:0;--padding-end:16px;--padding-bottom:0;--padding-start:16px;--transition:color 0.15s linear 0s, opacity 0.15s linear 0s;min-width:90px;min-height:48px;border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);font-size:14px;font-weight:500;letter-spacing:0.06em;line-height:40px;text-transform:uppercase}:host(.segment-button-disabled){opacity:0.3}:host(.in-segment-color){background:none;color:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.6)}:host(.in-segment-color) ion-ripple-effect{color:var(--ion-color-base)}:host(.in-segment-color) .segment-button-indicator-background{background:var(--ion-color-base)}:host(.in-segment-color.segment-button-checked) .button-native{color:var(--ion-color-base)}:host(.in-segment-color.ion-focused) .button-native::after{background:var(--ion-color-base)}@media (any-hover: hover){:host(.in-segment-color:hover) .button-native{color:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.6)}:host(.in-segment-color:hover) .button-native::after{background:var(--ion-color-base)}:host(.in-segment-color.segment-button-checked:hover) .button-native{color:var(--ion-color-base)}}:host(.in-toolbar:not(.in-segment-color)){--background:var(--ion-toolbar-segment-background, none);--background-checked:var(--ion-toolbar-segment-background-checked, none);--color:var(--ion-toolbar-segment-color, rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.6));--color-checked:var(--ion-toolbar-segment-color-checked, var(--ion-color-primary, #3880ff));--indicator-color:var(--ion-toolbar-segment-color-checked, var(--color-checked))}:host(.in-toolbar-color:not(.in-segment-color)) .button-native{color:rgba(var(--ion-color-contrast-rgb), 0.6)}:host(.in-toolbar-color.segment-button-checked:not(.in-segment-color)) .button-native{color:var(--ion-color-contrast)}@media (any-hover: hover){:host(.in-toolbar-color:not(.in-segment-color)) .button-native::after{background:var(--ion-color-contrast)}}::slotted(ion-icon){margin-top:12px;margin-bottom:12px;font-size:24px}::slotted(ion-label){margin-top:12px;margin-bottom:12px}:host(.segment-button-layout-icon-top) ::slotted(ion-label),:host(.segment-button-layout-icon-bottom) ::slotted(ion-icon){margin-top:0}:host(.segment-button-layout-icon-top) ::slotted(ion-icon),:host(.segment-button-layout-icon-bottom) ::slotted(ion-label){margin-bottom:0}:host(.segment-button-layout-icon-start) ::slotted(ion-label){-webkit-margin-start:8px;margin-inline-start:8px;-webkit-margin-end:0;margin-inline-end:0}:host(.segment-button-layout-icon-end) ::slotted(ion-label){-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:8px;margin-inline-end:8px}:host(.segment-button-has-icon-only) ::slotted(ion-icon){margin-top:12px;margin-bottom:12px}:host(.segment-button-has-label-only) ::slotted(ion-label){margin-top:12px;margin-bottom:12px}.segment-button-indicator{left:0;right:0;bottom:0}.segment-button-indicator-background{background:var(--indicator-color)}:host(.in-toolbar:not(.in-segment-color)) .segment-button-indicator-background{background:var(--ion-toolbar-segment-indicator-color, var(--indicator-color))}:host(.in-toolbar-color:not(.in-segment-color)) .segment-button-indicator-background{background:var(--ion-color-contrast)}';let J7=0;const eX=ur(class extends cr{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.segmentEl=null,this.inheritedAttributes={},this.updateStyle=()=>{rv(this)},this.updateState=()=>{const{segmentEl:t}=this;t&&(this.checked=t.value===this.value,t.disabled&&(this.disabled=!0))},this.checked=!1,this.disabled=!1,this.layout="icon-top",this.type="button",this.value="ion-sb-"+J7++}valueChanged(){this.updateState()}connectedCallback(){const t=this.segmentEl=this.el.closest("ion-segment");t&&(this.updateState(),Ak(t,"ionSelect",this.updateState),Ak(t,"ionStyle",this.updateStyle))}disconnectedCallback(){const t=this.segmentEl;t&&(Rk(t,"ionSelect",this.updateState),Rk(t,"ionStyle",this.updateStyle),this.segmentEl=null)}componentWillLoad(){this.inheritedAttributes=Object.assign({},P0(this.el,["aria-label"]))}get hasLabel(){return!!this.el.querySelector("ion-label")}get hasIcon(){return!!this.el.querySelector("ion-icon")}async setFocus(){const{nativeEl:t}=this;t!==void 0&&t.focus()}render(){const{checked:t,type:n,disabled:r,hasIcon:a,hasLabel:i,layout:s,segmentEl:o}=this,l=zt(this),c=()=>(o==null?void 0:o.color)!==void 0;return De(_r,{class:{[l]:!0,"in-toolbar":$i("ion-toolbar",this.el),"in-toolbar-color":$i("ion-toolbar[color]",this.el),"in-segment":$i("ion-segment",this.el),"in-segment-color":c(),"segment-button-has-label":i,"segment-button-has-icon":a,"segment-button-has-label-only":i&&!a,"segment-button-has-icon-only":a&&!i,"segment-button-disabled":r,"segment-button-checked":t,["segment-button-layout-".concat(s)]:!0,"ion-activatable":!0,"ion-activatable-instant":!0,"ion-focusable":!0}},De("button",Object.assign({"aria-selected":t?"true":"false",role:"tab",ref:u=>this.nativeEl=u,type:n,class:"button-native",part:"native",disabled:r},this.inheritedAttributes),De("span",{class:"button-inner"},De("slot",null)),l==="md"&&De("ion-ripple-effect",null)),De("div",{part:"indicator",class:{"segment-button-indicator":!0,"segment-button-indicator-animated":!0}},De("div",{part:"indicator-background",class:"segment-button-indicator-background"})))}get el(){return this}static get watchers(){return{value:["valueChanged"]}}static get style(){return{ios:Z7,md:Q7}}},[33,"ion-segment-button",{disabled:[1028],layout:[1],type:[1],value:[8],checked:[32],setFocus:[64]}]);function tX(){if(typeof customElements>"u")return;["ion-segment-button","ion-ripple-effect"].forEach(t=>{switch(t){case"ion-segment-button":customElements.get(t)||customElements.define(t,eX);break;case"ion-ripple-effect":customElements.get(t)||tL();break}})}const nX=tX;/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const rX=h7;/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const lv="ionKeyboardDidShow",uL="ionKeyboardDidHide",aX=150;let uv={},Cs={},_p=!1;const iX=()=>{uv={},Cs={},_p=!1},sX=e=>{if(iL.getEngine())oX(e);else{if(!e.visualViewport)return;Cs=w$(e.visualViewport),e.visualViewport.onresize=()=>{pL(e),cL()||dL(e)?b$(e):x$(e)&&v$(e)}}},oX=e=>{e.addEventListener("keyboardDidShow",t=>b$(e,t)),e.addEventListener("keyboardDidHide",()=>v$(e))},b$=(e,t)=>{lX(e,t),_p=!0},v$=e=>{uX(e),_p=!1},cL=()=>{const e=(uv.height-Cs.height)*Cs.scale;return!_p&&uv.width===Cs.width&&e>aX},dL=e=>_p&&!x$(e),x$=e=>_p&&Cs.height===e.innerHeight,lX=(e,t)=>{const n=t?t.keyboardHeight:e.innerHeight-Cs.height,r=new CustomEvent(lv,{detail:{keyboardHeight:n}});e.dispatchEvent(r)},uX=e=>{const t=new CustomEvent(uL);e.dispatchEvent(t)},pL=e=>{uv=Object.assign({},Cs),Cs=w$(e.visualViewport)},w$=e=>({width:Math.round(e.width),height:Math.round(e.height),offsetTop:e.offsetTop,offsetLeft:e.offsetLeft,pageTop:e.pageTop,pageLeft:e.pageLeft,scale:e.scale}),cX=Object.freeze(Object.defineProperty({__proto__:null,KEYBOARD_DID_CLOSE:uL,KEYBOARD_DID_OPEN:lv,copyVisualViewport:w$,keyboardDidClose:x$,keyboardDidOpen:cL,keyboardDidResize:dL,resetKeyboardAssist:iX,setKeyboardClose:v$,setKeyboardOpen:b$,startKeyboardAssist:sX,trackViewportChanges:pL},Symbol.toStringTag,{value:"Module"}));/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */var tp;(function(e){e.Dark="DARK",e.Light="LIGHT",e.Default="DEFAULT"})(tp||(tp={}));const vm={getEngine(){var e;return((e=ct==null?void 0:ct.Capacitor)===null||e===void 0?void 0:e.isPluginAvailable("StatusBar"))&&(ct==null?void 0:ct.Capacitor.Plugins.StatusBar)},supportsDefaultStatusBarStyle(){var e;return!!(!((e=ct==null?void 0:ct.Capacitor)===null||e===void 0)&&e.PluginHeaders)},setStyle(e){const t=this.getEngine();t&&t.setStyle(e)},getStyle:async function(){const e=this.getEngine();if(!e)return tp.Default;const{style:t}=await e.getInfo();return t}},Uk=(e,t)=>{if(t===1)return 0;const n=1/(1-t),r=-(t*n);return e*n+r},hL=()=>{!ct||ct.innerWidth>=768||!vm.supportsDefaultStatusBarStyle()||vm.setStyle({style:tp.Dark})},fL=(e=tp.Default)=>{!ct||ct.innerWidth>=768||!vm.supportsDefaultStatusBarStyle()||vm.setStyle({style:e})},mL=async(e,t)=>{typeof e.canDismiss!="function"||!await e.canDismiss(void 0,Hf)||(t.isRunning()?t.onFinish(()=>{e.dismiss(void 0,"handler")},{oneTimeCallback:!0}):e.dismiss(void 0,"handler"))},Vk=e=>.00255275*2.71828**(-14.9619*e)-1.00255*2.71828**(-.0380968*e)+1,cv={MIN_PRESENTING_SCALE:.93},dX=(e,t,n,r)=>{const i=e.offsetHeight;let s=!1,o=!1,l=null,c=null;const u=.2;let d=!0,p=0;const h=()=>l&&Kl(l)?l.scrollY:!0,b=f$({el:e,gestureName:"modalSwipeToClose",gesturePriority:39,direction:"y",threshold:10,canStart:v=>{const x=v.event.target;return x===null||!x.closest?!0:(l=v7(x),l?(Kl(l)?c=No(l).querySelector(".inner-scroll"):c=l,!!!l.querySelector("ion-refresher")&&c.scrollTop===0):x.closest("ion-footer")===null)},onStart:v=>{const{deltaY:x}=v;d=h(),o=e.canDismiss!==void 0&&e.canDismiss!==!0,x>0&&l&&pA(l),t.progressStart(!0,s?1:0)},onMove:v=>{const{deltaY:x}=v;x>0&&l&&pA(l);const w=v.deltaY/i,$=w>=0&&o,C=$?u:.9999,E=$?Vk(w/C):w,_=Jd(1e-4,E,C);t.progressStep(_),_>=.5&&p<.5?fL(n):_<.5&&p>=.5&&hL(),p=_},onEnd:v=>{const x=v.velocityY,w=v.deltaY/i,$=w>=0&&o,C=$?u:.9999,E=$?Vk(w/C):w,_=Jd(1e-4,E,C),R=(v.deltaY+x*1e3)/i,N=!$&&R>=.5;let I=N?-.001:.001;N?(t.easing("cubic-bezier(0.32, 0.72, 0, 1)"),I+=ep([0,0],[.32,.72],[0,1],[1,1],_)[0]):(t.easing("cubic-bezier(1, 0, 0.68, 0.28)"),I+=ep([0,0],[1,0],[.68,.28],[1,1],_)[0]);const O=vA(N?w*i:(1-_)*i,x);s=N,b.enable(!1),l&&x7(l,d),t.onFinish(()=>{N||b.enable(!0)}).progressEnd(N?1:0,I,O),$&&_>C/4?mL(e,t):N&&r()}});return b},vA=(e,t)=>Jd(400,e/Math.abs(t*1.1),500),gL=e=>{const{currentBreakpoint:t,backdropBreakpoint:n}=e,r=n===void 0||n<t,a=r?"calc(var(--backdrop-opacity) * ".concat(t,")"):"0",i=pn("backdropAnimation").fromTo("opacity",0,a);return r&&i.beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]),{wrapperAnimation:pn("wrapperAnimation").keyframes([{offset:0,opacity:1,transform:"translateY(100%)"},{offset:1,opacity:1,transform:"translateY(".concat(100-t*100,"%)")}]),backdropAnimation:i}},yL=e=>{const{currentBreakpoint:t,backdropBreakpoint:n}=e,r="calc(var(--backdrop-opacity) * ".concat(Uk(t,n),")"),a=[{offset:0,opacity:r},{offset:1,opacity:0}],i=[{offset:0,opacity:r},{offset:n,opacity:0},{offset:1,opacity:0}],s=pn("backdropAnimation").keyframes(n!==0?i:a);return{wrapperAnimation:pn("wrapperAnimation").keyframes([{offset:0,opacity:1,transform:"translateY(".concat(100-t*100,"%)")},{offset:1,opacity:1,transform:"translateY(100%)"}]),backdropAnimation:s}},pX=()=>{const e=pn().fromTo("opacity",.01,"var(--backdrop-opacity)").beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]),t=pn().fromTo("transform","translateY(100vh)","translateY(0vh)");return{backdropAnimation:e,wrapperAnimation:t}},xA=(e,t)=>{const{presentingEl:n,currentBreakpoint:r}=t,a=No(e),{wrapperAnimation:i,backdropAnimation:s}=r!==void 0?gL(t):pX();s.addElement(a.querySelector("ion-backdrop")),i.addElement(a.querySelectorAll(".modal-wrapper, .modal-shadow")).beforeStyles({opacity:1});const o=pn("entering-base").addElement(e).easing("cubic-bezier(0.32,0.72,0,1)").duration(500).addAnimation(i);if(n){const l=window.innerWidth<768,c=n.tagName==="ION-MODAL"&&n.presentingElement!==void 0,u=No(n),d=pn().beforeStyles({transform:"translateY(0)","transform-origin":"top center",overflow:"hidden"}),p=document.body;if(l){const h=CSS.supports("width","max(0px, 1px)")?"max(30px, var(--ion-safe-area-top))":"30px",f=c?"-10px":h,m=cv.MIN_PRESENTING_SCALE,g="translateY(".concat(f,") scale(").concat(m,")");d.afterStyles({transform:g}).beforeAddWrite(()=>p.style.setProperty("background-color","black")).addElement(n).keyframes([{offset:0,filter:"contrast(1)",transform:"translateY(0px) scale(1)",borderRadius:"0px"},{offset:1,filter:"contrast(0.85)",transform:g,borderRadius:"10px 10px 0 0"}]),o.addAnimation(d)}else if(o.addAnimation(s),!c)i.fromTo("opacity","0","1");else{const h=c?cv.MIN_PRESENTING_SCALE:1,f="translateY(-10px) scale(".concat(h,")");d.afterStyles({transform:f}).addElement(u.querySelector(".modal-wrapper")).keyframes([{offset:0,filter:"contrast(1)",transform:"translateY(0) scale(1)"},{offset:1,filter:"contrast(0.85)",transform:f}]);const m=pn().afterStyles({transform:f}).addElement(u.querySelector(".modal-shadow")).keyframes([{offset:0,opacity:"1",transform:"translateY(0) scale(1)"},{offset:1,opacity:"0",transform:f}]);o.addAnimation([d,m])}}else o.addAnimation(s);return o},hX=()=>{const e=pn().fromTo("opacity","var(--backdrop-opacity)",0),t=pn().fromTo("transform","translateY(0vh)","translateY(100vh)");return{backdropAnimation:e,wrapperAnimation:t}},wA=(e,t,n=500)=>{const{presentingEl:r,currentBreakpoint:a}=t,i=No(e),{wrapperAnimation:s,backdropAnimation:o}=a!==void 0?yL(t):hX();o.addElement(i.querySelector("ion-backdrop")),s.addElement(i.querySelectorAll(".modal-wrapper, .modal-shadow")).beforeStyles({opacity:1});const l=pn("leaving-base").addElement(e).easing("cubic-bezier(0.32,0.72,0,1)").duration(n).addAnimation(s);if(r){const c=window.innerWidth<768,u=r.tagName==="ION-MODAL"&&r.presentingElement!==void 0,d=No(r),p=pn().beforeClearStyles(["transform"]).afterClearStyles(["transform"]).onFinish(f=>{if(f!==1)return;r.style.setProperty("overflow",""),Array.from(h.querySelectorAll("ion-modal")).filter(g=>g.presentingElement!==void 0).length<=1&&h.style.setProperty("background-color","")}),h=document.body;if(c){const f=CSS.supports("width","max(0px, 1px)")?"max(30px, var(--ion-safe-area-top))":"30px",m=u?"-10px":f,g=cv.MIN_PRESENTING_SCALE,y="translateY(".concat(m,") scale(").concat(g,")");p.addElement(r).keyframes([{offset:0,filter:"contrast(0.85)",transform:y,borderRadius:"10px 10px 0 0"},{offset:1,filter:"contrast(1)",transform:"translateY(0px) scale(1)",borderRadius:"0px"}]),l.addAnimation(p)}else if(l.addAnimation(o),!u)s.fromTo("opacity","1","0");else{const f=u?cv.MIN_PRESENTING_SCALE:1,m="translateY(-10px) scale(".concat(f,")");p.addElement(d.querySelector(".modal-wrapper")).afterStyles({transform:"translate3d(0, 0, 0)"}).keyframes([{offset:0,filter:"contrast(0.85)",transform:m},{offset:1,filter:"contrast(1)",transform:"translateY(0) scale(1)"}]);const g=pn().addElement(d.querySelector(".modal-shadow")).afterStyles({transform:"translateY(0) scale(1)"}).keyframes([{offset:0,opacity:"0",transform:m},{offset:1,opacity:"1",transform:"translateY(0) scale(1)"}]);l.addAnimation([p,g])}}else l.addAnimation(o);return l},fX=()=>{const e=pn().fromTo("opacity",.01,"var(--backdrop-opacity)").beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]),t=pn().keyframes([{offset:0,opacity:.01,transform:"translateY(40px)"},{offset:1,opacity:1,transform:"translateY(0px)"}]);return{backdropAnimation:e,wrapperAnimation:t}},mX=(e,t)=>{const{currentBreakpoint:n}=t,r=No(e),{wrapperAnimation:a,backdropAnimation:i}=n!==void 0?gL(t):fX();return i.addElement(r.querySelector("ion-backdrop")),a.addElement(r.querySelector(".modal-wrapper")),pn().addElement(e).easing("cubic-bezier(0.36,0.66,0.04,1)").duration(280).addAnimation([i,a])},gX=()=>{const e=pn().fromTo("opacity","var(--backdrop-opacity)",0),t=pn().keyframes([{offset:0,opacity:.99,transform:"translateY(0px)"},{offset:1,opacity:0,transform:"translateY(40px)"}]);return{backdropAnimation:e,wrapperAnimation:t}},yX=(e,t)=>{const{currentBreakpoint:n}=t,r=No(e),{wrapperAnimation:a,backdropAnimation:i}=n!==void 0?yL(t):gX();return i.addElement(r.querySelector("ion-backdrop")),a.addElement(r.querySelector(".modal-wrapper")),pn().easing("cubic-bezier(0.47,0,0.745,0.715)").duration(200).addAnimation([i,a])},bX=(e,t,n,r,a,i,s=[],o,l,c)=>{const u=[{offset:0,opacity:"var(--backdrop-opacity)"},{offset:1,opacity:.01}],d=[{offset:0,opacity:"var(--backdrop-opacity)"},{offset:1-a,opacity:0},{offset:1,opacity:0}],p={WRAPPER_KEYFRAMES:[{offset:0,transform:"translateY(0%)"},{offset:1,transform:"translateY(100%)"}],BACKDROP_KEYFRAMES:a!==0?d:u},h=e.querySelector("ion-content"),f=n.clientHeight;let m=r,g=0,y=!1;const b=.95,v=i.childAnimations.find(L=>L.id==="wrapperAnimation"),x=i.childAnimations.find(L=>L.id==="backdropAnimation"),w=s[s.length-1],$=s[0],C=()=>{e.style.setProperty("pointer-events","auto"),t.style.setProperty("pointer-events","auto"),e.classList.remove("ion-disable-focus-trap")},E=()=>{e.style.setProperty("pointer-events","none"),t.style.setProperty("pointer-events","none"),e.classList.add("ion-disable-focus-trap")};v&&x&&(v.keyframes([...p.WRAPPER_KEYFRAMES]),x.keyframes([...p.BACKDROP_KEYFRAMES]),i.progressStart(!0,1-m),m>a?C():E()),h&&m!==w&&(h.scrollY=!1);const _=L=>{const U=L.event.target.closest("ion-content");return m=o(),!(m===1&&U)},R=()=>{y=e.canDismiss!==void 0&&e.canDismiss!==!0&&$===0,h&&(h.scrollY=!1),Pr(()=>{e.focus()}),i.progressStart(!0,1-m)},N=L=>{const U=1-m,D=s.length>1?1-s[1]:void 0,F=U+L.deltaY/f,z=D!==void 0&&F>=D&&y,B=z?b:.9999,j=z&&D!==void 0?D+Vk((F-D)/(B-D)):F;g=Jd(1e-4,j,B),i.progressStep(g)},I=L=>{const U=L.velocityY,D=(L.deltaY+U*350)/f,F=m-D,z=s.reduce((B,j)=>Math.abs(j-F)<Math.abs(B-F)?j:B);O({breakpoint:z,breakpointOffset:g,canDismiss:y})},O=L=>{const{breakpoint:U,canDismiss:D,breakpointOffset:F}=L,z=D&&U===0,B=z?m:U,j=B!==0;return m=0,v&&x&&(v.keyframes([{offset:0,transform:"translateY(".concat(F*100,"%)")},{offset:1,transform:"translateY(".concat((1-B)*100,"%)")}]),x.keyframes([{offset:0,opacity:"calc(var(--backdrop-opacity) * ".concat(Uk(1-F,a),")")},{offset:1,opacity:"calc(var(--backdrop-opacity) * ".concat(Uk(B,a),")")}]),i.progressStep(0)),P.enable(!1),z?mL(e,i):j||l(),new Promise(Y=>{i.onFinish(()=>{j?v&&x?Pr(()=>{v.keyframes([...p.WRAPPER_KEYFRAMES]),x.keyframes([...p.BACKDROP_KEYFRAMES]),i.progressStart(!0,1-B),m=B,c(m),h&&m===s[s.length-1]&&(h.scrollY=!0),m>a?C():E(),P.enable(!0),Y()}):(P.enable(!0),Y()):Y()},{oneTimeCallback:!0}).progressEnd(1,0,500)})},P=f$({el:n,gestureName:"modalSheet",gesturePriority:40,direction:"y",threshold:10,canStart:_,onStart:R,onMove:N,onEnd:I});return{gesture:P,moveSheetToBreakpoint:O}},vX=':host{--width:100%;--min-width:auto;--max-width:auto;--height:100%;--min-height:auto;--max-height:auto;--overflow:hidden;--border-radius:0;--border-width:0;--border-style:none;--border-color:transparent;--background:var(--ion-background-color, #fff);--box-shadow:none;--backdrop-opacity:0;left:0;right:0;top:0;bottom:0;display:-ms-flexbox;display:flex;position:absolute;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;outline:none;color:var(--ion-text-color, #000);contain:strict}.modal-wrapper,ion-backdrop{pointer-events:auto}:host(.overlay-hidden){display:none}.modal-wrapper,.modal-shadow{border-radius:var(--border-radius);width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);background:var(--background);-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);overflow:var(--overflow);z-index:10}.modal-shadow{position:absolute;background:transparent}@media only screen and (min-width: 768px) and (min-height: 600px){:host{--width:600px;--height:500px;--ion-safe-area-top:0px;--ion-safe-area-bottom:0px;--ion-safe-area-right:0px;--ion-safe-area-left:0px}}@media only screen and (min-width: 768px) and (min-height: 768px){:host{--width:600px;--height:600px}}.modal-handle{left:0px;right:0px;top:5px;border-radius:8px;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;position:absolute;width:36px;height:5px;-webkit-transform:translateZ(0);transform:translateZ(0);border:0;background:var(--ion-color-step-350, #c0c0be);cursor:pointer;z-index:11}.modal-handle::before{-webkit-padding-start:4px;padding-inline-start:4px;-webkit-padding-end:4px;padding-inline-end:4px;padding-top:4px;padding-bottom:4px;position:absolute;width:36px;height:5px;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);content:""}:host(.modal-sheet){--height:calc(100% - (var(--ion-safe-area-top) + 10px))}:host(.modal-sheet) .modal-wrapper,:host(.modal-sheet) .modal-shadow{position:absolute;bottom:0}:host{--backdrop-opacity:var(--ion-backdrop-opacity, 0.4)}:host(.modal-card),:host(.modal-sheet){--border-radius:10px}@media only screen and (min-width: 768px) and (min-height: 600px){:host{--border-radius:10px}}.modal-wrapper{-webkit-transform:translate3d(0,  100%,  0);transform:translate3d(0,  100%,  0)}@media screen and (max-width: 767px){@supports (width: max(0px, 1px)){:host(.modal-card){--height:calc(100% - max(30px, var(--ion-safe-area-top)) - 10px)}}@supports not (width: max(0px, 1px)){:host(.modal-card){--height:calc(100% - 40px)}}:host(.modal-card) .modal-wrapper{border-top-left-radius:var(--border-radius);border-top-right-radius:var(--border-radius);border-bottom-right-radius:0;border-bottom-left-radius:0}:host-context([dir=rtl]):host(.modal-card) .modal-wrapper,:host-context([dir=rtl]).modal-card .modal-wrapper{border-top-left-radius:var(--border-radius);border-top-right-radius:var(--border-radius);border-bottom-right-radius:0;border-bottom-left-radius:0}@supports selector(:dir(rtl)){:host(.modal-card) .modal-wrapper:dir(rtl){border-top-left-radius:var(--border-radius);border-top-right-radius:var(--border-radius);border-bottom-right-radius:0;border-bottom-left-radius:0}}:host(.modal-card){--backdrop-opacity:0;--width:100%;-ms-flex-align:end;align-items:flex-end}:host(.modal-card) .modal-shadow{display:none}:host(.modal-card) ion-backdrop{pointer-events:none}}@media screen and (min-width: 768px){:host(.modal-card){--width:calc(100% - 120px);--height:calc(100% - (120px + var(--ion-safe-area-top) + var(--ion-safe-area-bottom)));--max-width:720px;--max-height:1000px;--backdrop-opacity:0;--box-shadow:0px 0px 30px 10px rgba(0, 0, 0, 0.1);-webkit-transition:all 0.5s ease-in-out;transition:all 0.5s ease-in-out}:host(.modal-card) .modal-wrapper{-webkit-box-shadow:none;box-shadow:none}:host(.modal-card) .modal-shadow{-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow)}}:host(.modal-sheet) .modal-wrapper{border-top-left-radius:var(--border-radius);border-top-right-radius:var(--border-radius);border-bottom-right-radius:0;border-bottom-left-radius:0}:host-context([dir=rtl]):host(.modal-sheet) .modal-wrapper,:host-context([dir=rtl]).modal-sheet .modal-wrapper{border-top-left-radius:var(--border-radius);border-top-right-radius:var(--border-radius);border-bottom-right-radius:0;border-bottom-left-radius:0}@supports selector(:dir(rtl)){:host(.modal-sheet) .modal-wrapper:dir(rtl){border-top-left-radius:var(--border-radius);border-top-right-radius:var(--border-radius);border-bottom-right-radius:0;border-bottom-left-radius:0}}',xX=':host{--width:100%;--min-width:auto;--max-width:auto;--height:100%;--min-height:auto;--max-height:auto;--overflow:hidden;--border-radius:0;--border-width:0;--border-style:none;--border-color:transparent;--background:var(--ion-background-color, #fff);--box-shadow:none;--backdrop-opacity:0;left:0;right:0;top:0;bottom:0;display:-ms-flexbox;display:flex;position:absolute;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;outline:none;color:var(--ion-text-color, #000);contain:strict}.modal-wrapper,ion-backdrop{pointer-events:auto}:host(.overlay-hidden){display:none}.modal-wrapper,.modal-shadow{border-radius:var(--border-radius);width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);background:var(--background);-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);overflow:var(--overflow);z-index:10}.modal-shadow{position:absolute;background:transparent}@media only screen and (min-width: 768px) and (min-height: 600px){:host{--width:600px;--height:500px;--ion-safe-area-top:0px;--ion-safe-area-bottom:0px;--ion-safe-area-right:0px;--ion-safe-area-left:0px}}@media only screen and (min-width: 768px) and (min-height: 768px){:host{--width:600px;--height:600px}}.modal-handle{left:0px;right:0px;top:5px;border-radius:8px;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;position:absolute;width:36px;height:5px;-webkit-transform:translateZ(0);transform:translateZ(0);border:0;background:var(--ion-color-step-350, #c0c0be);cursor:pointer;z-index:11}.modal-handle::before{-webkit-padding-start:4px;padding-inline-start:4px;-webkit-padding-end:4px;padding-inline-end:4px;padding-top:4px;padding-bottom:4px;position:absolute;width:36px;height:5px;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);content:""}:host(.modal-sheet){--height:calc(100% - (var(--ion-safe-area-top) + 10px))}:host(.modal-sheet) .modal-wrapper,:host(.modal-sheet) .modal-shadow{position:absolute;bottom:0}:host{--backdrop-opacity:var(--ion-backdrop-opacity, 0.32)}@media only screen and (min-width: 768px) and (min-height: 600px){:host{--border-radius:2px;--box-shadow:0 28px 48px rgba(0, 0, 0, 0.4)}}.modal-wrapper{-webkit-transform:translate3d(0,  40px,  0);transform:translate3d(0,  40px,  0);opacity:0.01}',wX=ur(class extends cr{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.didPresent=bt(this,"ionModalDidPresent",7),this.willPresent=bt(this,"ionModalWillPresent",7),this.willDismiss=bt(this,"ionModalWillDismiss",7),this.didDismiss=bt(this,"ionModalDidDismiss",7),this.ionBreakpointDidChange=bt(this,"ionBreakpointDidChange",7),this.didPresentShorthand=bt(this,"didPresent",7),this.willPresentShorthand=bt(this,"willPresent",7),this.willDismissShorthand=bt(this,"willDismiss",7),this.didDismissShorthand=bt(this,"didDismiss",7),this.ionMount=bt(this,"ionMount",7),this.triggerController=LK(),this.coreDelegate=SK(),this.isSheetModal=!1,this.inheritedAttributes={},this.inline=!1,this.gestureAnimationDismissing=!1,this.onHandleClick=()=>{const{sheetTransition:t,handleBehavior:n}=this;n!=="cycle"||t!==void 0||this.moveToNextBreakpoint()},this.onBackdropTap=()=>{const{sheetTransition:t}=this;t===void 0&&this.dismiss(void 0,Ok)},this.onLifecycle=t=>{const n=this.usersElement,r=kX[t.type];if(n&&r){const a=new CustomEvent(r,{bubbles:!1,cancelable:!1,detail:t.detail});n.dispatchEvent(a)}},this.presented=!1,this.hasController=!1,this.overlayIndex=void 0,this.delegate=void 0,this.keyboardClose=!0,this.enterAnimation=void 0,this.leaveAnimation=void 0,this.breakpoints=void 0,this.initialBreakpoint=void 0,this.backdropBreakpoint=0,this.handle=void 0,this.handleBehavior="none",this.component=void 0,this.componentProps=void 0,this.cssClass=void 0,this.backdropDismiss=!0,this.showBackdrop=!0,this.animated=!0,this.presentingElement=void 0,this.htmlAttributes=void 0,this.isOpen=!1,this.trigger=void 0,this.keepContentsMounted=!1,this.canDismiss=!0}onIsOpenChange(t,n){t===!0&&n===!1?this.present():t===!1&&n===!0&&this.dismiss()}triggerChanged(){const{trigger:t,el:n,triggerController:r}=this;t&&r.addClickListener(n,t)}breakpointsChanged(t){t!==void 0&&(this.sortedBreakpoints=t.sort((n,r)=>n-r))}connectedCallback(){const{el:t}=this;CK(t),this.triggerChanged()}disconnectedCallback(){this.triggerController.removeClickListener()}componentWillLoad(){const{breakpoints:t,initialBreakpoint:n,el:r}=this,a=this.isSheetModal=t!==void 0&&n!==void 0;this.inheritedAttributes=P0(r,["aria-label","role"]),a&&(this.currentBreakpoint=this.initialBreakpoint),t!==void 0&&n!==void 0&&!t.includes(n)&&Pd("Your breakpoints array must include the initialBreakpoint value."),EK(r)}componentDidLoad(){this.isOpen===!0&&Pr(()=>this.present()),this.breakpointsChanged(this.breakpoints)}getDelegate(t=!1){if(this.workingDelegate&&!t)return{delegate:this.workingDelegate,inline:this.inline};const n=this.el.parentNode,r=this.inline=n!==null&&!this.hasController,a=this.workingDelegate=r?this.delegate||this.coreDelegate:this.delegate;return{inline:r,delegate:a}}async checkCanDismiss(t,n){const{canDismiss:r}=this;return typeof r=="function"?r(t,n):r}async present(){if(this.presented)return;const{presentingElement:t,el:n}=this;this.currentTransition!==void 0&&await this.currentTransition,this.currentBreakpoint=this.initialBreakpoint;const{inline:r,delegate:a}=this.getDelegate(!0);this.usersElement=await g$(a,n,this.component,["ion-page"],this.componentProps,r),this.ionMount.emit(),FO(n)?await iv(this.usersElement):this.keepContentsMounted||await Wq(),Ri(()=>this.el.classList.add("show-modal")),this.currentTransition=RK(this,"modalEnter",xA,mX,{presentingEl:t,currentBreakpoint:this.initialBreakpoint,backdropBreakpoint:this.backdropBreakpoint}),typeof window<"u"&&(this.keyboardOpenCallback=()=>{this.gesture&&(this.gesture.enable(!1),Pr(()=>{this.gesture&&this.gesture.enable(!0)}))},window.addEventListener(lv,this.keyboardOpenCallback));const i=t!==void 0;i&&zt(this)==="ios"&&(this.statusBarStyle=await vm.getStyle(),hL()),await this.currentTransition,this.isSheetModal?this.initSheetGesture():i&&this.initSwipeToClose(),this.currentTransition=void 0}initSwipeToClose(){var t;if(zt(this)!=="ios")return;const{el:n}=this,r=this.leaveAnimation||Ft.get("modalLeave",wA),a=this.animation=r(n,{presentingEl:this.presentingElement});if(!Pk(n)){zk(n);return}const s=(t=this.statusBarStyle)!==null&&t!==void 0?t:tp.Default;this.gesture=dX(n,a,s,()=>{this.gestureAnimationDismissing=!0,this.animation.onFinish(async()=>{await this.dismiss(void 0,Hf),this.gestureAnimationDismissing=!1})}),this.gesture.enable(!0)}initSheetGesture(){const{wrapperEl:t,initialBreakpoint:n,backdropBreakpoint:r}=this;if(!t||n===void 0)return;const a=this.enterAnimation||Ft.get("modalEnter",xA),i=this.animation=a(this.el,{presentingEl:this.presentingElement,currentBreakpoint:n,backdropBreakpoint:r});i.progressStart(!0,1);const{gesture:s,moveSheetToBreakpoint:o}=bX(this.el,this.backdropEl,t,n,r,i,this.sortedBreakpoints,()=>{var l;return(l=this.currentBreakpoint)!==null&&l!==void 0?l:0},()=>this.sheetOnDismiss(),l=>{this.currentBreakpoint!==l&&(this.currentBreakpoint=l,this.ionBreakpointDidChange.emit({breakpoint:l}))});this.gesture=s,this.moveSheetToBreakpoint=o,this.gesture.enable(!0)}sheetOnDismiss(){this.gestureAnimationDismissing=!0,this.animation.onFinish(async()=>{this.currentBreakpoint=0,this.ionBreakpointDidChange.emit({breakpoint:this.currentBreakpoint}),await this.dismiss(void 0,Hf),this.gestureAnimationDismissing=!1})}async dismiss(t,n){var r;if(this.gestureAnimationDismissing&&n!==Hf||n!=="handler"&&!await this.checkCanDismiss(t,n))return!1;const{presentingElement:a}=this;a!==void 0&&zt(this)==="ios"&&fL(this.statusBarStyle),typeof window<"u"&&this.keyboardOpenCallback&&(window.removeEventListener(lv,this.keyboardOpenCallback),this.keyboardOpenCallback=void 0),this.currentTransition!==void 0&&await this.currentTransition;const s=sv.get(this)||[];this.currentTransition=FK(this,t,n,"modalLeave",wA,yX,{presentingEl:a,currentBreakpoint:(r=this.currentBreakpoint)!==null&&r!==void 0?r:this.initialBreakpoint,backdropBreakpoint:this.backdropBreakpoint});const o=await this.currentTransition;if(o){const{delegate:l}=this.getDelegate();await QO(l,this.usersElement),Ri(()=>this.el.classList.remove("show-modal")),this.animation&&this.animation.destroy(),this.gesture&&this.gesture.destroy(),s.forEach(c=>c.destroy())}return this.currentBreakpoint=void 0,this.currentTransition=void 0,this.animation=void 0,o}onDidDismiss(){return uA(this.el,"ionModalDidDismiss")}onWillDismiss(){return uA(this.el,"ionModalWillDismiss")}async setCurrentBreakpoint(t){if(!this.isSheetModal){Pd("setCurrentBreakpoint is only supported on sheet modals.");return}if(!this.breakpoints.includes(t)){Pd("Attempted to set invalid breakpoint value ".concat(t,". Please double check that the breakpoint value is part of your defined breakpoints."));return}const{currentBreakpoint:n,moveSheetToBreakpoint:r,canDismiss:a,breakpoints:i}=this;n!==t&&r&&(this.sheetTransition=r({breakpoint:t,breakpointOffset:1-n,canDismiss:a!==void 0&&a!==!0&&i[0]===0}),await this.sheetTransition,this.sheetTransition=void 0)}async getCurrentBreakpoint(){return this.currentBreakpoint}async moveToNextBreakpoint(){const{breakpoints:t,currentBreakpoint:n}=this;if(!t||n==null)return!1;const r=t.filter(o=>o!==0),i=(r.indexOf(n)+1)%r.length,s=r[i];return await this.setCurrentBreakpoint(s),!0}render(){const{handle:t,isSheetModal:n,presentingElement:r,htmlAttributes:a,handleBehavior:i,inheritedAttributes:s}=this,o=t!==!1&&n,l=zt(this),c=r!==void 0&&l==="ios",u=i==="cycle";return De(_r,Object.assign({"no-router":!0,tabindex:"-1"},a,{style:{zIndex:"".concat(2e4+this.overlayIndex)},class:Object.assign({[l]:!0,"modal-default":!c&&!n,"modal-card":c,"modal-sheet":n,"overlay-hidden":!0},VK(this.cssClass)),onIonBackdropTap:this.onBackdropTap,onIonModalDidPresent:this.onLifecycle,onIonModalWillPresent:this.onLifecycle,onIonModalWillDismiss:this.onLifecycle,onIonModalDidDismiss:this.onLifecycle}),De("ion-backdrop",{ref:d=>this.backdropEl=d,visible:this.showBackdrop,tappable:this.backdropDismiss,part:"backdrop"}),l==="ios"&&De("div",{class:"modal-shadow"}),De("div",Object.assign({role:"dialog"},s,{"aria-modal":"true",class:"modal-wrapper ion-overlay-wrapper",part:"content",ref:d=>this.wrapperEl=d}),o&&De("button",{class:"modal-handle",tabIndex:u?0:-1,"aria-label":"Activate to adjust the size of the dialog overlaying the screen",onClick:u?this.onHandleClick:void 0,part:"handle"}),De("slot",null)))}get el(){return this}static get watchers(){return{isOpen:["onIsOpenChange"],trigger:["triggerChanged"]}}static get style(){return{ios:vX,md:xX}}},[33,"ion-modal",{hasController:[4,"has-controller"],overlayIndex:[2,"overlay-index"],delegate:[16],keyboardClose:[4,"keyboard-close"],enterAnimation:[16],leaveAnimation:[16],breakpoints:[16],initialBreakpoint:[2,"initial-breakpoint"],backdropBreakpoint:[2,"backdrop-breakpoint"],handle:[4],handleBehavior:[1,"handle-behavior"],component:[1],componentProps:[16],cssClass:[1,"css-class"],backdropDismiss:[4,"backdrop-dismiss"],showBackdrop:[4,"show-backdrop"],animated:[4],presentingElement:[16],htmlAttributes:[16],isOpen:[4,"is-open"],trigger:[1],keepContentsMounted:[4,"keep-contents-mounted"],canDismiss:[4,"can-dismiss"],presented:[32],present:[64],dismiss:[64],onDidDismiss:[64],onWillDismiss:[64],setCurrentBreakpoint:[64],getCurrentBreakpoint:[64]}]),kX={ionModalDidPresent:"ionViewDidEnter",ionModalWillPresent:"ionViewWillEnter",ionModalWillDismiss:"ionViewWillLeave",ionModalDidDismiss:"ionViewDidLeave"};function SX(){if(typeof customElements>"u")return;["ion-modal","ion-backdrop"].forEach(t=>{switch(t){case"ion-modal":customElements.get(t)||customElements.define(t,wX);break;case"ion-backdrop":customElements.get(t)||WK();break}})}const IX=SX,$X="html.plt-mobile ion-app{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}html.plt-mobile ion-app [contenteditable]{-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}ion-app.force-statusbar-padding{--ion-safe-area-top:20px}",CX=ur(class extends cr{constructor(){super(),this.__registerHost()}componentDidLoad(){TX(async()=>{const t=oo(window,"hybrid");if(Ft.getBoolean("_testing")||gi(()=>import("./index9-8162bab8.js"),[]).then(r=>r.startTapClick(Ft)),Ft.getBoolean("statusTap",t)&&gi(()=>import("./status-tap-51ba6bd7.js"),[]).then(r=>r.startStatusTap()),Ft.getBoolean("inputShims",EX())){const r=oo(window,"ios")?"ios":"android";gi(()=>import("./input-shims-4a5f29ea.js"),[]).then(a=>a.startInputShims(Ft,r))}const n=await gi(()=>Promise.resolve().then(()=>kK),void 0);Ft.getBoolean("hardwareBackButton",t)?n.startHardwareBackButton():n.blockHardwareBackButton(),typeof window<"u"&&gi(()=>Promise.resolve().then(()=>cX),void 0).then(r=>r.startKeyboardAssist(window)),gi(()=>import("./focus-visible-9c13edeb.js"),[]).then(r=>this.focusVisible=r.startFocusVisible())})}async setFocus(t){this.focusVisible&&this.focusVisible.setFocus(t)}render(){const t=zt(this);return De(_r,{class:{[t]:!0,"ion-page":!0,"force-statusbar-padding":Ft.getBoolean("_forceStatusbarPadding")}})}get el(){return this}static get style(){return $X}},[0,"ion-app",{setFocus:[64]}]),EX=()=>!!(oo(window,"ios")&&oo(window,"mobile")||oo(window,"android")&&oo(window,"mobileweb")),TX=e=>{"requestIdleCallback"in window?window.requestIdleCallback(e):setTimeout(e,32)};function NX(){if(typeof customElements>"u")return;["ion-app"].forEach(t=>{switch(t){case"ion-app":customElements.get(t)||customElements.define(t,CX);break}})}const _X=NX,AX=":host{left:0;right:0;top:0;bottom:0;position:absolute;contain:layout size style;overflow:hidden;z-index:0}",RX=ur(class extends cr{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.ionNavWillLoad=bt(this,"ionNavWillLoad",7),this.ionNavWillChange=bt(this,"ionNavWillChange",3),this.ionNavDidChange=bt(this,"ionNavDidChange",3),this.gestureOrAnimationInProgress=!1,this.mode=zt(this),this.delegate=void 0,this.animated=!0,this.animation=void 0,this.swipeHandler=void 0}swipeHandlerChanged(){this.gesture&&this.gesture.enable(this.swipeHandler!==void 0)}async connectedCallback(){const t=()=>{this.gestureOrAnimationInProgress=!0,this.swipeHandler&&this.swipeHandler.onStart()};this.gesture=(await gi(()=>import("./swipe-back-66ffc96b.js"),[])).createSwipeBackGesture(this.el,()=>!this.gestureOrAnimationInProgress&&!!this.swipeHandler&&this.swipeHandler.canStart(),()=>t(),n=>{var r;return(r=this.ani)===null||r===void 0?void 0:r.progressStep(n)},(n,r,a)=>{if(this.ani){this.ani.onFinish(()=>{this.gestureOrAnimationInProgress=!1,this.swipeHandler&&this.swipeHandler.onEnd(n)},{oneTimeCallback:!0});let i=n?-.001:.001;n?i+=ep([0,0],[.32,.72],[0,1],[1,1],r)[0]:(this.ani.easing("cubic-bezier(1, 0, 0.68, 0.28)"),i+=ep([0,0],[1,0],[.68,.28],[1,1],r)[0]),this.ani.progressEnd(n?1:0,i,a)}else this.gestureOrAnimationInProgress=!1}),this.swipeHandlerChanged()}componentWillLoad(){this.ionNavWillLoad.emit()}disconnectedCallback(){this.gesture&&(this.gesture.destroy(),this.gesture=void 0)}async commit(t,n,r){const a=await this.lock();let i=!1;try{i=await this.transition(t,n,r)}catch(s){console.error(s)}return a(),i}async setRouteId(t,n,r,a){return{changed:await this.setRoot(t,n,{duration:r==="root"?0:void 0,direction:r==="back"?"back":"forward",animationBuilder:a}),element:this.activeEl}}async getRouteId(){const t=this.activeEl;return t?{id:t.tagName,element:t,params:this.activeParams}:void 0}async setRoot(t,n,r){if(this.activeComponent===t&&OO(n,this.activeParams))return!1;const a=this.activeEl,i=await g$(this.delegate,this.el,t,["ion-page","ion-page-invisible"],n);return this.activeComponent=t,this.activeEl=i,this.activeParams=n,await this.commit(i,a,r),await QO(this.delegate,a),!0}async transition(t,n,r={}){if(n===t)return!1;this.ionNavWillChange.emit();const{el:a,mode:i}=this,s=this.animated&&Ft.getBoolean("animated",!0),o=r.animationBuilder||this.animation||Ft.get("navAnimation");return await zO(Object.assign(Object.assign({mode:i,animated:s,enteringEl:t,leavingEl:n,baseEl:a,deepWait:FO(a),progressCallback:r.progressAnimation?l=>{l!==void 0&&!this.gestureOrAnimationInProgress?(this.gestureOrAnimationInProgress=!0,l.onFinish(()=>{this.gestureOrAnimationInProgress=!1,this.swipeHandler&&this.swipeHandler.onEnd(!1)},{oneTimeCallback:!0}),l.progressEnd(0,0,0)):this.ani=l}:void 0},r),{animationBuilder:o})),this.ionNavDidChange.emit(),!0}async lock(){const t=this.waitPromise;let n;return this.waitPromise=new Promise(r=>n=r),t!==void 0&&await t,n}render(){return De("slot",null)}get el(){return this}static get watchers(){return{swipeHandler:["swipeHandlerChanged"]}}static get style(){return AX}},[1,"ion-router-outlet",{mode:[1025],delegate:[16],animated:[4],animation:[16],swipeHandler:[16],commit:[64],setRouteId:[64],getRouteId:[64]}]);function DX(){if(typeof customElements>"u")return;["ion-router-outlet"].forEach(t=>{switch(t){case"ion-router-outlet":customElements.get(t)||customElements.define(t,RX);break}})}const FX=DX;/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const MX=":host{-webkit-padding-start:var(--ion-safe-area-left);padding-inline-start:var(--ion-safe-area-left);-webkit-padding-end:var(--ion-safe-area-right);padding-inline-end:var(--ion-safe-area-right);display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:auto;padding-bottom:var(--ion-safe-area-bottom, 0);border-top:var(--border);background:var(--background);color:var(--color);text-align:center;contain:strict;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:10;-webkit-box-sizing:content-box !important;box-sizing:content-box !important}:host(.ion-color) ::slotted(ion-tab-button){--background-focused:var(--ion-color-shade);--color-selected:var(--ion-color-contrast)}:host(.ion-color) ::slotted(.tab-selected){color:var(--ion-color-contrast)}:host(.ion-color),:host(.ion-color) ::slotted(ion-tab-button){color:rgba(var(--ion-color-contrast-rgb), 0.7)}:host(.ion-color),:host(.ion-color) ::slotted(ion-tab-button){background:var(--ion-color-base)}:host(.ion-color) ::slotted(ion-tab-button.ion-focused),:host(.tab-bar-translucent) ::slotted(ion-tab-button.ion-focused){background:var(--background-focused)}:host(.tab-bar-translucent) ::slotted(ion-tab-button){background:transparent}:host([slot=top]){padding-top:var(--ion-safe-area-top, 0);padding-bottom:0;border-top:0;border-bottom:var(--border)}:host(.tab-bar-hidden){display:none !important}:host{--background:var(--ion-tab-bar-background, var(--ion-color-step-50, #f7f7f7));--background-focused:var(--ion-tab-bar-background-focused, #e0e0e0);--border:0.55px solid var(--ion-tab-bar-border-color, var(--ion-border-color, var(--ion-color-step-150, rgba(0, 0, 0, 0.2))));--color:var(--ion-tab-bar-color, var(--ion-color-step-600, #666666));--color-selected:var(--ion-tab-bar-color-selected, var(--ion-color-primary, #3880ff));height:50px}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){:host(.tab-bar-translucent){--background:rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.8);-webkit-backdrop-filter:saturate(210%) blur(20px);backdrop-filter:saturate(210%) blur(20px)}:host(.ion-color.tab-bar-translucent){background:rgba(var(--ion-color-base-rgb), 0.8)}:host(.tab-bar-translucent) ::slotted(ion-tab-button.ion-focused){background:rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.6)}}",OX=":host{-webkit-padding-start:var(--ion-safe-area-left);padding-inline-start:var(--ion-safe-area-left);-webkit-padding-end:var(--ion-safe-area-right);padding-inline-end:var(--ion-safe-area-right);display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:auto;padding-bottom:var(--ion-safe-area-bottom, 0);border-top:var(--border);background:var(--background);color:var(--color);text-align:center;contain:strict;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:10;-webkit-box-sizing:content-box !important;box-sizing:content-box !important}:host(.ion-color) ::slotted(ion-tab-button){--background-focused:var(--ion-color-shade);--color-selected:var(--ion-color-contrast)}:host(.ion-color) ::slotted(.tab-selected){color:var(--ion-color-contrast)}:host(.ion-color),:host(.ion-color) ::slotted(ion-tab-button){color:rgba(var(--ion-color-contrast-rgb), 0.7)}:host(.ion-color),:host(.ion-color) ::slotted(ion-tab-button){background:var(--ion-color-base)}:host(.ion-color) ::slotted(ion-tab-button.ion-focused),:host(.tab-bar-translucent) ::slotted(ion-tab-button.ion-focused){background:var(--background-focused)}:host(.tab-bar-translucent) ::slotted(ion-tab-button){background:transparent}:host([slot=top]){padding-top:var(--ion-safe-area-top, 0);padding-bottom:0;border-top:0;border-bottom:var(--border)}:host(.tab-bar-hidden){display:none !important}:host{--background:var(--ion-tab-bar-background, var(--ion-background-color, #fff));--background-focused:var(--ion-tab-bar-background-focused, #e0e0e0);--border:1px solid var(--ion-tab-bar-border-color, var(--ion-border-color, var(--ion-color-step-150, rgba(0, 0, 0, 0.07))));--color:var(--ion-tab-bar-color, var(--ion-color-step-650, #595959));--color-selected:var(--ion-tab-bar-color-selected, var(--ion-color-primary, #3880ff));height:56px}",LX=ur(class extends cr{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.ionTabBarChanged=bt(this,"ionTabBarChanged",7),this.keyboardCtrl=null,this.keyboardVisible=!1,this.color=void 0,this.selectedTab=void 0,this.translucent=!1}selectedTabChanged(){this.selectedTab!==void 0&&this.ionTabBarChanged.emit({tab:this.selectedTab})}componentWillLoad(){this.selectedTabChanged()}async connectedCallback(){this.keyboardCtrl=await w7(async(t,n)=>{t===!1&&n!==void 0&&await n,this.keyboardVisible=t})}disconnectedCallback(){this.keyboardCtrl&&this.keyboardCtrl.destroy()}render(){const{color:t,translucent:n,keyboardVisible:r}=this,a=zt(this),i=r&&this.el.getAttribute("slot")!=="top";return De(_r,{role:"tablist","aria-hidden":i?"true":null,class:Ym(t,{[a]:!0,"tab-bar-translucent":n,"tab-bar-hidden":i})},De("slot",null))}get el(){return this}static get watchers(){return{selectedTab:["selectedTabChanged"]}}static get style(){return{ios:MX,md:OX}}},[33,"ion-tab-bar",{color:[513],selectedTab:[1,"selected-tab"],translucent:[4],keyboardVisible:[32]}]);function PX(){if(typeof customElements>"u")return;["ion-tab-bar"].forEach(t=>{switch(t){case"ion-tab-bar":customElements.get(t)||customElements.define(t,LX);break}})}const zX=PX;/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const BX=':host{--ripple-color:var(--color-selected);--background-focused-opacity:1;-ms-flex:1;flex:1;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%;outline:none;background:var(--background);color:var(--color)}.button-native{border-radius:inherit;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:-ms-flexbox;display:flex;position:relative;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:100%;height:100%;border:0;outline:none;background:transparent;text-decoration:none;cursor:pointer;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-user-drag:none}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:inherit;flex-flow:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:100%;height:100%;z-index:1}:host(.ion-focused) .button-native{color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}@media (any-hover: hover){a:hover{color:var(--color-selected)}}:host(.tab-selected){color:var(--color-selected)}:host(.tab-hidden){display:none !important}:host(.tab-disabled){pointer-events:none;opacity:0.4}::slotted(ion-label),::slotted(ion-icon){display:block;-ms-flex-item-align:center;align-self:center;max-width:100%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box}::slotted(ion-label){-ms-flex-order:0;order:0}::slotted(ion-icon){-ms-flex-order:-1;order:-1;height:1em}:host(.tab-has-label-only) ::slotted(ion-label){white-space:normal}::slotted(ion-badge){-webkit-box-sizing:border-box;box-sizing:border-box;position:absolute;z-index:1}:host(.tab-layout-icon-start){-ms-flex-direction:row;flex-direction:row}:host(.tab-layout-icon-end){-ms-flex-direction:row-reverse;flex-direction:row-reverse}:host(.tab-layout-icon-bottom){-ms-flex-direction:column-reverse;flex-direction:column-reverse}:host(.tab-layout-icon-hide) ::slotted(ion-icon){display:none}:host(.tab-layout-label-hide) ::slotted(ion-label){display:none}ion-ripple-effect{color:var(--ripple-color)}:host{--padding-top:0;--padding-end:2px;--padding-bottom:0;--padding-start:2px;max-width:240px;font-size:10px}::slotted(ion-badge){-webkit-padding-start:6px;padding-inline-start:6px;-webkit-padding-end:6px;padding-inline-end:6px;padding-top:1px;padding-bottom:1px;top:4px;height:auto;font-size:12px;line-height:16px}@supports (inset-inline-start: 0){::slotted(ion-badge){inset-inline-start:calc(50% + 6px)}}@supports not (inset-inline-start: 0){::slotted(ion-badge){left:calc(50% + 6px)}:host-context([dir=rtl]) ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 6px)}[dir=rtl] ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 6px)}@supports selector(:dir(rtl)){::slotted(ion-badge):dir(rtl){left:unset;right:unset;right:calc(50% + 6px)}}}::slotted(ion-icon){margin-top:2px;margin-bottom:2px;font-size:30px}::slotted(ion-icon::before){vertical-align:top}::slotted(ion-label){margin-top:0;margin-bottom:1px;min-height:11px;font-weight:500}:host(.tab-has-label-only) ::slotted(ion-label){margin-left:0;margin-right:0;margin-top:2px;margin-bottom:2px;font-size:12px;font-size:14px;line-height:1.1}:host(.tab-layout-icon-end) ::slotted(ion-label),:host(.tab-layout-icon-start) ::slotted(ion-label),:host(.tab-layout-icon-hide) ::slotted(ion-label){margin-top:2px;margin-bottom:2px;font-size:14px;line-height:1.1}:host(.tab-layout-icon-end) ::slotted(ion-icon),:host(.tab-layout-icon-start) ::slotted(ion-icon){min-width:24px;height:26px;margin-top:2px;margin-bottom:1px;font-size:24px}@supports (inset-inline-start: 0){:host(.tab-layout-icon-bottom) ::slotted(ion-badge){inset-inline-start:calc(50% + 12px)}}@supports not (inset-inline-start: 0){:host(.tab-layout-icon-bottom) ::slotted(ion-badge){left:calc(50% + 12px)}:host-context([dir=rtl]):host(.tab-layout-icon-bottom) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-bottom ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 12px)}@supports selector(:dir(rtl)){:host(.tab-layout-icon-bottom) ::slotted(ion-badge):dir(rtl){left:unset;right:unset;right:calc(50% + 12px)}}}:host(.tab-layout-icon-bottom) ::slotted(ion-icon){margin-top:0;margin-bottom:1px}:host(.tab-layout-icon-bottom) ::slotted(ion-label){margin-top:4px}:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){top:10px}@supports (inset-inline-start: 0){:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){inset-inline-start:calc(50% + 35px)}}@supports not (inset-inline-start: 0){:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){left:calc(50% + 35px)}:host-context([dir=rtl]):host(.tab-layout-icon-start) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-start ::slotted(ion-badge),:host-context([dir=rtl]):host(.tab-layout-icon-end) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-end ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 35px)}@supports selector(:dir(rtl)){:host(.tab-layout-icon-start) ::slotted(ion-badge):dir(rtl),:host(.tab-layout-icon-end) ::slotted(ion-badge):dir(rtl){left:unset;right:unset;right:calc(50% + 35px)}}}:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){top:10px}@supports (inset-inline-start: 0){:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){inset-inline-start:calc(50% + 30px)}}@supports not (inset-inline-start: 0){:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){left:calc(50% + 30px)}:host-context([dir=rtl]):host(.tab-layout-icon-hide) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-hide ::slotted(ion-badge),:host-context([dir=rtl]):host(.tab-has-label-only) ::slotted(ion-badge),:host-context([dir=rtl]).tab-has-label-only ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 30px)}@supports selector(:dir(rtl)){:host(.tab-layout-icon-hide) ::slotted(ion-badge):dir(rtl),:host(.tab-has-label-only) ::slotted(ion-badge):dir(rtl){left:unset;right:unset;right:calc(50% + 30px)}}}:host(.tab-layout-label-hide) ::slotted(ion-badge),:host(.tab-has-icon-only) ::slotted(ion-badge){top:10px}:host(.tab-layout-label-hide) ::slotted(ion-icon){margin-left:0;margin-right:0;margin-top:0;margin-bottom:0}',WX=':host{--ripple-color:var(--color-selected);--background-focused-opacity:1;-ms-flex:1;flex:1;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%;outline:none;background:var(--background);color:var(--color)}.button-native{border-radius:inherit;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:-ms-flexbox;display:flex;position:relative;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:100%;height:100%;border:0;outline:none;background:transparent;text-decoration:none;cursor:pointer;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-user-drag:none}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:inherit;flex-flow:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:100%;height:100%;z-index:1}:host(.ion-focused) .button-native{color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}@media (any-hover: hover){a:hover{color:var(--color-selected)}}:host(.tab-selected){color:var(--color-selected)}:host(.tab-hidden){display:none !important}:host(.tab-disabled){pointer-events:none;opacity:0.4}::slotted(ion-label),::slotted(ion-icon){display:block;-ms-flex-item-align:center;align-self:center;max-width:100%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box}::slotted(ion-label){-ms-flex-order:0;order:0}::slotted(ion-icon){-ms-flex-order:-1;order:-1;height:1em}:host(.tab-has-label-only) ::slotted(ion-label){white-space:normal}::slotted(ion-badge){-webkit-box-sizing:border-box;box-sizing:border-box;position:absolute;z-index:1}:host(.tab-layout-icon-start){-ms-flex-direction:row;flex-direction:row}:host(.tab-layout-icon-end){-ms-flex-direction:row-reverse;flex-direction:row-reverse}:host(.tab-layout-icon-bottom){-ms-flex-direction:column-reverse;flex-direction:column-reverse}:host(.tab-layout-icon-hide) ::slotted(ion-icon){display:none}:host(.tab-layout-label-hide) ::slotted(ion-label){display:none}ion-ripple-effect{color:var(--ripple-color)}:host{--padding-top:0;--padding-end:12px;--padding-bottom:0;--padding-start:12px;max-width:168px;font-size:12px;font-weight:normal;letter-spacing:0.03em}::slotted(ion-label){margin-left:0;margin-right:0;margin-top:2px;margin-bottom:2px;text-transform:none}::slotted(ion-icon){margin-left:0;margin-right:0;margin-top:16px;margin-bottom:16px;-webkit-transform-origin:center center;transform-origin:center center;font-size:22px}:host-context([dir=rtl]) ::slotted(ion-icon){-webkit-transform-origin:calc(100% - center) center;transform-origin:calc(100% - center) center}[dir=rtl] ::slotted(ion-icon){-webkit-transform-origin:calc(100% - center) center;transform-origin:calc(100% - center) center}@supports selector(:dir(rtl)){::slotted(ion-icon):dir(rtl){-webkit-transform-origin:calc(100% - center) center;transform-origin:calc(100% - center) center}}::slotted(ion-badge){border-radius:8px;-webkit-padding-start:2px;padding-inline-start:2px;-webkit-padding-end:2px;padding-inline-end:2px;padding-top:3px;padding-bottom:2px;top:8px;min-width:12px;font-size:8px;font-weight:normal}@supports (inset-inline-start: 0){::slotted(ion-badge){inset-inline-start:calc(50% + 6px)}}@supports not (inset-inline-start: 0){::slotted(ion-badge){left:calc(50% + 6px)}:host-context([dir=rtl]) ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 6px)}[dir=rtl] ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 6px)}@supports selector(:dir(rtl)){::slotted(ion-badge):dir(rtl){left:unset;right:unset;right:calc(50% + 6px)}}}::slotted(ion-badge:empty){display:block;min-width:8px;height:8px}:host(.tab-layout-icon-top) ::slotted(ion-icon){margin-top:6px;margin-bottom:2px}:host(.tab-layout-icon-top) ::slotted(ion-label){margin-top:0;margin-bottom:6px}:host(.tab-layout-icon-bottom) ::slotted(ion-badge){top:8px}@supports (inset-inline-start: 0){:host(.tab-layout-icon-bottom) ::slotted(ion-badge){inset-inline-start:70%}}@supports not (inset-inline-start: 0){:host(.tab-layout-icon-bottom) ::slotted(ion-badge){left:70%}:host-context([dir=rtl]):host(.tab-layout-icon-bottom) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-bottom ::slotted(ion-badge){left:unset;right:unset;right:70%}@supports selector(:dir(rtl)){:host(.tab-layout-icon-bottom) ::slotted(ion-badge):dir(rtl){left:unset;right:unset;right:70%}}}:host(.tab-layout-icon-bottom) ::slotted(ion-icon){margin-top:0;margin-bottom:6px}:host(.tab-layout-icon-bottom) ::slotted(ion-label){margin-top:6px;margin-bottom:0}:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){top:16px}@supports (inset-inline-start: 0){:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){inset-inline-start:80%}}@supports not (inset-inline-start: 0){:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){left:80%}:host-context([dir=rtl]):host(.tab-layout-icon-start) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-start ::slotted(ion-badge),:host-context([dir=rtl]):host(.tab-layout-icon-end) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-end ::slotted(ion-badge){left:unset;right:unset;right:80%}@supports selector(:dir(rtl)){:host(.tab-layout-icon-start) ::slotted(ion-badge):dir(rtl),:host(.tab-layout-icon-end) ::slotted(ion-badge):dir(rtl){left:unset;right:unset;right:80%}}}:host(.tab-layout-icon-start) ::slotted(ion-icon){-webkit-margin-end:6px;margin-inline-end:6px}:host(.tab-layout-icon-end) ::slotted(ion-icon){-webkit-margin-start:6px;margin-inline-start:6px}:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){top:16px}@supports (inset-inline-start: 0){:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){inset-inline-start:70%}}@supports not (inset-inline-start: 0){:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){left:70%}:host-context([dir=rtl]):host(.tab-layout-icon-hide) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-hide ::slotted(ion-badge),:host-context([dir=rtl]):host(.tab-has-label-only) ::slotted(ion-badge),:host-context([dir=rtl]).tab-has-label-only ::slotted(ion-badge){left:unset;right:unset;right:70%}@supports selector(:dir(rtl)){:host(.tab-layout-icon-hide) ::slotted(ion-badge):dir(rtl),:host(.tab-has-label-only) ::slotted(ion-badge):dir(rtl){left:unset;right:unset;right:70%}}}:host(.tab-layout-icon-hide) ::slotted(ion-label),:host(.tab-has-label-only) ::slotted(ion-label){margin-top:0;margin-bottom:0}:host(.tab-layout-label-hide) ::slotted(ion-badge),:host(.tab-has-icon-only) ::slotted(ion-badge){top:16px}:host(.tab-layout-label-hide) ::slotted(ion-icon),:host(.tab-has-icon-only) ::slotted(ion-icon){margin-top:0;margin-bottom:0;font-size:24px}',UX=ur(class extends cr{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.ionTabButtonClick=bt(this,"ionTabButtonClick",7),this.inheritedAttributes={},this.onKeyUp=t=>{(t.key==="Enter"||t.key===" ")&&this.selectTab(t)},this.onClick=t=>{this.selectTab(t)},this.disabled=!1,this.download=void 0,this.href=void 0,this.rel=void 0,this.layout=void 0,this.selected=!1,this.tab=void 0,this.target=void 0}onTabBarChanged(t){const n=t.target,r=this.el.parentElement;(t.composedPath().includes(r)||n!=null&&n.contains(this.el))&&(this.selected=this.tab===t.detail.tab)}componentWillLoad(){this.inheritedAttributes=Object.assign({},P0(this.el,["aria-label"])),this.layout===void 0&&(this.layout=Ft.get("tabButtonLayout","icon-top"))}selectTab(t){this.tab!==void 0&&(this.disabled||this.ionTabButtonClick.emit({tab:this.tab,href:this.href,selected:this.selected}),t.preventDefault())}get hasLabel(){return!!this.el.querySelector("ion-label")}get hasIcon(){return!!this.el.querySelector("ion-icon")}render(){const{disabled:t,hasIcon:n,hasLabel:r,href:a,rel:i,target:s,layout:o,selected:l,tab:c,inheritedAttributes:u}=this,d=zt(this),p={download:this.download,href:a,rel:i,target:s};return De(_r,{onClick:this.onClick,onKeyup:this.onKeyUp,id:c!==void 0?"tab-button-".concat(c):null,class:{[d]:!0,"tab-selected":l,"tab-disabled":t,"tab-has-label":r,"tab-has-icon":n,"tab-has-label-only":r&&!n,"tab-has-icon-only":n&&!r,["tab-layout-".concat(o)]:!0,"ion-activatable":!0,"ion-selectable":!0,"ion-focusable":!0}},De("a",Object.assign({},p,{class:"button-native",part:"native",role:"tab","aria-selected":l?"true":null,"aria-disabled":t?"true":null,tabindex:t?"-1":void 0},u),De("span",{class:"button-inner"},De("slot",null)),d==="md"&&De("ion-ripple-effect",{type:"unbounded"})))}get el(){return this}static get style(){return{ios:BX,md:WX}}},[33,"ion-tab-button",{disabled:[4],download:[1],href:[1],rel:[1],layout:[1025],selected:[1028],tab:[1],target:[1]},[[8,"ionTabBarChanged","onTabBarChanged"]]]);function VX(){if(typeof customElements>"u")return;["ion-tab-button","ion-ripple-effect"].forEach(t=>{switch(t){case"ion-tab-button":customElements.get(t)||customElements.define(t,UX);break;case"ion-ripple-effect":customElements.get(t)||tL();break}})}const HX=VX,hd={allRenderFn:!1,cmpDidLoad:!0,cmpDidUnload:!1,cmpDidUpdate:!0,cmpDidRender:!0,cmpWillLoad:!0,cmpWillUpdate:!0,cmpWillRender:!0,connectedCallback:!0,disconnectedCallback:!0,element:!0,event:!0,hasRenderFn:!0,lifecycle:!0,hostListener:!0,hostListenerTargetWindow:!0,hostListenerTargetDocument:!0,hostListenerTargetBody:!0,hostListenerTargetParent:!1,hostListenerTarget:!0,member:!0,method:!0,mode:!0,observeAttribute:!0,prop:!0,propMutable:!0,reflect:!0,scoped:!0,shadowDom:!0,slot:!0,cssAnnotations:!0,state:!0,style:!0,svg:!0,updatable:!0,vdomAttribute:!0,vdomXlink:!0,vdomClass:!0,vdomFunctional:!0,vdomKey:!0,vdomListener:!0,vdomRef:!0,vdomPropOrAttr:!0,vdomRender:!0,vdomStyle:!0,vdomText:!0,watchCallback:!0,taskQueue:!0,hotModuleReplacement:!1,isDebug:!1,isDev:!1,isTesting:!1,hydrateServerSide:!1,hydrateClientSide:!1,lifecycleDOMEvents:!1,lazyLoad:!1,profile:!1,slotRelocation:!0,appendChildSlotFix:!1,cloneNodeFix:!1,hydratedAttribute:!1,hydratedClass:!0,safari10:!1,scriptDataOpts:!1,scopedSlotTextContentFix:!1,shadowDomShim:!1,slotChildNodesFix:!1,invisiblePrehydration:!0,propBoolean:!0,propNumber:!0,propString:!0,cssVarShim:!1,constructableCSS:!0,cmpShouldUpdate:!0,devTools:!1,dynamicImportShim:!1,shadowDelegatesFocus:!0,initializeNextTick:!1,asyncLoading:!1,asyncQueue:!1,transformTagName:!1,attachStyles:!0};let fd,bL,B0,vL=!1,dv=!1,k$=!1,Sa=!1,kA=null,Hk=!1;const jX=e=>{const t=new URL(e,Ir.$resourcesUrl$);return t.origin!==Qm.location.origin?t.href:t.pathname},Xl=(e,t="")=>()=>{},SA="http://www.w3.org/1999/xlink",IA={},GX="http://www.w3.org/2000/svg",qX="http://www.w3.org/1999/xhtml",KX=e=>e!=null,S$=e=>(e=typeof e,e==="object"||e==="function");function XX(e){var t,n,r;return(r=(n=(t=e.head)===null||t===void 0?void 0:t.querySelector('meta[name="csp-nonce"]'))===null||n===void 0?void 0:n.getAttribute("content"))!==null&&r!==void 0?r:void 0}const jf=(e,t,...n)=>{let r=null,a=null,i=null,s=!1,o=!1;const l=[],c=d=>{for(let p=0;p<d.length;p++)r=d[p],Array.isArray(r)?c(r):r!=null&&typeof r!="boolean"&&((s=typeof e!="function"&&!S$(r))&&(r=String(r)),s&&o?l[l.length-1].$text$+=r:l.push(s?pv(null,r):r),o=s)};if(c(n),t){t.key&&(a=t.key),t.name&&(i=t.name);{const d=t.className||t.class;d&&(t.class=typeof d!="object"?d:Object.keys(d).filter(p=>d[p]).join(" "))}}if(typeof e=="function")return e(t===null?{}:t,l,ZX);const u=pv(e,null);return u.$attrs$=t,l.length>0&&(u.$children$=l),u.$key$=a,u.$name$=i,u},pv=(e,t)=>{const n={$flags$:0,$tag$:e,$text$:t,$elm$:null,$children$:null};return n.$attrs$=null,n.$key$=null,n.$name$=null,n},xL={},YX=e=>e&&e.$tag$===xL,ZX={forEach:(e,t)=>e.map($A).forEach(t),map:(e,t)=>e.map($A).map(t).map(QX)},$A=e=>({vattrs:e.$attrs$,vchildren:e.$children$,vkey:e.$key$,vname:e.$name$,vtag:e.$tag$,vtext:e.$text$}),QX=e=>{if(typeof e.vtag=="function"){const n=Object.assign({},e.vattrs);return e.vkey&&(n.key=e.vkey),e.vname&&(n.name=e.vname),jf(e.vtag,n,...e.vchildren||[])}const t=pv(e.vtag,e.vtext);return t.$attrs$=e.vattrs,t.$children$=e.vchildren,t.$key$=e.vkey,t.$name$=e.vname,t},JX=e=>$9.map(t=>t(e)).find(t=>!!t),e9=(e,t)=>e!=null&&!S$(e)?t&4?e==="false"?!1:e===""||!!e:t&2?parseFloat(e):t&1?String(e):e:e,CA=new WeakMap,t9=(e,t,n)=>{let r=fv.get(e);N9&&n?(r=r||new CSSStyleSheet,typeof r=="string"?r=t:r.replaceSync(t)):r=t,fv.set(e,r)},n9=(e,t,n,r)=>{var a;let i=wL(t,n);const s=fv.get(i);if(e=e.nodeType===11?e:Ci,s)if(typeof s=="string"){e=e.head||e;let o=CA.get(e),l;if(o||CA.set(e,o=new Set),!o.has(i)){{l=Ci.createElement("style"),l.innerHTML=s;const c=(a=Ir.$nonce$)!==null&&a!==void 0?a:XX(Ci);c!=null&&l.setAttribute("nonce",c),e.insertBefore(l,e.querySelector("link"))}o&&o.add(i)}}else e.adoptedStyleSheets.includes(s)||(e.adoptedStyleSheets=[...e.adoptedStyleSheets,s]);return i},r9=e=>{const t=e.$cmpMeta$,n=e.$hostElement$,r=t.$flags$,a=Xl("attachStyles",t.$tagName$),i=n9(n.shadowRoot?n.shadowRoot:n.getRootNode(),t,e.$modeName$);r&10&&(n["s-sc"]=i,n.classList.add(i+"-h"),r&2&&n.classList.add(i+"-s")),a()},wL=(e,t)=>"sc-"+(t&&e.$flags$&32?e.$tagName$+"-"+t:e.$tagName$),EA=(e,t,n,r,a,i)=>{if(n!==r){let s=AA(e,t),o=t.toLowerCase();if(t==="class"){const l=e.classList,c=TA(n),u=TA(r);l.remove(...c.filter(d=>d&&!u.includes(d))),l.add(...u.filter(d=>d&&!c.includes(d)))}else if(t==="style"){for(const l in n)(!r||r[l]==null)&&(l.includes("-")?e.style.removeProperty(l):e.style[l]="");for(const l in r)(!n||r[l]!==n[l])&&(l.includes("-")?e.style.setProperty(l,r[l]):e.style[l]=r[l])}else if(t!=="key")if(t==="ref")r&&r(e);else if(!e.__lookupSetter__(t)&&t[0]==="o"&&t[1]==="n")t[2]==="-"?t=t.slice(3):AA(Qm,o)?t=o.slice(2):t=o[2]+t.slice(3),n&&Ir.rel(e,t,n,!1),r&&Ir.ael(e,t,r,!1);else{const l=S$(r);if((s||l&&r!==null)&&!a)try{if(e.tagName.includes("-"))e[t]=r;else{const u=r==null?"":r;t==="list"?s=!1:(n==null||e[t]!=u)&&(e[t]=u)}}catch(u){}let c=!1;o!==(o=o.replace(/^xlink\:?/,""))&&(t=o,c=!0),r==null||r===!1?(r!==!1||e.getAttribute(t)==="")&&(c?e.removeAttributeNS(SA,t):e.removeAttribute(t)):(!s||i&4||a)&&!l&&(r=r===!0?"":r,c?e.setAttributeNS(SA,t,r):e.setAttribute(t,r))}}},a9=/\s/,TA=e=>e?e.split(a9):[],kL=(e,t,n,r)=>{const a=t.$elm$.nodeType===11&&t.$elm$.host?t.$elm$.host:t.$elm$,i=e&&e.$attrs$||IA,s=t.$attrs$||IA;for(r in i)r in s||EA(a,r,i[r],void 0,n,t.$flags$);for(r in s)EA(a,r,i[r],s[r],n,t.$flags$)},hv=(e,t,n,r)=>{const a=t.$children$[n];let i=0,s,o,l;if(vL||(k$=!0,a.$tag$==="slot"&&(fd&&r.classList.add(fd+"-s"),a.$flags$|=a.$children$?2:1)),a.$text$!==null)s=a.$elm$=Ci.createTextNode(a.$text$);else if(a.$flags$&1)s=a.$elm$=Ci.createTextNode("");else{if(Sa||(Sa=a.$tag$==="svg"),s=a.$elm$=Ci.createElementNS(Sa?GX:qX,a.$flags$&2?"slot-fb":a.$tag$),Sa&&a.$tag$==="foreignObject"&&(Sa=!1),kL(null,a,Sa),KX(fd)&&s["s-si"]!==fd&&s.classList.add(s["s-si"]=fd),a.$children$)for(i=0;i<a.$children$.length;++i)o=hv(e,a,i,s),o&&s.appendChild(o);a.$tag$==="svg"?Sa=!1:s.tagName==="foreignObject"&&(Sa=!0)}return s["s-hn"]=B0,a.$flags$&3&&(s["s-sr"]=!0,s["s-cr"]=bL,s["s-sn"]=a.$name$||"",l=e&&e.$children$&&e.$children$[n],l&&l.$tag$===a.$tag$&&e.$elm$&&xm(e.$elm$,!1)),s},xm=(e,t)=>{Ir.$flags$|=1;const n=e.childNodes;for(let r=n.length-1;r>=0;r--){const a=n[r];a["s-hn"]!==B0&&a["s-ol"]&&($L(a).insertBefore(a,I$(a)),a["s-ol"].remove(),a["s-ol"]=void 0,k$=!0),t&&xm(a,t)}Ir.$flags$&=-2},SL=(e,t,n,r,a,i)=>{let s=e["s-cr"]&&e["s-cr"].parentNode||e,o;for(s.shadowRoot&&s.tagName===B0&&(s=s.shadowRoot);a<=i;++a)r[a]&&(o=hv(null,n,a,e),o&&(r[a].$elm$=o,s.insertBefore(o,I$(t))))},IL=(e,t,n,r,a)=>{for(;t<=n;++t)(r=e[t])&&(a=r.$elm$,TL(r),dv=!0,a["s-ol"]?a["s-ol"].remove():xm(a,!0),a.remove())},i9=(e,t,n,r)=>{let a=0,i=0,s=0,o=0,l=t.length-1,c=t[0],u=t[l],d=r.length-1,p=r[0],h=r[d],f,m;for(;a<=l&&i<=d;)if(c==null)c=t[++a];else if(u==null)u=t[--l];else if(p==null)p=r[++i];else if(h==null)h=r[--d];else if(By(c,p))md(c,p),c=t[++a],p=r[++i];else if(By(u,h))md(u,h),u=t[--l],h=r[--d];else if(By(c,h))(c.$tag$==="slot"||h.$tag$==="slot")&&xm(c.$elm$.parentNode,!1),md(c,h),e.insertBefore(c.$elm$,u.$elm$.nextSibling),c=t[++a],h=r[--d];else if(By(u,p))(c.$tag$==="slot"||h.$tag$==="slot")&&xm(u.$elm$.parentNode,!1),md(u,p),e.insertBefore(u.$elm$,c.$elm$),u=t[--l],p=r[++i];else{for(s=-1,o=a;o<=l;++o)if(t[o]&&t[o].$key$!==null&&t[o].$key$===p.$key$){s=o;break}s>=0?(m=t[s],m.$tag$!==p.$tag$?f=hv(t&&t[i],n,s,e):(md(m,p),t[s]=void 0,f=m.$elm$),p=r[++i]):(f=hv(t&&t[i],n,i,e),p=r[++i]),f&&$L(c.$elm$).insertBefore(f,I$(c.$elm$))}a>l?SL(e,r[d+1]==null?null:r[d+1].$elm$,n,r,i,d):i>d&&IL(t,a,l)},By=(e,t)=>e.$tag$===t.$tag$?e.$tag$==="slot"?e.$name$===t.$name$:e.$key$===t.$key$:!1,I$=e=>e&&e["s-ol"]||e,$L=e=>(e["s-ol"]?e["s-ol"]:e).parentNode,md=(e,t)=>{const n=t.$elm$=e.$elm$,r=e.$children$,a=t.$children$,i=t.$tag$,s=t.$text$;let o;s===null?(Sa=i==="svg"?!0:i==="foreignObject"?!1:Sa,i==="slot"||kL(e,t,Sa),r!==null&&a!==null?i9(n,r,t,a):a!==null?(e.$text$!==null&&(n.textContent=""),SL(n,null,t,a,0,a.length-1)):r!==null&&IL(r,0,r.length-1),Sa&&i==="svg"&&(Sa=!1)):(o=n["s-cr"])?o.parentNode.textContent=s:e.$text$!==s&&(n.data=s)},CL=e=>{const t=e.childNodes;let n,r,a,i,s,o;for(r=0,a=t.length;r<a;r++)if(n=t[r],n.nodeType===1){if(n["s-sr"]){for(s=n["s-sn"],n.hidden=!1,i=0;i<a;i++)if(o=t[i].nodeType,t[i]["s-hn"]!==n["s-hn"]||s!==""){if(o===1&&s===t[i].getAttribute("slot")){n.hidden=!0;break}}else if(o===1||o===3&&t[i].textContent.trim()!==""){n.hidden=!0;break}}CL(n)}},bi=[],EL=e=>{let t,n,r,a,i,s,o=0;const l=e.childNodes,c=l.length;for(;o<c;o++){if(t=l[o],t["s-sr"]&&(n=t["s-cr"])&&n.parentNode)for(r=n.parentNode.childNodes,a=t["s-sn"],s=r.length-1;s>=0;s--)n=r[s],!n["s-cn"]&&!n["s-nr"]&&n["s-hn"]!==t["s-hn"]&&(NA(n,a)?(i=bi.find(u=>u.$nodeToRelocate$===n),dv=!0,n["s-sn"]=n["s-sn"]||a,i?i.$slotRefNode$=t:bi.push({$slotRefNode$:t,$nodeToRelocate$:n}),n["s-sr"]&&bi.map(u=>{NA(u.$nodeToRelocate$,n["s-sn"])&&(i=bi.find(d=>d.$nodeToRelocate$===n),i&&!u.$slotRefNode$&&(u.$slotRefNode$=i.$slotRefNode$))})):bi.some(u=>u.$nodeToRelocate$===n)||bi.push({$nodeToRelocate$:n}));t.nodeType===1&&EL(t)}},NA=(e,t)=>e.nodeType===1?e.getAttribute("slot")===null&&t===""||e.getAttribute("slot")===t:e["s-sn"]===t?!0:t==="",TL=e=>{e.$attrs$&&e.$attrs$.ref&&e.$attrs$.ref(null),e.$children$&&e.$children$.map(TL)},s9=(e,t)=>{const n=e.$hostElement$,r=e.$cmpMeta$,a=e.$vnode$||pv(null,null),i=YX(t)?t:jf(null,null,t);B0=n.tagName,r.$attrsToReflect$&&(i.$attrs$=i.$attrs$||{},r.$attrsToReflect$.map(([s,o])=>i.$attrs$[o]=n[s])),i.$tag$=null,i.$flags$|=4,e.$vnode$=i,i.$elm$=a.$elm$=n.shadowRoot||n,fd=n["s-sc"],bL=n["s-cr"],vL=(r.$flags$&1)!==0,dv=!1,md(a,i);{if(Ir.$flags$|=1,k$){EL(i.$elm$);let s,o,l,c,u,d,p=0;for(;p<bi.length;p++)s=bi[p],o=s.$nodeToRelocate$,o["s-ol"]||(l=Ci.createTextNode(""),l["s-nr"]=o,o.parentNode.insertBefore(o["s-ol"]=l,o));for(p=0;p<bi.length;p++)if(s=bi[p],o=s.$nodeToRelocate$,s.$slotRefNode$){for(c=s.$slotRefNode$.parentNode,u=s.$slotRefNode$.nextSibling,l=o["s-ol"];l=l.previousSibling;)if(d=l["s-nr"],d&&d["s-sn"]===o["s-sn"]&&c===d.parentNode&&(d=d.nextSibling,!d||!d["s-nr"])){u=d;break}(!u&&c!==o.parentNode||o.nextSibling!==u)&&o!==u&&(!o["s-hn"]&&o["s-ol"]&&(o["s-hn"]=o["s-ol"].parentNode.nodeName),c.insertBefore(o,u))}else o.nodeType===1&&(o.hidden=!0)}dv&&CL(i.$elm$),Ir.$flags$&=-2,bi.length=0}},o9=(e,t)=>{},NL=(e,t)=>(e.$flags$|=16,o9(e,e.$ancestorComponent$),R9(()=>l9(e,t))),l9=(e,t)=>{const n=e.$hostElement$,r=Xl("scheduleUpdate",e.$cmpMeta$.$tagName$),a=n;let i;return t?i=zd(a,"componentWillLoad"):i=zd(a,"componentWillUpdate"),i=_A(i,()=>zd(a,"componentWillRender")),r(),_A(i,()=>u9(e,a,t))},u9=async(e,t,n)=>{const r=e.$hostElement$,a=Xl("update",e.$cmpMeta$.$tagName$);r["s-rc"],n&&r9(e);const i=Xl("render",e.$cmpMeta$.$tagName$);c9(e,t,r),i(),a(),d9(e)},c9=(e,t,n)=>{try{kA=t,t=t.render&&t.render(),e.$flags$&=-17,e.$flags$|=2,(hd.hasRenderFn||hd.reflect)&&(hd.vdomRender||hd.reflect)&&(hd.hydrateServerSide||s9(e,t))}catch(o){Zm(o,e.$hostElement$)}return kA=null,null},d9=e=>{const t=e.$cmpMeta$.$tagName$,n=e.$hostElement$,r=Xl("postUpdate",t),a=n;e.$ancestorComponent$,zd(a,"componentDidRender"),e.$flags$&64?(zd(a,"componentDidUpdate"),r()):(e.$flags$|=64,zd(a,"componentDidLoad"),r())},zd=(e,t,n)=>{if(e&&e[t])try{return e[t](n)}catch(r){Zm(r)}},_A=(e,t)=>e&&e.then?e.then(t):t(),p9=(e,t)=>W0(e).$instanceValues$.get(t),h9=(e,t,n,r)=>{const a=W0(e),i=e,s=a.$instanceValues$.get(t),o=a.$flags$,l=i;n=e9(n,r.$members$[t][0]);const c=Number.isNaN(s)&&Number.isNaN(n);if(n!==s&&!c){a.$instanceValues$.set(t,n);{if(r.$watchers$&&o&128){const d=r.$watchers$[t];d&&d.map(p=>{try{l[p](n,s,t)}catch(h){Zm(h,i)}})}if((o&18)===2){if(l.componentShouldUpdate&&l.componentShouldUpdate(n,s,t)===!1)return;NL(a,!1)}}}},f9=(e,t,n)=>{if(t.$members$){e.watchers&&(t.$watchers$=e.watchers);const r=Object.entries(t.$members$),a=e.prototype;r.map(([i,[s]])=>{(s&31||s&32)&&Object.defineProperty(a,i,{get(){return p9(this,i)},set(o){h9(this,i,o,t)},configurable:!0,enumerable:!0})});{const i=new Map;a.attributeChangedCallback=function(s,o,l){Ir.jmp(()=>{const c=i.get(s);if(this.hasOwnProperty(c))l=this[c],delete this[c];else if(a.hasOwnProperty(c)&&typeof this[c]=="number"&&this[c]==l)return;this[c]=l===null&&typeof this[c]=="boolean"?!1:l})},e.observedAttributes=r.filter(([s,o])=>o[0]&15).map(([s,o])=>{const l=o[1]||s;return i.set(l,s),o[0]&512&&t.$attrsToReflect$.push([s,l]),l})}}return e},m9=async(e,t,n,r,a)=>{if(!(t.$flags$&32)&&(a=e.constructor,t.$flags$|=32,customElements.whenDefined(n.$tagName$).then(()=>t.$flags$|=128),a.style)){let s=a.style;typeof s!="string"&&(s=s[t.$modeName$=JX(e)]);const o=wL(n,t.$modeName$);if(!fv.has(o)){const l=Xl("registerStyles",n.$tagName$);t9(o,s,!!(n.$flags$&1)),l()}}t.$ancestorComponent$,(()=>NL(t,!0))()},g9=e=>{},y9=e=>{if(!(Ir.$flags$&1)){const t=W0(e),n=t.$cmpMeta$,r=Xl("connectedCallback",n.$tagName$);t.$flags$&1?(_L(e,t,n.$listeners$),g9(t.$lazyInstance$)):(t.$flags$|=1,n.$flags$&12&&b9(e),n.$members$&&Object.entries(n.$members$).map(([a,[i]])=>{if(i&31&&e.hasOwnProperty(a)){const s=e[a];delete e[a],e[a]=s}}),m9(e,t,n)),r()}},b9=e=>{const t=e["s-cr"]=Ci.createComment("");t["s-cn"]=!0,e.insertBefore(t,e.firstChild)},v9=e=>{if(!(Ir.$flags$&1)){const t=W0(e);t.$rmListeners$&&(t.$rmListeners$.map(n=>n()),t.$rmListeners$=void 0)}},x9=(e,t)=>{const n={$flags$:t[0],$tagName$:t[1]};n.$members$=t[2],n.$listeners$=t[3],n.$watchers$=e.$watchers$,n.$attrsToReflect$=[];const r=e.prototype.connectedCallback,a=e.prototype.disconnectedCallback;return Object.assign(e.prototype,{__registerHost(){I9(this,n)},connectedCallback(){y9(this),r&&r.call(this)},disconnectedCallback(){v9(this),a&&a.call(this)},__attachShadow(){this.attachShadow({mode:"open",delegatesFocus:!!(n.$flags$&16)})}}),e.is=n.$tagName$,f9(e,n)},_L=(e,t,n,r)=>{n&&n.map(([a,i,s])=>{const o=k9(e,a),l=w9(t,s),c=S9(a);Ir.ael(o,i,l,c),(t.$rmListeners$=t.$rmListeners$||[]).push(()=>Ir.rel(o,i,l,c))})},w9=(e,t)=>n=>{try{hd.lazyLoad||e.$hostElement$[t](n)}catch(r){Zm(r)}},k9=(e,t)=>t&4?Ci:t&8?Qm:t&16?Ci.body:e,S9=e=>E9?{passive:(e&1)!==0,capture:(e&2)!==0}:(e&2)!==0,AL=new WeakMap,W0=e=>AL.get(e),I9=(e,t)=>{const n={$flags$:0,$hostElement$:e,$cmpMeta$:t,$instanceValues$:new Map};return _L(e,n,t.$listeners$),AL.set(e,n)},AA=(e,t)=>t in e,Zm=(e,t)=>(0,console.error)(e,t),fv=new Map,$9=[],Qm=typeof window<"u"?window:{},Ci=Qm.document||{head:{}},C9=Qm.HTMLElement||class{},Ir={$flags$:0,$resourcesUrl$:"",jmp:e=>e(),raf:e=>requestAnimationFrame(e),ael:(e,t,n,r)=>e.addEventListener(t,n,r),rel:(e,t,n,r)=>e.removeEventListener(t,n,r),ce:(e,t)=>new CustomEvent(e,t)},E9=(()=>{let e=!1;try{Ci.addEventListener("e",null,Object.defineProperty({},"passive",{get(){e=!0}}))}catch(t){}return e})(),T9=e=>Promise.resolve(e),N9=(()=>{try{return new CSSStyleSheet,typeof new CSSStyleSheet().replaceSync=="function"}catch(e){}return!1})(),RA=[],RL=[],_9=(e,t)=>n=>{e.push(n),Hk||(Hk=!0,t&&Ir.$flags$&4?A9(jk):Ir.raf(jk))},DA=e=>{for(let t=0;t<e.length;t++)try{e[t](performance.now())}catch(n){Zm(n)}e.length=0},jk=()=>{DA(RA),DA(RL),(Hk=RA.length>0)&&Ir.raf(jk)},A9=e=>T9().then(e),R9=_9(RL,!0);let u1;const D9=()=>{if(typeof window>"u")return new Map;if(!u1){const e=window;e.Ionicons=e.Ionicons||{},u1=e.Ionicons.map=e.Ionicons.map||new Map}return u1},F9=e=>{let t=c1(e.src);return t||(t=DL(e.name,e.icon,e.mode,e.ios,e.md),t?M9(t):e.icon&&(t=c1(e.icon),t||(t=c1(e.icon[e.mode]),t))?t:null)},M9=e=>{const t=D9().get(e);return t||jX("svg/".concat(e,".svg"))},DL=(e,t,n,r,a)=>(n=(n&&Wy(n))==="ios"?"ios":"md",r&&n==="ios"?e=Wy(r):a&&n==="md"?e=Wy(a):(!e&&t&&!FL(t)&&(e=t),mv(e)&&(e=Wy(e))),!mv(e)||e.trim()===""||e.replace(/[a-z]|-|\d/gi,"")!==""?null:e),c1=e=>mv(e)&&(e=e.trim(),FL(e))?e:null,FL=e=>e.length>0&&/(\/|\.)/.test(e),mv=e=>typeof e=="string",Wy=e=>e.toLowerCase(),O9=(e,t=[])=>{const n={};return t.forEach(r=>{e.hasAttribute(r)&&(e.getAttribute(r)!==null&&(n[r]=e.getAttribute(r)),e.removeAttribute(r))}),n},L9=e=>e&&e.dir!==""?e.dir.toLowerCase()==="rtl":(document==null?void 0:document.dir.toLowerCase())==="rtl",P9=e=>{const t=document.createElement("div");t.innerHTML=e;for(let r=t.childNodes.length-1;r>=0;r--)t.childNodes[r].nodeName.toLowerCase()!=="svg"&&t.removeChild(t.childNodes[r]);const n=t.firstElementChild;if(n&&n.nodeName.toLowerCase()==="svg"){const r=n.getAttribute("class")||"";if(n.setAttribute("class",(r+" s-ion-icon").trim()),ML(n))return t.innerHTML}return""},ML=e=>{if(e.nodeType===1){if(e.nodeName.toLowerCase()==="script")return!1;for(let t=0;t<e.attributes.length;t++){const n=e.attributes[t].name;if(mv(n)&&n.toLowerCase().indexOf("on")===0)return!1}for(let t=0;t<e.childNodes.length;t++)if(!ML(e.childNodes[t]))return!1}return!0},z9=e=>e.startsWith("data:image/svg+xml"),B9=e=>e.indexOf(";utf8,")!==-1,Tl=new Map,FA=new Map;let d1;const W9=(e,t)=>{let n=FA.get(e);if(!n)if(typeof fetch<"u"&&typeof document<"u")if(z9(e)&&B9(e)){d1||(d1=new DOMParser);const a=d1.parseFromString(e,"text/html").querySelector("svg");return a&&Tl.set(e,a.outerHTML),Promise.resolve()}else n=fetch(e).then(r=>{if(r.ok)return r.text().then(a=>{a&&t!==!1&&(a=P9(a)),Tl.set(e,a||"")});Tl.set(e,"")}),FA.set(e,n);else return Tl.set(e,""),Promise.resolve();return n},U9=":host{display:inline-block;width:1em;height:1em;contain:strict;fill:currentColor;-webkit-box-sizing:content-box !important;box-sizing:content-box !important}:host .ionicon{stroke:currentColor}.ionicon-fill-none{fill:none}.ionicon-stroke-width{stroke-width:32px;stroke-width:var(--ionicon-stroke-width, 32px)}.icon-inner,.ionicon,svg{display:block;height:100%;width:100%}@supports (background: -webkit-named-image(i)){:host(.icon-rtl) .icon-inner{-webkit-transform:scaleX(-1);transform:scaleX(-1)}}@supports not selector(:dir(rtl)) and selector(:host-context([dir='rtl'])){:host(.icon-rtl) .icon-inner{-webkit-transform:scaleX(-1);transform:scaleX(-1)}}:host(.flip-rtl):host-context([dir='rtl']) .icon-inner{-webkit-transform:scaleX(-1);transform:scaleX(-1)}@supports selector(:dir(rtl)){:host(.flip-rtl:dir(rtl)) .icon-inner{-webkit-transform:scaleX(-1);transform:scaleX(-1)}:host(.flip-rtl:dir(ltr)) .icon-inner{-webkit-transform:scaleX(1);transform:scaleX(1)}}:host(.icon-small){font-size:18px !important}:host(.icon-large){font-size:32px !important}:host(.ion-color){color:var(--ion-color-base) !important}:host(.ion-color-primary){--ion-color-base:var(--ion-color-primary, #3880ff)}:host(.ion-color-secondary){--ion-color-base:var(--ion-color-secondary, #0cd1e8)}:host(.ion-color-tertiary){--ion-color-base:var(--ion-color-tertiary, #f4a942)}:host(.ion-color-success){--ion-color-base:var(--ion-color-success, #10dc60)}:host(.ion-color-warning){--ion-color-base:var(--ion-color-warning, #ffce00)}:host(.ion-color-danger){--ion-color-base:var(--ion-color-danger, #f14141)}:host(.ion-color-light){--ion-color-base:var(--ion-color-light, #f4f5f8)}:host(.ion-color-medium){--ion-color-base:var(--ion-color-medium, #989aa2)}:host(.ion-color-dark){--ion-color-base:var(--ion-color-dark, #222428)}",V9=x9(class extends C9{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.iconName=null,this.inheritedAttributes={},this.isVisible=!1,this.mode=H9(),this.lazy=!1,this.sanitize=!0}componentWillLoad(){this.inheritedAttributes=O9(this.el,["aria-label"])}connectedCallback(){this.waitUntilVisible(this.el,"50px",()=>{this.isVisible=!0,this.loadIcon()})}disconnectedCallback(){this.io&&(this.io.disconnect(),this.io=void 0)}waitUntilVisible(e,t,n){if(this.lazy&&typeof window<"u"&&window.IntersectionObserver){const r=this.io=new window.IntersectionObserver(a=>{a[0].isIntersecting&&(r.disconnect(),this.io=void 0,n())},{rootMargin:t});r.observe(e)}else n()}loadIcon(){if(this.isVisible){const e=F9(this);e&&(Tl.has(e)?this.svgContent=Tl.get(e):W9(e,this.sanitize).then(()=>this.svgContent=Tl.get(e)))}this.iconName=DL(this.name,this.icon,this.mode,this.ios,this.md)}render(){const{flipRtl:e,iconName:t,inheritedAttributes:n,el:r}=this,a=this.mode||"md",i=t?(t.includes("arrow")||t.includes("chevron"))&&e!==!1:!1,s=e||i;return jf(xL,Object.assign({role:"img",class:Object.assign(Object.assign({[a]:!0},j9(this.color)),{["icon-".concat(this.size)]:!!this.size,"flip-rtl":s,"icon-rtl":s&&L9(r)})},n),this.svgContent?jf("div",{class:"icon-inner",innerHTML:this.svgContent}):jf("div",{class:"icon-inner"}))}static get assetsDirs(){return["svg"]}get el(){return this}static get watchers(){return{name:["loadIcon"],src:["loadIcon"],icon:["loadIcon"],ios:["loadIcon"],md:["loadIcon"]}}static get style(){return U9}},[1,"ion-icon",{mode:[1025],color:[1],ios:[1],md:[1],flipRtl:[4,"flip-rtl"],name:[513],src:[1],icon:[8],size:[1],lazy:[4],sanitize:[4],svgContent:[32],isVisible:[32]}]),H9=()=>typeof document<"u"&&document.documentElement.getAttribute("mode")||"md",j9=e=>e?{"ion-color":!0,["ion-color-".concat(e)]:!0}:null;function G9(){if(typeof customElements>"u")return;["ion-icon"].forEach(t=>{switch(t){case"ion-icon":customElements.get(t)||customElements.define(t,V9);break}})}const q9=G9,$$=oe.createContext({onIonViewWillEnter:()=>{},ionViewWillEnter:()=>{},onIonViewDidEnter:()=>{},ionViewDidEnter:()=>{},onIonViewWillLeave:()=>{},ionViewWillLeave:()=>{},onIonViewDidLeave:()=>{},ionViewDidLeave:()=>{}}),K9=class{constructor(){this.ionViewWillEnterCallbacks=[],this.ionViewDidEnterCallbacks=[],this.ionViewWillLeaveCallbacks=[],this.ionViewDidLeaveCallbacks=[]}onIonViewWillEnter(e){if(e.id){const t=this.ionViewWillEnterCallbacks.findIndex(n=>n.id===e.id);t>-1?this.ionViewWillEnterCallbacks[t]=e:this.ionViewWillEnterCallbacks.push(e)}else this.ionViewWillEnterCallbacks.push(e)}ionViewWillEnter(){this.ionViewWillEnterCallbacks.forEach(e=>e())}onIonViewDidEnter(e){if(e.id){const t=this.ionViewDidEnterCallbacks.findIndex(n=>n.id===e.id);t>-1?this.ionViewDidEnterCallbacks[t]=e:this.ionViewDidEnterCallbacks.push(e)}else this.ionViewDidEnterCallbacks.push(e)}ionViewDidEnter(){this.ionViewDidEnterCallbacks.forEach(e=>e())}onIonViewWillLeave(e){if(e.id){const t=this.ionViewWillLeaveCallbacks.findIndex(n=>n.id===e.id);t>-1?this.ionViewWillLeaveCallbacks[t]=e:this.ionViewWillLeaveCallbacks.push(e)}else this.ionViewWillLeaveCallbacks.push(e)}ionViewWillLeave(){this.ionViewWillLeaveCallbacks.forEach(e=>e())}onIonViewDidLeave(e){if(e.id){const t=this.ionViewDidLeaveCallbacks.findIndex(n=>n.id===e.id);t>-1?this.ionViewDidLeaveCallbacks[t]=e:this.ionViewDidLeaveCallbacks.push(e)}else this.ionViewDidLeaveCallbacks.push(e)}ionViewDidLeave(){this.ionViewDidLeaveCallbacks.forEach(e=>e()),this.componentCanBeDestroyed()}onComponentCanBeDestroyed(e){this.componentCanBeDestroyedCallback=e}componentCanBeDestroyed(){this.componentCanBeDestroyedCallback&&this.componentCanBeDestroyedCallback()}},zs=oe.createContext({getIonRedirect:()=>{},getIonRoute:()=>{},getPageManager:()=>{},getStackManager:()=>{},goBack:e=>{typeof window<"u"&&(typeof e=="string"?window.location.pathname=e:window.history.back())},navigate:e=>{typeof window<"u"&&(window.location.pathname=e)},hasIonicRouter:()=>!1,routeInfo:void 0,setCurrentTab:()=>{},changeTab:(e,t)=>{typeof window<"u"&&(window.location.pathname=t)},resetTab:(e,t)=>{typeof window<"u"&&(window.location.pathname=t)}}),C$=e=>e.toLowerCase().split("-").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(""),U0=e=>e.replace(/([A-Z])/g,t=>"-".concat(t[0].toLowerCase())),E$=(e,t,n={})=>{if(e instanceof Element){const r=X9(e.classList,t,n);r!==""&&(e.className=r),Object.keys(t).forEach(a=>{if(!(a==="children"||a==="style"||a==="ref"||a==="class"||a==="className"||a==="forwardedRef"))if(a.indexOf("on")===0&&a[2]===a[2].toUpperCase()){const i=a.substring(2),s=i[0].toLowerCase()+i.substring(1);Jm(s)||Z9(e,s,t[a])}else e[a]=t[a],typeof t[a]==="string"&&e.setAttribute(U0(a),t[a])})}},X9=(e,t,n)=>{const r=t.className||t.class,a=n.className||n.class,i=p1(e),s=p1(r?r.split(" "):[]),o=p1(a?a.split(" "):[]),l=[];return i.forEach(c=>{s.has(c)?(l.push(c),s.delete(c)):o.has(c)||l.push(c)}),s.forEach(c=>l.push(c)),l.join(" ")},Y9=e=>{switch(e){case"doubleclick":return"dblclick"}return e};/**
 * Checks if an event is supported in the current execution environment.
 * @license Modernizr 3.0.0pre (Custom Build) | MIT
 */const Jm=e=>{if(typeof document>"u")return!0;{const t="on"+Y9(e);let n=t in document;if(!n){const r=document.createElement("div");r.setAttribute(t,"return;"),n=typeof r[t]=="function"}return n}},Z9=(e,t,n)=>{const r=e.__events||(e.__events={}),a=r[t];a&&e.removeEventListener(t,a),e.addEventListener(t,r[t]=function(s){n&&n.call(this,s)})},p1=e=>{const t=new Map;return e.forEach(n=>t.set(n,n)),t},Q9=(e,t)=>{typeof e=="function"?e(t):e!=null&&(e.current=t)},V0=(...e)=>t=>{e.forEach(n=>{Q9(n,t)})},J9=(e,t)=>{const n=(r,a)=>oe.createElement(e,Object.assign({},r,{forwardedRef:a}));return n.displayName=t,oe.forwardRef(n)},eY=(e,t)=>{t!==void 0&&typeof customElements<"u"&&!customElements.get(e)&&customElements.define(e,t)},ya=(e,t,n,r)=>{r!==void 0&&r();const a=C$(e),i=class extends oe.Component{constructor(s){super(s),this.setComponentElRef=o=>{this.componentEl=o}}componentDidMount(){this.componentDidUpdate(this.props)}componentDidUpdate(s){E$(this.componentEl,this.props,s)}render(){const s=this.props,{children:o,forwardedRef:l,style:c,className:u,ref:d}=s,p=Sr(s,["children","forwardedRef","style","className","ref"]);let h=Object.keys(p).reduce((m,g)=>{const y=p[g];if(g.indexOf("on")===0&&g[2]===g[2].toUpperCase()){const b=g.substring(2).toLowerCase();typeof document<"u"&&Jm(b)&&(m[g]=y)}else{const b=typeof y;(b==="string"||b==="boolean"||b==="number")&&(m[U0(g)]=y)}return m},{});n&&(h=n(this.props,h));const f=Object.assign(Object.assign({},h),{ref:V0(l,this.setComponentElRef),style:c});return _e.createElement(e,f,o)}static get displayName(){return a}};return t&&(i.contextType=t),J9(i,a)},rn=ya("ion-col",void 0,void 0,r7),OL=ya("ion-content",void 0,void 0,c7),Fs=ya("ion-grid",void 0,void 0,$7),tY=ya("ion-header",void 0,void 0,M7),MA=ya("ion-label",void 0,void 0,O7),nn=ya("ion-row",void 0,void 0,j7),nY=ya("ion-segment",void 0,void 0,Y7),OA=ya("ion-segment-button",void 0,void 0,nX),vu=(e,t)=>{const n=(r,a)=>oe.createElement(e,Object.assign({},r,{forwardedRef:a}));return n.displayName=t,oe.forwardRef(n)},T$=()=>{if(typeof window<"u"){const e=window.Ionic;if(e&&e.config)return e.config}return null},rY=(e,t)=>{eY(e,t);const n=C$(e),r=class extends oe.Component{constructor(a){super(a),this.handleClick=i=>{const{routerLink:s,routerDirection:o,routerOptions:l,routerAnimation:c}=this.props;s!==void 0&&(i.preventDefault(),this.context.navigate(s,o,void 0,c,l))},this.ref=oe.createRef(),this.stableMergedRefs=V0(this.ref,this.props.forwardedRef)}componentDidMount(){this.componentDidUpdate(this.props)}componentDidUpdate(a){const i=this.ref.current;E$(i,this.props,a)}render(){const a=this.props,{children:i,forwardedRef:s,style:o,className:l,ref:c}=a,u=Sr(a,["children","forwardedRef","style","className","ref"]),d=Object.keys(u).reduce((h,f)=>{if(f.indexOf("on")===0&&f[2]===f[2].toUpperCase()){const m=f.substring(2).toLowerCase();Jm(m)&&(h[f]=u[f])}else["string","boolean","number"].includes(typeof u[f])&&(h[U0(f)]=u[f]);return h},{}),p=Object.assign(Object.assign({},d),{ref:this.stableMergedRefs,style:o});if(this.props.routerLink&&!this.props.href&&(p.href=this.props.routerLink),p.onClick){const h=p.onClick;p.onClick=f=>{h(f),f.defaultPrevented||this.handleClick(f)}}else p.onClick=this.handleClick;return _e.createElement(e,p,i)}static get displayName(){return n}static get contextType(){return zs}};return vu(r,n)},Or=rY("ion-button",rX),aY=(e,t)=>{e instanceof Element&&Object.keys(t).forEach(n=>{if(n.indexOf("on")===0&&n[2]===n[2].toUpperCase()){const r=n.substring(2),a=r[0].toLowerCase()+r.substring(1);Jm(a)||iY(e,a)}})},iY=(e,t)=>{const n=e.__events||(e.__events={}),r=n[t];r&&(e.removeEventListener(t,r),n[t]=void 0)},sY=(e,t,n)=>{t&&t();const r=C$(e),a=class extends oe.Component{constructor(i){super(i),this.handleIonMount=()=>{this.setState({isOpen:!0})},this.handleWillPresent=s=>{this.setState({isOpen:!0}),this.props.onWillPresent&&this.props.onWillPresent(s)},this.handleDidDismiss=s=>{const o=this.wrapperRef.current,l=this.ref.current;o&&l&&(l.append(o),this.setState({isOpen:!1})),this.props.onDidDismiss&&this.props.onDidDismiss(s)},this.ref=oe.createRef(),this.stableMergedRefs=V0(this.ref,this.props.forwardedRef),this.state={isOpen:!1},this.wrapperRef=oe.createRef()}componentDidMount(){var i,s,o;this.componentDidUpdate(this.props),(i=this.ref.current)===null||i===void 0||i.addEventListener("ionMount",this.handleIonMount),(s=this.ref.current)===null||s===void 0||s.addEventListener("willPresent",this.handleWillPresent),(o=this.ref.current)===null||o===void 0||o.addEventListener("didDismiss",this.handleDidDismiss)}componentDidUpdate(i){const s=this.ref.current;E$(s,this.props,i)}componentWillUnmount(){const i=this.ref.current;i&&this.state.isOpen&&(i.removeEventListener("didDismiss",this.handleDidDismiss),i.remove(),aY(i,this.props))}render(){const i=this.props,{children:s,forwardedRef:o,style:l,className:c,ref:u}=i,d=Sr(i,["children","forwardedRef","style","className","ref"]),p=Object.keys(d).reduce((m,g)=>{if(g.indexOf("on")===0&&g[2]===g[2].toUpperCase()){const y=g.substring(2).toLowerCase();Jm(y)&&(m[g]=d[g])}else["string","boolean","number"].includes(typeof d[g])&&(m[U0(g)]=d[g]);return m},{}),h=Object.assign(Object.assign({},p),{ref:this.stableMergedRefs,style:l}),f=()=>n?"".concat(LA," ion-page"):LA;return _e.createElement("template",{},_e.createElement(e,h,this.state.isOpen||this.props.keepContentsMounted?_e.createElement("div",{ref:this.wrapperRef,className:f()},s):null))}static get displayName(){return r}};return vu(a,r)},LA="ion-delegate-host",PA=sY("ion-modal",IX,!0),oY=oe.createContext({addOverlay:()=>{},removeOverlay:()=>{}}),lY=({onAddOverlay:e,onRemoveOverlay:t})=>{const[n,r]=_e.useState({}),a=_e.useRef({});a.current=n,_e.useEffect(()=>{e(i),t(s)},[]);const i=(l,c,u)=>{const d=Object.assign({},a.current);d[l]={component:c,containerElement:u},r(d)},s=l=>{const c=Object.assign({},a.current);delete c[l],r(c)},o=Object.keys(n);return oe.createElement(oe.Fragment,null,o.map(l=>{const c=n[l];return y5.createPortal(c.component,c.containerElement,"overlay-".concat(l))}))},uY=ya("ion-tab-button",void 0,void 0,HX),cY=ya("ion-tab-bar",void 0,void 0,zX),Gk=ya("ion-router-outlet",void 0,void 0,FX),dY=ya("ion-app",void 0,void 0,_X),pY=ya("ion-icon",void 0,void 0,q9),hY=(()=>class extends oe.Component{constructor(e){super(e),this.ionContext={addOverlay:(t,n,r)=>{this.addOverlayCallback&&this.addOverlayCallback(t,n,r)},removeOverlay:t=>{this.removeOverlayCallback&&this.removeOverlayCallback(t)}}}render(){return oe.createElement(oY.Provider,{value:this.ionContext},oe.createElement(dY,Object.assign({},this.props),this.props.children),oe.createElement(lY,{onAddOverlay:e=>{this.addOverlayCallback=e},onRemoveOverlay:e=>{this.removeOverlayCallback=e}}))}static get displayName(){return"IonApp"}})(),N$=oe.createContext({registerIonPage:()=>{},isInOutlet:()=>!1});class LL extends oe.PureComponent{constructor(t){super(t),this.ionPageElementRef=oe.createRef(),this.stableMergedRefs=V0(this.ionPageElementRef,this.props.forwardedRef)}componentDidMount(){this.ionPageElementRef.current&&(this.context.isInOutlet()&&this.ionPageElementRef.current.classList.add("ion-page-invisible"),this.context.registerIonPage(this.ionPageElementRef.current,this.props.routeInfo),this.ionPageElementRef.current.addEventListener("ionViewWillEnter",this.ionViewWillEnterHandler.bind(this)),this.ionPageElementRef.current.addEventListener("ionViewDidEnter",this.ionViewDidEnterHandler.bind(this)),this.ionPageElementRef.current.addEventListener("ionViewWillLeave",this.ionViewWillLeaveHandler.bind(this)),this.ionPageElementRef.current.addEventListener("ionViewDidLeave",this.ionViewDidLeaveHandler.bind(this)))}componentWillUnmount(){this.ionPageElementRef.current&&(this.ionPageElementRef.current.removeEventListener("ionViewWillEnter",this.ionViewWillEnterHandler.bind(this)),this.ionPageElementRef.current.removeEventListener("ionViewDidEnter",this.ionViewDidEnterHandler.bind(this)),this.ionPageElementRef.current.removeEventListener("ionViewWillLeave",this.ionViewWillLeaveHandler.bind(this)),this.ionPageElementRef.current.removeEventListener("ionViewDidLeave",this.ionViewDidLeaveHandler.bind(this)))}ionViewWillEnterHandler(){this.ionLifeCycleContext.ionViewWillEnter()}ionViewDidEnterHandler(){this.ionLifeCycleContext.ionViewDidEnter()}ionViewWillLeaveHandler(){this.ionLifeCycleContext.ionViewWillLeave()}ionViewDidLeaveHandler(){this.ionLifeCycleContext.ionViewDidLeave()}render(){const t=this.props,{className:n,children:r,routeInfo:a,forwardedRef:i}=t,s=Sr(t,["className","children","routeInfo","forwardedRef"]);return oe.createElement($$.Consumer,null,o=>(this.ionLifeCycleContext=o,oe.createElement("div",Object.assign({className:n?"".concat(n," ion-page"):"ion-page",ref:this.stableMergedRefs},s),r)))}static get contextType(){return N$}}class fY extends oe.Component{constructor(t){super(t)}render(){const t=this.props,{className:n,children:r,forwardedRef:a}=t,i=Sr(t,["className","children","forwardedRef"]);return this.context.hasIonicRouter()?oe.createElement(LL,Object.assign({className:n?"".concat(n):"",routeInfo:this.context.routeInfo,forwardedRef:a},i),r):oe.createElement("div",Object.assign({className:n?"ion-page ".concat(n):"ion-page",ref:a},i),r)}static get displayName(){return"IonPage"}static get contextType(){return zs}}vu(fY,"IonPage");const mY=(e,t)=>{const n=new WeakMap;return{attachViewToDom:async(i,s,o,l)=>{const c=document.createElement("div");l&&c.classList.add(...l),i.appendChild(c);const u=s(o),d=m0.createPortal(u,c);return n.set(c,d),e(d),Promise.resolve(c)},removeViewFromDom:(i,s)=>{const o=n.get(s);return o&&t(o),s.remove(),Promise.resolve()}}},gY=ya("ion-nav",void 0,void 0,W7),yY=e=>{var{children:t,forwardedRef:n}=e,r=Sr(e,["children","forwardedRef"]);const[a,i]=_e.useState([]),s=c=>i(u=>[...u,c]),o=c=>i(u=>u.filter(d=>d!==c)),l=_e.useMemo(()=>mY(s,o),[]);return oe.createElement(gY,Object.assign({delegate:l,ref:n},r),a)},bY=vu(yY,"IonNav");oe.createContext({activeTab:void 0,selectTab:()=>!1});const vY=typeof HTMLElement<"u"?HTMLElement:class{};class xY extends oe.Component{constructor(t){super(t),this.outletIsReady=!1}componentDidMount(){this.ionRouterOutlet&&(this.outletIsReady||Qd(this.ionRouterOutlet,()=>{this.outletIsReady=!0,this.context.registerIonPage(this.ionRouterOutlet,this.props.routeInfo)}),this.ionRouterOutlet.addEventListener("ionViewWillEnter",this.ionViewWillEnterHandler.bind(this)),this.ionRouterOutlet.addEventListener("ionViewDidEnter",this.ionViewDidEnterHandler.bind(this)),this.ionRouterOutlet.addEventListener("ionViewWillLeave",this.ionViewWillLeaveHandler.bind(this)),this.ionRouterOutlet.addEventListener("ionViewDidLeave",this.ionViewDidLeaveHandler.bind(this)))}componentWillUnmount(){this.ionRouterOutlet&&(this.ionRouterOutlet.removeEventListener("ionViewWillEnter",this.ionViewWillEnterHandler.bind(this)),this.ionRouterOutlet.removeEventListener("ionViewDidEnter",this.ionViewDidEnterHandler.bind(this)),this.ionRouterOutlet.removeEventListener("ionViewWillLeave",this.ionViewWillLeaveHandler.bind(this)),this.ionRouterOutlet.removeEventListener("ionViewDidLeave",this.ionViewDidLeaveHandler.bind(this)))}ionViewWillEnterHandler(){this.ionLifeCycleContext.ionViewWillEnter()}ionViewDidEnterHandler(){this.ionLifeCycleContext.ionViewDidEnter()}ionViewWillLeaveHandler(){this.ionLifeCycleContext.ionViewWillLeave()}ionViewDidLeaveHandler(){this.ionLifeCycleContext.ionViewDidLeave()}render(){const t=this.props,{StackManager:n,children:r,routeInfo:a}=t,i=Sr(t,["StackManager","children","routeInfo"]);return oe.createElement($$.Consumer,null,s=>(this.ionLifeCycleContext=s,oe.createElement(n,{routeInfo:a},oe.createElement(Gk,Object.assign({setRef:o=>this.ionRouterOutlet=o},i),r))))}static get contextType(){return N$}}class wY extends oe.Component{constructor(t){super(t)}render(){const t=this.context.getStackManager(),n=this.props,{children:r,forwardedRef:a}=n,i=Sr(n,["children","forwardedRef"]);return this.context.hasIonicRouter()?i.ionPage?oe.createElement(xY,Object.assign({StackManager:t,routeInfo:this.context.routeInfo},i),r):oe.createElement(t,{routeInfo:this.context.routeInfo},oe.createElement(Gk,Object.assign({},i,{forwardedRef:a}),r)):oe.createElement(Gk,Object.assign({ref:a},this.props),this.props.children)}static get contextType(){return zs}}const kY=vu(wY,"IonRouterOutlet"),h1=(()=>class extends oe.Component{constructor(e){super(e),this.handleIonTabButtonClick=this.handleIonTabButtonClick.bind(this)}handleIonTabButtonClick(){this.props.onClick&&this.props.onClick(new CustomEvent("ionTabButtonClick",{detail:{tab:this.props.tab,href:this.props.href,routeOptions:this.props.routerOptions}}))}render(){const e=this.props,t=Sr(e,["onClick"]);return oe.createElement(uY,Object.assign({onIonTabButtonClick:this.handleIonTabButtonClick},t))}static get displayName(){return"IonTabButton"}})();class SY extends oe.PureComponent{constructor(t){super(t),this.setActiveTabOnContext=r=>{};const n={};oe.Children.forEach(t.children,r=>{var a,i,s,o;r!=null&&typeof r=="object"&&r.props&&(r.type===h1||r.type.isTabButton)&&(n[r.props.tab]={originalHref:r.props.href,currentHref:r.props.href,originalRouteOptions:r.props.href===((a=t.routeInfo)===null||a===void 0?void 0:a.pathname)?(i=t.routeInfo)===null||i===void 0?void 0:i.routeOptions:void 0,currentRouteOptions:r.props.href===((s=t.routeInfo)===null||s===void 0?void 0:s.pathname)?(o=t.routeInfo)===null||o===void 0?void 0:o.routeOptions:void 0})}),this.state={tabs:n},this.onTabButtonClick=this.onTabButtonClick.bind(this),this.renderTabButton=this.renderTabButton.bind(this),this.setActiveTabOnContext=this.setActiveTabOnContext.bind(this),this.selectTab=this.selectTab.bind(this)}componentDidMount(){const t=this.state.tabs,r=Object.keys(t).find(a=>{const i=t[a].originalHref;return this.props.routeInfo.pathname.startsWith(i)});r&&this.setState({activeTab:r})}componentDidUpdate(){this.state.activeTab&&this.setActiveTabOnContext(this.state.activeTab)}selectTab(t){const n=this.state.tabs[t];return n?(this.onTabButtonClick(new CustomEvent("ionTabButtonClick",{detail:{href:n.currentHref,tab:t,selected:t===this.state.activeTab,routeOptions:void 0}})),!0):!1}static getDerivedStateFromProps(t,n){var r,a,i;const s=Object.assign({},n.tabs),l=Object.keys(n.tabs).find(u=>{const d=n.tabs[u].originalHref;return t.routeInfo.pathname.startsWith(d)});oe.Children.forEach(t.children,u=>{if(u!=null&&typeof u=="object"&&u.props&&(u.type===h1||u.type.isTabButton)){const d=s[u.props.tab];(!d||d.originalHref!==u.props.href)&&(s[u.props.tab]={originalHref:u.props.href,currentHref:u.props.href,originalRouteOptions:u.props.routeOptions,currentRouteOptions:u.props.routeOptions})}});const{activeTab:c}=n;if(l&&c){const u=n.tabs[c].currentHref,d=n.tabs[c].currentRouteOptions;(l!==c||u!==((r=t.routeInfo)===null||r===void 0?void 0:r.pathname)||d!==((a=t.routeInfo)===null||a===void 0?void 0:a.routeOptions))&&(s[l]={originalHref:s[l].originalHref,currentHref:t.routeInfo.pathname+(t.routeInfo.search||""),originalRouteOptions:s[l].originalRouteOptions,currentRouteOptions:(i=t.routeInfo)===null||i===void 0?void 0:i.routeOptions},t.routeInfo.routeAction==="pop"&&l!==c&&(s[c]={originalHref:s[c].originalHref,currentHref:s[c].originalHref,originalRouteOptions:s[c].originalRouteOptions,currentRouteOptions:s[c].currentRouteOptions}))}return l&&t.onSetCurrentTab(l,t.routeInfo),{activeTab:l,tabs:s}}onTabButtonClick(t,n){const r=this.state.tabs[t.detail.tab],a=r.originalHref,i=t.detail.href,{activeTab:s}=this.state;n&&n(t),s===t.detail.tab?a!==i&&this.context.resetTab(t.detail.tab,a,r.originalRouteOptions):(this.props.onIonTabsWillChange&&this.props.onIonTabsWillChange(new CustomEvent("ionTabWillChange",{detail:{tab:t.detail.tab}})),this.props.onIonTabsDidChange&&this.props.onIonTabsDidChange(new CustomEvent("ionTabDidChange",{detail:{tab:t.detail.tab}})),this.setActiveTabOnContext(t.detail.tab),this.context.changeTab(t.detail.tab,i,t.detail.routeOptions))}renderTabButton(t){return n=>{var r,a;if(n!=null&&n.props&&(n.type===h1||n.type.isTabButton)){const i=n.props.tab===t?(r=this.props.routeInfo)===null||r===void 0?void 0:r.pathname:this.state.tabs[n.props.tab].currentHref,s=n.props.tab===t?(a=this.props.routeInfo)===null||a===void 0?void 0:a.routeOptions:this.state.tabs[n.props.tab].currentRouteOptions;return oe.cloneElement(n,{href:i,routeOptions:s,onClick:o=>this.onTabButtonClick(o,n.props.onClick)})}return null}}render(){const{activeTab:t}=this.state;return oe.createElement(cY,Object.assign({},this.props,{selectedTab:t}),oe.Children.map(this.props.children,this.renderTabButton(t)))}static get contextType(){return zs}}const IY=oe.memo(e=>{var{forwardedRef:t}=e,n=Sr(e,["forwardedRef"]);const r=_e.useContext(zs);return oe.createElement(SY,Object.assign({ref:t},n,{routeInfo:n.routeInfo||r.routeInfo||{pathname:window.location.pathname},onSetCurrentTab:r.setCurrentTab}),n.children)});vu(IY,"IonTabBar");class $Y extends vY{constructor(){super()}}typeof window<"u"&&window.customElements&&(window.customElements.get("ion-tabs")||window.customElements.define("ion-tabs",$Y));class CY extends oe.PureComponent{constructor(t){super(t),this.props.name&&console.warn('In Ionic React, you import icons from "ionicons/icons" and set the icon you imported to the "icon" property. Setting the "name" property has no effect.')}render(){var t,n;const r=this.props,{icon:a,ios:i,md:s,mode:o}=r,l=Sr(r,["icon","ios","md","mode"]);let c;const u=T$(),d=o||(u==null?void 0:u.get("mode"));return i||s?d==="ios"?c=(t=i!=null?i:s)!==null&&t!==void 0?t:a:c=(n=s!=null?s:i)!==null&&n!==void 0?n:a:c=a,oe.createElement(pY,Object.assign({ref:this.props.forwardedRef,icon:c},l),this.props.children)}static get contextType(){return zs}}vu(CY,"IonIcon");class _$ extends oe.PureComponent{render(){const t=this.context.getIonRoute();return!this.context.hasIonicRouter()||!_$?(console.error("You either do not have an Ionic Router package, or your router does not support using <IonRoute>"),null):oe.createElement(t,Object.assign({},this.props))}static get contextType(){return zs}}class PL extends oe.PureComponent{render(){const t=this.context.getIonRedirect();return!this.context.hasIonicRouter()||!PL?(console.error("You either do not have an Ionic Router package, or your router does not support using <IonRedirect>"),null):oe.createElement(t,Object.assign({},this.props))}static get contextType(){return zs}}const EY=oe.createContext({routeInfo:void 0,push:()=>{throw new Error("An Ionic Router is required for IonRouterContext")},back:()=>{throw new Error("An Ionic Router is required for IonRouterContext")},canGoBack:()=>{throw new Error("An Ionic Router is required for IonRouterContext")},nativeBack:()=>{throw new Error("An Ionic Router is required for IonRouterContext")}});class YPe extends oe.PureComponent{constructor(t){super(t),this.nodes=new Map,this.animation=pn(t.id)}setupAnimation(t){const n=this.animation;this.nodes.size>0&&n.addElement(Array.from(this.nodes.values())),zA(n,t),BA(n,t)}componentDidMount(){const t=this.props;this.setupAnimation(t)}componentDidUpdate(t){const n=this.animation,r=this.props;zA(n,r,t),TY(n,r,t),BA(n,r,t)}render(){const{children:t}=this.props;return oe.createElement(oe.Fragment,null,oe.Children.map(t,(n,r)=>oe.cloneElement(n,{ref:a=>this.nodes.set(r,a)})))}}const zA=(e,t={},n={})=>{const r=["children","progressStart","progressStep","progressEnd","pause","stop","destroy","play","from","to","fromTo","onFinish"];for(const l in t)t.hasOwnProperty(l)&&!r.includes(l)&&t[l]!==n[l]&&e[l](t[l]);const a=t.from;a&&a!==n.from&&(Array.isArray(a)?a:[a]).forEach(c=>e.from(c.property,c.value));const i=t.to;i&&i!==n.to&&(Array.isArray(i)?i:[i]).forEach(c=>e.to(c.property,c.value));const s=t.fromTo;s&&s!==n.fromTo&&(Array.isArray(s)?s:[s]).forEach(c=>e.fromTo(c.property,c.fromValue,c.toValue));const o=t.onFinish;o&&o!==n.onFinish&&(Array.isArray(o)?o:[o]).forEach(c=>e.onFinish(c.callback,c.opts))},TY=(e,t={},n={})=>{var r,a,i,s,o;const{progressStart:l,progressStep:c,progressEnd:u}=t;l&&(((r=n.progressStart)===null||r===void 0?void 0:r.forceLinearEasing)!==(l==null?void 0:l.forceLinearEasing)||((a=n.progressStart)===null||a===void 0?void 0:a.step)!==(l==null?void 0:l.step))&&e.progressStart(l.forceLinearEasing,l.step),c&&((i=n.progressStep)===null||i===void 0?void 0:i.step)!==(c==null?void 0:c.step)&&e.progressStep(c.step),u&&(((s=n.progressEnd)===null||s===void 0?void 0:s.playTo)!==(u==null?void 0:u.playTo)||((o=n.progressEnd)===null||o===void 0?void 0:o.step)!==(u==null?void 0:u.step)||(n==null?void 0:n.dur)!==(u==null?void 0:u.dur))&&e.progressEnd(u.playTo,u.step,u.dur)},BA=(e,t={},n={})=>{!n.play&&t.play&&e.play(),!n.pause&&t.pause&&e.pause(),!n.stop&&t.stop&&e.stop(),!n.destroy&&t.destroy&&e.destroy()},WA={main:0},gv=(e="main")=>{var t;const n=((t=WA[e])!==null&&t!==void 0?t:0)+1;return WA[e]=n,n.toString()},zL=(e={})=>{typeof document<"u"&&document.documentElement.classList.add("ion-ce"),bK(Object.assign({},e))},BL=oe.createContext({addViewItem:()=>{},canGoBack:()=>{},clearOutlet:()=>{},createViewItem:()=>{},findViewItemByPathname:()=>{},findLeavingViewItemByRouteInfo:()=>{},findViewItemByRouteInfo:()=>{},getChildrenToRender:()=>{},goBack:()=>{},unMountViewItem:()=>{}});class UA extends oe.Component{constructor(t){super(t),this.ionLifeCycleContext=new K9,this._isMounted=!1,this.ionLifeCycleContext.onComponentCanBeDestroyed(()=>{this.props.mount||this._isMounted&&this.setState({show:!1},()=>this.props.removeView())}),this.state={show:!0}}componentDidMount(){this._isMounted=!0}componentWillUnmount(){this._isMounted=!1}render(){const{show:t}=this.state;return oe.createElement($$.Provider,{value:this.ionLifeCycleContext},t&&this.props.children)}}class NY{constructor(){this.locationHistory=[],this.tabHistory={}}add(t){t.routeAction==="push"||t.routeAction==null?this._add(t):t.routeAction==="pop"?this._pop(t):t.routeAction==="replace"&&this._replace(t),t.routeDirection==="root"&&(this._clear(),this._add(t))}clearTabStack(t){const n=this._getRouteInfosByKey(t);n&&(n.forEach(r=>{this.locationHistory=this.locationHistory.filter(a=>a.id!==r.id)}),this.tabHistory[t]=[])}update(t){const n=this.locationHistory.findIndex(a=>a.id===t.id);n>-1&&this.locationHistory.splice(n,1,t);const r=this.tabHistory[t.tab||""];if(r){const a=r.findIndex(i=>i.id===t.id);a>-1?r.splice(a,1,t):r.push(t)}else t.tab&&(this.tabHistory[t.tab]=[t])}_add(t){const n=this._getRouteInfosByKey(t.tab);n&&(this._areRoutesEqual(n[n.length-1],t)&&n.pop(),n.push(t)),this.locationHistory.push(t)}_areRoutesEqual(t,n){return!t||!n?!1:t.pathname===n.pathname&&t.search===n.search}_pop(t){const n=this._getRouteInfosByKey(t.tab);n&&(n.pop(),n.pop(),n.push(t)),this.locationHistory.pop(),this.locationHistory.pop(),this.locationHistory.push(t)}_replace(t){const n=this._getRouteInfosByKey(t.tab);n&&n.pop(),this.locationHistory.pop(),this._add(t)}_clear(){Object.keys(this.tabHistory).forEach(n=>this.tabHistory[n]=[]),this.locationHistory=[]}_getRouteInfosByKey(t){let n;return t&&(n=this.tabHistory[t],n||(n=this.tabHistory[t]=[])),n}getFirstRouteInfoForTab(t){const n=this._getRouteInfosByKey(t);if(n)return n[0]}getCurrentRouteInfoForTab(t){const n=this._getRouteInfosByKey(t);if(n)return n[n.length-1]}findLastLocation(t){const n=this._getRouteInfosByKey(t.tab);if(n)for(let r=n.length-2;r>=0;r--){const a=n[r];if(a&&a.pathname===t.pushedByRoute)return a}for(let r=this.locationHistory.length-2;r>=0;r--){const a=this.locationHistory[r];if(a&&a.pathname===t.pushedByRoute)return a}}previous(){return this.locationHistory[this.locationHistory.length-2]||this.locationHistory[this.locationHistory.length-1]}current(){return this.locationHistory[this.locationHistory.length-1]}canGoBack(){return this.locationHistory.length>1}}class _Y extends oe.PureComponent{constructor(t){super(t),this.ionRouterContextValue={push:(n,r,a,i,s)=>{this.navigate(n,r,a,s,i)},back:n=>{this.goBack(void 0,n)},canGoBack:()=>this.props.locationHistory.canGoBack(),nativeBack:()=>this.props.onNativeBack(),routeInfo:this.props.routeInfo},this.state={goBack:this.goBack.bind(this),hasIonicRouter:()=>!0,navigate:this.navigate.bind(this),getIonRedirect:this.getIonRedirect.bind(this),getIonRoute:this.getIonRoute.bind(this),getStackManager:this.getStackManager.bind(this),getPageManager:this.getPageManager.bind(this),routeInfo:this.props.routeInfo,setCurrentTab:this.props.onSetCurrentTab,changeTab:this.props.onChangeTab,resetTab:this.props.onResetTab}}componentDidMount(){typeof document<"u"&&(this.handleHardwareBackButton=this.handleHardwareBackButton.bind(this),document.addEventListener("ionBackButton",this.handleHardwareBackButton))}componentWillUnmount(){typeof document<"u"&&document.removeEventListener("ionBackButton",this.handleHardwareBackButton)}handleHardwareBackButton(t){t.detail.register(0,n=>{this.nativeGoBack(),n()})}goBack(t,n){this.props.onNavigateBack(t,n)}nativeGoBack(){this.props.onNativeBack()}navigate(t,n="forward",r="push",a,i,s){this.props.onNavigate(t,r,n,a,i,s)}getPageManager(){return LL}getIonRedirect(){return this.props.ionRedirect}getIonRoute(){return this.props.ionRoute}getStackManager(){return this.props.stackManager}render(){return oe.createElement(zs.Provider,{value:Object.assign(Object.assign({},this.state),{routeInfo:this.props.routeInfo})},oe.createElement(EY.Provider,{value:Object.assign(Object.assign({},this.ionRouterContextValue),{routeInfo:this.props.routeInfo})},this.props.children))}}class AY{constructor(){this.viewStacks={},this.add=this.add.bind(this),this.clear=this.clear.bind(this),this.getViewItemsForOutlet=this.getViewItemsForOutlet.bind(this),this.remove=this.remove.bind(this)}add(t){const{outletId:n}=t;this.viewStacks[n]?this.viewStacks[n].push(t):this.viewStacks[n]=[t]}clear(t){return setTimeout(()=>{delete this.viewStacks[t]},500)}getViewItemsForOutlet(t){return this.viewStacks[t]||[]}remove(t){const{outletId:n}=t,r=this.viewStacks[n];if(r){const a=r.find(i=>i.id===t.id);a&&(a.mount=!1,this.viewStacks[n]=r.filter(i=>i.id!==a.id))}}getStackIds(){return Object.keys(this.viewStacks)}getAllViewItems(){const t=this.getStackIds(),n=[];return t.forEach(r=>{n.push(...this.viewStacks[r])}),n}}class RY extends oe.PureComponent{render(){return oe.createElement(gl,Object.assign({path:this.props.path,exact:this.props.exact,render:this.props.render},this.props.computedMatch!==void 0?{computedMatch:this.props.computedMatch}:{}))}}class DY extends AY{constructor(){super(),this.createViewItem=this.createViewItem.bind(this),this.findViewItemByRouteInfo=this.findViewItemByRouteInfo.bind(this),this.findLeavingViewItemByRouteInfo=this.findLeavingViewItemByRouteInfo.bind(this),this.getChildrenToRender=this.getChildrenToRender.bind(this),this.findViewItemByPathname=this.findViewItemByPathname.bind(this)}createViewItem(t,n,r,a){const i={id:gv("viewItem"),outletId:t,ionPageElement:a,reactElement:n,mount:!0,ionRoute:!1},s={exact:n.props.exact,path:n.props.path||n.props.from,component:n.props.component},o=jl(r.pathname,s);return n.type===_$&&(i.ionRoute=!0,i.disableIonPageManagement=n.props.disableIonPageManagement),i.routeData={match:o,childProps:n.props},i}getChildrenToRender(t,n,r){const a=this.getViewItemsForOutlet(t);return oe.Children.forEach(n.props.children,s=>{const o=a.find(l=>VA(s,l.routeData.childProps.path||l.routeData.childProps.from));o&&(o.reactElement=s)}),a.map(s=>{let o;if(s.ionRoute&&!s.disableIonPageManagement)o=oe.createElement(UA,{key:"view-".concat(s.id),mount:s.mount,removeView:()=>this.remove(s)},oe.cloneElement(s.reactElement,{computedMatch:s.routeData.match}));else{const l=VA(s.reactElement,r.pathname);o=oe.createElement(UA,{key:"view-".concat(s.id),mount:s.mount,removeView:()=>this.remove(s)},oe.cloneElement(s.reactElement,{computedMatch:s.routeData.match})),!l&&s.routeData.match&&(s.routeData.match=void 0,s.mount=!1)}return o})}findViewItemByRouteInfo(t,n,r){const{viewItem:a,match:i}=this.findViewItemByPath(t.pathname,n);return(r===void 0||r===!0)&&a&&i&&(a.routeData.match=i),a}findLeavingViewItemByRouteInfo(t,n,r=!0){const{viewItem:a}=this.findViewItemByPath(t.lastPathname,n,!1,r);return a}findViewItemByPathname(t,n){const{viewItem:r}=this.findViewItemByPath(t,n);return r}findViewItemByPath(t,n,r,a){let i,s,o;if(n)o=this.getViewItemsForOutlet(n),o.some(l),i||o.some(c);else{const u=this.getAllViewItems();u.some(l),i||u.some(c)}return{viewItem:i,match:s};function l(u){if(a&&!u.ionRoute)return!1;const d={exact:r?!0:u.routeData.childProps.exact,path:u.routeData.childProps.path||u.routeData.childProps.from,component:u.routeData.childProps.component},p=jl(t,d);return p?(i=u,s=p,!0):!1}function c(u){return!u.routeData.childProps.path&&!u.routeData.childProps.from?(s={path:t,url:t,isExact:!0,params:{}},i=u,!0):!1}}}function VA(e,t,n){const r={exact:n?!0:e.props.exact,path:e.props.path||e.props.from,component:e.props.component};return jl(t,r)}function FY(e){let t;if(typeof e=="string"?t=e:t=e.outerHTML,document){const n=document.createElement("div");n.innerHTML=t,n.style.zIndex="";const r=n.getElementsByTagName("ion-back-button");return r[0]&&r[0].remove(),n.firstChild}}const HA=e=>!e.classList.contains("ion-page-invisible")&&!e.classList.contains("ion-page-hidden");class MY extends oe.PureComponent{constructor(t){super(t),this.stackContextValue={registerIonPage:this.registerIonPage.bind(this),isInOutlet:()=>!0},this.pendingPageTransition=!1,this.registerIonPage=this.registerIonPage.bind(this),this.transitionPage=this.transitionPage.bind(this),this.handlePageTransition=this.handlePageTransition.bind(this),this.id=gv("routerOutlet"),this.prevProps=void 0,this.skipTransition=!1}componentDidMount(){this.clearOutletTimeout&&clearTimeout(this.clearOutletTimeout),this.routerOutletElement&&(this.setupRouterOutlet(this.routerOutletElement),this.handlePageTransition(this.props.routeInfo))}componentDidUpdate(t){const{pathname:n}=this.props.routeInfo,{pathname:r}=t.routeInfo;n!==r?(this.prevProps=t,this.handlePageTransition(this.props.routeInfo)):this.pendingPageTransition&&(this.handlePageTransition(this.props.routeInfo),this.pendingPageTransition=!1)}componentWillUnmount(){this.clearOutletTimeout=this.context.clearOutlet(this.id)}async handlePageTransition(t){var n,r;if(!this.routerOutletElement||!this.routerOutletElement.commit)this.pendingPageTransition=!0;else{let a=this.context.findViewItemByRouteInfo(t,this.id),i=this.context.findLeavingViewItemByRouteInfo(t,this.id);!i&&t.prevRouteLastPathname&&(i=this.context.findViewItemByPathname(t.prevRouteLastPathname,this.id)),i&&(t.routeAction==="replace"?i.mount=!1:t.routeAction==="push"&&t.routeDirection==="forward"?!((n=t.routeOptions)===null||n===void 0)&&n.unmount&&(i.mount=!1):t.routeDirection!=="none"&&a!==i&&(i.mount=!1));const s=OY((r=this.ionRouterOutlet)===null||r===void 0?void 0:r.props.children,t);if(a?a.reactElement=s:s&&(a=this.context.createViewItem(this.id,s,t),this.context.addViewItem(a)),a&&a.ionPageElement){if(a===i&&a.routeData.match.url!==t.pathname||(!i&&this.props.routeInfo.prevRouteLastPathname&&(i=this.context.findViewItemByPathname(this.props.routeInfo.prevRouteLastPathname,this.id)),HA(a.ionPageElement)&&i!==void 0&&!HA(i.ionPageElement)))return;this.transitionPage(t,a,i)}else i&&!s&&!a&&i.ionPageElement&&(i.ionPageElement.classList.add("ion-page-hidden"),i.ionPageElement.setAttribute("aria-hidden","true"));this.forceUpdate()}}registerIonPage(t,n){const r=this.context.findViewItemByRouteInfo(n,this.id);if(r){const a=r.ionPageElement;if(r.ionPageElement=t,r.ionRoute=!0,a===t)return}this.handlePageTransition(n)}async setupRouterOutlet(t){const n=()=>{const i=T$();if(!(i&&i.get("swipeBackEnabled",t.mode==="ios")))return!1;const{routeInfo:o}=this.props,l=this.prevProps&&this.prevProps.routeInfo.pathname===o.pushedByRoute?this.prevProps.routeInfo:{pathname:o.pushedByRoute||""},c=this.context.findViewItemByRouteInfo(l,this.id,!1);return!!c&&c.mount&&c.routeData.match.path!==o.pathname},r=async()=>{const{routeInfo:i}=this.props,s=this.prevProps&&this.prevProps.routeInfo.pathname===i.pushedByRoute?this.prevProps.routeInfo:{pathname:i.pushedByRoute||""},o=this.context.findViewItemByRouteInfo(s,this.id,!1),l=this.context.findViewItemByRouteInfo(i,this.id,!1);return o&&l&&await this.transitionPage(i,o,l,"back",!0),Promise.resolve()},a=i=>{if(i)this.skipTransition=!0,this.context.goBack();else{const{routeInfo:s}=this.props,o=this.prevProps&&this.prevProps.routeInfo.pathname===s.pushedByRoute?this.prevProps.routeInfo:{pathname:s.pushedByRoute||""},l=this.context.findViewItemByRouteInfo(o,this.id,!1),c=this.context.findViewItemByRouteInfo(s,this.id,!1);if(l!==c&&(l==null?void 0:l.ionPageElement)!==void 0){const{ionPageElement:u}=l;u.setAttribute("aria-hidden","true"),u.classList.add("ion-page-hidden")}}};t.swipeHandler={canStart:n,onStart:r,onEnd:a}}async transitionPage(t,n,r,a,i=!1){const s=async(u,d)=>{const p=this.skipTransition;p?this.skipTransition=!1:(u.classList.add("ion-page"),u.classList.add("ion-page-invisible")),await o.commit(u,d,{duration:p||c===void 0?0:void 0,direction:c,showGoBack:!!t.pushedByRoute,progressAnimation:i,animationBuilder:t.routeAnimation})},o=this.routerOutletElement,l=t.routeDirection==="none"||t.routeDirection==="root"?void 0:t.routeDirection,c=a!=null?a:l;if(n&&n.ionPageElement&&this.routerOutletElement)if(r&&r.ionPageElement&&n===r)if(LY(r.reactElement,t.pathname,!0)){const d=FY(r.ionPageElement.outerHTML);d&&(this.routerOutletElement.appendChild(d),await s(n.ionPageElement,d),this.routerOutletElement.removeChild(d))}else await s(n.ionPageElement,void 0);else await s(n.ionPageElement,r==null?void 0:r.ionPageElement),r&&r.ionPageElement&&!i&&(r.ionPageElement.classList.add("ion-page-hidden"),r.ionPageElement.setAttribute("aria-hidden","true"))}render(){const{children:t}=this.props,n=oe.Children.only(t);this.ionRouterOutlet=n;const r=this.context.getChildrenToRender(this.id,this.ionRouterOutlet,this.props.routeInfo,()=>{this.forceUpdate()});return oe.createElement(N$.Provider,{value:this.stackContextValue},oe.cloneElement(n,{ref:a=>{n.props.setRef&&n.props.setRef(a),n.props.forwardedRef&&(n.props.forwardedRef.current=a),this.routerOutletElement=a;const{ref:i}=n;typeof i=="function"&&i(a)}},r))}static get contextType(){return BL}}function OY(e,t){let n;return oe.Children.forEach(e,r=>{const a={exact:r.props.exact,path:r.props.path||r.props.from,component:r.props.component};jl(t.pathname,a)&&(n=r)}),n||(oe.Children.forEach(e,r=>{r.props.path||r.props.from||(n=r)}),n)}function LY(e,t,n){const r={exact:n?!0:e.props.exact,path:e.props.path||e.props.from,component:e.props.component};return jl(t,r)}class PY extends oe.PureComponent{constructor(t){super(t),this.exitViewFromOtherOutletHandlers=[],this.locationHistory=new NY,this.viewStack=new DY,this.routeMangerContextState={canGoBack:()=>this.locationHistory.canGoBack(),clearOutlet:this.viewStack.clear,findViewItemByPathname:this.viewStack.findViewItemByPathname,getChildrenToRender:this.viewStack.getChildrenToRender,goBack:()=>this.handleNavigateBack(),createViewItem:this.viewStack.createViewItem,findViewItemByRouteInfo:this.viewStack.findViewItemByRouteInfo,findLeavingViewItemByRouteInfo:this.viewStack.findLeavingViewItemByRouteInfo,addViewItem:this.viewStack.add,unMountViewItem:this.viewStack.remove};const n={id:gv("routeInfo"),pathname:this.props.location.pathname,search:this.props.location.search};this.locationHistory.add(n),this.handleChangeTab=this.handleChangeTab.bind(this),this.handleResetTab=this.handleResetTab.bind(this),this.handleNativeBack=this.handleNativeBack.bind(this),this.handleNavigate=this.handleNavigate.bind(this),this.handleNavigateBack=this.handleNavigateBack.bind(this),this.props.registerHistoryListener(this.handleHistoryChange.bind(this)),this.handleSetCurrentTab=this.handleSetCurrentTab.bind(this),this.state={routeInfo:n}}handleChangeTab(t,n,r){if(!n)return;const a=this.locationHistory.getCurrentRouteInfoForTab(t),[i,s]=n.split("?");a?(this.incomingRouteParams=Object.assign(Object.assign({},a),{routeAction:"push",routeDirection:"none"}),a.pathname===i?(this.incomingRouteParams.routeOptions=r,this.props.history.push(a.pathname+(a.search||""))):(this.incomingRouteParams.pathname=i,this.incomingRouteParams.search=s?"?"+s:void 0,this.incomingRouteParams.routeOptions=r,this.props.history.push(i+(s?"?"+s:"")))):this.handleNavigate(i,"push","none",void 0,r,t)}handleHistoryChange(t,n){var r,a,i;let s;if(this.incomingRouteParams?this.incomingRouteParams.routeAction==="replace"?s=this.locationHistory.previous():s=this.locationHistory.current():s=this.locationHistory.current(),s.pathname+s.search!==t.pathname){if(!this.incomingRouteParams){if(n==="REPLACE"&&(this.incomingRouteParams={routeAction:"replace",routeDirection:"none",tab:this.currentTab}),n==="POP"){const c=this.locationHistory.current();if(c&&c.pushedByRoute){const u=this.locationHistory.findLastLocation(c);this.incomingRouteParams=Object.assign(Object.assign({},u),{routeAction:"pop",routeDirection:"back"})}else this.incomingRouteParams={routeAction:"pop",routeDirection:"none",tab:this.currentTab}}this.incomingRouteParams||(this.incomingRouteParams={routeAction:"push",routeDirection:((r=t.state)===null||r===void 0?void 0:r.direction)||"forward",routeOptions:(a=t.state)===null||a===void 0?void 0:a.routerOptions,tab:this.currentTab})}let l;if(!((i=this.incomingRouteParams)===null||i===void 0)&&i.id)l=Object.assign(Object.assign({},this.incomingRouteParams),{lastPathname:s.pathname}),this.locationHistory.add(l);else{const c=this.incomingRouteParams.routeAction==="push"&&this.incomingRouteParams.routeDirection==="forward";if(l=Object.assign(Object.assign({id:gv("routeInfo")},this.incomingRouteParams),{lastPathname:s.pathname,pathname:t.pathname,search:t.search,params:this.props.match.params,prevRouteLastPathname:s.lastPathname}),c)l.tab=s.tab,l.pushedByRoute=s.pathname;else if(l.routeAction==="pop"){const u=this.locationHistory.findLastLocation(l);l.pushedByRoute=u==null?void 0:u.pushedByRoute}else if(l.routeAction==="push"&&l.tab!==s.tab){const u=this.locationHistory.getCurrentRouteInfoForTab(l.tab);l.pushedByRoute=u==null?void 0:u.pushedByRoute}else if(l.routeAction==="replace"){const u=this.locationHistory.current(),d=u==null?void 0:u.pushedByRoute,p=d!==void 0&&d!==l.pathname?d:l.pushedByRoute;l.lastPathname=(u==null?void 0:u.pathname)||l.lastPathname,l.prevRouteLastPathname=u==null?void 0:u.lastPathname,l.pushedByRoute=p,l.routeDirection=(u==null?void 0:u.routeDirection)||l.routeDirection,l.routeAnimation=(u==null?void 0:u.routeAnimation)||l.routeAnimation}this.locationHistory.add(l)}this.setState({routeInfo:l})}this.incomingRouteParams=void 0}handleNativeBack(){const t=this.props.history;(t.goBack||t.back)()}handleNavigate(t,n,r,a,i,s){this.incomingRouteParams=Object.assign(this.incomingRouteParams||{},{routeAction:n,routeDirection:r,routeOptions:i,routeAnimation:a,tab:s}),n==="push"?this.props.history.push(t):this.props.history.replace(t)}handleNavigateBack(t="/",n){const r=T$();t=t||r&&r.get("backButtonDefaultHref");const a=this.locationHistory.current();if(a&&a.pushedByRoute){const i=this.locationHistory.findLastLocation(a);if(i)if(this.incomingRouteParams=Object.assign(Object.assign({},i),{routeAction:"pop",routeDirection:"back",routeAnimation:n||a.routeAnimation}),a.lastPathname===a.pushedByRoute||i.pathname===a.pushedByRoute&&a.tab===""&&i.tab===""){const s=this.props.history;(s.goBack||s.back)()}else this.handleNavigate(i.pathname+(i.search||""),"pop","back");else this.handleNavigate(t,"pop","back")}else this.handleNavigate(t,"pop","back")}handleResetTab(t,n,r){const a=this.locationHistory.getFirstRouteInfoForTab(t);if(a){const i=Object.assign({},a);i.pathname=n,i.routeOptions=r,this.incomingRouteParams=Object.assign(Object.assign({},i),{routeAction:"pop",routeDirection:"back"}),this.props.history.push(i.pathname+(i.search||""))}}handleSetCurrentTab(t){this.currentTab=t;const n=Object.assign({},this.locationHistory.current());n.tab!==t&&(n.tab=t,this.locationHistory.update(n))}render(){return oe.createElement(BL.Provider,{value:this.routeMangerContextState},oe.createElement(_Y,{ionRoute:RY,ionRedirect:{},stackManager:MY,routeInfo:this.state.routeInfo,onNativeBack:this.handleNativeBack,onNavigateBack:this.handleNavigateBack,onNavigate:this.handleNavigate,onSetCurrentTab:this.handleSetCurrentTab,onChangeTab:this.handleChangeTab,onResetTab:this.handleResetTab,locationHistory:this.locationHistory},this.props.children))}}const H0=T8(PY);H0.displayName="IonRouter";class zY extends oe.Component{constructor(t){super(t);const{history:n}=t,r=Sr(t,["history"]);this.history=n||A5(r),this.history.listen(this.handleHistoryChange.bind(this)),this.registerHistoryListener=this.registerHistoryListener.bind(this)}handleHistoryChange(t,n){const r=t.location||t,a=t.action||n;this.historyListenHandler&&this.historyListenHandler(r,a)}registerHistoryListener(t){this.historyListenHandler=t}render(){const t=this.props,{children:n}=t,r=Sr(t,["children"]);return oe.createElement(Km,Object.assign({history:this.history},r),oe.createElement(H0,{registerHistoryListener:this.registerHistoryListener},n))}}class ZPe extends oe.Component{constructor(t){super(t),this.history=t.history,this.history.listen(this.handleHistoryChange.bind(this)),this.registerHistoryListener=this.registerHistoryListener.bind(this)}handleHistoryChange(t,n){const r=t.location||t,a=t.action||n;this.historyListenHandler&&this.historyListenHandler(r,a)}registerHistoryListener(t){this.historyListenHandler=t}render(){const t=this.props,{children:n}=t,r=Sr(t,["children"]);return oe.createElement(Km,Object.assign({},r),oe.createElement(H0,{registerHistoryListener:this.registerHistoryListener},n))}}class QPe extends oe.Component{constructor(t){super(t);const{history:n}=t,r=Sr(t,["history"]);this.history=n||F5(r),this.history.listen(this.handleHistoryChange.bind(this)),this.registerHistoryListener=this.registerHistoryListener.bind(this)}handleHistoryChange(t,n){const r=t.location||t,a=t.action||n;this.historyListenHandler&&this.historyListenHandler(r,a)}registerHistoryListener(t){this.historyListenHandler=t}render(){const t=this.props,{children:n}=t,r=Sr(t,["children"]);return oe.createElement(Km,Object.assign({history:this.history},r),oe.createElement(H0,{registerHistoryListener:this.registerHistoryListener},n))}}var BY=Object.defineProperty,WY=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,n)=>(typeof require<"u"?require:t)[n]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')}),A$=(e,t)=>{for(var n in t)BY(e,n,{get:t[n],enumerable:!0})},UY={};A$(UY,{Abs:()=>Rp,Acos:()=>wu,Acosh:()=>ku,AdadeltaOptimizer:()=>ZC,AdagradOptimizer:()=>QC,AdamOptimizer:()=>JC,AdamaxOptimizer:()=>eE,Add:()=>Go,AddN:()=>Su,All:()=>Dp,Any:()=>Fp,ArgMax:()=>Mp,ArgMin:()=>Op,Asin:()=>Iu,Asinh:()=>$u,Atan:()=>Cu,Atan2:()=>Tu,Atanh:()=>Eu,AvgPool:()=>Nu,AvgPool3D:()=>Lp,AvgPool3DGrad:()=>rg,AvgPoolGrad:()=>ng,BackendWasm:()=>TH,BatchMatMul:()=>_u,BatchToSpaceND:()=>Pp,Bincount:()=>zp,BitwiseAnd:()=>Bp,BroadcastArgs:()=>ag,BroadcastTo:()=>tP,Callback:()=>RB,CallbackList:()=>Fz,Cast:()=>Au,Ceil:()=>Ru,ClipByValue:()=>qo,Complex:()=>X0,ComplexAbs:()=>ig,Concat:()=>Wp,Conv2D:()=>Du,Conv2DBackpropFilter:()=>Y0,Conv2DBackpropInput:()=>Fu,Conv3D:()=>Mu,Conv3DBackpropFilterV2:()=>Up,Conv3DBackpropInputV2:()=>Vp,Cos:()=>Ou,Cosh:()=>Lu,CropAndResize:()=>jp,Cumprod:()=>Hp,Cumsum:()=>Pu,CustomCallback:()=>Oz,DataStorage:()=>G0,DenseBincount:()=>sg,DepthToSpace:()=>Gp,DepthwiseConv2dNative:()=>zu,DepthwiseConv2dNativeBackpropFilter:()=>Z0,DepthwiseConv2dNativeBackpropInput:()=>Q0,Diag:()=>og,Dilation2D:()=>Bu,Dilation2DBackpropFilter:()=>ap,Dilation2DBackpropInput:()=>rp,Draw:()=>P$,ENV:()=>O$,EarlyStopping:()=>DB,Einsum:()=>J0,Elu:()=>Uu,EluGrad:()=>qp,Environment:()=>JL,Equal:()=>Kp,Erf:()=>Vu,Exp:()=>Hu,ExpandDims:()=>Xp,Expm1:()=>ju,FFT:()=>ex,Fill:()=>lg,FlipLeftRight:()=>Yp,Floor:()=>Gu,FloorDiv:()=>qu,FromPixels:()=>xv,FusedBatchNorm:()=>Ku,FusedConv2D:()=>Zl,FusedDepthwiseConv2D:()=>Ql,GPGPUContext:()=>Eb,GatherNd:()=>Qp,GatherV2:()=>Zp,GraphModel:()=>z2,Greater:()=>Jp,GreaterEqual:()=>Xu,History:()=>Mz,IFFT:()=>tx,Identity:()=>Yu,Imag:()=>nx,InputSpec:()=>dn,IsFinite:()=>Zu,IsInf:()=>Qu,IsNan:()=>Ju,KernelBackend:()=>eg,LRN:()=>rc,LRNGrad:()=>sh,LayerVariable:()=>Ez,LayersModel:()=>Ts,LeakyRelu:()=>ec,Less:()=>eh,LessEqual:()=>th,LinSpace:()=>nh,Log:()=>tc,Log1p:()=>nc,LogSoftmax:()=>rP,LogicalAnd:()=>rh,LogicalNot:()=>ah,LogicalOr:()=>ih,LogicalXor:()=>nP,LowerBound:()=>DZ,MathBackendCPU:()=>lw,MathBackendWebGL:()=>dw,MatrixBandPart:()=>FZ,Max:()=>ac,MaxPool:()=>sc,MaxPool3D:()=>oh,MaxPool3DGrad:()=>cg,MaxPoolGrad:()=>ug,MaxPoolWithArgmax:()=>dg,Maximum:()=>ic,Mean:()=>oc,Min:()=>lc,Minimum:()=>uc,MirrorPad:()=>cc,Mod:()=>dc,MomentumOptimizer:()=>tE,Multinomial:()=>lh,Multiply:()=>pc,Neg:()=>uh,NonMaxSuppressionV3:()=>dh,NonMaxSuppressionV4:()=>ph,NonMaxSuppressionV5:()=>hh,NotEqual:()=>ch,OP_SCOPE_SUFFIX:()=>W$,OneHot:()=>hc,OnesLike:()=>fh,Optimizer:()=>Hs,OptimizerConstructors:()=>cz,Pack:()=>mh,PadV2:()=>fc,Pool:()=>MZ,Pow:()=>mc,Prelu:()=>gc,Prod:()=>yc,RMSPropOptimizer:()=>nE,RNN:()=>cs,RaggedGather:()=>rx,RaggedRange:()=>ax,RaggedTensorToTensor:()=>ix,Range:()=>pg,Rank:()=>Xk,Real:()=>sx,RealDiv:()=>Wu,Reciprocal:()=>bc,Reduction:()=>vr,Relu:()=>vc,Relu6:()=>kc,Reshape:()=>gh,ResizeBilinear:()=>wc,ResizeBilinearGrad:()=>bh,ResizeNearestNeighbor:()=>xc,ResizeNearestNeighborGrad:()=>yh,Reverse:()=>Sc,RotateWithOffset:()=>Dh,Round:()=>Ic,Rsqrt:()=>$c,SGDOptimizer:()=>Ux,ScatterNd:()=>vh,SearchSorted:()=>wh,Select:()=>kh,Selu:()=>Cc,Sequential:()=>gp,Sigmoid:()=>_c,Sign:()=>Nc,Sin:()=>Ec,Sinh:()=>Tc,Slice:()=>Sh,Softmax:()=>Fc,Softplus:()=>Ac,SpaceToBatchND:()=>Ih,SparseFillEmptyRows:()=>hg,SparseReshape:()=>Ch,SparseSegmentMean:()=>fg,SparseSegmentSum:()=>mg,SparseToDense:()=>Eh,SplitV:()=>$h,Sqrt:()=>Rc,Square:()=>gg,SquaredDifference:()=>Mc,StaticRegexReplace:()=>yg,Step:()=>Xo,StridedSlice:()=>Th,StringNGrams:()=>bg,StringSplit:()=>vg,StringToHashBucketFast:()=>xg,Sub:()=>Oc,Sum:()=>Dc,SymbolicTensor:()=>wi,Tan:()=>Lc,Tanh:()=>Pc,Tensor:()=>He,TensorBuffer:()=>hn,TensorScatterUpdate:()=>xh,Tile:()=>Ko,TopK:()=>Nh,Transform:()=>_h,Transpose:()=>Es,Unique:()=>wg,Unpack:()=>Ah,UnsortedSegmentSum:()=>kg,UpperBound:()=>OZ,Variable:()=>Jl,ZerosLike:()=>Rh,_FusedMatMul:()=>Yl,abs:()=>un,acos:()=>j$,acosh:()=>G$,add:()=>ne,addN:()=>NP,all:()=>dx,any:()=>Cm,argMax:()=>nu,argMin:()=>q$,asin:()=>K$,asinh:()=>X$,atan:()=>Y$,atan2:()=>Z$,atanh:()=>Q$,avgPool:()=>Ws,avgPool3d:()=>eC,backend:()=>TP,backend_util:()=>T,basicLSTMCell:()=>DP,batchNorm:()=>zc,batchNorm2d:()=>tC,batchNorm3d:()=>nC,batchNorm4d:()=>rC,batchToSpaceND:()=>Ng,bincount:()=>aC,bitwiseAnd:()=>FP,booleanMaskAsync:()=>I3,broadcastArgs:()=>MP,broadcastTo:()=>Ml,broadcast_util:()=>Fh,browser:()=>Wg,buffer:()=>Ze,callbacks:()=>bpe,cast:()=>de,ceil:()=>iC,clipByValue:()=>lr,clone:()=>es,complex:()=>Ms,concat:()=>wt,concat1d:()=>sC,concat2d:()=>oC,concat3d:()=>lC,concat4d:()=>uC,constraints:()=>_z,conv1d:()=>px,conv2d:()=>$r,conv2dTranspose:()=>hx,conv3d:()=>dC,conv3dTranspose:()=>pC,copyRegisteredKernels:()=>BZ,cos:()=>_g,cosh:()=>fx,cosineWindow:()=>Lx,cumprod:()=>Nm,cumsum:()=>mx,customGrad:()=>as,data:()=>nW,denseBincount:()=>Cv,deprecationWarn:()=>EP,depthToSpace:()=>hC,depthwiseConv2d:()=>Bc,deregisterOp:()=>wpe,device_util:()=>Cg,diag:()=>LP,dilation2d:()=>fC,disableDeprecationWarnings:()=>YQ,dispose:()=>We,disposeVariables:()=>ZQ,div:()=>ke,divNoNan:()=>mC,dot:()=>gC,dropout:()=>GC,einsum:()=>zP,elu:()=>Mh,enableDebugMode:()=>XQ,enableProdMode:()=>KQ,enclosingPowerOfTwo:()=>qC,engine:()=>ja,ensureShape:()=>BP,env:()=>Z,equal:()=>ha,erf:()=>yC,euclideanNorm:()=>xC,exp:()=>Cr,expandDims:()=>Vn,expm1:()=>wC,eye:()=>gx,fft:()=>zg,fill:()=>da,findBackend:()=>aJ,findBackendFactory:()=>iJ,floor:()=>Lh,floorDiv:()=>cx,forceHalfFloat:()=>kU,fused:()=>pp,gather:()=>Ph,gatherND:()=>T3,gather_util:()=>iE,getBackend:()=>nJ,getGradient:()=>qk,getKernel:()=>wv,getKernelsForBackend:()=>kv,getThreadsCount:()=>kMe,gpgpu_util:()=>eU,grad:()=>tte,grads:()=>nte,greater:()=>Dr,greaterEqual:()=>Us,ifft:()=>dp,imag:()=>Ag,image:()=>$a,inTopKAsync:()=>N3,initializers:()=>Az,input:()=>Yz,io:()=>Gn,irfft:()=>_x,isFinite:()=>kC,isInf:()=>SC,isNaN:()=>IC,keep:()=>wn,kernel_impls:()=>us,layers:()=>Rz,leakyRelu:()=>Rg,less:()=>op,lessEqual:()=>Zo,linalg:()=>YC,linspace:()=>jP,loadGraphModel:()=>Ehe,loadGraphModelSync:()=>The,loadLayersModel:()=>fce,localResponseNormalization:()=>$C,log:()=>fa,log1p:()=>Dg,logSigmoid:()=>CC,logSoftmax:()=>bx,logSumExp:()=>vx,logicalAnd:()=>ti,logicalNot:()=>Fg,logicalOr:()=>xx,logicalXor:()=>EC,losses:()=>W3,lowerBound:()=>qP,matMul:()=>Ke,math:()=>Z3,max:()=>_a,maxPool:()=>Rn,maxPool3d:()=>TC,maxPoolWithArgmax:()=>KP,maximum:()=>ls,mean:()=>Gt,memory:()=>$v,meshgrid:()=>XP,metrics:()=>NB,min:()=>sp,minimum:()=>Do,mirrorPad:()=>NC,mod:()=>_C,model:()=>yce,models:()=>_B,moments:()=>Mg,movingAverage:()=>$3,mul:()=>G,multiRNNCell:()=>YP,multinomial:()=>ZP,neg:()=>_t,nextFrame:()=>sE,norm:()=>Oh,notEqual:()=>su,oneHot:()=>lp,ones:()=>oa,onesLike:()=>ma,op:()=>H,outerProduct:()=>QP,pad:()=>Oi,pad1d:()=>JP,pad2d:()=>e3,pad3d:()=>t3,pad4d:()=>n3,pool:()=>AC,pow:()=>Os,prelu:()=>Lg,print:()=>H$,prod:()=>RC,profile:()=>QQ,raggedGather:()=>r3,raggedRange:()=>a3,raggedTensorToTensor:()=>i3,rand:()=>s3,randomGamma:()=>c3,randomNormal:()=>kx,randomStandardNormal:()=>d3,randomUniform:()=>Qo,randomUniformInt:()=>p3,range:()=>ou,ready:()=>tJ,real:()=>up,reciprocal:()=>LC,registerBackend:()=>ux,registerCallbackConstructor:()=>vce,registerGradient:()=>aP,registerKernel:()=>Sg,registerOp:()=>xpe,regularizers:()=>AB,relu:()=>ft,relu6:()=>Sx,removeBackend:()=>rJ,reshape:()=>q,reverse:()=>Da,reverse1d:()=>h3,reverse2d:()=>f3,reverse3d:()=>m3,reverse4d:()=>g3,rfft:()=>Bg,round:()=>Ix,rsqrt:()=>$x,scalar:()=>Ae,scatterND:()=>C3,scatter_util:()=>Dx,searchSorted:()=>wx,selu:()=>Cx,separableConv2d:()=>zh,sequential:()=>bce,serialization:()=>le,setBackend:()=>eJ,setPlatform:()=>sJ,setThreadsCount:()=>wMe,setWasmPath:()=>vMe,setWasmPaths:()=>xMe,setWebGLContext:()=>I4,setdiff1dAsync:()=>y3,shared:()=>V2,sigmoid:()=>Qa,sign:()=>PC,signal:()=>B3,sin:()=>Ex,sinh:()=>Tx,slice:()=>et,slice1d:()=>Pg,slice2d:()=>Nx,slice3d:()=>Bh,slice4d:()=>cp,slice_util:()=>In,softmax:()=>Jo,softplus:()=>Wc,spaceToBatchND:()=>Og,sparse:()=>U3,sparseToDense:()=>E3,spectral:()=>z3,split:()=>Ur,sqrt:()=>Kn,square:()=>vt,squaredDifference:()=>Ax,squeeze:()=>el,stack:()=>Sn,step:()=>Uc,stridedSlice:()=>zC,string:()=>V3,sub:()=>xe,sum:()=>Se,sumOutType:()=>lx,tan:()=>BC,tanh:()=>au,tensor:()=>wr,tensor1d:()=>ht,tensor2d:()=>ts,tensor3d:()=>Rx,tensor4d:()=>Fo,tensor5d:()=>b3,tensor6d:()=>v3,tensorScatterUpdate:()=>w3,tensor_util:()=>Ei,test_util:()=>o3,tidy:()=>K,tile:()=>sa,time:()=>JQ,topk:()=>UC,train:()=>bl,transpose:()=>Ye,truncatedNormal:()=>Mx,unique:()=>VC,unregisterGradient:()=>zZ,unregisterKernel:()=>PZ,unsortedSegmentSum:()=>Ox,unstack:()=>en,upcastType:()=>Ra,upperBound:()=>k3,util:()=>k,valueAndGrad:()=>rte,valueAndGrads:()=>ate,variable:()=>HC,variableGrads:()=>GP,version:()=>NMe,version_converter:()=>_he,version_core:()=>Sie,version_cpu:()=>Tme,version_layers:()=>TE,version_wasm:()=>SMe,version_webgl:()=>y1e,webgl:()=>b1e,webgl_util:()=>S4,where:()=>Pn,whereAsync:()=>jC,zeros:()=>qt,zerosLike:()=>nt});var VY=Object.create,R$=Object.defineProperty,HY=Object.getOwnPropertyDescriptor,jY=Object.getOwnPropertyNames,GY=Object.getPrototypeOf,qY=Object.prototype.hasOwnProperty,mn=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Ue=(e,t)=>{for(var n in t)R$(e,n,{get:t[n],enumerable:!0})},KY=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of jY(t))!qY.call(e,a)&&a!==n&&R$(e,a,{get:()=>t[a],enumerable:!(r=HY(t,a))||r.enumerable});return e},jo=(e,t,n)=>(n=e!=null?VY(GY(e)):{},KY(t||!e||!e.__esModule?R$(n,"default",{value:e,enumerable:!0}):n,e)),XY=mn((e,t)=>{t.exports=r;var n=null;try{n=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(I){}function r(I,O,P){this.low=I|0,this.high=O|0,this.unsigned=!!P}r.prototype.__isLong__,Object.defineProperty(r.prototype,"__isLong__",{value:!0});function a(I){return(I&&I.__isLong__)===!0}r.isLong=a;var i={},s={};function o(I,O){var P,L,U;return O?(I>>>=0,(U=0<=I&&I<256)&&(L=s[I],L)?L:(P=c(I,(I|0)<0?-1:0,!0),U&&(s[I]=P),P)):(I|=0,(U=-128<=I&&I<128)&&(L=i[I],L)?L:(P=c(I,I<0?-1:0,!1),U&&(i[I]=P),P))}r.fromInt=o;function l(I,O){if(isNaN(I))return O?x:v;if(O){if(I<0)return x;if(I>=g)return _}else{if(I<=-y)return R;if(I+1>=y)return E}return I<0?l(-I,O).neg():c(I%m|0,I/m|0,O)}r.fromNumber=l;function c(I,O,P){return new r(I,O,P)}r.fromBits=c;var u=Math.pow;function d(I,O,P){if(I.length===0)throw Error("empty string");if(I==="NaN"||I==="Infinity"||I==="+Infinity"||I==="-Infinity")return v;if(typeof O=="number"?(P=O,O=!1):O=!!O,P=P||10,P<2||36<P)throw RangeError("radix");var L;if((L=I.indexOf("-"))>0)throw Error("interior hyphen");if(L===0)return d(I.substring(1),O,P).neg();for(var U=l(u(P,8)),D=v,F=0;F<I.length;F+=8){var z=Math.min(8,I.length-F),B=parseInt(I.substring(F,F+z),P);if(z<8){var j=l(u(P,z));D=D.mul(j).add(l(B))}else D=D.mul(U),D=D.add(l(B))}return D.unsigned=O,D}r.fromString=d;function p(I,O){return typeof I=="number"?l(I,O):typeof I=="string"?d(I,O):c(I.low,I.high,typeof O=="boolean"?O:I.unsigned)}r.fromValue=p;var h=65536,f=1<<24,m=h*h,g=m*m,y=g/2,b=o(f),v=o(0);r.ZERO=v;var x=o(0,!0);r.UZERO=x;var w=o(1);r.ONE=w;var $=o(1,!0);r.UONE=$;var C=o(-1);r.NEG_ONE=C;var E=c(-1,2147483647,!1);r.MAX_VALUE=E;var _=c(-1,-1,!0);r.MAX_UNSIGNED_VALUE=_;var R=c(0,-2147483648,!1);r.MIN_VALUE=R;var N=r.prototype;N.toInt=function(){return this.unsigned?this.low>>>0:this.low},N.toNumber=function(){return this.unsigned?(this.high>>>0)*m+(this.low>>>0):this.high*m+(this.low>>>0)},N.toString=function(I){if(I=I||10,I<2||36<I)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(R)){var O=l(I),P=this.div(O),L=P.mul(O).sub(this);return P.toString(I)+L.toInt().toString(I)}else return"-"+this.neg().toString(I);for(var U=l(u(I,6),this.unsigned),D=this,F="";;){var z=D.div(U),B=D.sub(z.mul(U)).toInt()>>>0,j=B.toString(I);if(D=z,D.isZero())return j+F;for(;j.length<6;)j="0"+j;F=""+j+F}},N.getHighBits=function(){return this.high},N.getHighBitsUnsigned=function(){return this.high>>>0},N.getLowBits=function(){return this.low},N.getLowBitsUnsigned=function(){return this.low>>>0},N.getNumBitsAbs=function(){if(this.isNegative())return this.eq(R)?64:this.neg().getNumBitsAbs();for(var I=this.high!=0?this.high:this.low,O=31;O>0&&!(I&1<<O);O--);return this.high!=0?O+33:O+1},N.isZero=function(){return this.high===0&&this.low===0},N.eqz=N.isZero,N.isNegative=function(){return!this.unsigned&&this.high<0},N.isPositive=function(){return this.unsigned||this.high>=0},N.isOdd=function(){return(this.low&1)===1},N.isEven=function(){return(this.low&1)===0},N.equals=function(I){return a(I)||(I=p(I)),this.unsigned!==I.unsigned&&this.high>>>31===1&&I.high>>>31===1?!1:this.high===I.high&&this.low===I.low},N.eq=N.equals,N.notEquals=function(I){return!this.eq(I)},N.neq=N.notEquals,N.ne=N.notEquals,N.lessThan=function(I){return this.comp(I)<0},N.lt=N.lessThan,N.lessThanOrEqual=function(I){return this.comp(I)<=0},N.lte=N.lessThanOrEqual,N.le=N.lessThanOrEqual,N.greaterThan=function(I){return this.comp(I)>0},N.gt=N.greaterThan,N.greaterThanOrEqual=function(I){return this.comp(I)>=0},N.gte=N.greaterThanOrEqual,N.ge=N.greaterThanOrEqual,N.compare=function(I){if(a(I)||(I=p(I)),this.eq(I))return 0;var O=this.isNegative(),P=I.isNegative();return O&&!P?-1:!O&&P?1:this.unsigned?I.high>>>0>this.high>>>0||I.high===this.high&&I.low>>>0>this.low>>>0?-1:1:this.sub(I).isNegative()?-1:1},N.comp=N.compare,N.negate=function(){return!this.unsigned&&this.eq(R)?R:this.not().add(w)},N.neg=N.negate,N.add=function(I){a(I)||(I=p(I));var O=this.high>>>16,P=this.high&65535,L=this.low>>>16,U=this.low&65535,D=I.high>>>16,F=I.high&65535,z=I.low>>>16,B=I.low&65535,j=0,Y=0,Q=0,ae=0;return ae+=U+B,Q+=ae>>>16,ae&=65535,Q+=L+z,Y+=Q>>>16,Q&=65535,Y+=P+F,j+=Y>>>16,Y&=65535,j+=O+D,j&=65535,c(Q<<16|ae,j<<16|Y,this.unsigned)},N.subtract=function(I){return a(I)||(I=p(I)),this.add(I.neg())},N.sub=N.subtract,N.multiply=function(I){if(this.isZero())return v;if(a(I)||(I=p(I)),n){var O=n.mul(this.low,this.high,I.low,I.high);return c(O,n.get_high(),this.unsigned)}if(I.isZero())return v;if(this.eq(R))return I.isOdd()?R:v;if(I.eq(R))return this.isOdd()?R:v;if(this.isNegative())return I.isNegative()?this.neg().mul(I.neg()):this.neg().mul(I).neg();if(I.isNegative())return this.mul(I.neg()).neg();if(this.lt(b)&&I.lt(b))return l(this.toNumber()*I.toNumber(),this.unsigned);var P=this.high>>>16,L=this.high&65535,U=this.low>>>16,D=this.low&65535,F=I.high>>>16,z=I.high&65535,B=I.low>>>16,j=I.low&65535,Y=0,Q=0,ae=0,se=0;return se+=D*j,ae+=se>>>16,se&=65535,ae+=U*j,Q+=ae>>>16,ae&=65535,ae+=D*B,Q+=ae>>>16,ae&=65535,Q+=L*j,Y+=Q>>>16,Q&=65535,Q+=U*B,Y+=Q>>>16,Q&=65535,Q+=D*z,Y+=Q>>>16,Q&=65535,Y+=P*j+L*B+U*z+D*F,Y&=65535,c(ae<<16|se,Y<<16|Q,this.unsigned)},N.mul=N.multiply,N.divide=function(I){if(a(I)||(I=p(I)),I.isZero())throw Error("division by zero");if(n){if(!this.unsigned&&this.high===-2147483648&&I.low===-1&&I.high===-1)return this;var O=(this.unsigned?n.div_u:n.div_s)(this.low,this.high,I.low,I.high);return c(O,n.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?x:v;var P,L,U;if(this.unsigned){if(I.unsigned||(I=I.toUnsigned()),I.gt(this))return x;if(I.gt(this.shru(1)))return $;U=x}else{if(this.eq(R)){if(I.eq(w)||I.eq(C))return R;if(I.eq(R))return w;var D=this.shr(1);return P=D.div(I).shl(1),P.eq(v)?I.isNegative()?w:C:(L=this.sub(I.mul(P)),U=P.add(L.div(I)),U)}else if(I.eq(R))return this.unsigned?x:v;if(this.isNegative())return I.isNegative()?this.neg().div(I.neg()):this.neg().div(I).neg();if(I.isNegative())return this.div(I.neg()).neg();U=v}for(L=this;L.gte(I);){P=Math.max(1,Math.floor(L.toNumber()/I.toNumber()));for(var F=Math.ceil(Math.log(P)/Math.LN2),z=F<=48?1:u(2,F-48),B=l(P),j=B.mul(I);j.isNegative()||j.gt(L);)P-=z,B=l(P,this.unsigned),j=B.mul(I);B.isZero()&&(B=w),U=U.add(B),L=L.sub(j)}return U},N.div=N.divide,N.modulo=function(I){if(a(I)||(I=p(I)),n){var O=(this.unsigned?n.rem_u:n.rem_s)(this.low,this.high,I.low,I.high);return c(O,n.get_high(),this.unsigned)}return this.sub(this.div(I).mul(I))},N.mod=N.modulo,N.rem=N.modulo,N.not=function(){return c(~this.low,~this.high,this.unsigned)},N.and=function(I){return a(I)||(I=p(I)),c(this.low&I.low,this.high&I.high,this.unsigned)},N.or=function(I){return a(I)||(I=p(I)),c(this.low|I.low,this.high|I.high,this.unsigned)},N.xor=function(I){return a(I)||(I=p(I)),c(this.low^I.low,this.high^I.high,this.unsigned)},N.shiftLeft=function(I){return a(I)&&(I=I.toInt()),(I&=63)===0?this:I<32?c(this.low<<I,this.high<<I|this.low>>>32-I,this.unsigned):c(0,this.low<<I-32,this.unsigned)},N.shl=N.shiftLeft,N.shiftRight=function(I){return a(I)&&(I=I.toInt()),(I&=63)===0?this:I<32?c(this.low>>>I|this.high<<32-I,this.high>>I,this.unsigned):c(this.high>>I-32,this.high>=0?0:-1,this.unsigned)},N.shr=N.shiftRight,N.shiftRightUnsigned=function(I){if(a(I)&&(I=I.toInt()),I&=63,I===0)return this;var O=this.high;if(I<32){var P=this.low;return c(P>>>I|O<<32-I,O>>>I,this.unsigned)}else return I===32?c(O,0,this.unsigned):c(O>>>I-32,0,this.unsigned)},N.shru=N.shiftRightUnsigned,N.shr_u=N.shiftRightUnsigned,N.toSigned=function(){return this.unsigned?c(this.low,this.high,!1):this},N.toUnsigned=function(){return this.unsigned?this:c(this.low,this.high,!0)},N.toBytes=function(I){return I?this.toBytesLE():this.toBytesBE()},N.toBytesLE=function(){var I=this.high,O=this.low;return[O&255,O>>>8&255,O>>>16&255,O>>>24,I&255,I>>>8&255,I>>>16&255,I>>>24]},N.toBytesBE=function(){var I=this.high,O=this.low;return[I>>>24,I>>>16&255,I>>>8&255,I&255,O>>>24,O>>>16&255,O>>>8&255,O&255]},r.fromBytes=function(I,O,P){return P?r.fromBytesLE(I,O):r.fromBytesBE(I,O)},r.fromBytesLE=function(I,O){return new r(I[0]|I[1]<<8|I[2]<<16|I[3]<<24,I[4]|I[5]<<8|I[6]<<16|I[7]<<24,O)},r.fromBytesBE=function(I,O){return new r(I[4]<<24|I[5]<<16|I[6]<<8|I[7],I[0]<<24|I[1]<<16|I[2]<<8|I[3],O)}}),YY=mn(()=>{}),ZY=mn(()=>{}),QY=mn((e,t)=>{(function(n,r,a){function i(c){var u=this,d=l();u.next=function(){var p=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=p-(u.c=p|0)},u.c=1,u.s0=d(" "),u.s1=d(" "),u.s2=d(" "),u.s0-=d(c),u.s0<0&&(u.s0+=1),u.s1-=d(c),u.s1<0&&(u.s1+=1),u.s2-=d(c),u.s2<0&&(u.s2+=1),d=null}function s(c,u){return u.c=c.c,u.s0=c.s0,u.s1=c.s1,u.s2=c.s2,u}function o(c,u){var d=new i(c),p=u&&u.state,h=d.next;return h.int32=function(){return d.next()*4294967296|0},h.double=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.quick=h,p&&(typeof p=="object"&&s(p,d),h.state=function(){return s(d,{})}),h}function l(){var c=4022871197,u=function(d){d=String(d);for(var p=0;p<d.length;p++){c+=d.charCodeAt(p);var h=.02519603282416938*c;c=h>>>0,h-=c,h*=c,c=h>>>0,h-=c,c+=h*4294967296}return(c>>>0)*23283064365386963e-26};return u}r&&r.exports?r.exports=o:a&&a.amd?a(function(){return o}):this.alea=o})(e,typeof t=="object"&&t,typeof define=="function"&&define)}),JY=mn((e,t)=>{(function(n,r,a){function i(l){var c=this,u="";c.x=0,c.y=0,c.z=0,c.w=0,c.next=function(){var p=c.x^c.x<<11;return c.x=c.y,c.y=c.z,c.z=c.w,c.w^=c.w>>>19^p^p>>>8},l===(l|0)?c.x=l:u+=l;for(var d=0;d<u.length+64;d++)c.x^=u.charCodeAt(d)|0,c.next()}function s(l,c){return c.x=l.x,c.y=l.y,c.z=l.z,c.w=l.w,c}function o(l,c){var u=new i(l),d=c&&c.state,p=function(){return(u.next()>>>0)/4294967296};return p.double=function(){do var h=u.next()>>>11,f=(u.next()>>>0)/4294967296,m=(h+f)/(1<<21);while(m===0);return m},p.int32=u.next,p.quick=p,d&&(typeof d=="object"&&s(d,u),p.state=function(){return s(u,{})}),p}r&&r.exports?r.exports=o:a&&a.amd?a(function(){return o}):this.xor128=o})(e,typeof t=="object"&&t,typeof define=="function"&&define)}),eZ=mn((e,t)=>{(function(n,r,a){function i(l){var c=this,u="";c.next=function(){var p=c.x^c.x>>>2;return c.x=c.y,c.y=c.z,c.z=c.w,c.w=c.v,(c.d=c.d+362437|0)+(c.v=c.v^c.v<<4^(p^p<<1))|0},c.x=0,c.y=0,c.z=0,c.w=0,c.v=0,l===(l|0)?c.x=l:u+=l;for(var d=0;d<u.length+64;d++)c.x^=u.charCodeAt(d)|0,d==u.length&&(c.d=c.x<<10^c.x>>>4),c.next()}function s(l,c){return c.x=l.x,c.y=l.y,c.z=l.z,c.w=l.w,c.v=l.v,c.d=l.d,c}function o(l,c){var u=new i(l),d=c&&c.state,p=function(){return(u.next()>>>0)/4294967296};return p.double=function(){do var h=u.next()>>>11,f=(u.next()>>>0)/4294967296,m=(h+f)/(1<<21);while(m===0);return m},p.int32=u.next,p.quick=p,d&&(typeof d=="object"&&s(d,u),p.state=function(){return s(u,{})}),p}r&&r.exports?r.exports=o:a&&a.amd?a(function(){return o}):this.xorwow=o})(e,typeof t=="object"&&t,typeof define=="function"&&define)}),tZ=mn((e,t)=>{(function(n,r,a){function i(l){var c=this;c.next=function(){var d=c.x,p=c.i,h,f;return h=d[p],h^=h>>>7,f=h^h<<24,h=d[p+1&7],f^=h^h>>>10,h=d[p+3&7],f^=h^h>>>3,h=d[p+4&7],f^=h^h<<7,h=d[p+7&7],h=h^h<<13,f^=h^h<<9,d[p]=f,c.i=p+1&7,f};function u(d,p){var h,f=[];if(p===(p|0))f[0]=p;else for(p=""+p,h=0;h<p.length;++h)f[h&7]=f[h&7]<<15^p.charCodeAt(h)+f[h+1&7]<<13;for(;f.length<8;)f.push(0);for(h=0;h<8&&f[h]===0;++h);for(h==8?f[7]=-1:f[h],d.x=f,d.i=0,h=256;h>0;--h)d.next()}u(c,l)}function s(l,c){return c.x=l.x.slice(),c.i=l.i,c}function o(l,c){l==null&&(l=+new Date);var u=new i(l),d=c&&c.state,p=function(){return(u.next()>>>0)/4294967296};return p.double=function(){do var h=u.next()>>>11,f=(u.next()>>>0)/4294967296,m=(h+f)/(1<<21);while(m===0);return m},p.int32=u.next,p.quick=p,d&&(d.x&&s(d,u),p.state=function(){return s(u,{})}),p}r&&r.exports?r.exports=o:a&&a.amd?a(function(){return o}):this.xorshift7=o})(e,typeof t=="object"&&t,typeof define=="function"&&define)}),nZ=mn((e,t)=>{(function(n,r,a){function i(l){var c=this;c.next=function(){var d=c.w,p=c.X,h=c.i,f,m;return c.w=d=d+1640531527|0,m=p[h+34&127],f=p[h=h+1&127],m^=m<<13,f^=f<<17,m^=m>>>15,f^=f>>>12,m=p[h]=m^f,c.i=h,m+(d^d>>>16)|0};function u(d,p){var h,f,m,g,y,b=[],v=128;for(p===(p|0)?(f=p,p=null):(p=p+"\0",f=0,v=Math.max(v,p.length)),m=0,g=-32;g<v;++g)p&&(f^=p.charCodeAt((g+32)%p.length)),g===0&&(y=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,g>=0&&(y=y+1640531527|0,h=b[g&127]^=f+y,m=h==0?m+1:0);for(m>=128&&(b[(p&&p.length||0)&127]=-1),m=127,g=4*128;g>0;--g)f=b[m+34&127],h=b[m=m+1&127],f^=f<<13,h^=h<<17,f^=f>>>15,h^=h>>>12,b[m]=f^h;d.w=y,d.X=b,d.i=m}u(c,l)}function s(l,c){return c.i=l.i,c.w=l.w,c.X=l.X.slice(),c}function o(l,c){l==null&&(l=+new Date);var u=new i(l),d=c&&c.state,p=function(){return(u.next()>>>0)/4294967296};return p.double=function(){do var h=u.next()>>>11,f=(u.next()>>>0)/4294967296,m=(h+f)/(1<<21);while(m===0);return m},p.int32=u.next,p.quick=p,d&&(d.X&&s(d,u),p.state=function(){return s(u,{})}),p}r&&r.exports?r.exports=o:a&&a.amd?a(function(){return o}):this.xor4096=o})(e,typeof t=="object"&&t,typeof define=="function"&&define)}),rZ=mn((e,t)=>{(function(n,r,a){function i(l){var c=this,u="";c.next=function(){var p=c.b,h=c.c,f=c.d,m=c.a;return p=p<<25^p>>>7^h,h=h-f|0,f=f<<24^f>>>8^m,m=m-p|0,c.b=p=p<<20^p>>>12^h,c.c=h=h-f|0,c.d=f<<16^h>>>16^m,c.a=m-p|0},c.a=0,c.b=0,c.c=-1640531527,c.d=1367130551,l===Math.floor(l)?(c.a=l/4294967296|0,c.b=l|0):u+=l;for(var d=0;d<u.length+20;d++)c.b^=u.charCodeAt(d)|0,c.next()}function s(l,c){return c.a=l.a,c.b=l.b,c.c=l.c,c.d=l.d,c}function o(l,c){var u=new i(l),d=c&&c.state,p=function(){return(u.next()>>>0)/4294967296};return p.double=function(){do var h=u.next()>>>11,f=(u.next()>>>0)/4294967296,m=(h+f)/(1<<21);while(m===0);return m},p.int32=u.next,p.quick=p,d&&(typeof d=="object"&&s(d,u),p.state=function(){return s(u,{})}),p}r&&r.exports?r.exports=o:a&&a.amd?a(function(){return o}):this.tychei=o})(e,typeof t=="object"&&t,typeof define=="function"&&define)}),aZ=mn(()=>{}),iZ=mn((e,t)=>{(function(n,r,a){var i=256,s=6,o=52,l="random",c=a.pow(i,s),u=a.pow(2,o),d=u*2,p=i-1,h;function f(w,$,C){var E=[];$=$==!0?{entropy:!0}:$||{};var _=b(y($.entropy?[w,x(r)]:w==null?v():w,3),E),R=new m(E),N=function(){for(var I=R.g(s),O=c,P=0;I<u;)I=(I+P)*i,O*=i,P=R.g(1);for(;I>=d;)I/=2,O/=2,P>>>=1;return(I+P)/O};return N.int32=function(){return R.g(4)|0},N.quick=function(){return R.g(4)/4294967296},N.double=N,b(x(R.S),r),($.pass||C||function(I,O,P,L){return L&&(L.S&&g(L,R),I.state=function(){return g(R,{})}),P?(a[l]=I,O):I})(N,_,"global"in $?$.global:this==a,$.state)}function m(w){var $,C=w.length,E=this,_=0,R=E.i=E.j=0,N=E.S=[];for(C||(w=[C++]);_<i;)N[_]=_++;for(_=0;_<i;_++)N[_]=N[R=p&R+w[_%C]+($=N[_])],N[R]=$;(E.g=function(I){for(var O,P=0,L=E.i,U=E.j,D=E.S;I--;)O=D[L=p&L+1],P=P*i+D[p&(D[L]=D[U=p&U+O])+(D[U]=O)];return E.i=L,E.j=U,P})(i)}function g(w,$){return $.i=w.i,$.j=w.j,$.S=w.S.slice(),$}function y(w,$){var C=[],E=typeof w,_;if($&&E=="object")for(_ in w)try{C.push(y(w[_],$-1))}catch(R){}return C.length?C:E=="string"?w:w+"\0"}function b(w,$){for(var C=w+"",E,_=0;_<C.length;)$[p&_]=p&(E^=$[p&_]*19)+C.charCodeAt(_++);return x($)}function v(){try{var w;return h&&(w=h.randomBytes)?w=w(i):(w=new Uint8Array(i),(n.crypto||n.msCrypto).getRandomValues(w)),x(w)}catch(E){var $=n.navigator,C=$&&$.plugins;return[+new Date,n,C,n.screen,x(r)]}}function x(w){return String.fromCharCode.apply(0,w)}if(b(a.random(),r),typeof t=="object"&&t.exports){t.exports=f;try{h=aZ()}catch(w){}}else typeof define=="function"&&define.amd?define(function(){return f}):a["seed"+l]=f})(typeof self<"u"?self:e,[],Math)}),j0=mn((e,t)=>{var n=QY(),r=JY(),a=eZ(),i=tZ(),s=nZ(),o=rZ(),l=iZ();l.alea=n,l.xor128=r,l.xorwow=a,l.xorshift7=i,l.xor4096=s,l.tychei=o,t.exports=l}),WL=mn(()=>{}),D$=mn(()=>{}),UL=mn(()=>{}),sZ=mn(()=>{}),oZ=mn(()=>{}),lZ=mn(()=>{}),uZ=mn((e,t)=>{var n=(()=>{var r=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(r=r||__filename),function(a){a=a||{};function i(){return F.buffer!=he&&Je(F.buffer),Te}function s(){return F.buffer!=he&&Je(F.buffer),Fe}function o(){return F.buffer!=he&&Je(F.buffer),Ve}function l(){return F.buffer!=he&&Je(F.buffer),Pe}function c(){return F.buffer!=he&&Je(F.buffer),pt}var u=typeof a<"u"?a:{},d,p;u.ready=new Promise(function(W,J){d=W,p=J});var h;typeof process<"u"&&process.listeners&&(h={uncaughtException:process.listeners("uncaughtException"),unhandledRejection:process.listeners("unhandledRejection")});var f=Object.assign({},u),m=(W,J)=>{throw J},g=typeof window=="object",y=typeof importScripts=="function",b=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",v=u.ENVIRONMENT_IS_PTHREAD||!1,x="";function w(W){return u.locateFile?u.locateFile(W,x):x+W}var $,C,E;function _(W){W instanceof si||L("exiting due to exception: "+W)}if(b){var R=D$(),N=UL();y?x=N.dirname(x)+"/":x=__dirname+"/",$=(J,pe)=>(J=Bi(J)?new URL(J):N.normalize(J),R.readFileSync(J,pe?void 0:"utf8")),E=J=>{var pe=$(J,!0);return pe.buffer||(pe=new Uint8Array(pe)),pe},C=(J,pe,Me)=>{J=Bi(J)?new URL(J):N.normalize(J),R.readFile(J,function(je,qe){je?Me(je):pe(qe.buffer)})},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",function(J){if(!(J instanceof si))throw J}),process.on("unhandledRejection",function(J){throw J}),m=(J,pe)=>{if(Ot())throw process.exitCode=J,pe;_(pe),process.exit(J)},u.inspect=function(){return"[Emscripten Module object]"};let W;try{W=sZ()}catch(J){throw console.error('The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?'),J}global.Worker=W.Worker}else(g||y)&&(y?x=self.location.href:typeof document<"u"&&document.currentScript&&(x=document.currentScript.src),typeof r<"u"&&r&&(x=r),x.indexOf("blob:")!==0?x=x.substr(0,x.replace(/[?#].*/,"").lastIndexOf("/")+1):x="",b||($=W=>{var J=new XMLHttpRequest;return J.open("GET",W,!1),J.send(null),J.responseText},y&&(E=W=>{var J=new XMLHttpRequest;return J.open("GET",W,!1),J.responseType="arraybuffer",J.send(null),new Uint8Array(J.response)}),C=(W,J,pe)=>{var Me=new XMLHttpRequest;Me.open("GET",W,!0),Me.responseType="arraybuffer",Me.onload=()=>{if(Me.status==200||Me.status==0&&Me.response){J(Me.response);return}pe()},Me.onerror=pe,Me.send(null)}));b&&typeof performance>"u"&&(global.performance=oZ().performance);var I=console.log.bind(console),O=console.warn.bind(console);b&&(I=W=>R.writeSync(1,W+"\n"),O=W=>R.writeSync(2,W+"\n"));var P=u.print||I,L=u.printErr||O;Object.assign(u,f),f=null,u.arguments&&u.arguments,u.thisProgram&&u.thisProgram,u.quit&&(m=u.quit);var U;u.wasmBinary&&(U=u.wasmBinary);var D=u.noExitRuntime||!0;typeof WebAssembly!="object"&&on("no native wasm support detected");var F,z,B=!1,j;function Y(W,J){W||on(J)}var Q=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function ae(W,J,pe){J>>>=0;for(var Me=J+pe,je=J;W[je]&&!(je>=Me);)++je;if(je-J>16&&W.buffer&&Q)return Q.decode(W.buffer instanceof SharedArrayBuffer?W.slice(J,je):W.subarray(J,je));for(var qe="";J<je;){var we=W[J++];if(!(we&128)){qe+=String.fromCharCode(we);continue}var Re=W[J++]&63;if((we&224)==192){qe+=String.fromCharCode((we&31)<<6|Re);continue}var Vt=W[J++]&63;if((we&240)==224?we=(we&15)<<12|Re<<6|Vt:we=(we&7)<<18|Re<<12|Vt<<6|W[J++]&63,we<65536)qe+=String.fromCharCode(we);else{var va=we-65536;qe+=String.fromCharCode(55296|va>>10,56320|va&1023)}}return qe}function se(W,J){return W>>>=0,W?ae(s(),W,J):""}function fe(W,J,pe,Me){if(pe>>>=0,!(Me>0))return 0;for(var je=pe,qe=pe+Me-1,we=0;we<W.length;++we){var Re=W.charCodeAt(we);if(Re>=55296&&Re<=57343){var Vt=W.charCodeAt(++we);Re=65536+((Re&1023)<<10)|Vt&1023}if(Re<=127){if(pe>=qe)break;J[pe++>>>0]=Re}else if(Re<=2047){if(pe+1>=qe)break;J[pe++>>>0]=192|Re>>6,J[pe++>>>0]=128|Re&63}else if(Re<=65535){if(pe+2>=qe)break;J[pe++>>>0]=224|Re>>12,J[pe++>>>0]=128|Re>>6&63,J[pe++>>>0]=128|Re&63}else{if(pe+3>=qe)break;J[pe++>>>0]=240|Re>>18,J[pe++>>>0]=128|Re>>12&63,J[pe++>>>0]=128|Re>>6&63,J[pe++>>>0]=128|Re&63}}return J[pe>>>0]=0,pe-je}function me(W,J,pe){return fe(W,s(),J,pe)}var he,Te,Fe,Ve,Pe,pt;v&&(he=u.buffer);function Je(W){he=W,u.HEAP8=Te=new Int8Array(W),u.HEAP16=new Int16Array(W),u.HEAP32=Ve=new Int32Array(W),u.HEAPU8=Fe=new Uint8Array(W),u.HEAPU16=new Uint16Array(W),u.HEAPU32=Pe=new Uint32Array(W),u.HEAPF32=new Float32Array(W),u.HEAPF64=pt=new Float64Array(W)}var tt=u.INITIAL_MEMORY||16777216;if(v)F=u.wasmMemory,he=u.buffer;else if(u.wasmMemory)F=u.wasmMemory;else if(F=new WebAssembly.Memory({initial:tt/65536,maximum:65536,shared:!0}),!(F.buffer instanceof SharedArrayBuffer))throw L("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),b&&L("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and/or recent version)"),Error("bad memory");F&&(he=F.buffer),tt=he.byteLength,Je(he);var Le,st=[],gt=[],pr=[];function Ot(){return D}function Qn(){if(u.preRun)for(typeof u.preRun=="function"&&(u.preRun=[u.preRun]);u.preRun.length;)Yr(u.preRun.shift());yt(st)}function yn(){!v&&yt(gt)}function Jn(){if(!v){if(u.postRun)for(typeof u.postRun=="function"&&(u.postRun=[u.postRun]);u.postRun.length;)er(u.postRun.shift());yt(pr)}}function Yr(W){st.unshift(W)}function hr(W){gt.unshift(W)}function er(W){pr.unshift(W)}var bn=0,Tn=null;function Mr(W){bn++,u.monitorRunDependencies&&u.monitorRunDependencies(bn)}function ii(W){if(bn--,u.monitorRunDependencies&&u.monitorRunDependencies(bn),bn==0&&Tn){var J=Tn;Tn=null,J()}}function on(W){u.onAbort&&u.onAbort(W),W="Aborted("+W+")",L(W),B=!0,j=1,W+=". Build with -sASSERTIONS for more info.";var J=new WebAssembly.RuntimeError(W);throw p(J),J}var Zr="data:application/octet-stream;base64,";function tr(W){return W.startsWith(Zr)}function Bi(W){return W.startsWith("file://")}var vn;vn="tfjs-backend-wasm-threaded-simd.wasm",tr(vn)||(vn=w(vn));function Zc(W){try{if(W==vn&&U)return new Uint8Array(U);if(E)return E(W);throw"both async and sync fetching of the wasm failed"}catch(J){on(J)}}function Qc(){if(!U&&(g||y)){if(typeof fetch=="function"&&!Bi(vn))return fetch(vn,{credentials:"same-origin"}).then(function(W){if(!W.ok)throw"failed to load wasm binary file at '"+vn+"'";return W.arrayBuffer()}).catch(function(){return Zc(vn)});if(C)return new Promise(function(W,J){C(vn,function(pe){W(new Uint8Array(pe))},J)})}return Promise.resolve().then(function(){return Zc(vn)})}function Jc(){var W={env:oN,wasi_snapshot_preview1:oN};function J(we,Re){var Vt=we.exports;if(u.asm=Vt,oi(u.asm._emscripten_tls_init),Le=u.asm.__indirect_function_table,hr(u.asm.__wasm_call_ctors),z=Re,!v){var va=ve.unusedWorkers.length;ve.unusedWorkers.forEach(function(fs){ve.loadWasmModuleToWorker(fs,function(){--va||ii()})})}}v||Mr();function pe(we){J(we.instance,we.module)}function Me(we){return Qc().then(function(Re){return WebAssembly.instantiate(Re,W)}).then(function(Re){return Re}).then(we,function(Re){L("failed to asynchronously prepare wasm: "+Re),on(Re)})}function je(){return!U&&typeof WebAssembly.instantiateStreaming=="function"&&!tr(vn)&&!Bi(vn)&&!b&&typeof fetch=="function"?fetch(vn,{credentials:"same-origin"}).then(function(we){var Re=WebAssembly.instantiateStreaming(we,W);return Re.then(pe,function(Vt){return L("wasm streaming compile failed: "+Vt),L("falling back to ArrayBuffer instantiation"),Me(pe)})}):Me(pe)}if(u.instantiateWasm)try{var qe=u.instantiateWasm(W,J);return qe}catch(we){L("Module.instantiateWasm callback failed with error: "+we),p(we)}return je().catch(p),{}}var ed={};function si(W){this.name="ExitStatus",this.message="Program terminated with exit("+W+")",this.status=W}function Gs(W){var J=ve.pthreads[W];delete ve.pthreads[W],J.terminate(),Iw(W),ve.runningWorkers.splice(ve.runningWorkers.indexOf(J),1),J.pthread_ptr=0}function td(W){var J=ve.pthreads[W];J.postMessage({cmd:"cancel"})}function ps(W){var J=ve.pthreads[W];Y(J),ve.returnWorkerToPool(J)}function hs(W){var J=ve.getNewWorker();if(!J)return 6;ve.runningWorkers.push(J),ve.pthreads[W.pthread_ptr]=J,J.pthread_ptr=W.pthread_ptr;var pe={cmd:"run",start_routine:W.startRoutine,arg:W.arg,pthread_ptr:W.pthread_ptr};return J.runPthread=()=>{b&&J.ref(),J.postMessage(pe,W.transferList),delete J.runPthread},J.loaded&&J.runPthread(),0}function nd(W){if(v)return _n(1,1,W);j=W,Ot()||(ve.terminateAllThreads(),u.onExit&&u.onExit(W),B=!0),m(W,new si(W))}function ie(W,J){if(j=W,!J&&v)throw ze(W),"unwind";nd(W)}var ue=ie;function Ce(W){if(W instanceof si||W=="unwind")return j;m(1,W)}var ve={unusedWorkers:[],runningWorkers:[],tlsInitFunctions:[],pthreads:{},init:function(){v?ve.initWorker():ve.initMainThread()},initMainThread:function(){for(var W=8;W--;)ve.allocateUnusedWorker()},initWorker:function(){D=!1},setExitStatus:function(W){j=W},terminateAllThreads:function(){for(var W of Object.values(ve.pthreads))ve.returnWorkerToPool(W);for(var W of ve.unusedWorkers)W.terminate();ve.unusedWorkers=[]},returnWorkerToPool:function(W){var J=W.pthread_ptr;delete ve.pthreads[J],ve.unusedWorkers.push(W),ve.runningWorkers.splice(ve.runningWorkers.indexOf(W),1),W.pthread_ptr=0,b&&W.unref(),Iw(J)},receiveObjectTransfer:function(W){},threadInitTLS:function(){ve.tlsInitFunctions.forEach(W=>W())},loadWasmModuleToWorker:function(W,J){W.onmessage=qe=>{var we=qe.data,Re=we.cmd;if(W.pthread_ptr&&(ve.currentProxiedOperationCallerThread=W.pthread_ptr),we.targetThread&&we.targetThread!=py()){var Vt=ve.pthreads[we.targetThread];Vt?Vt.postMessage(we,we.transferList):L('Internal error! Worker sent a message "'+Re+'" to target pthread '+we.targetThread+", but that thread no longer exists!"),ve.currentProxiedOperationCallerThread=void 0;return}Re==="processProxyingQueue"?rf(we.queue):Re==="spawnThread"?hs(we):Re==="cleanupThread"?ps(we.thread):Re==="killThread"?Gs(we.thread):Re==="cancelThread"?td(we.thread):Re==="loaded"?(W.loaded=!0,b&&W.unref(),J&&J(W),W.runPthread&&W.runPthread()):Re==="print"?P("Thread "+we.threadId+": "+we.text):Re==="printErr"?L("Thread "+we.threadId+": "+we.text):Re==="alert"?alert("Thread "+we.threadId+": "+we.text):we.target==="setimmediate"?W.postMessage(we):Re==="callHandler"?u[we.handler](...we.args):Re&&L("worker sent an unknown command "+Re),ve.currentProxiedOperationCallerThread=void 0},W.onerror=qe=>{var we="worker sent an error!";throw L(we+" "+qe.filename+":"+qe.lineno+": "+qe.message),qe},b&&(W.on("message",function(qe){W.onmessage({data:qe})}),W.on("error",function(qe){W.onerror(qe)}),W.on("detachedExit",function(){}));var pe=[],Me=["onExit","onAbort","print","printErr"];for(var je of Me)u.hasOwnProperty(je)&&pe.push(je);W.postMessage({cmd:"load",handlers:pe,urlOrBlob:u.mainScriptUrlOrBlob||r,wasmMemory:F,wasmModule:z})},allocateUnusedWorker:function(){var W,J=w("tfjs-backend-wasm-threaded-simd.worker.js");W=new Worker(J),ve.unusedWorkers.push(W)},getNewWorker:function(){return ve.unusedWorkers.length==0&&(ve.allocateUnusedWorker(),ve.loadWasmModuleToWorker(ve.unusedWorkers[0])),ve.unusedWorkers.pop()}};u.PThread=ve;function yt(W){for(;W.length>0;)W.shift()(u)}function $t(){var W=py(),J=o()[W+52>>>2],pe=o()[W+56>>>2],Me=J-pe;pN(J,Me),hy(J)}u.establishStackSpace=$t;function ze(W){if(v)return _n(2,0,W);try{ue(W)}catch(J){Ce(J)}}var Be=[];function Ut(W){var J=Be[W];return J||(W>=Be.length&&(Be.length=W+1),Be[W]=J=Le.get(W)),J}function Rt(W,J){var pe=Ut(W)(J);Ot()?ve.setExitStatus(pe):dN(pe)}u.invokeEntryPoint=Rt;function oi(W){ve.tlsInitFunctions.push(W)}function rd(W){lN(W,!y,1,!g),ve.threadInitTLS()}function ll(W){v?postMessage({cmd:"cleanupThread",thread:W}):ps(W)}function ul(W,J,pe,Me){return v?_n(3,1,W,J,pe,Me):Wn(W,J,pe,Me)}function Wn(W,J,pe,Me){if(typeof SharedArrayBuffer>"u")return L("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var je=[],qe=0;if(v&&(je.length===0||qe))return ul(W,J,pe,Me);var we={startRoutine:pe,pthread_ptr:W,arg:Me,transferList:je};return v?(we.cmd="spawnThread",postMessage(we,je),0):hs(we)}function Wi(){return 65536}var qs=!0;function xw(){return qs}function rf(W){Atomics.store(o(),W>>2,1),py()&&cN(W),Atomics.compareExchange(o(),W>>2,1,0)}u.executeNotifiedProxyingQueue=rf;function ww(W,J,pe,Me){if(W==J)setTimeout(()=>rf(Me));else if(v)postMessage({targetThread:W,cmd:"processProxyingQueue",queue:Me});else{var je=ve.pthreads[W];if(!je)return;je.postMessage({cmd:"processProxyingQueue",queue:Me})}return 1}function kw(W,J,pe){return-1}function cy(){on("")}function cl(W){cl.shown||(cl.shown={}),cl.shown[W]||(cl.shown[W]=1,b&&(W="warning: "+W),L(W))}function dy(){b||y||cl("Blocking on the main thread is very dangerous, see https://emscripten.org/docs/porting/pthreads.html#blocking-on-the-main-browser-thread")}function nN(){return Date.now()}function Sw(){return 4294901760}function te(){return Sw()}var ge;b?ge=()=>{var W=process.hrtime();return W[0]*1e3+W[1]/1e6}:ge=()=>performance.timeOrigin+performance.now();function Ne(W,J,pe){s().copyWithin(W>>>0,J>>>0,J+pe>>>0)}function ln(){return b?lZ().cpus().length:navigator.hardwareConcurrency}function Nn(W){var J=$w(),pe=W();return hy(J),pe}function _n(W,J){var pe=arguments.length-2,Me=arguments;return Nn(()=>{for(var je=pe,qe=fy(je*8),we=qe>>3,Re=0;Re<pe;Re++){var Vt=Me[2+Re];c()[we+Re>>>0]=Vt}return uN(W,je,qe,J)})}var li=[];function Fj(W,J,pe){li.length=J;for(var Me=pe>>3,je=0;je<J;je++)li[je]=c()[Me+je>>>0];var qe=W<0,we=qe?ed[-W-1]:Vj[W];return we.apply(null,li)}function Mj(W){try{return F.grow(W-he.byteLength+65535>>>16),Je(F.buffer),1}catch(J){}}function Oj(W){var J=s().length;if(W=W>>>0,W<=J)return!1;var pe=Sw();if(W>pe)return!1;let Me=(Vt,va)=>Vt+(va-Vt%va)%va;for(var je=1;je<=4;je*=2){var qe=J*(1+.2/je);qe=Math.min(qe,W+100663296);var we=Math.min(pe,Me(Math.max(W,qe),65536)),Re=Mj(we);if(Re)return!0}return!1}function Lj(){throw"unwind"}function rN(W){return v?_n(4,1,W):52}function aN(W,J,pe,Me,je){return v?_n(5,1,W,J,pe,Me,je):70}var Pj=[null,[],[]];function zj(W,J){var pe=Pj[W];J===0||J===10?((W===1?P:L)(ae(pe,0)),pe.length=0):pe.push(J)}function iN(W,J,pe,Me){if(v)return _n(6,1,W,J,pe,Me);for(var je=0,qe=0;qe<pe;qe++){var we=l()[J>>>2],Re=l()[J+4>>>2];J+=8;for(var Vt=0;Vt<Re;Vt++)zj(W,s()[we+Vt>>>0]);je+=Re}return l()[Me>>>2]=je,0}function sN(W){var J=u["_"+W];return J}function Bj(W,J){i().set(W,J>>>0)}function Wj(W,J,pe,Me,je){var qe={string:xa=>{var ad=0;if(xa!=null&&xa!==0){var mN=(xa.length<<2)+1;ad=fy(mN),me(xa,ad,mN)}return ad},array:xa=>{var ad=fy(xa.length);return Bj(xa,ad),ad}};function we(xa){return J==="string"?se(xa):J==="boolean"?!!xa:xa}var Re=sN(W),Vt=[],va=0;if(Me)for(var fs=0;fs<Me.length;fs++){var fN=qe[pe[fs]];fN?(va===0&&(va=$w()),Vt[fs]=fN(Me[fs])):Vt[fs]=Me[fs]}var Cw=Re.apply(null,Vt);function jj(xa){return va!==0&&hy(va),we(xa)}return Cw=jj(Cw),Cw}function Uj(W,J,pe,Me){pe=pe||[];var je=pe.every(we=>we==="number"||we==="boolean"),qe=J!=="string";return qe&&je&&!Me?sN(W):function(){return Wj(W,J,pe,arguments)}}ve.init();var Vj=[null,nd,ze,ul,rN,aN,iN],oN={__emscripten_init_main_thread_js:rd,__emscripten_thread_cleanup:ll,__pthread_create_js:Wn,_emscripten_default_pthread_stack_size:Wi,_emscripten_get_now_is_monotonic:xw,_emscripten_notify_task_queue:ww,_emscripten_set_offscreencanvas_size:kw,abort:cy,emscripten_check_blocking_allowed:dy,emscripten_date_now:nN,emscripten_get_heap_max:te,emscripten_get_now:ge,emscripten_memcpy_big:Ne,emscripten_num_logical_cores:ln,emscripten_receive_on_main_thread_js:Fj,emscripten_resize_heap:Oj,emscripten_unwind_to_js_event_loop:Lj,exit:ue,fd_close:rN,fd_seek:aN,fd_write:iN,memory:F||u.wasmMemory};Jc(),u.___wasm_call_ctors=function(){return(u.___wasm_call_ctors=u.asm.__wasm_call_ctors).apply(null,arguments)},u._init=function(){return(u._init=u.asm.init).apply(null,arguments)},u._init_with_threads_count=function(){return(u._init_with_threads_count=u.asm.init_with_threads_count).apply(null,arguments)},u._get_threads_count=function(){return(u._get_threads_count=u.asm.get_threads_count).apply(null,arguments)},u._register_tensor=function(){return(u._register_tensor=u.asm.register_tensor).apply(null,arguments)},u._dispose_data=function(){return(u._dispose_data=u.asm.dispose_data).apply(null,arguments)},u._dispose=function(){return(u._dispose=u.asm.dispose).apply(null,arguments)},u._Abs=function(){return(u._Abs=u.asm.Abs).apply(null,arguments)},u._Acos=function(){return(u._Acos=u.asm.Acos).apply(null,arguments)},u._Acosh=function(){return(u._Acosh=u.asm.Acosh).apply(null,arguments)},u._Add=function(){return(u._Add=u.asm.Add).apply(null,arguments)},u._AddN=function(){return(u._AddN=u.asm.AddN).apply(null,arguments)},u._All=function(){return(u._All=u.asm.All).apply(null,arguments)},u._Any=function(){return(u._Any=u.asm.Any).apply(null,arguments)},u._ArgMax=function(){return(u._ArgMax=u.asm.ArgMax).apply(null,arguments)},u._ArgMin=function(){return(u._ArgMin=u.asm.ArgMin).apply(null,arguments)},u._Asin=function(){return(u._Asin=u.asm.Asin).apply(null,arguments)},u._Asinh=function(){return(u._Asinh=u.asm.Asinh).apply(null,arguments)},u._Atan=function(){return(u._Atan=u.asm.Atan).apply(null,arguments)},u._Atan2=function(){return(u._Atan2=u.asm.Atan2).apply(null,arguments)},u._Atanh=function(){return(u._Atanh=u.asm.Atanh).apply(null,arguments)},u._AvgPool=function(){return(u._AvgPool=u.asm.AvgPool).apply(null,arguments)},u._AvgPool3D=function(){return(u._AvgPool3D=u.asm.AvgPool3D).apply(null,arguments)},u._AvgPool3DGrad=function(){return(u._AvgPool3DGrad=u.asm.AvgPool3DGrad).apply(null,arguments)},u._AvgPoolGrad=function(){return(u._AvgPoolGrad=u.asm.AvgPoolGrad).apply(null,arguments)},u._BatchMatMul=function(){return(u._BatchMatMul=u.asm.BatchMatMul).apply(null,arguments)},u._Bincount=function(){return(u._Bincount=u.asm.Bincount).apply(null,arguments)},u._BitwiseAnd=function(){return(u._BitwiseAnd=u.asm.BitwiseAnd).apply(null,arguments)},u._Ceil=function(){return(u._Ceil=u.asm.Ceil).apply(null,arguments)},u._ClipByValue=function(){return(u._ClipByValue=u.asm.ClipByValue).apply(null,arguments)},u._Conv2D=function(){return(u._Conv2D=u.asm.Conv2D).apply(null,arguments)},u._Conv2DBackpropInput=function(){return(u._Conv2DBackpropInput=u.asm.Conv2DBackpropInput).apply(null,arguments)},u._Conv3D=function(){return(u._Conv3D=u.asm.Conv3D).apply(null,arguments)},u._Conv3DBackpropFilterV2=function(){return(u._Conv3DBackpropFilterV2=u.asm.Conv3DBackpropFilterV2).apply(null,arguments)},u._Conv3DBackpropInputV2=function(){return(u._Conv3DBackpropInputV2=u.asm.Conv3DBackpropInputV2).apply(null,arguments)},u._Cos=function(){return(u._Cos=u.asm.Cos).apply(null,arguments)},u._Cosh=function(){return(u._Cosh=u.asm.Cosh).apply(null,arguments)},u._CropAndResize=function(){return(u._CropAndResize=u.asm.CropAndResize).apply(null,arguments)},u._Cumprod=function(){return(u._Cumprod=u.asm.Cumprod).apply(null,arguments)},u._Cumsum=function(){return(u._Cumsum=u.asm.Cumsum).apply(null,arguments)},u._DenseBincount=function(){return(u._DenseBincount=u.asm.DenseBincount).apply(null,arguments)},u._DepthToSpace=function(){return(u._DepthToSpace=u.asm.DepthToSpace).apply(null,arguments)},u._DepthwiseConv2dNative=function(){return(u._DepthwiseConv2dNative=u.asm.DepthwiseConv2dNative).apply(null,arguments)},u._Diag=function(){return(u._Diag=u.asm.Diag).apply(null,arguments)},u._Dilation2D=function(){return(u._Dilation2D=u.asm.Dilation2D).apply(null,arguments)},u._Dilation2DBackpropFilter=function(){return(u._Dilation2DBackpropFilter=u.asm.Dilation2DBackpropFilter).apply(null,arguments)},u._Dilation2DBackpropInput=function(){return(u._Dilation2DBackpropInput=u.asm.Dilation2DBackpropInput).apply(null,arguments)},u._Elu=function(){return(u._Elu=u.asm.Elu).apply(null,arguments)},u._EluGrad=function(){return(u._EluGrad=u.asm.EluGrad).apply(null,arguments)},u._Equal=function(){return(u._Equal=u.asm.Equal).apply(null,arguments)},u._Erf=function(){return(u._Erf=u.asm.Erf).apply(null,arguments)},u._Exp=function(){return(u._Exp=u.asm.Exp).apply(null,arguments)},u._Expm1=function(){return(u._Expm1=u.asm.Expm1).apply(null,arguments)},u._FlipLeftRight=function(){return(u._FlipLeftRight=u.asm.FlipLeftRight).apply(null,arguments)},u._Floor=function(){return(u._Floor=u.asm.Floor).apply(null,arguments)},u._FloorDiv=function(){return(u._FloorDiv=u.asm.FloorDiv).apply(null,arguments)},u._FusedBatchNorm=function(){return(u._FusedBatchNorm=u.asm.FusedBatchNorm).apply(null,arguments)},u._FusedConv2D=function(){return(u._FusedConv2D=u.asm.FusedConv2D).apply(null,arguments)},u._FusedDepthwiseConv2D=function(){return(u._FusedDepthwiseConv2D=u.asm.FusedDepthwiseConv2D).apply(null,arguments)},u._Gather=function(){return(u._Gather=u.asm.Gather).apply(null,arguments)},u._GatherNd=function(){return(u._GatherNd=u.asm.GatherNd).apply(null,arguments)},u._Greater=function(){return(u._Greater=u.asm.Greater).apply(null,arguments)},u._GreaterEqual=function(){return(u._GreaterEqual=u.asm.GreaterEqual).apply(null,arguments)},u._IsFinite=function(){return(u._IsFinite=u.asm.IsFinite).apply(null,arguments)},u._IsInf=function(){return(u._IsInf=u.asm.IsInf).apply(null,arguments)},u._IsNan=function(){return(u._IsNan=u.asm.IsNan).apply(null,arguments)},u._LRN=function(){return(u._LRN=u.asm.LRN).apply(null,arguments)},u._LRNGrad=function(){return(u._LRNGrad=u.asm.LRNGrad).apply(null,arguments)},u._LeakyRelu=function(){return(u._LeakyRelu=u.asm.LeakyRelu).apply(null,arguments)},u._Less=function(){return(u._Less=u.asm.Less).apply(null,arguments)},u._LessEqual=function(){return(u._LessEqual=u.asm.LessEqual).apply(null,arguments)},u._LinSpace=function(){return(u._LinSpace=u.asm.LinSpace).apply(null,arguments)},u._Log=function(){return(u._Log=u.asm.Log).apply(null,arguments)},u._Log1p=function(){return(u._Log1p=u.asm.Log1p).apply(null,arguments)},u._LogicalAnd=function(){return(u._LogicalAnd=u.asm.LogicalAnd).apply(null,arguments)},u._LogicalNot=function(){return(u._LogicalNot=u.asm.LogicalNot).apply(null,arguments)},u._LogicalOr=function(){return(u._LogicalOr=u.asm.LogicalOr).apply(null,arguments)},u._LogicalXor=function(){return(u._LogicalXor=u.asm.LogicalXor).apply(null,arguments)},u._Max=function(){return(u._Max=u.asm.Max).apply(null,arguments)},u._MaxPool=function(){return(u._MaxPool=u.asm.MaxPool).apply(null,arguments)},u._MaxPool3D=function(){return(u._MaxPool3D=u.asm.MaxPool3D).apply(null,arguments)},u._MaxPool3DGrad=function(){return(u._MaxPool3DGrad=u.asm.MaxPool3DGrad).apply(null,arguments)},u._MaxPoolGrad=function(){return(u._MaxPoolGrad=u.asm.MaxPoolGrad).apply(null,arguments)},u._MaxPoolWithArgmax=function(){return(u._MaxPoolWithArgmax=u.asm.MaxPoolWithArgmax).apply(null,arguments)},u._Maximum=function(){return(u._Maximum=u.asm.Maximum).apply(null,arguments)},u._Mean=function(){return(u._Mean=u.asm.Mean).apply(null,arguments)},u._Min=function(){return(u._Min=u.asm.Min).apply(null,arguments)},u._Minimum=function(){return(u._Minimum=u.asm.Minimum).apply(null,arguments)},u._MirrorPad=function(){return(u._MirrorPad=u.asm.MirrorPad).apply(null,arguments)},u._Mod=function(){return(u._Mod=u.asm.Mod).apply(null,arguments)},u._Multinomial=function(){return(u._Multinomial=u.asm.Multinomial).apply(null,arguments)},u._Multiply=function(){return(u._Multiply=u.asm.Multiply).apply(null,arguments)},u._Neg=function(){return(u._Neg=u.asm.Neg).apply(null,arguments)},u._NonMaxSuppressionV3=function(){return(u._NonMaxSuppressionV3=u.asm.NonMaxSuppressionV3).apply(null,arguments)},u._NonMaxSuppressionV4=function(){return(u._NonMaxSuppressionV4=u.asm.NonMaxSuppressionV4).apply(null,arguments)},u._NonMaxSuppressionV5=function(){return(u._NonMaxSuppressionV5=u.asm.NonMaxSuppressionV5).apply(null,arguments)},u._NotEqual=function(){return(u._NotEqual=u.asm.NotEqual).apply(null,arguments)},u._OneHot=function(){return(u._OneHot=u.asm.OneHot).apply(null,arguments)},u._PadV2=function(){return(u._PadV2=u.asm.PadV2).apply(null,arguments)},u._Pow=function(){return(u._Pow=u.asm.Pow).apply(null,arguments)},u._Prelu=function(){return(u._Prelu=u.asm.Prelu).apply(null,arguments)},u._Prod=function(){return(u._Prod=u.asm.Prod).apply(null,arguments)},u._RealDiv=function(){return(u._RealDiv=u.asm.RealDiv).apply(null,arguments)},u._Reciprocal=function(){return(u._Reciprocal=u.asm.Reciprocal).apply(null,arguments)},u._Relu=function(){return(u._Relu=u.asm.Relu).apply(null,arguments)},u._Relu6=function(){return(u._Relu6=u.asm.Relu6).apply(null,arguments)},u._ResizeBilinear=function(){return(u._ResizeBilinear=u.asm.ResizeBilinear).apply(null,arguments)},u._ResizeBilinearGrad=function(){return(u._ResizeBilinearGrad=u.asm.ResizeBilinearGrad).apply(null,arguments)},u._ResizeNearestNeighbor=function(){return(u._ResizeNearestNeighbor=u.asm.ResizeNearestNeighbor).apply(null,arguments)},u._ResizeNearestNeighborGrad=function(){return(u._ResizeNearestNeighborGrad=u.asm.ResizeNearestNeighborGrad).apply(null,arguments)},u._Reverse=function(){return(u._Reverse=u.asm.Reverse).apply(null,arguments)},u._RotateWithOffset=function(){return(u._RotateWithOffset=u.asm.RotateWithOffset).apply(null,arguments)},u._Round=function(){return(u._Round=u.asm.Round).apply(null,arguments)},u._Rsqrt=function(){return(u._Rsqrt=u.asm.Rsqrt).apply(null,arguments)},u._ScatterNd=function(){return(u._ScatterNd=u.asm.ScatterNd).apply(null,arguments)},u._SearchSorted=function(){return(u._SearchSorted=u.asm.SearchSorted).apply(null,arguments)},u._SelectV2=function(){return(u._SelectV2=u.asm.SelectV2).apply(null,arguments)},u._Selu=function(){return(u._Selu=u.asm.Selu).apply(null,arguments)},u._Sigmoid=function(){return(u._Sigmoid=u.asm.Sigmoid).apply(null,arguments)},u._Sign=function(){return(u._Sign=u.asm.Sign).apply(null,arguments)},u._Sin=function(){return(u._Sin=u.asm.Sin).apply(null,arguments)},u._Sinh=function(){return(u._Sinh=u.asm.Sinh).apply(null,arguments)},u._Softmax=function(){return(u._Softmax=u.asm.Softmax).apply(null,arguments)},u._Softplus=function(){return(u._Softplus=u.asm.Softplus).apply(null,arguments)},u._SparseFillEmptyRows=function(){return(u._SparseFillEmptyRows=u.asm.SparseFillEmptyRows).apply(null,arguments)},u._SparseReshape=function(){return(u._SparseReshape=u.asm.SparseReshape).apply(null,arguments)},u._SparseSegmentReduction=function(){return(u._SparseSegmentReduction=u.asm.SparseSegmentReduction).apply(null,arguments)},u._SparseToDense=function(){return(u._SparseToDense=u.asm.SparseToDense).apply(null,arguments)},u._Sqrt=function(){return(u._Sqrt=u.asm.Sqrt).apply(null,arguments)},u._Square=function(){return(u._Square=u.asm.Square).apply(null,arguments)},u._SquaredDifference=function(){return(u._SquaredDifference=u.asm.SquaredDifference).apply(null,arguments)},u._Step=function(){return(u._Step=u.asm.Step).apply(null,arguments)},u._StridedSlice=function(){return(u._StridedSlice=u.asm.StridedSlice).apply(null,arguments)},u._Sub=function(){return(u._Sub=u.asm.Sub).apply(null,arguments)},u._Sum=function(){return(u._Sum=u.asm.Sum).apply(null,arguments)},u._Tan=function(){return(u._Tan=u.asm.Tan).apply(null,arguments)},u._Tanh=function(){return(u._Tanh=u.asm.Tanh).apply(null,arguments)},u._TensorScatterUpdate=function(){return(u._TensorScatterUpdate=u.asm.TensorScatterUpdate).apply(null,arguments)},u._Tile=function(){return(u._Tile=u.asm.Tile).apply(null,arguments)},u._TopK=function(){return(u._TopK=u.asm.TopK).apply(null,arguments)},u._Transform=function(){return(u._Transform=u.asm.Transform).apply(null,arguments)},u._Transpose=function(){return(u._Transpose=u.asm.Transpose).apply(null,arguments)},u.__FusedMatMul=function(){return(u.__FusedMatMul=u.asm._FusedMatMul).apply(null,arguments)},u._malloc=function(){return(u._malloc=u.asm.malloc).apply(null,arguments)},u._free=function(){return(u._free=u.asm.free).apply(null,arguments)},u.__emscripten_tls_init=function(){return(u.__emscripten_tls_init=u.asm._emscripten_tls_init).apply(null,arguments)};var py=u._pthread_self=function(){return(py=u._pthread_self=u.asm.pthread_self).apply(null,arguments)};u.___errno_location=function(){return(u.___errno_location=u.asm.__errno_location).apply(null,arguments)};var lN=u.__emscripten_thread_init=function(){return(lN=u.__emscripten_thread_init=u.asm._emscripten_thread_init).apply(null,arguments)};u.__emscripten_thread_crashed=function(){return(u.__emscripten_thread_crashed=u.asm._emscripten_thread_crashed).apply(null,arguments)},u._emscripten_main_thread_process_queued_calls=function(){return(u._emscripten_main_thread_process_queued_calls=u.asm.emscripten_main_thread_process_queued_calls).apply(null,arguments)},u._emscripten_main_browser_thread_id=function(){return(u._emscripten_main_browser_thread_id=u.asm.emscripten_main_browser_thread_id).apply(null,arguments)};var uN=u._emscripten_run_in_main_runtime_thread_js=function(){return(uN=u._emscripten_run_in_main_runtime_thread_js=u.asm.emscripten_run_in_main_runtime_thread_js).apply(null,arguments)};u._emscripten_dispatch_to_thread_=function(){return(u._emscripten_dispatch_to_thread_=u.asm.emscripten_dispatch_to_thread_).apply(null,arguments)};var cN=u.__emscripten_proxy_execute_task_queue=function(){return(cN=u.__emscripten_proxy_execute_task_queue=u.asm._emscripten_proxy_execute_task_queue).apply(null,arguments)},Iw=u.__emscripten_thread_free_data=function(){return(Iw=u.__emscripten_thread_free_data=u.asm._emscripten_thread_free_data).apply(null,arguments)},dN=u.__emscripten_thread_exit=function(){return(dN=u.__emscripten_thread_exit=u.asm._emscripten_thread_exit).apply(null,arguments)},pN=u._emscripten_stack_set_limits=function(){return(pN=u._emscripten_stack_set_limits=u.asm.emscripten_stack_set_limits).apply(null,arguments)},$w=u.stackSave=function(){return($w=u.stackSave=u.asm.stackSave).apply(null,arguments)},hy=u.stackRestore=function(){return(hy=u.stackRestore=u.asm.stackRestore).apply(null,arguments)},fy=u.stackAlloc=function(){return(fy=u.stackAlloc=u.asm.stackAlloc).apply(null,arguments)};u.dynCall_iijjiiii=function(){return(u.dynCall_iijjiiii=u.asm.dynCall_iijjiiii).apply(null,arguments)},u.dynCall_jiji=function(){return(u.dynCall_jiji=u.asm.dynCall_jiji).apply(null,arguments)},u.keepRuntimeAlive=Ot,u.wasmMemory=F,u.cwrap=Uj,u.ExitStatus=si,u.PThread=ve;var my;Tn=function W(){my||hN(),my||(Tn=W)};function hN(W){if(bn>0)return;if(v){d(u),yn(),startWorker(u);return}if(Qn(),bn>0)return;function J(){my||(my=!0,u.calledRun=!0,!B&&(yn(),d(u),u.onRuntimeInitialized&&u.onRuntimeInitialized(),Jn()))}u.setStatus?(u.setStatus("Running..."),setTimeout(function(){setTimeout(function(){u.setStatus("")},1),J()},1)):J()}if(u.preInit)for(typeof u.preInit=="function"&&(u.preInit=[u.preInit]);u.preInit.length>0;)u.preInit.pop()();hN();var gy;h&&(gy={uncaughtException:process.listeners("uncaughtException").filter(function(W){return!h.uncaughtException.indexOf(W)>-1}),unhandledRejection:process.listeners("unhandledRejection").filter(function(W){return!h.unhandledRejection.indexOf(W)>-1})});var yy;if(typeof WasmBackendModule<"u")yy=WasmBackendModule;else if(typeof a<"u")yy=a;else throw new Error("Could not find wasm module in post.js");if(gy){var Hj=yy._dispose;yy._dispose=function(){Hj(),gy.uncaughtException.forEach(function(W){process.removeListener("uncaughtException",W)}),gy.unhandledRejection.forEach(function(W){process.removeListener("unhandledRejection",W)})}}return a.ready}})();typeof e=="object"&&typeof t=="object"?t.exports=n:typeof define=="function"&&define.amd?define([],function(){return n}):typeof e=="object"&&(e.WasmBackendModuleThreadedSimd=n)}),cZ=mn((e,t)=>{t.exports.wasmWorkerContents='"use strict";var Module={};var ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string";if(ENVIRONMENT_IS_NODE){var nodeWorkerThreads=require("worker_threads");var parentPort=nodeWorkerThreads.parentPort;parentPort.on("message",data=>onmessage({data:data}));var fs=require("fs");Object.assign(global,{self:global,require:require,Module:Module,location:{href:__filename},Worker:nodeWorkerThreads.Worker,importScripts:function(f){(0,eval)(fs.readFileSync(f,"utf8")+"//# sourceURL="+f)},postMessage:function(msg){parentPort.postMessage(msg)},performance:global.performance||{now:function(){return Date.now()}}})}var initializedJS=false;var pendingNotifiedProxyingQueues=[];function threadPrintErr(){var text=Array.prototype.slice.call(arguments).join(" ");if(ENVIRONMENT_IS_NODE){fs.writeSync(2,text+"\n");return}console.error(text)}function threadAlert(){var text=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:text,threadId:Module["_pthread_self"]()})}var err=threadPrintErr;self.alert=threadAlert;Module["instantiateWasm"]=(info,receiveInstance)=>{var instance=new WebAssembly.Instance(Module["wasmModule"],info);receiveInstance(instance);Module["wasmModule"]=null;return instance.exports};self.onunhandledrejection=e=>{throw e.reason??e};self.startWorker=instance=>{Module=instance;postMessage({"cmd":"loaded"})};self.onmessage=e=>{try{if(e.data.cmd==="load"){Module["wasmModule"]=e.data.wasmModule;for(const handler of e.data.handlers){Module[handler]=function(){postMessage({cmd:"callHandler",handler:handler,args:[...arguments]})}}Module["wasmMemory"]=e.data.wasmMemory;Module["buffer"]=Module["wasmMemory"].buffer;Module["ENVIRONMENT_IS_PTHREAD"]=true;if(typeof e.data.urlOrBlob=="string"){importScripts(e.data.urlOrBlob)}else{var objectUrl=URL.createObjectURL(e.data.urlOrBlob);importScripts(objectUrl);URL.revokeObjectURL(objectUrl)}WasmBackendModuleThreadedSimd(Module)}else if(e.data.cmd==="run"){Module["__emscripten_thread_init"](e.data.pthread_ptr,0,0,1);Module["establishStackSpace"]();Module["PThread"].receiveObjectTransfer(e.data);Module["PThread"].threadInitTLS();if(!initializedJS){pendingNotifiedProxyingQueues.forEach(queue=>{Module["executeNotifiedProxyingQueue"](queue)});pendingNotifiedProxyingQueues=[];initializedJS=true}try{Module["invokeEntryPoint"](e.data.start_routine,e.data.arg)}catch(ex){if(ex!="unwind"){if(ex instanceof Module["ExitStatus"]){if(Module["keepRuntimeAlive"]()){}else{Module["__emscripten_thread_exit"](ex.status)}}else{throw ex}}}}else if(e.data.cmd==="cancel"){if(Module["_pthread_self"]()){Module["__emscripten_thread_exit"](-1)}}else if(e.data.target==="setimmediate"){}else if(e.data.cmd==="processProxyingQueue"){if(initializedJS){Module["executeNotifiedProxyingQueue"](e.data.queue)}else{pendingNotifiedProxyingQueues.push(e.data.queue)}}else if(e.data.cmd){err("worker.js received unknown command "+e.data.cmd);err(e.data)}}catch(ex){if(Module["__emscripten_thread_crashed"]){Module["__emscripten_thread_crashed"]()}throw ex}};'}),dZ=mn((e,t)=>{var n=(()=>{var r=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(r=r||__filename),function(a){a=a||{};var i=typeof a<"u"?a:{},s,o;i.ready=new Promise(function(ie,ue){s=ie,o=ue});var l;typeof process<"u"&&process.listeners&&(l={uncaughtException:process.listeners("uncaughtException"),unhandledRejection:process.listeners("unhandledRejection")});var c=Object.assign({},i),u=typeof window=="object",d=typeof importScripts=="function",p=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",h="";function f(ie){return i.locateFile?i.locateFile(ie,h):h+ie}var m,g,y;if(p){var b=D$(),v=UL();d?h=v.dirname(h)+"/":h=__dirname+"/",m=(ie,ue)=>(ie=tt(ie)?new URL(ie):v.normalize(ie),b.readFileSync(ie,ue?void 0:"utf8")),y=ie=>{var ue=m(ie,!0);return ue.buffer||(ue=new Uint8Array(ue)),ue},g=(ie,ue,Ce)=>{ie=tt(ie)?new URL(ie):v.normalize(ie),b.readFile(ie,function(ve,yt){ve?Ce(ve):ue(yt.buffer)})},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",function(ie){if(!(ie instanceof Ot))throw ie}),process.on("unhandledRejection",function(ie){throw ie}),i.inspect=function(){return"[Emscripten Module object]"}}else(u||d)&&(d?h=self.location.href:typeof document<"u"&&document.currentScript&&(h=document.currentScript.src),r&&(h=r),h.indexOf("blob:")!==0?h=h.substr(0,h.replace(/[?#].*/,"").lastIndexOf("/")+1):h="",m=ie=>{var ue=new XMLHttpRequest;return ue.open("GET",ie,!1),ue.send(null),ue.responseText},d&&(y=ie=>{var ue=new XMLHttpRequest;return ue.open("GET",ie,!1),ue.responseType="arraybuffer",ue.send(null),new Uint8Array(ue.response)}),g=(ie,ue,Ce)=>{var ve=new XMLHttpRequest;ve.open("GET",ie,!0),ve.responseType="arraybuffer",ve.onload=()=>{if(ve.status==200||ve.status==0&&ve.response){ue(ve.response);return}Ce()},ve.onerror=Ce,ve.send(null)});var x=i.print||console.log.bind(console),w=i.printErr||console.warn.bind(console);Object.assign(i,c),c=null,i.arguments&&i.arguments,i.thisProgram&&i.thisProgram,i.quit&&i.quit;var $;i.wasmBinary&&($=i.wasmBinary),i.noExitRuntime,typeof WebAssembly!="object"&&Pe("no native wasm support detected");var C,E=!1,_=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function R(ie,ue,Ce){ue>>>=0;for(var ve=ue+Ce,yt=ue;ie[yt]&&!(yt>=ve);)++yt;if(yt-ue>16&&ie.buffer&&_)return _.decode(ie.subarray(ue,yt));for(var $t="";ue<yt;){var ze=ie[ue++];if(!(ze&128)){$t+=String.fromCharCode(ze);continue}var Be=ie[ue++]&63;if((ze&224)==192){$t+=String.fromCharCode((ze&31)<<6|Be);continue}var Ut=ie[ue++]&63;if((ze&240)==224?ze=(ze&15)<<12|Be<<6|Ut:ze=(ze&7)<<18|Be<<12|Ut<<6|ie[ue++]&63,ze<65536)$t+=String.fromCharCode(ze);else{var Rt=ze-65536;$t+=String.fromCharCode(55296|Rt>>10,56320|Rt&1023)}}return $t}function N(ie,ue){return ie>>>=0,ie?R(U,ie,ue):""}function I(ie,ue,Ce,ve){if(Ce>>>=0,!(ve>0))return 0;for(var yt=Ce,$t=Ce+ve-1,ze=0;ze<ie.length;++ze){var Be=ie.charCodeAt(ze);if(Be>=55296&&Be<=57343){var Ut=ie.charCodeAt(++ze);Be=65536+((Be&1023)<<10)|Ut&1023}if(Be<=127){if(Ce>=$t)break;ue[Ce++>>>0]=Be}else if(Be<=2047){if(Ce+1>=$t)break;ue[Ce++>>>0]=192|Be>>6,ue[Ce++>>>0]=128|Be&63}else if(Be<=65535){if(Ce+2>=$t)break;ue[Ce++>>>0]=224|Be>>12,ue[Ce++>>>0]=128|Be>>6&63,ue[Ce++>>>0]=128|Be&63}else{if(Ce+3>=$t)break;ue[Ce++>>>0]=240|Be>>18,ue[Ce++>>>0]=128|Be>>12&63,ue[Ce++>>>0]=128|Be>>6&63,ue[Ce++>>>0]=128|Be&63}}return ue[Ce>>>0]=0,Ce-yt}function O(ie,ue,Ce){return I(ie,U,ue,Ce)}var P,L,U,D;function F(ie){P=ie,i.HEAP8=L=new Int8Array(ie),i.HEAP16=new Int16Array(ie),i.HEAP32=new Int32Array(ie),i.HEAPU8=U=new Uint8Array(ie),i.HEAPU16=new Uint16Array(ie),i.HEAPU32=D=new Uint32Array(ie),i.HEAPF32=new Float32Array(ie),i.HEAPF64=new Float64Array(ie)}i.INITIAL_MEMORY;var z=[],B=[],j=[];function Y(){if(i.preRun)for(typeof i.preRun=="function"&&(i.preRun=[i.preRun]);i.preRun.length;)se(i.preRun.shift());Qn(z)}function Q(){Qn(B)}function ae(){if(i.postRun)for(typeof i.postRun=="function"&&(i.postRun=[i.postRun]);i.postRun.length;)me(i.postRun.shift());Qn(j)}function se(ie){z.unshift(ie)}function fe(ie){B.unshift(ie)}function me(ie){j.unshift(ie)}var he=0,Te=null;function Fe(ie){he++,i.monitorRunDependencies&&i.monitorRunDependencies(he)}function Ve(ie){if(he--,i.monitorRunDependencies&&i.monitorRunDependencies(he),he==0&&Te){var ue=Te;Te=null,ue()}}function Pe(ie){i.onAbort&&i.onAbort(ie),ie="Aborted("+ie+")",w(ie),E=!0,ie+=". Build with -sASSERTIONS for more info.";var ue=new WebAssembly.RuntimeError(ie);throw o(ue),ue}var pt="data:application/octet-stream;base64,";function Je(ie){return ie.startsWith(pt)}function tt(ie){return ie.startsWith("file://")}var Le;Le="tfjs-backend-wasm.wasm",Je(Le)||(Le=f(Le));function st(ie){try{if(ie==Le&&$)return new Uint8Array($);if(y)return y(ie);throw"both async and sync fetching of the wasm failed"}catch(ue){Pe(ue)}}function gt(){if(!$&&(u||d)){if(typeof fetch=="function"&&!tt(Le))return fetch(Le,{credentials:"same-origin"}).then(function(ie){if(!ie.ok)throw"failed to load wasm binary file at '"+Le+"'";return ie.arrayBuffer()}).catch(function(){return st(Le)});if(g)return new Promise(function(ie,ue){g(Le,function(Ce){ie(new Uint8Array(Ce))},ue)})}return Promise.resolve().then(function(){return st(Le)})}function pr(){var ie={env:Qc,wasi_snapshot_preview1:Qc};function ue(ze,Be){var Ut=ze.exports;i.asm=Ut,C=i.asm.memory,F(C.buffer),i.asm.__indirect_function_table,fe(i.asm.__wasm_call_ctors),Ve()}Fe();function Ce(ze){ue(ze.instance)}function ve(ze){return gt().then(function(Be){return WebAssembly.instantiate(Be,ie)}).then(function(Be){return Be}).then(ze,function(Be){w("failed to asynchronously prepare wasm: "+Be),Pe(Be)})}function yt(){return!$&&typeof WebAssembly.instantiateStreaming=="function"&&!Je(Le)&&!tt(Le)&&!p&&typeof fetch=="function"?fetch(Le,{credentials:"same-origin"}).then(function(ze){var Be=WebAssembly.instantiateStreaming(ze,ie);return Be.then(Ce,function(Ut){return w("wasm streaming compile failed: "+Ut),w("falling back to ArrayBuffer instantiation"),ve(Ce)})}):ve(Ce)}if(i.instantiateWasm)try{var $t=i.instantiateWasm(ie,ue);return $t}catch(ze){w("Module.instantiateWasm callback failed with error: "+ze),o(ze)}return yt().catch(o),{}}function Ot(ie){this.name="ExitStatus",this.message="Program terminated with exit("+ie+")",this.status=ie}function Qn(ie){for(;ie.length>0;)ie.shift()(i)}function yn(){Pe("")}function Jn(){return 4294901760}function Yr(){return Jn()}function hr(ie,ue,Ce){U.copyWithin(ie>>>0,ue>>>0,ue+Ce>>>0)}function er(ie){try{return C.grow(ie-P.byteLength+65535>>>16),F(C.buffer),1}catch(ue){}}function bn(ie){var ue=U.length;ie=ie>>>0;var Ce=Jn();if(ie>Ce)return!1;let ve=(Ut,Rt)=>Ut+(Rt-Ut%Rt)%Rt;for(var yt=1;yt<=4;yt*=2){var $t=ue*(1+.2/yt);$t=Math.min($t,ie+100663296);var ze=Math.min(Ce,ve(Math.max(ie,$t),65536)),Be=er(ze);if(Be)return!0}return!1}function Tn(ie){return 52}function Mr(ie,ue,Ce,ve,yt){return 70}var ii=[null,[],[]];function on(ie,ue){var Ce=ii[ie];ue===0||ue===10?((ie===1?x:w)(R(Ce,0)),Ce.length=0):Ce.push(ue)}function Zr(ie,ue,Ce,ve){for(var yt=0,$t=0;$t<Ce;$t++){var ze=D[ue>>>2],Be=D[ue+4>>>2];ue+=8;for(var Ut=0;Ut<Be;Ut++)on(ie,U[ze+Ut>>>0]);yt+=Be}return D[ve>>>2]=yt,0}function tr(ie){var ue=i["_"+ie];return ue}function Bi(ie,ue){L.set(ie,ue>>>0)}function vn(ie,ue,Ce,ve,yt){var $t={string:Wn=>{var Wi=0;if(Wn!=null&&Wn!==0){var qs=(Wn.length<<2)+1;Wi=si(qs),O(Wn,Wi,qs)}return Wi},array:Wn=>{var Wi=si(Wn.length);return Bi(Wn,Wi),Wi}};function ze(Wn){return ue==="string"?N(Wn):ue==="boolean"?!!Wn:Wn}var Be=tr(ie),Ut=[],Rt=0;if(ve)for(var oi=0;oi<ve.length;oi++){var rd=$t[Ce[oi]];rd?(Rt===0&&(Rt=Jc()),Ut[oi]=rd(ve[oi])):Ut[oi]=ve[oi]}var ll=Be.apply(null,Ut);function ul(Wn){return Rt!==0&&ed(Rt),ze(Wn)}return ll=ul(ll),ll}function Zc(ie,ue,Ce,ve){Ce=Ce||[];var yt=Ce.every(ze=>ze==="number"||ze==="boolean"),$t=ue!=="string";return $t&&yt&&!ve?tr(ie):function(){return vn(ie,ue,Ce,arguments)}}var Qc={abort:yn,emscripten_get_heap_max:Yr,emscripten_memcpy_big:hr,emscripten_resize_heap:bn,fd_close:Tn,fd_seek:Mr,fd_write:Zr};pr(),i.___wasm_call_ctors=function(){return(i.___wasm_call_ctors=i.asm.__wasm_call_ctors).apply(null,arguments)},i._init=function(){return(i._init=i.asm.init).apply(null,arguments)},i._init_with_threads_count=function(){return(i._init_with_threads_count=i.asm.init_with_threads_count).apply(null,arguments)},i._get_threads_count=function(){return(i._get_threads_count=i.asm.get_threads_count).apply(null,arguments)},i._register_tensor=function(){return(i._register_tensor=i.asm.register_tensor).apply(null,arguments)},i._dispose_data=function(){return(i._dispose_data=i.asm.dispose_data).apply(null,arguments)},i._dispose=function(){return(i._dispose=i.asm.dispose).apply(null,arguments)},i._Abs=function(){return(i._Abs=i.asm.Abs).apply(null,arguments)},i._Acos=function(){return(i._Acos=i.asm.Acos).apply(null,arguments)},i._Acosh=function(){return(i._Acosh=i.asm.Acosh).apply(null,arguments)},i._Add=function(){return(i._Add=i.asm.Add).apply(null,arguments)},i._AddN=function(){return(i._AddN=i.asm.AddN).apply(null,arguments)},i._All=function(){return(i._All=i.asm.All).apply(null,arguments)},i._Any=function(){return(i._Any=i.asm.Any).apply(null,arguments)},i._ArgMax=function(){return(i._ArgMax=i.asm.ArgMax).apply(null,arguments)},i._ArgMin=function(){return(i._ArgMin=i.asm.ArgMin).apply(null,arguments)},i._Asin=function(){return(i._Asin=i.asm.Asin).apply(null,arguments)},i._Asinh=function(){return(i._Asinh=i.asm.Asinh).apply(null,arguments)},i._Atan=function(){return(i._Atan=i.asm.Atan).apply(null,arguments)},i._Atan2=function(){return(i._Atan2=i.asm.Atan2).apply(null,arguments)},i._Atanh=function(){return(i._Atanh=i.asm.Atanh).apply(null,arguments)},i._AvgPool=function(){return(i._AvgPool=i.asm.AvgPool).apply(null,arguments)},i._AvgPool3D=function(){return(i._AvgPool3D=i.asm.AvgPool3D).apply(null,arguments)},i._AvgPool3DGrad=function(){return(i._AvgPool3DGrad=i.asm.AvgPool3DGrad).apply(null,arguments)},i._AvgPoolGrad=function(){return(i._AvgPoolGrad=i.asm.AvgPoolGrad).apply(null,arguments)},i._BatchMatMul=function(){return(i._BatchMatMul=i.asm.BatchMatMul).apply(null,arguments)},i._Bincount=function(){return(i._Bincount=i.asm.Bincount).apply(null,arguments)},i._BitwiseAnd=function(){return(i._BitwiseAnd=i.asm.BitwiseAnd).apply(null,arguments)},i._Ceil=function(){return(i._Ceil=i.asm.Ceil).apply(null,arguments)},i._ClipByValue=function(){return(i._ClipByValue=i.asm.ClipByValue).apply(null,arguments)},i._Conv2D=function(){return(i._Conv2D=i.asm.Conv2D).apply(null,arguments)},i._Conv2DBackpropInput=function(){return(i._Conv2DBackpropInput=i.asm.Conv2DBackpropInput).apply(null,arguments)},i._Conv3D=function(){return(i._Conv3D=i.asm.Conv3D).apply(null,arguments)},i._Conv3DBackpropFilterV2=function(){return(i._Conv3DBackpropFilterV2=i.asm.Conv3DBackpropFilterV2).apply(null,arguments)},i._Conv3DBackpropInputV2=function(){return(i._Conv3DBackpropInputV2=i.asm.Conv3DBackpropInputV2).apply(null,arguments)},i._Cos=function(){return(i._Cos=i.asm.Cos).apply(null,arguments)},i._Cosh=function(){return(i._Cosh=i.asm.Cosh).apply(null,arguments)},i._CropAndResize=function(){return(i._CropAndResize=i.asm.CropAndResize).apply(null,arguments)},i._Cumprod=function(){return(i._Cumprod=i.asm.Cumprod).apply(null,arguments)},i._Cumsum=function(){return(i._Cumsum=i.asm.Cumsum).apply(null,arguments)},i._DenseBincount=function(){return(i._DenseBincount=i.asm.DenseBincount).apply(null,arguments)},i._DepthToSpace=function(){return(i._DepthToSpace=i.asm.DepthToSpace).apply(null,arguments)},i._DepthwiseConv2dNative=function(){return(i._DepthwiseConv2dNative=i.asm.DepthwiseConv2dNative).apply(null,arguments)},i._Diag=function(){return(i._Diag=i.asm.Diag).apply(null,arguments)},i._Dilation2D=function(){return(i._Dilation2D=i.asm.Dilation2D).apply(null,arguments)},i._Dilation2DBackpropFilter=function(){return(i._Dilation2DBackpropFilter=i.asm.Dilation2DBackpropFilter).apply(null,arguments)},i._Dilation2DBackpropInput=function(){return(i._Dilation2DBackpropInput=i.asm.Dilation2DBackpropInput).apply(null,arguments)},i._Elu=function(){return(i._Elu=i.asm.Elu).apply(null,arguments)},i._EluGrad=function(){return(i._EluGrad=i.asm.EluGrad).apply(null,arguments)},i._Equal=function(){return(i._Equal=i.asm.Equal).apply(null,arguments)},i._Erf=function(){return(i._Erf=i.asm.Erf).apply(null,arguments)},i._Exp=function(){return(i._Exp=i.asm.Exp).apply(null,arguments)},i._Expm1=function(){return(i._Expm1=i.asm.Expm1).apply(null,arguments)},i._FlipLeftRight=function(){return(i._FlipLeftRight=i.asm.FlipLeftRight).apply(null,arguments)},i._Floor=function(){return(i._Floor=i.asm.Floor).apply(null,arguments)},i._FloorDiv=function(){return(i._FloorDiv=i.asm.FloorDiv).apply(null,arguments)},i._FusedBatchNorm=function(){return(i._FusedBatchNorm=i.asm.FusedBatchNorm).apply(null,arguments)},i._FusedConv2D=function(){return(i._FusedConv2D=i.asm.FusedConv2D).apply(null,arguments)},i._FusedDepthwiseConv2D=function(){return(i._FusedDepthwiseConv2D=i.asm.FusedDepthwiseConv2D).apply(null,arguments)},i._Gather=function(){return(i._Gather=i.asm.Gather).apply(null,arguments)},i._GatherNd=function(){return(i._GatherNd=i.asm.GatherNd).apply(null,arguments)},i._Greater=function(){return(i._Greater=i.asm.Greater).apply(null,arguments)},i._GreaterEqual=function(){return(i._GreaterEqual=i.asm.GreaterEqual).apply(null,arguments)},i._IsFinite=function(){return(i._IsFinite=i.asm.IsFinite).apply(null,arguments)},i._IsInf=function(){return(i._IsInf=i.asm.IsInf).apply(null,arguments)},i._IsNan=function(){return(i._IsNan=i.asm.IsNan).apply(null,arguments)},i._LRN=function(){return(i._LRN=i.asm.LRN).apply(null,arguments)},i._LRNGrad=function(){return(i._LRNGrad=i.asm.LRNGrad).apply(null,arguments)},i._LeakyRelu=function(){return(i._LeakyRelu=i.asm.LeakyRelu).apply(null,arguments)},i._Less=function(){return(i._Less=i.asm.Less).apply(null,arguments)},i._LessEqual=function(){return(i._LessEqual=i.asm.LessEqual).apply(null,arguments)},i._LinSpace=function(){return(i._LinSpace=i.asm.LinSpace).apply(null,arguments)},i._Log=function(){return(i._Log=i.asm.Log).apply(null,arguments)},i._Log1p=function(){return(i._Log1p=i.asm.Log1p).apply(null,arguments)},i._LogicalAnd=function(){return(i._LogicalAnd=i.asm.LogicalAnd).apply(null,arguments)},i._LogicalNot=function(){return(i._LogicalNot=i.asm.LogicalNot).apply(null,arguments)},i._LogicalOr=function(){return(i._LogicalOr=i.asm.LogicalOr).apply(null,arguments)},i._LogicalXor=function(){return(i._LogicalXor=i.asm.LogicalXor).apply(null,arguments)},i._Max=function(){return(i._Max=i.asm.Max).apply(null,arguments)},i._MaxPool=function(){return(i._MaxPool=i.asm.MaxPool).apply(null,arguments)},i._MaxPool3D=function(){return(i._MaxPool3D=i.asm.MaxPool3D).apply(null,arguments)},i._MaxPool3DGrad=function(){return(i._MaxPool3DGrad=i.asm.MaxPool3DGrad).apply(null,arguments)},i._MaxPoolGrad=function(){return(i._MaxPoolGrad=i.asm.MaxPoolGrad).apply(null,arguments)},i._MaxPoolWithArgmax=function(){return(i._MaxPoolWithArgmax=i.asm.MaxPoolWithArgmax).apply(null,arguments)},i._Maximum=function(){return(i._Maximum=i.asm.Maximum).apply(null,arguments)},i._Mean=function(){return(i._Mean=i.asm.Mean).apply(null,arguments)},i._Min=function(){return(i._Min=i.asm.Min).apply(null,arguments)},i._Minimum=function(){return(i._Minimum=i.asm.Minimum).apply(null,arguments)},i._MirrorPad=function(){return(i._MirrorPad=i.asm.MirrorPad).apply(null,arguments)},i._Mod=function(){return(i._Mod=i.asm.Mod).apply(null,arguments)},i._Multinomial=function(){return(i._Multinomial=i.asm.Multinomial).apply(null,arguments)},i._Multiply=function(){return(i._Multiply=i.asm.Multiply).apply(null,arguments)},i._Neg=function(){return(i._Neg=i.asm.Neg).apply(null,arguments)},i._NonMaxSuppressionV3=function(){return(i._NonMaxSuppressionV3=i.asm.NonMaxSuppressionV3).apply(null,arguments)},i._NonMaxSuppressionV4=function(){return(i._NonMaxSuppressionV4=i.asm.NonMaxSuppressionV4).apply(null,arguments)},i._NonMaxSuppressionV5=function(){return(i._NonMaxSuppressionV5=i.asm.NonMaxSuppressionV5).apply(null,arguments)},i._NotEqual=function(){return(i._NotEqual=i.asm.NotEqual).apply(null,arguments)},i._OneHot=function(){return(i._OneHot=i.asm.OneHot).apply(null,arguments)},i._PadV2=function(){return(i._PadV2=i.asm.PadV2).apply(null,arguments)},i._Pow=function(){return(i._Pow=i.asm.Pow).apply(null,arguments)},i._Prelu=function(){return(i._Prelu=i.asm.Prelu).apply(null,arguments)},i._Prod=function(){return(i._Prod=i.asm.Prod).apply(null,arguments)},i._RealDiv=function(){return(i._RealDiv=i.asm.RealDiv).apply(null,arguments)},i._Reciprocal=function(){return(i._Reciprocal=i.asm.Reciprocal).apply(null,arguments)},i._Relu=function(){return(i._Relu=i.asm.Relu).apply(null,arguments)},i._Relu6=function(){return(i._Relu6=i.asm.Relu6).apply(null,arguments)},i._ResizeBilinear=function(){return(i._ResizeBilinear=i.asm.ResizeBilinear).apply(null,arguments)},i._ResizeBilinearGrad=function(){return(i._ResizeBilinearGrad=i.asm.ResizeBilinearGrad).apply(null,arguments)},i._ResizeNearestNeighbor=function(){return(i._ResizeNearestNeighbor=i.asm.ResizeNearestNeighbor).apply(null,arguments)},i._ResizeNearestNeighborGrad=function(){return(i._ResizeNearestNeighborGrad=i.asm.ResizeNearestNeighborGrad).apply(null,arguments)},i._Reverse=function(){return(i._Reverse=i.asm.Reverse).apply(null,arguments)},i._RotateWithOffset=function(){return(i._RotateWithOffset=i.asm.RotateWithOffset).apply(null,arguments)},i._Round=function(){return(i._Round=i.asm.Round).apply(null,arguments)},i._Rsqrt=function(){return(i._Rsqrt=i.asm.Rsqrt).apply(null,arguments)},i._ScatterNd=function(){return(i._ScatterNd=i.asm.ScatterNd).apply(null,arguments)},i._SearchSorted=function(){return(i._SearchSorted=i.asm.SearchSorted).apply(null,arguments)},i._SelectV2=function(){return(i._SelectV2=i.asm.SelectV2).apply(null,arguments)},i._Selu=function(){return(i._Selu=i.asm.Selu).apply(null,arguments)},i._Sigmoid=function(){return(i._Sigmoid=i.asm.Sigmoid).apply(null,arguments)},i._Sign=function(){return(i._Sign=i.asm.Sign).apply(null,arguments)},i._Sin=function(){return(i._Sin=i.asm.Sin).apply(null,arguments)},i._Sinh=function(){return(i._Sinh=i.asm.Sinh).apply(null,arguments)},i._Softmax=function(){return(i._Softmax=i.asm.Softmax).apply(null,arguments)},i._Softplus=function(){return(i._Softplus=i.asm.Softplus).apply(null,arguments)},i._SparseFillEmptyRows=function(){return(i._SparseFillEmptyRows=i.asm.SparseFillEmptyRows).apply(null,arguments)},i._SparseReshape=function(){return(i._SparseReshape=i.asm.SparseReshape).apply(null,arguments)},i._SparseSegmentReduction=function(){return(i._SparseSegmentReduction=i.asm.SparseSegmentReduction).apply(null,arguments)},i._SparseToDense=function(){return(i._SparseToDense=i.asm.SparseToDense).apply(null,arguments)},i._Sqrt=function(){return(i._Sqrt=i.asm.Sqrt).apply(null,arguments)},i._Square=function(){return(i._Square=i.asm.Square).apply(null,arguments)},i._SquaredDifference=function(){return(i._SquaredDifference=i.asm.SquaredDifference).apply(null,arguments)},i._Step=function(){return(i._Step=i.asm.Step).apply(null,arguments)},i._StridedSlice=function(){return(i._StridedSlice=i.asm.StridedSlice).apply(null,arguments)},i._Sub=function(){return(i._Sub=i.asm.Sub).apply(null,arguments)},i._Sum=function(){return(i._Sum=i.asm.Sum).apply(null,arguments)},i._Tan=function(){return(i._Tan=i.asm.Tan).apply(null,arguments)},i._Tanh=function(){return(i._Tanh=i.asm.Tanh).apply(null,arguments)},i._TensorScatterUpdate=function(){return(i._TensorScatterUpdate=i.asm.TensorScatterUpdate).apply(null,arguments)},i._Tile=function(){return(i._Tile=i.asm.Tile).apply(null,arguments)},i._TopK=function(){return(i._TopK=i.asm.TopK).apply(null,arguments)},i._Transform=function(){return(i._Transform=i.asm.Transform).apply(null,arguments)},i._Transpose=function(){return(i._Transpose=i.asm.Transpose).apply(null,arguments)},i.__FusedMatMul=function(){return(i.__FusedMatMul=i.asm._FusedMatMul).apply(null,arguments)},i._malloc=function(){return(i._malloc=i.asm.malloc).apply(null,arguments)},i._free=function(){return(i._free=i.asm.free).apply(null,arguments)},i.___errno_location=function(){return(i.___errno_location=i.asm.__errno_location).apply(null,arguments)};var Jc=i.stackSave=function(){return(Jc=i.stackSave=i.asm.stackSave).apply(null,arguments)},ed=i.stackRestore=function(){return(ed=i.stackRestore=i.asm.stackRestore).apply(null,arguments)},si=i.stackAlloc=function(){return(si=i.stackAlloc=i.asm.stackAlloc).apply(null,arguments)};i.dynCall_iijjiiii=function(){return(i.dynCall_iijjiiii=i.asm.dynCall_iijjiiii).apply(null,arguments)},i.dynCall_jiji=function(){return(i.dynCall_jiji=i.asm.dynCall_jiji).apply(null,arguments)},i.cwrap=Zc;var Gs;Te=function ie(){Gs||td(),Gs||(Te=ie)};function td(ie){if(he>0||(Y(),he>0))return;function ue(){Gs||(Gs=!0,i.calledRun=!0,!E&&(Q(),s(i),i.onRuntimeInitialized&&i.onRuntimeInitialized(),ae()))}i.setStatus?(i.setStatus("Running..."),setTimeout(function(){setTimeout(function(){i.setStatus("")},1),ue()},1)):ue()}if(i.preInit)for(typeof i.preInit=="function"&&(i.preInit=[i.preInit]);i.preInit.length>0;)i.preInit.pop()();td();var ps;l&&(ps={uncaughtException:process.listeners("uncaughtException").filter(function(ie){return!l.uncaughtException.indexOf(ie)>-1}),unhandledRejection:process.listeners("unhandledRejection").filter(function(ie){return!l.unhandledRejection.indexOf(ie)>-1})});var hs;if(typeof a<"u")hs=a;else if(typeof WasmBackendModuleThreadedSimd<"u")hs=WasmBackendModuleThreadedSimd;else throw new Error("Could not find wasm module in post.js");if(ps){var nd=hs._dispose;hs._dispose=function(){nd(),ps.uncaughtException.forEach(function(ie){process.removeListener("uncaughtException",ie)}),ps.unhandledRejection.forEach(function(ie){process.removeListener("unhandledRejection",ie)})}}return a.ready}})();typeof e=="object"&&typeof t=="object"?t.exports=n:typeof define=="function"&&define.amd?define([],function(){return n}):typeof e=="object"&&(e.WasmBackendModule=n)}),G0=class{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}},eg=class{refCount(e){return Qr("refCount")}incRef(e){return Qr("incRef")}timerAvailable(){return!0}time(e){return Qr("time")}read(e){return Qr("read")}readSync(e){return Qr("readSync")}readToGPU(e,t){return Qr("readToGPU")}numDataIds(){return Qr("numDataIds")}disposeData(e,t){return Qr("disposeData")}write(e,t,n){return Qr("write")}move(e,t,n,r,a){return Qr("move")}createTensorFromGPUData(e,t,n){return Qr("createTensorFromGPUData")}memory(){return Qr("memory")}floatPrecision(){return Qr("floatPrecision")}epsilon(){return this.floatPrecision()===32?1e-7:1e-4}dispose(){return Qr("dispose")}};function Qr(e){throw new Error("'".concat(e,"' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen"))}function VL(e){let t=e.length,n=0;for(;t>0;)n=Math.random()*t|0,t--,yv(e,t,n)}function pZ(e,t){if(e.length!==t.length)throw new Error("Array sizes must match to be shuffled together First array length was ".concat(e.length,"Second array length was ").concat(t.length));let n=e.length,r=0;for(;n>0;)r=Math.random()*n|0,n--,yv(e,n,r),yv(t,n,r)}function wm(e,t,n){return Math.max(e,Math.min(t,n))}function hZ(e){return e%2===0?e:e+1}function yv(e,t,n){let r=e[t];e[t]=e[n],e[n]=r}function fZ(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n];return t}function mZ(e,t){let n=Math.random();return t*n+(1-n)*e}function gZ(e,t){let n=0;for(let r=0;r<e.length;r++){let a=Number(e[r])-Number(t[r]);n+=a*a}return n}function M(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}function Ar(e,t,n=""){M(Bs(e,t),()=>n+" Shapes ".concat(e," and ").concat(t," must match"))}function xu(e){M(e!=null,()=>"The input to the tensor constructor must be a non-null value.")}function Nt(e){if(e.length===0)return 1;let t=e[0];for(let n=1;n<e.length;n++)t*=e[n];return t}function yZ(e){return e.length===0}function HL(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==null&&t[n]!==null&&e[n]!==t[n])return!1;return!0}function Bs(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function np(e){return e%1===0}function bZ(e){if(Math.tanh!=null)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;{let t=Math.exp(2*e);return(t-1)/(t+1)}}function vZ(e){let t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function xZ(e){let t=new Uint32Array(e);for(let n=0;n<e;++n)t[n]=n;return VL(t),t}function Gf(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function wZ(e,t=a=>0,n,r){return new Promise((a,i)=>{let s=0,o=()=>{if(e()){a();return}s++;let l=t(s);if(n!=null&&s>=n){i();return}r!=null?r(o,l):setTimeout(o,l)};o()})}function kZ(e,t){let n=1,r=-1;for(let i=0;i<e.length;++i)if(e[i]>=0)n*=e[i];else if(e[i]===-1){if(r!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim ".concat(r," and dim ").concat(i));r=i}else if(e[i]<0)throw Error("Shapes can not be < 0. Found ".concat(e[i]," at dim ").concat(i));if(r===-1){if(t>0&&t!==n)throw Error("Size(".concat(t,") must match the product of shape ").concat(e));return e}if(n===0)throw Error("Cannot infer the missing size in [".concat(e,"] when there are 0 elements"));if(t%n!==0)throw Error("The implicit shape can't be a fractional number. Got ".concat(t," / ").concat(n));let a=e.slice();return a[r]=t/n,a}function ni(e,t){let n=t.length;return e=e==null?t.map((r,a)=>a):[].concat(e),M(e.every(r=>r>=-n&&r<n),()=>"All values in axis param must be in range [-".concat(n,", ").concat(n,") but got axis ").concat(e)),M(e.every(r=>np(r)),()=>"All values in axis param must be integers but got axis ".concat(e)),e.map(r=>r<0?n+r:r)}function jL(e,t){let n=[],r=[],a=t!=null&&Array.isArray(t)&&t.length===0,i=t==null||a?null:ni(t,e).sort(),s=0;for(let o=0;o<e.length;++o){if(i!=null){if(i[s]===o&&e[o]!==1)throw new Error("Can't squeeze axis ".concat(o," since its dim '").concat(e[o],"' is not 1"));(i[s]==null||i[s]>o)&&e[o]===1&&(n.push(e[o]),r.push(o)),i[s]<=o&&s++}e[o]!==1&&(n.push(e[o]),r.push(o))}return{newShape:n,keptDims:r}}function GL(e,t){return F$(e,t)}function F$(e,t){let n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else if(e==="bool")n=new Uint8Array(t);else if(e==="string")n=new Array(t);else throw new Error("Unknown data type ".concat(e));return n}function qL(e,t){for(let n=0;n<e.length;n++){let r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type ".concat(t," being uploaded contains ").concat(r,"."))}}function KL(e){return e==="bool"||e==="complex64"||e==="float32"||e==="int32"||e==="string"}function SZ(e,t){return!(t==="complex64"||t==="float32"&&e!=="complex64"||t==="int32"&&e!=="float32"&&e!=="complex64"||t==="bool"&&e==="bool")}function bv(e){if(e==="float32"||e==="int32")return 4;if(e==="complex64")return 8;if(e==="bool")return 1;throw new Error("Unknown dtype ".concat(e))}function XL(e){if(e==null)return 0;let t=0;return e.forEach(n=>t+=n.length),t}function lo(e){return typeof e=="string"||e instanceof String}function YL(e){return typeof e=="boolean"}function ZL(e){return typeof e=="number"}function tg(e){return Array.isArray(e)?tg(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray?"int32":ZL(e)?"float32":lo(e)?"string":YL(e)?"bool":"float32"}function _o(e){return!!(e&&e.constructor&&e.call&&e.apply)}function vv(e,t){for(let n=t;n<e;++n)if(e%n===0)return n;return e}function Ap(e){let t=e.length;if(t<2)return[];let n=new Array(t-1);n[t-2]=e[t-1];for(let r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function QL(e,t,n,r=!1){let a=new Array;if(t.length===1){let i=t[0]*(r?2:1);for(let s=0;s<i;s++)a[s]=n[e+s]}else{let i=t[0],s=t.slice(1),o=s.reduce((l,c)=>l*c)*(r?2:1);for(let l=0;l<i;l++)a[l]=QL(e+l*o,s,n,r)}return a}function Bd(e,t,n=!1){if(e.length===0)return t[0];let r=e.reduce((a,i)=>a*i)*(n?2:1);if(r===0)return[];if(r!==t.length)throw new Error("[".concat(e,"] does not match the input size ").concat(t.length).concat(n?" for a complex tensor":"","."));return QL(0,e,t,n)}function IZ(e,t){if(Array.isArray(e))return e;if(t==="float32")return e instanceof Float32Array?e:new Float32Array(e);if(t==="int32")return e instanceof Int32Array?e:new Int32Array(e);if(t==="bool"||t==="string")return Uint8Array.from(new Int32Array(e));throw new Error("Unknown dtype ".concat(t))}function M$(e,t){let n=q0(e,t);for(let r=0;r<n.length;r++)n[r]=1;return n}function q0(e,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool")return new Uint8Array(e);throw new Error("Unknown data type ".concat(t))}function $Z(e,t){let n=e.reduce((r,a)=>r*a,1);if(t==null||t==="float32")return Bd(e,new Float32Array(n));if(t==="int32")return Bd(e,new Int32Array(n));if(t==="bool")return Bd(e,new Uint8Array(n));throw new Error("Unknown data type ".concat(t))}function ba(e){e.forEach(t=>{M(Number.isInteger(t)&&t>=0,()=>"Tensor must have a shape comprised of positive integers but got shape [".concat(e,"]."))})}function CZ(e,t,n){if(t===0)return 0;if(t===1)return e[0];let r=e[e.length-1];for(let a=0;a<e.length-1;++a)r+=n[a]*e[a];return r}function EZ(e,t,n){if(t===0)return[];if(t===1)return[e];let r=new Array(t);for(let a=0;a<r.length-1;++a)r[a]=Math.floor(e/n[a]),e-=r[a]*n[a];return r[r.length-1]=e,r}function K0(e){return e&&e.then&&typeof e.then=="function"}var jA="tfjsflags",JL=class{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=TZ,this.populateURLFlags()}setPlatform(e,t){this.platform!=null&&(Z().getBool("IS_TEST")||Z().getBool("PROD")||console.warn("Platform ".concat(this.platformName," has already been set. Overwriting the platform with ").concat(e,"."))),this.platformName=e,this.platform=t}registerFlag(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},this.urlFlags[e]!=null){let r=this.urlFlags[e];Z().getBool("IS_TEST")||Z().getBool("PROD")||console.warn("Setting feature override from URL ".concat(e,": ").concat(r,".")),this.set(e,r)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];let t=this.evaluateFlag(e);if(K0(t))throw new Error("Flag ".concat(e," cannot be synchronously evaluated. Please use getAsync() instead."));return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(this.flagRegistry[e]==null)throw new Error("Cannot set flag ".concat(e," as it has not been registered."));this.flags[e]=t,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error("Cannot evaluate flag '".concat(e,"': no evaluation function found."));return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;let e=this.getQueryParams(this.global.location.search);jA in e&&e[jA].split(",").forEach(t=>{let[n,r]=t.split(":");this.urlFlags[n]=_Z(n,r)})}};function TZ(e){let t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...r)=>(NZ(t,r[0],r[1]),r.join("="))),t}function NZ(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function _Z(e,t){let n=t.toLowerCase();return n==="true"||n==="false"?n==="true":"".concat(+n)===n?+n:t}function Z(){return O$}var O$=null;function AZ(e){O$=e}var f1;function eP(){if(f1==null){let e;if(typeof window<"u")e=window;else if(typeof global<"u")e=global;else if(typeof process<"u")e=process;else if(typeof self<"u")e=self;else throw new Error("Could not find a global object");f1=e}return f1}function RZ(){let e=eP();return e._tfGlobals==null&&(e._tfGlobals=new Map),e._tfGlobals}function L$(e,t){let n=RZ();if(n.has(e))return n.get(e);{let r=t();return n.set(e,r),n.get(e)}}var Rp="Abs",wu="Acos",ku="Acosh",Go="Add",Su="AddN",Dp="All",Fp="Any",Mp="ArgMax",Op="ArgMin",Iu="Asin",$u="Asinh",Cu="Atan",Eu="Atanh",Tu="Atan2",Nu="AvgPool",ng="AvgPoolGrad",Lp="AvgPool3D",rg="AvgPool3DGrad",_u="BatchMatMul",Pp="BatchToSpaceND",zp="Bincount",Bp="BitwiseAnd",tP="BroadcastTo",ag="BroadcastArgs",Au="Cast",Ru="Ceil",qo="ClipByValue",X0="Complex",ig="ComplexAbs",Wp="Concat",Du="Conv2D",Y0="Conv2DBackpropFilter",Fu="Conv2DBackpropInput",Mu="Conv3D",Up="Conv3DBackpropFilterV2",Vp="Conv3DBackpropInputV2",Ou="Cos",Lu="Cosh",Hp="Cumprod",Pu="Cumsum",jp="CropAndResize",sg="DenseBincount",Gp="DepthToSpace",zu="DepthwiseConv2dNative",Z0="DepthwiseConv2dNativeBackpropFilter",Q0="DepthwiseConv2dNativeBackpropInput",og="Diag",Bu="Dilation2D",rp="Dilation2DBackpropInput",ap="Dilation2DBackpropFilter",P$="Draw",Wu="RealDiv",J0="Einsum",Uu="Elu",qp="EluGrad",Vu="Erf",Kp="Equal",Hu="Exp",Xp="ExpandDims",ju="Expm1",ex="FFT",lg="Fill",Yp="FlipLeftRight",Gu="Floor",qu="FloorDiv",Ku="FusedBatchNorm",Zp="GatherV2",Qp="GatherNd",Jp="Greater",Xu="GreaterEqual",Yu="Identity",tx="IFFT",nx="Imag",Zu="IsFinite",Qu="IsInf",Ju="IsNan",ec="LeakyRelu",eh="Less",th="LessEqual",nh="LinSpace",tc="Log",nc="Log1p",rh="LogicalAnd",ah="LogicalNot",ih="LogicalOr",nP="LogicalXor",rP="LogSoftmax",DZ="LowerBound",rc="LRN",sh="LRNGrad",FZ="MatrixBandPart",ac="Max",ic="Maximum",sc="MaxPool",ug="MaxPoolGrad",oh="MaxPool3D",cg="MaxPool3DGrad",dg="MaxPoolWithArgmax",oc="Mean",lc="Min",uc="Minimum",cc="MirrorPad",dc="Mod",lh="Multinomial",pc="Multiply",uh="Neg",ch="NotEqual",dh="NonMaxSuppressionV3",ph="NonMaxSuppressionV4",hh="NonMaxSuppressionV5",fh="OnesLike",hc="OneHot",mh="Pack",fc="PadV2",MZ="Pool",mc="Pow",gc="Prelu",yc="Prod",rx="RaggedGather",ax="RaggedRange",ix="RaggedTensorToTensor",pg="Range",sx="Real",bc="Reciprocal",vc="Relu",gh="Reshape",xc="ResizeNearestNeighbor",yh="ResizeNearestNeighborGrad",wc="ResizeBilinear",bh="ResizeBilinearGrad",kc="Relu6",Sc="Reverse",Ic="Round",$c="Rsqrt",vh="ScatterNd",xh="TensorScatterUpdate",wh="SearchSorted",kh="Select",Cc="Selu",Sh="Slice",Ec="Sin",Tc="Sinh",Nc="Sign",_c="Sigmoid",Ac="Softplus",Rc="Sqrt",Dc="Sum",Ih="SpaceToBatchND",$h="SplitV",Fc="Softmax",hg="SparseFillEmptyRows",Ch="SparseReshape",fg="SparseSegmentMean",mg="SparseSegmentSum",Eh="SparseToDense",Mc="SquaredDifference",gg="Square",yg="StaticRegexReplace",Th="StridedSlice",bg="StringNGrams",vg="StringSplit",xg="StringToHashBucketFast",Oc="Sub",Lc="Tan",Pc="Tanh",Ko="Tile",Nh="TopK",_h="Transform",Es="Transpose",wg="Unique",Ah="Unpack",kg="UnsortedSegmentSum",OZ="UpperBound",Rh="ZerosLike",Xo="Step",xv="FromPixels",Dh="RotateWithOffset",Yl="_FusedMatMul",Zl="FusedConv2D",Ql="FusedDepthwiseConv2D";function ao(...e){Z().getBool("IS_TEST")||Z().getBool("PROD")||console.warn(...e)}function LZ(...e){Z().getBool("IS_TEST")||Z().getBool("PROD")||console.log(...e)}var ip=L$("kernelRegistry",()=>new Map),km=L$("gradRegistry",()=>new Map);function wv(e,t){let n=z$(e,t);return ip.get(n)}function qk(e){return km.get(e)}function kv(e){let t=ip.entries(),n=[];for(;;){let{done:r,value:a}=t.next();if(r)break;let[i,s]=a,[o]=i.split("_");o===e&&n.push(s)}return n}function Sg(e){let{kernelName:t,backendName:n}=e,r=z$(t,n);ip.has(r)&&ao("The kernel '".concat(t,"' for backend '").concat(n,"' is already registered")),ip.set(r,e)}function aP(e){let{kernelName:t}=e;km.has(t)&&Z().getBool("DEBUG")&&ao("Overriding the gradient for '".concat(t,"'")),km.set(t,e)}function PZ(e,t){let n=z$(e,t);if(!ip.has(n))throw new Error("The kernel '".concat(e,"' for backend '").concat(t,"' is not registered"));ip.delete(n)}function zZ(e){if(!km.has(e))throw new Error("The gradient '".concat(e,"' for backend is not registered"));km.delete(e)}function BZ(e,t){kv(e).forEach(n=>{let r=Object.assign({},n,{backendName:t});Sg(r)})}function z$(e,t){return"".concat(t,"_").concat(e)}var k={};Ue(k,{arraysEqual:()=>Bs,arraysEqualWithNull:()=>HL,assert:()=>M,assertNonNegativeIntegerDimensions:()=>ba,assertNonNull:()=>xu,assertShapesMatch:()=>Ar,bytesFromStringArray:()=>XL,bytesPerElement:()=>bv,checkConversionForErrors:()=>qL,clamp:()=>wm,computeStrides:()=>Ap,convertBackendValuesAndArrayBuffer:()=>IZ,createScalarValue:()=>GZ,createShuffledIndices:()=>xZ,decodeString:()=>Sv,distSquared:()=>gZ,encodeString:()=>$g,fetch:()=>KZ,fingerPrint64:()=>jZ,flatten:()=>Ao,getArrayFromDType:()=>F$,getTypedArrayFromDType:()=>GL,hasEncodingLoss:()=>SZ,hexToLong:()=>Ig,indexToLoc:()=>EZ,inferDtype:()=>tg,inferFromImplicitShape:()=>kZ,isBoolean:()=>YL,isFunction:()=>_o,isInt:()=>np,isNumber:()=>ZL,isPromise:()=>K0,isScalarShape:()=>yZ,isString:()=>lo,isTypedArray:()=>Mn,isValidDtype:()=>KL,locToIndex:()=>CZ,makeOnesTypedArray:()=>M$,makeZerosNestedTypedArray:()=>$Z,makeZerosTypedArray:()=>q0,nearestDivisor:()=>vv,nearestLargerEven:()=>hZ,now:()=>Sm,parseAxisParam:()=>ni,randUniform:()=>mZ,repeatedTry:()=>wZ,rightPad:()=>Gf,shuffle:()=>VL,shuffleCombo:()=>pZ,sizeFromShape:()=>Nt,sizeToSquarishShape:()=>vZ,squeezeShape:()=>jL,sum:()=>fZ,swap:()=>yv,tanh:()=>bZ,toNestedArray:()=>Bd,toTypedArray:()=>ox});function iP(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray}var GA=jo(XY()),xl=GA.default||GA;function Ig(e){return xl.fromString(e,!0,16)}var sP=Ig("c3a5c85c97cb3127"),yl=Ig("b492b66fbe98f273"),br=Ig("9ae16a3b2f90404f");function Kk(e){return e.xor(e.shru(47))}function oP(e,t,n){let r=e.slice(t,t+n);return xl.fromBytes(Array.from(r),!0,!0)}function Tt(e,t){return oP(e,t,8)}function qA(e,t){return oP(e,t,4)}function Fn(e,t){return t===0?e:e.shru(t).or(e.shl(64-t))}function ko(e,t,n=Ig("9ddfea08eb382d69")){let r=e.xor(t).mul(n);r=r.xor(r.shru(47));let a=t.xor(r).mul(n);return a=a.xor(a.shru(47)),a=a.mul(n),a}function WZ(e,t,n,r,a,i){a=a.add(e),i=Fn(i.add(a).add(r),21);let s=a;return a=a.add(t),a=a.add(n),i=i.add(Fn(a,44)),[a.add(r),i.add(s)]}function Uy(e,t,n,r){return WZ(Tt(e,t),Tt(e,t+8),Tt(e,t+16),Tt(e,t+24),n,r)}function UZ(e,t=e.length){if(t>=8){let n=br.add(t*2),r=Tt(e,0).add(br),a=Tt(e,t-8),i=Fn(a,37).mul(n).add(r),s=Fn(r,25).add(a).mul(n);return ko(i,s,n)}if(t>=4){let n=br.add(t*2),r=qA(e,0);return ko(r.shl(3).add(t),qA(e,t-4),n)}if(t>0){let n=e[0],r=e[t>>1],a=e[t-1],i=n+(r<<8),s=t+(a<<2);return Kk(br.mul(i).xor(sP.mul(s))).mul(br)}return br}function VZ(e,t=e.length){let n=br.add(t*2),r=Tt(e,0).mul(yl),a=Tt(e,8),i=Tt(e,t-8).mul(n),s=Tt(e,t-16).mul(br);return ko(Fn(r.add(a),43).add(Fn(i,30)).add(s),r.add(Fn(a.add(br),18)).add(i),n)}function HZ(e,t=e.length){let n=br.add(t*2),r=Tt(e,0).mul(br),a=Tt(e,8),i=Tt(e,t-8).mul(n),s=Tt(e,t-16).mul(br),o=Fn(r.add(a),43).add(Fn(i,30)).add(s),l=ko(o,r.add(Fn(a.add(br),18)).add(i),n),c=Tt(e,16).mul(n),u=Tt(e,24),d=o.add(Tt(e,t-32)).mul(n),p=l.add(Tt(e,t-24)).mul(n);return ko(Fn(c.add(u),43).add(Fn(d,30)).add(p),c.add(Fn(u.add(r),18)).add(d),n)}function jZ(e,t=e.length){let n=xl.fromNumber(81,!0);if(t<=32)return t<=16?UZ(e,t):VZ(e,t);if(t<=64)return HZ(e,t);let r=n,a=n.mul(yl).add(113),i=Kk(a.mul(br).add(113)).mul(br),s=[xl.UZERO,xl.UZERO],o=[xl.UZERO,xl.UZERO];r=r.mul(br).add(Tt(e,0));let l=0,c=(t-1>>6)*64,u=c+(t-1&63)-63;do r=Fn(r.add(a).add(s[0]).add(Tt(e,l+8)),37).mul(yl),a=Fn(a.add(s[1]).add(Tt(e,l+48)),42).mul(yl),r=r.xor(o[1]),a=a.add(s[0]).add(Tt(e,l+40)),i=Fn(i.add(o[0]),33).mul(yl),s=Uy(e,l,s[1].mul(yl),r.add(o[0])),o=Uy(e,l+32,i.add(o[1]),a.add(Tt(e,l+16))),[i,r]=[r,i],l+=64;while(l!==c);let d=yl.add(i.and(255).shl(1));return l=u,o[0]=o[0].add(t-1&63),s[0]=s[0].add(o[0]),o[0]=o[0].add(s[0]),r=Fn(r.add(a).add(s[0]).add(Tt(e,l+8)),37).mul(d),a=Fn(a.add(s[1]).add(Tt(e,l+48)),42).mul(d),r=r.xor(o[1].mul(9)),a=a.add(s[0].mul(9).add(Tt(e,l+40))),i=Fn(i.add(o[0]),33).mul(d),s=Uy(e,l,s[1].mul(d),r.add(o[0])),o=Uy(e,l+32,i.add(o[1]),a.add(Tt(e,l+16))),[i,r]=[r,i],ko(ko(s[0],o[0],d).add(Kk(a).mul(sP)).add(i),ko(s[1],o[1],d).add(r),d)}function GZ(e,t){return t==="string"?$g(e):ox([e],t)}function qZ(e,t){return e instanceof Float32Array&&t==="float32"||e instanceof Int32Array&&t==="int32"||e instanceof Uint8Array&&t==="bool"}function ox(e,t){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=Ao(e)),Z().getBool("DEBUG")&&qL(e,t),qZ(e,t))return e;if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool"){let n=new Uint8Array(e.length);for(let r=0;r<n.length;++r)Math.round(e[r])!==0&&(n[r]=1);return n}else throw new Error("Unknown data type ".concat(t))}function Sm(){return Z().platform.now()}function KZ(e,t){return Z().platform.fetch(e,t)}function $g(e,t="utf-8"){return t=t||"utf-8",Z().platform.encode(e,t)}function Sv(e,t="utf-8"){return t=t||"utf-8",Z().platform.decode(e,t)}function Mn(e){return Z().platform.isTypedArray!=null?Z().platform.isTypedArray(e):iP(e)}function Ao(e,t=[],n=!1){if(t==null&&(t=[]),typeof e=="boolean"||typeof e=="number"||typeof e=="string"||K0(e)||e==null||Mn(e)&&n)t.push(e);else if(Array.isArray(e)||Mn(e))for(let r=0;r<e.length;++r)Ao(e[r],t,n);else{let r=-1;for(let a of Object.keys(e))/^([1-9]+[0-9]*|0)$/.test(a)&&(r=Math.max(r,Number(a)));for(let a=0;a<=r;a++)Ao(e[a],t,n)}return t}var XZ=class{constructor(e,t){this.backendTimer=e,this.logger=t,t==null&&(this.logger=new ZZ)}profileKernel(e,t,n){let r,a=()=>{r=n()},i,s=Sm();if(this.backendTimer.timerAvailable())i=this.backendTimer.time(a);else{a();for(let o of r)o.dataSync();i=Promise.resolve({kernelMs:Sm()-s})}if(Z().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let o=0;o<r.length;o++){let l=r[o];l.data().then(c=>{YZ(c,l.dtype,e)})}return{kernelName:e,outputs:r,inputs:t,timeMs:i.then(o=>o.kernelMs),extraInfo:i.then(o=>o.getExtraProfileInfo!=null?o.getExtraProfileInfo():"")}}logKernelProfile(e){let{kernelName:t,outputs:n,timeMs:r,inputs:a,extraInfo:i}=e;n.forEach(s=>{Promise.all([s.data(),r,i]).then(o=>{this.logger.logKernelProfile(t,s,o[0],o[1],a,o[2])})})}};function YZ(e,t,n){if(t!=="float32")return!1;for(let r=0;r<e.length;r++){let a=e[r];if(isNaN(a)||!isFinite(a))return console.warn("Found ".concat(a," in the result of '").concat(n,"'")),!0}return!1}var ZZ=class{logKernelProfile(e,t,n,r,a,i){let s=typeof r=="number"?Gf("".concat(r,"ms"),9):r.error,o=Gf(e,25),l=t.rank,c=t.size,u=Gf(t.shape.toString(),14),d="";for(let p in a){let h=a[p];if(h!=null){let f=h.shape||t.shape,m=f.length;d+="".concat(p,": ").concat(m,"D ").concat(m>0?f:""," ")}}console.log("%c".concat(o,"	%c").concat(s,"	%c").concat(l,"D ").concat(u,"	%c").concat(c,"	%c").concat(d,"	%c").concat(i),"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}};function QZ(e,t,n){let r={},a={};for(let l=0;l<t.length;l++)r[t[l].id]=!0;for(let l=0;l<e.length;l++){let c=e[l],u=c.inputs;for(let d in u){let p=u[d],h=!1;for(let f=0;f<t.length;f++)if(r[p.id]){c.outputs.forEach(m=>r[m.id]=!0),h=!0,a[c.id]=!0;break}if(h)break}}let i={};i[n.id]=!0;let s={};for(let l=e.length-1;l>=0;l--){let c=e[l],u=c.inputs;for(let d=0;d<c.outputs.length;d++)if(i[c.outputs[d].id]){for(let p in u)i[u[p].id]=!0,s[c.id]=!0;break}}let o=[];for(let l=0;l<e.length;l++){let c=e[l];if(a[c.id]&&s[c.id]){let u={};for(let p in c.inputs){let h=c.inputs[p];r[h.id]&&(u[p]=h)}let d=Object.assign({},c);d.inputs=u,d.outputs=c.outputs,o.push(d)}}return o}function JZ(e,t,n,r){for(let a=t.length-1;a>=0;a--){let i=t[a],s=[];if(i.outputs.forEach(l=>{let c=e[l.id];c!=null?s.push(c):s.push(null)}),i.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for ".concat(i.kernelName,"."));let o=i.gradient(s);for(let l in i.inputs){if(!(l in o))throw new Error("Cannot backprop through input ".concat(l,". Available gradients found: ").concat(Object.keys(o),"."));let c=n(()=>o[l]());if(c.dtype!=="float32")throw new Error("Error in gradient for op ".concat(i.kernelName,". The gradient of input ").concat(l," must have 'float32' dtype, but has '").concat(c.dtype,"'"));let u=i.inputs[l];if(!Bs(c.shape,u.shape))throw new Error("Error in gradient for op ".concat(i.kernelName,". The gradient of input '").concat(l,"' has shape '").concat(c.shape,"', which does not match the shape of the input '").concat(u.shape,"'"));if(e[u.id]==null)e[u.id]=c;else{let d=e[u.id];e[u.id]=r(d,c),d.dispose()}}}}var KA=20,ff=3,m1=7;function eQ(e,t,n,r){let a=Ap(t),i=tQ(e,t,n,a),s=t.length,o=xb(e,t,n,a,i),l=["Tensor"];return r&&(l.push("  dtype: ".concat(n)),l.push("  rank: ".concat(s)),l.push("  shape: [".concat(t,"]")),l.push("  values:")),l.push(o.map(c=>"    "+c).join("\n")),l.join("\n")}function tQ(e,t,n,r){let a=Nt(t),i=r[r.length-1],s=new Array(i).fill(0),o=t.length,l=n==="complex64"?$f(e):e;if(o>1)for(let c=0;c<a/i;c++){let u=c*i;for(let d=0;d<i;d++)s[d]=Math.max(s[d],If(l[u+d],0,n).length)}return s}function If(e,t,n){let r;return Array.isArray(e)?r="".concat(parseFloat(e[0].toFixed(m1))," + ").concat(parseFloat(e[1].toFixed(m1)),"j"):lo(e)?r="'".concat(e,"'"):n==="bool"?r=lP(e):r=parseFloat(e.toFixed(m1)).toString(),Gf(r,t)}function lP(e){return e===0?"false":"true"}function xb(e,t,n,r,a,i=!0){let s=n==="complex64"?2:1,o=t[0],l=t.length;if(l===0){if(n==="complex64"){let m=$f(e);return[If(m[0],0,n)]}return n==="bool"?[lP(e[0])]:[e[0].toString()]}if(l===1){if(o>KA){let m=ff*s,g=Array.from(e.slice(0,m)),y=Array.from(e.slice((o-ff)*s,o*s));return n==="complex64"&&(g=$f(g),y=$f(y)),["["+g.map((b,v)=>If(b,a[v],n)).join(", ")+", ..., "+y.map((b,v)=>If(b,a[o-ff+v],n)).join(", ")+"]"]}return["["+(n==="complex64"?$f(e):Array.from(e)).map((m,g)=>If(m,a[g],n)).join(", ")+"]"]}let c=t.slice(1),u=r.slice(1),d=r[0]*s,p=[];if(o>KA){for(let m=0;m<ff;m++){let g=m*d,y=g+d;p.push(...xb(e.slice(g,y),c,n,u,a,!1))}p.push("...");for(let m=o-ff;m<o;m++){let g=m*d,y=g+d;p.push(...xb(e.slice(g,y),c,n,u,a,m===o-1))}}else for(let m=0;m<o;m++){let g=m*d,y=g+d;p.push(...xb(e.slice(g,y),c,n,u,a,m===o-1))}let h=l===2?",":"";p[0]="["+(o>0?p[0]+h:"");for(let m=1;m<p.length-1;m++)p[m]=" "+p[m]+h;let f=",\n";for(let m=2;m<l;m++)f+="\n";return p[p.length-1]=" "+p[p.length-1]+"]"+(i?"":f),p}function $f(e){let t=[];for(let n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var hn=class{constructor(e,t,n){if(this.dtype=t,this.shape=e.slice(),this.size=Nt(e),n!=null){let r=n.length;M(r===this.size,()=>"Length of values '".concat(r,"' does not match the size inferred by the shape '").concat(this.size,"'."))}if(t==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||F$(t,this.size),this.strides=Ap(e)}set(e,...t){t.length===0&&(t=[0]),M(t.length===this.rank,()=>"The number of provided coordinates (".concat(t.length,") must match the rank (").concat(this.rank,")"));let n=this.locToIndex(t);this.values[n]=e}get(...e){e.length===0&&(e=[0]);let t=0;for(let r of e){if(r<0||r>=this.shape[t]){let a="Requested out of range element at ".concat(e,".   Buffer shape=").concat(this.shape);throw new Error(a)}t++}let n=e[e.length-1];for(let r=0;r<e.length-1;++r)n+=this.strides[r]*e[r];return this.values[n]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let t=e[e.length-1];for(let n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];let t=new Array(this.shape.length);for(let n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return vi().makeTensor(this.values,this.shape,this.dtype)}},vi=null,gd=null;function nQ(e){vi=e}function rQ(e){gd=e}var He=class{constructor(e,t,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=Nt(e),this.strides=Ap(e),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){let e=await this.data();return gd.buffer(this.shape,this.dtype,e)}bufferSync(){return gd.buffer(this.shape,this.dtype,this.dataSync())}async array(){let e=await this.data();return Bd(this.shape,e,this.dtype==="complex64")}arraySync(){return Bd(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();let e=vi().read(this.dataId);if(this.dtype==="string"){let t=await e;try{return t.map(n=>Sv(n))}catch(n){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),vi().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();let e=vi().readSync(this.dataId);if(this.dtype==="string")try{return e.map(t=>Sv(t))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();let e=await vi().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(vi().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return gd.print(this,e)}clone(){return this.throwIfDisposed(),gd.clone(this)}toString(e=!1){let t=this.dataSync();return eQ(t,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),gd.cast(this,e)}variable(e=!0,t,n){return this.throwIfDisposed(),vi().makeVariable(this,e,t,n)}};Object.defineProperty(He,Symbol.hasInstance,{value:e=>!!e&&e.data!=null&&e.dataSync!=null&&e.throwIfDisposed!=null});function re(){return L$("Tensor",()=>He)}re();var Jl=class extends He{constructor(e,t,n,r){super(e.shape,e.dtype,e.dataId,r),this.trainable=t,this.name=n}assign(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value (".concat(e.dtype,") and previous value (").concat(this.dtype,") must match"));if(!Bs(e.shape,this.shape))throw new Error("shape of the new value (".concat(e.shape,") and previous value (").concat(this.shape,") must match"));vi().disposeTensor(this),this.dataId=e.dataId,vi().incRef(this,null)}dispose(){vi().disposeVariable(this),this.isDisposedInternal=!0}};Object.defineProperty(Jl,Symbol.hasInstance,{value:e=>e instanceof He&&e.assign!=null&&e.assign instanceof Function});var Ei={};Ue(Ei,{assertTypesMatch:()=>dP,getTensorsInContainer:()=>B$,isTensorInList:()=>iQ,makeTypesMatch:()=>Xt});var Xk;(function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"})(Xk||(Xk={}));var Yk;(function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"})(Yk||(Yk={}));var Zk;(function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"})(Zk||(Zk={}));var Qk;(function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"})(Qk||(Qk={}));var Jk;(function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"})(Jk||(Jk={}));var aQ={float32:Qk,int32:Yk,bool:Zk,complex64:Jk};function Ra(e,t){if(e==="string"||t==="string"){if(e==="string"&&t==="string")return"string";throw new Error("Can not upcast ".concat(e," with ").concat(t))}return aQ[e][t]}function lx(e){return Ra(e,"int32")}function uP(e){return e!=null&&typeof e=="object"&&"texture"in e&&e.texture instanceof WebGLTexture}function cP(e){return typeof GPUBuffer<"u"&&e!=null&&typeof e=="object"&&"buffer"in e&&e.buffer instanceof GPUBuffer}function Xt(e,t){if(e.dtype===t.dtype)return[e,t];let n=Ra(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function dP(e,t){M(e.dtype===t.dtype,()=>"The dtypes of the first(".concat(e.dtype,") and second(").concat(t.dtype,") input must match"))}function iQ(e,t){return t.some(n=>n.id===e.id)}function B$(e){let t=[];return pP(e,t,new Set),t}function pP(e,t,n){if(e==null)return;if(e instanceof He){t.push(e);return}if(!sQ(e))return;let r=e;for(let a in r){let i=r[a];n.has(i)||(n.add(i),pP(i,t,n))}}function sQ(e){return Array.isArray(e)||typeof e=="object"}function g1(e){return e.kernelName!=null}var XA=class{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(let e in this.registeredVariables)this.registeredVariables[e].dispose()}},Im=class{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new XA}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;let e=this.getSortedBackends();for(let t=0;t<e.length;t++){let n=e[t];if(await this.initializeBackend(n).success){await this.setBackend(n);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error("Backend '".concat(this.backendName,"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods"));if(this.backendInstance==null){let{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw new Error("The highest priority backend '".concat(e,"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods"));this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){let{asyncInit:t}=this.initializeBackend(e);if(t)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t,n=1){return e in this.registryFactory?(ao("".concat(e," backend was already registered. Reusing existing backend factory.")),!1):(this.registryFactory[e]={factory:t,priority:n},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error("Backend name '".concat(e,"' not found in registry"));if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;let{success:t,asyncInit:n}=this.initializeBackend(e);if(!(n?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new XZ(this.backendInstance),!0}setupRegisteredKernels(){kv(this.backendName).forEach(e=>{e.setupFunc!=null&&e.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){kv(e).forEach(t=>{t.disposeFunc!=null&&t.disposeFunc(this.registry[e])})}initializeBackend(e){let t=this.registryFactory[e];if(t==null)throw new Error("Cannot initialize backend ".concat(e,", no registration found."));try{let n=t.factory();if(n&&!(n instanceof eg)&&typeof n.then=="function"){let r=++this.pendingBackendInitId,a=n.then(i=>r<this.pendingBackendInitId?!1:(this.registry[e]=i,this.pendingBackendInit=null,!0)).catch(i=>(r<this.pendingBackendInitId||(this.pendingBackendInit=null,ao("Initialization of backend ".concat(e," failed")),ao(i.stack||i.message)),!1));return this.pendingBackendInit=a,{success:a,asyncInit:!0}}else return this.registry[e]=n,{success:!0,asyncInit:!1}}catch(n){return ao("Initialization of backend ".concat(e," failed")),ao(n.stack||n.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error("".concat(e," backend not found in registry"));this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){let e=this.getSortedBackends();for(let t=0;t<e.length;t++){let n=e[t],{success:r,asyncInit:a}=this.initializeBackend(n);if(a||r)return{name:n,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){let n=this.state.tensorInfo.get(t),r=n.backend,a=this.readSync(t),i=r.refCount(t);r.disposeData(t,!0),n.backend=e,e.move(t,a,n.shape,n.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let n=null;if(t==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");t=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof t!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");n=e}let r;return this.scopedRun(()=>this.startScope(n),()=>this.endScope(r),()=>(r=t(),r instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r))}scopedRun(e,t,n){e();try{let r=n();return t(),r}catch(r){throw t(),r}}nextTensorId(){return Im.nextTensorId++}nextVariableId(){return Im.nextVariableId++}clone(e){let t=V.runKernel(Yu,{x:e}),n={x:e},r=i=>({x:()=>{let s="float32",o={x:i},l={dtype:s};return V.runKernel(Au,o,l)}}),a=[];return this.addTapeNode(this.state.activeScope.name,n,[t],r,a,{}),t}runKernel(e,t,n){if(this.backendName==null&&this.backend,wv(e,this.backendName)==null)throw new Error("Kernel '".concat(e,"' not registered for backend '").concat(this.backendName,"'"));return this.runKernelFunc({kernelName:e,inputs:t,attrs:n})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,n){let r=this.backend.numDataIds(),a=0;n.forEach(o=>{a+=o.dtype==="complex64"?3:1});let i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],s=r-t-a-i;if(s>0)throw new Error("Backend '".concat(this.backendName,"' has an internal memory leak (").concat(s," data ids) after running '").concat(e,"'"))}runKernelFunc(e){let t,n=[],r=this.isTapeOn(),a=this.state.numBytes,i=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let s;this.backendName==null&&this.backend;let o,l=g1(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(g1(e)){let{kernelName:h,inputs:f,attrs:m}=e;this.backendName==null&&this.backend;let g=wv(h,this.backendName);M(g!=null,()=>"Cannot find registered kernel '".concat(h,"' for backend '").concat(this.backendName,"'")),s=()=>{let y=this.backend.numDataIds();o=g.kernelFunc({inputs:f,attrs:m,backend:this.backend});let b=Array.isArray(o)?o:[o];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(h,y,b);let v=b.map(x=>x.rank!=null?x:this.makeTensorFromTensorInfo(x));if(r){let x=this.getTensorsForGradient(h,f,v);n=this.saveTensorsForBackwardMode(x)}return v}}else{let{forwardFunc:h}=e,f=m=>{r&&(n=m.map(g=>this.keep(this.clone(g))))};s=()=>{let m=this.backend.numDataIds();o=this.tidy(()=>h(this.backend,f));let g=Array.isArray(o)?o:[o];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(l,m,g),g}}let{inputs:c,attrs:u}=e,d=g1(e)?null:e.backwardsFunc,p;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?t=s():(p=this.profiler.profileKernel(l,c,()=>s()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(p),t=p.outputs)}),r&&this.addTapeNode(l,c,t,d,n,u),this.state.profiling&&this.state.activeProfile.kernels.push({name:l,bytesAdded:this.state.numBytes-a,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-i,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(c).map(h=>c[h]!=null?c[h].shape:null),outputShapes:t.map(h=>h.shape),kernelTimeMs:p.timeMs,extraInfo:p.extraInfo}),Array.isArray(o)?t:t[0]}saveTensorsForBackwardMode(e){return e.map(t=>this.keep(this.clone(t)))}getTensorsForGradient(e,t,n){let r=qk(e);if(r!=null){let a=r.inputsToSave||[],i=r.outputsToSave||[],s;r.saveAllInputs?(M(Array.isArray(t),()=>"saveAllInputs is true, expected inputs to be an array."),s=Object.keys(t).map(l=>t[l])):s=a.map(l=>t[l]);let o=n.filter((l,c)=>i[c]);return s.concat(o)}return[]}makeTensor(e,t,n,r){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;let a=e;n==="string"&&lo(e[0])&&(a=e.map(o=>$g(o)));let i=r.write(a,t,n),s=new He(t,n,i,this.nextTensorId());if(this.trackTensor(s,r),n==="string"){let o=this.state.tensorInfo.get(i),l=XL(a);this.state.numBytes+=l-o.bytes,o.bytes=l}return s}makeTensorFromDataId(e,t,n,r){n=n||"float32";let a={dataId:e,shape:t,dtype:n};return this.makeTensorFromTensorInfo(a,r)}makeTensorFromTensorInfo(e,t){let{dataId:n,shape:r,dtype:a}=e,i=new He(r,a,n,this.nextTensorId());return this.trackTensor(i,t),i}makeVariable(e,t=!0,n,r){n=n||this.nextVariableId().toString(),r!=null&&r!==e.dtype&&(e=e.cast(r));let a=new Jl(e,t,n,this.nextTensorId());if(this.state.registeredVariables[a.name]!=null)throw new Error("Variable with name ".concat(a.name," was already registered"));return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}trackTensor(e,t){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let n=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(n=e.size*bv(e.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:n})),e instanceof Jl||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;let t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){let n=e.size*bv(e.dtype);this.state.numBytes-=n}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(let e in this.state.registeredVariables){let t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){let e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;let t=this.state.numBytes,n=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(r=>r.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-n;for(let r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,t,n,r,a,i){let s={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:a},o=qk(e);o!=null&&(r=o.gradFunc),r!=null&&(s.gradient=l=>(l=l.map((c,u)=>{if(c==null){let d=n[u],p=q0(d.size,d.dtype);return this.makeTensor(p,d.shape,d.dtype)}return c}),r(l.length>1?l:l[0],a,i))),this.state.activeTape.push(s)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){let t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){let t=B$(e),n=new Set(t.map(a=>a.id));for(let a=0;a<this.state.activeScope.track.length;a++){let i=this.state.activeScope.track[a];!i.kept&&!n.has(i.id)&&i.dispose()}let r=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach(a=>{!a.kept&&a.scopeId===r.id&&this.track(a)})}gradients(e,t,n,r=!1){if(M(t.length>0,()=>"gradients() received an empty list of xs."),n!=null&&n.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '".concat(n.dtype,"'"));let a=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));M(a instanceof He,()=>"The result y returned by f() must be a tensor.");let i=QZ(this.state.activeTape,t,a);if(!r&&i.length===0&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{let s={};s[a.id]=n==null?oQ(a.shape):n,JZ(s,i,l=>this.tidy(l),lQ);let o=t.map(l=>s[l.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(l=>{for(let c of l.saved)c.dispose()}),this.state.activeTape=null),{value:a,grads:o}})}customGrad(e){return M(_o(e),()=>"The f passed in customGrad(f) must be a function."),(...t)=>{M(t.every(s=>s instanceof He),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let n,r={};t.forEach((s,o)=>{r[o]=s});let a=(s,o)=>(n=e(...t,o),M(n.value instanceof He,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),M(_o(n.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),n.value),i=(s,o)=>{let l=n.gradFunc(s,o),c=Array.isArray(l)?l:[l];M(c.length===t.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),M(c.every(d=>d instanceof He),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");let u={};return c.forEach((d,p)=>{u[p]=()=>d}),u};return this.runKernelFunc({forwardFunc:a,backwardsFunc:i,inputs:r})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}async time(e){let t=Sm(),n=await this.backend.time(e);return n.wallMs=Sm()-t,n}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new XA;for(let e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}};Im.nextTensorId=0;Im.nextVariableId=0;function oQ(e){let t=M$(Nt(e),"float32");return V.makeTensor(t,e,"float32")}function hP(){let e=eP();if(e._tfengine==null){let t=new JL(e);e._tfengine=new Im(t)}return AZ(e._tfengine.ENV),nQ(()=>e._tfengine),e._tfengine}var V=hP();function lQ(e,t){let n={a:e,b:t};return V.runKernel(Go,n)}var Cg={};Ue(Cg,{isBrowser:()=>fP,isMobile:()=>dQ,mockIsMobile:()=>cQ});function uQ(){return typeof navigator<"u"&&navigator!=null}var eS;function cQ(e){eS=e}function dQ(e){if(eS!==void 0)return eS;if(e||uQ()){if(e||(e=navigator),e.product==="ReactNative")return!0;let t=e.userAgent||e.vendor||(typeof window<"u"?window.opera:"");if(!t){let n=e;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function fP(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var Hr=Z();Hr.registerFlag("DEBUG",()=>!1,e=>{e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});Hr.registerFlag("IS_BROWSER",()=>fP());Hr.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");Hr.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));Hr.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));Hr.registerFlag("PROD",()=>!1);Hr.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Hr.getBool("DEBUG"));Hr.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);Hr.registerFlag("IS_TEST",()=>!1);Hr.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>Hr.getBool("DEBUG"));Hr.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);Hr.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);Hr.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);function rs(e,t){let n=e;if(Mn(e))return t==="string"?[]:[e.length];if(uP(e)){let a=e.channels||"RGBA";return[e.height,e.width*a.length]}else if(cP(e))return[e.buffer.size/(t==null?4:bv(t))];if(!Array.isArray(e))return[];let r=[];for(;Array.isArray(n)||Mn(n)&&t!=="string";)r.push(n.length),n=n[0];return Array.isArray(e)&&Z().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&mP(e,r,[]),r}function mP(e,t,n){if(n=n||[],!Array.isArray(e)&&!Mn(e)){M(t.length===0,()=>"Element arr[".concat(n.join("]["),"] is a primitive, but should be an array/TypedArray of ").concat(t[0]," elements"));return}M(t.length>0,()=>"Element arr[".concat(n.join("]["),"] should be a primitive, but is an array of ").concat(e.length," elements")),M(e.length===t[0],()=>"Element arr[".concat(n.join("]["),"] should have ").concat(t[0]," elements, but has ").concat(e.length," elements"));let r=t.slice(1);for(let a=0;a<e.length;++a)mP(e[a],r,n.concat(a))}function YA(e,t,n,r){if(e!=="string_or_numeric"){if(e==null)throw new Error("Expected dtype cannot be null.");if(e!=="numeric"&&e!==t||e==="numeric"&&t==="string")throw new Error("Argument '".concat(n,"' passed to '").concat(r,"' must be ").concat(e," tensor, but got ").concat(t," tensor"))}}function A(e,t,n,r="numeric"){if(e instanceof He)return YA(r,e.dtype,t,n),e;let a=tg(e);if(a!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(a=r),YA(r,a,t,n),e==null||!Mn(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string"){let o=e==null?"null":e.constructor.name;throw new Error("Argument '".concat(t,"' passed to '").concat(n,"' must be a Tensor or TensorLike, but got '").concat(o,"'"))}let i=rs(e,a);!Mn(e)&&!Array.isArray(e)&&(e=[e]);let s=a!=="string"?ox(e,a):Ao(e,[],!0);return V.makeTensor(s,i,a)}function $m(e,t,n,r="numeric"){if(!Array.isArray(e))throw new Error("Argument ".concat(t," passed to ").concat(n," must be a `Tensor[]` or `TensorLike[]`"));return e.map((a,i)=>A(a,"".concat(t,"[").concat(i,"]"),n,r))}var W$="__op";function H(e){let t=Object.keys(e);if(t.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with ".concat(t.length," keys."));let n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+W$;let a=(...i)=>{V.startScope(n);try{let s=r(...i);return K0(s)&&console.error("Cannot return a Promise inside of tidy."),V.endScope(s),s}catch(s){throw V.endScope(null),s}};return Object.defineProperty(a,"name",{value:n,configurable:!0}),a}function pQ(e,t){let n=A(e,"real","complex"),r=A(t,"imag","complex");Ar(n.shape,r.shape,"real and imag shapes, ".concat(n.shape," and ").concat(r.shape,", must match in call to tf.complex()."));let a={real:n,imag:r};return V.runKernel(X0,a)}var Ms=H({complex_:pQ});function Yo(e,t,n,r){if(r==null)r=tg(e);else if(r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(cP(e)||uP(e)){if(r!=="float32"&&r!=="int32")throw new Error("Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ".concat(r,"."));return V.backend.createTensorFromGPUData(e,t||n,r)}if(!Mn(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){ba(t);let a=Nt(t),i=Nt(n);M(a===i,()=>"Based on the provided shape, [".concat(t,"], the tensor should have ").concat(a," values but has ").concat(i));for(let s=0;s<n.length;++s){let o=n[s],l=s===n.length-1?o!==Nt(t.slice(s)):!0;M(n[s]===t[s]||!l,()=>"Error creating a new Tensor. Inferred shape (".concat(n,") does not match the provided shape (").concat(t,"). "))}}return!Mn(e)&&!Array.isArray(e)&&(e=[e]),t=t||n,e=r!=="string"?ox(e,r):Ao(e,[],!0),V.makeTensor(e,t,r)}function wr(e,t,n){let r=rs(e,n);return Yo(e,t,r,n)}var tS={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8},ss=class{static join(e){return new ss(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(n=>Mn(n)?n.buffer:n),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let t=0;for(let n=0;n<e.length;n++){let r=e[n];n!==e.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);let a=t+r.byteLength;this.shards.push({buffer:r,start:t,end:a}),t=a}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,t=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,t=isNaN(Number(t))?0:t,e=Math.max(0,e),t=Math.min(this.byteLength,t),t<=e)return new ArrayBuffer(0);let n=this.findShardForByte(e);if(n===-1)throw new Error("Could not find start shard for byte ".concat(e));let r=t-e,a=new ArrayBuffer(r),i=new Uint8Array(a),s=0;for(let o=n;o<this.shards.length;o++){let l=this.shards[o],c=e+s-l.start,u=s,d=Math.min(t,l.end)-l.start,p=new Uint8Array(l.buffer,c,d-c);if(i.set(p,u),s+=p.length,t<l.end)break}return a}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function t(r){return e<r.start?-1:e>=r.end?1:0}if(t(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;let n=hQ(this.shards,t);return n===-1?-1:(this.previousShardIndex=n,this.previousShardIndex)}};function hQ(e,t){let n=0,r=e.length;for(;n<=r;){let a=Math.floor((r-n)/2)+n,i=t(e[a]);if(i===0)return a;i<0?r=a:n=a+1}return-1}var Iv=4;async function fQ(e,t){let n=[],r=[],a=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);for(let s=0;s<a.length;++s){let o=a[s],l=Array.isArray(e)?e[s].tensor:e[o];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error("Unsupported dtype in weight '".concat(o,"': ").concat(l.dtype));let c={name:o,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){let u=new Promise(async d=>{let p=await l.bytes(),h=p.reduce((g,y)=>g+y.length,0)+Iv*p.length,f=new Uint8Array(h),m=0;for(let g=0;g<p.length;g++){let y=p[g],b=new Uint8Array(new Uint32Array([y.length]).buffer);f.set(b,m),m+=Iv,f.set(y,m),m+=y.length}d(f)});r.push(u)}else r.push(l.data());t!=null&&(c.group=t),n.push(c)}let i=await Promise.all(r);return{data:mQ(i),specs:n}}function gP(e,t){let n=new ss(e),r={},a,i=0;for(let s of t){let o=s.name,l=s.dtype,c=s.shape,u=Nt(c),d;if("quantization"in s){let p=s.quantization;if(p.dtype==="uint8"||p.dtype==="uint16"){if(!("min"in p&&"scale"in p))throw new Error("Weight ".concat(s.name," with quantization ").concat(p.dtype," doesn't have corresponding metadata min and scale."))}else if(p.dtype==="float16"){if(l!=="float32")throw new Error("Weight ".concat(s.name," is quantized with ").concat(p.dtype," which only supports weights of type float32 not ").concat(l,"."))}else throw new Error("Weight ".concat(s.name," has unknown quantization dtype ").concat(p.dtype,". Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'."));let h=tS[p.dtype],f=n.slice(i,i+u*h),m=p.dtype==="uint8"?new Uint8Array(f):new Uint16Array(f);if(l==="float32")if(p.dtype==="uint8"||p.dtype==="uint16"){d=new Float32Array(m.length);for(let g=0;g<m.length;g++){let y=m[g];d[g]=y*p.scale+p.min}}else if(p.dtype==="float16")a===void 0&&(a=kQ()),d=a(m);else throw new Error("Unsupported quantization type ".concat(p.dtype," for weight type float32."));else if(l==="int32"){if(p.dtype!=="uint8"&&p.dtype!=="uint16")throw new Error("Unsupported quantization type ".concat(p.dtype," for weight type int32."));d=new Int32Array(m.length);for(let g=0;g<m.length;g++){let y=m[g];d[g]=Math.round(y*p.scale+p.min)}}else throw new Error("Unsupported dtype in weight '".concat(o,"': ").concat(l));i+=u*h}else if(l==="string"){let p=Nt(s.shape);d=[];for(let h=0;h<p;h++){let f=new Uint32Array(n.slice(i,i+Iv))[0];i+=Iv;let m=new Uint8Array(n.slice(i,i+f));d.push(m),i+=f}}else{let p=tS[l],h=n.slice(i,i+u*p);if(l==="float32")d=new Float32Array(h);else if(l==="int32")d=new Int32Array(h);else if(l==="bool")d=new Uint8Array(h);else if(l==="complex64"){d=new Float32Array(h);let f=new Float32Array(d.length/2),m=new Float32Array(d.length/2);for(let b=0;b<f.length;b++)f[b]=d[b*2],m[b]=d[b*2+1];let g=wr(f,c,"float32"),y=wr(m,c,"float32");r[o]=Ms(g,y),g.dispose(),y.dispose()}else throw new Error("Unsupported dtype in weight '".concat(o,"': ").concat(l));i+=u*p}l!=="complex64"&&(r[o]=wr(d,c,l))}return r}function mQ(e){if(e===null)throw new Error("Invalid input value: ".concat(JSON.stringify(e)));let t=0,n=[];e.forEach(i=>{if(t+=i.byteLength,n.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: ".concat(i.constructor.name))});let r=new Uint8Array(t),a=0;return n.forEach(i=>{r.set(new Uint8Array(i.buffer),a),a+=i.byteLength}),r.buffer}var U$=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function ZA(e){return U$?Buffer.byteLength(e,"utf8"):new Blob([e]).size}function gQ(e){if(U$)return Buffer.from(e).toString("base64");let t=new Uint8Array(e),n="";for(let r=0,a=t.length;r<a;r++)n+=String.fromCharCode(t[r]);return btoa(n)}function yQ(e){if(U$){let r=Buffer.from(e,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}let t=atob(e),n=new Uint8Array(t.length);for(let r=0;r<t.length;++r)n.set([t.charCodeAt(r)],r);return n.buffer}function bQ(e){return ss.join(e)}function QA(e){let t="/";for(e=e.trim();e.endsWith(t);)e=e.slice(0,e.length-1);let n=e.split(t);return n[n.length-1]}function yP(e,t){let n={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:t};return e.signature!=null&&(n.signature=e.signature),e.userDefinedMetadata!=null&&(n.userDefinedMetadata=e.userDefinedMetadata),e.modelInitializer!=null&&(n.modelInitializer=e.modelInitializer),e.initializerSignature!=null&&(n.initializerSignature=e.initializerSignature),e.trainingConfig!=null&&(n.trainingConfig=e.trainingConfig),n}function bP(e,t,n){let r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy};if(e.trainingConfig!=null&&(r.trainingConfig=e.trainingConfig),e.weightsManifest!=null){if(!t)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=t,r.weightData=n}return e.signature!=null&&(r.signature=e.signature),e.userDefinedMetadata!=null&&(r.userDefinedMetadata=e.userDefinedMetadata),e.modelInitializer!=null&&(r.modelInitializer=e.modelInitializer),e.initializerSignature!=null&&(r.initializerSignature=e.initializerSignature),r}async function V$(e,t){let n,r;return e.weightsManifest!=null&&([n,r]=await t(e.weightsManifest)),bP(e,n,r)}function Eg(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:e.modelTopology==null?0:ZA(JSON.stringify(e.modelTopology)),weightSpecsBytes:e.weightSpecs==null?0:ZA(JSON.stringify(e.weightSpecs)),weightDataBytes:e.weightData==null?0:new ss(e.weightData).byteLength}}function vP(e){let t=[];for(let n of e)t.push(...n.weights);return t}function vQ(){let e=n=>{let r=n<<13,a=0;for(;!(r&8388608);)a-=8388608,r<<=1;return r&=-8388609,a+=947912704,r|a},t=new Uint32Array(2048);t[0]=0;for(let n=1;n<1024;n++)t[n]=e(n);for(let n=1024;n<2048;n++)t[n]=939524096+(n-1024<<13);return t}function xQ(){let e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(let t=1;t<31;t++)e[t]=t<<23;for(let t=33;t<63;t++)e[t]=2147483648+(t-32<<23);return e}function wQ(){let e=new Uint32Array(64);for(let t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}function kQ(){let e=vQ(),t=xQ(),n=wQ();return r=>{let a=new ArrayBuffer(4*r.length),i=new Uint32Array(a);for(let s=0;s<r.length;s++){let o=r[s],l=e[n[o>>10]+(o&1023)]+t[o>>10];i[s]=l}return new Float32Array(a)}}var Yt=class{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Yt.instance==null&&(Yt.instance=new Yt),Yt.instance}static registerSaveRouter(e){Yt.getInstance().saveRouters.push(e)}static registerLoadRouter(e){Yt.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return Yt.getHandlers(e,"save")}static getLoadHandlers(e,t){return Yt.getHandlers(e,"load",t)}static getHandlers(e,t,n){let r=[];return(t==="load"?Yt.getInstance().loadRouters:Yt.getInstance().saveRouters).forEach(a=>{let i=a(e,n);i!==null&&r.push(i)}),r}},SQ=e=>Yt.registerSaveRouter(e),IQ=e=>Yt.registerLoadRouter(e),$Q=e=>Yt.getSaveHandlers(e),CQ=(e,t)=>Yt.getLoadHandlers(e,t),nS="tensorflowjs",rS=1,Nl="models_store",uo="model_info_store";function xP(){if(!Z().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");let e=typeof window>"u"?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function aS(e){let t=e.result;t.createObjectStore(Nl,{keyPath:"modelPath"}),t.createObjectStore(uo,{keyPath:"modelPath"})}var eu=class{constructor(e){if(this.indexedDB=xP(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise((n,r)=>{let a=this.indexedDB.open(nS,rS);a.onupgradeneeded=()=>aS(a),a.onsuccess=()=>{let i=a.result;if(t==null){let s=i.transaction(Nl,"readonly"),o=s.objectStore(Nl).get(this.modelPath);o.onsuccess=()=>{if(o.result==null)return i.close(),r(new Error("Cannot find model with path '".concat(this.modelPath,"' in IndexedDB.")));n(o.result.modelArtifacts)},o.onerror=l=>(i.close(),r(o.error)),s.oncomplete=()=>i.close()}else{t.weightData=ss.join(t.weightData);let s=Eg(t),o=i.transaction(uo,"readwrite"),l=o.objectStore(uo),c;try{c=l.put({modelPath:this.modelPath,modelArtifactsInfo:s})}catch(d){return r(d)}let u;c.onsuccess=()=>{u=i.transaction(Nl,"readwrite");let d=u.objectStore(Nl),p;try{p=d.put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:s})}catch(h){return r(h)}p.onsuccess=()=>n({modelArtifactsInfo:s}),p.onerror=h=>{l=o.objectStore(uo);let f=l.delete(this.modelPath);f.onsuccess=()=>(i.close(),r(p.error)),f.onerror=m=>(i.close(),r(p.error))}},c.onerror=d=>(i.close(),r(c.error)),o.oncomplete=()=>{u==null?i.close():u.oncomplete=()=>i.close()}}},a.onerror=i=>r(a.error)})}};eu.URL_SCHEME="indexeddb://";var wP=e=>Z().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(eu.URL_SCHEME)?EQ(e.slice(eu.URL_SCHEME.length)):null;Yt.registerSaveRouter(wP);Yt.registerLoadRouter(wP);function EQ(e){return new eu(e)}function TQ(e){return e.startsWith(eu.URL_SCHEME)?e.slice(eu.URL_SCHEME.length):e}var NQ=class{constructor(){this.indexedDB=xP()}async listModels(){return new Promise((e,t)=>{let n=this.indexedDB.open(nS,rS);n.onupgradeneeded=()=>aS(n),n.onsuccess=()=>{let r=n.result,a=r.transaction(uo,"readonly"),i=a.objectStore(uo).getAll();i.onsuccess=()=>{let s={};for(let o of i.result)s[o.modelPath]=o.modelArtifactsInfo;e(s)},i.onerror=s=>(r.close(),t(i.error)),a.oncomplete=()=>r.close()},n.onerror=r=>t(n.error)})}async removeModel(e){return e=TQ(e),new Promise((t,n)=>{let r=this.indexedDB.open(nS,rS);r.onupgradeneeded=()=>aS(r),r.onsuccess=()=>{let a=r.result,i=a.transaction(uo,"readwrite"),s=i.objectStore(uo),o=s.get(e),l;o.onsuccess=()=>{if(o.result==null)return a.close(),n(new Error("Cannot find model with path '".concat(e,"' in IndexedDB.")));{let c=s.delete(e),u=()=>{l=a.transaction(Nl,"readwrite");let d=l.objectStore(Nl).delete(e);d.onsuccess=()=>t(o.result.modelArtifactsInfo),d.onerror=p=>n(o.error)};c.onsuccess=u,c.onerror=d=>(u(),a.close(),n(o.error))}},o.onerror=c=>(a.close(),n(o.error)),i.oncomplete=()=>{l==null?a.close():l.oncomplete=()=>a.close()}},r.onerror=a=>n(r.error)})}},ks="/",yd="tensorflowjs_models",kP="info",_Q="model_topology",AQ="weight_specs",RQ="weight_data",DQ="model_metadata";function SP(e){return{info:[yd,e,kP].join(ks),topology:[yd,e,_Q].join(ks),weightSpecs:[yd,e,AQ].join(ks),weightData:[yd,e,RQ].join(ks),modelMetadata:[yd,e,DQ].join(ks)}}function IP(e){for(let t of Object.values(e))window.localStorage.removeItem(t)}function FQ(e){let t=e.split(ks);if(t.length<3)throw new Error("Invalid key format: ".concat(e));return t.slice(1,t.length-1).join(ks)}function MQ(e){return e.startsWith(tu.URL_SCHEME)?e.slice(tu.URL_SCHEME.length):e}var tu=class{constructor(e){if(!Z().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=SP(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{let t=JSON.stringify(e.modelTopology),n=JSON.stringify(e.weightSpecs),r=Eg(e),a=ss.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,gQ(a));let i={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),{modelArtifactsInfo:r}}catch(i){throw IP(this.keys),new Error("Failed to save model '".concat(this.modelPath,"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=").concat(r.modelTopologyBytes,", weightSpecsBytes=").concat(r.weightSpecsBytes,", weightDataBytes=").concat(r.weightDataBytes,"."))}}}async load(){let e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error("In local storage, there is no model with name '".concat(this.modelPath,"'"));if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");let t={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(n==null)throw new Error("In local storage, the topology of model '".concat(this.modelPath,"' is missing."));t.modelTopology=n;let r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(r==null)throw new Error("In local storage, the weight specs of model '".concat(this.modelPath,"' are missing."));t.weightSpecs=r;let a=this.LS.getItem(this.keys.modelMetadata);if(a!=null){let s=JSON.parse(a);t.format=s.format,t.generatedBy=s.generatedBy,t.convertedBy=s.convertedBy,s.signature!=null&&(t.signature=s.signature),s.userDefinedMetadata!=null&&(t.userDefinedMetadata=s.userDefinedMetadata),s.modelInitializer!=null&&(t.modelInitializer=s.modelInitializer),s.initializerSignature!=null&&(t.initializerSignature=s.initializerSignature),s.trainingConfig!=null&&(t.trainingConfig=s.trainingConfig)}let i=this.LS.getItem(this.keys.weightData);if(i==null)throw new Error("In local storage, the binary weight values of model '".concat(this.modelPath,"' are missing."));return t.weightData=yQ(i),t}};tu.URL_SCHEME="localstorage://";var $P=e=>Z().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(tu.URL_SCHEME)?OQ(e.slice(tu.URL_SCHEME.length)):null;Yt.registerSaveRouter($P);Yt.registerLoadRouter($P);function OQ(e){return new tu(e)}var LQ=class{constructor(){M(Z().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),M(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){let e={},t=yd+ks,n=ks+kP;for(let r=0;r<this.LS.length;++r){let a=this.LS.key(r);if(a.startsWith(t)&&a.endsWith(n)){let i=FQ(a);e[i]=JSON.parse(this.LS.getItem(a))}}return e}async removeModel(e){e=MQ(e);let t=SP(e);if(this.LS.getItem(t.info)==null)throw new Error("Cannot find model at path '".concat(e,"'"));let n=JSON.parse(this.LS.getItem(t.info));return IP(t),n}},Wd="://",zr=class{constructor(){this.managers={}}static getInstance(){return zr.instance==null&&(zr.instance=new zr),zr.instance}static registerManager(e,t){M(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(Wd)&&(e=e.slice(0,e.indexOf(Wd))),M(e.length>0,()=>"scheme must not be an empty string.");let n=zr.getInstance();M(n.managers[e]==null,()=>"A model store manager is already registered for scheme '".concat(e,"'.")),n.managers[e]=t}static getManager(e){let t=zr.getInstance().managers[e];if(t==null)throw new Error("Cannot find model manager for scheme '".concat(e,"'"));return t}static getSchemes(){return Object.keys(zr.getInstance().managers)}};function wb(e){if(e.indexOf(Wd)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: ".concat(zr.getSchemes().join(",")));return{scheme:e.split(Wd)[0],path:e.split(Wd)[1]}}async function CP(e,t,n=!1){M(e!==t,()=>"Old path and new path are the same: '".concat(e,"'"));let r=Yt.getLoadHandlers(e);M(r.length>0,()=>"Copying failed because no load handler is found for source URL ".concat(e,".")),M(r.length<2,()=>"Copying failed because more than one (".concat(r.length,") load handlers for source URL ").concat(e,"."));let a=r[0],i=Yt.getSaveHandlers(t);M(i.length>0,()=>"Copying failed because no save handler is found for destination URL ".concat(t,".")),M(i.length<2,()=>"Copying failed because more than one (".concat(r.length,") save handlers for destination URL ").concat(t,"."));let s=i[0],o=wb(e).scheme,l=wb(e).path,c=o===wb(e).scheme,u=await a.load();n&&c&&await zr.getManager(o).removeModel(l);let d=await s.save(u);return n&&!c&&await zr.getManager(o).removeModel(l),d.modelArtifactsInfo}async function PQ(){let e=zr.getSchemes(),t={};for(let n of e){let r=await zr.getManager(n).listModels();for(let a in r){let i=n+Wd+a;t[i]=r[a]}}return t}async function zQ(e){let t=wb(e);return zr.getManager(t.scheme).removeModel(t.path)}async function BQ(e,t){return CP(e,t,!1)}async function WQ(e,t){return CP(e,t,!0)}var UQ=class{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got ".concat(t));return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){if(typeof window>"u"||!Z().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,t);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",n=>{if(n.source===window&&n.data.name===this.messageName){n.stopPropagation();let r=this.functionRefs[n.data.index];r(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return iP(e)}};if(Z().get("IS_BROWSER")){Z().setPlatform("browser",new UQ);try{zr.registerManager(tu.URL_SCHEME,new LQ)}catch(e){}try{zr.registerManager(eu.URL_SCHEME,new NQ)}catch(e){}}var VQ={importFetch:()=>YY()},y1,HQ=class{constructor(){this.util=ZY(),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return Z().global.fetch!=null?Z().global.fetch(e,t):(y1==null&&(y1=VQ.importFetch()),y1(e,t))}now(){let e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got ".concat(t));return this.textEncoder.encode(e)}decode(e,t){return e.length===0?"":new this.util.TextDecoder(t).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}};Z().get("IS_NODE")&&!Z().get("IS_BROWSER")&&Z().setPlatform("node",new HQ);function Ze(e,t="float32",n){return t=t||"float32",ba(e),new hn(e,t,n)}function jQ(e,t){let n=A(e,"x","cast");if(!KL(t))throw new Error("Failed to cast to unknown dtype ".concat(t));if(t==="string"&&n.dtype!=="string"||t!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");let r={x:n},a={dtype:t};return V.runKernel(Au,r,a)}var de=H({cast_:jQ});function GQ(e){let t={x:A(e,"x","clone","string_or_numeric")};return V.runKernel(Yu,t)}var es=H({clone_:GQ});function H$(e,t=!1){console.log(e.toString(t))}hP();var qQ={buffer:Ze,cast:de,clone:es,print:H$};rQ(qQ);function KQ(){Z().set("PROD",!0)}function XQ(){Z().set("DEBUG",!0)}function YQ(){Z().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function EP(e){Z().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function ZQ(){V.disposeVariables()}function ja(){return V}function $v(){return V.memory()}function QQ(e){return V.profile(e)}function K(e,t){return V.tidy(e,t)}function We(e){B$(e).forEach(t=>t.dispose())}function wn(e){return V.keep(e)}function JQ(e){return V.time(e)}function eJ(e){return V.setBackend(e)}function tJ(){return V.ready()}function nJ(){return V.backendName}function rJ(e){V.removeBackend(e)}function aJ(e){return V.findBackend(e)}function iJ(e){return V.findBackendFactory(e)}function ux(e,t,n=1){return V.registerBackend(e,t,n)}function TP(){return V.backend}function sJ(e,t){Z().setPlatform(e,t)}function oJ(e,t){let n=A(e,"a","add"),r=A(t,"b","add");[n,r]=Xt(n,r);let a={a:n,b:r};return V.runKernel(Go,a)}var ne=H({add_:oJ});function lJ(e,t){let n=A(e,"a","floorDiv"),r=A(t,"b","floorDiv");[n,r]=Xt(n,r);let a={a:n,b:r};return V.runKernel(qu,a)}var cx=H({floorDiv_:lJ});function uJ(e,t){let n=A(e,"a","div"),r=A(t,"b","div");if([n,r]=Xt(n,r),n.dtype==="int32"&&r.dtype==="int32")return cx(n,r);let a={a:n,b:r},i={};return V.runKernel(Wu,a,i)}var ke=H({div_:uJ});function cJ(e,t){let n=A(e,"a","mul"),r=A(t,"b","mul");[n,r]=Xt(n,r);let a={a:n,b:r};return V.runKernel(pc,a)}var G=H({mul_:cJ});function dJ(e){let t=A(e,"x","abs");if(t.dtype==="complex64"){let n={x:t};return V.runKernel(ig,n)}else{let n={x:t};return V.runKernel(Rp,n)}}var un=H({abs_:dJ});function pJ(e){let t={x:A(e,"x","acos")};return V.runKernel(wu,t)}var j$=H({acos_:pJ});function hJ(e){let t={x:A(e,"x","acosh")};return V.runKernel(ku,t)}var G$=H({acosh_:hJ});function fJ(e){M(Array.isArray(e),()=>"The argument passed to tf.addN() must be a list of tensors"),M(e.length>=1,()=>"Must pass at least one tensor to tf.addN(), but got ".concat(e.length));let t=e.map((a,i)=>A(a,"tensors".concat(i),"addN")),n=t[0];t.forEach(a=>{if(a.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(a=>{if(!Bs(a.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});let r=t;return V.runKernel(Su,r)}var NP=H({addN_:fJ});function mJ(e,t=null,n=!1){let r={x:A(e,"x","all","bool")},a={axis:t,keepDims:n};return V.runKernel(Dp,r,a)}var dx=H({all_:mJ});function gJ(e,t=null,n=!1){let r={x:A(e,"x","any","bool")},a={axis:t,keepDims:n};return V.runKernel(Fp,r,a)}var Cm=H({any_:gJ});function yJ(e,t=0){let n={x:A(e,"x","argMax")},r={axis:t};return V.runKernel(Mp,n,r)}var nu=H({argMax_:yJ});function bJ(e,t=0){let n={x:A(e,"x","argMin")},r={axis:t};return V.runKernel(Op,n,r)}var q$=H({argMin_:bJ});function vJ(e){let t={x:A(e,"x","asin")};return V.runKernel(Iu,t)}var K$=H({asin_:vJ});function xJ(e){let t={x:A(e,"x","asinh")};return V.runKernel($u,t)}var X$=H({asinh_:xJ});function wJ(e){let t={x:A(e,"x","atan")};return V.runKernel(Cu,t)}var Y$=H({atan_:wJ});function kJ(e,t){let n=A(e,"a","atan2"),r=A(t,"b","atan2");[n,r]=Xt(n,r);let a={a:n,b:r};return V.runKernel(Tu,a)}var Z$=H({atan2_:kJ});function SJ(e){let t={x:A(e,"x","atanh")};return V.runKernel(Eu,t)}var Q$=H({atanh_:SJ});function IJ(e,t,n,r,a="NHWC",i){let s=e[3],o=[...t,s],l=RP(a);return Tg(e,o,n,i,r,null,null,l)}function _P(e,t,n,r,a,i,s="channelsLast"){let[o,l]=Em(t),c;if(s==="channelsLast")c=[o,l,e[3],e[3]];else if(s==="channelsFirst")c=[o,l,e[1],e[1]];else throw new Error("Unknown dataFormat ".concat(s));return Tg(e,c,n,r,a,i,!1,s)}function $J(e,t,n,r,a,i,s="NDHWC"){let[o,l,c]=iS(t),u,d;if(s==="NDHWC")d="channelsLast",u=[o,l,c,e[4],e[4]];else if(s==="NCDHW")d="channelsFirst",u=[o,l,c,e[1],e[1]];else throw new Error("Unknown dataFormat ".concat(s));return AP(e,u,n,r,a,!1,d,i)}function Tg(e,t,n,r,a,i,s=!1,o="channelsLast"){let[l,c,u,d]=[-1,-1,-1,-1];if(o==="channelsLast")[l,c,u,d]=e;else if(o==="channelsFirst")[l,d,c,u]=e;else throw new Error("Unknown dataFormat ".concat(o));let[p,h,,f]=t,[m,g]=Em(n),[y,b]=Em(r),v=Ud(p,y),x=Ud(h,b),{padInfo:w,outHeight:$,outWidth:C}=TJ(a,c,u,m,g,v,x,i,o),E=s?f*d:f,_;return o==="channelsFirst"?_=[l,E,$,C]:o==="channelsLast"&&(_=[l,$,C,E]),{batchSize:l,dataFormat:o,inHeight:c,inWidth:u,inChannels:d,outHeight:$,outWidth:C,outChannels:E,padInfo:w,strideHeight:m,strideWidth:g,filterHeight:p,filterWidth:h,effectiveFilterHeight:v,effectiveFilterWidth:x,dilationHeight:y,dilationWidth:b,inShape:e,outShape:_,filterShape:t}}function AP(e,t,n,r,a,i=!1,s="channelsLast",o){let[l,c,u,d,p]=[-1,-1,-1,-1,-1];if(s==="channelsLast")[l,c,u,d,p]=e;else if(s==="channelsFirst")[l,p,c,u,d]=e;else throw new Error("Unknown dataFormat ".concat(s));let[h,f,m,,g]=t,[y,b,v]=iS(n),[x,w,$]=iS(r),C=Ud(h,x),E=Ud(f,w),_=Ud(m,$),{padInfo:R,outDepth:N,outHeight:I,outWidth:O}=NJ(a,c,u,d,y,b,v,C,E,_,o),P=i?g*p:g,L;return s==="channelsFirst"?L=[l,P,N,I,O]:s==="channelsLast"&&(L=[l,N,I,O,P]),{batchSize:l,dataFormat:s,inDepth:c,inHeight:u,inWidth:d,inChannels:p,outDepth:N,outHeight:I,outWidth:O,outChannels:P,padInfo:R,strideDepth:y,strideHeight:b,strideWidth:v,filterDepth:h,filterHeight:f,filterWidth:m,effectiveFilterDepth:C,effectiveFilterHeight:E,effectiveFilterWidth:_,dilationDepth:x,dilationHeight:w,dilationWidth:$,inShape:e,outShape:L,filterShape:t}}function CJ(e,t,n,r,a){r==null&&(r=J$(e,t,n));let i=e[0],s=e[1],o=Tm((i-t+2*r)/n+1,a),l=Tm((s-t+2*r)/n+1,a);return[o,l]}function EJ(e,t,n,r,a,i){a==null&&(a=J$(e,t[0],r[0]));let s=[0,0,0,n];for(let o=0;o<3;o++)e[o]+2*a>=t[o]&&(s[o]=Tm((e[o]-t[o]+2*a)/r[o]+1,i));return s}function J$(e,t,n,r=1){let a=Ud(t,r);return Math.floor((e[0]*(n-1)-n+a)/2)}function Em(e){return typeof e=="number"?[e,e,e]:e.length===2?[e[0],e[1],1]:e}function iS(e){return typeof e=="number"?[e,e,e]:e}function Ud(e,t){return t<=1?e:e+(e-1)*(t-1)}function TJ(e,t,n,r,a,i,s,o,l){let c,u,d;if(typeof e=="number"){c={top:e,bottom:e,left:e,right:e,type:e===0?"VALID":"NUMBER"};let p=CJ([t,n],i,r,e,o);u=p[0],d=p[1]}else if(e==="same"){u=Math.ceil(t/r),d=Math.ceil(n/a);let p=Math.max(0,(u-1)*r+i-t),h=Math.max(0,(d-1)*a+s-n),f=Math.floor(p/2),m=p-f,g=Math.floor(h/2),y=h-g;c={top:f,bottom:m,left:g,right:y,type:"SAME"}}else if(e==="valid")c={top:0,bottom:0,left:0,right:0,type:"VALID"},u=Math.ceil((t-i+1)/r),d=Math.ceil((n-s+1)/a);else if(typeof e=="object"){let p=l==="channelsLast"?e[1][0]:e[2][0],h=l==="channelsLast"?e[1][1]:e[2][1],f=l==="channelsLast"?e[2][0]:e[3][0],m=l==="channelsLast"?e[2][1]:e[3][1];c={top:p,bottom:h,left:f,right:m,type:p===0&&h===0&&f===0&&m===0?"VALID":"EXPLICIT"},u=Tm((t-i+p+h)/r+1,o),d=Tm((n-s+f+m)/a+1,o)}else throw Error("Unknown padding parameter: ".concat(e));return{padInfo:c,outHeight:u,outWidth:d}}function NJ(e,t,n,r,a,i,s,o,l,c,u){let d,p,h,f;if(e==="valid"&&(e=0),typeof e=="number"){d={top:e,bottom:e,left:e,right:e,front:e,back:e,type:e===0?"VALID":"NUMBER"};let m=EJ([t,n,r,1],[o,l,c],1,[a,i,s],e,u);p=m[0],h=m[1],f=m[2]}else if(e==="same"){p=Math.ceil(t/a),h=Math.ceil(n/i),f=Math.ceil(r/s);let m=(p-1)*a+o-t,g=(h-1)*i+l-n,y=(f-1)*s+c-r,b=Math.floor(m/2),v=m-b,x=Math.floor(g/2),w=g-x,$=Math.floor(y/2),C=y-$;d={top:x,bottom:w,left:$,right:C,front:b,back:v,type:"SAME"}}else throw Error("Unknown padding parameter: ".concat(e));return{padInfo:d,outDepth:p,outHeight:h,outWidth:f}}function Tm(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode ".concat(t))}}function Ro(e){let[t,n,r]=Em(e);return t===1&&n===1&&r===1}function os(e,t){return Ro(e)||Ro(t)}function ru(e){return Em(e).every(t=>t>0)}function RP(e){if(e==="NHWC")return"channelsLast";if(e==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat ".concat(e))}function Rr(e,t,n){if(n!=null){if(typeof t=="string")throw Error("Error in ".concat(e,": pad must be an integer when using dimRoundingMode ").concat(n," but got pad ").concat(t,"."));if(typeof t=="number")M(np(t),()=>"Error in ".concat(e,": pad must be an integer when using dimRoundingMode ").concat(n," but got pad ").concat(t,"."));else if(typeof t=="object")t.forEach(r=>{r.forEach(a=>{M(np(a),()=>"Error in ".concat(e,": pad must be an integer when using dimRoundingMode ").concat(n," but got pad ").concat(a,"."))})});else throw Error("Error in ".concat(e,": Unknown padding parameter: ").concat(t))}}function _J(e,t){let n={x:A(e,"x","reshape","string_or_numeric")},r={shape:t};return V.runKernel(gh,n,r)}var q=H({reshape_:_J});function AJ(e,t,n,r,a){let i=A(e,"x","avgPool","float32"),s=1;M(os(n,s),()=>"Error in avgPool: Either strides or dilations must be 1. Got strides ".concat(n," and dilations '").concat(s,"'"));let o=i,l=!1;i.rank===3&&(l=!0,o=q(i,[1,i.shape[0],i.shape[1],i.shape[2]])),M(o.rank===4,()=>"Error in avgPool: x must be rank 4 but got rank ".concat(o.rank,".")),Rr("avgPool",r,a);let c={x:o},u={filterSize:t,strides:n,pad:r,dimRoundingMode:a},d=V.runKernel(Nu,c,u);return d=de(d,i.dtype),l?q(d,[d.shape[1],d.shape[2],d.shape[3]]):d}var Ws=H({avgPool_:AJ});function RJ(e,t,n,r,a,i="NDHWC"){let s=A(e,"x","avgPool3d","float32"),o=s,l=!1;s.rank===4&&(l=!0,o=q(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),M(o.rank===5,()=>"Error in avgPool3d: x must be rank 5 but got rank ".concat(o.rank,".")),M(i==="NDHWC",()=>"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ".concat(i)),M(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>"Error in avgPool3d: Stride must be > 0, but got '".concat(n,"'")),Rr("avgPool3d",r,a);let c={x:o},u={filterSize:t,strides:n,pad:r,dimRoundingMode:a,dataFormat:i},d=V.runKernel(Lp,c,u);return d=de(d,o.dtype),l?q(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}var eC=H({avgPool3d_:RJ});function DJ(e,t=0){M(e.length>=1,()=>"Pass at least one tensor to concat");let n=$m(e,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(i=>{if(i.dtype!=="complex64")throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype ".concat(i.dtype,". "))}),n.length===1)return es(n[0]);let r=n,a={axis:t};return V.runKernel(Wp,r,a)}var wt=H({concat_:DJ});function FJ(e,t,n=!1,r=!1){let a=A(e,"a","matMul"),i=A(t,"b","matMul");[a,i]=Xt(a,i);let s={a,b:i},o={transposeA:n,transposeB:r};return V.runKernel(_u,s,o)}var Ke=H({matMul_:FJ});function MJ(e){let t={x:A(e,"x","sigmoid","float32")};return V.runKernel(_c,t)}var Qa=H({sigmoid_:MJ});function OJ(e,t,n){let r=A(e,"x","slice","string_or_numeric");if(r.rank===0)throw new Error("Slicing scalar is not possible");let a={x:r},i={begin:t,size:n};return V.runKernel(Sh,a,i)}var et=H({slice_:OJ});function LJ(e){let t={x:A(e,"x","tanh","float32")};return V.runKernel(Pc,t)}var au=H({tanh_:LJ});function PJ(e,t,n,r,a,i){let s=A(e,"forgetBias","basicLSTMCell"),o=A(t,"lstmKernel","basicLSTMCell"),l=A(n,"lstmBias","basicLSTMCell"),c=A(r,"data","basicLSTMCell"),u=A(a,"c","basicLSTMCell"),d=A(i,"h","basicLSTMCell"),p=wt([c,d],1),h=Ke(p,o),f=ne(h,l),m=f.shape[0],g=f.shape[1]/4,y=[m,g],b=et(f,[0,0],y),v=et(f,[0,g],y),x=et(f,[0,g*2],y),w=et(f,[0,g*3],y),$=ne(G(Qa(b),au(v)),G(u,Qa(ne(s,x)))),C=G(au($),Qa(w));return[$,C]}var DP=H({basicLSTMCell_:PJ});function zJ(e,t,n){let r=A(e,"x","batchToSpaceND"),a=t.reduce((o,l)=>o*l);M(r.rank>=1+t.length,()=>"input rank is ".concat(r.rank," but should be > than blockShape.length ").concat(t.length)),M(n.length===t.length,()=>"crops.length is ".concat(n.length," but should be equal to blockShape.length  ").concat(t.length)),M(r.shape[0]%a===0,()=>"input tensor batch is ".concat(r.shape[0]," but is not divisible by the product of the elements of blockShape ").concat(t.join(" * ")," === ").concat(a));let i={x:r},s={blockShape:t,crops:n};return V.runKernel(Pp,i,s)}var Ng=H({batchToSpaceND_:zJ});function BJ(e){let t;return e.rank===0||e.rank===1?t=q(e,[1,1,1,e.size]):e.rank===2?t=q(e,[1,1,e.shape[0],e.shape[1]]):e.rank===3?t=q(e,[1,e.shape[0],e.shape[1],e.shape[2]]):t=e,t}function WJ(e,t,n,r,a,i){i==null&&(i=.001);let s=A(e,"x","batchNorm"),o=A(t,"mean","batchNorm"),l=A(n,"variance","batchNorm"),c;a!=null&&(c=A(a,"scale","batchNorm"));let u;r!=null&&(u=A(r,"offset","batchNorm")),M(o.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),M(u==null||o.rank===u.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),M(c==null||o.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let d={x:BJ(s),scale:c,offset:u,mean:o,variance:l},p={varianceEpsilon:i},h=V.runKernel(Ku,d,p);return q(h,s.shape)}var zc=H({batchNorm_:WJ});function UJ(e,t,n,r,a,i){let s=A(e,"x","batchNorm"),o=A(t,"mean","batchNorm"),l=A(n,"variance","batchNorm"),c;a!=null&&(c=A(a,"scale","batchNorm"));let u;return r!=null&&(u=A(r,"offset","batchNorm")),M(s.rank===2,()=>"Error in batchNorm2D: x must be rank 2 but got rank ".concat(s.rank,".")),M(o.rank===2||o.rank===1,()=>"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ".concat(o.rank,".")),M(l.rank===2||l.rank===1,()=>"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ".concat(l.rank,".")),c!=null&&M(c.rank===2||c.rank===1,()=>"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ".concat(c.rank,".")),u!=null&&M(u.rank===2||u.rank===1,()=>"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ".concat(u.rank,".")),zc(s,o,l,u,c,i)}var tC=H({batchNorm2d_:UJ});function VJ(e,t,n,r,a,i){let s=A(e,"x","batchNorm"),o=A(t,"mean","batchNorm"),l=A(n,"variance","batchNorm"),c;a!=null&&(c=A(a,"scale","batchNorm"));let u;return r!=null&&(u=A(r,"offset","batchNorm")),M(s.rank===3,()=>"Error in batchNorm3D: x must be rank 3 but got rank ".concat(s.rank,".")),M(o.rank===3||o.rank===1,()=>"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ".concat(o.rank,".")),M(l.rank===3||l.rank===1,()=>"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ".concat(l.rank,".")),c!=null&&M(c.rank===3||c.rank===1,()=>"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ".concat(c.rank,".")),u!=null&&M(u.rank===3||u.rank===1,()=>"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ".concat(u.rank,".")),zc(s,o,l,u,c,i)}var nC=H({batchNorm3d_:VJ});function HJ(e,t,n,r,a,i){let s=A(e,"x","batchNorm"),o=A(t,"mean","batchNorm"),l=A(n,"variance","batchNorm"),c;a!=null&&(c=A(a,"scale","batchNorm"));let u;return r!=null&&(u=A(r,"offset","batchNorm")),M(s.rank===4,()=>"Error in batchNorm4D: x must be rank 4 but got rank ".concat(s.rank,".")),M(o.rank===4||o.rank===1,()=>"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ".concat(o.rank,".")),M(l.rank===4||l.rank===1,()=>"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ".concat(l.rank,".")),c!=null&&M(c.rank===4||c.rank===1,()=>"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ".concat(c.rank,".")),u!=null&&M(u.rank===4||u.rank===1,()=>"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ".concat(u.rank,".")),zc(s,o,l,u,c,i)}var rC=H({batchNorm4d_:HJ});function jJ(e,t,n){let r=A(e,"x","bincount"),a=A(t,"weights","bincount");M(r.dtype==="int32",()=>"Error in bincount: input dtype must be int32, but got ".concat(r.dtype)),M(n>=0,()=>"size must be non-negative, but got ".concat(n,".")),M(a.size===r.size||a.size===0,()=>"Error in bincount: weights must have the same size as input or0-length, but got input shape: ".concat(r.shape,", weights shape: ").concat(a.shape,"."));let i={x:r,weights:a},s={size:n};return V.runKernel(zp,i,s)}var aC=H({bincount_:jJ});function GJ(e,t){let n=A(e,"x","bitwiseAnd"),r=A(t,"y","bitwiseAnd");if(!Bs(n.shape,r.shape))throw new Error("BitwiseAnd: Tensors must have the same shape. x: ".concat(n.shape,", y: ").concat(r.shape));if(n.dtype!=="int32"||r.dtype!=="int32")throw new Error("BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ".concat(n.dtype," and type of y: ").concat(r.dtype));let a={a:n,b:r};return V.runKernel(Bp,a)}var FP=H({bitwiseAnd_:GJ});function qJ(e,t){let n=A(e,"s0","broadcastArgs","int32"),r=A(t,"s1","broadcastArgs","int32");if(n.rank!==1)throw new Error("broadcastArgs(): first input must be a vector (rank=1). Has rank ".concat(n.rank));if(r.rank!==1)throw new Error("broadcastArgs(): second input must be a vector (rank=1). Has rank ".concat(r.rank));let a={s0:n,s1:r};return V.runKernel(ag,a)}var MP=H({broadcastArgs_:qJ});function KJ(e,t){let n=A(e,"broadcastTo","x"),r=n.shape;if(ba(t),t.length<n.rank)throw new Error("broadcastTo(): shape.length=".concat(t.length," < input.rank=").concat(n.rank,"."));if(t.length>n.rank){let l=n.shape.slice();for(;l.length<t.length;)l.unshift(1);n=q(n,l)}let a=n.shape,i=Array.from(t);for(let l=t.length-1;l>=0;l--)if(a[l]===t[l])i[l]=1;else if(n.shape[l]!==1)throw new Error("broadcastTo(): [".concat(r,"] cannot be broadcast to [").concat(t,"]."));if(i.map((l,c)=>l>1?c:-1).filter(l=>l>=0).length===0)return es(n);let s={x:n},o={reps:i};return V.runKernel(Ko,s,o)}var Ml=H({broadcastTo_:KJ});function XJ(e){let t={x:A(e,"x","ceil","float32")};return V.runKernel(Ru,t)}var iC=H({ceil_:XJ});function da(e,t,n){ba(e),n=n||tg(t);let r={shape:e,value:t,dtype:n};return V.runKernel(lg,{},r)}function YJ(e,t,n){let r=A(e,"x","clipByValue");if(M(t<=n,()=>"Error in clip: min (".concat(t,") must be less than or equal to max (").concat(n,").")),t===n)return da(r.shape,t,r.dtype);let a={x:r},i={clipValueMin:t,clipValueMax:n};return V.runKernel(qo,a,i)}var lr=H({clipByValue_:YJ});function ZJ(e){return wt(e,0)}var sC=H({concat1d_:ZJ});function QJ(e,t){return wt(e,t)}var oC=H({concat2d_:QJ});function JJ(e,t){return wt(e,t)}var lC=H({concat3d_:JJ});function eee(e,t){return wt(e,t)}var uC=H({concat4d_:eee});function tee(e,t,n,r,a="NHWC",i=[1,1],s){let o=A(e,"x","conv2d","float32"),l=A(t,"filter","conv2d","float32"),c=o,u=!1;o.rank===3&&(u=!0,c=q(o,[1,o.shape[0],o.shape[1],o.shape[2]])),M(c.rank===4,()=>"Error in conv2d: input must be rank 4, but got rank ".concat(c.rank,".")),M(l.rank===4,()=>"Error in conv2d: filter must be rank 4, but got rank ".concat(l.rank,".")),Rr("conv2d",r,s);let d=a==="NHWC"?c.shape[3]:c.shape[1];M(d===l.shape[2],()=>"Error in conv2d: depth of input (".concat(d,") must match input depth for filter ").concat(l.shape[2],".")),M(os(n,i),()=>"Error in conv2D: Either strides or dilations must be 1. Got strides ".concat(n," and dilations '").concat(i,"'")),M(ru(i),()=>"Error in conv2D: Dilated rates should be larger than 0."),M(ru(n),()=>"Error in conv2D: Strides should be larger than 0.");let p={x:c,filter:l},h={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:s},f=V.runKernel(Du,p,h);return u?q(f,[f.shape[1],f.shape[2],f.shape[3]]):f}var $r=H({conv2d_:tee});function nee(e,t,n,r,a="NWC",i=1,s){let o=A(e,"x","conv1d"),l=A(t,"filter","conv1d"),c=o,u=!1;o.rank===2&&(u=!0,c=q(o,[1,o.shape[0],o.shape[1]])),M(c.rank===3,()=>"Error in conv1d: input must be rank 3, but got rank ".concat(c.rank,".")),M(l.rank===3,()=>"Error in conv1d: filter must be rank 3, but got rank ".concat(l.rank,".")),Rr("conv1d",r,s),M(c.shape[2]===l.shape[1],()=>"Error in conv1d: depth of input (".concat(c.shape[2],") must match input depth for filter ").concat(l.shape[1],".")),M(os(n,i),()=>"Error in conv1D: Either stride or dilation must be 1. Got stride ".concat(n," and dilation '").concat(i,"'")),M(ru(i),()=>"Error in conv1D: Dilated rates should be larger than 0."),M(ru(n),()=>"Error in conv1D: Stride should be larger than 0."),M(a==="NWC",()=>"Error in conv1d: got dataFormat of ".concat(a," but only NWC is currently supported."));let d=q(l,[1,l.shape[0],l.shape[1],l.shape[2]]),p=q(c,[c.shape[0],1,c.shape[1],c.shape[2]]),h=$r(p,d,[1,n],r,"NHWC",[1,i],s);return u?q(h,[h.shape[2],h.shape[3]]):q(h,[h.shape[0],h.shape[2],h.shape[3]])}var px=H({conv1d_:nee});function ree(e,t,n,r,a,i="NHWC",s){M(e.length===t.rank,()=>"Length of inShape (".concat(e.length,") and rank of dy (").concat(t.rank,") must match"));let o=e,l=t,c=!1;t.rank===3&&(c=!0,l=q(t,[1,t.shape[0],t.shape[1],t.shape[2]]),o=[1,e[0],e[1],e[2]]),M(o.length===4,()=>"Error in conv2dDerInput: inShape must be length 4, but got length ".concat(o.length,".")),M(l.rank===4,()=>"Error in conv2dDerInput: dy must be rank 4, but got rank ".concat(l.rank)),M(n.rank===4,()=>"Error in conv2dDerInput: filter must be rank 4, but got rank ".concat(n.rank));let u=i==="NHWC"?o[3]:o[1],d=i==="NHWC"?l.shape[3]:l.shape[1];M(u===n.shape[2],()=>"Error in conv2dDerInput: depth of input (".concat(u,") must match input depth for filter ").concat(n.shape[2],".")),M(d===n.shape[3],()=>"Error in conv2dDerInput: depth of output (".concat(d,") must match output depth for filter ").concat(n.shape[3],".")),Rr("conv2dDerInput",a,s);let p={dy:l,filter:n},h={strides:r,pad:a,dataFormat:i,dimRoundingMode:s,inputShape:o},f=V.runKernel(Fu,p,h);return c?q(f,[f.shape[1],f.shape[2],f.shape[3]]):f}var cC=H({conv2DBackpropInput_:ree});function aee(e,t,n,r,a,i){let s=A(e,"x","conv2dTranspose"),o=A(t,"filter","conv2dTranspose");return cC(n,s,o,r,a,"NHWC",i)}var hx=H({conv2dTranspose_:aee});function iee(e,t,n,r,a="NDHWC",i=[1,1,1]){let s=A(e,"x","conv3d"),o=A(t,"filter","conv3d"),l=s,c=!1;s.rank===4&&(c=!0,l=q(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),M(l.rank===5,()=>"Error in conv3d: input must be rank 5, but got rank ".concat(l.rank,".")),M(o.rank===5,()=>"Error in conv3d: filter must be rank 5, but got rank ".concat(o.rank,".")),M(l.shape[4]===o.shape[3],()=>"Error in conv3d: depth of input (".concat(l.shape[4],") must match input depth for filter ").concat(o.shape[3],".")),M(os(n,i),()=>"Error in conv3D: Either strides or dilations must be 1. Got strides ".concat(n," and dilations '").concat(i,"'")),M(a==="NDHWC",()=>"Error in conv3d: got dataFormat of ".concat(a," but only NDHWC is currently supported.")),M(ru(i),()=>"Error in conv3D: Dilated rates should be larger than 0."),M(ru(n),()=>"Error in conv3D: Strides should be larger than 0.");let u={x:l,filter:o},d={strides:n,pad:r,dataFormat:a,dilations:i},p=V.runKernel(Mu,u,d);return c?q(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}var dC=H({conv3d_:iee});function see(e,t,n,r,a){M(e.length===t.rank,()=>"Length of inShape (".concat(e.length,") and rank of dy (").concat(t.rank,") must match"));let i=e,s=t,o=!1;t.rank===4&&(o=!0,s=q(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),i=[1,e[0],e[1],e[2],e[3]]);let l=i[4],c=s.shape[4];M(i.length===5,()=>"Error in conv3dDerInput: inShape must be length 5, but got length ".concat(i.length,".")),M(s.rank===5,()=>"Error in conv3dDerInput: dy must be rank 5, but got rank ".concat(s.rank)),M(n.rank===5,()=>"Error in conv3dDerInput: filter must be rank 5, but got rank ".concat(n.rank)),M(l===n.shape[3],()=>"Error in conv3dDerInput: depth of input (".concat(l,") must match input depth for filter ").concat(n.shape[3],".")),M(c===n.shape[4],()=>"Error in conv3dDerInput: depth of output (".concat(c,") must match output depth for filter ").concat(n.shape[4],"."));let u={dy:s,filter:n},d={pad:a,strides:r,inputShape:i},p=V.runKernel(Vp,u,d);return o?q(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}var OP=H({conv3DBackpropInput_:see});function oee(e,t,n,r,a){let i=A(e,"x","conv3dTranspose"),s=A(t,"filter","conv3dTranspose");return OP(n,i,s,r,a)}var pC=H({conv3dTranspose_:oee});function lee(e){let t={x:A(e,"x","cos","float32")};return V.runKernel(Ou,t)}var _g=H({cos_:lee});function uee(e){let t={x:A(e,"x","cosh","float32")};return V.runKernel(Lu,t)}var fx=H({cosh_:uee});function cee(e,t=0,n=!1,r=!1){let a={x:A(e,"x","cumprod")},i={axis:t,exclusive:n,reverse:r};return V.runKernel(Hp,a,i)}var Nm=H({cumprod_:cee});function dee(e,t=0,n=!1,r=!1){let a={x:A(e,"x","cumsum")},i={axis:t,exclusive:n,reverse:r};return V.runKernel(Pu,a,i)}var mx=H({cumsum_:dee});function pee(e,t,n,r=!1){let a=A(e,"x","denseBincount"),i=A(t,"weights","denseBincount");M(a.dtype==="int32",()=>"Error in denseBincount: input dtype must be int32, but got ".concat(a.dtype)),M(a.rank<=2,()=>"Error in denseBincount: input must be at most rank 2, but got rank ".concat(a.rank,".")),M(n>=0,()=>"size must be non-negative, but got ".concat(n,".")),M(i.size===a.size||i.size===0,()=>"Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ".concat(a.shape,", weights shape: ").concat(i.shape,"."));let s={x:a,weights:i},o={size:n,binaryOutput:r};return V.runKernel(sg,s,o)}var Cv=H({denseBincount_:pee});function hee(e,t,n="NHWC"){let r=A(e,"x","depthToSpace","float32"),a=n==="NHWC"?r.shape[1]:r.shape[2],i=n==="NHWC"?r.shape[2]:r.shape[3],s=n==="NHWC"?r.shape[3]:r.shape[1];M(t>1,()=>"blockSize should be > 1 for depthToSpace, but was: ".concat(t)),M(a*t>=0,()=>"Negative dimension size caused by overflow when multiplying\n    ".concat(a," and ").concat(t,"  for depthToSpace with input shape\n    ").concat(r.shape)),M(i*t>=0,()=>"Negative dimension size caused by overflow when multiplying\n    ".concat(i," and ").concat(t," for depthToSpace with input shape\n        ").concat(r.shape)),M(s%(t*t)===0,()=>"Dimension size must be evenly divisible by ".concat(t*t," but is ").concat(s," for depthToSpace with input shape ").concat(r.shape));let o={x:r},l={blockSize:t,dataFormat:n};return V.runKernel(Gp,o,l)}var hC=H({depthToSpace_:hee});function fee(e,t,n,r,a="NHWC",i=[1,1],s){let o=A(e,"x","depthwiseConv2d","float32"),l=A(t,"filter","depthwiseConv2d","float32"),c=o,u=!1;o.rank===3&&(u=!0,c=q(o,[1,o.shape[0],o.shape[1],o.shape[2]])),M(c.rank===4,()=>"Error in depthwiseConv2d: input must be rank 4, but got rank ".concat(c.rank,".")),M(l.rank===4,()=>"Error in depthwiseConv2d: filter must be rank 4, but got rank ".concat(l.rank,"."));let d=a==="NHWC"?c.shape[3]:c.shape[1];M(d===l.shape[2],()=>"Error in depthwiseConv2d: number of input channels (".concat(d,") must match the inChannels dimension in filter ").concat(l.shape[2],".")),Rr("depthwiseConv2d",r,s);let p={x:c,filter:l},h={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:s},f=V.runKernel(zu,p,h);return u?q(f,[f.shape[1],f.shape[2],f.shape[3]]):f}var Bc=H({depthwiseConv2d_:fee});function mee(e){let t={x:A(e,"x","diag")};return V.runKernel(og,t)}var LP=H({diag_:mee});function gee(e,t,n,r,a=[1,1],i="NHWC"){let s=A(e,"x","dilation2d"),o=A(t,"filter","dilation2d");M(s.rank===3||s.rank===4,()=>"Error in dilation2d: input must be rank 3 or 4, but got rank ".concat(s.rank,".")),M(o.rank===3,()=>"Error in dilation2d: filter must be rank 3, but got rank ".concat(o.rank,".")),M(i==="NHWC",()=>"Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ".concat(i));let l=s,c=!1;s.rank===3&&(l=q(s,[1,s.shape[0],s.shape[1],s.shape[2]]),c=!0),M(l.shape[3]===o.shape[2],()=>"Error in dilation2d:  input and filter must have the same depth: ".concat(l.shape[3]," vs ").concat(o.shape[2]));let u={x:l,filter:o},d={strides:n,pad:r,dilations:a},p=V.runKernel(Bu,u,d);return c?q(p,[p.shape[1],p.shape[2],p.shape[3]]):p}var fC=H({dilation2d_:gee}),Fh={};Ue(Fh,{assertAndGetBroadcastShape:()=>kt,getBroadcastDims:()=>PP,getReductionAxes:()=>fn});function PP(e,t){let n=e.length,r=[];for(let a=0;a<n;a++){let i=n-1-a,s=e[i]||1;(t[t.length-1-a]||1)>1&&s===1&&r.unshift(i)}return r}function fn(e,t){let n=[];for(let r=0;r<t.length;r++){let a=e[e.length-r-1],i=t.length-r-1,s=t[i];(a==null||a===1&&s>1)&&n.unshift(i)}return n}function kt(e,t){let n=Math.max(e.length,t.length),r=new Array(n);for(let a=0;a<n;a++){let i=e[e.length-a-1];i==null&&(i=1);let s=t[t.length-a-1];if(s==null&&(s=1),i===1)r[n-a-1]=s;else if(s===1)r[n-a-1]=i;else if(i!==s){let o="Operands could not be broadcast together with shapes ".concat(e," and ").concat(t,".");throw Error(o)}else r[n-a-1]=i}return r}function yee(e,t){let n=A(e,"a","equal","string_or_numeric"),r=A(t,"b","equal","string_or_numeric");[n,r]=Xt(n,r),kt(n.shape,r.shape);let a={a:n,b:r};return V.runKernel(Kp,a)}var ha=H({equal_:yee});function bee(e,t,n){let r=A(t,"a","where"),a=A(n,"b","where"),i=A(e,"condition","where","bool"),s=kt(kt(i.shape,r.shape),a.shape),o=Ml(i,s),l=Ml(r,s),c=Ml(a,s),u={condition:o,t:l,e:c};return V.runKernel(kh,u)}var Pn=H({where_:bee});function vee(e){let t={x:A(e,"x","zerosLike")};return V.runKernel(Rh,t)}var nt=H({zerosLike_:vee});function xee(e,t){let n=A(e,"a","div"),r=A(t,"b","div");[n,r]=Xt(n,r);let a=ke(n,r),i=nt(a),s=ha(r,i);return Pn(s,i,a)}var mC=H({divNoNan_:xee});function wee(e,t){let n=A(e,"t1","dot"),r=A(t,"t2","dot");M((n.rank===1||n.rank===2)&&(r.rank===1||r.rank===2),()=>"Error in dot: inputs must all be rank 1 or 2, but got ranks ".concat(n.rank," and ").concat(r.rank,"."));let a=n.rank===1?n.size:n.shape[1],i=r.rank===1?r.size:r.shape[0];if(M(a===i,()=>"Error in dot: inner dimensions of inputs must match, but got ".concat(a," and ").concat(i,".")),n.rank===1&&r.rank===1){let s=q(n,[1,-1]),o=q(r,[-1,1]),l=Ke(s,o);return q(l,[])}else if(n.rank===1&&r.rank===2){let s=q(n,[1,-1]),o=q(r,[r.shape[0],r.shape[1]]),l=Ke(s,o);return q(l,[l.size])}else if(n.rank===2&&r.rank===1){let s=q(r,[-1,1]),o=Ke(n,s);return q(o,[o.size])}else{let s=q(r,[r.shape[0],r.shape[1]]);return Ke(n,s)}}var gC=H({dot_:wee});function kee(e,...t){let n=t.map((a,i)=>A(a,"tensors".concat(i),"einsum")),r={equation:e};return V.runKernel(J0,n,r)}var zP=H({einsum_:kee});function See(e){let t={x:A(e,"x","elu","float32")};return V.runKernel(Uu,t)}var Mh=H({elu_:See});function Iee(e,t){let n=A(e,"x","ensureShape","string_or_numeric");if(!HL(n.shape,t))throw new Error("EnsureShape: Shape of tensor ".concat(n.shape," is not compatible with expected shape ").concat(t));return e}var BP=H({ensureShape_:Iee});function $ee(e){let t=A(e,"x","erf");M(t.dtype==="int32"||t.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),t.dtype==="int32"&&(t=de(t,"float32"));let n={x:t};return V.runKernel(Vu,n)}var yC=H({erf_:$ee});function bC(e,t){for(let n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function WP(e,t,n){let r=e.length+t.length,a=[],i=0,s=0;for(let o=0;o<r;o++)n.indexOf(o)===-1?a.push(e[i++]):a.push(t[s++]);return a}function UP(e,t){let n=[],r=e.length;for(let i=0;i<r;i++)t.indexOf(i)===-1&&n.push(e[i]);let a=t.map(i=>e[i]);return[n,a]}function iu(e,t){let n=t.map(r=>1);return WP(e,n,t)}function Cee(e,t,n){M(bC(t,n),()=>"".concat(e," supports only inner-most axes for now. Got axes ").concat(t," and rank-").concat(n," input."))}function VP(e,t){if(bC(e,t))return null;let n=[];for(let r=0;r<t;++r)e.indexOf(r)===-1&&n.push(r);return e.forEach(r=>n.push(r)),n}function vC(e){return e.map((t,n)=>[n,t]).sort((t,n)=>t[1]-n[1]).map(t=>t[0])}function Eee(e,t){let n=[];for(let r=t-e;r<t;++r)n.push(r);return n}function Tee(e,t=null,n=!1){let r={x:A(e,"x","max")},a={reductionIndices:t,keepDims:n};return V.runKernel(ac,r,a)}var _a=H({max_:Tee});function Nee(e,t=null,n=!1){let r={x:A(e,"x","min")},a={axis:t,keepDims:n};return V.runKernel(lc,r,a)}var sp=H({min_:Nee});function _ee(e,t){let n=A(e,"base","pow"),r=A(t,"exp","pow");[n,r]=Xt(n,r);let a={a:n,b:r};return V.runKernel(mc,a)}var Os=H({pow_:_ee});function Ae(e,t){if((Mn(e)&&t!=="string"||Array.isArray(e))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&Mn(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Yo(e,[],[],t)}function Aee(e){let t={x:A(e,"x","sqrt","float32")};return V.runKernel(Rc,t)}var Kn=H({sqrt_:Aee});function Ree(e){let t=A(e,"x","square"),n={};return V.runKernel("Square",{x:t},n)}var vt=H({square_:Ree});function Dee(e,t=null,n=!1){let r=A(e,"x","sum");r.dtype==="bool"&&(r=de(r,"int32"));let a={x:r},i={axis:t,keepDims:n};return V.runKernel(Dc,a,i)}var Se=H({sum_:Dee});function Fee(e,t="euclidean",n=null,r=!1){e=A(e,"x","norm");let a=HP(e,t,n),i=a.shape;if(r){let s=ni(n,e.shape);i=iu(a.shape,s)}return q(a,i)}function HP(e,t,n=null){if(e.rank===0)return un(e);if(e.rank!==1&&n===null)return HP(q(e,[-1]),t,n);if(e.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(t===1)return Se(un(e),n);if(t===1/0)return _a(un(e),n);if(t===-1/0)return sp(un(e),n);if(t==="euclidean"||t===2)return Kn(Se(Os(un(e),Ae(2,"int32")),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}if(Array.isArray(n)&&n.length===2){if(t===1)return _a(Se(un(e),n[0]),n[1]-1);if(t===1/0)return _a(Se(un(e),n[1]),n[0]);if(t===-1/0)return sp(Se(un(e),n[1]),n[0]);if(t==="fro"||t==="euclidean")return Kn(Se(vt(e),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}throw new Error("Error in norm: invalid axis: ".concat(n))}var Oh=H({norm_:Fee});function Mee(e,t=null,n=!1){return Oh(e,"euclidean",t,n)}var xC=H({euclideanNorm_:Mee});function Oee(e){let t={x:A(e,"x","exp")};return V.runKernel(Hu,t)}var Cr=H({exp_:Oee});function Lee(e,t=0){let n=A(e,"x","expandDims","string_or_numeric");M(t<=n.rank,()=>"Axis must be <= rank of the tensor");let r={input:n},a={dim:t};return V.runKernel(Xp,r,a)}var Vn=H({expandDims_:Lee});function Pee(e){let t={x:A(e,"x","expm1")};return V.runKernel(ju,t)}var wC=H({expm1_:Pee});function zee(e,t){let n=A(e,"x","tile","string_or_numeric");M(n.rank===t.length,()=>"Error in transpose: rank of input ".concat(n.rank," must match length of reps ").concat(t,"."));let r={x:n},a={reps:t};return V.runKernel(Ko,r,a)}var sa=H({tile_:zee});function Bee(e,t,n,r="float32"){t==null&&(t=e);let a=Ze([e,t],r),i=e<=t?e:t;for(let o=0;o<i;++o)a.set(1,o,o);let s=q(a.toTensor(),[e,t]);if(n==null)return s;if(n.length===1)return sa(Vn(s,0),[n[0],1,1]);if(n.length===2)return sa(Vn(Vn(s,0),0),[n[0],n[1],1,1]);if(n.length===3)return sa(Vn(Vn(Vn(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received ".concat(n.length,"D."))}var gx=H({eye_:Bee});function Wee(e){let t={x:A(e,"x","floor","float32")};return V.runKernel(Gu,t)}var Lh=H({floor_:Wee});function Uee(e,t,n=0,r=0){let a=A(e,"x","gather"),i=A(t,"indices","gather","int32"),s={x:a,indices:i},o={axis:n,batchDims:r};return V.runKernel(Zp,s,o)}var Ph=H({gather_:Uee});function Vee(e,t){let n=A(e,"a","greater","string_or_numeric"),r=A(t,"b","greater","string_or_numeric");[n,r]=Xt(n,r),kt(n.shape,r.shape);let a={a:n,b:r};return V.runKernel(Jp,a)}var Dr=H({greater_:Vee});function Hee(e,t){let n=A(e,"a","greaterEqual","string_or_numeric"),r=A(t,"b","greaterEqual","string_or_numeric");[n,r]=Xt(n,r),kt(n.shape,r.shape);let a={a:n,b:r};return V.runKernel(Xu,a)}var Us=H({greaterEqual_:Hee});function jee(e){let t={input:A(e,"input","imag")};return V.runKernel(nx,t)}var Ag=H({imag_:jee});function Gee(e){let t={x:A(e,"x","isFinite")};return V.runKernel(Zu,t)}var kC=H({isFinite_:Gee});function qee(e){let t={x:A(e,"x","isInf")};return V.runKernel(Qu,t)}var SC=H({isInf_:qee});function Kee(e){let t={x:A(e,"x","isNaN")};return V.runKernel(Ju,t)}var IC=H({isNaN_:Kee});function Xee(e,t=.2){let n={x:A(e,"x","leakyRelu")},r={alpha:t};return V.runKernel(ec,n,r)}var Rg=H({leakyRelu_:Xee});function Yee(e,t){let n=A(e,"a","less","string_or_numeric"),r=A(t,"b","less","string_or_numeric");[n,r]=Xt(n,r),kt(n.shape,r.shape);let a={a:n,b:r};return V.runKernel(eh,a)}var op=H({less_:Yee});function Zee(e,t){let n=A(e,"a","lessEqual","string_or_numeric"),r=A(t,"b","lessEqual","string_or_numeric");[n,r]=Xt(n,r),kt(n.shape,r.shape);let a={a:n,b:r};return V.runKernel(th,a)}var Zo=H({lessEqual_:Zee});function jP(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");let r={start:e,stop:t,num:n};return V.runKernel(nh,{},r)}function Qee(e,t=5,n=1,r=1,a=.5){let i=A(e,"x","localResponseNormalization");M(i.rank===4||i.rank===3,()=>"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ".concat(i.rank,".")),M(np(t),()=>"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ".concat(t,"."));let s=i,o=!1;i.rank===3&&(o=!0,s=q(i,[1,i.shape[0],i.shape[1],i.shape[2]]));let l={x:s},c={depthRadius:t,bias:n,alpha:r,beta:a},u=V.runKernel(rc,l,c);return o?q(u,[u.shape[1],u.shape[2],u.shape[3]]):u}var $C=H({localResponseNormalization_:Qee});function Jee(e){let t={x:A(e,"x","log","float32")};return V.runKernel(tc,t)}var fa=H({log_:Jee});function ete(e){let t={x:A(e,"x","log1p")};return V.runKernel(nc,t)}var Dg=H({log1p_:ete});function tte(e){return M(_o(e),()=>"The f passed in grad(f) must be a function"),(t,n)=>{let r=A(t,"x","tf.grad","string_or_numeric"),a=n!=null?A(n,"dy","tf.grad"):null;return V.tidy(()=>{let{value:i,grads:s}=V.gradients(()=>e(r),[r],a);return a!=null&&Ar(i.shape,a.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),yx(s),s[0]})}}function nte(e){return M(_o(e),()=>"The f passed in grads(f) must be a function"),(t,n)=>{M(Array.isArray(t),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");let r=$m(t,"args","tf.grads","string_or_numeric"),a=n!=null?A(n,"dy","tf.grads"):null;return V.tidy(()=>{let{value:i,grads:s}=V.gradients(()=>e(...r),r,a);return a!=null&&Ar(i.shape,a.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),yx(s),s})}}function rte(e){return M(_o(e),()=>"The f passed in valueAndGrad(f) must be a function"),(t,n)=>{M(t instanceof He,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),M(n==null||n instanceof He,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");let{grads:r,value:a}=V.gradients(()=>e(t),[t],n);return yx(r),{grad:r[0],value:a}}}function ate(e){return M(_o(e),()=>"The f passed in valueAndGrads(f) must be a function"),(t,n)=>{M(Array.isArray(t)&&t.every(a=>a instanceof He),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),M(n==null||n instanceof He,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");let r=V.gradients(()=>e(...t),t,n);return n!=null&&Ar(r.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),yx(r.grads),r}}function GP(e,t){M(_o(e),()=>"The f passed in variableGrads(f) must be a function"),M(t==null||Array.isArray(t)&&t.every(c=>c instanceof Jl),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");let n=t!=null;if(!n){t=[];for(let c in V.registeredVariables)t.push(V.registeredVariables[c])}let r=n?t.filter(c=>!c.trainable):null,a=t.length;t=t.filter(c=>c.trainable),M(t.length>0,()=>"variableGrads() expects at least one of the input variables to be trainable, but none of the ".concat(a," variables is trainable."));let i=!0,{value:s,grads:o}=V.gradients(e,t,null,i);M(o.some(c=>c!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),M(s.rank===0,()=>"The f passed in variableGrads(f) must return a scalar, but it returned a rank-".concat(s.rank," tensor"));let l={};return t.forEach((c,u)=>{o[u]!=null&&(l[c.name]=o[u])}),r!=null&&r.forEach(c=>l[c.name]=null),{value:s,grads:l}}function as(e){return V.customGrad(e)}function yx(e){if(e.filter(t=>t==null).length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that\n    the f you passed encloses all operations that lead from x to y.")}function ite(e){let t={x:A(e,"x","neg")};return V.runKernel(uh,t)}var _t=H({neg_:ite});function ste(e){let t={x:A(e,"x","softplus")};return V.runKernel(Ac,t)}var Wc=H({softplus_:ste});function ote(e){let t=A(e,"x","logSigmoid");return as(n=>({value:_t(Wc(_t(n))),gradFunc:r=>G(r,Qa(_t(n)))}))(t)}var CC=H({logSigmoid_:ote});function lte(e,t){let n=A(e,"a","sub"),r=A(t,"b","sub");[n,r]=Xt(n,r);let a={a:n,b:r};return V.runKernel(Oc,a)}var xe=H({sub_:lte});function ute(e,t=-1){let n=A(e,"logits","logSoftmax");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank ".concat(n.rank," and axis was ").concat(t));return as((r,a)=>{let i=_a(r,t,!0),s=xe(r,i),o=xe(de(s,"float32"),fa(Se(Cr(s),t,!0)));return a([o]),{value:o,gradFunc:(l,c)=>{let[u]=c,d=!0,p=Cr(u);return xe(l,G(Se(l,t,d),p))}}})(n)}var bx=H({logSoftmax_:ute});function cte(e,t=null,n=!1){let r=A(e,"x","logSumExp"),a=ni(t,r.shape),i=_a(r,a,!0),s=xe(r,i),o=Cr(s),l=Se(o,a),c=fa(l),u=ne(q(i,c.shape),c);if(n){let d=iu(u.shape,a);return q(u,d)}return u}var vx=H({logSumExp_:cte});function dte(e,t){let n=A(e,"a","logicalAnd","bool"),r=A(t,"b","logicalAnd","bool");kt(n.shape,r.shape);let a={a:n,b:r};return V.runKernel(rh,a)}var ti=H({logicalAnd_:dte});function pte(e){let t={x:A(e,"x","logicalNot","bool")};return V.runKernel(ah,t)}var Fg=H({logicalNot_:pte});function hte(e,t){let n=A(e,"a","logicalOr","bool"),r=A(t,"b","logicalOr","bool");kt(n.shape,r.shape);let a={a:n,b:r};return V.runKernel(ih,a)}var xx=H({logicalOr_:hte});function fte(e,t){let n=A(e,"a","logicalXor","bool"),r=A(t,"b","logicalXor","bool");return kt(n.shape,r.shape),ti(xx(e,t),Fg(ti(e,t)))}var EC=H({logicalXor_:fte}),Vy=2147483648;function mte(e,t,n="left"){let r=A(e,"sortedSequence","searchSorted"),a=A(t,"values","searchSorted"),i=r.shape[r.shape.length-1],s=a.shape[a.shape.length-1],o=q(r,[-1,i]),l=q(a,[-1,s]);if(o.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(o.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(Nt(l.shape)>=Vy)throw new Error("values tensor size must less than ".concat(Vy));if(o.shape[1]>=Vy)throw new Error("trailing dim_size must less than ".concat(Vy," for int32 output type, was ").concat(o.shape[1]));let c={sortedSequence:o,values:l},u={side:n};return V.runKernel(wh,c,u)}var wx=H({searchSorted_:mte});function qP(e,t){return wx(e,t,"left")}function gte(e,t,n,r,a){let i=A(e,"x","maxPool"),s=1,o=i,l=!1;i.rank===3&&(l=!0,o=q(i,[1,i.shape[0],i.shape[1],i.shape[2]])),M(o.rank===4,()=>"Error in maxPool: input must be rank 4 but got rank ".concat(o.rank,".")),M(os(n,s),()=>"Error in maxPool: Either strides or dilations must be 1. Got strides ".concat(n," and dilations '").concat(s,"'")),Rr("maxPool",r,a);let c={x:o},u={filterSize:t,strides:n,pad:r,dimRoundingMode:a},d=V.runKernel(sc,c,u);return l?q(d,[d.shape[1],d.shape[2],d.shape[3]]):d}var Rn=H({maxPool_:gte});function yte(e,t=[1,1,1],n,r,a,i="NDHWC"){let s=A(e,"x","maxPool3d"),o=s,l=!1;s.rank===4&&(l=!0,o=q(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),M(o.rank===5,()=>"Error in maxPool3d: x must be rank 5 but got rank ".concat(o.rank,".")),M(i==="NDHWC",()=>"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ".concat(i)),Rr("maxPool3d",r,a);let c={x:o},u={filterSize:t,strides:n,pad:r,dimRoundingMode:a,dataFormat:i},d=V.runKernel(oh,c,u);return l?q(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}var TC=H({maxPool3d_:yte});function bte(e,t,n,r,a=!1){let i={x:A(e,"x","maxPoolWithArgmax")},s={filterSize:t,strides:n,pad:r,includeBatchInIndex:a},o=V.runKernel(dg,i,s);return{result:o[0],indexes:o[1]}}var KP=H({maxPoolWithArgmax_:bte});function vte(e,t){let n=A(e,"a","maximum"),r=A(t,"b","maximum");[n,r]=Xt(n,r),n.dtype==="bool"&&(n=de(n,"int32"),r=de(r,"int32")),kt(n.shape,r.shape);let a={a:n,b:r};return V.runKernel(ic,a)}var ls=H({maximum_:vte});function xte(e,t=null,n=!1){let r={x:A(e,"x","mean")},a={axis:t,keepDims:n};return V.runKernel(oc,r,a)}var Gt=H({mean_:xte});function qt(e,t="float32"){if(ba(e),t==="complex64"){let r=qt(e,"float32"),a=qt(e,"float32");return Ms(r,a)}let n=q0(Nt(e),t);return V.makeTensor(n,e,t)}function oa(e,t="float32"){if(ba(e),t==="complex64"){let r=oa(e,"float32"),a=qt(e,"float32");return Ms(r,a)}let n=M$(Nt(e),t);return V.makeTensor(n,e,t)}function XP(e,t,{indexing:n="xy"}={}){if(n!=="xy"&&n!=="ij")throw new TypeError("".concat(n," is not a valid third argument to meshgrid"));if(e===void 0)return[];let r=A(e,"x","meshgrid",e instanceof He?e.dtype:"float32");if(t===void 0)return[r];let a=A(t,"y","meshgrid",t instanceof He?t.dtype:"float32"),i=Nt(r.shape),s=Nt(a.shape);return n==="xy"?(r=q(r,[1,-1]),a=q(a,[-1,1]),[Ke(oa([s,1],r.dtype),r),Ke(a,oa([1,i],a.dtype))]):(r=q(r,[-1,1]),a=q(a,[1,-1]),[Ke(r,oa([1,s],r.dtype)),Ke(oa([i,1],a.dtype),a)])}function wte(e,t){let n=A(e,"a","minimum"),r=A(t,"b","minimum");[n,r]=Xt(n,r),n.dtype==="bool"&&(n=de(n,"int32"),r=de(r,"int32")),kt(n.shape,r.shape);let a={a:n,b:r};return V.runKernel(uc,a)}var Do=H({minimum_:wte});function kte(e,t,n){M(n==="reflect"||n==="symmetric",()=>"Invalid mode. Mode must be either reflect or symmetric. Got ".concat(n,"."));let r=A(e,"x","mirrorPad");if(r.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");M(t.length===r.rank,()=>"Padding doesn't match input. Must be ".concat(r.rank,". Got ").concat(t.length,"."));let a=n==="reflect"?1:0;for(let o=0;o<r.rank;o++)M(t[o].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),M(t[o][0]>=0&&t[o][0]<=r.shape[o]-a&&t[o][1]>=0&&t[o][1]<=r.shape[o]-a,()=>"Padding in dimension ".concat(o," cannot be greater than or equal to ").concat(r.shape[o]-a," or less than 0 for input of shape ").concat(r.shape));let i={paddings:t,mode:n},s={x:r};return V.runKernel(cc,s,i)}var NC=H({mirrorPad_:kte});function Ste(e,t){let n=A(e,"a","mod"),r=A(t,"b","mod");[n,r]=Xt(n,r);let a={a:n,b:r};return V.runKernel(dc,a)}var _C=H({mod_:Ste});function Ite(e,t=null,n=!1){e=A(e,"x","moments");let r=ni(t,e.shape),a=Gt(e,r,n),i=a.shape;n||(i=iu(a.shape,r));let s=vt(xe(de(e,"float32"),q(a,i))),o=Gt(s,r,n);return{mean:a,variance:o}}var Mg=H({moments_:Ite});function $te(e,t,n,r){let a=A(t,"data","multiRNNCell"),i=$m(n,"c","multiRNNCell"),s=$m(r,"h","multiRNNCell"),o=a,l=[];for(let d=0;d<e.length;d++){let p=e[d](o,i[d],s[d]);l.push(p[0]),l.push(p[1]),o=p[1]}let c=[],u=[];for(let d=0;d<l.length;d+=2)c.push(l[d]),u.push(l[d+1]);return[c,u]}var YP=H({multiRNNCell_:$te});function Cte(e,t,n,r=!1){let a=A(e,"logits","multinomial"),i=a.size,s=a.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got ".concat(i,"."));if(s>2)throw new Error("Rank of probabilities must be 1 or 2, but is ".concat(s));n=n||Math.random();let o={logits:s===1?q(a,[1,-1]):a},l={numSamples:t,seed:n,normalized:r},c=V.runKernel(lh,o,l);return s===1?q(c,[c.size]):c}var ZP=H({multinomial_:Cte});function Ete(e,t){let n=A(e,"a","notEqual","string_or_numeric"),r=A(t,"b","notEqual","string_or_numeric");[n,r]=Xt(n,r),kt(n.shape,r.shape);let a={a:n,b:r};return V.runKernel(ch,a)}var su=H({notEqual_:Ete});function Tte(e,t,n=1,r=0,a="int32"){if(t<2)throw new Error("Error in oneHot: depth must be >=2, but it is ".concat(t));let i={indices:A(e,"indices","oneHot","int32")},s={dtype:a,depth:t,onValue:n,offValue:r};return V.runKernel(hc,i,s)}var lp=H({oneHot_:Tte});function Nte(e){let t={x:A(e,"x","onesLike")};return V.runKernel(fh,t)}var ma=H({onesLike_:Nte});function _te(e,t){let n=A(e,"v1","outerProduct"),r=A(t,"v2","outerProduct");M(n.rank===1&&r.rank===1,()=>"Error in outerProduct: inputs must be rank 1, but got ranks ".concat(n.rank," and ").concat(r.rank,"."));let a=q(n,[-1,1]),i=q(r,[1,-1]);return Ke(a,i)}var QP=H({outerProduct_:_te});function Ate(e,t,n=0){let r=A(e,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");let a={paddings:t,constantValue:n},i={x:r};return V.runKernel(fc,i,a)}var Oi=H({pad_:Ate});function Rte(e,t,n=0){return M(t.length===2,()=>"Invalid number of paddings. Must be length of 2."),Oi(e,[t],n)}var JP=H({pad1d_:Rte});function Dte(e,t,n=0){return M(t.length===2&&t[0].length===2&&t[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Oi(e,t,n)}var e3=H({pad2d_:Dte});function Fte(e,t,n=0){return M(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Oi(e,t,n)}var t3=H({pad3d_:Fte});function Mte(e,t,n=0){return M(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Oi(e,t,n)}var n3=H({pad4d_:Mte});function Ote(e,t,n){let r=A(e,"x","spaceToBatchND");M(r.rank>=1+t.length,()=>"input rank ".concat(r.rank," should be > than [blockShape] ").concat(t.length)),M(n.length===t.length,()=>"paddings.shape[0] ".concat(n.length," must be equal to [blockShape] ").concat(t.length)),M(r.shape.reduce((s,o,l)=>l>0&&l<=t.length?s&&(o+n[l-1][0]+n[l-1][1])%t[l-1]===0:s,!0),()=>"input spatial dimensions ".concat(r.shape.slice(1)," with paddings ").concat(n.toString()," must be divisible by blockShapes ").concat(t.toString()));let a={x:r},i={blockShape:t,paddings:n};return V.runKernel(Ih,a,i)}var Og=H({spaceToBatchND_:Ote});function Lte(e,t,n,r,a,i,s){a==null&&(a=[1,1]),i==null&&(i=1),r===0&&(r="valid");let o=A(e,"x","maxPool"),l=o,c=!1;o.rank===3&&(c=!0,l=q(o,[1,o.shape[0],o.shape[1],o.shape[2]])),M(os(i,a),()=>"Error in pool: Either strides or dilations must be 1. Got strides ".concat(i," and dilations '").concat(a,"'"));let u=_P(l.shape,t,i,a,r),d=[u.dilationHeight,u.dilationWidth],p;r==="same"?p=zte([u.filterHeight,u.filterWidth],d):p=[[0,0],[0,0]];let h=d[0]===1&&d[1]===1,[f,m]=Pte([u.inHeight,u.inWidth],d,p),g=h?r:"valid",y=h?l:Og(l,d,f),b=(n==="avg"?()=>Ws(y,t,i,g,s):()=>Rn(y,t,i,g,s))(),v=h?b:Ng(b,d,m);return c?q(v,[v.shape[1],v.shape[2],v.shape[3]]):v}function Pte(e,t,n){let r=n.map(u=>u[0]),a=n.map(u=>u[1]),i=e.concat(r,a),s=t.map((u,d)=>(u-i[d]%u)%u),o=a.map((u,d)=>u+s[d]),l=t.map((u,d)=>[r[d],o[d]]),c=t.map((u,d)=>[0,s[d]]);return[l,c]}function zte(e,t){let n=e.map((i,s)=>i+(i-1)*(t[s]-1)).map(i=>i-1),r=n.map(i=>Math.floor(i/2)),a=n.map((i,s)=>i-r[s]);return n.map((i,s)=>[r[s],a[s]])}var AC=H({pool_:Lte});function Bte(e,t){let n=A(e,"x","prelu"),r=A(t,"alpha","prelu"),a={x:n,alpha:r};return V.runKernel(gc,a)}var Lg=H({prelu_:Bte});function Wte(e,t=null,n=!1){let r=A(e,"x","prod");r.dtype==="bool"&&(r=de(r,"int32"));let a={x:r},i={axis:t,keepDims:n};return V.runKernel(yc,a,i)}var RC=H({prod_:Wte});function Ute(e,t,n,r){let a=e.map((u,d)=>A(u,"tensors".concat(d),"raggedGather","int32")),i=A(t,"paramsDenseValues","raggedGather"),s=A(n,"indices","raggedGather","int32"),o={paramsNestedSplits:a,paramsDenseValues:i,indices:s},l={outputRaggedRank:r},c=V.runKernel(rx,o,l);return{outputNestedSplits:c.slice(0,c.length-1),outputDenseValues:c[c.length-1]}}var r3=H({raggedGather_:Ute});function Vte(e,t,n){let r=A(e,"starts","raggedRange"),a=A(t,"limits","raggedRange",r.dtype),i=A(n,"deltas","raggedRange",r.dtype),s={starts:r,limits:a,deltas:i},o=V.runKernel(ax,s);return{rtNestedSplits:o[0],rtDenseValues:o[1]}}var a3=H({raggedRange_:Vte});function Hte(e,t,n,r,a){let i=A(e,"shape","raggedTensorToTensor","int32"),s=A(t,"values","raggedTensorToTensor"),o=A(n,"defaultValue","raggedTensorToTensor",s.dtype),l=r.map((d,p)=>A(d,"tensors".concat(p),"raggedTensorToTensor","int32")),c={shape:i,values:s,defaultValue:o,rowPartitionTensors:l},u={rowPartitionTypes:a};return V.runKernel(ix,c,u)}var i3=H({raggedTensorToTensor_:Hte});function jte(e,t,n){ba(e);let r=Nt(e),a=null;if(n==null||n==="float32")a=new Float32Array(r);else if(n==="int32")a=new Int32Array(r);else if(n==="bool")a=new Uint8Array(r);else throw new Error("Unknown data type ".concat(n));for(let i=0;i<r;i++)a[i]=t();return V.makeTensor(a,e,n)}var s3=H({rand_:jte}),DC=jo(j0()),o3={};Ue(o3,{TEST_EPSILON_FLOAT16:()=>l3,createVideoElement:()=>Jte,encodeStrings:()=>u3,expectArrayBuffersEqual:()=>Qte,expectArraysClose:()=>qte,expectArraysEqual:()=>Xte,expectNumbersClose:()=>Yte,expectPromiseToFail:()=>Kte,expectValuesInRange:()=>Zte,play:()=>ene,testEpsilon:()=>FC});var Gte=.001,l3=.1;function qte(e,t,n){return n==null&&(n=FC()),sS(e,t,(r,a)=>MC(r,a,n))}function FC(){return V.backend.floatPrecision()===32?Gte:l3}function sS(e,t,n){let r=!0;if((Mn(e)||Mn(t))&&(r=!1),Mn(e)&&Mn(t)&&(r=!0),r){let s=e.constructor.name,o=t.constructor.name;if(s!==o)throw new Error("Arrays are of different type. Actual: ".concat(s,". Expected: ").concat(o))}if(Array.isArray(e)&&Array.isArray(t)){let s=rs(e),o=rs(t);if(!Bs(s,o))throw new Error("Arrays have different shapes. Actual: [".concat(s,"]. Expected: [").concat(o,"]"))}let a=Mn(e)?e:Ao(e),i=Mn(t)?t:Ao(t);if(a.length!==i.length)throw new Error("Arrays have different lengths actual: ".concat(a.length," vs expected: ").concat(i.length,".\nActual:   ").concat(a,".\nExpected: ").concat(i,"."));for(let s=0;s<i.length;++s){let o=a[s],l=i[s];if(!n(o,l))throw new Error("Arrays differ: actual[".concat(s,"] = ").concat(o,", expected[").concat(s,"] = ").concat(l,".\nActual:   ").concat(a,".\nExpected: ").concat(i,"."))}typeof expect<"u"&&expect().nothing()}function Kte(e,t){e().then(()=>t.fail(),()=>t()),typeof expect<"u"&&expect().nothing()}function Xte(e,t){let n=typeof t=="string"||typeof t=="number"||typeof t=="boolean"?[t]:t;return lo(e)||lo(e[0])||lo(t)||lo(t[0])?sS(e,n,(r,a)=>r==a):sS(e,t,(r,a)=>MC(r,a,0))}function Yte(e,t,n){if(n==null&&(n=FC()),!MC(e,t,n))throw new Error("Numbers differ: actual === ".concat(e,", expected === ").concat(t));typeof expect<"u"&&expect().nothing()}function MC(e,t,n){return!isFinite(e)&&!isFinite(t)?!0:!(isNaN(e)||isNaN(t)||Math.abs(e-t)>n)}function Zte(e,t,n){for(let r=0;r<e.length;r++)if(e[r]<t||e[r]>n)throw new Error("Value out of range:".concat(e[r]," low: ").concat(t,", high: ").concat(n))}function Qte(e,t){let n=new Float32Array(e),r=new Float32Array(t);if(n.length!==r.length)throw new Error("Expected ArrayBuffer to be of length ".concat(r.length,", but it was ").concat(n.length));for(let a=0;a<r.length;a++)if(n[a]!==r[a])throw new Error("Expected ArrayBuffer value at ".concat(a," to be ").concat(r[a]," but got ").concat(n[a]," instead"))}function u3(e){for(let t=0;t<e.length;t++){let n=e[t];Array.isArray(n)?u3(n):e[t]=$g(n)}return e}function Jte(e){let t=document.createElement("video");return"playsInline"in t&&(t.playsInline=!0),t.muted=!0,t.loop=!0,t.style.position="fixed",t.style.left="0px",t.style.top="0px",t.preload="auto",t.appendChild(e),new Promise(n=>{t.addEventListener("loadeddata",r=>n(t)),t.load()})}async function ene(e){await e.play(),"requestVideoFrameCallback"in e&&await new Promise(t=>{e.requestVideoFrameCallback(t)})}var OC=class{constructor(e,t,n,r,a){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);let i=a||Math.random();this.random=DC.alea(i.toString())}nextValue(){if(!isNaN(this.nextVal)){let r=this.nextVal;return this.nextVal=NaN,r}let e,t,n=!1;for(;!n;){let r,a,i;do r=2*this.random()-1,a=2*this.random()-1,i=r*r+a*a;while(i>=1||i===0);let s=Math.sqrt(-2*Math.log(i)/i);e=this.mean+this.stdDev*r*s,t=this.mean+this.stdDev*a*s,(!this.truncated||this.isValidTruncated(e))&&(n=!0)}return(!this.truncated||this.isValidTruncated(t))&&(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}},tne=class{constructor(e,t,n,r){this.alpha=e,this.beta=1/t,this.dtype=n;let a=r||Math.random();this.randu=DC.alea(a.toString()),this.randn=new OC(0,1,n,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,t,n,r,a,i;for(;;){do r=this.randn.nextValue(),i=1+this.c*r;while(i<=0);if(i*=i*i,e=r*r,t=1-.331*e*e,n=.5*e+this.d*(1-i+Math.log(i)),a=this.randu(),a<t||Math.log(a)<n)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}},nne=class{constructor(e=0,t=1,n,r){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=t-e,this.dtype=n,r==null&&(r=Math.random()),typeof r=="number"&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between ".concat(e," - ").concat(t," <= 1 and dtype is not float"));this.random=DC.alea(r)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}};function rne(e,t,n=1,r="float32",a){if(ba(e),n==null&&(n=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error("Unsupported data type ".concat(r));let i=new tne(t,n,r,a),s=Ze(e,r);for(let o=0;o<s.values.length;o++)s.values[o]=i.nextValue();return s.toTensor()}var c3=H({randomGamma_:rne});function ane(e,t=0,n=1,r,a){if(ba(e),r!=null&&r==="bool")throw new Error("Unsupported data type ".concat(r));let i=new OC(t,n,r,!1,a),s=Ze(e,r);for(let o=0;o<s.values.length;o++)s.values[o]=i.nextValue();return s.toTensor()}var kx=H({randomNormal_:ane});function ine(e,t,n){if(t!=null&&t==="bool")throw new Error("Unsupported data type ".concat(t));return kx(e,0,1,t,n)}var d3=H({randomStandardNormal_:ine});function sne(e,t=0,n=1,r="float32",a){ba(e);let i=Ze(e,r),s=new nne(t,n,null,a);for(let o=0;o<i.values.length;o++)i.values[o]=s.nextValue();return i.toTensor()}var Qo=H({randomUniform_:sne});function one(e,t,n,r){return Qo(e,t,n,"int32",r)}var p3=H({randomUniformInt_:one});function ou(e,t,n=1,r="float32"){if(n===0)throw new Error("Cannot have a step of zero");let a={start:e,stop:t,step:n,dtype:r};return V.runKernel(pg,{},a)}function lne(e){let t={input:A(e,"input","real")};return V.runKernel(sx,t)}var up=H({real_:lne});function une(e){let t={x:A(e,"x","reciprocal")};return V.runKernel(bc,t)}var LC=H({reciprocal_:une});function cne(e){let t={x:A(e,"x","relu")};return V.runKernel(vc,t)}var ft=H({relu_:cne});function dne(e){let t={x:A(e,"x","relu6")};return V.runKernel(kc,t)}var Sx=H({relu6_:dne});function pne(e,t){let n={x:A(e,"x","reverse")},r={dims:t};return V.runKernel(Sc,n,r)}var Da=H({reverse_:pne});function hne(e){let t=A(e,"x","reverse");return M(t.rank===1,()=>"Error in reverse1D: x must be rank 1 but got rank ".concat(t.rank,".")),Da(t,0)}var h3=H({reverse1d_:hne});function fne(e,t){let n=A(e,"x","reverse");return M(n.rank===2,()=>"Error in reverse2D: x must be rank 2 but got rank ".concat(n.rank,".")),Da(n,t)}var f3=H({reverse2d_:fne});function mne(e,t){let n=A(e,"x","reverse");return M(n.rank===3,()=>"Error in reverse3D: x must be rank 3 but got rank ".concat(n.rank,".")),Da(n,t)}var m3=H({reverse3d_:mne});function gne(e,t){let n=A(e,"x","reverse");return M(n.rank===4,()=>"Error in reverse4D: x must be rank 4 but got rank ".concat(n.rank,".")),Da(n,t)}var g3=H({reverse4d_:gne});function yne(e){let t={x:A(e,"x","round")};return V.runKernel(Ic,t)}var Ix=H({round_:yne});function bne(e){let t={x:A(e,"x","rsqrt","float32")};return V.runKernel($c,t)}var $x=H({rsqrt_:bne});function vne(e){let t={x:A(e,"x","selu")};return V.runKernel(Cc,t)}var Cx=H({selu_:vne});function xne(e,t,n,r,a,i=[1,1],s="NHWC"){let o=A(e,"x","separableConv2d"),l=A(t,"depthwiseFilter","separableConv2d"),c=A(n,"pointwiseFilter","separableConv2d"),u=o,d=!1;if(o.rank===3&&(d=!0,u=q(o,[1,o.shape[0],o.shape[1],o.shape[2]])),s==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");M(u.rank===4,()=>"Error in separableConv2d: input must be rank 4, but got rank ".concat(u.rank,".")),M(l.rank===4,()=>"Error in separableConv2d: depthwise filter must be rank 4, but got rank ".concat(l.rank,".")),M(c.rank===4,()=>"Error in separableConv2d: pointwise filter must be rank 4, but got rank ".concat(l.rank,".")),M(c.shape[0]===1,()=>"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ".concat(c.shape[0],".")),M(c.shape[1]===1,()=>"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ".concat(c.shape[1],"."));let p=l.shape[2],h=l.shape[3];M(c.shape[2]===p*h,()=>"Error in separableConv2d: the third dimension of pointwise filter must be ".concat(p*h,", but got ").concat(c.shape[2],"."));let f=Bc(u,l,r,a,s,i),m=$r(f,c,1,"valid",s);return d?q(m,[m.shape[1],m.shape[2],m.shape[3]]):m}var zh=H({separableConv2d_:xne});async function wne(e,t){let n=A(e,"x","setdiff1d"),r=A(t,"y","setdiff1d");M(n.dtype===r.dtype,()=>"x and y should have the same dtype, but got x (".concat(n.dtype,") and y (").concat(r.dtype,").")),M(n.rank===1,()=>"x should be 1D tensor, but got x (".concat(n.shape,").")),M(r.rank===1,()=>"y should be 1D tensor, but got y (".concat(r.shape,")."));let a=await n.data(),i=await r.data(),s=new Set(i),o=0;for(let u=0;u<a.length;u++)s.has(a[u])||o++;let l=new hn([o],n.dtype),c=new hn([o],"int32");for(let u=0,d=0;u<a.length;u++)s.has(a[u])||(l.values[d]=a[u],c.values[d]=u,d++);return[l.toTensor(),c.toTensor()]}var y3=wne;function kne(e){let t={x:A(e,"x","sign")};return V.runKernel(Nc,t)}var PC=H({sign_:kne});function Sne(e){let t={x:A(e,"x","sin","float32")};return V.runKernel(Ec,t)}var Ex=H({sin_:Sne});function Ine(e){let t={x:A(e,"x","sinh")};return V.runKernel(Tc,t)}var Tx=H({sinh_:Ine});function $ne(e,t,n){let r=A(e,"x","slice1d");return M(r.rank===1,()=>"slice1d expects a rank-1 tensor, but got a rank-".concat(r.rank," tensor")),et(r,[t],[n])}var Pg=H({slice1d_:$ne});function Cne(e,t,n){let r=A(e,"x","slice2d");return M(r.rank===2,()=>"slice2d expects a rank-2 tensor, but got a rank-".concat(r.rank," tensor")),et(r,t,n)}var Nx=H({slice2d_:Cne});function Ene(e,t,n){let r=A(e,"x","slice3d");return M(r.rank===3,()=>"slice3d expects a rank-3 tensor, but got a rank-".concat(r.rank," tensor")),et(r,t,n)}var Bh=H({slice3d_:Ene});function Tne(e,t,n){let r=A(e,"x","slice4d");return M(r.rank===4,()=>"slice4d expects a rank-4 tensor, but got a rank-".concat(r.rank," tensor")),et(r,t,n)}var cp=H({slice4d_:Tne});function Nne(e,t=-1){let n=A(e,"logits","softmax","float32");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank ".concat(n.rank," and dim was ").concat(t));let r={logits:n},a={dim:t};return V.runKernel(Fc,r,a)}var Jo=H({softmax_:Nne});function _ne(e){M(e.dtype==="complex64",()=>"The dtype for tf.spectral.fft() must be complex64 but got ".concat(e.dtype,"."));let t={input:e};return V.runKernel(ex,t)}var zg=H({fft_:_ne});function Ane(e){M(e.dtype==="complex64",()=>"The dtype for tf.spectral.ifft() must be complex64 but got ".concat(e.dtype,"."));let t={input:e};return V.runKernel(tx,t)}var dp=H({ifft_:Ane});function Rne(e){let t=e.shape[e.shape.length-1],n=e.size/t,r;if(t<=2){let a=q(e,[n,t]);r=dp(a)}else{let a=[n,2*(t-1)],i=q(up(e),[n,t]),s=q(Ag(e),[n,t]),o=Da(et(i,[0,1],[n,t-2]),1),l=G(Da(et(s,[0,1],[n,t-2]),1),Ae(-1)),c=wt([i,o],1),u=wt([s,l],1),d=q(Ms(c,u),[a[0],a[1]]);r=dp(d)}if(r=up(r),e.rank===3&&e.shape[0]!==0){let a=r,i=e.shape[0];r=q(r,[i,r.shape[0]/i,r.shape[1]]),a.dispose()}return r}var _x=H({irfft_:Rne});function Dne(e,t,n=0){let r={x:A(e,"x","split")},a={numOrSizeSplits:t,axis:n};return V.runKernel($h,r,a)}var Ur=H({split_:Dne});function Fne(e,t){M(e.dtype==="float32",()=>"The dtype for rfft() must be real value but got ".concat(e.dtype));let n=e.shape[e.shape.length-1],r=e.size/n,a;if(t!=null&&t<n){let f=e.shape.map(g=>0),m=e.shape.map(g=>g);m[e.shape.length-1]=t,a=et(e,f,m),n=t}else if(t!=null&&t>n){let f=e.shape.map(m=>m);f[e.shape.length-1]=t-n,a=wt([e,qt(f)],e.shape.length-1),n=t}else a=e;let i=nt(a),s=q(Ms(a,i),[r,n]),o=zg(s),l=Math.floor(n/2)+1,c=up(o),u=Ag(o),d=Ur(c,[l,n-l],c.shape.length-1),p=Ur(u,[l,n-l],u.shape.length-1),h=a.shape.slice();return h[a.shape.length-1]=l,q(Ms(d[0],p[0]),h)}var Bg=H({rfft_:Fne});function Mne(e,t){let n=A(e,"a","squaredDifference"),r=A(t,"b","squaredDifference");[n,r]=Xt(n,r),kt(n.shape,r.shape);let a={a:n,b:r},i={};return V.runKernel(Mc,a,i)}var Ax=H({squaredDifference_:Mne});function One(e,t){let n=A(e,"x","squeeze","string_or_numeric");return q(n,jL(n.shape,t).newShape)}var el=H({squeeze_:One});function Lne(e,t=0){let n=$m(e,"tensors","stack","string_or_numeric");M(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&M(t<=n[0].rank,()=>"Axis must be <= rank of the tensor");let r=n,a={axis:t};return V.runKernel(mh,r,a)}var Sn=H({stack_:Lne});function Pne(e,t=0){let n={x:A(e,"x","step")},r={alpha:t};return V.runKernel(Xo,n,r)}var Uc=H({step_:Pne});function zne(e,t,n,r,a=0,i=0,s=0,o=0,l=0){let c={x:A(e,"x","stridedSlice","string_or_numeric")},u={begin:t,end:n,strides:r,beginMask:a,endMask:i,ellipsisMask:s,newAxisMask:o,shrinkAxisMask:l};return V.runKernel(Th,c,u)}var zC=H({stridedSlice_:zne});function Bne(e){let t={x:A(e,"x","tan","float32")};return V.runKernel(Lc,t)}var BC=H({tan_:Bne});function ht(e,t){xu(e);let n=rs(e,t);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Yo(e,null,n,t)}function ts(e,t,n){if(xu(e),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");let r=rs(e,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Yo(e,t,r,n)}function Rx(e,t,n){if(xu(e),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");let r=rs(e,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Yo(e,t,r,n)}function Fo(e,t,n){if(xu(e),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");let r=rs(e,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Yo(e,t,r,n)}function b3(e,t,n){if(xu(e),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");let r=rs(e,n);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Yo(e,t,r,n)}function v3(e,t,n){if(xu(e),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");let r=rs(e,n);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return t=t||r,Yo(e,t,r,n)}var Dx={};Ue(Dx,{calculateShapes:()=>x3,validateInput:()=>Fx,validateUpdateShape:()=>WC});function WC(e,t,n){let r=t.rank>1?t.shape[t.rank-1]:1,a=t.rank>1?t.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ".concat(n.shape,", indices.shape: ").concat(t.shape,", shape: ").concat(e,", sliceDim: ").concat(r,", and batchDim: ").concat(a,".");if(n.rank<a)throw new Error(i+" update.rank < ".concat(a,". "));if(e.length<r+(n.rank-a))throw new Error(i+" Output shape length < ".concat(r+(n.rank-a)));if(n.rank!==a+e.length-r)throw new Error(i+" update.rank != ".concat(a+e.length-r));for(let s=0;s<a;++s)if(n.shape[s]!==t.shape[s])throw new Error(i+" updates.shape[".concat(s,"] (").concat(n.shape[s],") != indices.shape[").concat(s,"] (").concat(t.shape[s],")."));for(let s=0;s<n.rank-a;++s)if(n.shape[s+a]!==e[s+r])throw new Error(i+" updates.shape[".concat(s+a,"] (").concat(n.shape[s+a],") != shape[").concat(s+a,"] (").concat(e[s+a],")"))}function Fx(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ".concat(t.rank,"."));if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ".concat(e.rank,"."));if(t.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: ".concat(t.dtype));if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: ".concat(n));if(n.length===0){if(t.size===0)throw new Error("Indices specified for empty output. indices shape: ".concat(t.shape));if(e.size===0)throw new Error("Updates specified for empty output. updates shape: ".concat(e.shape))}WC(n,t,e)}function x3(e,t,n){let r=t.shape.length,a=r>1?t.shape[r-1]:1,i=n.length,s=1;for(let d=a;d<i;++d)s*=n[d];let o=a<1?1:a,l=Nt(t.shape)/o,c=[...Ap(n.slice(0,a)),1],u=Nt(n);return{sliceRank:a,numUpdates:l,sliceSize:s,strides:c,outputSize:u}}function Wne(e,t,n){let r=A(e,"tensor","tensorScatterupdate"),a=A(t,"indices","tensorScatterupdate","int32"),i=A(n,"updates","tensorScatterupdate");if(Fx(i,a,r.shape),r.dtype!==i.dtype)throw new Error("tensor and updates must have the same dtype, instead they are ".concat(r.dtype," and ").concat(i.dtype,"."));let s={tensor:r,indices:a,updates:i},o={};return V.runKernel(xh,s,o)}var w3=H({tensorScatterUpdate_:Wne});function Une(e,t=1,n=!0){let r=A(e,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");let a=r.shape[r.shape.length-1];if(t<0)throw new Error("'k' passed to topk() must be >= 0 but got ".concat(t));if(t>a)throw new Error("'k' passed to topk() must be <= the last dimension (".concat(a,") but got ").concat(t));let i={x:r},s={k:t,sorted:n},[o,l]=V.runKernel(Nh,i,s);return{values:o,indices:l}}var UC=H({topk_:Une});function Vne(e,t=0,n=1,r,a){if(ba(e),r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");let i=new OC(t,n,r,!0,a),s=Ze(e,r);for(let o=0;o<s.values.length;o++)s.values[o]=i.nextValue();return s.toTensor()}var Mx=H({truncatedNormal_:Vne});function Hne(e,t=0){let n=A(e,"x","unique","string_or_numeric");M(n.rank>0,()=>"The input tensor must be at least 1D");let r={x:n},a={axis:t},[i,s]=V.runKernel(wg,r,a);return{values:i,indices:s}}var VC=H({unique_:Hne});function jne(e,t,n){let r=A(e,"x","unsortedSegmentSum"),a=A(t,"segmentIds","unsortedSegmentSum","int32");M(np(n),()=>"numSegments must be of dtype int");let i={x:r,segmentIds:a},s={numSegments:n};return V.runKernel(kg,i,s)}var Ox=H({unsortedSegmentSum_:jne});function Gne(e,t=0){let n=A(e,"x","unstack","string_or_numeric");M(t>=-n.shape.length&&t<n.shape.length,()=>"Axis = ".concat(t," is not in [-").concat(n.shape.length,", ").concat(n.shape.length,")"));let r={value:n},a={axis:t};return V.runKernel(Ah,r,a)}var en=H({unstack_:Gne});function k3(e,t){return wx(e,t,"right")}function HC(e,t=!0,n,r){return V.makeVariable(e,t,n,r)}function S3(e,t){let n=[];for(let i=0;i<t.length;i++)t[i]&&n.push(i);let r=Ze(e,"int32"),a=Ze([n.length,e.length],"int32");for(let i=0;i<n.length;i++){let s=r.indexToLoc(n[i]),o=i*e.length;a.values.set(s,o)}return a.toTensor()}async function qne(e){let t=A(e,"condition","whereAsync","bool"),n=await t.data(),r=S3(t.shape,n);return e!==t&&t.dispose(),r}var jC=qne;async function Kne(e,t,n){let r=A(e,"tensor","boolMask"),a=A(t,"mask","boolMask","bool"),i=n==null?0:n,s=a.rank,o=r.shape;M(s>0,()=>"mask cannot be scalar"),Ar(o.slice(i,i+s),a.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let m=i;m<i+s;m++)l*=o[m];let c=o.slice(0,i).concat([l],o.slice(i+s)),u=q(r,c),d=q(a,[-1]),p=await jC(d),h=el(p,[1]),f=Ph(u,h,i);return e!==r&&r.dispose(),t!==a&&a.dispose(),h.dispose(),u.dispose(),d.dispose(),p.dispose(),f}var I3=Kne;function Xne(e,t,n){let r=A(e,"x","transpose");if(t==null&&(t=r.shape.map((s,o)=>o).reverse()),M(r.rank===t.length,()=>"Error in transpose: rank of input ".concat(r.rank," must match length of perm ").concat(t,".")),t.forEach(s=>{M(s>=0&&s<r.rank,()=>"All entries in 'perm' must be between 0 and ".concat(r.rank-1," but got ").concat(t))}),r.rank<=1)return r.clone();let a={x:r},i={perm:t};return r.dtype==="complex64"?K(()=>{let s=up(r),o=Ag(r);return s=V.runKernel(Es,{x:s},i),o=V.runKernel(Es,{x:o},i),n&&(o=_t(o)),Ms(s,o)}):V.runKernel(Es,a,i)}var Ye=H({transpose_:Xne});function Yne(e,t,n,r,a=!0){let i=A(e,"v","movingAverage"),s=A(t,"x","movingAverage"),o=A(n,"decay","movingAverage");dP(i,s),M(Bs(i.shape,s.shape),()=>"Shape mismatch in v and x");let l=Ae(1),c=xe(l,o),u=G(xe(s,i),c);if(a){M(r!=null,()=>"When using zeroDebias: true, step is required.");let d=A(r,"step","movingAverage");u=ke(u,xe(l,Os(o,d)))}return ne(i,u)}var $3=H({movingAverage_:Yne});function Zne(e,t,n){ba(n);let r=A(e,"indices","scatterND","int32"),a=A(t,"updates","scatterND");Fx(a,r,n);let i={indices:r,updates:a},s={shape:n};return V.runKernel(vh,i,s)}var C3=H({scatterND_:Zne});function Qne(e,t,n,r){if(e.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was ".concat(e.dtype,"."));if(e.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape ".concat(e.shape,"."));let a=e.rank>0?e.shape[0]:1,i=e.rank>1?e.shape[1]:1;if(n.length!==i)throw new Error("outputShape has incorrect number of elements:, ".concat(n.length,", should be: ").concat(i,"."));let s=t.size;if(!(t.rank===0||t.rank===1&&s===a))throw new Error("sparseValues has incorrect shape ".concat(t.shape,", should be [] or [").concat(a,"]"));if(t.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}function Jne(e,t,n,r=0){ba(n);let a=A(e,"sparseIndices","sparseToDense","int32"),i=A(t,"sparseValues","sparseToDense","string_or_numeric"),s=A(r,"defaultValue","sparseToDense",i.dtype);Qne(a,i,n,s);let o={sparseIndices:a,sparseValues:i,defaultValue:s},l={outputShape:n};return V.runKernel(Eh,o,l)}var E3=H({sparseToDense_:Jne});function ere(e,t){let n=A(t,"indices","gatherND","int32"),r={params:A(e,"x","gatherND","string_or_numeric"),indices:n};return V.runKernel(Qp,r)}var T3=H({gatherND_:ere});function tre(e,t){if(t==null)return e.shape.slice();if(Bs(e.shape,t))return t;if(e.shape.length===t.length){let n=[];for(let r=0;r<e.shape.length;r++)t[r]==null&&e.shape[r]!=null?n.push(e.shape[r]):n.push(t[r]);return n}return t}function nre(e,t,n,r){let a=A(e,"x","dropout");if(M(a.dtype==="float32",()=>"x has to be a floating point tensor since it's going to be scaled, but got a ".concat(a.dtype," tensor instead.")),M(t>=0&&t<1,()=>"rate must be a float in the range [0, 1), but got ".concat(t,".")),t===0)return e instanceof He?a.clone():a;let i=tre(a,n),s=1-t,o=ke(Lh(ne(Qo(i,0,1,"float32",r),s)),s);return G(a,o)}var GC=H({dropout_:nre});function qC(e){return Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))))}function Lx(e,t,n){let r=1-e%2,a=new Float32Array(e);for(let i=0;i<e;++i){let s=2*Math.PI*i/(e+r-1);a[i]=t-n*Math.cos(s)}return ht(a,"float32")}async function rre(e,t,n=1){let r=A(e,"predictions","inTopK"),a=A(t,"targets","inTopK");M(r.rank>1,()=>"inTopK() expects the predictions to be of rank 2 or higher, but got ".concat(r.rank)),M(r.rank-1===a.rank,()=>"predictions rank should be 1 larger than targets rank, but got predictions rank ".concat(r.rank," and targets rank ").concat(a.rank)),Ar(r.shape.slice(0,r.shape.length-1),a.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");let i=r.shape[r.shape.length-1];M(n>0&&n<=i,()=>"'k' passed to inTopK() must be > 0 && <= the predictions last dimension (".concat(i,"), but got ").concat(n));let s=await r.data(),o=await a.data(),[l,c]=[s.length/i,i],u=GL("bool",l);for(let d=0;d<l;d++){let p=d*c,h=s.subarray(p,p+c),f=[];for(let m=0;m<h.length;m++)f.push({value:h[m],index:m});f.sort((m,g)=>g.value-m.value),u[d]=0;for(let m=0;m<n;m++)if(f[m].index===o[d]){u[d]=1;break}}return e!==r&&r.dispose(),t!==a&&a.dispose(),wr(u,a.shape,"bool")}var N3=rre,pp={};Ue(pp,{conv2d:()=>sre,depthwiseConv2d:()=>cre,matMul:()=>pre});function are(e,t,n,r,a,i="NHWC",s){let o=e;e.rank===3&&(o=q(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let l=t;l.rank===3&&(l=q(t,[1,t.shape[0],t.shape[1],t.shape[2]])),M(o.rank===4,()=>"Error in conv2dDerFilter: input must be rank 4, but got shape ".concat(o.shape,".")),M(l.rank===4,()=>"Error in conv2dDerFilter: dy must be rank 4, but got shape ".concat(l.shape,".")),M(n.length===4,()=>"Error in conv2dDerFilter: filterShape must be length 4, but got ".concat(n,"."));let c=i==="NHWC"?o.shape[3]:o.shape[1],u=i==="NHWC"?l.shape[3]:l.shape[1];M(c===n[2],()=>"Error in conv2dDerFilter: depth of input ".concat(c,") must match input depth in filter (").concat(n[2],".")),M(u===n[3],()=>"Error in conv2dDerFilter: depth of dy (".concat(u,") must match output depth for filter (").concat(n[3],").")),Rr("conv2dDerFilter",a,s);let d={x:o,dy:l},p={strides:r,pad:a,dataFormat:i,dimRoundingMode:s,filterShape:n};return V.runKernel(Y0,d,p)}var KC=H({conv2DBackpropFilter_:are});function Px(e,t,n){if(n==null||n==="linear")return e;if(n==="relu")return G(e,Uc(t));throw new Error("Cannot compute gradient for fused activation ".concat(n,"."))}function zx(e,t){let n=t,r=fn(e.shape,t.shape);return r.length>0&&(n=Se(n,r)),q(n,e.shape)}function Bx(e,t,n,r){if(t==="linear")return e;if(t==="relu")return ft(e);if(t==="elu")return Mh(e);if(t==="relu6")return Sx(e);if(t==="prelu")return Lg(e,n);if(t==="leakyrelu")return Rg(e,r);if(t==="sigmoid")return Qa(e);throw new Error("Unknown fused activation ".concat(t,"."))}var Wx=(e,t)=>!(e>0)||t==="linear";function ire({x:e,filter:t,strides:n,pad:r,dataFormat:a="NHWC",dilations:i=[1,1],dimRoundingMode:s,bias:o,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:u}){if(l=l||"linear",Wx(V.state.gradientDepth,l)===!1){M(a==="NHWC",()=>"Error in fused conv2d: got dataFormat of ".concat(a," but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear."));let $=$r(e,t,n,r,a,i,s);return o!=null&&($=ne($,o)),Bx($,l,c,u)}let d=A(e,"x","conv2d","float32"),p=A(t,"filter","conv2d","float32"),h=d,f=!1;d.rank===3&&(f=!0,h=q(d,[1,d.shape[0],d.shape[1],d.shape[2]])),M(h.rank===4,()=>"Error in fused conv2d: input must be rank 4, but got rank ".concat(h.rank,".")),M(p.rank===4,()=>"Error in fused conv2d: filter must be rank 4, but got rank ".concat(p.rank,".")),Rr("fused conv2d",r,s);let m=a==="NHWC"?h.shape[3]:h.shape[1];M(p.shape[2]===m,()=>"Error in conv2d: depth of input (".concat(m,") must match input depth for filter ").concat(p.shape[2],".")),M(os(n,i),()=>"Error in conv2D: Either strides or dilations must be 1. Got strides ".concat(n," and dilations '").concat(i,"'"));let g=Tg(h.shape,p.shape,n,i,r,s),y;o!=null&&(y=A(o,"bias","fused conv2d"),[y]=Xt(y,d),a==="NHWC"?kt(g.outShape,y.shape):(M(y.shape.length<=1,()=>"Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-".concat(y.shape.length,".")),M(y.shape.length===0||y.shape[0]===g.outChannels||y.shape[0]===1,()=>"Error in fused conv2d: bias shape (".concat(y.shape,") is not compatible with the number of output channels (").concat(g.outChannels,")"))));let b;if(c!=null){let $=c.shape;if(M($.length<=1||$.length===3,()=>"Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-".concat($.length,".")),$.length===1)M($[0]===1||$[0]===g.outChannels,()=>"Error in fused conv2d: PReLU activation weights (".concat($,") is not compatible with the number of output channels (").concat(g.outChannels,")."));else if($.length===3)try{kt($,g.outShape)}catch(C){let E="Error in fused conv2d: PReLU activation weights (".concat($,") is not compatible with the output shape of the conv2d (").concat(g.outShape,").");throw Error(E)}b=A(c,"prelu weights","fused conv2d")}let v=($,C)=>{M(a==="NHWC",()=>"Error in gradient of fused conv2D: got dataFormat of ".concat(a," but only NHWC is currently supported."));let[E,_,R,N]=C,I=Px($,R,l);M(Ro(i),()=>"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '".concat(i,"'"));let O=cC(_.shape,I,E,n,r),P=KC(_,I,E.shape,n,r),L=[O,P];if(N!=null){let U=zx(N,I);L.push(U)}return L},x={x:h,filter:p,bias:y,preluActivationWeights:b},w={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:s,activation:l,leakyreluAlpha:u};return o==null?as(($,C,E)=>{let _=V.runKernel(Zl,x,w);return E([C,$,_]),f&&(_=q(_,[_.shape[1],_.shape[2],_.shape[3]])),{value:_,gradFunc:v}})(h,p):as(($,C,E,_)=>{let R=V.runKernel(Zl,x,w);return _([C,$,R,E]),f&&(R=q(R,[R.shape[1],R.shape[2],R.shape[3]])),{value:R,gradFunc:v}})(h,p,y)}var sre=H({fusedConv2d_:ire});function ore(e,t,n,r,a,i=[1,1],s){let o=e;e.rank===3&&(o=q(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let l=t;l.rank===3&&(l=q(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let c={x:o,dy:l},u={strides:r,pad:a,dimRoundingMode:s,dilations:i,filterShape:n};return V.runKernel(Z0,c,u)}var _3=H({depthwiseConv2dNativeBackpropFilter_:ore});function lre(e,t,n,r,a,i=[1,1],s){let o=t,l=!1;t.rank===3&&(l=!0,o=q(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let c={dy:o,filter:n},u={strides:r,pad:a,dimRoundingMode:s,dilations:i,inputShape:e},d=V.runKernel(Q0,c,u);return l?q(d,[d.shape[1],d.shape[2],d.shape[3]]):d}var A3=H({depthwiseConv2dNativeBackpropInput_:lre});function ure({x:e,filter:t,strides:n,pad:r,dataFormat:a="NHWC",dilations:i=[1,1],dimRoundingMode:s,bias:o,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:u}){if(Wx(V.state.gradientDepth,l)===!1){let w=Bc(e,t,n,r,a,i,s);return o!=null&&(w=ne(w,o)),Bx(w,l,c,u)}let d=A(e,"x","depthwiseConv2d","float32"),p=A(t,"filter","depthwiseConv2d","float32"),h=d,f=!1;d.rank===3&&(f=!0,h=q(d,[1,d.shape[0],d.shape[1],d.shape[2]])),M(h.rank===4,()=>"Error in fused depthwiseConv2d: input must be rank 4, but got rank ".concat(h.rank,".")),M(p.rank===4,()=>"Error in fused depthwiseConv2d: filter must be rank 4, but got rank ".concat(p.rank,".")),M(h.shape[3]===p.shape[2],()=>"Error in fused depthwiseConv2d: number of input channels (".concat(h.shape[3],") must match the inChannels dimension in filter ").concat(p.shape[2],".")),i==null&&(i=[1,1]),M(os(n,i),()=>"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ".concat(n," and dilations '").concat(i,"'")),Rr("fused depthwiseConv2d",r,s);let m=Tg(h.shape,p.shape,n,i,r,s,!0),g;o!=null&&(g=A(o,"bias","fused conv2d"),[g]=Xt(g,d),kt(m.outShape,g.shape));let y;c!=null&&(y=A(c,"prelu weights","fused depthwiseConv2d"));let b=(w,$)=>{M(Ro(i),()=>"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '".concat(i,"'"));let[C,E,_,R]=$,N=Px(w,_,l),I=A3(E.shape,N,C,n,r,i,s),O=_3(E,N,C.shape,n,r,i,s);if(R!=null){let P=zx(g,N);return[I,O,P]}return[I,O]},v={x:h,filter:p,bias:g,preluActivationWeights:y},x={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:s,activation:l,leakyreluAlpha:u};return o==null?as((w,$,C)=>{let E=V.runKernel(Ql,v,x);return C([$,w,E]),f&&(E=q(E,[E.shape[1],E.shape[2],E.shape[3]])),{value:E,gradFunc:b}})(h,p):as((w,$,C,E)=>{let _=V.runKernel(Ql,v,x);return E([$,w,_,C]),f&&(_=q(_,[_.shape[1],_.shape[2],_.shape[3]])),{value:_,gradFunc:b}})(h,p,g)}var cre=H({fusedDepthwiseConv2d_:ure});function dre({a:e,b:t,transposeA:n=!1,transposeB:r=!1,bias:a,activation:i="linear",preluActivationWeights:s,leakyreluAlpha:o=.2}){if(Wx(V.state.gradientDepth,i)===!1){let R=Ke(e,t,n,r);return a!=null&&(R=ne(R,a)),Bx(R,i,s,o)}let l=A(e,"a","fused matMul"),c=A(t,"b","fused matMul");[l,c]=Xt(l,c);let u=n?l.shape[l.rank-2]:l.shape[l.rank-1],d=r?c.shape[c.rank-1]:c.shape[c.rank-2],p=n?l.shape[l.rank-1]:l.shape[l.rank-2],h=r?c.shape[c.rank-2]:c.shape[c.rank-1],f=l.shape.slice(0,-2),m=c.shape.slice(0,-2),g=Nt(f),y=Nt(m);M(u===d,()=>"Error in fused matMul: inner shapes (".concat(u,") and (").concat(d,") of Tensors with shapes ").concat(l.shape," and ").concat(c.shape," and transposeA=").concat(n," and transposeB=").concat(r," must match."));let b=kt(l.shape.slice(0,-2),c.shape.slice(0,-2)).concat([p,h]),v=n?q(l,[g,u,p]):q(l,[g,p,u]),x=r?q(c,[y,h,d]):q(c,[y,d,h]),w;a!=null&&(w=A(a,"bias","fused matMul"),[w]=Xt(w,l),kt(b,w.shape));let $;s!=null&&($=A(s,"prelu weights","fused matMul"));let C=(R,N)=>{let[I,O,P,L]=N,U=Px(q(R,P.shape),P,i),D,F;if(!n&&!r?(D=Ke(U,O,!1,!0),F=Ke(I,U,!0,!1)):!n&&r?(D=Ke(U,O,!1,!1),F=Ke(U,I,!0,!1)):n&&!r?(D=Ke(O,U,!1,!0),F=Ke(I,U,!1,!1)):(D=Ke(O,U,!0,!0),F=Ke(U,I,!0,!0)),a!=null){let z=zx(L,U);return[D,F,z]}else return[D,F]},E={a:v,b:x,bias:w,preluActivationWeights:$},_={transposeA:n,transposeB:r,activation:i,leakyreluAlpha:o};return a==null?as((R,N,I)=>{let O=V.runKernel(Yl,E,_);return I([R,N,O]),{value:q(O,b),gradFunc:C}})(v,x):as((R,N,I,O)=>{let P=V.runKernel(Yl,E,_);return O([R,N,P,I]),{value:q(P,b),gradFunc:C}})(v,x,w)}var pre=H({fusedMatMul_:dre});function hre(e){return Lx(e,.54,.46)}var fre=H({hammingWindow_:hre});function mre(e){return Lx(e,.5,.5)}var R3=H({hannWindow_:mre});function gre(e,t,n,r=!1,a=0){let i=0,s=[];for(;i+t<=e.size;)s.push(et(e,i,t)),i+=n;if(r)for(;i<e.size;){let o=i+t-e.size,l=wt([et(e,i,t-o),da([o],a)]);s.push(l),i+=n}return s.length===0?ts([],[0,t]):q(wt(s),[s.length,t])}var D3=H({frame_:gre});function yre(e,t,n,r,a=R3){r==null&&(r=qC(t));let i=D3(e,t,n),s=G(i,a(t));return Bg(s,r)}var bre=H({stft_:yre});function vre(e,t,n,r,a="bilinear",i=0){let s=A(e,"image","cropAndResize"),o=A(t,"boxes","cropAndResize","float32"),l=A(n,"boxInd","cropAndResize","int32"),c=o.shape[0];M(s.rank===4,()=>"Error in cropAndResize: image must be rank 4,but got rank ".concat(s.rank,".")),M(o.rank===2&&o.shape[1]===4,()=>"Error in cropAndResize: boxes must be have size [".concat(c,",4] but had shape ").concat(o.shape,".")),M(l.rank===1&&l.shape[0]===c,()=>"Error in cropAndResize: boxInd must be have size [".concat(c,"] but had shape ").concat(o.shape,".")),M(r.length===2,()=>"Error in cropAndResize: cropSize must be of length 2, but got length ".concat(r.length,".")),M(r[0]>=1&&r[1]>=1,()=>"cropSize must be atleast [1,1], but was ".concat(r)),M(a==="bilinear"||a==="nearest",()=>"method must be bilinear or nearest, but was ".concat(a));let u={image:s,boxes:o,boxInd:l},d={method:a,extrapolationValue:i,cropSize:r};return V.runKernel(jp,u,d)}var xre=H({cropAndResize_:vre});function wre(e){let t=A(e,"image","flipLeftRight","float32");M(t.rank===4,()=>"Error in flipLeftRight: image must be rank 4,but got rank ".concat(t.rank,"."));let n={image:t};return V.runKernel(Yp,n,{})}var kre=H({flipLeftRight_:wre});function Sre(e){let t=A(e,"image","grayscaleToRGB"),n=t.rank-1,r=t.shape[n];M(t.rank>=2,()=>"Error in grayscaleToRGB: images must be at least rank 2, but got rank ".concat(t.rank,".")),M(r===1,()=>"Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ".concat(r,"."));let a=new Array(t.rank);return a.fill(1,0,n),a[n]=3,sa(t,a)}var Ire=H({grayscaleToRGB_:Sre});function $re(e,t,n=0,r=.5){let a=A(e,"image","rotateWithOffset","float32");M(a.rank===4,()=>"Error in rotateWithOffset: image must be rank 4,but got rank ".concat(a.rank,"."));let i={image:a},s={radians:t,fillValue:n,center:r};return V.runKernel(Dh,i,s)}var Cre=H({rotateWithOffset_:$re});function Wh(e,t,n,r,a,i){r==null&&(r=.5),a==null&&(a=Number.NEGATIVE_INFINITY),i==null&&(i=0);let s=e.shape[0];return n=Math.min(n,s),M(0<=r&&r<=1,()=>"iouThreshold must be in [0, 1], but was '".concat(r,"'")),M(e.rank===2,()=>"boxes must be a 2D tensor, but was of rank '".concat(e.rank,"'")),M(e.shape[1]===4,()=>"boxes must have 4 columns, but 2nd dimension was ".concat(e.shape[1])),M(t.rank===1,()=>"scores must be a 1D tensor"),M(t.shape[0]===s,()=>"scores has incompatible shape with boxes. Expected ".concat(s,", but was ").concat(t.shape[0])),M(0<=i&&i<=1,()=>"softNmsSigma must be in [0, 1], but was '".concat(i,"'")),{maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:i}}function Ere(e,t,n,r=.5,a=Number.NEGATIVE_INFINITY){let i=A(e,"boxes","nonMaxSuppression","float32"),s=A(t,"scores","nonMaxSuppression","float32"),o=Wh(i,s,n,r,a);n=o.maxOutputSize,r=o.iouThreshold,a=o.scoreThreshold;let l={maxOutputSize:n,iouThreshold:r,scoreThreshold:a};return V.runKernel(dh,{boxes:i,scores:s},l)}var Tre=H({nonMaxSuppression_:Ere});function Nre(e,t,n){let r=_re(e,t,n),a=r<0?-(r+1):r;e.splice(a,0,t)}function _re(e,t,n){return Rre(e,t,n||Are)}function Are(e,t){return e>t?1:e<t?-1:0}function Rre(e,t,n){let r=0,a=e.length,i=0,s=!1;for(;r<a;){i=r+(a-r>>>1);let o=n(t,e[i]);o>0?r=i+1:(a=i,s=!o)}return s?r:-r-1}function F3(e,t,n,r,a){return XC(e,t,n,r,a,0)}function M3(e,t,n,r,a,i){return XC(e,t,n,r,a,0,!1,i,!0)}function O3(e,t,n,r,a,i){return XC(e,t,n,r,a,i,!0)}function XC(e,t,n,r,a,i,s=!1,o=!1,l=!1){let c=[];for(let g=0;g<t.length;g++)t[g]>a&&c.push({score:t[g],boxIndex:g,suppressBeginIndex:0});c.sort(JA);let u=i>0?-.5/i:0,d=[],p=[];for(;d.length<n&&c.length>0;){let g=c.pop(),{score:y,boxIndex:b,suppressBeginIndex:v}=g;if(y<a)break;let x=!1;for(let w=d.length-1;w>=v;--w){let $=Dre(e,b,d[w]);if($>=r){x=!0;break}if(g.score=g.score*Fre(r,u,$),g.score<=a)break}g.suppressBeginIndex=d.length,x||(g.score===y?(d.push(b),p.push(g.score)):g.score>a&&Nre(c,g,JA))}let h=d.length,f=n-h;o&&f>0&&(d.push(...new Array(f).fill(0)),p.push(...new Array(f).fill(0)));let m={selectedIndices:d};return s&&(m.selectedScores=p),l&&(m.validOutputs=h),m}function Dre(e,t,n){let r=e.subarray(t*4,t*4+4),a=e.subarray(n*4,n*4+4),i=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),o=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),c=Math.min(a[0],a[2]),u=Math.min(a[1],a[3]),d=Math.max(a[0],a[2]),p=Math.max(a[1],a[3]),h=(o-i)*(l-s),f=(d-c)*(p-u);if(h<=0||f<=0)return 0;let m=Math.max(i,c),g=Math.max(s,u),y=Math.min(o,d),b=Math.min(l,p),v=Math.max(y-m,0)*Math.max(b-g,0);return v/(h+f-v)}function Fre(e,t,n){let r=Math.exp(t*n*n);return n<=e?r:0}function JA(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}async function Mre(e,t,n,r=.5,a=Number.NEGATIVE_INFINITY){let i=A(e,"boxes","nonMaxSuppressionAsync"),s=A(t,"scores","nonMaxSuppressionAsync"),o=Wh(i,s,n,r,a);n=o.maxOutputSize,r=o.iouThreshold,a=o.scoreThreshold;let l=await Promise.all([i.data(),s.data()]),c=l[0],u=l[1],{selectedIndices:d}=F3(c,u,n,r,a);return i!==e&&i.dispose(),s!==t&&s.dispose(),ht(d,"int32")}var Ore=Mre;function Lre(e,t,n,r=.5,a=Number.NEGATIVE_INFINITY,i=0){let s=A(e,"boxes","nonMaxSuppression"),o=A(t,"scores","nonMaxSuppression"),l=Wh(s,o,n,r,a,i);n=l.maxOutputSize,r=l.iouThreshold,a=l.scoreThreshold,i=l.softNmsSigma;let c={boxes:s,scores:o},u={maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:i},d=V.runKernel(hh,c,u);return{selectedIndices:d[0],selectedScores:d[1]}}var Pre=H({nonMaxSuppressionWithScore_:Lre});async function zre(e,t,n,r=.5,a=Number.NEGATIVE_INFINITY,i=0){let s=A(e,"boxes","nonMaxSuppressionAsync"),o=A(t,"scores","nonMaxSuppressionAsync"),l=Wh(s,o,n,r,a,i);n=l.maxOutputSize,r=l.iouThreshold,a=l.scoreThreshold,i=l.softNmsSigma;let c=await Promise.all([s.data(),o.data()]),u=c[0],d=c[1],{selectedIndices:p,selectedScores:h}=O3(u,d,n,r,a,i);return s!==e&&s.dispose(),o!==t&&o.dispose(),{selectedIndices:ht(p,"int32"),selectedScores:ht(h)}}var Bre=zre;function Wre(e,t,n,r=.5,a=Number.NEGATIVE_INFINITY,i=!1){let s=A(e,"boxes","nonMaxSuppression"),o=A(t,"scores","nonMaxSuppression"),l=Wh(s,o,n,r,a,null),c=l.maxOutputSize,u=l.iouThreshold,d=l.scoreThreshold,p={boxes:s,scores:o},h={maxOutputSize:c,iouThreshold:u,scoreThreshold:d,padToMaxOutputSize:i},f=V.runKernel(ph,p,h);return{selectedIndices:f[0],validOutputs:f[1]}}var Ure=H({nonMaxSuppressionPadded_:Wre});async function Vre(e,t,n,r=.5,a=Number.NEGATIVE_INFINITY,i=!1){let s=A(e,"boxes","nonMaxSuppressionAsync"),o=A(t,"scores","nonMaxSuppressionAsync"),l=Wh(s,o,n,r,a,null),c=l.maxOutputSize,u=l.iouThreshold,d=l.scoreThreshold,[p,h]=await Promise.all([s.data(),o.data()]),{selectedIndices:f,validOutputs:m}=M3(p,h,c,u,d,i);return s!==e&&s.dispose(),o!==t&&o.dispose(),{selectedIndices:ht(f,"int32"),validOutputs:Ae(m,"int32")}}var Hre=Vre;function jre(e,t,n=!1,r=!1){let a=A(e,"images","resizeBilinear");M(a.rank===3||a.rank===4,()=>"Error in resizeBilinear: x must be rank 3 or 4, but got rank ".concat(a.rank,".")),M(t.length===2,()=>"Error in resizeBilinear: new shape must 2D, but got shape ".concat(t,".")),M(r===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let i=a,s=!1;a.rank===3&&(s=!0,i=q(a,[1,a.shape[0],a.shape[1],a.shape[2]]));let o={images:i},l={alignCorners:n,halfPixelCenters:r,size:t},c=V.runKernel(wc,o,l);return s?q(c,[c.shape[1],c.shape[2],c.shape[3]]):c}var L3=H({resizeBilinear_:jre});function Gre(e,t,n=!1,r=!1){let a=A(e,"images","resizeNearestNeighbor");M(a.rank===3||a.rank===4,()=>"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ".concat(a.rank,".")),M(t.length===2,()=>"Error in resizeNearestNeighbor: new shape must 2D, but got shape ".concat(t,".")),M(a.dtype==="float32"||a.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),M(r===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let i=a,s=!1;a.rank===3&&(s=!0,i=q(a,[1,a.shape[0],a.shape[1],a.shape[2]]));let o={images:i},l={alignCorners:n,halfPixelCenters:r,size:t},c=V.runKernel(xc,o,l);return s?q(c,[c.shape[1],c.shape[2],c.shape[3]]):c}var P3=H({resizeNearestNeighbor_:Gre});function qre(e,t="binary",n=!1,r=.5){let a=A(e,"image","threshold"),i=.2989,s=.587,o=.114,l=a.shape[0]*a.shape[1],c=G(ht([r]),255),u,d,p,h;if(M(a.rank===3,()=>"Error in threshold: image must be rank 3,but got rank ".concat(a.rank,".")),M(a.shape[2]===3||a.shape[2]===1,()=>"Error in threshold: image color channel must be equal to 3 or 1but got ".concat(a.shape[2],".")),M(a.dtype==="int32"||a.dtype==="float32",()=>"Error in dtype: image dtype must be int32 or float32,but got dtype ".concat(a.dtype,".")),M(t==="otsu"||t==="binary",()=>"Method must be binary or otsu, but was ".concat(t)),a.shape[2]===3){[u,d,p]=Ur(a,[1,1,1],-1);let m=G(u,i),g=G(d,s),y=G(p,o);h=ne(ne(m,g),y)}else h=e;if(t==="otsu"){let m=aC(de(Ix(h),"int32"),wr([]),256);c=Kre(m,l)}let f=n?Zo(h,c):Dr(h,c);return de(G(f,255),"int32")}function Kre(e,t){let n=ht([-1]),r=ht([0]),a=ht([0]),i,s,o,l,c,u;for(let d=0;d<e.size-1;d++){i=et(e,0,d+1),s=et(e,d+1),c=ke(Se(i),t),u=ke(Se(s),t);let p=Se(G(i,ou(0,i.size)));o=ke(p,Se(i));let h=da(s.shape,i.size),f=ne(ou(0,s.size),h),m=G(s,f);l=ke(Se(m),Se(s));let g=xe(o,l),y=xe(o,l),b=G(c,u);a=G(G(b,g),y);let v=Dr(a,r);r=Pn(v,a,r),n=Pn(v,ht([d]),n)}return n}var Xre=H({threshold_:qre});function Yre(e,t,n="nearest",r="constant",a=0,i){let s=A(e,"image","transform","float32"),o=A(t,"transforms","transform","float32");M(s.rank===4,()=>"Error in transform: image must be rank 4,but got rank ".concat(s.rank,".")),M(o.rank===2&&(o.shape[0]===s.shape[0]||o.shape[0]===1)&&o.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),M(i==null||i.length===2,()=>"Error in transform: outputShape must be [height, width] or null, but got ".concat(i,"."));let l={image:s,transforms:o},c={interpolation:n,fillMode:r,fillValue:a,outputShape:i};return V.runKernel(_h,l,c)}var Zre=H({transform_:Yre});function Qre(e,t,n){let r=A(e,"a","bandPart");M(r.rank>=2,()=>"bandPart(): Rank must be at least 2, got ".concat(r.rank,"."));let a=r.shape,[i,s]=r.shape.slice(-2),o,l;typeof t=="number"?(M(t%1===0,()=>"bandPart(): numLower must be an integer, got ".concat(t,".")),M(t<=i,()=>"bandPart(): numLower (".concat(t,") must not be greater than the number of rows (").concat(i,").")),o=A(t<0?i:t,"numLower","bandPart")):(M(t.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),o=Pn(op(t,0),i,Do(t,i))),typeof n=="number"?(M(n%1===0,()=>"bandPart(): numUpper must be an integer, got ".concat(n,".")),M(n<=s,()=>"bandPart(): numUpper (".concat(n,") must not be greater than the number of columns (").concat(s,").")),l=A(n<0?s:n,"numUpper","bandPart")):(M(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=Pn(op(n,0),s,Do(n,s)));let c=q(ou(0,i,1,"int32"),[-1,1]),u=ou(0,s,1,"int32"),d=xe(c,u),p=ti(Zo(d,o),Us(d,_t(l))),h=qt([i,s],r.dtype);return q(Sn(en(q(r,[-1,i,s])).map(f=>Pn(p,f,h))),a)}var Jre=H({bandPart_:Qre});function eae(e){let t;if(Array.isArray(e)){t=!1,M(e!=null&&e.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");let a=e[0].shape[0];for(let i=1;i<e.length;++i)M(e[i].shape[0]===a,()=>"Gram-Schmidt: Non-unique lengths found in the input vectors: (".concat(e[i].shape[0]," vs. ").concat(a,")"))}else t=!0,e=Ur(e,e.shape[0],0).map(a=>el(a,[0]));M(e.length<=e[0].shape[0],()=>"Gram-Schmidt: Number of vectors (".concat(e.length,") exceeds number of dimensions (").concat(e[0].shape[0],")."));let n=[],r=e;for(let a=0;a<e.length;++a)n.push(V.tidy(()=>{let i=r[a];if(a>0)for(let s=0;s<a;++s){let o=G(Se(G(n[s],i)),n[s]);i=xe(i,o)}return ke(i,Oh(i,"euclidean"))}));return t?Sn(n,0):n}var tae=H({gramSchmidt_:eae});function nae(e,t=!1){if(M(e.rank>=2,()=>"qr() requires input tensor to have a rank >= 2, but got rank ".concat(e.rank)),e.rank===2)return eR(e,t);{let n=e.shape.slice(0,e.shape.length-2).reduce((l,c)=>l*c),r=en(q(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),a=[],i=[];r.forEach(l=>{let[c,u]=eR(l,t);a.push(c),i.push(u)});let s=q(Sn(a,0),e.shape),o=q(Sn(i,0),e.shape);return[s,o]}}function eR(e,t=!1){return V.tidy(()=>{M(e.shape.length===2,()=>"qr2d() requires a 2D Tensor, but got a ".concat(e.shape.length,"D Tensor."));let n=e.shape[0],r=e.shape[1],a=gx(n),i=es(e),s=ts([[1]],[1,1]),o=es(s),l=n>=r?r:n;for(let c=0;c<l;++c){let u=i,d=o,p=a;[o,i,a]=V.tidy(()=>{let h=et(i,[c,c],[n-c,1]),f=Oh(h),m=et(i,[c,c],[1,1]),g=Pn(Dr(m,0),ts([[-1]]),ts([[1]])),y=xe(m,G(g,f)),b=ke(h,y);b.shape[0]===1?o=es(s):o=wt([s,et(b,[1,0],[b.shape[0]-1,b.shape[1]])],0);let v=_t(ke(Ke(g,y),f)),x=et(i,[c,0],[n-c,r]),w=G(v,o),$=Ye(o);if(c===0)i=xe(x,Ke(w,Ke($,x)));else{let _=xe(x,Ke(w,Ke($,x)));i=wt([et(i,[0,0],[c,r]),_],0)}let C=Ye(w),E=et(a,[0,c],[n,a.shape[1]-c]);if(c===0)a=xe(E,Ke(Ke(E,o),C));else{let _=xe(E,Ke(Ke(E,o),C));a=wt([et(a,[0,0],[n,c]),_],1)}return[o,i,a]}),We([u,d,p])}return!t&&n>r&&(a=et(a,[0,0],[n,r]),i=et(i,[0,0],[r,r])),[a,i]})}var rae=H({qr_:nae}),vr;(function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(vr||(vr={}));function aae(e,t,n=vr.SUM_BY_NONZERO_WEIGHTS){let r=A(e,"losses","computeWeightedLoss"),a=null;t!=null&&(a=A(t,"weights","computeWeightedLoss"));let i=a==null?r:G(r,a);if(n===vr.NONE)return i;if(n===vr.SUM)return Se(i);if(n===vr.MEAN){if(a==null)return Gt(i);{let s=r.size/a.size,o=ke(Se(i),Se(a));return s>1?ke(o,Ae(s)):o}}if(n===vr.SUM_BY_NONZERO_WEIGHTS){if(a==null)return ke(Se(i),Ae(r.size));{let s=G(a,oa(r.shape)),o=de(Se(su(s,Ae(0))),"float32");return ke(Se(i),o)}}throw Error("Unknown reduction: ".concat(n))}var Vs=H({computeWeightedLoss_:aae});function iae(e,t,n,r=vr.SUM_BY_NONZERO_WEIGHTS){let a=A(e,"labels","absoluteDifference"),i=A(t,"predictions","absoluteDifference"),s=null;n!=null&&(s=A(n,"weights","absoluteDifference")),Ar(a.shape,i.shape,"Error in absoluteDifference: ");let o=un(xe(a,i));return Vs(o,s,r)}var sae=H({absoluteDifference_:iae});function oae(e,t,n,r,a=vr.SUM_BY_NONZERO_WEIGHTS){let i=A(e,"labels","cosineDistance"),s=A(t,"predictions","cosineDistance"),o=null;r!=null&&(o=A(r,"weights","cosineDistance")),Ar(i.shape,s.shape,"Error in cosineDistance: ");let l=Ae(1),c=xe(l,Se(G(i,s),n,!0));return Vs(c,o,a)}var lae=H({cosineDistance_:oae});function uae(e,t,n,r=vr.SUM_BY_NONZERO_WEIGHTS){let a=A(e,"labels","hingeLoss"),i=A(t,"predictions","hingeLoss"),s=null;n!=null&&(s=A(n,"weights","hingeLoss")),Ar(a.shape,i.shape,"Error in hingeLoss: ");let o=Ae(1);a=xe(G(Ae(2),a),o);let l=ft(xe(o,G(a,i)));return Vs(l,s,r)}var cae=H({hingeLoss_:uae});function dae(e,t,n,r=1,a=vr.SUM_BY_NONZERO_WEIGHTS){let i=A(e,"labels","huberLoss"),s=A(t,"predictions","huberLoss"),o=null;n!=null&&(o=A(n,"weights","huberLoss")),Ar(i.shape,s.shape,"Error in huberLoss: ");let l=Ae(r),c=un(xe(s,i)),u=Do(c,l),d=xe(c,u),p=ne(G(Ae(.5),vt(u)),G(l,d));return Vs(p,o,a)}var pae=H({huberLoss_:dae});function hae(e,t,n,r=1e-7,a=vr.SUM_BY_NONZERO_WEIGHTS){let i=A(e,"labels","logLoss"),s=A(t,"predictions","logLoss"),o=null;n!=null&&(o=A(n,"weights","logLoss")),Ar(i.shape,s.shape,"Error in logLoss: ");let l=Ae(1),c=Ae(r),u=_t(G(i,fa(ne(s,c)))),d=G(xe(l,i),fa(ne(xe(l,s),c))),p=xe(u,d);return Vs(p,o,a)}var fae=H({logLoss_:hae});function mae(e,t,n,r=vr.SUM_BY_NONZERO_WEIGHTS){let a=A(e,"labels","meanSquaredError"),i=A(t,"predictions","meanSquaredError"),s=null;n!=null&&(s=A(n,"weights","meanSquaredError")),Ar(a.shape,i.shape,"Error in meanSquaredError: ");let o=Ax(a,i);return Vs(o,s,r)}var gae=H({meanSquaredError_:mae});function yae(e,t){let n=A(e,"labels","sigmoidCrossEntropyWithLogits"),r=A(t,"logits","sigmoidCrossEntropyWithLogits");Ar(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");let a=ft(r),i=G(r,n),s=Dg(Cr(_t(un(r))));return ne(xe(a,i),s)}function bae(e,t,n,r=0,a=vr.SUM_BY_NONZERO_WEIGHTS){let i=A(e,"multiClassLabels","sigmoidCrossEntropy"),s=A(t,"logits","sigmoidCrossEntropy"),o=null;if(n!=null&&(o=A(n,"weights","sigmoidCrossEntropy")),Ar(i.shape,s.shape,"Error in sigmoidCrossEntropy: "),r>0){let c=Ae(r),u=Ae(1),d=Ae(.5);i=ne(G(i,xe(u,c)),G(d,c))}let l=yae(i,s);return Vs(l,o,a)}var vae=H({sigmoidCrossEntropy_:bae});function xae(e,t,n=-1){if(n===-1&&(n=t.rank-1),n!==t.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ".concat(t.rank," and dim was ").concat(n));return as((r,a,i)=>{let s=vx(a,[n],!0),o=xe(de(a,"float32"),s);i([r,o]);let l=_t(G(o,r));return{value:Se(l,[n]),gradFunc:(c,u)=>{let[d,p]=u,h=iu(c.shape,[n]);return[G(q(c,h),xe(de(d,"float32"),Cr(p))),G(q(c,h),xe(Cr(p),de(d,"float32")))]}}})(e,t)}function wae(e,t,n,r=0,a=vr.SUM_BY_NONZERO_WEIGHTS){let i=A(e,"onehotLabels","softmaxCrossEntropy"),s=A(t,"logits","softmaxCrossEntropy"),o=null;if(n!=null&&(o=A(n,"weights","softmaxCrossEntropy")),Ar(i.shape,s.shape,"Error in softmaxCrossEntropy: "),r>0){let c=Ae(r),u=Ae(1),d=Ae(i.shape[1]);i=ne(G(i,xe(u,c)),ke(c,d))}let l=xae(i,s);return Vs(l,o,a)}var kae=H({softmaxCrossEntropy_:wae});function Sae(e,t,n,r){let a=A(e,"indices","sparseFillEmptyRows","int32"),i=A(t,"values","sparseFillEmptyRows"),s=A(n,"denseShape","sparseFillEmptyRows","int32"),o=A(r,"defaultValue","sparseFillEmptyRows",i.dtype);if(a.rank!==2)throw new Error("Indices should be Tensor2D but received shape\n        ".concat(a.shape));if(i.rank!==1)throw new Error("Values should be Tensor1D but received shape ".concat(i.shape));if(s.rank!==1)throw new Error("Dense shape should be Tensor1D but received shape ".concat(s.shape));if(o.rank!==0)throw new Error("Default value should be a scalar but received shape ".concat(o.shape));let l={indices:a,values:i,denseShape:s,defaultValue:o},c=V.runKernel(hg,l);return{outputIndices:c[0],outputValues:c[1],emptyRowIndicator:c[2],reverseIndexMap:c[3]}}var Iae=H({sparseFillEmptyRows_:Sae});function $ae(e,t,n){let r=A(e,"inputIndices","sparseReshape","int32"),a=A(t,"inputShape","sparseReshape","int32"),i=A(n,"newShape","sparseReshape","int32");if(r.rank!==2)throw new Error("Input indices should be Tensor2D but received shape\n        ".concat(r.shape));if(a.rank!==1)throw new Error("Input shape should be Tensor1D but received shape ".concat(a.shape));if(i.rank!==1)throw new Error("New shape should be Tensor1D but received shape ".concat(i.shape));let s={inputIndices:r,inputShape:a,newShape:i},o=V.runKernel(Ch,s);return{outputIndices:o[0],outputShape:o[1]}}var Cae=H({sparseReshape_:$ae});function Eae(e,t,n){let r=A(e,"data","sparseSegmentMean"),a=A(t,"indices","sparseSegmentMean","int32"),i=A(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.rank!==1)throw new Error("Indices should be Tensor1D but received shape\n          ".concat(a.shape));if(i.rank!==1)throw new Error("Segment ids should be Tensor1D but received shape\n          ".concat(i.shape));let s={data:r,indices:a,segmentIds:i};return V.runKernel(fg,s)}var Tae=H({sparseSegmentMean_:Eae});function Nae(e,t,n){let r=A(e,"data","sparseSegmentSum"),a=A(t,"indices","sparseSegmentSum","int32"),i=A(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.rank!==1)throw new Error("Indices should be Tensor1D but received shape\n         ".concat(a.shape));if(i.rank!==1)throw new Error("Segment ids should be Tensor1D but received shape\n         ".concat(i.shape));let s={data:r,indices:a,segmentIds:i};return V.runKernel(mg,s)}var _ae=H({sparseSegmentSum_:Nae});function Aae(e,t,n,r,a,i,s,o){let l=A(e,"data","stringNGrams","string");if(l.dtype!=="string")throw new Error("Data must be of datatype string");if(l.shape.length!==1)throw new Error("Data must be a vector, saw: ".concat(l.shape));let c=A(t,"dataSplits","stringNGrams");if(c.dtype!=="int32")throw new Error("Data splits must be of datatype int32");let u={separator:n,nGramWidths:r,leftPad:a,rightPad:i,padWidth:s,preserveShortSequences:o},d={data:l,dataSplits:c},p=V.runKernel(bg,d,u);return{nGrams:p[0],nGramsSplits:p[1]}}var Rae=H({stringNGrams_:Aae});function Dae(e,t,n=!0){let r=A(e,"input","stringSplit","string"),a=A(t,"delimiter","stringSplit","string");if(r.rank!==1)throw new Error("Input should be Tensor1D but received shape ".concat(r.shape));if(a.rank!==0)throw new Error("Delimiter should be a scalar but received shape ".concat(a.shape));let i={skipEmpty:n},s={input:r,delimiter:a},o=V.runKernel(vg,s,i);return{indices:o[0],values:o[1],shape:o[2]}}var Fae=H({stringSplit_:Dae});function Mae(e,t){let n=A(e,"input","stringToHashBucketFast","string"),r={numBuckets:t};if(t<=0)throw new Error("Number of buckets must be at least 1");let a={input:n};return V.runKernel(xg,a,r)}var Oae=H({stringToHashBucketFast_:Mae});function Lae(e,t,n,r=!0){let a=A(e,"input","staticRegexReplace","string"),i={pattern:t,rewrite:n,replaceGlobal:r};return V.runKernel(yg,{x:a},i)}var Pae=H({staticRegexReplace_:Lae}),z3={fft:zg,ifft:dp,rfft:Bg,irfft:_x},B3={hammingWindow:fre,hannWindow:R3,frame:D3,stft:bre},$a={flipLeftRight:kre,grayscaleToRGB:Ire,resizeNearestNeighbor:P3,resizeBilinear:L3,rotateWithOffset:Cre,cropAndResize:xre,nonMaxSuppression:Tre,nonMaxSuppressionAsync:Ore,nonMaxSuppressionWithScore:Pre,nonMaxSuppressionWithScoreAsync:Bre,nonMaxSuppressionPadded:Ure,nonMaxSuppressionPaddedAsync:Hre,threshold:Xre,transform:Zre},YC={bandPart:Jre,gramSchmidt:tae,qr:rae},W3={absoluteDifference:sae,computeWeightedLoss:Vs,cosineDistance:lae,hingeLoss:cae,huberLoss:pae,logLoss:fae,meanSquaredError:gae,sigmoidCrossEntropy:vae,softmaxCrossEntropy:kae},U3={sparseFillEmptyRows:Iae,sparseReshape:Cae,sparseSegmentMean:Tae,sparseSegmentSum:_ae},V3={stringNGrams:Rae,stringSplit:Fae,stringToHashBucketFast:Oae,staticRegexReplace:Pae},le={};Ue(le,{Serializable:()=>H3,SerializationMap:()=>wl,registerClass:()=>j3});var H3=class{getClassName(){return this.constructor.className}static fromConfig(e,t){return new e(t)}},wl=class{constructor(){this.classNameMap={}}static getMap(){return wl.instance==null&&(wl.instance=new wl),wl.instance}static register(e){wl.getMap().classNameMap[e.className]=[e,e.fromConfig]}};function j3(e){M(e.className!=null,()=>"Class being registered does not have the static className property defined."),M(typeof e.className=="string",()=>"className is required to be a string, but got type "+typeof e.className),M(e.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),wl.register(e)}var Hs=class extends H3{minimize(e,t=!1,n){let{value:r,grads:a}=this.computeGradients(e,n);if(n!=null){let i=n.map(s=>({name:s.name,tensor:a[s.name]}));this.applyGradients(i)}else this.applyGradients(a);return We(a),t?r:(r.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,t){return GP(e,t)}dispose(){this.iterations_!=null&&We(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:Ae(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for this optimizer class ".concat(this.getClassName()))}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}};Object.defineProperty(Hs,Symbol.hasInstance,{value:e=>e.minimize!=null&&e.computeGradients!=null&&e.applyGradients!=null});var ZC=class extends Hs{static get className(){return"Adadelta"}constructor(e,t,n=null){super(),this.learningRate=e,this.rho=t,this.epsilon=n,this.accumulatedGrads=[],this.accumulatedUpdates=[],n==null&&(this.epsilon=V.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(t=>t.name):Object.keys(e)).forEach((t,n)=>{let r=V.registeredVariables[t],a=!1;this.accumulatedGrads[n]==null&&(this.accumulatedGrads[n]={originalName:"".concat(t,"/accum_grad"),variable:K(()=>nt(r).variable(a))}),this.accumulatedUpdates[n]==null&&(this.accumulatedUpdates[n]={originalName:"".concat(t,"/accum_var"),variable:K(()=>nt(r).variable(a))});let i=Array.isArray(e)?e[n].tensor:e[t];if(i==null)return;let s=this.accumulatedGrads[n].variable,o=this.accumulatedUpdates[n].variable;K(()=>{let l=ne(G(s,this.rho),G(vt(i),1-this.rho)),c=G(ke(Kn(ne(o,this.epsilon)),Kn(ne(s,this.epsilon))),i),u=ne(G(o,this.rho),G(vt(c),1-this.rho));s.assign(l),o.assign(u);let d=ne(G(c,-this.learningRate),r);r.assign(d)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(We(this.accumulatedGrads.map(e=>e.variable)),We(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){let e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);let t=e.length/2,n=!1;this.accumulatedGrads=e.slice(0,t).map(r=>({originalName:r.name,variable:r.tensor.variable(n)})),this.accumulatedUpdates=e.slice(t,t*2).map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.rho,t.epsilon)}},QC=class extends Hs{static get className(){return"Adagrad"}constructor(e,t=.1){super(),this.learningRate=e,this.initialAccumulatorValue=t,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(t=>t.name):Object.keys(e)).forEach((t,n)=>{let r=V.registeredVariables[t];this.accumulatedGrads[n]==null&&(this.accumulatedGrads[n]={originalName:"".concat(t,"/accumulator"),variable:K(()=>da(r.shape,this.initialAccumulatorValue).variable(!1))});let a=Array.isArray(e)?e[n].tensor:e[t];if(a==null)return;let i=this.accumulatedGrads[n].variable;K(()=>{let s=ne(i,vt(a));i.assign(s);let o=ne(G(ke(a,Kn(ne(s,V.backend.epsilon()))),-this.learningRate),r);r.assign(o)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&We(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);let t=!1;this.accumulatedGrads=e.map(n=>({originalName:n.name,variable:n.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}},JC=class extends Hs{static get className(){return"Adam"}constructor(e,t,n,r=null){super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],K(()=>{this.accBeta1=Ae(t).variable(),this.accBeta2=Ae(n).variable()}),r==null&&(this.epsilon=V.backend.epsilon())}applyGradients(e){let t=Array.isArray(e)?e.map(n=>n.name):Object.keys(e);K(()=>{let n=xe(1,this.accBeta1),r=xe(1,this.accBeta2);t.forEach((a,i)=>{let s=V.registeredVariables[a],o=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:"".concat(a,"/m"),variable:K(()=>nt(s).variable(o))}),this.accumulatedSecondMoment[i]==null&&(this.accumulatedSecondMoment[i]={originalName:"".concat(a,"/v"),variable:K(()=>nt(s).variable(o))});let l=Array.isArray(e)?e[i].tensor:e[a];if(l==null)return;let c=this.accumulatedFirstMoment[i].variable,u=this.accumulatedSecondMoment[i].variable,d=ne(G(c,this.beta1),G(l,1-this.beta1)),p=ne(G(u,this.beta2),G(vt(l),1-this.beta2)),h=ke(d,n),f=ke(p,r);c.assign(d),u.assign(p);let m=ne(G(ke(h,ne(Kn(f),this.epsilon)),-this.learningRate),s);s.assign(m)}),this.accBeta1.assign(G(this.accBeta1,this.beta1)),this.accBeta2.assign(G(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&We(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&We(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){let e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e),K(()=>{this.accBeta1.assign(Os(this.beta1,this.iterations_+1)),this.accBeta2.assign(Os(this.beta2,this.iterations_+1))});let t=e.length/2,n=!1;this.accumulatedFirstMoment=e.slice(0,t).map(r=>({originalName:r.name,variable:r.tensor.variable(n)})),this.accumulatedSecondMoment=e.slice(t,t*2).map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}},eE=class extends Hs{static get className(){return"Adamax"}constructor(e,t,n,r=null,a=0){super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=r,this.decay=a,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],K(()=>{this.iteration=Ae(0).variable(),this.accBeta1=Ae(t).variable()}),r==null&&(this.epsilon=V.backend.epsilon())}applyGradients(e){let t=Array.isArray(e)?e.map(n=>n.name):Object.keys(e);K(()=>{let n=xe(1,this.accBeta1),r=ke(-this.learningRate,ne(G(this.iteration,this.decay),1));t.forEach((a,i)=>{let s=V.registeredVariables[a],o=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:"".concat(a,"/m"),variable:nt(s).variable(o)}),this.accumulatedWeightedInfNorm[i]==null&&(this.accumulatedWeightedInfNorm[i]={originalName:"".concat(a,"/v"),variable:nt(s).variable(o)});let l=Array.isArray(e)?e[i].tensor:e[a];if(l==null)return;let c=this.accumulatedFirstMoment[i].variable,u=this.accumulatedWeightedInfNorm[i].variable,d=ne(G(c,this.beta1),G(l,1-this.beta1)),p=G(u,this.beta2),h=un(l),f=ls(p,h);c.assign(d),u.assign(f);let m=ne(G(ke(r,n),ke(d,ne(f,this.epsilon))),s);s.assign(m)}),this.iteration.assign(ne(this.iteration,1)),this.accBeta1.assign(G(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&We(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&We(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}},Ux=class extends Hs{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(t=>t.name):Object.keys(e)).forEach((t,n)=>{let r=Array.isArray(e)?e[n].tensor:e[t];if(r==null)return;let a=V.registeredVariables[t];K(()=>{let i=ne(G(this.c,r),a);a.assign(i)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=wn(Ae(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,t){return new e(t.learningRate)}},tE=class extends Ux{static get className(){return"Momentum"}constructor(e,t,n=!1){super(e),this.learningRate=e,this.momentum=t,this.useNesterov=n,this.accumulations=[],this.m=Ae(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(t=>t.name):Object.keys(e)).forEach((t,n)=>{let r=V.registeredVariables[t];this.accumulations[n]==null&&(this.accumulations[n]={originalName:"".concat(t,"/momentum"),variable:K(()=>nt(r).variable(!1))});let a=this.accumulations[n].variable,i=Array.isArray(e)?e[n].tensor:e[t];i!=null&&K(()=>{let s,o=ne(G(this.m,a),i);this.useNesterov?s=ne(G(this.c,ne(i,G(o,this.m))),r):s=ne(G(this.c,o),r),a.assign(o),r.assign(s)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&We(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);let t=!1;this.accumulations=e.map(n=>({originalName:n.name,variable:n.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}},nE=class extends Hs{static get className(){return"RMSProp"}constructor(e,t=.9,n=0,r=null,a=!1){if(super(),this.learningRate=e,this.decay=t,this.momentum=n,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=a,r==null&&(this.epsilon=V.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(t=>t.name):Object.keys(e)).forEach((t,n)=>{let r=V.registeredVariables[t],a=!1;this.accumulatedMeanSquares[n]==null&&(this.accumulatedMeanSquares[n]={originalName:"".concat(t,"/rms"),variable:K(()=>nt(r).variable(a))}),this.accumulatedMoments[n]==null&&(this.accumulatedMoments[n]={originalName:"".concat(t,"/momentum"),variable:K(()=>nt(r).variable(a))}),this.accumulatedMeanGrads[n]==null&&this.centered&&(this.accumulatedMeanGrads[n]={originalName:"".concat(t,"/mg"),variable:K(()=>nt(r).variable(a))});let i=Array.isArray(e)?e[n].tensor:e[t];if(i==null)return;let s=this.accumulatedMeanSquares[n].variable,o=this.accumulatedMoments[n].variable;K(()=>{let l=ne(G(s,this.decay),G(vt(i),1-this.decay));if(this.centered){let c=this.accumulatedMeanGrads[n].variable,u=ne(G(c,this.decay),G(i,1-this.decay)),d=ke(G(i,this.learningRate),Kn(xe(l,ne(vt(u),this.epsilon)))),p=ne(G(o,this.momentum),d);s.assign(l),c.assign(u),o.assign(p);let h=xe(r,p);r.assign(h)}else{let c=ne(G(s,this.decay),G(vt(i),1-this.decay)),u=ne(G(o,this.momentum),ke(G(i,this.learningRate),Kn(ne(c,this.epsilon))));s.assign(c),o.assign(u);let d=xe(r,u);r.assign(d)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&We(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&We(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&We(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){let e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);let t=this.centered?e.length/3:e.length/2,n=!1;this.accumulatedMeanSquares=e.slice(0,t).map(r=>({originalName:r.name,variable:r.tensor.variable(n)})),this.accumulatedMoments=e.slice(t,t*2).map(r=>({originalName:r.name,variable:r.tensor.variable(n)})),this.centered&&(this.accumulatedMeanGrads=e.slice(t*2,t*3).map(r=>({originalName:r.name,variable:r.tensor.variable(n)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}},zae=[ZC,QC,JC,eE,tE,nE,Ux];function Bae(){for(let e of zae)j3(e)}var Gn={};Ue(Gn,{CompositeArrayBuffer:()=>ss,browserFiles:()=>qae,browserHTTPRequest:()=>Qae,concatenateArrayBuffers:()=>bQ,copyModel:()=>BQ,decodeWeights:()=>gP,encodeWeights:()=>fQ,fromMemory:()=>eie,fromMemorySync:()=>Y3,getLoadHandlers:()=>CQ,getModelArtifactsForJSON:()=>V$,getModelArtifactsForJSONSync:()=>bP,getModelArtifactsInfoForJSON:()=>Eg,getSaveHandlers:()=>$Q,getWeightSpecs:()=>vP,http:()=>aE,isHTTPScheme:()=>oS,listModels:()=>PQ,loadWeights:()=>Kae,moveModel:()=>WQ,registerLoadRouter:()=>IQ,registerSaveRouter:()=>SQ,removeModel:()=>zQ,weightsLoaderFactory:()=>q3,withSaveHandler:()=>tie,withSaveHandlerSync:()=>nie});var Wae="model",Uae=".json",Vae=".weights.bin";function tR(e){return new Promise(t=>setTimeout(t)).then(e)}var hp=class{constructor(e){if(!Z().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(hp.URL_SCHEME)&&(e=e.slice(hp.URL_SCHEME.length)),(e==null||e.length===0)&&(e=Wae),this.modelJsonFileName=e+Uae,this.weightDataFileName=e+Vae}async save(e){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");let t=ss.join(e.weightData),n=window.URL.createObjectURL(new Blob([t],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{let r=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],a=yP(e,r),i=window.URL.createObjectURL(new Blob([JSON.stringify(a)],{type:"application/json"})),s=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(s.download=this.modelJsonFileName,s.href=i,await tR(()=>s.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){let o=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;o.download=this.weightDataFileName,o.href=n,await tR(()=>o.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:Eg(e)}}}};hp.URL_SCHEME="downloads://";var Hae=class{constructor(e){if(e==null||e.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received ".concat(e));this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,t)=>{let n=new FileReader;n.onload=r=>{let a=JSON.parse(r.target.result),i=a.modelTopology;if(i==null){t(new Error("modelTopology field is missing from file ".concat(this.jsonFile.name)));return}if(a.weightsManifest==null){t(new Error("weightManifest field is missing from file ".concat(this.jsonFile.name)));return}if(this.weightsFiles.length===0){e({modelTopology:i});return}let s=V$(a,o=>this.loadWeights(o));e(s)},n.onerror=r=>t("Failed to read model topology and weights manifest JSON from file '".concat(this.jsonFile.name,"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")),n.readAsText(this.jsonFile)})}loadWeights(e){let t=[],n=[];for(let i of e)t.push(...i.weights),n.push(...i.paths);let r=this.checkManifestAndWeightFiles(e),a=n.map(i=>this.loadWeightsFile(i,r[i]));return Promise.all(a).then(i=>[t,i])}loadWeightsFile(e,t){return new Promise((n,r)=>{let a=new FileReader;a.onload=i=>{let s=i.target.result;n(s)},a.onerror=i=>r("Failed to weights data from file of path '".concat(e,"'.")),a.readAsArrayBuffer(t)})}checkManifestAndWeightFiles(e){let t=[],n=this.weightsFiles.map(a=>QA(a.name)),r={};for(let a of e)a.paths.forEach(i=>{let s=QA(i);if(t.indexOf(s)!==-1)throw new Error("Duplicate file basename found in weights manifest: '".concat(s,"'"));if(t.push(s),n.indexOf(s)===-1)throw new Error("Weight file with basename '".concat(s,"' is not provided."));r[i]=this.weightsFiles[n.indexOf(s)]});if(t.length!==this.weightsFiles.length)throw new Error("Mismatch in the number of files in weights manifest (".concat(t.length,") and the number of weight files provided (").concat(this.weightsFiles.length,")."));return r}},jae=e=>Z().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(hp.URL_SCHEME)?Gae(e.slice(hp.URL_SCHEME.length)):null;Yt.registerSaveRouter(jae);function Gae(e="model"){return new hp(e)}function qae(e){return new Hae(e)}function nR(e,t,n,r){s(e),n=n==null?0:n,r=r==null?1:r,o(n,r);let a=0,i=l=>(l.then(c=>{let u=n+ ++a/e.length*(r-n);return t(u),c}),l);function s(l){M(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function o(l,c){M(l>=0&&l<=1,()=>"Progress fraction must be in range [0, 1], but got startFraction ".concat(l)),M(c>=0&&c<=1,()=>"Progress fraction must be in range [0, 1], but got endFraction ".concat(c)),M(c>=l,()=>"startFraction must be no more than endFraction, but got startFraction ".concat(l," and endFraction ").concat(c))}return Promise.all(e.map(i))}async function G3(e,t){t==null&&(t={});let n=t.fetchFunc==null?Z().platform.fetch:t.fetchFunc,r=e.map(c=>n(c,t.requestInit,{isBinary:!0})),a=0,i=.5,s=(t.onProgress==null?await Promise.all(r):await nR(r,t.onProgress,a,i)).map(c=>c.arrayBuffer()),o=.5,l=1;return t.onProgress==null?await Promise.all(s):await nR(s,t.onProgress,o,l)}async function Kae(e,t="",n,r){return q3(a=>G3(a,{requestInit:r}))(e,t,n)}function q3(e){return async(t,n="",r)=>{let a=t.map(()=>!1),i={},s=r!=null?r.map(()=>!1):[],o=[];if(t.forEach((h,f)=>{let m=0;h.weights.forEach(g=>{let y="quantization"in g?g.quantization.dtype:g.dtype,b=tS[y]*Nt(g.shape),v=()=>{a[f]=!0,i[f]==null&&(i[f]=[]),i[f].push({manifestEntry:g,groupOffset:m,sizeBytes:b})};r!=null?r.forEach((x,w)=>{x===g.name&&(v(),s[w]=!0)}):v(),o.push(g.name),m+=b})}),!s.every(h=>h)){let h=r.filter((f,m)=>!s[m]);throw new Error("Could not find weights in manifest with names: ".concat(h.join(", "),". \nManifest JSON has weights with names: ").concat(o.join(", "),"."))}let l=a.reduce((h,f,m)=>(f&&h.push(m),h),[]),c=[];l.forEach(h=>{t[h].paths.forEach(f=>{let m=n+(n.endsWith("/")?"":"/")+f;c.push(m)})});let u=await e(c),d={},p=0;return l.forEach(h=>{let f=t[h].paths.length,m=new ss(u.slice(p,p+f));i[h].forEach(g=>{let y=m.slice(g.groupOffset,g.groupOffset+g.sizeBytes),b=gP(y,[g.manifestEntry]);for(let v in b)d[v]=b[v]}),p+=f}),d}}var Xae="application/octet-stream",Yae="application/json",rE=class{constructor(e,t){if(this.DEFAULT_METHOD="POST",t==null&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.onProgress=t.onProgress,this.weightUrlConverter=t.weightUrlConverter,t.fetchFunc!=null?(M(typeof t.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=t.fetchFunc):this.fetch=Z().platform.fetch,M(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&M(e.length===2,()=>"URL paths for http must have a length of 2, (actual length is ".concat(e.length,").")),this.path=e,t.requestInit!=null&&t.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{}}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");let t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;let n=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],r=yP(e,n);if(t.body.append("model.json",new Blob([JSON.stringify(r)],{type:Yae}),"model.json"),e.weightData!=null){let i=ss.join(e.weightData);t.body.append("model.weights.bin",new Blob([i],{type:Xae}),"model.weights.bin")}let a=await this.fetch(this.path,t);if(a.ok)return{modelArtifactsInfo:Eg(e),responses:[a]};throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status ".concat(a.status,"."))}async load(){let e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error("Request to ".concat(this.path," failed with status code ").concat(e.status,". Please verify this URL points to the model JSON of the model to load."));let t;try{t=await e.json()}catch(a){let i="Failed to parse model JSON of response from ".concat(this.path,".");throw this.path.endsWith(".pb")?i+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":i+=" Please make sure the server is serving valid JSON for this request.",new Error(i)}let n=t.modelTopology,r=t.weightsManifest;if(n==null&&r==null)throw new Error("The JSON from HTTP path ".concat(this.path," contains neither model topology or manifest for weights."));return V$(t,a=>this.loadWeights(a))}async loadWeights(e){let t=Array.isArray(this.path)?this.path[1]:this.path,[n,r]=Zae(t),a=this.weightPathPrefix||n,i=vP(e),s=[],o=[];for(let c of e)for(let u of c.paths)this.weightUrlConverter!=null?o.push(this.weightUrlConverter(u)):s.push(a+u+r);this.weightUrlConverter&&s.push(...await Promise.all(o));let l=await G3(s,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});return[i,l]}};rE.URL_SCHEME_REGEX=/^https?:\/\//;function Zae(e){let t=e.lastIndexOf("/"),n=e.lastIndexOf("?"),r=e.substring(0,t),a=n>t?e.substring(n):"";return[r+"/",a]}function oS(e){return e.match(rE.URL_SCHEME_REGEX)!=null}var K3=(e,t)=>{if(typeof fetch>"u"&&(t==null||t.fetchFunc==null))return null;{let n=!0;if(Array.isArray(e)?n=e.every(r=>oS(r)):n=oS(e),n)return aE(e,t)}return null};Yt.registerSaveRouter(K3);Yt.registerLoadRouter(K3);function aE(e,t){return new rE(e,t)}function Qae(e,t){return aE(e,t)}var b1=class{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}},X3=class{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}},Jae=class{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=t=>Promise.resolve(e.save(t)))}};function eie(e,t,n,r){let a=arguments;return new Jae(Y3(...a))}function Y3(e,t,n,r){return arguments.length===1?e.modelTopology!=null||e.weightSpecs!=null?new b1(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new b1({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new b1({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r}))}function tie(e){return new X3(e)}function nie(e){return new X3(e)}var Z3={};Ue(Z3,{confusionMatrix:()=>aie});function rie(e,t,n){let r=A(e,"labels","confusionMatrix"),a=A(t,"predictions","confusionMatrix");M(n==null||n>0&&Number.isInteger(n),()=>"If provided, numClasses must be a positive integer, but got ".concat(n)),M(r.rank===1,()=>"Expected the rank of labels to be 1, but got ".concat(r.rank)),M(a.rank===1,()=>"Expected the rank of predictions to be 1, but got ".concat(a.rank)),M(r.shape[0]===a.shape[0],()=>"Mismatch in the number of examples: ".concat(r.shape[0]," vs. ").concat(a.shape[0],". Labels and predictions should have the same number of elements.")),M(n>0&&Number.isInteger(n),()=>"numClasses is required to be a positive integer, but got ".concat(n));let i=lp(de(r,"int32"),n),s=lp(de(a,"int32"),n),o=Ye(i),l=Ke(o,s);return de(l,"int32")}var aie=H({confusionMatrix_:rie}),Wg={};Ue(Wg,{draw:()=>pie,fromPixels:()=>hie,fromPixelsAsync:()=>uie,toPixels:()=>die});var pl,rR=!1;function Q3(e,t=3){if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(e==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,r=!1,a=!1,i=!1,s=!1,o=!1;if(e.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&e instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement)a=!0;else if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement)i=!0;else if(e.getContext!=null)s=!0;else if(typeof ImageBitmap<"u"&&e instanceof ImageBitmap)o=!0;else throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ".concat(e.constructor.name));if(wv(xv,V.backendName)!=null){let p={pixels:e},h={numChannels:t};return V.runKernel(xv,p,h)}let[l,c]=a?[e.videoWidth,e.videoHeight]:[e.width,e.height],u;if(s)u=e.getContext("2d").getImageData(0,0,l,c).data;else if(r||n)u=e.data;else if(i||a||o){if(pl==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")pl=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else pl=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});pl.canvas.width=l,pl.canvas.height=c,pl.drawImage(e,0,0,l,c),u=pl.getImageData(0,0,l,c).data}let d;if(t===4)d=new Int32Array(u);else{let p=l*c;d=new Int32Array(p*t);for(let h=0;h<p;h++)for(let f=0;f<t;++f)d[h*t+f]=u[h*4+f]}return Rx(d,[c,l,t],"int32")}function iie(e){return e!=null&&e.data instanceof Uint8Array}function sie(){return typeof window<"u"&&typeof ImageBitmap<"u"&&window.hasOwnProperty("createImageBitmap")}function oie(e){return e!=null&&e.width!==0&&e.height!==0}function lie(e){return sie()&&!(e instanceof ImageBitmap)&&oie(e)&&!iie(e)}async function uie(e,t=3){let n=null;if(Z().getBool("WRAP_TO_IMAGEBITMAP")&&lie(e)){let r;try{r=await createImageBitmap(e,{premultiplyAlpha:"none"})}catch(a){r=null}r!=null&&r.width===e.width&&r.height===e.height?n=r:n=e}else n=e;return Q3(n,t)}function J3(e){if(e.rank!==2&&e.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank ".concat(e.rank,"."));let t=e.rank===2?1:e.shape[2];if(t>4||t===2)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got ".concat(t));if(e.dtype!=="float32"&&e.dtype!=="int32")throw new Error("Unsupported type for toPixels: ".concat(e.dtype,". Please use float32 or int32 tensors."))}function cie(e){let t=(e==null?void 0:e.alpha)||1;if(t>1||t<0)throw new Error("Alpha value ".concat(t," is suppoed to be in range [0 - 1]."))}async function die(e,t){let n=A(e,"img","toPixels");if(!(e instanceof He)){let c=n;n=de(c,"int32"),c.dispose()}J3(n);let[r,a]=n.shape.slice(0,2),i=n.rank===2?1:n.shape[2],s=await n.data(),o=n.dtype==="float32"?255:1,l=new Uint8ClampedArray(a*r*4);for(let c=0;c<r*a;++c){let u=[0,0,0,255];for(let p=0;p<i;p++){let h=s[c*i+p];if(n.dtype==="float32"){if(h<0||h>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ".concat(h,"."))}else if(n.dtype==="int32"&&(h<0||h>255))throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ".concat(h,"."));i===1?(u[0]=h*o,u[1]=h*o,u[2]=h*o):u[p]=h*o}let d=c*4;l[d+0]=Math.round(u[0]),l[d+1]=Math.round(u[1]),l[d+2]=Math.round(u[2]),l[d+3]=Math.round(u[3])}if(t!=null){rR||(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),rR=!0),t.width=a,t.height=r;let c=t.getContext("2d"),u=new ImageData(l,a,r);c.putImageData(u,0,0)}return n!==e&&n.dispose(),l}function pie(e,t,n){let r=A(e,"img","draw");if(!(e instanceof He)){let s=r;r=de(s,"int32"),s.dispose()}J3(r),cie(n==null?void 0:n.imageOptions);let a={image:r},i={canvas:t,options:n};V.runKernel(P$,a,i)}var hie=H({fromPixels_:Q3}),iE={};Ue(iE,{prepareAndValidate:()=>ez});function ez(e,t){let n=e.shape.length,r=t.shape.length;if(n<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was ".concat(n,"."));if(r<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ".concat(r,"."));if(t.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was ".concat(t.dtype,"."));if(t.shape[r-1]>n)throw new Error("index innermost dimension length must be <= tensor rank; saw: ".concat(t.shape[r-1]," vs. ").concat(n));if(Nt(e.shape)===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: ".concat(e.shape,"."));let a=t.shape,i=a[a.length-1],s=1;for(let d=0;d<a.length-1;++d)s*=a[d];let o=e.shape,l=a.slice();l.pop();let c=1;for(let d=i;d<n;++d)c*=o[d],l.push(o[d]);let u=[...Ap(e.shape).map(d=>d/c),1].slice(0,i);return[l,s,c,u]}var In={};Ue(In,{assertParamsValid:()=>mie,computeFlatOffset:()=>xie,computeOutShape:()=>yie,getNormalizedAxes:()=>bie,isSliceContinous:()=>vie,maskToAxes:()=>gie,parseSliceParams:()=>uz,sliceInfo:()=>wie,startForAxis:()=>oz,startIndicesWithElidedDims:()=>az,stopForAxis:()=>lz,stopIndicesWithElidedDims:()=>iz,stridesForAxis:()=>sz,stridesWithElidedDims:()=>tz});var lS=-2,fie=-1;function mie(e,t,n){let r=e.shape.length;M(r===t.length,()=>"Error in slice".concat(r,"D: Length of begin ").concat(t," must match the rank of the array (").concat(r,").")),M(r===n.length,()=>"Error in slice".concat(r,"D: Length of size ").concat(n," must match the rank of the array (").concat(r,")."));for(let a=0;a<r;++a)M(t[a]+n[a]<=e.shape[a],()=>"Error in slice".concat(r,"D: begin[").concat(a,"] + size[").concat(a,"] (").concat(t[a]+n[a],") would overflow input.shape[").concat(a,"] (").concat(e.shape[a],")"))}function gie(e){let t=[],n=0;for(;e>0;)e&1&&t.push(n),e/=2,n++;return t}function yie(e,t,n){let r=[];for(let a=0;a<e.length;a++)r[a]=Math.ceil((t[a]-e[a])/n[a]);return r}function tz(e,t,n,r){let a=[...e];for(let i=a.length;i<r.length;i++)a.push(1);for(let i=0;i<n;i++)i===0?a[t]=1:(a.splice(t,0,1),a.pop());return a}function nz(e,t,n){return n<=e?n:n-(t-1)}function rz(e,t){let n=[];for(let r=0;r<e;r++)n.push(t+r);return n}function bie(e,t,n,r,a,i,s,o,l){let c=e.length,u=new Array(c),d=new Array(c),p=new Array(c);if(t.length&&n>0){let h=t[0],f=n+1;u=az(s,h,f,r,e),d=iz(o,h,f,a,e),p=tz(i,h,f,e)}else for(let h=0;h<c;h++)u[h]=oz(s,r,i,e,h,l),d[h]=lz(o,a,i,e,h,l),p[h]=sz(i,h,l);return{begin:u,end:d,strides:p}}function az(e,t,n,r,a){let i=[...a],s=rz(n,t);for(let o=0;o<i.length;o++)if(s.indexOf(o)>-1)i[o]=0;else{let l=nz(t,n,o),c=r[l];e&1<<l&&(c=0),i[o]=c}return i}function iz(e,t,n,r,a){let i=[...a],s=rz(n,t);for(let o=0;o<i.length;o++)if(s.indexOf(o)>-1)i[o]=Number.MAX_SAFE_INTEGER;else{let l=nz(t,n,o),c=r[l];e&1<<l&&(c=Number.MAX_SAFE_INTEGER),i[o]=c}for(let o=0;o<i.length;o++){let l=a[o];i[o]<0&&(i[o]+=l),i[o]=wm(0,i[o],a[o])}return i}function sz(e,t,n){let r=e[t];return(n&1<<t||r==null)&&(r=1),r}function oz(e,t,n,r,a,i){let s=t[a],o=n[a]||1;(e&1<<a||i&1<<a||s==null)&&(o>0?s=Number.MIN_SAFE_INTEGER:s=Number.MAX_SAFE_INTEGER);let l=r[a];return s<0&&(s+=l),s=wm(0,s,l-1),s}function lz(e,t,n,r,a,i){let s=t[a],o=n[a]||1;(e&1<<a||i&1<<a||s==null)&&(o>0?s=Number.MAX_SAFE_INTEGER:s=Number.MIN_SAFE_INTEGER);let l=r[a];return s<0&&(s+=l),o>0?s=wm(0,s,l):s=wm(-1,s,l-1),s}function vie(e,t,n){let r=n.length;for(let a=0;a<n.length;a++)if(n[a]>1){r=a;break}for(let a=r+1;a<n.length;a++)if(t[a]>0||n[a]!==e[a])return!1;return!0}function xie(e,t){let n=e.length>0?e[e.length-1]:1;for(let r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function uz(e,t,n){let r,a=e.shape.length;typeof t=="number"?r=[t,...new Array(a-1).fill(0)]:t.length<a?r=t.concat(new Array(a-t.length).fill(0)):r=t.slice(),r.forEach(s=>{M(s!==-1,()=>"slice() does not support negative begin indexing.")});let i;return n==null?i=new Array(a).fill(-1):typeof n=="number"?i=[n,...new Array(a-1).fill(-1)]:n.length<a?i=n.concat(new Array(a-n.length).fill(-1)):i=n,i=i.map((s,o)=>s>=0?s:(M(s===-1,()=>"Negative size values should be exactly -1 but got ".concat(s," for the slice() size at index ").concat(o,".")),e.shape[o]-r[o])),[r,i]}function wie(e,t,n,r,a,i,s,o,l){let c;if(r==null?(c=new Array(t.length),c.fill(1)):c=r,s!=null&&s&s-1)throw new Error("Multiple ellipses in slice is not allowed.");let u=!1,d={dims:c.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:n.slice(),strides:c.slice(),beginMask:a,endMask:i,ellipsisMask:s,newAxisMask:o,shrinkAxisMask:l};for(let b=0;b<d.dims;b++)u&&1<<b&o&&d.numAddAxisAfterEllipsis++,1<<b&s&&(u=!0);u||(d.ellipsisMask|=1<<d.dims,d.dims++);let p={dims:e.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};kie(d,p);let h=!0,f=!0,m=!0,g=[],y=[];for(let b=0;b<e.length;++b){if(p.strides[b]===0)throw Error("strides[".concat(b,"] must be non-zero"));let v=!!(p.shrinkAxisMask&1<<b),x=e[b];if(x===-1){g.push(v?1:-1);continue}let w=[p.beginMask&1<<b,p.endMask&1<<b],$=[p.strides[b]>0?0:-1,p.strides[b]>0?x:x-1];if(v&&p.strides[b]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&p.strides[b]===1;let C=!!(p.beginMask&1<<b&&p.endMask&1<<b);if(p.beginValid&&p.endValid){if(v){let N=p.begin[b]<0?x+p.begin[b]:p.begin[b];if(p.begin[b]=N,p.end[b]=p.begin[b]+1,N<0||N>=x)throw Error("slice index ".concat(p.begin[b]," of dimension ").concat(b," out of bounds."))}else p.begin[b]=aR(p.begin[b],0,p.strides[b],x,w,$),p.end[b]=aR(p.end[b],1,p.strides[b],x,w,$);let R=p.strides[b]===1&&p.begin[b]===0&&p.end[b]===x;h=h&&R,f=f&&(b===0&&p.strides[b]===1||R)}else h=h&&p.strides[b]===1&&C,f=f&&(b===0&&p.strides[b]===1||C);let E,_=!1;if(p.beginValid&&p.endValid?(E=p.end[b]-p.begin[b],_=!0):v?(E=1,_=!0):C&&x>=0&&(p.strides[b]<0?E=-x:E=x,_=!0),_){let R;E===0||E<0!=p.strides[b]<0?R=0:R=Math.trunc(E/p.strides[b])+(E%p.strides[b]!==0?1:0),g.push(R)}else g.push(-1)}for(let b=0;b<p.finalShapeGatherIndices.length;++b){let v=p.finalShapeGatherIndices[b];v>=0?y.push(g[v]):v===lS&&y.push(1)}return{finalShapeSparse:y.filter((b,v)=>p.finalShapeGatherIndices[v]!==lS),finalShape:y,isIdentity:h,sliceDim0:f,isSimpleSlice:m,begin:p.begin,end:p.end,strides:p.strides}}function kie(e,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;let n=0;t.beginValid=e.begin!=null,t.endValid=e.end!=null,t.begin=new Array(t.dims),t.end=new Array(t.dims),t.strides=new Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=new Array(t.dims);for(let r=0;r<e.dims;r++)if(1<<r&e.ellipsisMask){let a=Math.min(t.dims-(e.dims-r)+1+e.numAddAxisAfterEllipsis,t.dims);for(;n<a;n++)t.begin[n]=0,t.end[n]=0,t.strides[n]=1,t.beginMask|=1<<n,t.endMask|=1<<n,t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&e.newAxisMask)t.finalShapeGatherIndices.push(lS),t.finalShapeGatherIndicesSparse.push(-1);else{if(n===t.begin.length)throw Error("Index out of range using input dim ".concat(n,"; input has only ").concat(t.dims," dims, ").concat(t.begin.length,"."));e.begin!=null&&(t.begin[n]=e.begin[r]),e.end!=null&&(t.end[n]=e.end[r]),t.strides[n]=e.strides[r],e.beginMask&1<<r&&(t.beginMask|=1<<n),e.endMask&1<<r&&(t.endMask|=1<<n),e.shrinkAxisMask&1<<r?(t.finalShapeGatherIndices.push(fie),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<n):(t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(r)),t.inputShapeGatherIndicesSparse[n]=r,n++}}function aR(e,t,n,r,a,i){if(a[t])return n>0?i[t]:i[t+1&1];{let s=e<0?r+e:e;return s<i[0]?i[0]:s>i[1]?i[1]:s}}var Sie="4.7.0",cz=class{static sgd(e){return new Ux(e)}static momentum(e,t,n=!1){return new tE(e,t,n)}static rmsprop(e,t=.9,n=0,r=null,a=!1){return new nE(e,t,n,r,a)}static adam(e=.001,t=.9,n=.999,r=null){return new JC(e,t,n,r)}static adadelta(e=.001,t=.95,n=null){return new ZC(e,t,n)}static adamax(e=.002,t=.9,n=.999,r=null,a=0){return new eE(e,t,n,r,a)}static adagrad(e,t=.1){return new QC(e,t)}},bl=cz,Iie=(()=>typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:e=>e())();function sE(){return new Promise(e=>Iie(()=>e()))}var T={};Ue(T,{ERF_A1:()=>zie,ERF_A2:()=>Bie,ERF_A3:()=>Wie,ERF_A4:()=>Uie,ERF_A5:()=>Vie,ERF_P:()=>Pie,PARALLELIZE_THRESHOLD:()=>oE,RowPartitionType:()=>qi,SELU_SCALE:()=>pz,SELU_SCALEALPHA:()=>dz,applyActivation:()=>Bx,assertAndGetBroadcastShape:()=>kt,assertAxesAreInnerMostDims:()=>Cee,assertParamsConsistent:()=>$ie,assignToTypedArray:()=>Xie,axesAreInnerMostDims:()=>bC,calculateShapes:()=>x3,checkEinsumDimSizes:()=>tse,checkPadOnDimRoundingMode:()=>Rr,combineLocations:()=>WP,combineRaggedTensorToTensorShapes:()=>Eie,complexWithEvenIndex:()=>Gie,complexWithOddIndex:()=>qie,computeConv2DInfo:()=>Tg,computeConv3DInfo:()=>AP,computeDefaultPad:()=>J$,computeDilation2DInfo:()=>IJ,computeOptimalWindowSize:()=>Aie,computeOutAndReduceShapes:()=>UP,computeOutShape:()=>Cie,computePool2DInfo:()=>_P,computePool3DInfo:()=>$J,convertConv2DDataFormat:()=>RP,decodeEinsumEquation:()=>Jie,eitherStridesOrDilationsAreOne:()=>os,expandShapeToKeepDim:()=>iu,exponent:()=>Zie,exponents:()=>Yie,fromStringArrayToUint8:()=>kse,fromUint8ToStringArray:()=>wse,getAxesPermutation:()=>VP,getBroadcastDims:()=>PP,getComplexWithIndex:()=>Kie,getEinsumComputePath:()=>nse,getEinsumPermutation:()=>ese,getFusedBiasGradient:()=>zx,getFusedDyActivation:()=>Px,getImageCenter:()=>Rie,getInnerMostAxes:()=>Eee,getPermuted:()=>Fie,getRaggedRank:()=>Nie,getReductionAxes:()=>fn,getReshaped:()=>Die,getReshapedPermuted:()=>Mie,getRowPartitionTypesHelper:()=>Tie,getSliceBeginCoords:()=>Oie,getSliceSize:()=>Lie,getSparseFillEmptyRowsIndicesDenseShapeMismatch:()=>sse,getSparseFillEmptyRowsNegativeIndexErrorMessage:()=>ose,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:()=>lse,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:()=>dse,getSparseReshapeInputOutputMismatchErrorMessage:()=>hse,getSparseReshapeInputOutputMultipleErrorMessage:()=>pse,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:()=>use,getSparseReshapeNegativeOutputDimErrorMessage:()=>cse,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:()=>yse,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:()=>fse,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:()=>mse,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:()=>gse,getUndoAxesPermutation:()=>vC,isIdentityPermutation:()=>rse,log:()=>LZ,mergeRealAndImagArrays:()=>Hie,prepareAndValidate:()=>ez,prepareSplitSize:()=>ise,segment_util:()=>hz,shouldFuse:()=>Wx,slice_util:()=>In,splitRealAndImagArrays:()=>jie,stridesOrDilationsArePositive:()=>ru,tupleValuesAreOne:()=>Ro,upcastType:()=>Ra,validateDefaultValueShape:()=>_ie,validateInput:()=>Fx,validateUpdateShape:()=>WC,warn:()=>ao});function $ie(e,t){let n=e[0].length;e.forEach((a,i)=>{M(a.length===n,()=>"Error in concat".concat(n,"D: rank of tensors[").concat(i,"] must be the same as the rank of the rest (").concat(n,")"))}),M(t>=0&&t<n,()=>"Error in concat".concat(n,"D: axis must be between 0 and ").concat(n-1,"."));let r=e[0];e.forEach((a,i)=>{for(let s=0;s<n;s++)M(s===t||a[s]===r[s],()=>"Error in concat".concat(n,"D: Shape of tensors[").concat(i,"] (").concat(a,") does not match the shape of the rest (").concat(r,") along the non-concatenated axis ").concat(i,"."))})}function Cie(e,t){let n=e[0].slice();for(let r=1;r<e.length;r++)n[t]+=e[r][t];return n}var qi;(function(e){e[e.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",e[e.VALUE_ROWIDS=1]="VALUE_ROWIDS",e[e.ROW_LENGTHS=2]="ROW_LENGTHS",e[e.ROW_SPLITS=3]="ROW_SPLITS",e[e.ROW_LIMITS=4]="ROW_LIMITS",e[e.ROW_STARTS=5]="ROW_STARTS"})(qi||(qi={}));function Eie(e,t,n){let r=new Array;if(n==null&&t==null)return r;if(t==null)for(;r.length<e+n.length;)r.push(-1);else r=t.slice();if(n==null)return r;if(e+n.length!==r.length)throw new Error("rt input.shape and shape=".concat(t," are incompatible: rt input.rank = ").concat(e+n.length,", but shape.rank = ").concat(r.length));for(let a=1;a<n.length;++a){let i=n[a],s=r[r.length-n.length+a],o=r[s];if(i>=0)if(o>=0){if(o!==i)throw new Error("rt input.shape and shape=".concat(t," are incompatible: rt input.shape[").concat(a+e,"] = ").concat(i," but shape[").concat(a+e,"] = ").concat(o))}else r[s]=i}return r}function Tie(e){let t={FIRST_DIM_SIZE:qi.FIRST_DIM_SIZE,VALUE_ROWIDS:qi.VALUE_ROWIDS,ROW_LENGTHS:qi.ROW_LENGTHS,ROW_SPLITS:qi.ROW_SPLITS,ROW_LIMITS:qi.ROW_LIMITS,ROW_STARTS:qi.ROW_STARTS},n=[];for(let r of e)if(r in t)n.push(t[r]);else break;return n}function Nie(e){return e.length===0?0:e[0]===qi.FIRST_DIM_SIZE?e.length-1:e.length}function _ie(e,t){if(e==null||t==null)return;let n=e.length,r=t.length;if(n>=r)throw new Error("defaultValue.shape=".concat(e," and ragged tensor flatValues.shape=").concat(t,", are incompatible: defaultValue.rank = ").concat(n," must be less than ragged tensor input flatValues.rank = ").concat(r,")"));for(let a=0;a<Math.min(n,r-1);++a){let i=e[a],s=t[a+1];if(i>=0&&s>=0&&i!==1&&i!==s)throw new Error("defaultValue.shape=".concat(e,", and ragged tensor input flatValues.shape=").concat(t," are incompatible: defaultValue.shape[").concat(a-e.length,"] = ").concat(i," but ragged tensor input.flatValues.shape[").concat(a-e.length,"] = ").concat(s))}}var oE=30;function Aie(e){return e<=oE?e:vv(e,Math.floor(Math.sqrt(e)))}function Rie(e,t,n){let r=n*(typeof e=="number"?e:e[0]),a=t*(typeof e=="number"?e:e[1]);return[r,a]}function Die(e,t,n,r=!0){let a=[];if(r)a=a.concat(t.slice(0)),a.push(e[0]/n),a=a.concat(e.slice(1));else{a=a.concat(e[0]);let i=t.length;for(let s=0;s<i;++s)a=a.concat([e[s+1]/t[s],t[s]]);a=a.concat(e.slice(i+1))}return a}function Fie(e,t,n=!0){let r=[];if(n){r.push(t);for(let a=t+1;a<e;++a)a<=2*t?(r.push(a),r.push(a-(t+1))):r.push(a)}else{let a=[],i=[];for(let s=1;s<e;++s)s>=t*2+1||s%2===1?i.push(s):a.push(s);r.push(...a),r.push(0),r.push(...i)}return r}function Mie(e,t,n,r=!0){let a=[];r?a.push(e[0]/n):a.push(e[0]*n);for(let i=1;i<e.length;++i)i<=t.length?r?a.push(t[i-1]*e[i]):a.push(e[i]/t[i-1]):a.push(e[i]);return a}function Oie(e,t){let n=[0];for(let r=0;r<t;++r)n.push(e[r][0]);return n}function Lie(e,t,n){let r=e.slice(0,1);for(let a=0;a<n;++a)r.push(e[a+1]-t[a][0]-t[a][1]);return r}var dz=1.7580993408473768,pz=1.0507009873554805,Pie=.3275911,zie=.254829592,Bie=-.284496736,Wie=1.421413741,Uie=-1.453152027,Vie=1.061405429;function Hie(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:".concat(e.length,", imag: ").concat(t.length,"."));let n=new Float32Array(e.length*2);for(let r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function jie(e){let t=new Float32Array(e.length/2),n=new Float32Array(e.length/2);for(let r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}function Gie(e){let t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let a=0;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}function qie(e){let t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let a=2;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}function Kie(e,t){let n=e[t*2],r=e[t*2+1];return{real:n,imag:r}}function Xie(e,t,n,r){e[r*2]=t,e[r*2+1]=n}function Yie(e,t){let n=new Float32Array(e/2),r=new Float32Array(e/2);for(let a=0;a<Math.ceil(e/2);a++){let i=(t?2:-2)*Math.PI*(a/e);n[a]=Math.cos(i),r[a]=Math.sin(i)}return{real:n,imag:r}}function Zie(e,t,n){let r=(n?2:-2)*Math.PI*(e/t),a=Math.cos(r),i=Math.sin(r);return{real:a,imag:i}}var v1="->",Qie=/->/g,iR=",",sR="...";function Jie(e,t){e=e.replace(/\s/g,"");let n=(e.length-e.replace(Qie,"").length)/v1.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error('Equation must contain exactly one arrow ("'.concat(v1,'").'));let[r,a]=e.split(v1);M(r.indexOf(sR)===-1,()=>'The ellipsis notation ("'.concat(sR,'") is not supported yet.'));let i=r.split(iR),s=i.length;if(t!==s)throw new Error("Expected ".concat(s," input tensors, received ").concat(t));if(s>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");let o=[];for(let p=0;p<a.length;++p){let h=a[p];if(!i.some(f=>f.indexOf(h)!==-1))throw new Error("Output subscripts contain the label ".concat(h," not present in the input subscripts."));o.indexOf(h)===-1&&o.push(h)}for(let p=0;p<r.length;++p){let h=r[p];o.indexOf(h)===-1&&h!==iR&&o.push(h)}let l=new Array(i.length);for(let p=0;p<s;++p){if(new Set(i[p].split("")).size!==i[p].length)throw new Error("Found duplicate axes in input component ".concat(i[p],". Support for duplicate axes in input is not implemented yet."));l[p]=[];for(let h=0;h<i[p].length;++h)l[p].push(o.indexOf(i[p][h]))}let c=o.length,u=a.length,d=[];for(let p=u;p<c;++p)d.push(p);return{allDims:o,summedDims:d,idDims:l}}function ese(e,t){let n=new Array(e);n.fill(-1);for(let a=0;a<t.length;++a)n[t[a]]=a;let r=[];for(let a=0;a<e;++a)n[a]===-1&&r.push(a);return n=n.filter(a=>a!==-1),{permutationIndices:n,expandDims:r}}function tse(e,t,n){let r=new Array(e);for(let a=0;a<n.length;++a){let i=n[a].shape;for(let s=0;s<t[a].length;++s)r[t[a][s]]===void 0?r[t[a][s]]=i[s]:M(r[t[a][s]]===i[s],()=>"Expected dimension ".concat(r[t[a][s]]," at axis ").concat(s," of input shaped ").concat(JSON.stringify(i),", but got dimension ").concat(i[s]))}}function nse(e,t){let n=e,r=[],a=0;e.length===0&&n.push(-1),a=e.length+1;for(let s=0;s<a;++s)r.push([]);let i=[];for(let s=0;s<n.length;++s){let o=n[s],l=ase(t,o);for(let c of l)i.indexOf(c)===-1&&(r[s].push(c),i.push(c))}return{path:n,steps:r}}function rse(e){return e.every((t,n)=>t===n)}function ase(e,t){let n=[];for(let r=0;r<e.length;++r)(e[r].length===0||e[r].indexOf(t)!==-1||t===-1)&&n.push(r);return n}function ise(e,t,n=0){let r=[];if(typeof t=="number")M(e.shape[n]%t===0,()=>"Number of splits must evenly divide the axis."),r=new Array(t).fill(e.shape[n]/t);else{let a=t.reduce((s,o)=>(o===-1&&(s+=1),s),0);M(a<=1,()=>"There should be only one negative value in split array.");let i=t.indexOf(-1);if(i!==-1){let s=t.reduce((o,l)=>l>0?o+l:o);t[i]=e.shape[n]-s}M(e.shape[n]===t.reduce((s,o)=>s+o),()=>"The sum of sizes must match the size of the axis dimension."),r=t}return r}function sse(e){return"Received SparseTensor with denseShape[0] = 0 but\n  indices.shape[0] = ".concat(e)}function ose(e,t){return"indices(".concat(e,", 0) is invalid: ").concat(t," < 0")}function lse(e,t,n){return"indices(".concat(e,", 0) is invalid: ").concat(t," >= ").concat(n)}function use(e,t){return"only one output dimension may be -1, not both ".concat(e," and ").concat(t)}function cse(e,t){return"size ".concat(e," must be non-negative, not ").concat(t)}function dse(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function pse(e,t){let n=Nt(e),r=Nt(t);return"Input to reshape is a SparseTensor with ".concat(n,"\n  dense values, but the requested shape requires a multiple of ").concat(r,". inputShape=").concat(e," outputShape= ").concat(t)}function hse(e,t){let n=Nt(e),r=Nt(t);return"Input to reshape is a tensor with ".concat(n," dense values, but the requested shape has ").concat(r,". inputShape=").concat(e," outputShape=").concat(t)}function fse(){return"segment ids must be >= 0"}function mse(){return"segment ids are not increasing"}function gse(e,t){return"Segment id ".concat(e," out of range [0, ").concat(t,"), possibly because segmentIds input is not sorted.")}function yse(e,t,n){return"Bad: indices[".concat(e,"] == ").concat(t," out of range [0, ").concat(n,")")}var hz={};Ue(hz,{collectGatherOpShapeInfo:()=>xse,computeOutShape:()=>vse,segOpComputeOptimalWindowSize:()=>bse});function bse(e,t){let n=!1,r;for(e<=oE?(r=e,n=!0):r=vv(e,Math.floor(Math.sqrt(e)));!n;)r>t||r===e?n=!0:r=vv(e,r+1);return r}function vse(e,t,n){let r=[],a=e.length;for(let i=0;i<a;i++)i!==t?r.push(e[i]):r.push(n);return r}function xse(e,t,n,r){let a=t.shape.length,i=e.shape.length;if(r!==0&&(r<-a||r>a))throw new Error("Expect batchDims in the range of [-".concat(a,", ").concat(a,"], but got ").concat(r));if(r<0&&(r+=a),r>i)throw new Error("batchDims (".concat(r,") must be less than rank(x) (\n    ").concat(i,")."));if(n<r)throw new Error("batchDims (".concat(r,") must be less than or equal to axis (").concat(n,")."));for(let d=0;d<r;++d)if(e.shape[d]!==t.shape[d])throw new Error("x.shape[".concat(d,"]: ").concat(e.shape[d]," should be equal to indices.shape[").concat(d,"]: ").concat(t.shape[d],"."));let s=e.shape[n],o=[],l=1,c=1,u=1;for(let d=0;d<r;++d)o.push(e.shape[d]),l*=e.shape[d];for(let d=r;d<n;d++)o.push(e.shape[d]),c*=e.shape[d];for(let d=r;d<a;d++)o.push(t.shape[d]);for(let d=n+1;d<i;d++)o.push(e.shape[d]),u*=e.shape[d];return{batchSize:l,sliceSize:u,outerSize:c,dimSize:s,outputShape:o}}function wse(e){try{return e.map(t=>Sv(t))}catch(t){throw new Error("Failed to decode encoded string bytes into utf-8, error: ".concat(t))}}function kse(e){return e.map(t=>$g(t))}var us={};Ue(us,{nonMaxSuppressionV3Impl:()=>F3,nonMaxSuppressionV4Impl:()=>M3,nonMaxSuppressionV5Impl:()=>O3,whereImpl:()=>S3});Bae();var fz={kernelName:Rp,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>G(e,Uc(de(n,"float32"),-1))}}},Sse={kernelName:wu,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>{let r=vt(de(n,"float32")),a=Kn(xe(Ae(1),r));return _t(ke(e,a))}}}},Ise={kernelName:ku,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>{let r=Kn(xe(vt(de(n,"float32")),1));return ke(e,r)}}}},$se={kernelName:Go,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,a=kt(n.shape,r.shape);return{a:()=>{let i=e,s=fn(n.shape,a);return s.length>0&&(i=Se(i,s)),q(i,n.shape)},b:()=>{let i=e,s=fn(r.shape,a);return s.length>0&&(i=Se(i,s)),q(i,r.shape)}}}},Cse={kernelName:Su,saveAllInputs:!0,gradFunc:(e,t)=>{let n={};return t.forEach((r,a)=>{n[a]=()=>e.clone()}),n}},Ese={kernelName:Mp,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>nt(n)}}},Tse={kernelName:Op,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>nt(n)}}},Nse={kernelName:Iu,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ke(e,Kn(xe(Ae(1),vt(de(n,"float32")))))}}},_se={kernelName:$u,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>{let r=Kn(ne(Ae(1),vt(de(n,"float32"))));return ke(e,r)}}}},Ase={kernelName:Tu,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,a=kt(n.shape,r.shape);return{a:()=>{let i=ne(vt(n),vt(r)),s=G(e,ke(r,i)),o=fn(n.shape,a);return o.length>0&&(s=Se(s,o)),q(s,n.shape)},b:()=>{let i=ne(vt(n),vt(r)),s=_t(G(e,ke(n,i))),o=fn(r.shape,a);return o.length>0&&(s=Se(s,o)),q(s,r.shape)}}}},Rse={kernelName:Cu,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ke(e,ne(vt(de(n,"float32")),1))}}},Dse={kernelName:Eu,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ke(e,xe(Ae(1),vt(de(n,"float32"))))}}};function Fse(e,t,n,r,a,i){let s=A(e,"dy","avgPool3dGrad"),o=A(t,"input","avgPool3dGrad"),l=s,c=o,u=!1;o.rank===4&&(u=!0,l=q(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]]),c=q(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),M(l.rank===5,()=>"Error in avgPool3dGrad: dy must be rank 5 but got rank ".concat(l.rank,".")),M(c.rank===5,()=>"Error in avgPool3dGrad: input must be rank 5 but got rank ".concat(c.rank,".")),Rr("avgPool3dGrad",a,i);let d={dy:l,input:c},p={filterSize:n,strides:r,pad:a,dimRoundingMode:i},h=V.runKernel(rg,d,p);return u?q(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}var Mse=H({avgPool3dGrad_:Fse}),Ose={kernelName:Lp,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{filterSize:a,strides:i,pad:s,dimRoundingMode:o}=n;return{x:()=>Mse(e,r,a,i,s,o)}}};function Lse(e,t,n,r,a){let i=A(e,"dy","avgPoolGrad"),s=A(t,"input","avgPoolGrad");M(s.rank===i.rank,()=>"Rank of input (".concat(s.rank,") does not match rank of dy (").concat(i.rank,")"));let o=s,l=i,c=!1;s.rank===3&&(c=!0,o=q(s,[1,s.shape[0],s.shape[1],s.shape[2]]),l=q(i,[1,i.shape[0],i.shape[1],i.shape[2]])),M(l.rank===4,()=>"Error in avgPoolGrad: dy must be rank 4 but got rank ".concat(l.rank,".")),M(o.rank===4,()=>"Error in avgPoolGrad: input must be rank 4 but got rank ".concat(o.rank,"."));let u={dy:l,input:o},d={filterSize:n,strides:r,pad:a},p=V.runKernel(ng,u,d);return c?q(p,[p.shape[1],p.shape[2],p.shape[3]]):p}var Pse=H({avgPoolGrad_:Lse}),zse={kernelName:Nu,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{filterSize:a,strides:i,pad:s}=n;return{x:()=>Pse(e,r,a,i,s)}}},Bse={kernelName:_u,inputsToSave:["a","b"],gradFunc:(e,t,n)=>{let[r,a]=t,{transposeA:i,transposeB:s}=n;return!i&&!s?{a:()=>Ke(e,a,!1,!0),b:()=>Ke(r,e,!0,!1)}:!i&&s?{a:()=>Ke(e,a,!1,!1),b:()=>Ke(e,r,!0,!1)}:i&&!s?{a:()=>Ke(a,e,!1,!0),b:()=>Ke(r,e,!1,!1)}:{a:()=>Ke(a,e,!0,!0),b:()=>Ke(e,r,!0,!0)}}},Wse={kernelName:Pp,gradFunc:(e,t,n)=>{let{blockShape:r,crops:a}=n;return{x:()=>Og(e,r,a)}}},Use={kernelName:tP,gradFunc:(e,t,n)=>{let r=n,a=r.inputShape,i=r.shape,s=Array.from(i);for(let l=a.length-1;l>=0;l--)if(a[l]===i[l])s[l]=1;else if(a[l]!==1)throw new Error("broadcastTo(): [".concat(a,"] cannot be broadcast to [").concat(i,"]."));let o=[];for(let l=0;l<s.length;l++)s[l]>1&&o.push(l);return{x:()=>Se(e,o,!0)}}},Vse={kernelName:Au,gradFunc:e=>({x:()=>e.clone()})},Hse={kernelName:Ru,gradFunc:e=>({x:()=>nt(e)})},jse={kernelName:qo,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{clipValueMin:a,clipValueMax:i}=n;return{x:()=>Pn(ti(Us(r,a),Zo(r,i)),e,nt(e))}}},Gse={kernelName:ig,inputsToSave:["x"],gradFunc:fz.gradFunc},qse={kernelName:Wp,saveAllInputs:!0,gradFunc:(e,t,n)=>{let r=t.map(o=>o.shape),{axis:a}=n,i=ni(a,t[0].shape)[0],s=r.map(o=>o[i]);return Ur(e,s,i).map(o=>()=>o)}},Kse={kernelName:Du,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{let[r,a]=t,{dilations:i,strides:s,pad:o,dataFormat:l}=n;return M(Ro(i),()=>"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '".concat(i,"'")),{x:()=>cC(r.shape,e,a,s,o,l),filter:()=>KC(r,e,a.shape,s,o,l)}}},Xse={kernelName:Fu,inputsToSave:["dy","filter"],gradFunc:(e,t,n)=>{let[r,a]=t,{strides:i,pad:s,dataFormat:o,dimRoundingMode:l}=n;return{dy:()=>$r(e,a,i,s,o,1,l),filter:()=>KC(e,r,a.shape,i,s,o,l)}}};function Yse(e,t,n,r,a){let i=e;e.rank===4&&(i=q(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]));let s=t;s.rank===4&&(s=q(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),M(i.rank===5,()=>"Error in conv3dDerFilter: input must be rank 5, but got shape ".concat(i.shape,".")),M(s.rank===5,()=>"Error in conv3dDerFilter: dy must be rank 5, but got shape ".concat(s.shape,".")),M(n.length===5,()=>"Error in conv3dDerFilter: filterShape must be length 5, but got ".concat(n,".")),M(i.shape[4]===n[3],()=>"Error in conv3dDerFilter: depth of input ".concat(i.shape[4],") must match input depth in filter (").concat(n[3],".")),M(s.shape[4]===n[4],()=>"Error in conv3dDerFilter: depth of dy (".concat(s.shape[4],") must match output depth for filter (").concat(n[4],")."));let o={x:i,dy:s},l={strides:r,pad:a,filterShape:n};return V.runKernel(Up,o,l)}var Zse=H({conv3DBackpropFilter_:Yse}),Qse={kernelName:Mu,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{let{dilations:r,strides:a,pad:i}=n;M(Ro(r),()=>"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '".concat(r,"'"));let[s,o]=t;return{x:()=>OP(s.shape,e,o,a,i),filter:()=>Zse(s,e,o.shape,a,i)}}},Jse={kernelName:Ou,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>G(_t(Ex(de(n,"float32"))),e)}}},eoe={kernelName:Lu,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>G(Tx(de(n,"float32")),e)}}},toe={kernelName:Pu,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{axis:a,exclusive:i,reverse:s}=n;return{x:()=>{let o=VP([a],r.rank),l=mx(e,a,i,!s);return o!=null&&(l=Ye(l,o)),l}}}},noe={kernelName:zu,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{let{dilations:r,strides:a,pad:i,dimRoundingMode:s}=n,o=r==null?[1,1]:r;M(Ro(o),()=>"Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '".concat(o,"'"));let[l,c]=t;return M(l.rank===4,()=>"Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ".concat(l.rank,".")),M(c.rank===4,()=>"Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ".concat(c.rank,".")),M(l.shape[3]===c.shape[2],()=>"Error in gradient of depthwiseConv2d: number of input channels (".concat(l.shape[3],") must match the inChannels dimension in filter ").concat(c.shape[2],".")),M(os(a,o),()=>"Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ".concat(a," and dilations '").concat(o,"'.")),Rr("depthwiseConv2d",i,s),{x:()=>A3(l.shape,e,c,a,i,o,s),filter:()=>_3(l,e,c.shape,a,i,o,s)}}},roe={kernelName:Bu,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{let[r,a]=t,i={x:r,filter:a,dy:e},s={x:r,filter:a,dy:e};return{x:()=>V.runKernel(rp,i,n),filter:()=>V.runKernel(ap,s,n)}}},aoe={kernelName:Uu,outputsToSave:[!0],gradFunc:(e,t)=>{let[n]=t,r={dy:e,y:n};return{x:()=>V.runKernel(qp,r)}}},ioe={kernelName:Vu,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t,r=G(Cr(_t(vt(n))),2/Math.sqrt(Math.PI));return{x:()=>G(e,r)}}},soe={kernelName:Hu,outputsToSave:[!0],gradFunc:(e,t)=>{let[n]=t;return{x:()=>G(e,n)}}},ooe={kernelName:Xp,inputsToSave:["input"],gradFunc:(e,t)=>{let[n]=t;return{input:()=>q(e,n.shape)}}},loe={kernelName:ju,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>G(e,Cr(n))}}},uoe={kernelName:Gu,gradFunc:e=>({x:()=>nt(e)})},coe={kernelName:qu,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,a=kt(n.shape,r.shape);return{a:()=>{let i=ke(e,de(r,"float32")),s=fn(n.shape,a);return s.length>0?q(Se(i,s),n.shape):i},b:()=>{let i=G(e,de(n,"float32")),s=fn(r.shape,a);s.length>0&&(i=q(Se(i,s),r.shape));let o=vt(r);return _t(ke(i,de(o,"float32")))}}}},doe={kernelName:Ku,inputsToSave:["x","mean","variance","scale"],gradFunc:(e,t,n)=>{let{varianceEpsilon:r}=n,[a,i,s,o]=t,l=o==null?Ae(1):o,c=fn(i.shape,a.shape),u=[];if(i.rank===1){for(let m=0;m<a.shape.length-1;++m)u.push(a.shape[m]);u.push(1)}let d=xe(a,i),p=G(e,l),h=$x(ne(s,Ae(r))),f=G(G(G(h,h),h),Ae(-.5));return{x:()=>i.rank===1?q(G(G(e,sa(q(h,[1,1,1,i.shape[0]]),u)),l),a.shape):q(G(G(e,h),l),a.shape),mean:()=>{let m=G(G(h,Ae(-1)),p);return i.rank===1&&(m=Se(m,c)),q(m,i.shape)},variance:()=>{let m=G(G(f,d),p);return i.rank===1&&(m=Se(m,c)),q(m,i.shape)},scale:()=>{let m=G(d,h),g=G(e,m);return i.rank===1&&(g=Se(g,c)),q(g,i.shape)},offset:()=>{let m=e;return i.rank===1&&(m=Se(m,c)),q(m,i.shape)}}}},poe={kernelName:Zp,inputsToSave:["x","indices"],gradFunc:(e,t,n)=>{let[r,a]=t,{axis:i}=n,s=ni(i,r.shape)[0];return{x:()=>{let o=r.shape,l=a.size,c=o.slice(0,s),u=c.length,d=o.slice(i,o.length).slice(1),p=d.length,h=oR(0,u),f=oR(u+1,u+1+p),m=lR([c,[l],d]),g=q(e,m),y=q(a,[l]),b=lR([[u],h,f]),v=Ye(g,b),x=Ox(v,y,r.shape[s]),w=vC(b);return x=Ye(x,w),x},indices:()=>a}}};function oR(e,t){let n=[];for(let r=e;r<t;++r)n.push(r);return n}function lR(e){let t=[];for(let n=0;n<e.length;++n)for(let r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var hoe={kernelName:Xu,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t;return{a:()=>nt(n),b:()=>nt(r)}}},foe={kernelName:Yu,gradFunc:e=>({x:()=>de(e,"float32")})},moe={kernelName:Zu,gradFunc:e=>({x:()=>nt(e)})},goe={kernelName:Qu,gradFunc:e=>({x:()=>nt(e)})},yoe={kernelName:Ju,gradFunc:e=>({x:()=>nt(e)})},boe={kernelName:ec,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{alpha:a}=n,i=Dr(r,0);return{x:()=>Pn(i,e,G(e,a))}}},voe={kernelName:nc,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ke(e,ne(n,1))}}},xoe={kernelName:tc,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ke(e,de(n,"float32"))}}},woe={kernelName:rP,inputsToSave:[],outputsToSave:[!0],gradFunc:(e,t,n)=>{let[r]=t,{axis:a}=n;return{logits:()=>{let i=Cr(r);return xe(e,G(Se(e,a,!0),i))}}}};function koe(e,t,n,r=5,a=1,i=1,s=.5){let o={x:e,y:t,dy:n},l={depthRadius:r,bias:a,alpha:i,beta:s};return V.runKernel(sh,o,l)}var Soe=H({localResponseNormalizationBackprop_:koe}),Ioe={kernelName:rc,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let[r,a]=t,{depthRadius:i,bias:s,alpha:o,beta:l}=n;return{x:()=>Soe(r,a,e,i,s,o,l)}}};function mz(e,t,n,r){return t.rank<n.rank&&(t=q(t,iu(t.shape,r))),e.rank<n.rank&&(e=q(e,iu(e.shape,r))),{x:()=>G(e,de(ha(n,t),e.dtype))}}var uR={kernelName:ac,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let r=n,{reductionIndices:a}=r,i=t[0],s=t[1],o=ni(a,i.shape),l=mz(e,s,i,o);return{x:()=>l.x()}}},$oe={kernelName:ic,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t;return{a:()=>G(e,de(Us(n,r),"float32")),b:()=>G(e,de(op(n,r),"float32"))}}};function Coe(e,t,n,r,a,i,s){let o=A(e,"dy","maxPool3dGrad"),l=A(t,"input","maxPool3dGrad"),c=A(n,"output","maxPool3dGrad"),u=o,d=l,p=c,h=!1;l.rank===4&&(h=!0,u=q(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),d=q(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),p=q(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),M(u.rank===5,()=>"Error in maxPool3dGrad: dy must be rank 5 but got rank ".concat(u.rank,".")),M(d.rank===5,()=>"Error in maxPool3dGrad: input must be rank 5 but got rank ".concat(d.rank,".")),M(p.rank===5,()=>"Error in maxPool3dGrad: output must be rank 5 but got rank ".concat(p.rank,".")),Rr("maxPool3dGrad",i,s);let f={dy:u,input:d,output:p},m={filterSize:r,strides:a,pad:i,dimRoundingMode:s},g=V.runKernel(cg,f,m);return h?q(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}var Eoe=H({maxPool3dGrad_:Coe}),Toe={kernelName:oh,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let[r,a]=t,{filterSize:i,strides:s,pad:o,dimRoundingMode:l}=n;return{x:()=>Eoe(e,r,a,i,s,o,l)}}};function Noe(e,t,n,r,a,i,s){let o=A(e,"dy","maxPoolGrad"),l=A(t,"input","maxPoolGrad"),c=A(n,"output","maxPoolGrad");M(l.rank===o.rank,()=>"Rank of input (".concat(l.rank,") does not match rank of dy (").concat(o.rank,")")),M(o.rank===4,()=>"Error in maxPoolGrad: dy must be rank 4 but got rank ".concat(o.rank,".")),M(l.rank===4,()=>"Error in maxPoolGrad: input must be rank 4 but got rank ".concat(l.rank,".")),Rr("maxPoolGrad",i,s);let u={dy:o,input:l,output:c},d={filterSize:r,strides:a,pad:i,dimRoundingMode:s};return V.runKernel(ug,u,d)}var _oe=H({maxPoolGrad_:Noe}),Aoe={kernelName:sc,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let[r,a]=t,{filterSize:i,strides:s,pad:o}=n;return{x:()=>_oe(e,r,a,i,s,o)}}},Roe={kernelName:oc,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{axis:a}=n,i=ni(a,r.shape),s=UP(r.shape,i)[1],o=Nt(s);return{x:()=>{let l=r.shape.slice();i.forEach(u=>{l[u]=1});let c=q(e,l);return ke(G(c,oa(r.shape,"float32")),o)}}}},Doe={kernelName:lc,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let r=n,{axis:a}=r,[i,s]=t,o=ni(a,i.shape),l=mz(e,s,i,o);return{x:()=>l.x()}}},Foe={kernelName:uc,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t;return{a:()=>G(e,de(Zo(n,r),"float32")),b:()=>G(e,de(Dr(n,r),"float32"))}}},Moe={kernelName:cc,inputsToSave:["x"],gradFunc:(e,t,n)=>{let r=t[0],{paddings:a}=n,i=a.map(s=>s[0]);return{x:()=>et(e,i,r.shape)}}},Ooe={kernelName:dc,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,a=kt(n.shape,r.shape);return{a:()=>{let i=fn(n.shape,a);return i.length>0?q(Se(e,i),n.shape):e},b:()=>{let i=G(e,_t(Lh(ke(n,r)))),s=fn(r.shape,a);return s.length>0?q(Se(i,s),r.shape):i}}}},Loe={kernelName:pc,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,a=kt(n.shape,r.shape);return{a:()=>{let i=G(e,de(r,"float32")),s=fn(n.shape,a);return s.length>0?q(Se(i,s),n.shape):i},b:()=>{let i=G(e,de(n,"float32")),s=fn(r.shape,a);return s.length>0?q(Se(i,s),r.shape):i}}}},Poe={kernelName:uh,gradFunc:e=>({x:()=>_t(e)})},zoe={kernelName:hc,inputsToSave:["indices"],gradFunc:(e,t)=>{let n=t[0];return{indices:()=>qt(n.shape,"float32")}}},Boe={kernelName:fh,gradFunc:e=>({x:()=>nt(e)})},Woe={kernelName:mh,saveAllInputs:!0,gradFunc:(e,t,n)=>{let{axis:r}=n;return en(e,r).map(a=>()=>a)}},cR={kernelName:fc,inputsToSave:["x"],gradFunc:(e,t,n)=>{let r=t[0],{paddings:a}=n,i=a.map(s=>s[0]);return{x:()=>et(e,i,r.shape)}}},Uoe={kernelName:mc,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(e,t)=>{let[n,r,a]=t,i=n,s=r,o=kt(i.shape,s.shape);return{a:()=>{let l=de(s,"float32"),c=G(e,G(l,Os(i,xe(l,Ae(1))))),u=fn(i.shape,o);return u.length>0&&(c=Se(c,u)),q(c,i.shape)},b:()=>{let l=Dr(i,0),c=Pn(l,fa(i),nt(i)),u=G(e,G(a,c)),d=fn(s.shape,o);return d.length>0&&(u=Se(u,d)),q(u,s.shape)}}}},Voe={kernelName:gc,inputsToSave:["x","alpha"],gradFunc:(e,t)=>{let[n,r]=t,a=Dr(n,0);return{x:()=>Pn(a,e,G(e,r)),alpha:()=>{let i=Pn(a,nt(e),G(e,n)),s=fn(r.shape,e.shape);return s.length>0&&(i=Se(i,s)),q(i,r.shape)}}}};function Hoe(e,t,n){let r=e.shape.slice();r[n]=1;let a=q(t,r),i=Nm(e,n,!0,!1),s=Nm(e,n,!0,!0),o=G(i,s);return G(a,o)}function joe(e,t,n){let r=e.shape.length,a=r-n.length,i=T.getAxesPermutation(n,r),s=e;i!=null&&(s=Ye(e,i));let o=s.shape.slice(),l=o.splice(r-n.length,n.length).reduce((d,p)=>d*p,1);o.push(l);let c=s.reshape(o),u=Hoe(c,t,a);if(u=u.reshape(s.shape),i!=null){let d=T.getUndoAxesPermutation(i);u=Ye(u,d)}return u}var Goe={kernelName:yc,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{axis:a}=n,i=[];return a==null?i=r.shape.map((s,o)=>o):typeof a=="number"?i=[a]:i=a,{x:()=>joe(r,e,i)}}},qoe={kernelName:Wu,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,a=kt(n.shape,r.shape);return{a:()=>{let i=ke(e,de(r,"float32")),s=fn(n.shape,a);return s.length>0?q(Se(i,s),n.shape):i},b:()=>{let i=G(e,de(n,"float32")),s=fn(r.shape,a);s.length>0&&(i=q(Se(i,s),r.shape));let o=vt(r);return _t(ke(i,de(o,"float32")))}}}},Koe={kernelName:bc,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ke(e,_t(vt(n)))}}},Xoe={kernelName:kc,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t,r=G(Zo(n,6),Uc(n));return{x:()=>G(e,de(r,"float32"))}}},Yoe={kernelName:vc,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>G(e,de(Uc(n),"float32"))}}},Zoe={kernelName:gh,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>q(e,n.shape)}}},Qoe={kernelName:wc,inputsToSave:["images"],gradFunc:(e,t,n)=>{let[r]=t,a={dy:e,images:r};return{images:()=>V.runKernel(bh,a,n)}}},Joe={kernelName:xc,inputsToSave:["images"],gradFunc:(e,t,n)=>{let[r]=t,a={dy:e,images:r};return{images:()=>V.runKernel(yh,a,n)}}},ele={kernelName:Sc,gradFunc:(e,t,n)=>{let{dims:r}=n,a=ni(r,e.shape);return{x:()=>Da(e,a)}}},tle={kernelName:Ic,gradFunc:e=>({x:()=>nt(e)})},nle={kernelName:$c,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>_t(ke(e,G(Os(n,1.5),2)))}}},rle={kernelName:kh,inputsToSave:["condition"],gradFunc:(e,t)=>{let[n]=t;return{condition:()=>de(nt(n),"float32"),t:()=>G(e,de(n,e.dtype)),e:()=>G(e,de(Fg(n),e.dtype))}}},ale={kernelName:Cc,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>{let r=Dr(n,Ae(0)),a=Ae(dz),i=Ae(pz),s=G(e,i),o=G(G(e,a),Cr(de(n,"float32")));return Pn(r,s,o)}}}},ile={kernelName:_c,outputsToSave:[!0],gradFunc:(e,t)=>{let[n]=t;return{x:()=>G(e,G(n,xe(Ae(1),n)))}}},sle={kernelName:Nc,gradFunc:e=>({x:()=>nt(e)})},ole={kernelName:Ec,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>G(_g(de(n,"float32")),e)}}},lle={kernelName:Tc,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>G(fx(de(n,"float32")),e)}}},ule={kernelName:Sh,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{begin:a,size:i}=n,s=r.shape,[o,l]=uz(r,a,i),c=[];for(let u=0;u<e.rank;u++)c.push([o[u],s[u]-o[u]-l[u]]);return{x:()=>Oi(e,c)}}},cle={kernelName:Fc,outputsToSave:[!0],gradFunc:(e,t,n)=>{let[r]=t,{dim:a}=n,i=!0,s=G(e,r);return{logits:()=>xe(s,G(Se(s,[a],i),r))}}},dle={kernelName:Ac,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>G(e,Qa(n))}}},dR={kernelName:Ih,gradFunc:(e,t,n)=>{let{blockShape:r,paddings:a}=n;return{x:()=>Ng(e,r,a)}}},pR={kernelName:$h,gradFunc:(e,t,n)=>{let{axis:r}=n;return{x:()=>wt(e,r)}}},ple={kernelName:Rc,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ke(e,G(Kn(de(n,"float32")),2))}}},hle={kernelName:gg,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>G(e,G(de(n,"float32"),2))}}},fle={kernelName:Mc,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,a=Ae(2);return{a:()=>G(e,G(a,xe(n,r))),b:()=>G(e,G(a,xe(r,n)))}}},mle={kernelName:Xo,gradFunc:e=>({x:()=>nt(e)})},gle={kernelName:Oc,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,a=kt(n.shape,r.shape);return{a:()=>{let i=e,s=fn(n.shape,a);return s.length>0&&(i=Se(i,s)),q(i,n.shape)},b:()=>{let i=e,s=fn(r.shape,a);return s.length>0&&(i=Se(i,s)),q(_t(i),r.shape)}}}},yle={kernelName:Dc,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,a=r.shape.slice(),{axis:i}=n;ni(i,r.shape).forEach(l=>{a[l]=1});let s=q(e,a),o=G(s,oa(r.shape,"float32"));return{x:()=>o}}},ble={kernelName:Lc,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ke(e,vt(_g(n)))}}},vle={kernelName:Pc,outputsToSave:[!0],gradFunc:(e,t)=>{let[n]=t;return{x:()=>G(xe(Ae(1),vt(n)),e)}}},xle={kernelName:Ko,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{reps:a}=n;return{x:()=>{let i=nt(r);if(r.rank===1)for(let s=0;s<a[0];++s)i=ne(i,et(e,[s*r.shape[0]],[r.shape[0]]));else if(r.rank===2)for(let s=0;s<a[0];++s)for(let o=0;o<a[1];++o)i=ne(i,et(e,[s*r.shape[0],o*r.shape[1]],[r.shape[0],r.shape[1]]));else if(r.rank===3)for(let s=0;s<a[0];++s)for(let o=0;o<a[1];++o)for(let l=0;l<a[2];++l)i=ne(i,et(e,[s*r.shape[0],o*r.shape[1],l*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else if(r.rank===4)for(let s=0;s<a[0];++s)for(let o=0;o<a[1];++o)for(let l=0;l<a[2];++l)for(let c=0;c<a[3];++c)i=ne(i,et(e,[s*r.shape[0],o*r.shape[1],l*r.shape[2],c*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]));else throw new Error("Gradient for tile operation is not implemented for rank-".concat(r.rank," tensors yet."));return i}}}},wle={kernelName:Es,gradFunc:(e,t,n)=>{let r=n,{perm:a}=r,i=vC(a);return{x:()=>Ye(e,i)}}},kle={kernelName:Ah,gradFunc:(e,t,n)=>{let r=n,{axis:a}=r;return{value:()=>Sn(e,a)}}},Sle={kernelName:kg,inputsToSave:["segmentIds"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>Ile(e,n)}}};function Ile(e,t){let n=ls(t,nt(t)),r=Ph(e,n),a=Us(t,Ae(0,"int32")),i=r.rank-a.rank;for(let o=0;o<i;++o)a=Vn(a,o+1);a=ti(a,oa(r.shape,"bool"));let s=nt(r);return Pn(a,r,s)}var $le={kernelName:Rh,gradFunc:e=>({x:()=>nt(e)})},Cle=[fz,Sse,Ise,$se,Cse,Ese,Tse,Nse,_se,Ase,Rse,Dse,Ose,zse,Bse,Wse,Use,Vse,Hse,jse,Gse,qse,Xse,Kse,Qse,Jse,eoe,toe,noe,roe,qoe,aoe,ioe,soe,ooe,loe,coe,uoe,doe,poe,hoe,foe,moe,goe,yoe,boe,voe,xoe,woe,Ioe,uR,uR,$oe,Toe,Aoe,Roe,Doe,Foe,Moe,Ooe,Loe,Poe,zoe,Boe,Woe,cR,cR,Uoe,Voe,Goe,Koe,Xoe,Yoe,Zoe,Qoe,Joe,ele,tle,nle,rle,ale,ile,sle,ole,lle,ule,cle,dle,dR,dR,pR,pR,ple,fle,hle,mle,gle,yle,ble,vle,xle,wle,kle,Sle,$le];for(let e of Cle)aP(e);re().prototype.abs=function(){return this.throwIfDisposed(),un(this)};re().prototype.acos=function(){return this.throwIfDisposed(),j$(this)};re().prototype.acosh=function(){return this.throwIfDisposed(),G$(this)};re().prototype.add=function(e){return this.throwIfDisposed(),ne(this,e)};re().prototype.all=function(e,t){return this.throwIfDisposed(),dx(this,e,t)};re().prototype.any=function(e,t){return this.throwIfDisposed(),Cm(this,e,t)};re().prototype.argMax=function(e){return this.throwIfDisposed(),nu(this,e)};re().prototype.argMin=function(e){return this.throwIfDisposed(),q$(this,e)};re().prototype.asScalar=function(){return this.throwIfDisposed(),M(this.size===1,()=>"The array must have only 1 element."),q(this,[])};re().prototype.asType=function(e){return this.throwIfDisposed(),de(this,e)};re().prototype.as1D=function(){return this.throwIfDisposed(),q(this,[this.size])};re().prototype.as2D=function(e,t){return this.throwIfDisposed(),q(this,[e,t])};re().prototype.as3D=function(e,t,n){return this.throwIfDisposed(),q(this,[e,t,n])};re().prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),q(this,[e,t,n,r])};re().prototype.as5D=function(e,t,n,r,a){return this.throwIfDisposed(),q(this,[e,t,n,r,a])};re().prototype.asin=function(){return this.throwIfDisposed(),K$(this)};re().prototype.asinh=function(){return this.throwIfDisposed(),X$(this)};re().prototype.atan=function(){return this.throwIfDisposed(),Y$(this)};re().prototype.atan2=function(e){return this.throwIfDisposed(),Z$(this,e)};re().prototype.atanh=function(){return this.throwIfDisposed(),Q$(this)};re().prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),Ws(this,e,t,n,r)};re().prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),Ng(this,e,t)};re().prototype.batchNorm=function(e,t,n,r,a){return this.throwIfDisposed(),zc(this,e,t,n,r,a)};re().prototype.broadcastTo=function(e){return this.throwIfDisposed(),Ml(this,e)};re().prototype.cast=function(e){return this.throwIfDisposed(),de(this,e)};re().prototype.ceil=function(){return this.throwIfDisposed(),iC(this)};re().prototype.clipByValue=function(e,t){return this.throwIfDisposed(),lr(this,e,t)};re().prototype.concat=function(e,t){return this.throwIfDisposed(),e instanceof He&&(e=[e]),wt([this,...e],t)};re().prototype.conv1d=function(e,t,n,r,a,i){return this.throwIfDisposed(),px(this,e,t,n,r,a,i)};re().prototype.conv2dTranspose=function(e,t,n,r,a){return this.throwIfDisposed(),hx(this,e,t,n,r,a)};re().prototype.conv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),$r(this,e,t,n,r,a,i)};re().prototype.cos=function(){return this.throwIfDisposed(),_g(this)};re().prototype.cosh=function(){return this.throwIfDisposed(),fx(this)};re().prototype.cumprod=function(e,t,n){return this.throwIfDisposed(),Nm(this,e,t,n)};re().prototype.cumsum=function(e,t,n){return this.throwIfDisposed(),mx(this,e,t,n)};re().prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),hC(this,e,t)};re().prototype.depthwiseConv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),Bc(this,e,t,n,r,a,i)};re().prototype.dilation2d=function(e,t,n,r,a){return this.throwIfDisposed(),fC(this,e,t,n,r,a)};re().prototype.divNoNan=function(e){return this.throwIfDisposed(),mC(this,e)};re().prototype.div=function(e){return this.throwIfDisposed(),ke(this,e)};re().prototype.dot=function(e){return this.throwIfDisposed(),gC(this,e)};re().prototype.elu=function(){return this.throwIfDisposed(),Mh(this)};re().prototype.equal=function(e){return this.throwIfDisposed(),ha(this,e)};re().prototype.erf=function(){return this.throwIfDisposed(),yC(this)};re().prototype.euclideanNorm=function(e,t){return this.throwIfDisposed(),xC(this,e,t)};re().prototype.exp=function(){return this.throwIfDisposed(),Cr(this)};re().prototype.expandDims=function(e){return this.throwIfDisposed(),Vn(this,e)};re().prototype.expm1=function(){return this.throwIfDisposed(),wC(this)};re().prototype.fft=function(){return this.throwIfDisposed(),zg(this)};re().prototype.flatten=function(){return this.throwIfDisposed(),q(this,[this.size])};re().prototype.floor=function(){return this.throwIfDisposed(),Lh(this)};re().prototype.floorDiv=function(e){return this.throwIfDisposed(),cx(this,e)};re().prototype.gather=function(e,t,n){return this.throwIfDisposed(),Ph(this,e,t,n)};re().prototype.greaterEqual=function(e){return this.throwIfDisposed(),Us(this,e)};re().prototype.greater=function(e){return this.throwIfDisposed(),Dr(this,e)};re().prototype.ifft=function(){return this.throwIfDisposed(),dp(this)};re().prototype.irfft=function(){return this.throwIfDisposed(),_x(this)};re().prototype.isFinite=function(){return this.throwIfDisposed(),kC(this)};re().prototype.isInf=function(){return this.throwIfDisposed(),SC(this)};re().prototype.isNaN=function(){return this.throwIfDisposed(),IC(this)};re().prototype.leakyRelu=function(e){return this.throwIfDisposed(),Rg(this,e)};re().prototype.lessEqual=function(e){return this.throwIfDisposed(),Zo(this,e)};re().prototype.less=function(e){return this.throwIfDisposed(),op(this,e)};re().prototype.localResponseNormalization=function(e,t,n,r){return this.throwIfDisposed(),$C(this,e,t,n,r)};re().prototype.logSigmoid=function(){return this.throwIfDisposed(),CC(this)};re().prototype.logSoftmax=function(e){return this.throwIfDisposed(),bx(this,e)};re().prototype.logSumExp=function(e,t){return this.throwIfDisposed(),vx(this,e,t)};re().prototype.log=function(){return this.throwIfDisposed(),fa(this)};re().prototype.log1p=function(){return this.throwIfDisposed(),Dg(this)};re().prototype.logicalAnd=function(e){return this.throwIfDisposed(),ti(this,e)};re().prototype.logicalNot=function(){return this.throwIfDisposed(),Fg(this)};re().prototype.logicalOr=function(e){return this.throwIfDisposed(),xx(this,e)};re().prototype.logicalXor=function(e){return this.throwIfDisposed(),EC(this,e)};re().prototype.matMul=function(e,t,n){return this.throwIfDisposed(),Ke(this,e,t,n)};re().prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),Rn(this,e,t,n,r)};re().prototype.max=function(e,t){return this.throwIfDisposed(),_a(this,e,t)};re().prototype.maximum=function(e){return this.throwIfDisposed(),ls(this,e)};re().prototype.mean=function(e,t){return this.throwIfDisposed(),Gt(this,e,t)};re().prototype.min=function(e,t){return this.throwIfDisposed(),sp(this,e,t)};re().prototype.minimum=function(e){return this.throwIfDisposed(),Do(this,e)};re().prototype.mirrorPad=function(e,t){return this.throwIfDisposed(),NC(this,e,t)};re().prototype.mod=function(e){return this.throwIfDisposed(),_C(this,e)};re().prototype.mul=function(e){return this.throwIfDisposed(),G(this,e)};re().prototype.neg=function(){return this.throwIfDisposed(),_t(this)};re().prototype.norm=function(e,t,n){return this.throwIfDisposed(),Oh(this,e,t,n)};re().prototype.notEqual=function(e){return this.throwIfDisposed(),su(this,e)};re().prototype.oneHot=function(e,t=1,n=0){return this.throwIfDisposed(),lp(this,e,t,n)};re().prototype.onesLike=function(){return this.throwIfDisposed(),ma(this)};re().prototype.pad=function(e,t){return this.throwIfDisposed(),Oi(this,e,t)};re().prototype.pool=function(e,t,n,r,a,i){return this.throwIfDisposed(),AC(this,e,t,n,r,a,i)};re().prototype.pow=function(e){return this.throwIfDisposed(),Os(this,e)};re().prototype.prelu=function(e){return this.throwIfDisposed(),Lg(this,e)};re().prototype.prod=function(e,t){return this.throwIfDisposed(),RC(this,e,t)};re().prototype.reciprocal=function(){return this.throwIfDisposed(),LC(this)};re().prototype.relu=function(){return this.throwIfDisposed(),ft(this)};re().prototype.relu6=function(){return this.throwIfDisposed(),Sx(this)};re().prototype.reshapeAs=function(e){return this.throwIfDisposed(),q(this,e.shape)};re().prototype.reshape=function(e){return this.throwIfDisposed(),q(this,e)};re().prototype.resizeBilinear=function(e,t,n){return this.throwIfDisposed(),L3(this,e,t,n)};re().prototype.resizeNearestNeighbor=function(e,t,n){return this.throwIfDisposed(),P3(this,e,t,n)};re().prototype.reverse=function(e){return this.throwIfDisposed(),Da(this,e)};re().prototype.rfft=function(){return this.throwIfDisposed(),Bg(this)};re().prototype.round=function(){return this.throwIfDisposed(),Ix(this)};re().prototype.rsqrt=function(){return this.throwIfDisposed(),$x(this)};re().prototype.selu=function(){return this.throwIfDisposed(),Cx(this)};re().prototype.separableConv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),zh(this,e,t,n,r,a,i)};re().prototype.sigmoid=function(){return this.throwIfDisposed(),Qa(this)};re().prototype.sign=function(){return this.throwIfDisposed(),PC(this)};re().prototype.sin=function(){return this.throwIfDisposed(),Ex(this)};re().prototype.sinh=function(){return this.throwIfDisposed(),Tx(this)};re().prototype.slice=function(e,t){return this.throwIfDisposed(),et(this,e,t)};re().prototype.softmax=function(e){return this.throwIfDisposed(),Jo(this,e)};re().prototype.softplus=function(){return this.throwIfDisposed(),Wc(this)};re().prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),Og(this,e,t)};re().prototype.split=function(e,t){return this.throwIfDisposed(),Ur(this,e,t)};re().prototype.sqrt=function(){return this.throwIfDisposed(),Kn(this)};re().prototype.square=function(){return this.throwIfDisposed(),vt(this)};re().prototype.squaredDifference=function(e){return this.throwIfDisposed(),Ax(this,e)};re().prototype.squeeze=function(e){return this.throwIfDisposed(),el(this,e)};re().prototype.stack=function(e,t){this.throwIfDisposed();let n=e instanceof He?[this,e]:[this,...e];return Sn(n,t)};re().prototype.step=function(e){return this.throwIfDisposed(),Uc(this,e)};re().prototype.stridedSlice=function(e,t,n,r,a,i,s,o){return this.throwIfDisposed(),zC(this,e,t,n,r,a,i,s,o)};re().prototype.sub=function(e){return this.throwIfDisposed(),xe(this,e)};re().prototype.sum=function(e,t){return this.throwIfDisposed(),Se(this,e,t)};re().prototype.tan=function(){return this.throwIfDisposed(),BC(this)};re().prototype.tanh=function(){return this.throwIfDisposed(),au(this)};re().prototype.tile=function(e){return this.throwIfDisposed(),sa(this,e)};re().prototype.toBool=function(){return this.throwIfDisposed(),de(this,"bool")};re().prototype.toFloat=function(){return this.throwIfDisposed(),de(this,"float32")};re().prototype.toInt=function(){return this.throwIfDisposed(),de(this,"int32")};re().prototype.topk=function(e,t){return this.throwIfDisposed(),UC(this,e,t)};re().prototype.transpose=function(e){return this.throwIfDisposed(),Ye(this,e)};re().prototype.unique=function(e){return this.throwIfDisposed(),VC(this,e)};re().prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),Ox(this,e,t)};re().prototype.unstack=function(e){return this.throwIfDisposed(),en(this,e)};re().prototype.where=function(e,t){return this.throwIfDisposed(),Pn(e,this,t)};re().prototype.zerosLike=function(){return this.throwIfDisposed(),nt(this)};var ys=class extends Error{constructor(e){super(e),Object.setPrototypeOf(this,ys.prototype)}},xi=class extends Error{constructor(e){super(e),Object.setPrototypeOf(this,xi.prototype)}},X=class extends Error{constructor(e){super(e),Object.setPrototypeOf(this,X.prototype)}},Xe=class extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Xe.prototype)}},gz=class extends Error{constructor(e){super(e),Object.setPrototypeOf(this,gz.prototype)}},yz=class{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let t;return this.cache.has(e)&&(t=this.cache.get(e),this.cache.delete(e),this.cache.set(e,t)),t}put(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){let n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(e,t)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error("The maxEntries of LRU caches must be at least 0, but got ".concat(e,"."));if(this.maxEntries>e)for(let t=0;t<this.maxEntries-e;t++){let n=this.cache.keys().next().value;this.cache.delete(n)}this.maxEntries=e}};function lu(e,t){if(Array.isArray(e)){let n=[];for(let r=0;r<t;r++)n=n.concat(e);return n}else{let n=new Array(t);return n.fill(e),n}}function Ki(e,t){if(!e)throw new gz(t)}function hR(e,t){let n=0;for(let r of e)r===t&&n++;return n}function Br(e){return e.length===1?e[0]:e}function Dt(e){return Array.isArray(e)?e:[e]}function bs(e){let t=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return t[0]!=="_"?t:"private"+t}function kl(e){return e.length<=1||e.indexOf("_")===-1?e:e.replace(/[_]+(\w|$)/g,(t,n)=>n.toUpperCase())}var Ba={};function lE(e){if(e==null)return null;let t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function uS(e){if(!(e==null||typeof e!="object"))if(Array.isArray(e))e.forEach(t=>uS(t));else{let t=Object.keys(e);for(let n of t){let r=e[n];r!=null&&typeof r=="object"&&(!Array.isArray(r)&&r.type==="ndarray"&&typeof r.value=="number"?e[n]=r.value:uS(r))}}}function Ug(e,t={},n={},r="object",a=!1){if(typeof e=="string"){let i=e,s;if(i in n)s=n[i];else if(i in Ba)s=Ba[i];else if(s=t[i],s==null)throw new X("Unknown ".concat(r,": ").concat(e,". This may be due to one of the following reasons:\n1. The ").concat(r," is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom ").concat(r," is defined in JavaScript, but is not registered properly with tf.serialization.registerClass()."));return s}else{let i=e;if(i.className==null||i.config==null)throw new X("".concat(r,": Improper config format: ").concat(JSON.stringify(i),".\n'className' and 'config' must set."));let s=i.className,o,l;if(s in n?[o,l]=n[s]:s in Ba?[o,l]=Ba.className:s in t&&([o,l]=t[s]),o==null)throw new X("Unknown ".concat(r,": ").concat(s,". This may be due to one of the following reasons:\n1. The ").concat(r," is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom ").concat(r," is defined in JavaScript, but is not registered properly with tf.serialization.registerClass()."));if(l!=null){let c={};for(let h of Object.keys(Ba))c[h]=Ba[h];for(let h of Object.keys(n))c[h]=n[h];let u=i.config;u.customObjects=c;let d=Object.assign({},Ba);for(let h of Object.keys(n))Ba[h]=n[h];uS(i.config);let p=l(o,i.config,n,a);return Ba=Object.assign({},d),p}else{let c=Object.assign({},Ba);for(let d of Object.keys(n))Ba[d]=n[d];let u=new o(i.config);return Ba=Object.assign({},c),u}}}function Ele(e,t){return e<t?-1:e>t?1:0}function Hy(e,t){return-1*Ele(e,t)}function So(e){if(e==null)return e;let t=[];for(let n of e)t.indexOf(n)===-1&&t.push(n);return t}function Tle(e){if(e==null)throw new X("Invalid value in obj: ".concat(JSON.stringify(e)));for(let t in e)if(e.hasOwnProperty(t))return!1;return!0}function Vc(e,t,n){if(n!=null&&e.indexOf(n)<0)throw new X("".concat(n," is not a valid ").concat(t,".  Valid values are ").concat(e," or null/undefined."))}function uE(e,t,n=0,r=1/0){return Ki(n>=0),Ki(r>=n),Array.isArray(e)&&e.length>=n&&e.length<=r&&e.every(a=>typeof a===t)}function Ln(e,t){Array.isArray(e)?(k.assert(e.length>0,()=>"".concat(t," is unexpectedly an empty array.")),e.forEach((n,r)=>Ln(n,"element ".concat(r+1," of ").concat(t)))):k.assert(Number.isInteger(e)&&e>0,()=>"Expected ".concat(t," to be a positive integer, but got ").concat(bz(e),"."))}function bz(e){return e===null?"null":Array.isArray(e)?"["+e.map(t=>bz(t)).join(",")+"]":typeof e=="string"?'"'.concat(e,'"'):"".concat(e)}function Nle(e,t,n){let r=n!=null?n():k.now(),a;return(...i)=>{let s=n!=null?n():k.now();return s-r<t||(r=s,a=e(...i)),a}}function vz(e){return e==="relu"?"relu":e==="linear"?"linear":e==="elu"?"elu":null}var _le=0;function xz(){return _le++}var jy={};function Vx(e=""){return e in jy||(jy[e]=0),jy[e]+=1,e+jy[e].toString()}var Ale=["channelsFirst","channelsLast"],Rle=["nearest","bilinear"],Dle=["valid","same","causal"],Fle=["max","avg"],Mle=["sum","mul","concat","ave"],sd=new Map;function an(e){Vc(Ale,"DataFormat",e)}function Ole(e){Vc(Rle,"InterpolationFormat",e)}function za(e){Vc(Dle,"PaddingMode",e)}function wz(e){Vc(Fle,"PoolMode",e)}var qf=[],fR="/";function Ol(e,t){qf.push(e);try{let n=t();return qf.pop(),n}catch(n){throw qf.pop(),n}}function Lle(){return qf.length===0?"":qf.join(fR)+fR}function kz(e){if(!Iz(e))throw new Error("Not a valid tensor name: '"+e+"'");return Lle()+e}function Sz(e){if(!Iz(e))throw new Error("Not a valid tensor name: '"+e+"'");sd.has(e)||sd.set(e,0);let t=sd.get(e);if(sd.set(e,sd.get(e)+1),t>0){let n="".concat(e,"_").concat(t);return sd.set(n,1),n}else return e}var Ple=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function Iz(e){return!!e.match(Ple)}function zle(e){return e===parseInt(e.toString(),10)}function Io(e,t,n){t==null&&(t=0),n==null&&(n=e.length);let r=1;for(let a=t;a<n;++a)r*=e[a];return r}function fp(e){if(e.length===0)return Number.NaN;let t=Number.POSITIVE_INFINITY;for(let n=0;n<e.length;n++){let r=e[n];r<t&&(t=r)}return t}function Mo(e){if(e.length===0)return Number.NaN;let t=Number.NEGATIVE_INFINITY;for(let n=0;n<e.length;n++){let r=e[n];r>t&&(t=r)}return t}function Di(e,t){if(t<e)throw new X("end (".concat(t,") < begin (").concat(e,") is forbidden."));let n=[];for(let r=e;r<t;++r)n.push(r);return n}var x1;function kn(){return x1==null&&(x1=TP().epsilon()),x1}function Fi(){return"channelsLast"}function Ls(e,t){return de(e,t)}function Vg(e,t=-1){let n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),q(e,n)}function Ble(e,t){return K(()=>{if(e.shape.length!==2)throw new X("repeat() expects a rank-2 tensor, but received a rank-".concat(e.shape.length," tensor."));let n=Vg(e,1);return cS(n,[1,t,1])})}function Wle(e){let t=[Io(e.shape)];return q(e,t)}function Ule(e){if(e.rank<=1)throw new X("batchFlatten requires a minimum rank of 2. Got rank: ".concat(e.rank,"."));let t=[e.shape[0],Io(e.shape,1)];return q(e,t)}function Ll(e,t,n){return K(()=>{switch(e.rank){case 1:return Pg(e,t,n);case 2:return Nx(e,[t,0],[n,e.shape[1]]);case 3:return Bh(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return cp(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return et(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return et(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new X("sliceAlongFirstAxis() received an unsupported tensor rank: ".concat(e.rank))}})}function w1(e,t,n){return K(()=>{switch(e.rank){case 1:return Pg(e,t,n);case 2:return Nx(e,[0,t],[e.shape[0],n]);case 3:return Bh(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return cp(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new X("sliceAlongLastAxis() received an unsupported tensor rank: ".concat(e.rank))}})}function Gy(e,t,n,r){return K(()=>{switch(e.rank){case 1:return Pg(e,t,n);case 2:switch(r){case 1:return Ll(e,t,n);case 2:return w1(e,t,n);default:throw new X("The axis is not within the rank of the tensor ".concat(r))}case 3:switch(r){case 1:return Ll(e,t,n);case 2:return Bh(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return w1(e,t,n);default:throw new X("The axis is not within the rank of the tensor ".concat(r))}case 4:switch(r){case 1:return Ll(e,t,n);case 2:return cp(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return cp(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return w1(e,t,n);default:throw new X("The axis is not within the rank of the tensor ".concat(r))}default:throw new X("sliceAlongLastAxis() received an unsupported tensor rank: ".concat(e.rank))}})}function cE(e,t=-1){let n;return t<0&&(n=e[0].rank,n!==0?t=n:t=0),t===e[0].rank&&(t=-1),wt(e,t)}function mR(e,t){switch(e.rank){case 1:return sC([e,t]);case 2:return oC([e,t],0);case 3:return lC([e,t],0);case 4:return uC([e,t],0);default:throw new X("concatAlongFirstAxis() received an unsupported tensor rank: ".concat(e.rank))}}function cS(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new X("The length of input n (".concat(t.length,") does not match the number of dimensions in input x (").concat(e.rank,")"));return sa(e,t)}function Hx(e,t=0,n=1,r,a){return kx(e,t,n,r,a)}function ns(e,t,n,r){if(e.rank<2||t.rank<2)throw new Xe("dot requires both inputs to be rank >= 2 but got x shape = ".concat(e.shape," and y shape = ").concat(t.shape));if(t.rank>=3){let a=e.shape.slice(-1)[0],i=t.shape.slice(-2)[0];if(a!==i)throw new Xe("If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ".concat(e.shape," and  y shape = ").concat(t.shape))}if(e.rank===2&&t.rank===2)return pp.matMul({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?dS(e.rank,r,Fi()):null,activation:n});{let a=e.shape.slice(),i=a.pop();e=q(e,[-1,i]);let s=t.shape.slice(),o=s.pop(),l=s.pop(),c=[...s,o],u=Array.from({length:t.rank},(f,m)=>m===0?t.rank-2:m<=t.rank-2?m-1:m);t=q(Ye(t,u),[l,-1]);let d=[...a,...c],p=!1,h=!1;return q(pp.matMul({a:e,b:t,transposeA:p,transposeB:h,bias:r?dS(e.rank,r,Fi()):null,activation:n}),d)}}function $z(e,t,n){return K(()=>(Array.isArray(t)?t=ht(t,"int32"):t=de(t,"int32"),Ph(e,t,n)))}function Hg(e){return G(e,e)}function dS(e,t,n){let r=t.shape;if(t.rank!==1&&t.rank!==e)throw new X("Unexpected bias dimensions: ".concat(t.rank,"; expected it to be 1 or ").concat(e));if(e===5){if(n==="channelsFirst")return r.length===1?q(t,[1,r[0],1,1,1]):q(t,[1,r[3],r[0],r[1],r[2]]);if(n==="channelsLast")return r.length===1?q(t,[1,1,1,1,r[0]]):q(t,[1].concat(r))}else if(e===4){if(n==="channelsFirst")return r.length===1?q(t,[1,r[0],1,1]):q(t,[1,r[2],r[0],r[1]]);if(n==="channelsLast")return r.length===1?q(t,[1,1,1,r[0]]):q(t,[1].concat(r))}else if(e===3){if(n==="channelsFirst")return r.length===1?q(t,[1,r[0],1]):q(t,[1,r[1],r[0]]);if(n==="channelsLast")return r.length===1?q(t,[1,1,r[0]]):q(t,[1].concat(r))}else if(e<3)return t;throw new X("Unsupported input rank by biasAdd: ".concat(t.rank))}function Li(e,t,n){return K(()=>(n==null&&(n=Fi()),an(n),ne(e,dS(e.rank,t,n))))}function Vle(e,t=1){if(t!==1)throw new Xe("Support for alpha values other than 1 (".concat(t,") is not implemented yet."));return Mh(e)}function Hle(e){return K(()=>ke(e,ne(un(e),1)))}function Cz(e,t,n,r){return K(()=>GC(e,t,n,r))}function jle(e){return K(()=>{let t=ne(.5,G(.2,e));return lr(t,0,1)})}function jg(e,t,n=!1){return n?e():t()}var Gle=["fanIn","fanOut","fanAvg"],qle=["normal","uniform","truncatedNormal"];function Kle(e){Vc(Gle,"FanMode",e)}function Xle(e){Vc(qle,"Distribution",e)}var ri=class extends le.Serializable{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}},dE=class extends ri{apply(e,t){return qt(e,t)}};dE.className="Zeros";le.registerClass(dE);var jx=class extends ri{apply(e,t){return oa(e,t)}};jx.className="Ones";le.registerClass(jx);var pE=class extends ri{constructor(e){if(super(),typeof e!="object")throw new X("Expected argument of type ConstantConfig but got ".concat(e));if(e.value===void 0)throw new X("config must have value set but got ".concat(e));this.value=e.value}apply(e,t){return K(()=>G(Ae(this.value),oa(e,t)))}getConfig(){return{value:this.value}}};pE.className="Constant";le.registerClass(pE);var hE=class extends ri{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,t){return Qo(e,this.minval,this.maxval,t,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}};hE.className="RandomUniform";le.registerClass(hE);var fE=class extends ri{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t=t||"float32",t!=="float32"&&t!=="int32")throw new Xe("randomNormal does not support dType ".concat(t,"."));return Hx(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}};fE.className="RandomNormal";le.registerClass(fE);var mE=class extends ri{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t=t||"float32",t!=="float32"&&t!=="int32")throw new Xe("truncatedNormal does not support dType ".concat(t,"."));return Mx(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}};mE.className="TruncatedNormal";le.registerClass(mE);var gE=class extends ri{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,t){return K(()=>{if(e.length!==2||e[0]!==e[1])throw new X("Identity matrix initializer can only be used for 2D square matrices.");return G(this.gain,gx(e[0]))})}getConfig(){return{gain:this.gain}}};gE.className="Identity";le.registerClass(gE);function Yle(e,t="channelsLast"){let n,r;if(an(t),e.length===2)n=e[0],r=e[1];else if([3,4,5].indexOf(e.length)!==-1){if(t==="channelsFirst"){let a=Io(e,2);n=e[1]*a,r=e[0]*a}else if(t==="channelsLast"){let a=Io(e,0,e.length-2);n=e[e.length-2]*a,r=e[e.length-1]*a}}else{let a=Io(e);n=Math.sqrt(a),r=Math.sqrt(a)}return[n,r]}var jr=class extends ri{constructor(e){if(super(),e.scale<0)throw new X("scale must be a positive float. Got: ".concat(e.scale));this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,Kle(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,Xle(this.distribution),this.seed=e.seed}apply(e,t){let n=Yle(e),r=n[0],a=n[1],i=this.scale;if(this.mode==="fanIn"?i/=Math.max(1,r):this.mode==="fanOut"?i/=Math.max(1,a):i/=Math.max(1,(r+a)/2),this.distribution==="normal"){let s=Math.sqrt(i);if(t=t||"float32",t!=="float32"&&t!=="int32")throw new Xe("".concat(this.getClassName()," does not support dType ").concat(t,"."));return Mx(e,0,s,t,this.seed)}else{let s=Math.sqrt(3*i);return Qo(e,-s,s,t,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}};jr.className="VarianceScaling";le.registerClass(jr);var Gx=class extends jr{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return jr.className}};Gx.className="GlorotUniform";le.registerClass(Gx);var qx=class extends jr{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return jr.className}};qx.className="GlorotNormal";le.registerClass(qx);var Kx=class extends jr{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return jr.className}};Kx.className="HeNormal";le.registerClass(Kx);var Xx=class extends jr{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return jr.className}};Xx.className="HeUniform";le.registerClass(Xx);var Yx=class extends jr{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return jr.className}};Yx.className="LeCunNormal";le.registerClass(Yx);var Zx=class extends jr{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return jr.className}};Zx.className="LeCunUniform";le.registerClass(Zx);var yE=class extends ri{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,t){return K(()=>{if(e.length<2)throw new Xe("Shape must be at least 2D.");if(t!=="int32"&&t!=="float32"&&t!==void 0)throw new TypeError("Unsupported data type ".concat(t,"."));t=t;let n=k.sizeFromShape(e.slice(0,-1)),r=e[e.length-1],a=n*r;a>this.ELEMENTS_WARN_SLOW&&console.warn("Orthogonal initializer is being called on a matrix with more than ".concat(this.ELEMENTS_WARN_SLOW," (").concat(a,") elements: Slowness may result."));let i=[Math.max(r,n),Math.min(r,n)],s=Hx(i,0,1,t,this.seed),o=YC.qr(s,!1),l=o[0],c=o[1].flatten().stridedSlice([0],[Math.min(r,n)*Math.min(r,n)],[Math.min(r,n)+1]);return l=G(l,c.sign()),n<r&&(l=l.transpose()),G(Ae(this.gain),l.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}};yE.className="Orthogonal";le.registerClass(yE);var gR={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function yR(e,t={}){return Ug(e,le.SerializationMap.getMap().classNameMap,t,"initializer")}function Kt(e){return lE(e)}function Bt(e){if(typeof e=="string"){let t=e in gR?gR[e]:e;if(t==="GlorotNormal")return new qx;if(t==="GlorotUniform")return new Gx;if(t==="HeNormal")return new Kx;if(t==="HeUniform")return new Xx;if(t==="LeCunNormal")return new Yx;if(t==="LeCunUniform")return new Zx;{let n={};return n.className=t,n.config={},yR(n)}}else return e instanceof ri?e:yR(e)}function pS(e){return Array.isArray(e)&&Array.isArray(e[0])}function Ev(e){return e.length===0?[]:Array.isArray(e[0])?e:[e]}function Oe(e){let t;if(Array.isArray(e)){if(e.length!==1)throw new X("Expected Tensor length to be 1; got ".concat(e.length));t=e[0]}else t=e;return t}function lt(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(e.length===1)return e=e,e[0];throw new X("Expected exactly 1 Shape; got ".concat(e.length))}else return e}function Tv(e){let t=0;for(let n of e)n.shape.length===0?t+=1:t+=n.shape.reduce((r,a)=>r*a);return t}var bR="Variable",Ez=class{constructor(e,t="float32",n=bR,r=!0,a=null){this.dtype=t==null?"float32":t,this.shape=e.shape,this.id=xz(),n=n==null?bR:n,this.originalName=kz(n),this.name=Sz(this.originalName),this.trainable_=r,this.constraint=a,this.val=HC(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),Zle(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error("LayersVariable ".concat(this.name," is already disposed."))}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}};function Zle(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}function hS(e){return e.map(t=>t.read())}function bE(e){e.forEach(t=>{t[0].write(t[1])})}var dn=class{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}},wi=class{constructor(e,t,n,r,a,i,s){this.dtype=e,this.shape=t,this.sourceLayer=n,this.inputs=r,this.callArgs=a,this.outputTensorIndex=s,this.id=xz(),i!=null&&(this.originalName=kz(i),this.name=Sz(this.originalName)),this.rank=t.length}},Qle=0,Qx=class{constructor(e,t){this.callArgs=t,this.id=Qle++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(let n of e.inboundLayers)n!=null&&n.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){let e=[];for(let t of this.inboundLayers)t!=null?e.push(t.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}},Jle=0,Qe=class extends le.Serializable{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=Jle++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let t=e.name;if(!t){let n=this.getClassName();t=bs(n)+"_"+Vx(n)}if(this.name=t,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let n;if(e.batchInputShape!=null)n=e.batchInputShape;else if(e.inputShape!=null){let a=null;e.batchSize!=null&&(a=e.batchSize),n=[a].concat(e.inputShape)}this.batchInputShape=n;let r=e.dtype;r==null&&(r=e.inputDType),r==null&&(r="float32"),this.dtype=r}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,t){return e.name+"_ib-"+t.toString()}getNodeAtIndex(e,t){if(this.inboundNodes.length===0)throw new xi("The layer has never been called and thus has no defined ".concat(t,"."));if(this.inboundNodes.length<=e)throw new X("Asked to get ".concat(t," at node ").concat(e,", but the layer has only ").concat(this.inboundNodes.length," inbound nodes."));return this.inboundNodes[e]}getInputAt(e){return Br(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return Br(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new ys("Layer ".concat(this.name,' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.'));if(this.inboundNodes.length===0)throw new ys("Layer ".concat(this.name," is not connected, no input to return."));return Br(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new ys("Layer ".concat(this.name," has no inbound nodes."));if(this.inboundNodes.length>1)throw new ys("Layer ".concat(this.name,' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.'));return Br(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(t=>t.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){if(e=Dt(e),this.inputSpec==null||this.inputSpec.length===0)return;let t=Dt(this.inputSpec);if(e.length!==t.length)throw new X("Layer ".concat(this.name," expects ").concat(t.length," inputs, but it received ").concat(e.length," input tensors. Input received: ").concat(e));for(let n=0;n<e.length;n++){let r=e[n],a=t[n];if(a==null)continue;let i=r.rank;if(a.ndim!=null&&i!==a.ndim)throw new X("Input ".concat(n," is incompatible with layer ").concat(this.name,": expected ndim=").concat(a.ndim,", found ndim=").concat(i));if(a.maxNDim!=null&&i>a.maxNDim)throw new X("Input ".concat(n," is incompatible with layer ").concat(this.name,": expected max_ndim=").concat(a.maxNDim,", found ndim=").concat(i));if(a.minNDim!=null&&i<a.minNDim)throw new X("Input ".concat(n," is incompatible with layer ").concat(this.name,": expected min_ndim=").concat(a.minNDim,", found ndim=").concat(i,"."));if(a.dtype!=null&&r.dtype!==a.dtype)throw new X("Input ".concat(n," is incompatible with layer ").concat(this.name," : expected dtype=").concat(a.dtype,", found dtype=").concat(r.dtype,"."));if(a.axes){let s=r.shape;for(let o in a.axes){let l=Number(o),c=a.axes[o],u=l>=0?s[l]:s[s.length+l];if(c!=null&&[c,null].indexOf(u)===-1)throw new X("Input ".concat(n," is incompatible with layer ").concat(this.name,": expected axis ").concat(l," of input shape to have value ").concat(c," but got shape ").concat(s,"."))}}if(a.shape!=null)for(let s=0;s<a.shape.length;++s){let o=a.shape[s],l=r.shape[s];if(o!=null&&l!=null&&o!==l)throw new X("Input ".concat(n," is incompatible with layer ").concat(this.name,": expected shape=").concat(a.shape,", found shape=").concat(r.shape,"."))}}}call(e,t){return e}invokeCallHook(e,t){this._callHook!=null&&this._callHook(e,t)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,t){t=t||{},this.assertNotDisposed();let n=Dt(e),r=!0;for(let i of n)if(!(i instanceof wi)){r=!1;break}let a=!0;for(let i of n)if(i instanceof wi){a=!1;break}if(r===a)throw new X("Arguments to apply() must be all SymbolicTensors or all Tensors");return Ol(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);let i=[];for(let s of Dt(e))i.push(s.shape);this.build(Br(i)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&a&&(this._refCount=1)}if(this.assertInputCompatibility(e),a){let i=this.call(e,t),s=Dt(i),o=[];for(let l of s)n.indexOf(l)!==-1&&(l=l.clone()),o.push(l);if(i=Br(o),this.activityRegularizer!=null)throw new Xe("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return i}else{let i=eue(e),s=this.computeOutputShape(i),o,l=tue(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?i[0]:i),s!=null&&s.length>0&&Array.isArray(s[0])?o=s.map((c,u)=>new wi(l,c,this,Dt(e),t,this.name,u)):o=new wi(l,s,this,Dt(e),t,this.name),this.addInboundNode(e,o,null,null,i,s,t),this._refCount++,this.activityRegularizer!=null)throw new Xe("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return o}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: ".concat(JSON.stringify(e),") does not match that of the batchInputShape (").concat(JSON.stringify(this.batchInputShape),") of the layer ").concat(this.name));else{let t=!1;this.batchInputShape.forEach((n,r)=>{n!=null&&e[r]!=null&&e[r]!==n&&(t=!0)}),t&&console.warn("The shape of the input tensor (".concat(JSON.stringify(e),") does not match the expectation of layer ").concat(this.name,": ").concat(JSON.stringify(this.batchInputShape)))}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new ys("The layer ".concat(this.name," has never been called and thus has no defined output shape."));let e=[];for(let t of this.inboundNodes){let n=JSON.stringify(t.outputShapes);e.indexOf(n)===-1&&e.push(n)}if(e.length===1){let t=this.inboundNodes[0].outputShapes;return Array.isArray(t)&&Array.isArray(t[0])&&t.length===1?t[0]:t}else throw new ys("The layer ".concat(this.name,' has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.'))}countParams(){if(!this.built)throw new xi("You tried to call countParams() on ".concat(this.name,", but the layer is not built yet. Build it first by calling build(batchInputShape)."));return Tv(this.weights)}build(e){this.built=!0}getWeights(e=!1){return hS(e?this.trainableWeights:this.weights)}setWeights(e){K(()=>{let t=this.weights;if(t.length!==e.length)throw new X('You called setWeights(weights) on layer "'.concat(this.name,'" with a weight list of length ').concat(e.length,", but the layer was expecting ").concat(t.length," weights. Provided weights: ").concat(e,"..."));if(t.length===0)return;let n=[],r=hS(t);for(let a=0;a<r.length;++a){let i=r[a],s=t[a],o=e[a];if(!k.arraysEqual(i.shape,o.shape))throw new X("Layer weight shape ".concat(i.shape," not compatible with provided weight shape ").concat(o.shape));n.push([s,o])}bE(n)})}addWeight(e,t,n,r,a,i,s,o){if(this._addedWeightNames.indexOf(e)!==-1)throw new X("Duplicate weight name ".concat(e," for layer ").concat(this.name));this._addedWeightNames.push(e),n==null&&(n="float32"),this.fastWeightInitDuringBuild&&(r=o!=null?o():Bt("zeros"));let l=r.apply(t,n),c=new Ez(l,n,e,i,s);return l.dispose(),a!=null&&this.addLoss(()=>a.apply(c.read())),i==null&&(i=!0),i?this._trainableWeights.push(c):this._nonTrainableWeights.push(c),c}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=Dt(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,t){if(!this.supportsMasking){if(t!=null)if(Array.isArray(t))t.forEach(n=>{if(n!=null)throw new TypeError("Layer ".concat(this.name," does not support masking, but was passed an inputMask."))});else throw new TypeError("Layer ".concat(this.name," does not support masking, but was passed an inputMask."));return null}return t}addInboundNode(e,t,n,r,a,i,s=null){let o=Dt(e);t=Dt(t),n=Dt(n),r=Dt(r),a=Ev(a),i=Ev(i);let l=[],c=[],u=[];for(let d of o)l.push(d.sourceLayer),c.push(d.nodeIndex),u.push(d.tensorIndex);new Qx({outboundLayer:this,inboundLayers:l,nodeIndices:c,tensorIndices:u,inputTensors:o,outputTensors:t,inputMasks:n,outputMasks:r,inputShapes:a,outputShapes:i},s);for(let d=0;d<t.length;d++)t[d].sourceLayer=this,t[d].nodeIndex=this.inboundNodes.length-1,t[d].tensorIndex=d}getConfig(){let e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error("Layer '".concat(this.name,"' is already disposed."))}dispose(){if(!this.built)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been built yet."));if(this._refCount===null)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been used yet."));this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}};function eue(e){e=Dt(e);let t=[];for(let n of e)t.push(n.shape);return Br(t)}function tue(e){return"float32"}function Tz(e,t,n){if((t==null||n!=null&&n>0)&&(t=e.sourceLayer,n=e.nodeIndex),t.inboundNodes.length===0)return[e];{let r=t.inboundNodes[n];if(r.inboundLayers.length===0)return r.inputTensors;{let a=[];for(let i=0;i<r.inboundLayers.length;i++){let s=r.inputTensors[i],o=r.inboundLayers[i],l=r.nodeIndices[i],c=Tz(s,o,l);for(let u of c)a.indexOf(u)===-1&&a.push(u)}return a}}}var Uh=class extends Qe{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:Vx("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new X("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let t=e.batchInputShape;if(t==null){if(e.inputShape==null)throw new X("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");t=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new X("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");let n=e.dtype||"float32";this.batchInputShape=t,this.dtype=n,this.inputSpec=[{shape:t}];let r=new wi(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new Qx({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[t],outputShapes:[t]})}apply(e,t){throw new X("Cannot pass any input to an InputLayer's apply() method. InputLayer name: ".concat(this.name))}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}};Uh.className="InputLayer";le.registerClass(Uh);function Nz(e){if(e.batchShape==null&&e.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(e.batchShape!=null&&e.shape!=null)throw new X("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let t=e.batchShape;e.shape!=null&&t==null&&(t=[null].concat(e.shape));let n=e.dtype;return n==null&&(n="float32"),new Uh({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}function nue(e,t){if(e.dtype==null||e.dtype===t.dtype)return t;try{return de(t,e.dtype)}catch(n){throw new X("The dtype of the feed (".concat(t.dtype,") can not be cast to the dtype of the key '").concat(e.name,"' (").concat(e.dtype,")."))}}var _l=class{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof _l)for(let t in e.id2Value)this.id2Value[t]=e.id2Value[t],t in e.id2Mask&&(this.id2Mask[t]=e.id2Mask[t]);else{if(e==null)return;for(let t of e)this.add(t.key,t.value)}}add(e,t,n){if(this.id2Value[e.id]==null)this.id2Value[e.id]=nue(e,t),this.name2Id[e.name]=e.id,n!=null&&(this.id2Mask[e.id]=n);else throw new X("Duplicate key: name=".concat(e.name,", id=").concat(e.id));return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof wi){if(this.id2Value[e.id]==null)throw new X("Nonexistent key: ".concat(e.name));return this.id2Value[e.id]}else{let t=this.name2Id[e];if(t==null)throw new X("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Value[t]}}getMask(e){if(e instanceof wi){if(this.id2Value[e.id]==null)throw new X("Nonexistent key: ".concat(e.name));return this.id2Mask[e.id]}else{let t=this.name2Id[e];if(t==null)throw new X("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Mask[t]}}disposeMasks(){this.id2Mask!=null&&We(this.id2Mask)}},Nv=new yz,_v=new yz;function rue(e){Nv!=null&&Nv.setMaxEntries(e),_v!=null&&_v.setMaxEntries(e)}function Cf(e,t,n,r){let a=n==null?!1:n.training,i=Array.isArray(e),s=i?e:[e],o=s.map(f=>f.name),l=[],c=t.names();for(let f of o)c.indexOf(f)!==-1?l.push(t.getValue(f)):l.push(null);r!=null&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);let u=o.join(",")+"|"+t.names().sort().join(","),d=Nv.get(u),p;if(d==null){let f=aue(s,t);d=f.sorted,p=f.recipientCounts,Nv.put(u,d),_v.put(u,p)}p={},a||Object.assign(p,_v.get(u));let h=new _l(t);for(let f=0;f<d.length;++f){if(r!=null){let _=$v().numTensors;_>r.maxNumTensors&&(r.maxNumTensors=_),_<r.minNumTensors&&(r.minNumTensors=_)}let m=d[f],g=m.sourceLayer;if(g instanceof Uh)continue;let y=[],b=[],v=[],x=!1;for(let _ of m.inputs){let R=h.getValue(_),N=h.getMask(_);y.push(R),b.push(N),N!=null&&(x=!0),a||(p[_.name]--,p[_.name]===0&&!t.hasKey(_)&&o.indexOf(_.name)===-1&&!R.isDisposed&&_.sourceLayer.stateful!==!0&&v.push(R))}x&&(n=n||{},n.mask=b[0]);let w=Dt(g.apply(y,n)),$=null;g.supportsMasking&&($=g.computeMask(y,b));let C=sue(m),E=Array.isArray(C)?C:[C];for(let _=0;_<E.length;++_){h.hasKey(E[_])||h.add(E[_],w[_],Array.isArray($)?$[0]:$);let R=o.indexOf(E[_].name);R!==-1&&(l[R]=w[_])}a||We(v)}return h.disposeMasks(),i?l:l[0]}function aue(e,t){k.assert(e!=null&&e.length>0,()=>"Expected at least one fetch, got none");let n=[],r={};if(e.length===1){let a=vR(e[0],t);n=a.sorted,r=a.recipientMap}else{let a=new Set;for(let i of e){let{sorted:s,recipientMap:o}=vR(i,t);for(let l of s)a.has(l.name)||(n.push(l),a.add(l.name));for(let l in o)r[l]==null&&(r[l]=new Set),o[l].forEach(c=>r[l].add(c))}}return{sorted:n,recipientCounts:iue(r)}}function iue(e){let t={};for(let n in e)t[n]=e[n].size;return t}function vR(e,t){let n=new Set,r=[],a={};for(let o of t.names())n.add(o);let i=[],s=[];for(i.push(e);i.length>0;){let o=i[i.length-1];if(n.has(o.name)){i.pop();continue}let l=s[s.length-1]===i.length-1;if(o.inputs.length===0||l)i.pop(),r.push(o),n.add(o.name),l&&s.pop();else{s.push(i.length-1);for(let c of o.inputs)a[c.name]==null&&(a[c.name]=new Set),a[c.name].add(o.name),!n.has(c.name)&&i.push(c)}}return{sorted:r,recipientMap:a}}function sue(e){let t;if(e.sourceLayer.inboundNodes.length===1)t=e.sourceLayer.output;else{let n=null;for(let r=0;r<e.sourceLayer.inboundNodes.length;++r)for(let a of e.sourceLayer.inboundNodes[r].outputTensors)if(a.id===e.id){n=r;break}t=e.sourceLayer.getOutputAt(n)}return t}var oue=Z();oue.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,rue);var _z={};Ue(_z,{maxNorm:()=>lue,minMaxNorm:()=>due,nonNeg:()=>cue,unitNorm:()=>uue});function vE(e,t){return K(()=>Kn(Se(G(e,e),t,!0)))}var Gg=class extends le.Serializable{getConfig(){return{}}},xE=class extends Gg{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return K(()=>{let t=vE(e,this.axis),n=lr(t,0,this.maxValue);return G(e,ke(n,ne(kn(),t)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}};xE.className="MaxNorm";le.registerClass(xE);var wE=class extends Gg{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return K(()=>ke(e,ne(kn(),vE(e,this.axis))))}getConfig(){return{axis:this.axis}}};wE.className="UnitNorm";le.registerClass(wE);var kE=class extends Gg{apply(e){return ft(e)}};kE.className="NonNeg";le.registerClass(kE);var SE=class extends Gg{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return K(()=>{let t=vE(e,this.axis),n=ne(G(this.rate,lr(t,this.minValue,this.maxValue)),G(1-this.rate,t));return G(e,ke(n,ne(kn(),t)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}};SE.className="MinMaxNorm";le.registerClass(SE);var xR={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function $n(e){return lE(e)}function wR(e,t={}){return Ug(e,le.SerializationMap.getMap().classNameMap,t,"constraint")}function Cn(e){if(e==null)return null;if(typeof e=="string"){let t={className:e in xR?xR[e]:e,config:{}};return wR(t)}else return e instanceof Gg?e:wR(e)}function lue(e){return new xE(e)}function uue(e){return new wE(e)}function cue(){return new kE}function due(e){return new SE(e)}var Az={};Ue(Az,{constant:()=>fue,glorotNormal:()=>wue,glorotUniform:()=>xue,heNormal:()=>kue,heUniform:()=>Sue,identity:()=>bue,leCunNormal:()=>Iue,leCunUniform:()=>$ue,ones:()=>hue,orthogonal:()=>Cue,randomNormal:()=>gue,randomUniform:()=>mue,truncatedNormal:()=>yue,varianceScaling:()=>vue,zeros:()=>pue});function pue(){return new dE}function hue(){return new jx}function fue(e){return new pE(e)}function mue(e){return new hE(e)}function gue(e){return new fE(e)}function yue(e){return new mE(e)}function bue(e){return new gE(e)}function vue(e){return new jr(e)}function xue(e){return new Gx(e)}function wue(e){return new qx(e)}function kue(e){return new Kx(e)}function Sue(e){return new Xx(e)}function Iue(e){return new Yx(e)}function $ue(e){return new Zx(e)}function Cue(e){return new yE(e)}var Rz={};Ue(Rz,{Layer:()=>Qe,RNN:()=>cs,RNNCell:()=>Zg,activation:()=>ede,add:()=>ude,alphaDropout:()=>Gde,average:()=>cde,averagePooling1d:()=>F2,averagePooling2d:()=>M2,averagePooling3d:()=>O2,avgPool1d:()=>vde,avgPool2d:()=>wde,avgPool3d:()=>Sde,avgPooling1d:()=>xde,avgPooling2d:()=>kde,avgPooling3d:()=>Ide,batchNormalization:()=>gde,bidirectional:()=>Pde,categoryEncoding:()=>Zde,centerCrop:()=>Xde,concatenate:()=>dde,conv1d:()=>jce,conv2d:()=>Gce,conv2dTranspose:()=>qce,conv3d:()=>Kce,conv3dTranspose:()=>Xce,convLstm2d:()=>Fde,convLstm2dCell:()=>Mde,cropping2D:()=>Zce,dense:()=>tde,depthwiseConv2d:()=>Jce,dot:()=>mde,dropout:()=>nde,elu:()=>zce,embedding:()=>lde,flatten:()=>ade,gaussianDropout:()=>jde,gaussianNoise:()=>Hde,globalAveragePooling1d:()=>$de,globalAveragePooling2d:()=>Cde,globalMaxPool1d:()=>Bde,globalMaxPool2d:()=>Wde,globalMaxPooling1d:()=>$B,globalMaxPooling2d:()=>CB,gru:()=>Tde,gruCell:()=>Nde,input:()=>Yz,inputLayer:()=>Pce,layerNormalization:()=>yde,leakyReLU:()=>Wce,lstm:()=>_de,lstmCell:()=>Ade,masking:()=>qde,maxPool1d:()=>Ude,maxPool2d:()=>Vde,maxPooling1d:()=>EB,maxPooling2d:()=>TB,maxPooling3d:()=>Ede,maximum:()=>pde,minimum:()=>hde,multiply:()=>fde,permute:()=>ode,prelu:()=>Uce,randomWidth:()=>Qde,reLU:()=>Bce,repeatVector:()=>ide,rescaling:()=>Kde,reshape:()=>sde,resizing:()=>Yde,rnn:()=>Ode,separableConv2d:()=>Yce,simpleRNN:()=>Rde,simpleRNNCell:()=>Dde,softmax:()=>Vce,spatialDropout1d:()=>rde,stackedRNNCells:()=>Lde,thresholdedReLU:()=>Hce,timeDistributed:()=>zde,upSampling2d:()=>Qce,zeroPadding2d:()=>bde});async function Zs(e){if(e==null)return;let t=[],n=[],r=[];for(let a in e){let i=e[a];if(typeof i!="number"){let s=i;t.push(s.data()),n.push(a),r.push(s)}}if(t.length>0){let a=await Promise.all(t);for(let i=0;i<a.length;++i)e[n[i]]=a[i][0];We(r)}}function Dz(e){if(e!=null)for(let t in e){let n=e[t];typeof n!="number"&&n.dispose()}}var kR;(function(e){e[e.SILENT=0]="SILENT",e[e.VERBOSE=1]="VERBOSE"})(kR||(kR={}));var Eue=125,mp=class{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,t){}async onEpochEnd(e,t){}async onBatchBegin(e,t){}async onBatchEnd(e,t){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}},Fz=class{constructor(e,t=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=t}append(e){this.callbacks.push(e)}setParams(e){for(let t of this.callbacks)t.setParams(e)}setModel(e){for(let t of this.callbacks)t.setModel(e)}async onEpochBegin(e,t){t==null&&(t={});for(let n of this.callbacks)await n.onEpochBegin(e,t)}async onEpochEnd(e,t){t==null&&(t={});for(let n of this.callbacks)await n.onEpochEnd(e,t)}async onBatchBegin(e,t){t==null&&(t={});for(let n of this.callbacks)await n.onBatchBegin(e,t)}async onBatchEnd(e,t){t==null&&(t={});for(let n of this.callbacks)await n.onBatchEnd(e,t)}async onTrainBegin(e){e==null&&(e={});for(let t of this.callbacks)await t.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(let t of this.callbacks)await t.onTrainEnd(e)}},Tue=class extends mp{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,t){t==null&&(t={});let n=t.size==null?0:t.size;this.seen+=n;for(let r in t){let a=t[r];if(typeof a=="number")this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+a*n;else{let i;r in this.totals?i=this.totals[r]:this.totals[r]=0;let s=K(()=>ne(this.totals[r],G(a,n)));this.totals[r]=s,i!=null&&i.dispose()}}}async onEpochEnd(e,t){if(t!=null)for(let n of this.params.metrics)this.totals[n]!=null&&(typeof this.totals[n]=="number"?t[n]=this.totals[n]/this.seen:K(()=>{let r=G(ke(1,this.seen),this.totals[n]);t[n]=r,this.totals[n].dispose(),wn(t[n])}))}},Mz=class extends mp{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,t){t==null&&(t={}),this.epoch.push(e);for(let n in t)this.history[n]==null&&(this.history[n]=[]),this.history[n].push(t[n])}async syncData(){let e=[],t=[],n=[];for(let a in this.history){let i=this.history[a];for(let s=0;s<i.length;++s)if(typeof i[s]!="number"){let o=i[s];e.push(o.data()),t.push(a),n.push(s)}}let r=await Promise.all(e);for(let a=0;a<r.length;++a)this.history[t[a]][n[a]].dispose(),this.history[t[a]][n[a]]=r[a][0]}},Oz=class extends mp{constructor(e,t){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||sE,this.yieldEvery=t||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=Eue),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");k.isNumber(this.yieldEvery)&&(this.maybeWait=Nle(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,t,n){let r=[];this.yield!=null&&(await Zs(n),r.push(this.yield(e,t,n))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(e,t){this.currentEpoch=e,this.epochBegin!=null&&(await Zs(t),await this.epochBegin(e,t))}async onEpochEnd(e,t){let n=[];this.epochEnd!=null&&(await Zs(t),n.push(this.epochEnd(e,t))),this.yieldEvery==="epoch"&&n.push(this.nextFrameFunc()),await Promise.all(n)}async onBatchBegin(e,t){this.batchBegin!=null&&(await Zs(t),await this.batchBegin(e,t))}async onBatchEnd(e,t){let n=[];this.batchEnd!=null&&(await Zs(t),n.push(this.batchEnd(e,t))),this.yieldEvery==="batch"?n.push(this.nextFrameFunc()):k.isNumber(this.yieldEvery)&&n.push(this.maybeWait(this.currentEpoch,e,t)),await Promise.all(n)}async onTrainBegin(e){this.trainBegin!=null&&(await Zs(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await Zs(e),await this.trainEnd(e))}};function Lz(e,t){return e==null&&(e={}),e instanceof mp?[e]:Array.isArray(e)&&e[0]instanceof mp?e:Dt(e).map(n=>new Oz(n,t))}var Ha=class{constructor(){}static registerCallbackConstructor(e,t){k.assert(e>=0&&Number.isInteger(e),()=>"Verbosity level is expected to be an integer >= 0, but got ".concat(e)),Ha.checkForDuplicate(t),Ha.constructors[e]==null&&(Ha.constructors[e]=[]),Ha.constructors[e].push(t)}static checkForDuplicate(e){for(let t in Ha.constructors)Ha.constructors[+t].forEach(n=>{if(n===e)throw new X("Duplicate callback constructor.")})}static clear(){Ha.constructors={}}static createCallbacks(e){let t=[];for(let n in Ha.constructors){let r=+n;e>=r&&t.push(...Ha.constructors[r])}return t.map(n=>new n)}};Ha.constructors={};function Pz(e,t,n,r,a,i,s,o,l){let c=new Mz,u=[new Tue,...Ha.createCallbacks(t)];e!=null&&u.push(...e),u.push(c);let d=new Fz(u);return d.setParams({epochs:n,initialEpoch:r,samples:a,steps:i,batchSize:s,verbose:t,doValidation:o,metrics:l}),{callbackList:d,history:c}}function Ti(e,t={},n=!1){return Ug(e,le.SerializationMap.getMap().classNameMap,t,"layer",n)}function Av(e,t){return K(()=>{e.dtype!=="float32"&&(e=de(e,"float32"));let n=Se(Hg(e),t,!0),r=da(n.shape,kn()),a=Kn(ls(n,r));return ke(e,a)})}function Hc(e,t){return K(()=>Gt(Hg(xe(t,e)),-1))}function Jx(e,t){return K(()=>Gt(un(xe(t,e)),-1))}function Vh(e,t){return K(()=>{let n=xe(e,t),r=lr(un(e),kn(),Number.MAX_VALUE),a=un(ke(n,r));return G(100,Gt(a,-1))})}function Nue(e,t){return K(()=>{let n=lr(t,kn(),Number.MAX_VALUE),r=fa(ne(1,n)),a=lr(e,kn(),Number.MAX_VALUE),i=fa(ne(1,a));return Gt(Hg(xe(r,i)),-1)})}function _ue(e,t){return K(()=>{let n=ls(0,xe(1,G(e,t)));return Gt(Hg(n),-1)})}function Aue(e,t){return K(()=>{let n=ls(0,xe(1,G(e,t)));return Gt(n,-1)})}function Rue(e,t){return K(()=>{let n=Se(G(e,t),-1),r=_a(G(xe(1,e),t),-1);return ls(0,ne(1,xe(r,n)))})}function Due(e,t){return K(()=>{let n=Math.log(2),r=xe(t,e),a=xe(ne(r,Wc(G(-2,r))),n);return Gt(a,-1)})}function _m(e,t,n=!1){return K(()=>{if(n)t=Jo(t);else{let r=Se(t,t.shape.length-1,!0);t=ke(t,r)}return t=lr(t,kn(),1-kn()),_t(Se(G(de(e,"float32"),fa(t)),t.shape.length-1))})}function Rv(e,t,n=!1){return K(()=>{let r=de(Lh(Wle(e)),"int32");t=lr(t,kn(),1-kn());let a=t.shape,i=q(lp(r,a[a.length-1]),a);return _m(i,t,n)})}function Fue(e,t){if(!k.arraysEqual(e.shape,t.shape))throw new X("logits and labels must have the same shape, but got shapes ".concat(JSON.stringify(e.shape)," and ").concat(JSON.stringify(t.shape)));return K(()=>{let n=ft(t),r=_t(un(t));return ne(xe(n,G(t,e)),Dg(Cr(r)))})}function ew(e,t){return K(()=>{let n;return n=lr(t,kn(),1-kn()),n=fa(ke(n,xe(1,n))),Gt(Fue(e,n),-1)})}function Mue(e,t){return K(()=>{let n=lr(e,kn(),1),r=lr(t,kn(),1);return Se(G(e,fa(ke(n,r))),-1)})}function Oue(e,t){return K(()=>{let n=fa(ne(kn(),t));return Gt(xe(t,G(e,n)),-1)})}function IE(e,t){return K(()=>{let n=Av(e,-1),r=Av(t,-1),a=G(n,r);return _t(Se(a,-1))})}var Dv={meanSquaredError:Hc,meanAbsoluteError:Jx,meanAbsolutePercentageError:Vh,meanSquaredLogarithmicError:Nue,squaredHinge:_ue,hinge:Aue,categoricalHinge:Rue,logcosh:Due,categoricalCrossentropy:_m,sparseCategoricalCrossentropy:Rv,binaryCrossentropy:ew,kullbackLeiblerDivergence:Mue,poisson:Oue,cosineProximity:IE};function k1(e){if(typeof e=="string"){if(e in Dv)return Dv[e];let t="Unknown loss ".concat(e);throw e.toLowerCase().includes("softmaxcrossentropy")&&(t="Unknown loss ".concat(e,'. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy')),new X(t)}else return e}function $E(e,t){return K(()=>{let n=G(.5,ma(t)),r=Ls(Dr(t,n),e.dtype);return Gt(ha(e,r),-1)})}function CE(e,t){return K(()=>Ls(ha(nu(e,-1),nu(t,-1)),"float32"))}function zz(e,t){return K(()=>de(Se(ti(ha(e,1),ha(t,1))),"float32"))}function Lue(e,t){return K(()=>de(Se(ti(ha(e,1),ha(t,0))),"float32"))}function Pue(e,t){return K(()=>de(Se(ti(ha(e,0),ha(t,1))),"float32"))}function Bz(e,t){return K(()=>{let n=zz(e,t),r=Pue(e,t),a=ne(n,r);return de(Pn(Dr(a,0),ke(n,a),0),"float32")})}function zue(e,t){return K(()=>{let n=zz(e,t),r=Lue(e,t),a=ne(n,r);return de(Pn(Dr(a,0),ke(n,a),0),"float32")})}function Wz(e,t){return ew(e,t)}function Uz(e,t){return e.rank===t.rank&&(e=el(e,[e.rank-1])),t=nu(t,-1),t.dtype!==e.dtype&&(t=de(t,e.dtype)),de(ha(e,t),"float32")}var Bue=Hc,Wue=Hc,Uue=Jx,Vue=Jx,Hue=Vh,jue=Vh,EE=_m,Gue=IE,Vz=Rv,Fv={binaryAccuracy:$E,categoricalAccuracy:CE,precision:Bz,categoricalCrossentropy:EE,sparseCategoricalCrossentropy:Vz,mse:Bue,MSE:Wue,mae:Uue,MAE:Vue,mape:Hue,MAPE:jue,cosine:Gue};function que(e){if(typeof e=="string"&&e in Fv)return Fv[e];if(typeof e!="string"&&e!=null)return e;throw new X("Unknown metric ".concat(e))}function qy(e){if(Ki(e!==null,"Unknown LossOrMetricFn ".concat(e)),typeof e=="string")return e;{let t;for(let n of Object.keys(Dv))if(Dv[n]===e){t=n;break}if(t!==void 0)return t;for(let n of Object.keys(Fv))if(Fv[n]===e){t=n;break}return t!==void 0?t:e.name}}function Kue(e){let t={Adagrad:()=>bl.adagrad(.01),Adadelta:()=>bl.adadelta(1,.95,kn()),Adam:()=>bl.adam(.001,.9,.999,kn()),Adamax:()=>bl.adamax(.002,.9,.999,kn(),0),RMSProp:()=>bl.rmsprop(.001,.9,0,kn()),SGD:()=>bl.sgd(.01)};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new X("Unknown Optimizer ".concat(e))}function SR(e,t,n=!1){if(e==null||typeof e!="object"||Object.getPrototypeOf(e)!==Object.prototype||!fS(e))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){let r=JSON.stringify(e);r.length>1048576&&console.warn('User-defined metadata of model "'.concat(t,'" is too large in size (length=').concat(r.length," when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= 1048576."))}}function fS(e){if(e===null)return!0;if(typeof e=="object")if(Object.getPrototypeOf(e)===Object.prototype){let t=Object.keys(e);for(let n of t)if(typeof n!="string"||!fS(e[n]))return!1;return!0}else if(Array.isArray(e)){for(let t of e)if(!fS(t))return!1;return!0}else return!1;else{let t=typeof e;return t==="string"||t==="number"||t==="boolean"}}function Xue(e,t,n,r=console.log){let a=Zue(e),i=["Layer (type)","Input Shape","Output shape","Param #"];a?(t=t||90,n=n||[.32,.61,.89,1]):(t=t||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(u=>Math.floor(t*u)));let s;if(!a){i.push("Receives inputs"),s=[];for(let u in e.nodesByDepth)s.push(...e.nodesByDepth[u])}r("_".repeat(t)),Mv(i,n,r),r("=".repeat(t));let o=e.layers;for(let u=0;u<o.length;++u)a?Que(o[u],n,r):Jue(o[u],n,s,r),r((u===o.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();let l=Yue(e),c=Tv(e.nonTrainableWeights);r("Total params: ".concat(l+c)),r("Trainable params: ".concat(l)),r("Non-trainable params: ".concat(c)),r("_".repeat(t))}function Yue(e){let t;return e.collectedTrainableWeights!=null?t=Tv(e.collectedTrainableWeights):t=Tv(e.trainableWeights),t}function Zue(e){let t=!0,n=[],r=[];for(let a in e.nodesByDepth)n.push(e.nodesByDepth[a]);for(let a of n){if(a.length>1||a.length===1&&a[0].inboundLayers.length>1){t=!1;break}r.push(...a)}if(t)for(let a of e.layers){let i=!1;for(let s of a.inboundNodes)if(r.indexOf(s)!==-1)if(i){t=!1;break}else i=!0;if(!t)break}return t}function Mv(e,t,n=console.log){let r="";for(let a=0;a<e.length;++a)a>0&&(r=r.slice(0,r.length-1)+" "),r+=e[a],r=r.slice(0,t[a]),r+=" ".repeat(t[a]-r.length);n(r)}function Que(e,t,n){let r,a;try{a=e.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch(l){a="multiple"}try{r=JSON.stringify(e.outputShape)}catch(l){r="multiple"}let i=e.name,s=e.getClassName(),o=["".concat(i," (").concat(s,")"),a,r,e.countParams().toString()];Mv(o,t,n)}function Jue(e,t,n,r){let a,i;try{i=e.inboundNodes.map(d=>JSON.stringify(d.inputShapes)).join(",")}catch(d){i="multiple"}try{a=JSON.stringify(e.outputShape)}catch(d){a="multiple"}let s=[];for(let d of e.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(d)===-1))for(let p=0;p<d.inboundLayers.length;++p){let h=d.inboundLayers[p].name,f=d.nodeIndices[p],m=d.tensorIndices[p];s.push("".concat(h,"[").concat(f,"][").concat(m,"]"))}let o=e.name,l=e.getClassName(),c=s.length===0?"":s[0],u=["".concat(o," (").concat(l,")"),i,a,e.countParams().toString(),c];Mv(u,t,r);for(let d=1;d<s.length;++d)Mv(["","","","",s[d]],t,r)}function Hz(e,t,n){return(e==="inboundNodes"||e==="outputLayers"||e==="inputLayers")&&t===0&&typeof n=="string"}function Am(e,t){if(e===null)return null;if(typeof e=="string")return kl(e);if(typeof e=="number"||typeof e=="boolean")return e;if(e instanceof Array){let n=[],r=e.length;for(let a=0;a<r;++a){let i=e[a];Hz(t,a,i)?n.push(i):n.push(Am(i,t))}return n}else{let n={};for(let r of Object.keys(e)){let a=e[r];if(r==="name"&&typeof a=="string")n[r]=a;else{let i=kl(r);n[i]=Am(a,i)}}return n}}function mS(e,t){if(e==null)return null;if(typeof e=="string")return bs(e);if(typeof e=="number"||typeof e=="boolean")return e;if(e instanceof Array){let n=[],r=e.length;for(let a=0;a<r;++a){let i=e[a];Hz(t,a,i)?n.push(i):n.push(mS(i,t))}return n}else{let n={};for(let r of Object.keys(e)){let a=e[r],i=bs(r);(r==="name"||r==="className")&&typeof a=="string"?n[i]=a:n[i]=mS(a,r)}return n}}var TE="4.7.0",Hi=class extends Qe{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){let y=this.getClassName().toLowerCase();this.name=Vx(y)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],So(this.inputs).length!==this.inputs.length)throw new X("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ".concat(this.inputs.map(y=>y.name)));So(this.outputs).length!==this.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ".concat(this.outputs.map(y=>y.name))),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(let y of this.outputs){let b=y.sourceLayer,v=y.nodeIndex,x=y.tensorIndex;this.outputLayers.push(b),this.outputLayersNodeIndices.push(v),this.outputLayersTensorIndices.push(x)}for(let y of this.inputs){let b=y.sourceLayer,v=y.nodeIndex,x=y.tensorIndex;Ki(v===0,"input layer has >1 nodes"),Ki(x===0,"input layer has >1 tensors"),this.inputLayers.push(b),this.inputLayersNodeIndices.push(v),this.inputLayersTensorIndices.push(x)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let y=0;y<this.inputLayers.length;y++){let b=this.inputLayers[y];if(!(b instanceof Uh))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. Received inputs: ".concat(e.inputs,". Input ").concat(y," (0-based) originates from layer type ").concat(b.getClassName(),"."));this.inputNames.push(b.name),this.feedInputShapes.push(b.batchInputShape),this.feedInputNames.push(b.name)}for(let y of this.outputLayers)this.outputNames.push(y.name);this.internalInputShapes=this.inputs.map(y=>y.shape),this.internalOutputShapes=this.outputs.map(y=>y.shape);let t={},n={},r={},a={},i={},s=[],o=(y,b,v,x,w,$)=>{(x==null||w==null||$==null)&&(x=y.sourceLayer,w=y.nodeIndex,$=y.tensorIndex);let C=x.inboundNodes[w];if(v.indexOf(C)!==-1)throw new xi("The tensor ".concat(y.name,' at layer "').concat(x.name,'" is part of a cycle.'));if(b.indexOf(C)!==-1)return;this.containerNodes.add(Hi.nodeKey(x,w)),x.id in i||(i[x.id]=Object.keys(i).length),v.indexOf(C)===-1&&v.push(C);let E=C.inboundLayers.length;for(let _=0;_<E;_++){let R=C.inputTensors[_],N=C.inboundLayers[_],I=C.nodeIndices[_],O=C.tensorIndices[_];o(R,b,v,N,I,O)}for(b.push(C);v.indexOf(C)>=0;)v.splice(v.indexOf(C),1);s.push(C)},l=[],c=[];for(let y of this.outputs)o(y,l,c);let u=s.slice().reverse();for(let y of u){n[y.id]=y,y.id in t||(t[y.id]=0);let b=t[y.id],v=r[y.outboundLayer.id]==null?0:r[y.outboundLayer.id];b=Math.max(b,v),r[y.outboundLayer.id]=b,a[y.outboundLayer.id]=y.outboundLayer,t[y.id]=b;for(let x=0;x<y.inboundLayers.length;x++){let w=y.inboundLayers[x],$=y.nodeIndices[x],C=w.inboundNodes[$],E=t[C.id]==null?0:t[C.id];t[C.id]=Math.max(b+1,E),n[C.id]=C}}let d={};for(let y in t){let b=t[y];b in d||(d[b]=[]),d[b].push(n[y])}let p={};for(let y in r){let b=r[y];b in p||(p[b]=[]),p[b].push(a[y])}let h=Object.keys(p).map(y=>parseInt(y,10)).sort(Hy);this.layers=[];for(let y of h){let b=p[y];b.sort((v,x)=>{let w=i[v.id],$=i[x.id];return w<$?-1:w>$?1:0});for(let v of b)v instanceof Hi&&this.internalContainerRefs.push(v),this.layers.push(v)}this.layersByDepth=p,h=Object.keys(d).map(y=>parseInt(y,10)).sort(Hy);let f=this.inputs.slice(),m=[];for(let y of h)for(let b of d[y]){let v=b.outboundLayer;if(v!=null){for(let x of b.inputTensors)if(f.indexOf(x)===-1)throw new xi("Graph disconnected: cannot obtain value for tensor ".concat(x,' at layer "').concat(v.name,'". The following previous layers were accessed without issue: ').concat(m));for(let x of b.outputTensors)f.push(x);m.push(v.name)}}this.nodesByDepth=d;let g=this.layers.map(y=>y.name);for(let y of g){let b=g.filter(v=>v===y).length;if(b!==1)throw new xi('The name "'.concat(y,'" is used ').concat(b," times in the model. All layer names should be unique. Layer names: ")+JSON.stringify(g))}this.outboundNodes=[],this.inboundNodes=[],new Qx({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(y=>null),outputMasks:this.outputs.map(y=>null),inputShapes:this.inputs.map(y=>y.shape),outputShapes:this.outputs.map(y=>y.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error("Container '".concat(this.name,"' is already disposed."))}dispose(){this.assertNotDisposed();let e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(let t of this.layers)e.numDisposedVariables+=t.dispose().numDisposedVariables;for(let t of this.internalContainerRefs)e.numDisposedVariables+=t.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(t=>{t._trainableWeights.forEach(n=>n.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new X("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(let t of this.layers)e=e.concat(t.trainableWeights);return e}get nonTrainableWeights(){let e=[];for(let t of this.layers)e.push(...t.nonTrainableWeights);if(!this.trainable){let t=[];for(let n of this.layers)t.push(...n.trainableWeights);return t.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,t=!0){let n={},r=0;for(let i of this.layers)for(let s of i.weights){if(n[s.originalName]!=null)throw new X("Duplicate weight name: ".concat(s.originalName));n[s.originalName]=s,r++}let a=[];for(let i in e){let s=i;if(n[i]==null){let o=i.split("/");s=o.slice(0,-2).concat([o[o.length-1]]).join("/")}if(n[s]!=null)a.push([n[s],e[i]]);else if(t)throw new X("Provided weight data has no target variable: ".concat(i));delete n[s]}if(t){let i=[];for(let s in n)i.push(s);if(i.length>0)throw new X("".concat(i.length," of ").concat(r," weights are not set: ").concat(i))}bE(a)}updatedConfig(){let e=this.getConfig(),t={};return t.className=this.getClassName(),t.config=e,t.kerasVersion="tfjs-layers ".concat(TE),t.backend="TensorFlow.js",t}toJSON(e,t=!0){let n=mS(this.updatedConfig());return t?JSON.stringify(n):n}call(e,t){return K(()=>{e=Dt(e);let n=new _l;for(let r=0;r<this.inputs.length;++r)n.add(this.inputs[r],e[r]);return Cf(this.outputs,n,t)})}computeMask(e,t){return K(()=>{e=Dt(e);let n;return t==null?n=lu(null,e.length):n=Dt(t),this.runInternalGraph(e,n)[1]})}computeOutputShape(e){let t=Ev(e);if(t.length!==this.inputLayers.length)throw new X("Invalid inputShape argument ".concat(e,": model has ").concat(this.inputLayers.length," tensor inputs."));let n={};for(let s=0;s<t.length;s++){let o=this.inputLayers[s],l=t[s],c=o.name+"_0_0";n[c]=l}let r=Object.keys(this.nodesByDepth).map(s=>parseInt(s,10)).sort(Hy);if(r.length>1)for(let s of r){let o=this.nodesByDepth[s];for(let l of o){let c=l.outboundLayer;if(this.inputLayers.map(f=>f.id).indexOf(c.id)!==-1)continue;let u=[];for(let f=0;f<l.inboundLayers.length;f++){let m=l.inboundLayers[f],g=l.nodeIndices[f],y=l.tensorIndices[f],b="".concat(m.name,"_").concat(g,"_").concat(y),v=n[b];u.push(v)}let d=c.computeOutputShape(Br(u)),p=Ev(d),h=c.inboundNodes.indexOf(l);for(let f=0;f<p.length;f++){let m="".concat(c.name,"_").concat(h,"_").concat(f);n[m]=p[f]}}}let a=[],i=[];for(let s=0;s<this.outputLayers.length;s++){let o=this.outputLayers[s],l=this.outputLayersNodeIndices[s],c=this.outputLayersTensorIndices[s],u="".concat(o.name,"_").concat(l,"_").concat(c);i.push(u)}for(let s=0;s<i.length;s++){let o=i[s];Ki(o in n),a.push(n[o])}return Br(a)}runInternalGraph(e,t){t==null&&(t=lu(null,e.length));let n={};for(let o=0;o<this.inputs.length;++o){let l=this.inputs[o],c=e[o],u=t[o];n[l.id]=[c,u]}let r=Object.keys(this.nodesByDepth).map(o=>parseInt(o,10)).sort(Hy);for(let o of r){let l=this.nodesByDepth[o];for(let c of l){let u=c.outboundLayer,d=c.inputTensors,p=c.outputTensors,h=new Array;for(let f of d)f.id in n&&h.push(n[f.id]);if(h.length===d.length){let f={},m,g,y,b;if(c.callArgs!=null&&(f=c.callArgs),h.length===1){let[v,x]=h[0];f.mask==null&&(f.mask=x),y=Dt(u.call(v,f)),b=Dt(u.computeMask(v,x)),m=[v],g=[x]}else m=h.map(v=>v[0]),g=h.map(v=>v[1]),f.mask==null&&(f.mask=g),y=Dt(u.call(m,f)),b=Dt(u.computeMask(m,g));if(u.activityRegularizer)throw new Xe("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let v=0;v<p.length;++v){let x=p[v],w=y[v],$=b[v];n[x.id]=[w,$]}}}}let a=[],i=[],s=[];for(let o of this.outputs){Ki(o.id in n,"Could not compute output ".concat(o.name," : ").concat(o.id));let[l,c]=n[o.id];s.push(l.shape),a.push(l),i.push(c)}return[a,i,s]}buildNodeConversionMap(e){let t={},n;for(let r of this.layers){n=r instanceof Hi?1:0;for(let a=0;a<r.inboundNodes.length;a++){let i=Hi.nodeKey(r,a);this.containerNodes.has(i)&&(t[i]=n,n+=1)}}return t}getLayer(e,t){if(t!=null)return this.findLayer(t);if(e==null)throw new X("Provide either a layer name or layer index");if(typeof e=="number")return this.findLayer(e);for(let n of this.layers)if(n.name===e)return n;throw new X("No such layer: ".concat(e))}findLayer(e){if(this.layers.length<=e)throw new X("Was asked to retrieve layer at index ".concat(e,", but model only has ").concat(this.layers.length," layer(s)."));return this.layers[e]}calculateLosses(){return K(()=>{let e=[];for(let t of this.layers)for(let n=0;n<t.inboundNodes.length;++n){let r=Hi.nodeKey(t,n);this.containerNodes.has(r)&&e.push(...t.calculateLosses())}return e})}getConfig(){let e={name:this.name},t=this.buildNodeConversionMap(this.layers),n=[];for(let i of this.layers){let s=i.getClassName(),o=i.getConfig(),l=[];for(let u=0;u<i.inboundNodes.length;u++){let d=i.inboundNodes[u],p=Hi.nodeKey(i,u),h={};if(this.containerNodes.has(p)){if(d.callArgs)try{JSON.stringify(d.callArgs),h=d.callArgs}catch(f){console.warn("Layer ".concat(i.name," was passed non-serializable keyword arguments: ").concat(d.callArgs,". They will not be included in the serialized model (and thus will be missing at deserialization time).")),h={}}if(d.inboundLayers.length>0){let f=[];for(let m=0;m<d.inboundLayers.length;m++){let g=d.inboundLayers[m],y=d.nodeIndices[m],b=d.tensorIndices[m],v=Hi.nodeKey(g,y),x=t[v];x==null&&(x=0),f.push([g.name,x,b,h])}l.push(f)}}}let c={};c.name=i.name,c.className=s,c.config=o,c.inboundNodes=l,n.push(c)}e.layers=n;let r=[];for(let i=0;i<this.inputLayers.length;i++){let s=this.inputLayers[i],o=this.inputLayersNodeIndices[i],l=Hi.nodeKey(s,o);if(!this.containerNodes.has(l))continue;let c=t[l];c==null&&(c=0);let u=this.inputLayersTensorIndices[i];r.push([s.name,c,u])}e.inputLayers=r;let a=[];for(let i=0;i<this.outputLayers.length;i++){let s=this.outputLayers[i],o=this.outputLayersNodeIndices[i],l=Hi.nodeKey(s,o);if(!this.containerNodes.has(l))continue;let c=t[l];c==null&&(c=0);let u=this.outputLayersTensorIndices[i];a.push([s.name,c,u])}return e.outputLayers=a,e}static fromConfig(e,t,n={},r=!1){let a={},i={};function s(m,g){m.name in i?i[m.name].push(g):i[m.name]=[g]}function o(m,g){let y=[],b;for(let v of g){let x=v[0],w=v[1],$=v[2];if(b=v[3]==null?{}:v[3],!(x in a)){s(m,g);return}let C=a[x];if(C.inboundNodes.length<=w){s(m,g);return}let E=C.inboundNodes[w];y.push(E.outputTensors[$])}y.length>0&&m.apply(Br(y),b)}function l(m){let g=m.name,y=Ti(m,t.customObjects!=null?t.customObjects:{});y.setFastWeightInitDuringBuild(r),a[g]=y,m.inboundNodes.forEach(b=>{if(!(b instanceof Array))throw new X("Corrupted configuration, expected array for nodeData: ".concat(b));s(y,b)})}let c=t.name,u=t.layers;for(let m of u)l(m);for(;!Tle(i);)for(let m of u){let g=a[m.name];if(g.name in i){let y=i[g.name];delete i[g.name];for(let b of y)o(g,b)}}let d=[],p=[],h=t.inputLayers;for(let m of h){let g=m[0],y=m[1],b=m[2];Ki(g in a);let v=a[g].inboundNodes[y].outputTensors;d.push(v[b])}let f=t.outputLayers;for(let m of f){let g=m[0],y=m[1],b=m[2];Ki(g in a);let v=a[g].inboundNodes[y].outputTensors;p.push(v[b])}return new e({inputs:d,outputs:p,name:c})}get stateful(){if(this._stateful)throw new X("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(let e of this.layers)if(e.stateful)return!0;return!1}resetStates(){K(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}};function ece(e,t,n){let r=t.length;if(e==null||Array.isArray(e)&&e.length===0)return t.map(a=>null);if(r===1)return Array.isArray(e)&&e.length===1?e:typeof e=="object"&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==r)throw new Error("Provided ".concat(n," is an array of ").concat(e.length," element(s), but the model has ").concat(r," outputs. Make sure a set of weights is provided for each model output."));return e}else if(typeof e=="object"&&Object.keys(e).length>0&&typeof e[Object.keys(e)[0]]=="object"){let a=[];return t.forEach(i=>{i in e?a.push(e[i]):a.push(null)}),a}else throw new Error("The model has multiple (".concat(r,") outputs, so ").concat(n," must be either an array with ").concat(r," elements or an object with ").concat(t," keys. Provided ").concat(n," not understood: ").concat(JSON.stringify(e)))}function jz(e,t){return ece(e,t,"classWeight")}async function Gz(e,t,n,r){if(t!=null||r!=null)throw new Error("Support sampleWeight is not implemented yet");if(n!=null){let a=K(()=>{if(e.shape.length===1)return es(e);if(e.shape.length===2){if(e.shape[1]>1)return nu(e,1);if(e.shape[1]===1)return q(e,[e.shape[0]]);throw new Error("Encountered unexpected last-dimension size (".concat(e.shape[1],") during handling of class weights. The size is expected to be >= 1."))}else throw new Error("Unexpected rank of target (y) tensor (".concat(e.rank,") during handling of class weights. The rank is expected to be 1 or 2."))}),i=Array.from(await a.data());We(a);let s=[];return i.forEach(o=>{if(n[o]==null)throw new Error("classWeight must contain all classes in the training data. The class ".concat(o," exists in the data but not in classWeight"));s.push(n[o])}),ht(s,"float32")}else return null}function tce(e,t){return G(e,t)}var nce=32;function qz(e,t){let n,r,a=t;n=a.xs,r=a.ys,k.assert(n!=null&&r!=null,()=>"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ".concat(t));let i=IR("input",e.inputNames,n),s=IR("output",e.outputNames,r),o=i[0].shape[0];k.assert(i.length===e.inputs.length,()=>"LayersModel has ".concat(e.inputs.length," inputs, but the dataset provides ").concat(i.length," inputs.  (Expected input keys: ").concat(JSON.stringify(e.inputNames),")")),k.assert(s.length===e.outputs.length,()=>"LayersModel has ".concat(e.outputs.length," outputs, but the dataset provides ").concat(s.length," outputs.  (Expected output keys: ").concat(JSON.stringify(e.outputNames),")"));for(let l=0;l<i.length;l++)k.assert(i[l].shape[0]===o,()=>"Batch size mismatch: input ".concat(e.inputNames[l]," has ").concat(i[l].shape[0],"; expected  ").concat(o," based on input ").concat(e.inputNames[0],"."));for(let l=0;l<s.length;l++)k.assert(s[l].shape[0]===o,()=>"Batch size mismatch: output ".concat(e.outputNames[l]," has ").concat(s[l].shape[0],"; expected  ").concat(o," based on input ").concat(e.inputNames[0],"."));return{xs:i,ys:s}}function IR(e,t,n){if(n instanceof He)return[n];if(Array.isArray(n))return k.assert(n.length===t.length,()=>"Received an array of ".concat(n.length," Tensors, but expected ").concat(t.length," to match the ").concat(e," keys ").concat(t,".")),n;{let r=[];for(let a of t){if(n[a]==null)throw new X("The feature data generated by the dataset lacks the required ".concat(e," key '").concat(a,"'."));r.push(n[a])}return r}}function rce(e){if(e.length===3)throw new Xe("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}async function ace(e,t,n){let r=n.batchesPerEpoch!=null;if(k.assert(e.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),k.assert(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),k.assert(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>"For fitDataset(), config.epochs is expected to be a positive integer, but got ".concat(n.epochs)),k.assert(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>"For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ".concat(n.batchesPerEpoch)),k.assert(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),e.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");e.isTraining=!0;try{let a=n.validationData!=null,i,s;if(a)if($R(n.validationData))k.assert(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ".concat(n.validationBatches));else{let g=rce(n.validationData);i=g.xs,s=g.ys}let o=e.makeTrainFunction(),l=e.getDedupedMetricsNames(),c;a?c=l.slice().concat(l.map(g=>"val_"+g)):c=l.slice();let u=Lz(n.callbacks,n.yieldEvery),d=n.verbose==null?1:n.verbose,{callbackList:p,history:h}=Pz(u,d,n.epochs,null,null,ice(t,n),null,a,c);p.setModel(e),e.history=h,await p.onTrainBegin(),e.stopTraining_=!1;let f=n.initialEpoch==null?0:n.initialEpoch,m=await t.iterator();for(;f<n.epochs;){let g={};await p.onEpochBegin(f);let y=0,b=0;for(r||(m=await t.iterator());!r||y<n.batchesPerEpoch;){let v=await m.next();if(r&&v.done){console.warn("You provided `batchesPerEpoch` as ".concat(n.batchesPerEpoch,", but your dataset iterator ran out of data after ").concat(y," batches; interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, ").concat(n.batchesPerEpoch*n.epochs," batches). You may need to use the repeat() function when building your dataset."));break}if(v.value!=null){let{xs:x,ys:w}=qz(e,v.value),$={};$.batch=b,$.size=x[0].shape[0],await p.onBatchBegin(b,$);let C=[];if(n.classWeight!=null){let R=jz(n.classWeight,e.outputNames);for(let N=0;N<R.length;++N)C.push(await Gz(w[N],null,R[N]))}let E=x.concat(w).concat(C),_=o(E);We(E);for(let R=0;R<l.length;++R){let N=l[R],I=_[R];$[N]=I,wn(I)}await p.onBatchEnd(b,$),Dz($),b++,y++}if(r?y>=n.batchesPerEpoch:v.done){if(a){let x;$R(n.validationData)?x=Dt(await e.evaluateDataset(n.validationData,{batches:n.validationBatches})):x=Dt(e.evaluate(i,s,{batchSize:n.validationBatchSize==null?nce:n.validationBatchSize,verbose:0}));for(let w=0;w<e.metricsNames.length;++w)g["val_".concat(e.metricsNames[w])]=x[w]}break}if(e.stopTraining_)break}if(await p.onEpochEnd(f,g),f++,e.stopTraining_)break}return await p.onTrainEnd(),await e.history.syncData(),e.history}finally{e.isTraining=!1}}function ice(e,t){let n=null;return t.batchesPerEpoch!=null?n=t.batchesPerEpoch:Number.isFinite(e.size)&&(n=e.size),n}function $R(e){return typeof e.iterator=="function"}function sce(e){return typeof e.next=="function"}async function oce(e,t,n){n=n||{};let r=n.batches!=null,a=e.testFunction,i=[];if(n.verbose>0)throw new Xe("Verbose mode is not implemented yet.");k.assert(!r||n.batches>0&&Number.isInteger(n.batches),()=>"Test loop expects `batches` to be a positive integer, but received ".concat(JSON.stringify(n.batches)));let s=sce(t)?t:await t.iterator(),o=0,l=0;for(;!r||l<n.batches;){let c=await s.next();if(i=K(()=>{if(c.value){let{xs:u,ys:d}=qz(e,c.value),p=u.concat(d),h=K(()=>a(p));if(We(p),l===0)for(let m=0;m<h.length;++m)i.push(Ae(0));let f=p[0].shape[0];for(let m=0;m<h.length;++m){let g=h[m],y=i[m];i[m]=K(()=>ne(i[m],G(f,g))),l>0&&We(y)}We(h),o+=f,++l}return i}),c.done){r&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` batches (in this case, ".concat(n.batches," batches). You may need to use the repeat() function when building your dataset."));break}}for(let c=0;c<i.length;++c){let u=i[c];i[c]=ke(i[c],o),We(u)}return Br(i)}function S1(e){k.assert(e>0&&Number.isInteger(e),()=>"batchSize is required to be a positive integer, but got ".concat(e))}function mf(e,t,n){return e==null?[null]:Array.isArray(e)?e.map(r=>Ll(r,t,n-t)):Ll(e,t,n-t)}function gS(e,t){return K(()=>e==null?null:Array.isArray(e)?e.map(n=>gS(n,t)):$z(e,t.dtype==="int32"?t:de(t,"int32")))}function I1(e,t){let n=[],r=0,a=null;for(;r<e;)a=r+t,a>=e&&(a=e),n.push([r,a]),r=a;return n}function Kz(e){let t=[];e instanceof He&&(e=[e]);for(let n=0;n<e.length;++n){let r=e[n];if(r.rank===1)t.push(Vg(r,1));else{if(r.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(r)}}return t}function di(e,t){if(e==null)return;let n=[];if(t instanceof He)n.push(t.id);else if(Array.isArray(t))t.forEach(a=>n.push(a.id));else if(t!=null)for(let a in t){let i=t[a];n.push(i.id)}let r=[];if(e instanceof He)n.indexOf(e.id)===-1&&r.push(e);else if(Array.isArray(e))e.forEach(a=>{n.indexOf(a.id)===-1&&r.push(a)});else if(e!=null)for(let a in e){let i=e[a];n.indexOf(i.id)===-1&&r.push(i)}r.forEach(a=>{a.isDisposed||a.dispose()})}function lce(e){return e instanceof He}function yS(e){return Array.isArray(e)}function CR(e){return!lce(e)&&!yS(e)}function ER(e,t,n,r=!0,a=""){if(t==null||t.length===0){if(e!=null){let s=!1;if(yS(e)&&e.length>0)s=!0;else if(CR(e)){for(let o in e)if(e.hasOwnProperty(o)){s=!0;break}}else s=!0;if(s)throw new X("Error when checking model ".concat(a," expected no data, but got ").concat(e))}return[]}if(e==null)return t.map(s=>null);let i;if(CR(e)){e=e,i=[];for(let s of t){if(e[s]==null)throw new X('No data provided for "'.concat(s,'". Need data for each key in: ').concat(t));i.push(e[s])}}else if(yS(e)){if(e=e,e.length!==t.length)throw new X("Error when checking model ".concat(a,": the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ").concat(t.length," Tensor(s), but instead got the following list of Tensor(s): ").concat(e));i=e}else{if(e=e,t.length>1)throw new X("The model ".concat(a," expects ").concat(t.length," Tensor(s), but only received one Tensor. Found: Tensor with shape ").concat(e.shape));i=[e]}if(i=Kz(i),n!=null)for(let s=0;s<t.length;++s){if(n[s]==null)continue;let o=i[s];if(o.shape.length!==n[s].length)throw new X("Error when checking ".concat(a,": expected ").concat(t[s]," to have ").concat(n[s].length," dimension(s). but got array with shape ").concat(o.shape));for(let l=0;l<n[s].length;++l){if(l===0&&!r)continue;let c=o.shape[l],u=n[s][l];if(u!=null&&u>=0&&c!==u)throw new X("".concat(a," expected a batch of elements where each example has shape [").concat(n[s].slice(1,n[s].length),"] (i.e.,tensor shape [*,").concat(n[s].slice(1,n[s].length),"]) but the ").concat(a," received an input with ").concat(o.shape[0]," examples, each with shape [").concat(o.shape.slice(1,o.shape.length),"] (tensor shape [").concat(o.shape,"])"))}}return i}function uce(e,t,n){let r=So(e.map(i=>i.shape[0]));r.sort();let a=So(t.map(i=>i.shape[0]));if(a.sort(),r.length>1)throw new X("All input Tensors (x) should have the same number of samples. Got array shapes: ".concat(JSON.stringify(e.map(i=>i.shape))));if(a.length>1)throw new X("All target Tensors (y) should have the same number of samples. Got array shapes: ".concat(JSON.stringify(t.map(i=>i.shape))));if(r.length>0&&a.length>0&&!k.arraysEqual(r,a))throw new X("Input Tensors should have the same number of samples as target Tensors. Found ".concat(r[0]," input sample(s) and ").concat(a[0]," target sample(s)."))}function cce(e,t,n){let r=[Hc,ew,_m];for(let a=0;a<e.length;++a){let i=e[a],s=t[a],o=n[a];if(s!=null){if(s===_m&&i.shape[i.shape.length-1]===1)throw new X("You are passing a target array of shape ".concat(i.shape," while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes]."));if(r.indexOf(s)!==-1){let l=i.shape.slice(1),c=o.slice(1);for(let u=0;u<l.length;++u){let d=l[u],p=c[u];if(p!=null&&d!==p)throw new X("A target Tensor with shape ".concat(i.shape," was passed for an output of shape ").concat(o,", while using a loss function that expects targets to have the same shape as the output."))}}}}}function TR(e,t,n,r=!0,a=""){let i;if(Array.isArray(e)){if(e.length!==t.length)throw new X("Error when checking model ".concat(a,": the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ").concat(t.length," Tensor(s), but instead got ").concat(e.length," Tensors(s)."));i=e}else{if(t.length>1)throw new X("The model expects ".concat(t.length," ").concat(a," Tensors, but only received one Tensor. Found: array with shape ").concat(JSON.stringify(e.shape),"."));i=[e]}if(n!=null)for(let s=0;s<t.length;++s){if(n[s]==null)continue;let o=i[s];if(o.shape.length!==n[s].length)throw new X("Error when checking ".concat(a,": expected ").concat(t[s]," to have ").concat(n[s].length," dimension(s), but got array with shape ").concat(JSON.stringify(o.shape)));for(let l=0;l<n[s].length;++l){if(l===0&&!r)continue;let c=o.shape[l],u=n[s][l];if(u!=null&&u!==c)throw new X("Error when checking ".concat(a,": expected ").concat(t[s]," to have shape ").concat(JSON.stringify(n[s])," but got array with shape ").concat(JSON.stringify(o.shape),"."))}}}function dce(e,t){if(e==null||Array.isArray(e)&&e.length===0)return t.map(r=>[]);let n;if(typeof e=="string"||typeof e=="function")n=[e];else if(Array.isArray(e)||typeof e=="object")n=e;else throw new TypeError("Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ".concat(e));if(Array.isArray(n))return t.map(r=>n);{let r=[];for(let a of t){let i=n.hasOwnProperty(a)?n[a]:[];Array.isArray(i)||(i=[i]),r.push(i)}return r}}var pce="layers-model",Ts=class extends Hi{constructor(e){super(e),this.isTraining=!1}summary(e,t,n=console.log){if(!this.built)throw new X("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");Xue(this,e,t,n)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=Kue(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof Hs))throw new X("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let t=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(let i in e.loss)if(this.outputNames.indexOf(i)===-1)throw new X('Unknown entry in loss dictionary: "'.concat(i,'". Only expected the following keys: ').concat(this.outputNames));for(let i of this.outputNames)e.loss[i]==null&&console.warn('Output "'.concat(i,'" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ').concat(i," during training")),t.push(k1(e.loss[i]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new X("When passing an Array as loss, it should have one entry per model output. The model has ".concat(this.outputs.length," output(s), but you passed loss=").concat(e.loss,"."));t=e.loss.map(i=>k1(i))}else{let i=k1(e.loss);this.outputs.forEach(s=>{t.push(i)})}this.lossFunctions=t,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let i=0;i<this.outputs.length;++i){let s=this.internalOutputShapes[i],o=this.outputNames[i];this.feedOutputNames.push(o),this.feedOutputShapes.push(s),this.feedLossFns.push(this.lossFunctions[i])}let n=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Ol("loss",()=>{for(let i=0;i<this.outputs.length;++i){if(n.indexOf(i)!==-1)continue;let s=this.lossFunctions[i];this.outputs.length>1&&(this.metricsTensors.push([s,i]),this.metricsNames.push(this.outputNames[i]+"_loss"))}});let r=dce(e.metrics,this.outputNames),a=(i,s,o)=>{this.outputNames.length>1&&(s=this.outputNames[i]+"_"+s),this.metricsNames.push(s),this.metricsTensors.push([o,i])};Ol("metric",()=>{for(let i=0;i<this.outputs.length;++i){if(n.indexOf(i)!==-1)continue;let s=r[i];(o=>{let l="",c,u,d;for(let p of o){if(typeof p=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(p)!==-1){let f=this.internalOutputShapes[i];f[f.length-1]===1||this.lossFunctions[i]===ew?["accuracy","acc"].indexOf(p)!==-1?u=$E:["crossentropy","ce"].indexOf(p)!==-1&&(u=Wz):this.lossFunctions[i]===Rv?["accuracy","acc"].indexOf(p)!==-1?u=Uz:["crossentropy","ce"].indexOf(p)!==-1&&(u=Vz):["accuracy","acc"].indexOf(p)!==-1?u=CE:["crossentropy","ce"].indexOf(p)!==-1&&(u=EE);let m;["accuracy","acc"].indexOf(p)!==-1?m="acc":["crossentropy","ce"].indexOf(p)!==-1&&(m="ce"),d=u,c=l+m}else d=que(p),c=l+qy(p);let h;Ol(c,()=>{h=d}),a(i,c,h)}})(s)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,t,n={}){let r=n.batchSize==null?32:n.batchSize;S1(r);let a=!0,i=this.standardizeUserDataXY(e,t,a,r);try{let s=i[0].concat(i[1]);this.makeTestFunction();let o=this.testFunction,l=this.testLoop(o,s,r,n.verbose,n.steps);return Br(l)}finally{di(i[0],e),di(i[1],t)}}async evaluateDataset(e,t){return this.makeTestFunction(),oce(this,e,t)}checkNumSamples(e,t,n,r="steps"){let a;if(n!=null){if(a=null,t!=null)throw new X("If ".concat(r," is set, batchSize must be null or undefined.Got batchSize = ").concat(t))}else if(e!=null)Array.isArray(e)?a=e[0].shape[0]:a=e.shape[0];else throw new X("Either the input data should have a defined shape, or ".concat(r," shoud be specified."));return a}execute(e,t){if(Array.isArray(t)&&t.length===0)throw new X("`outputs` is an empty Array, which is not allowed.");let n=Array.isArray(t),r=n?t:[t],a=this.retrieveSymbolicTensors(r),i=new _l;if(e instanceof He&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new X("The number of inputs provided (".concat(e.length,") does not match the number of inputs of this model (").concat(this.inputs.length,")."));for(let o=0;o<this.inputs.length;++o)i.add(this.inputs[o],e[o])}else for(let o of this.inputs){let l=e[o.name];if(l==null)throw new X("No value is provided for the model's input ".concat(o.name));i.add(o,l)}let s=Cf(a,i);return n?s:s[0]}retrieveSymbolicTensors(e){let t=lu(null,e.length),n=e.length;for(let r of this.layers){let a=Array.isArray(r.output)?r.output:[r.output],i=a.map(s=>s.name);for(let s=0;s<e.length;++s){let o=i.indexOf(e[s]);if(o!==-1&&(t[s]=a[o],n--),n===0)break}if(n===0)break}if(n>0){let r=[];throw t.forEach((a,i)=>{a==null&&r.push(e[i])}),new X("Cannot find SymbolicTensors for output name(s): ".concat(JSON.stringify(r)))}return t}predictLoop(e,t=32,n=!1){return K(()=>{let r=this.checkNumSamples(e);if(n)throw new Xe("Verbose predictLoop() is not implemented yet.");let a=I1(r,t),i=this.outputs.map(s=>[]);for(let s=0;s<a.length;++s)K(()=>{let o=a[s][0],l=a[s][1],c=mf(e,o,l),u=[];if(Array.isArray(c))for(let p=0;p<c.length;++p)u.push({key:this.inputs[p],value:c[p]});else u.push({key:this.inputs[0],value:c});let d=new _l(u);return Cf(this.outputs,d)}).forEach((o,l)=>i[l].push(o));return Br(i.map(s=>wt(s,0)))})}predict(e,t={}){let n=Kz(e);TR(n,this.inputNames,this.feedInputShapes,!1);try{let r=t.batchSize==null?32:t.batchSize;return S1(r),this.predictLoop(n,r)}finally{di(n,e)}}predictOnBatch(e){TR(e,this.inputNames,this.feedInputShapes,!0);let t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}standardizeUserDataXY(e,t,n=!0,r){if(this.optimizer_==null)throw new xi("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");let a=[];for(let i=0;i<this.feedOutputShapes.length;++i){let s=this.feedOutputShapes[i];this.feedLossFns[i]===Rv?a.push(s.slice(0,s.length-1).concat([1])):a.push(s)}if(e=ER(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=ER(t,this.feedOutputNames,a,!1,"target"),uce(e,t),cce(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&r!=null&&r>0&&e[0].shape[0]%r!==0)throw new X("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ".concat(r,". Found: ").concat(e[0].shape[0]," sample(s)."));return[e,t]}async standardizeUserData(e,t,n,r,a=!0,i){let[s,o]=this.standardizeUserDataXY(e,t,a,i);if(n!=null)throw new Error("sample weight is not supported yet.");let l=null;if(r!=null){let c=jz(r,this.outputNames);l=[];for(let u=0;u<c.length;++u)l.push(await Gz(o[u],null,c[u]))}return[s,o,l]}testLoop(e,t,n,r=0,a){return K(()=>{let i=this.checkNumSamples(t,n,a,"steps"),s=[];if(r>0)throw new Xe("Verbose mode is not implemented yet.");if(a!=null)throw new Xe("steps mode in testLoop() is not implemented yet");{let o=I1(i,n),l=ht(Di(0,i));for(let c=0;c<o.length;++c){let u=o[c][0],d=o[c][1],p=Ll(l,u,d-u),h=gS(t,p),f=e(h);if(c===0)for(let m=0;m<f.length;++m)s.push(Ae(0));for(let m=0;m<f.length;++m){let g=f[m];s[m]=ne(s[m],G(d-u,g))}}for(let c=0;c<s.length;++c)s[c]=ke(s[c],i)}return s})}getDedupedMetricsNames(){let e=this.metricsNames,t=[];for(let n=0;n<e.length;++n){let r=e[n],a=r;if(hR(e,r)>1){let i=hR(e.slice(0,n),r);a+="_".concat(i)}t.push(a)}return t}makeTrainFunction(){return e=>{let t=[],n=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),a=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),i=[],s=()=>{let c=[];for(let h=0;h<this.inputs.length;++h)c.push({key:this.inputs[h],value:n[h]});let u=new _l(c),d=Cf(this.outputs,u,{training:!0}),p;for(let h=0;h<this.lossFunctions.length;++h){let f=this.lossFunctions[h],m=f(r[h],d[h]);a[h]!=null&&(m=tce(m,a[h]));let g=Gt(m);t.push(g),h===0?p=m:p=ne(p,m)}for(let h=0;h<this.metricsTensors.length;++h){let f;if(this.outputs.length>1&&h<this.outputs.length)f=t[h];else{let m=this.metricsTensors[h][0],g=this.metricsTensors[h][1];f=Gt(m(r[g],d[g]))}wn(f),i.push(f)}return p=Gt(p),this.calculateLosses().forEach(h=>{p=ne(p,h)}),p},o=this.collectedTrainableWeights.map(c=>c.read()),l=!0;return[this.optimizer_.minimize(s,l,o)].concat(i)}}makeTestFunction(){this.testFunction=e=>K(()=>{let t=[],n,r=e.slice(0,this.inputs.length),a=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=[];for(let l=0;l<this.inputs.length;++l)i.push({key:this.inputs[l],value:r[l]});let s=new _l(i),o=Cf(this.outputs,s);for(let l=0;l<this.lossFunctions.length;++l){let c=this.lossFunctions[l],u=Gt(c(a[l],o[l]));l===0?n=u:n=ne(n,u),t.push(n)}for(let l=0;l<this.metricsTensors.length;++l){let c=this.metricsTensors[l][0],u=this.metricsTensors[l][1],d=Gt(c(a[u],o[u]));t.push(d)}return t})}async fit(e,t,n={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let r,a,i,s,o,l,c,u,d;try{let p=n.batchSize==null?32:n.batchSize;S1(p);let h=!1,f=await this.standardizeUserData(e,t,n.sampleWeight,n.classWeight,h,p);r=f[0],a=f[1],d=f[2];let m=!1,g;if(n.validationData!=null&&n.validationData.length>0){if(m=!0,n.validationData.length===2)o=n.validationData[0],l=n.validationData[1];else throw n.validationData.length===3?new Xe("validationData including sample weights is not supported yet."):new X("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ".concat(n.validationData," is invalid."));let C=!0,E=await this.standardizeUserData(o,l,null,null,C,p);c=E[0],u=E[1],g=c.concat(u)}else if(n.validationSplit!=null&&n.validationSplit>0&&n.validationSplit<1){m=!0;let C=Math.floor(r[0].shape[0]*(1-n.validationSplit)),E=r[0].shape[0];c=mf(r,C,E),i=r,r=mf(r,0,C),u=mf(a,C,E),s=a,a=mf(a,0,C),g=c.concat(u)}else n.validationSteps!=null&&(m=!0);let y=r.concat(a).concat(d);this.checkTrainableWeightsConsistency();let b=this.makeTrainFunction(),v=this.getDedupedMetricsNames(),x,w;m?(this.makeTestFunction(),x=this.testFunction,w=v.slice().concat(v.map(C=>"val_"+C))):(x=null,g=[],w=v.slice());let $=Lz(n.callbacks,n.yieldEvery);return await this.fitLoop(b,y,v,p,n.epochs,n.verbose,$,x,g,n.shuffle,w,n.initialEpoch,null,null)}finally{this.isTraining=!1,di(r,e),di(a,t),di(i,e),di(s,t),di(c,o),di(u,l),d!=null&&We(d)}}async fitLoop(e,t,n,r,a,i,s,o,l,c,u,d,p,h){r==null&&(r=32),a==null&&(a=1),c==null&&(c=!0),d==null&&(d=0);let f=!1;if(o!=null&&l!=null&&(f=!0),h!=null&&(f=!0,p==null))throw new X("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");let m=this.checkNumSamples(t,r,p,"steps_per_epoch"),g;m!=null&&(g=Di(0,m)),i==null&&(i=1);let{callbackList:y,history:b}=Pz(s,i,a,d,m,p,r,f,u);y.setModel(this),this.history=b,await y.onTrainBegin(),this.stopTraining_=!1;for(let v=d;v<a;++v){await y.onEpochBegin(v);let x={};if(p!=null)throw new Xe("stepsPerEpoch mode is not implemented yet.");{if(c==="batch")throw new Xe("batch shuffling is not implemneted yet");c&&k.shuffle(g);let w=ht(g),$=I1(m,r);for(let C=0;C<$.length;++C){let E={};if(await y.onBatchBegin(C,E),K(()=>{let _=$[C][0],R=$[C][1],N=Ll(w,_,R-_);E.batch=C,E.size=R-_;let I=gS(t,N),O=e(I);for(let P=0;P<n.length;++P){let L=n[P],U=O[P];E[L]=U,wn(U)}if(C===$.length-1&&f){let P=this.testLoop(o,l,r);for(let L=0;L<n.length;++L){let U=n[L],D=P[L];wn(D),x["val_"+U]=D}}}),await y.onBatchEnd(C,E),Dz(E),this.stopTraining_)break}w.dispose()}if(await y.onEpochEnd(v,x),this.stopTraining_)break}return await y.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,t){return ace(this,e,t)}async trainOnBatch(e,t){let n=await this.standardizeUserData(e,t),r=n[0],a=n[1],i=this.makeTrainFunction()(r.concat(a)),s=[];for(let o of i){let l=await o.data();s.push(l[0])}return We(i),di(n[0],e),di(n[1],t),Br(s)}getNamedWeights(e){let t=[],n=e!=null&&e.trainableOnly,r=n?this.trainableWeights:this.weights,a=this.getWeights(n);for(let i=0;i<r.length;++i)n&&!r[i].trainable||t.push({name:r[i].originalName,tensor:a[i]});return t}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){let e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){let t=$v().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-$v().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=bs(this.loss);else if(Array.isArray(this.loss)){for(let t of this.loss)if(typeof t!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(t=>bs(t))}else{let t=Object.keys(this.loss);e={};let n=this.loss;for(let r of t)if(typeof n[r]=="string")e[r]=bs(n[r]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[bs(qy(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>bs(qy(e)));{let e={};for(let t in this.metrics)e[t]=bs(qy(this.metrics[t]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");let t=Am(e.optimizer_config),n=Ti(t),r;if(typeof e.loss=="string")r=kl(e.loss);else if(Array.isArray(e.loss))r=e.loss.map(i=>kl(i));else if(e.loss!=null){r={};for(let i in e.loss)r[i]=kl(e.loss[i])}let a;if(Array.isArray(e.metrics))a=e.metrics.map(i=>kl(i));else if(e.metrics!=null){a={};for(let i in e.metrics)a[i]=kl(e.metrics[i])}this.compile({loss:r,metrics:a,optimizer:n})}async save(e,t){if(typeof e=="string"){let s=Gn.getSaveHandlers(e);if(s.length===0)throw new X("Cannot find any save handlers for URL '".concat(e,"'"));if(s.length>1)throw new X("Found more than one (".concat(s.length,") save handlers for URL '").concat(e,"'"));e=s[0]}if(e.save==null)throw new X("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");let n=await Gn.encodeWeights(this.getNamedWeights(t)),r=!1,a=null,i={modelTopology:this.toJSON(a,r),format:pce,generatedBy:"TensorFlow.js tfjs-layers v".concat(TE),convertedBy:null};if(t!=null&&t.includeOptimizer&&this.optimizer!=null){i.trainingConfig=this.getTrainingConfig();let s="optimizer",{data:o,specs:l}=await Gn.encodeWeights(await this.optimizer.getWeights(),s);n.specs.push(...l),n.data=Gn.concatenateArrayBuffers([n.data,o])}return this.userDefinedMetadata!=null&&(SR(this.userDefinedMetadata,this.name,!0),i.userDefinedMetadata=this.userDefinedMetadata),i.weightData=n.data,i.weightSpecs=n.specs,e.save(i)}setUserDefinedMetadata(e){SR(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}};Ts.className="Model";le.registerClass(Ts);var Xz=class extends Ts{};Xz.className="Functional";le.registerClass(Xz);async function hce(e,t){"modelTopology"in e||(e={modelTopology:e}),e=e;let n=e.modelTopology;n.model_config!=null&&(n=n.model_config);let r=Am(n),a=Ti(r,t);if(e.weightsManifest!=null){let i=await Gn.loadWeights(e.weightsManifest,e.pathPrefix,a.weights.map(o=>o.originalName)),s={};for(let o of a.weights)s[o.originalName]=i[o.originalName];a.loadWeights(s),We(i)}return a}async function fce(e,t){if(t==null&&(t={}),typeof e=="string"){let n=Gn.getLoadHandlers(e,t);if(n.length===0)n.push(Gn.browserHTTPRequest(e,t));else if(n.length>1)throw new X("Found more than one (".concat(n.length,") load handlers for URL '").concat(e,"'"));e=n[0]}return mce(e,void 0,t)}async function mce(e,t,n){if(n==null&&(n={}),e.load==null)throw new X("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");let r=await e.load(),a=r.modelTopology;a.model_config!=null&&(a=a.model_config);let i=n.strict==null?!0:n.strict,s=r.weightData!=null&&r.weightSpecs!=null&&i,o=Ti(Am(a),t,s),l=r.trainingConfig;if(l!=null&&o.loadTrainingConfig(l),r.userDefinedMetadata!=null&&o.setUserDefinedMetadata(r.userDefinedMetadata),r.weightData!=null){if(r.weightSpecs==null)throw new X("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");let{modelWeights:c,optimizerWeights:u}=gce(r.weightData,r.weightSpecs);o.loadWeights(c,i),o.optimizer!=null&&u.length>0&&await o.optimizer.setWeights(u),We(c),We(u.map(d=>d.tensor))}return o}function gce(e,t){let n=Gn.decodeWeights(e,t),r={},a=[];return t.forEach(i=>{i.group==="optimizer"?a.push({name:i.name,tensor:n[i.name]}):r[i.name]=n[i.name]}),{modelWeights:r,optimizerWeights:a}}var gp=class extends Ts{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:Vx("sequential_"),e.layers!=null)for(let t of e.layers)this.add(t)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(t=>t<0))throw new X("Negative dimension size caused by adding layer ".concat(e.name," with input shape [").concat(e.inboundNodes[0].inputTensors[0].shape,"]"))}add(e){let t=e instanceof gp||e instanceof Ts,n;if(t){if(n=e,n.outputs.length!==1)throw new X("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(n.inputs.length!==1)throw new X("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new X("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");let r=Nz({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(r)}if(t)this.outputs=n.outputs,this.inputs=n.inputs;else{if(e.inboundNodes.length!==1)throw new X("A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ".concat(e.name," which has ").concat(e.inboundNodes.length," pre-existing inbound connections."));if(e.inboundNodes[0].outputTensors.length!==1)throw new X("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=Tz(this.outputs[0])}this.inboundNodes=[],new Qx({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:lu(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(r=>r.shape),outputShapes:this.outputs[0].shape})}else{let r=e.apply(this.outputs[0]);if(Array.isArray(r))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[r],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{let e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,t){return this.model==null&&this.build(),this.model.call(e,t)}build(e){if(lt(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Ts({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,t,n=console.log){this.built||this.build(),super.summary(e,t,n)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,t,n={}){if(!this.built)throw new xi("The model needs to be compiled before being used.");return this.model.evaluate(e,t,n)}async evaluateDataset(e,t){if(!this.built)throw new xi("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,t)}predict(e,t={}){return this.model==null&&this.build(),this.model.predict(e,t)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,t,n={}){if(!this.built)throw new xi("The model needs to be compiled before being used.");return this.model.fit(e,t,n)}async fitDataset(e,t){if(!this.built)throw new xi("The model needs to be compiled before being used.");return this.model.fitDataset(e,t)}async trainOnBatch(e,t){return this.model.trainOnBatch(e,t)}static fromConfig(e,t,n={},r=!1){let a,i={};if(t instanceof Array){if(t[0].className==null||t[0].className==="Merge")throw new X("Legacy serialization format not supported yet.");a=t}else k.assert(t.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),a=t.layers,delete t.layers,i=t;let s=new e(i);if(!(s instanceof gp))throw new Xe("Sequential.fromConfig called on non-Sequential input: ".concat(s));for(let o of a){let l=Ti(o,void 0,r);r&&l.setFastWeightInitDuringBuild(!0),s.add(l)}return s}set stopTraining(e){if(this.model==null)throw new X("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new X("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){let e=[];for(let t of this.layers){let n={};n.className=t.getClassName(),n.config=t.getConfig(),e.push(n)}return{name:this.name,layers:e}}};gp.className="Sequential";le.registerClass(gp);function yce(e){return new Ts(e)}function bce(e){return new gp(e)}function Yz(e){return Nz(e)}function vce(e,t){Ha.registerCallbackConstructor(e,t)}var Xr=class extends le.Serializable{getConfig(){return{}}},Zz=class extends Xr{apply(e,t=1){return Vle(e,t)}};Zz.className="elu";le.registerClass(Zz);var Qz=class extends Xr{apply(e){return Cx(e)}};Qz.className="selu";le.registerClass(Qz);var Jz=class extends Xr{apply(e){return ft(e)}};Jz.className="relu";le.registerClass(Jz);var eB=class extends Xr{apply(e){return K(()=>Do(6,ft(e)))}};eB.className="relu6";le.registerClass(eB);var tB=class extends Xr{apply(e){return e}};tB.className="linear";le.registerClass(tB);var nB=class extends Xr{apply(e){return Qa(e)}};nB.className="sigmoid";le.registerClass(nB);var rB=class extends Xr{apply(e){return jle(e)}};rB.className="hardSigmoid";le.registerClass(rB);var aB=class extends Xr{apply(e){return Wc(e)}};aB.className="softplus";le.registerClass(aB);var iB=class extends Xr{apply(e){return Hle(e)}};iB.className="softsign";le.registerClass(iB);var sB=class extends Xr{apply(e){return au(e)}};sB.className="tanh";le.registerClass(sB);var NE=class extends Xr{apply(e,t=-1){return Jo(e,t)}};NE.className="softmax";le.registerClass(NE);var oB=class extends Xr{apply(e,t=-1){return bx(e,t)}};oB.className="logSoftmax";le.registerClass(oB);var lB=class extends Xr{apply(e,t=1){return K(()=>G(Qa(G(e,t)),e))}};lB.className="swish";le.registerClass(lB);var uB=class extends Xr{apply(e){return K(()=>G(e,au(Wc(e))))}};uB.className="mish";le.registerClass(uB);function Oo(e){return e.getClassName()}function $1(e,t={}){return Ug(e,le.SerializationMap.getMap().classNameMap,t,"activation")}function Lo(e){if(e==null){let t={};return t.className="linear",t.config={},$1(t)}if(typeof e=="string"){let t={};return t.className=e,t.config={},$1(t)}else return e instanceof Xr?e:$1(e)}function _E(e){if(e!=null&&typeof e!="object")throw new Error("Argument to L1L2 regularizer's constructor is expected to be an object, but received: ".concat(e))}var cB=class extends le.Serializable{},qg=class extends cB{constructor(e){super(),_E(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return K(()=>{let t=qt([1]);return this.hasL1&&(t=ne(t,Se(G(this.l1,un(e))))),this.hasL2&&(t=ne(t,Se(G(this.l2,Hg(e))))),q(t,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,t){return new e({l1:t.l1,l2:t.l2})}};qg.className="L1L2";le.registerClass(qg);function xce(e){return _E(e),new qg({l1:e!=null?e.l1:null,l2:0})}function wce(e){return _E(e),new qg({l2:e!=null?e.l2:null,l1:0})}var NR={l1l2:"L1L2"};function Ct(e){return lE(e)}function _R(e,t={}){return Ug(e,le.SerializationMap.getMap().classNameMap,t,"regularizer")}function Wt(e){if(e==null)return null;if(typeof e=="string"){let t={className:e in NR?NR[e]:e,config:{}};return _R(t)}else return e instanceof cB?e:_R(e)}var AE=class extends Qe{constructor(e){super(e==null?{}:e),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,t){e=Oe(e);let n=ft(e);return this.maxValue!=null&&(n=lr(n,0,this.maxValue)),n}computeOutputShape(e){return e}getConfig(){let e={maxValue:this.maxValue},t=super.getConfig();return Object.assign(e,t),e}};AE.className="ReLU";le.registerClass(AE);var RE=class extends Qe{constructor(e){super(e==null?{}:e),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){let n=Oe(e);return Rg(n,this.alpha)}computeOutputShape(e){return e}getConfig(){let e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}};RE.className="LeakyReLU";le.registerClass(RE);var DE=class extends Qe{constructor(e){if(super(e==null?{}:e),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=Bt(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=Wt(e.alphaRegularizer),this.alphaConstraint=Cn(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new X("Expected sharedAxes to be a number or an array of numbers, but got ".concat(e.sharedAxes))}build(e){e=lt(e);let t=e.slice(1);if(this.sharedAxes!=null)for(let r of this.sharedAxes)t[r-1]=1;this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);let n={};if(this.sharedAxes!=null)for(let r=1;r<e.length;++r)n[r]=e[r];this.inputSpec=[new dn({ndim:e.length,axes:n})],this.built=!0}call(e,t){return e=Oe(e),Lg(e,this.alpha.read())}getConfig(){let e={alphaInitializer:Kt(this.alphaInitializer),alphaRegularizer:Ct(this.alphaRegularizer),alphaConstraint:$n(this.alphaConstraint),sharedAxes:this.sharedAxes},t=super.getConfig();return Object.assign(e,t),e}};DE.className="PReLU";le.registerClass(DE);var FE=class extends Qe{constructor(e){if(super(e==null?{}:e),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new Xe("Non-default alpha value (".concat(e.alpha,") is not supported by the ELU layer yet."));this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){let n=Oe(e);return Mh(n)}computeOutputShape(e){return e}getConfig(){let e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}};FE.className="ELU";le.registerClass(FE);var ME=class extends Qe{constructor(e){super(e==null?{}:e),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,t){let n=Oe(e);return G(n,de(Dr(n,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){let e={theta:this.theta},t=super.getConfig();return Object.assign(e,t),e}};ME.className="ThresholdedReLU";le.registerClass(ME);var OE=class extends Qe{constructor(e){super(e==null?{}:e),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new NE().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,t){let n=Oe(e);return this.softmax(n,this.axis)}computeOutputShape(e){return e}getConfig(){let e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}};OE.className="Softmax";le.registerClass(OE);function Vd(e,t,n){if(typeof e=="number")return lu(e,t);if(e.length!==t)throw new X("The ".concat(n," argument must be an integer or tuple of ").concat(t," integers. Received: ").concat(e.length," elements."));for(let r=0;r<t;++r){let a=e[r];if(!zle(a))throw new X("The ".concat(n," argument must be an integer or tuple of ").concat(t," integers. Received: ").concat(JSON.stringify(e)," including a non-integer number ").concat(a))}return e}function Ni(e,t,n,r,a=1){if(e==null)return e;let i=t+(t-1)*(a-1),s;return n==="same"?s=e:s=e-i+1,Math.floor((s+r-1)/r)}function Xi(e,t,n,r){if(e==null)return null;if(r==="valid")e=e*t+Mo([n-t,0]);else if(r==="same")e=e*t;else throw new X("Unsupport padding mode: ".concat(r,"."));return e}function LE(e,t){return K(()=>(an(t),t==="channelsFirst"?Ye(e,[0,2,3,1]):e))}function dB(e,t){return K(()=>(an(t),t==="channelsFirst"?Ye(e,[0,2,3,4,1]):e))}function kce(e,t,n,r=1,a="valid",i,s=1){return K(()=>{if(i==null&&(i=Fi()),an(i),e.shape.length!==3)throw new X("The input of a conv1dWithBias operation should be 3, but is ".concat(e.shape.length," instead."));if(t.shape.length!==3)throw new X("The kernel for a conv1dWithBias operation should be 3, but is ".concat(t.shape.length," instead"));if(n!=null&&n.shape.length!==1)throw new X("The bias for a conv1dWithBias operation should be 1, but is ".concat(t.shape.length," instead"));if(i==="channelsFirst"&&(e=Ye(e,[0,2,1])),a==="causal")throw new Xe("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let o=px(e,t,r,a==="same"?"same":"valid","NWC",s);return n!=null&&(o=Li(o,n)),o})}function AR(e,t,n,r=[1,1],a="valid",i,s,o=null){return K(()=>{if(i==null&&(i=Fi()),an(i),e.rank!==3&&e.rank!==4)throw new X("conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ".concat(e.rank,"."));if(t.rank!==3&&t.rank!==4)throw new X("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ".concat(e.rank,"."));let l=LE(e,i);if(a==="causal")throw new Xe("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=pp.conv2d({x:l,filter:t,strides:r,pad:a==="same"?"same":"valid",dilations:s,dataFormat:"NHWC",bias:n,activation:o}),i==="channelsFirst"&&(l=Ye(l,[0,3,1,2])),l})}function Sce(e,t,n,r=[1,1,1],a="valid",i,s){return K(()=>{if(i==null&&(i=Fi()),an(i),e.rank!==4&&e.rank!==5)throw new X("conv3dWithBias expects input to be of rank 4 or 5, but received ".concat(e.rank,"."));if(t.rank!==4&&t.rank!==5)throw new X("conv3dWithBias expects kernel to be of rank 4 or 5, but received ".concat(e.rank,"."));let o=dB(e,i);if(a==="causal")throw new Xe("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return o=dC(o,t,r,a==="same"?"same":"valid","NDHWC",s),n!=null&&(o=Li(o,n)),i==="channelsFirst"&&(o=Ye(o,[0,4,1,2,3])),o})}var PE=class extends Qe{constructor(e,t){if(super(t),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",PE.verifyArgs(t),this.rank=e,Ln(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new Xe("Convolution layer for rank other than 1, 2, or 3 (".concat(this.rank,") is not implemented yet."));if(this.kernelSize=Vd(t.kernelSize,e,"kernelSize"),this.strides=Vd(t.strides==null?1:t.strides,e,"strides"),this.padding=t.padding==null?"valid":t.padding,za(this.padding),this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,an(this.dataFormat),this.activation=Lo(t.activation),this.useBias=t.useBias==null?!0:t.useBias,this.biasInitializer=Bt(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=Cn(t.biasConstraint),this.biasRegularizer=Wt(t.biasRegularizer),this.activityRegularizer=Wt(t.activityRegularizer),this.dilationRate=Vd(t.dilationRate==null?1:t.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new X("dilationRate must be a number or an array of a single number for 1D convolution, but received ".concat(JSON.stringify(this.dilationRate)));if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new X("dilationRate must be a number or array of two numbers for 2D convolution, but received ".concat(JSON.stringify(this.dilationRate)))}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new X("dilationRate must be a number or array of three numbers for 3D convolution, but received ".concat(JSON.stringify(this.dilationRate)))}}static verifyArgs(e){if(Ki("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!uE(e.kernelSize,"number",1,3))throw new X("BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ".concat(JSON.stringify(e.kernelSize),"."))}getConfig(){let e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Oo(this.activation),useBias:this.useBias,biasInitializer:Kt(this.biasInitializer),biasRegularizer:Ct(this.biasRegularizer),activityRegularizer:Ct(this.activityRegularizer),biasConstraint:$n(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}},Kg=class extends PE{constructor(e,t){super(e,t),this.kernel=null,Kg.verifyArgs(t),this.filters=t.filters,Ln(this.filters,"filters"),this.kernelInitializer=Bt(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=Cn(t.kernelConstraint),this.kernelRegularizer=Wt(t.kernelRegularizer)}build(e){e=lt(e);let t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new X("The channel dimension of the input should be defined. Found ".concat(e[t]));let n=e[t],r=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[t]:n}}],this.built=!0}call(e,t){return K(()=>{e=Oe(e);let n,r=this.bias==null?null:this.bias.read(),a=vz(this.activation.getClassName());if(a!=null&&this.rank===2)n=AR(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate,a);else{if(this.rank===1)n=kce(e,this.kernel.read(),r,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)n=AR(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)n=Sce(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new Xe("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(n=this.activation.apply(n))}return n})}computeOutputShape(e){e=lt(e);let t=[],n=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let a=0;a<n.length;++a){let i=Ni(n[a],this.kernelSize[a],this.padding,this.strides[a],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[a]);t.push(i)}let r=[e[0]];return this.dataFormat==="channelsLast"?(r=r.concat(t),r.push(this.filters)):(r.push(this.filters),r=r.concat(t)),r}getConfig(){let e={filters:this.filters,kernelInitializer:Kt(this.kernelInitializer),kernelRegularizer:Ct(this.kernelRegularizer),kernelConstraint:$n(this.kernelConstraint)},t=super.getConfig();return Object.assign(e,t),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new X("Convolution layer expected config.filters to be a 'number' > 0 but got ".concat(JSON.stringify(e.filters)))}},Xg=class extends Kg{constructor(e){super(2,e),Xg.verifyArgs(e)}getConfig(){let e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!uE(e.kernelSize,"number",1,2))throw new X("Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ".concat(JSON.stringify(e.kernelSize),"."))}};Xg.className="Conv2D";le.registerClass(Xg);var Yg=class extends Kg{constructor(e){super(3,e),Yg.verifyArgs(e)}getConfig(){let e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new X("Conv3D expects config.kernelSize to be number or [number, number, number], but received ".concat(JSON.stringify(e.kernelSize),"."))}};Yg.className="Conv3D";le.registerClass(Yg);var zE=class extends Xg{constructor(e){if(super(e),this.inputSpec=[new dn({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new X("Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ".concat(this.padding))}build(e){if(e=lt(e),e.length!==4)throw new X("Input should have rank 4; Received input shape: "+JSON.stringify(e));let t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new X("The channel dimension of the inputs should be defined. Found `None`.");let n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new dn({ndim:4,axes:{[t]:n}})],this.built=!0}call(e,t){return K(()=>{let n=Oe(e);if(n.shape.length!==4)throw new X("Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-".concat(n.shape.length));let r=n.shape,a=r[0],i,s;this.dataFormat==="channelsFirst"?(i=2,s=3):(i=1,s=2);let o=r[i],l=r[s],c=this.kernelSize[0],u=this.kernelSize[1],d=this.strides[0],p=this.strides[1],h=Xi(o,d,c,this.padding),f=Xi(l,p,u,this.padding),m=[a,h,f,this.filters];this.dataFormat!=="channelsLast"&&(n=Ye(n,[0,2,3,1]));let g=hx(n,this.kernel.read(),m,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(g=Ye(g,[0,3,1,2])),this.bias!=null&&(g=Li(g,this.bias.read(),this.dataFormat)),this.activation!=null&&(g=this.activation.apply(g)),g})}computeOutputShape(e){e=lt(e);let t=e.slice(),n,r,a;this.dataFormat==="channelsFirst"?(n=1,r=2,a=3):(n=3,r=1,a=2);let i=this.kernelSize[0],s=this.kernelSize[1],o=this.strides[0],l=this.strides[1];return t[n]=this.filters,t[r]=Xi(t[r],o,i,this.padding),t[a]=Xi(t[a],l,s,this.padding),t}getConfig(){let e=super.getConfig();return delete e.dilationRate,e}};zE.className="Conv2DTranspose";le.registerClass(zE);var BE=class extends Yg{constructor(e){if(super(e),this.inputSpec=[new dn({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new X("Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ".concat(this.padding))}build(e){if(e=lt(e),e.length!==5)throw new X("Input should have rank 5; Received input shape: "+JSON.stringify(e));let t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new X("The channel dimension of the inputs should be defined. Found `None`.");let n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new dn({ndim:5,axes:{[t]:n}})],this.built=!0}call(e,t){return K(()=>{let n=Oe(e);if(n.shape.length!==5)throw new X("Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-".concat(n.shape.length));let r=n.shape,a=r[0],i,s,o;this.dataFormat==="channelsFirst"?(o=2,i=3,s=4):(o=1,i=2,s=3);let l=r[o],c=r[i],u=r[s],d=this.kernelSize[0],p=this.kernelSize[1],h=this.kernelSize[2],f=this.strides[0],m=this.strides[1],g=this.strides[2],y=Xi(l,f,d,this.padding),b=Xi(c,m,p,this.padding),v=Xi(u,g,h,this.padding),x=[a,y,b,v,this.filters];this.dataFormat!=="channelsLast"&&(n=Ye(n,[0,2,3,4,1]));let w=pC(n,this.kernel.read(),x,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(w=Ye(w,[0,4,1,2,3])),this.bias!==null&&(w=Li(w,this.bias.read(),this.dataFormat)),this.activation!==null&&(w=this.activation.apply(w)),w})}computeOutputShape(e){e=lt(e);let t=e.slice(),n,r,a,i;this.dataFormat==="channelsFirst"?(n=1,r=2,a=3,i=4):(n=4,r=1,a=2,i=3);let s=this.kernelSize[0],o=this.kernelSize[1],l=this.kernelSize[2],c=this.strides[0],u=this.strides[1],d=this.strides[2];return t[n]=this.filters,t[r]=Xi(t[r],c,s,this.padding),t[a]=Xi(t[a],u,o,this.padding),t[i]=Xi(t[i],d,l,this.padding),t}getConfig(){let e=super.getConfig();return delete e.dilationRate,e}};BE.className="Conv3DTranspose";le.registerClass(BE);var pB=class extends Kg{constructor(e,t){if(super(e,t),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,t.filters==null)throw new X("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(t.kernelInitializer!=null||t.kernelRegularizer!=null||t.kernelConstraint!=null)throw new X("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(t.padding!=null&&t.padding!=="same"&&t.padding!=="valid")throw new X("SeparableConv".concat(this.rank,"D supports only padding modes: 'same' and 'valid', but received ").concat(JSON.stringify(t.padding)));this.depthMultiplier=t.depthMultiplier==null?1:t.depthMultiplier,this.depthwiseInitializer=Bt(t.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=Wt(t.depthwiseRegularizer),this.depthwiseConstraint=Cn(t.depthwiseConstraint),this.pointwiseInitializer=Bt(t.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=Wt(t.pointwiseRegularizer),this.pointwiseConstraint=Cn(t.pointwiseConstraint)}build(e){if(e=lt(e),e.length<this.rank+2)throw new X("Inputs to SeparableConv".concat(this.rank,"D should have rank ").concat(this.rank+2,", but received input shape: ").concat(JSON.stringify(e)));let t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null||e[t]<0)throw new X("The channel dimension of the inputs should be defined, but found ".concat(JSON.stringify(e[t])));let n=e[t],r=this.kernelSize.concat([n,this.depthMultiplier]),a=[];for(let s=0;s<this.rank;++s)a.push(1);a.push(n*this.depthMultiplier,this.filters);let i=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,i,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",a,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,i,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,i,this.biasConstraint):this.bias=null,this.inputSpec=[new dn({ndim:this.rank+2,axes:{[t]:n}})],this.built=!0}call(e,t){return K(()=>{e=Oe(e);let n;if(this.rank===1)throw new Xe("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=Ye(e,[0,2,3,1])),n=zh(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(n=Li(n,this.bias.read(),this.dataFormat)),this.activation!=null&&(n=this.activation.apply(n)),this.dataFormat==="channelsFirst"&&(n=Ye(n,[0,3,1,2])),n})}getConfig(){let e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=Kt(this.depthwiseInitializer),e.pointwiseInitializer=Kt(this.pointwiseInitializer),e.depthwiseRegularizer=Ct(this.depthwiseRegularizer),e.pointwiseRegularizer=Ct(this.pointwiseRegularizer),e.depthwiseConstraint=$n(this.depthwiseConstraint),e.pointwiseConstraint=$n(this.pointwiseConstraint),e}};pB.className="SeparableConv";var WE=class extends pB{constructor(e){super(2,e)}};WE.className="SeparableConv2D";le.registerClass(WE);var tw=class extends Kg{constructor(e){super(1,e),tw.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){let e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!uE(e.kernelSize,"number",1,1))throw new X("Conv1D expects config.kernelSize to be number or number[] with length 1, but received ".concat(JSON.stringify(e.kernelSize),"."))}};tw.className="Conv1D";le.registerClass(tw);var UE=class extends Qe{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,t){return K(()=>{if(e=Oe(e),this.dataFormat==="channelsLast"){let n=Gy(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return Gy(n,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{let n=Gy(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return Gy(n,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){let e={cropping:this.cropping,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}};UE.className="Cropping2D";le.registerClass(UE);var VE=class extends Qe{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,an(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,Ole(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){let t=e[2]==null?null:this.size[0]*e[2],n=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],t,n]}else{let t=e[1]==null?null:this.size[0]*e[1],n=e[2]==null?null:this.size[1]*e[2];return[e[0],t,n,e[3]]}}call(e,t){return K(()=>{let n=Oe(e),r=n.shape;if(this.dataFormat==="channelsFirst"){n=Ye(n,[0,2,3,1]);let a=this.size[0]*r[2],i=this.size[1]*r[3],s=this.interpolation==="nearest"?$a.resizeNearestNeighbor(n,[a,i]):$a.resizeBilinear(n,[a,i]);return Ye(s,[0,3,1,2])}else{let a=this.size[0]*r[1],i=this.size[1]*r[2];return this.interpolation==="nearest"?$a.resizeNearestNeighbor(n,[a,i]):$a.resizeBilinear(n,[a,i])}})}getConfig(){let e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}};VE.className="UpSampling2D";le.registerClass(VE);function Ice(e,t,n=[1,1],r="valid",a,i){return K(()=>{a==null&&(a=Fi()),an(a);let s=LE(e,a);if(e.rank!==4)throw new X("Input for depthwiseConv2d is required to be 4-D, but is instead ".concat(e.rank,"-D"));if(t.rank!==4)throw new X("depthwiseKernel is required to be 4-D, but is instead ".concat(t.rank,"-D"));return s=Bc(s,t,n,r==="same"?"same":"valid","NHWC",i),a==="channelsFirst"&&(s=Ye(s,[0,3,1,2])),s})}var HE=class extends PE{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=Bt(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=Cn(e.depthwiseConstraint),this.depthwiseRegularizer=Wt(e.depthwiseRegularizer)}build(e){if(e=lt(e),e.length<4)throw new X("Inputs to DepthwiseConv2D should have rank 4. Received input shape: ".concat(JSON.stringify(e),"."));let t=this.dataFormat==="channelsFirst"?1:3;if(e[t]==null||e[t]<0)throw new X("The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (".concat(e[t],")."));let n=e[t],r=[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return K(()=>{e=Oe(e);let n=Ice(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(n=Li(n,this.bias.read(),this.dataFormat)),this.activation!=null&&(n=this.activation.apply(n)),n})}computeOutputShape(e){e=lt(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],n=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,a=Ni(t,this.kernelSize[0],this.padding,this.strides[0]),i=Ni(n,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],r,a,i]:[e[0],a,i,r]}getConfig(){let e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=Kt(this.depthwiseInitializer),e.depthwiseRegularizer=Ct(this.depthwiseRegularizer),e.depthwiseConstraint=$n(this.depthwiseRegularizer),e}};HE.className="DepthwiseConv2D";le.registerClass(HE);function hB(e,t,n,r){if(Array.isArray(e)){if(t!=null||n!=null)throw new X("When inputs is an array, neither initialState or constants should be provided");r!=null&&(n=e.slice(e.length-r,e.length),e=e.slice(0,e.length-r)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function a(i){return i==null||Array.isArray(i)?i:[i]}return t=a(t),n=a(n),{inputs:e,initialState:t,constants:n}}function fB(e,t,n,r=!1,a,i,s=!1,o=!1){return K(()=>{let l=t.shape.length;if(l<3)throw new X("Input should be at least 3D, but is ".concat(l,"D."));let c=[1,0].concat(Di(2,l));if(t=Ye(t,c),i!=null)throw new Xe("The rnn() functoin of the deeplearn.js backend does not support constants yet.");s&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),a!=null&&(a=de(de(a,"bool"),"float32"),a.rank===l-1&&(a=Vn(a,-1)),a=Ye(a,c)),r&&(t=Da(t,0),a!=null&&(a=Da(a,0)));let u=[],d,p=n,h=t.shape[0],f=en(t),m;a!=null&&(m=en(a));for(let y=0;y<h;++y){let b=f[y],v=K(()=>e(b,p));if(a==null)d=v[0],p=v[1];else{let x=K(()=>{let w=m[y],$=xe(ma(w),w),C=ne(G(v[0],w),G(p[0],$)),E=p.map((_,R)=>ne(G(v[1][R],w),G(_,$)));return{output:C,newStates:E}});d=x.output,p=x.newStates}o&&u.push(d)}let g;return o&&(g=Sn(u,1)),[d,g,p]})}var cs=class extends Qe{constructor(e){super(e);let t;if(e.cell==null)throw new X("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?t=new aw({cells:e.cell}):t=e.cell,t.stateSize==null)throw new X("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=t,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new dn({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){let e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return Di(0,e).map(t=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){pS(e)&&(e=e[0]),e=e;let t=this.cell.stateSize;Array.isArray(t)||(t=[t]);let n=t[0],r;if(this.returnSequences?r=[e[0],e[1],n]:r=[e[0],n],this.returnState){let a=[];for(let i of t)a.push([e[0],i]);return[r].concat(a)}else return r}computeMask(e,t){return K(()=>{Array.isArray(t)&&(t=t[0]);let n=this.returnSequences?t:null;if(this.returnState){let r=this.states.map(a=>null);return[n].concat(r)}else return n})}get states(){if(this.states_==null){let e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,t=[];for(let n=0;n<e;++n)t.push(null);return t}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new Xe("Constants support is not implemented in RNN yet.");pS(e)&&(e=e[0]),e=e;let t=this.stateful?e[0]:null,n=e.slice(2);this.inputSpec[0]=new dn({shape:[t,null,...n]});let r=[e[0]].concat(e.slice(2));this.cell.build(r);let a;if(Array.isArray(this.cell.stateSize)?a=this.cell.stateSize:a=[this.cell.stateSize],this.stateSpec!=null){if(!k.arraysEqual(this.stateSpec.map(i=>i.shape[i.shape.length-1]),a))throw new X("An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=".concat(this.stateSpec,"; However cell.stateSize is ").concat(this.cell.stateSize))}else this.stateSpec=a.map(i=>new dn({shape:[null,i]}));this.stateful&&this.resetStates()}resetStates(e,t=!1){K(()=>{if(!this.stateful)throw new ys("Cannot call resetStates() on an RNN Layer that is not stateful.");let n=this.inputSpec[0].shape[0];if(n==null)throw new X("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>qt([n,r])):this.states_=[qt([n,this.cell.stateSize])];else if(e==null)We(this.states_),this.keptStates!=null&&(We(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>qt([n,r])):this.states_[0]=qt([n,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new X("Layer ".concat(this.name," expects ").concat(this.states_.length," state(s), but it received ").concat(e.length," state value(s). Input received: ").concat(e));t===!0?this.keptStates.push(this.states_.slice()):We(this.states_);for(let r=0;r<this.states_.length;++r){let a=e[r],i=Array.isArray(this.cell.stateSize)?this.cell.stateSize[r]:this.cell.stateSize,s=[n,i];if(!k.arraysEqual(a.shape,s))throw new X("State ".concat(r," is incompatible with layer ").concat(this.name,": expected shape=").concat(s,", received shape=").concat(a.shape));this.states_[r]=a}}this.states_=this.states_.map(r=>wn(r.clone()))})}apply(e,t){let n=t==null?null:t.initialState,r=t==null?null:t.constants;t==null&&(t={});let a=hB(e,n,r,this.numConstants);e=a.inputs,n=a.initialState,r=a.constants;let i=[],s=[];if(n!=null){t.initialState=n,i=i.concat(n),this.stateSpec=[];for(let o of n)this.stateSpec.push(new dn({shape:o.shape}));s=s.concat(this.stateSpec)}if(r!=null&&(t.constants=r,i=i.concat(r),this.numConstants=r.length),i[0]instanceof wi){let o=[e].concat(i),l=this.inputSpec.concat(s),c=this.inputSpec;this.inputSpec=l;let u=super.apply(o,t);return this.inputSpec=c,u}else return super.apply(e,t)}call(e,t){return K(()=>{let n=t==null?null:t.mask,r=t==null?null:t.training,a=t==null?null:t.initialState;e=Oe(e),a==null&&(this.stateful?a=this.states_:a=this.getInitialState(e));let i=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(a.length!==i)throw new X("RNN Layer has ".concat(i," state(s) but was passed ").concat(a.length," initial state(s)."));this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");let s={training:r},o=fB((p,h)=>{let f=this.cell.call([p].concat(h),s);return[f[0],f.slice(1)]},e,a,this.goBackwards,n,null,this.unroll,this.returnSequences),l=o[0],c=o[1],u=o[2];this.stateful&&this.resetStates(u,r);let d=this.returnSequences?c:l;return this.returnState?[d].concat(u):d})}getInitialState(e){return K(()=>{let t=qt(e.shape);return t=Se(t,[1,2]),t=Vg(t),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(n=>n>1?cS(t,[1,n]):t):this.cell.stateSize>1?[cS(t,[1,this.cell.stateSize])]:[t]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){let e=super.getConfig(),t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(t.numConstants=this.numConstants);let n=this.cell.getConfig();return this.getClassName()===cs.className&&(t.cell={className:this.cell.getClassName(),config:n}),Object.assign(Object.assign(Object.assign({},n),e),t)}static fromConfig(e,t,n={}){let r=t.cell,a=Ti(r,n);return new e(Object.assign(t,{cell:a}))}};cs.className="RNN";le.registerClass(cs);var Zg=class extends Qe{},nw=class extends Zg{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Ln(this.units,"units"),this.activation=Lo(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Bt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Bt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Bt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Wt(e.kernelRegularizer),this.recurrentRegularizer=Wt(e.recurrentRegularizer),this.biasRegularizer=Wt(e.biasRegularizer),this.kernelConstraint=Cn(e.kernelConstraint),this.recurrentConstraint=Cn(e.recurrentConstraint),this.biasConstraint=Cn(e.biasConstraint),this.dropout=fp([1,Mo([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=fp([1,Mo([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=lt(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return K(()=>{if(e=e,e.length!==2)throw new X("SimpleRNNCell expects 2 input Tensors, got ".concat(e.length,"."));let n=e[1];e=e[0];let r=t.training==null?!1:t.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Po({ones:()=>ma(e),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Po({ones:()=>ma(n),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));let a,i=this.dropoutMask,s=this.recurrentDropoutMask;i!=null?a=ns(G(e,i),this.kernel.read()):a=ns(e,this.kernel.read()),this.bias!=null&&(a=Li(a,this.bias.read())),s!=null&&(n=G(n,s));let o=ne(a,ns(n,this.recurrentKernel.read()));return this.activation!=null&&(o=this.activation.apply(o)),[o,o]})}getConfig(){let e=super.getConfig(),t={units:this.units,activation:Oo(this.activation),useBias:this.useBias,kernelInitializer:Kt(this.kernelInitializer),recurrentInitializer:Kt(this.recurrentInitializer),biasInitializer:Kt(this.biasInitializer),kernelRegularizer:Ct(this.kernelRegularizer),recurrentRegularizer:Ct(this.recurrentRegularizer),biasRegularizer:Ct(this.biasRegularizer),activityRegularizer:Ct(this.activityRegularizer),kernelConstraint:$n(this.kernelConstraint),recurrentConstraint:$n(this.recurrentConstraint),biasConstraint:$n(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),t)}};nw.className="SimpleRNNCell";le.registerClass(nw);var jE=class extends cs{constructor(e){e.cell=new nw(e),super(e)}call(e,t){return K(()=>{this.cell.dropoutMask!=null&&(We(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(We(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let n=t==null?null:t.mask,r=t==null?null:t.training,a=t==null?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:a})})}static fromConfig(e,t){return new e(t)}};jE.className="SimpleRNN";le.registerClass(jE);var rw=class extends Zg{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new X("GRUCell does not support reset_after parameter set to true.");this.units=e.units,Ln(this.units,"units"),this.activation=Lo(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Lo(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Bt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Bt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Bt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Wt(e.kernelRegularizer),this.recurrentRegularizer=Wt(e.recurrentRegularizer),this.biasRegularizer=Wt(e.biasRegularizer),this.kernelConstraint=Cn(e.kernelConstraint),this.recurrentConstraint=Cn(e.recurrentConstraint),this.biasConstraint=Cn(e.biasConstraint),this.dropout=fp([1,Mo([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=fp([1,Mo([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=lt(e);let t=e[e.length-1];this.kernel=this.addWeight("kernel",[t,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return K(()=>{if(e=e,e.length!==2)throw new X("GRUCell expects 2 input Tensors (inputs, h, c), got ".concat(e.length,"."));let n=t.training==null?!1:t.training,r=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Po({ones:()=>ma(e),rate:this.dropout,training:n,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Po({ones:()=>ma(r),rate:this.recurrentDropout,training:n,count:3,dropoutFunc:this.dropoutFunc}));let a=this.dropoutMask,i=this.recurrentDropoutMask,s,o,l;0<this.dropout&&this.dropout<1&&(e=G(e,a[0]));let c=ns(e,this.kernel.read());this.useBias&&(c=Li(c,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=G(r,i[0]));let u=this.recurrentKernel.read(),[d,p]=Ur(u,[2*this.units,this.units],u.rank-1),h=ns(r,d),[f,m,g]=Ur(c,3,c.rank-1),[y,b]=Ur(h,2,h.rank-1);s=this.recurrentActivation.apply(ne(f,y)),o=this.recurrentActivation.apply(ne(m,b));let v=ns(G(o,r),p);l=this.activation.apply(ne(g,v));let x=ne(G(s,r),G(ne(1,_t(s)),l));return[x,x]})}getConfig(){let e=super.getConfig(),t={units:this.units,activation:Oo(this.activation),recurrentActivation:Oo(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Kt(this.kernelInitializer),recurrentInitializer:Kt(this.recurrentInitializer),biasInitializer:Kt(this.biasInitializer),kernelRegularizer:Ct(this.kernelRegularizer),recurrentRegularizer:Ct(this.recurrentRegularizer),biasRegularizer:Ct(this.biasRegularizer),activityRegularizer:Ct(this.activityRegularizer),kernelConstraint:$n(this.kernelConstraint),recurrentConstraint:$n(this.recurrentConstraint),biasConstraint:$n(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),t)}};rw.className="GRUCell";le.registerClass(rw);var GE=class extends cs{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new rw(e),super(e)}call(e,t){return K(()=>{this.cell.dropoutMask!=null&&(We(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(We(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let n=t==null?null:t.mask,r=t==null?null:t.training,a=t==null?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:a})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}};GE.className="GRU";le.registerClass(GE);var Qg=class extends Zg{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Ln(this.units,"units"),this.activation=Lo(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Lo(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Bt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Bt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Bt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=Wt(e.kernelRegularizer),this.recurrentRegularizer=Wt(e.recurrentRegularizer),this.biasRegularizer=Wt(e.biasRegularizer),this.kernelConstraint=Cn(e.kernelConstraint),this.recurrentConstraint=Cn(e.recurrentConstraint),this.biasConstraint=Cn(e.biasConstraint),this.dropout=fp([1,Mo([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=fp([1,Mo([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var t;e=lt(e);let n=e[e.length-1];this.kernel=this.addWeight("kernel",[n,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let r;if(this.useBias){if(this.unitForgetBias){let a=this.biasInitializer,i=this.units;r=new(t=class extends ri{apply(s,o){let l=a.apply([i]),c=new jx().apply([i]),u=a.apply([i*2]);return mR(mR(l,c),u)}},t.className="CustomInit",t)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,t){return K(()=>{let n=t.training==null?!1:t.training;if(e=e,e.length!==3)throw new X("LSTMCell expects 3 input Tensors (inputs, h, c), got ".concat(e.length,"."));let r=e[1],a=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Po({ones:()=>ma(e),rate:this.dropout,training:n,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Po({ones:()=>ma(r),rate:this.recurrentDropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));let i=this.dropoutMask,s=this.recurrentDropoutMask,o,l,c,u;0<this.dropout&&this.dropout<1&&(e=G(e,i[0]));let d=ns(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=G(r,s[0])),d=ne(d,ns(r,this.recurrentKernel.read())),this.useBias&&(d=Li(d,this.bias.read()));let[p,h,f,m]=Ur(d,4,d.rank-1);o=this.recurrentActivation.apply(p),l=this.recurrentActivation.apply(h),c=ne(G(l,a),G(o,this.activation.apply(f))),u=this.recurrentActivation.apply(m);let g=G(u,this.activation.apply(c));return[g,g,c]})}getConfig(){let e=super.getConfig(),t={units:this.units,activation:Oo(this.activation),recurrentActivation:Oo(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Kt(this.kernelInitializer),recurrentInitializer:Kt(this.recurrentInitializer),biasInitializer:Kt(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Ct(this.kernelRegularizer),recurrentRegularizer:Ct(this.recurrentRegularizer),biasRegularizer:Ct(this.biasRegularizer),activityRegularizer:Ct(this.activityRegularizer),kernelConstraint:$n(this.kernelConstraint),recurrentConstraint:$n(this.recurrentConstraint),biasConstraint:$n(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),t)}};Qg.className="LSTMCell";le.registerClass(Qg);var qE=class extends cs{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Qg(e),super(e)}call(e,t){return K(()=>{this.cell.dropoutMask!=null&&(We(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(We(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let n=t==null?null:t.mask,r=t==null?null:t.training,a=t==null?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:a})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}};qE.className="LSTM";le.registerClass(qE);var aw=class extends Zg{constructor(e){super(e),this.cells=e.cells}get stateSize(){let e=[];for(let t of this.cells.slice().reverse())Array.isArray(t.stateSize)?e.push(...t.stateSize):e.push(t.stateSize);return e}call(e,t){return K(()=>{e=e;let n=e.slice(1),r=[];for(let s of this.cells.slice().reverse())Array.isArray(s.stateSize)?r.push(n.splice(0,s.stateSize.length)):r.push(n.splice(0,1));r.reverse();let a=[],i;for(let s=0;s<this.cells.length;++s){let o=this.cells[s];n=r[s],s===0?i=[e[0]].concat(n):i=[i[0]].concat(n),i=o.call(i,t),a.push(i.slice(1))}n=[];for(let s of a.slice().reverse())n.push(...s);return[i[0]].concat(n)})}build(e){pS(e)&&(e=e[0]),e=e;let t;this.cells.forEach((n,r)=>{Ol("RNNCell_".concat(r),()=>{n.build(e),Array.isArray(n.stateSize)?t=n.stateSize[0]:t=n.stateSize,e=[e[0],t]})}),this.built=!0}getConfig(){let e=super.getConfig(),t=r=>({className:r.getClassName(),config:r.getConfig()}),n={cells:this.cells.map(t)};return Object.assign(Object.assign({},e),n)}static fromConfig(e,t,n={}){let r=[];for(let a of t.cells)r.push(Ti(a,n));return new e({cells:r})}get trainableWeights(){if(!this.trainable)return[];let e=[];for(let t of this.cells)e.push(...t.trainableWeights);return e}get nonTrainableWeights(){let e=[];for(let t of this.cells)e.push(...t.nonTrainableWeights);if(!this.trainable){let t=[];for(let n of this.cells)t.push(...n.trainableWeights);return t.concat(e)}return e}getWeights(){let e=[];for(let t of this.cells)e.push(...t.weights);return hS(e)}setWeights(e){let t=[];for(let n of this.cells){let r=n.weights.length,a=e.splice(r);for(let i=0;i<n.weights.length;++i)t.push([n.weights[i],a[i]])}bE(t)}};aw.className="StackedRNNCells";le.registerClass(aw);function Po(e){let{ones:t,rate:n,training:r=!1,count:a=1,dropoutFunc:i}=e,s=()=>i!=null?i(t(),n):Cz(t(),n),o=()=>jg(s,t,r);return!a||a<=1?wn(o().clone()):Array(a).fill(void 0).map(o).map(l=>wn(l.clone()))}var $ce=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n},mB=class extends cs{constructor(e){if(e.unroll)throw new Xe("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new Xe("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new dn({ndim:5})]}call(e,t){return K(()=>{if(this.cell.dropoutMask!=null&&(We(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(We(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),t&&t.constants)throw new X("ConvRNN2D cell does not support constants");let n=t==null?null:t.mask,r=t==null?null:t.training,a=t==null?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:a})})}computeOutputShape(e){let t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0],...t.slice(2)]),this.returnState&&(t=[t,...Array(2).fill([e[0],...t.slice(-3)])]),t}getInitialState(e){return K(()=>{let{stateSize:t}=this.cell,n=e.shape,r=this.computeSingleOutputShape(n),a=[r[0],...r.slice(2)],i=qt(a);return Array.isArray(t)?Array(t.length).fill(i):[i]})}resetStates(e,t=!1){K(()=>{if(!this.stateful)throw new ys("Cannot call resetStates() on an RNN Layer that is not stateful.");let n=this.inputSpec[0].shape,r=this.computeSingleOutputShape(n),a=[r[0],...r.slice(2)];if(n[0]==null)throw new X("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>qt(a)):this.states_=[qt(a)];else if(e==null)We(this.states_),this.keptStates!=null&&(We(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>qt(a)):this.states_[0]=qt(a);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new X("Layer ".concat(this.name," expects ").concat(this.states_.length," state(s), but it received ").concat(e.length," state value(s). Input received: ").concat(e));t?this.keptStates.push(this.states_.slice()):We(this.states_);for(let i=0;i<this.states_.length;++i){let s=e[i],o=a;if(!k.arraysEqual(s.shape,o))throw new X("State ".concat(i," is incompatible with layer ").concat(this.name,": expected shape=").concat(o,", received shape=").concat(s.shape));this.states_[i]=s}}this.states_=this.states_.map(i=>wn(i.clone()))})}computeSingleOutputShape(e){let{dataFormat:t,filters:n,kernelSize:r,padding:a,strides:i,dilationRate:s}=this.cell,o=t==="channelsFirst",l=e[o?3:2],c=e[o?4:3],u=Ni(l,r[0],a,i[0],s[0]),d=Ni(c,r[1],a,i[1],s[1]);return[...e.slice(0,2),...o?[n,u,d]:[u,d,n]]}};mB.className="ConvRNN2D";var iw=class extends Qg{constructor(e){let{filters:t,kernelSize:n,strides:r,padding:a,dataFormat:i,dilationRate:s}=e;super(Object.assign(Object.assign({},e),{units:t})),this.filters=t,Ln(this.filters,"filters"),this.kernelSize=Vd(n,2,"kernelSize"),this.kernelSize.forEach(o=>Ln(o,"kernelSize")),this.strides=Vd(r||1,2,"strides"),this.strides.forEach(o=>Ln(o,"strides")),this.padding=a||"valid",za(this.padding),this.dataFormat=i||"channelsLast",an(this.dataFormat),this.dilationRate=Vd(s||1,2,"dilationRate"),this.dilationRate.forEach(o=>Ln(o,"dilationRate"))}build(e){var t;e=lt(e);let n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new X("The channel dimension of the input should be defined. Found ".concat(e[n]));let r=e[n],a=4,i=this.kernelSize.concat([r,this.filters*a]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);let s=this.kernelSize.concat([this.filters,this.filters*a]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",s,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let o;if(this.unitForgetBias){let l=this.biasInitializer,c=this.filters;o=new(t=class extends ri{apply(u,d){let p=l.apply([c]),h=oa([c]),f=l.apply([c*2]);return cE([p,h,f])}},t.className="CustomInit",t)}else o=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*a],null,o,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,t){return K(()=>{if(e.length!==3)throw new X("ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ".concat(e.length,"."));let n=t.training||!1,r=e[0],a=e[1],i=e[2],s=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Po({ones:()=>ma(r),rate:this.dropout,training:n,count:s,dropoutFunc:this.dropoutFunc}));let o=this.dropoutMask,l=(z,B,j)=>!B||!B[j]?z:G(B[j],z),c=l(r,o,0),u=l(r,o,1),d=l(r,o,2),p=l(r,o,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Po({ones:()=>ma(a),rate:this.recurrentDropout,training:n,count:s,dropoutFunc:this.dropoutFunc}));let h=this.recurrentDropoutMask,f=l(a,h,0),m=l(a,h,1),g=l(a,h,2),y=l(a,h,3),b=3,[v,x,w,$]=Ur(this.kernel.read(),s,b),[C,E,_,R]=this.useBias?Ur(this.bias.read(),s):[null,null,null,null];c=this.inputConv(c,v,C,this.padding),u=this.inputConv(u,x,E,this.padding),d=this.inputConv(d,w,_,this.padding),p=this.inputConv(p,$,R,this.padding);let[N,I,O,P]=Ur(this.recurrentKernel.read(),s,b);f=this.recurrentConv(f,N),m=this.recurrentConv(m,I),g=this.recurrentConv(g,O),y=this.recurrentConv(y,P);let L=this.recurrentActivation.apply(ne(c,f)),U=this.recurrentActivation.apply(ne(u,m)),D=ne(G(U,i),G(L,this.activation.apply(ne(d,g)))),F=G(this.recurrentActivation.apply(ne(p,y)),this.activation.apply(D));return[F,F,D]})}getConfig(){let e=super.getConfig(),t=$ce(e,["units"]),n={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},t),n)}inputConv(e,t,n,r){let a=$r(e,t,this.strides,r||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return n?Li(a,n,this.dataFormat):a}recurrentConv(e,t){return $r(e,t,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}};iw.className="ConvLSTM2DCell";le.registerClass(iw);var KE=class extends mB{constructor(e){let t=new iw(e);super(Object.assign(Object.assign({},e),{cell:t}))}static fromConfig(e,t){return new e(t)}};KE.className="ConvLSTM2D";le.registerClass(KE);var sw=class extends Qe{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;let t=e.shape,n=[];for(let r=0;r<this.noiseShape.length;++r)n.push(this.noiseShape[r]==null?t[r]:this.noiseShape[r]);return n}call(e,t){return K(()=>{this.invokeCallHook(e,t);let n=Oe(e);if(0<this.rate&&this.rate<1){let r=t.training==null?!1:t.training,a=this.getNoiseShape(n);return jg(()=>Cz(n,this.rate,a,this.seed),()=>n,r)}return e})}getConfig(){let e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=super.getConfig();return Object.assign(e,t),e}dispose(){return super.dispose()}};sw.className="Dropout";le.registerClass(sw);var XE=class extends sw{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){let t=e.shape;return[t[0],1,t[2]]}};XE.className="SpatialDropout1D";le.registerClass(XE);var YE=class extends Qe{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let t=null;e.batchSize!=null&&(t=e.batchSize),this.batchInputShape=[t,e.inputDim]}this.units=e.units,Ln(this.units,"units"),this.activation=Lo(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=Bt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=Bt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=Cn(e.kernelConstraint),this.biasConstraint=Cn(e.biasConstraint),this.kernelRegularizer=Wt(e.kernelRegularizer),this.biasRegularizer=Wt(e.biasRegularizer),this.activityRegularizer=Wt(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=lt(e);let t=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:t}}],this.built=!0}computeOutputShape(e){e=lt(e);let t=e.slice();return t[t.length-1]=this.units,t}call(e,t){return K(()=>{this.invokeCallHook(e,t);let n=Oe(e),r=vz(this.activation.getClassName()),a;return r!=null?a=ns(n,this.kernel.read(),r,this.bias?this.bias.read():null):(a=ns(n,this.kernel.read()),this.bias!=null&&(a=Li(a,this.bias.read())),this.activation!=null&&(a=this.activation.apply(a))),a})}getConfig(){let e={units:this.units,activation:Oo(this.activation),useBias:this.useBias,kernelInitializer:Kt(this.kernelInitializer),biasInitializer:Kt(this.biasInitializer),kernelRegularizer:Ct(this.kernelRegularizer),biasRegularizer:Ct(this.biasRegularizer),activityRegularizer:Ct(this.activityRegularizer),kernelConstraint:$n(this.kernelConstraint),biasConstraint:$n(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}};YE.className="Dense";le.registerClass(YE);var ZE=class extends Qe{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=lt(e);for(let t of e.slice(1))if(t==null)throw new X('The shape of the input to "Flatten" is not fully defined (got '.concat(e.slice(1),'). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.'));return[e[0],Io(e,1)]}call(e,t){return K(()=>{this.invokeCallHook(e,t);let n=Oe(e);if(this.dataFormat==="channelsFirst"&&n.rank>1){let r=[0];for(let a=2;a<n.rank;++a)r.push(a);r.push(1),n=Ye(n,r)}return Ule(n)})}getConfig(){let e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);let t=super.getConfig();return Object.assign(e,t),e}};ZE.className="Flatten";le.registerClass(ZE);var QE=class extends Qe{constructor(e){super(e),this.supportsMasking=!0,this.activation=Lo(e.activation)}call(e,t){return K(()=>{this.invokeCallHook(e,t);let n=Oe(e);return this.activation.apply(n)})}getConfig(){let e={activation:Oo(this.activation)},t=super.getConfig();return Object.assign(e,t),e}};QE.className="Activation";le.registerClass(QE);var JE=class extends Qe{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,t){return K(()=>(e=Oe(e),Ble(e,this.n)))}getConfig(){let e={n:this.n},t=super.getConfig();return Object.assign(e,t),e}};JE.className="RepeatVector";le.registerClass(JE);var e2=class extends Qe{constructor(e){super(e),this.targetShape=e.targetShape;for(let t=0;t<this.targetShape.length;++t)this.isUnknown(this.targetShape[t])&&(this.targetShape[t]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,t){let n="Total size of new array must be unchanged.",r=t.slice(),a=1,i=null;for(let o=0;o<r.length;++o){let l=r[o];if(this.isUnknown(l))if(i===null)i=o;else throw new X("Can only specifiy one unknown dimension.");else a*=l}let s=Io(e);if(i!==null){if(a===0||s%a!==0)throw new X(n);r[i]=s/a}else if(s!==a)throw new X(n);return r}computeOutputShape(e){let t=!1;for(let n=0;n<e.length;++n)if(this.isUnknown(e[n])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,t){return K(()=>{this.invokeCallHook(e,t);let n=Oe(e),r=n.shape,a=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return q(n,a)})}getConfig(){let e={targetShape:this.targetShape},t=super.getConfig();return Object.assign(e,t),e}};e2.className="Reshape";le.registerClass(e2);var t2=class extends Qe{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received ".concat(e.dims," instead."));let t=Di(1,e.dims.length+1);if(!k.arraysEqual(e.dims.slice().sort(),t))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new dn({ndim:this.dims.length+1})]}computeOutputShape(e){e=lt(e);let t=e.slice();return this.dims.forEach((n,r)=>{t[r+1]=e[n]}),t}call(e,t){return Ye(Oe(e),this.dimsIncludingBatch)}getConfig(){let e={dims:this.dims},t=super.getConfig();return Object.assign(e,t),e}};t2.className="Permute";le.registerClass(t2);var n2=class extends Qe{constructor(e){super(e==null?{}:e),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={maskValue:this.maskValue};return Object.assign(t,e),t}computeMask(e,t){let n=Oe(e),r=-1;return Cm(su(n,this.maskValue),r)}call(e,t){return K(()=>{this.invokeCallHook(e,t);let n=Oe(e),r=-1,a=!0,i=Cm(su(n,this.maskValue),r,a);return G(n,de(i,n.dtype))})}};n2.className="Masking";le.registerClass(n2);var r2=class extends Qe{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let t=null;e.batchSize!=null&&(t=e.batchSize),e.inputLength==null?this.batchInputShape=[t,null]:this.batchInputShape=[t].concat(Dt(e.inputLength))}this.inputDim=e.inputDim,Ln(this.inputDim,"inputDim"),this.outputDim=e.outputDim,Ln(this.outputDim,"outputDim"),this.embeddingsInitializer=Bt(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=Wt(e.embeddingsRegularizer),this.activityRegularizer=Wt(e.activityRegularizer),this.embeddingsConstraint=Cn(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,t){return K(()=>this.maskZero?(e=Oe(e),su(e,nt(e))):null)}computeOutputShape(e){if(e=lt(e),this.inputLength==null)return[...e,this.outputDim];let t=Dt(this.inputLength);if(t.length!==e.length-1)throw new X('"inputLength" is '.concat(this.inputLength,", but received input shape has shape ").concat(e));{let n=0;for(let r=0;r<t.length;++r){let a=t[r],i=e[r+1];if(a!=null&&i!=null&&a!==i)throw new X('"inputLength" is '.concat(this.inputLength,", but received input shape has shape ").concat(e));a==null&&(t[n]=i),n++}}return[e[0],...t,this.outputDim]}call(e,t){return K(()=>{this.invokeCallHook(e,t);let n=Oe(e);n.dtype!=="int32"&&(n=Ls(n,"int32"));let r=$z(this.embeddings.read(),q(n,[n.size]));return q(r,lt(this.computeOutputShape(n.shape)))})}getConfig(){let e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Kt(this.embeddingsInitializer),embeddingsRegularizer:Ct(this.embeddingsRegularizer),activityRegularizer:Ct(this.activityRegularizer),embeddingsConstraint:$n(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=super.getConfig();return Object.assign(e,t),e}};r2.className="Embedding";le.registerClass(r2);var jc=class extends Qe{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new Xe}computeElementwiseOpOutputShape(e,t){if(e==null||t==null)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(t.length===0)return e;let n=e.slice(0,e.length-t.length);for(let r=0;r<t.length;++r){let a=e[e.length-t.length+r],i=t[r];if(a==null||i==null||a<0||i<0)n.push(null);else if(a===1)n.push(i);else if(i===1)n.push(a);else{if(a!==i)throw new X("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));n.push(a)}}return n}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[lt(e)]),e=e,e.length<2)throw new X("A merge layer should be called on an Array of at least 2 inputs. Got ".concat(e.length," input(s)."));let t=[];for(let a of e)a!=null&&a[0]!==null&&t.push(a[0]);if(t=So(t),t.length>1)throw new X("Can not merge tensors with different batch sizes. Got tensors with shapes: ".concat(JSON.stringify(e),"."));let n=e[0]==null?null:e[0].slice(1);for(let a=1;a<e.length;++a){let i=e[a]==null?null:e[a].slice(1);n=this.computeElementwiseOpOutputShape(n,i)}let r=e.map(a=>a.length);e.indexOf(null)===-1&&So(r).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,t){return K(()=>{if(e=e,this.reshapeRequired){let n=[],r=e.map(a=>a.rank);if(r.indexOf(null)===-1){let a=Mo(r);for(let i of e){let s=i.rank;for(let o=0;o<a-s;++o)i=Vg(i,1);n.push(i)}return this.mergeFunction(n)}else{let a=!1;for(let o of e){let l=o.rank;if(l==null){let c=o.shape,u=c[0],d=c.slice(1).concat([u]),p=q(o,[u].concat(Io(c.slice(1))));p=Ye(p,[1,0]),p=q(p,d),n.push(p),a=!0}else if(l>1){let c=Di(1,l).concat([0]);n.push(Ye(o,c)),a=!0}else n.push(o)}let i=this.mergeFunction(n),s=i.rank;if(a){if(s==null){let o=i.shape,l=o.length,c=o[l-1],u=[c].concat(o.slice(0,o.length-1));i=q(Ye(q(i,[-1,c]),[1,0]),u)}else if(s>1){let o=[s-1].concat(Di(0,s-1));i=Ye(i,o)}}return i}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let t;e[0]==null?t=null:t=e[0].slice(1);for(let r=1;r<e.length;++r){let a=e[r]==null?null:e[r].slice(1);t=this.computeElementwiseOpOutputShape(t,a)}let n=[];for(let r of e)r!=null&&r[0]!==null&&n.push(r[0]);return n=So(n),n.length===1?t=n.concat(t):t=[null].concat(t),t}computeMask(e,t){return K(()=>{if(t==null)return null;if(!Array.isArray(t))throw new X("`mask` should be an Array");if(!Array.isArray(e))throw new X("`inputs` should be an Array");if(t.length!==e.length)throw new X("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (".concat(e.length," vs ").concat(t.length,")"));if(t.every(r=>r==null))return null;t=t.map(r=>r==null?r:Vn(r,0));let n=t[0];for(let r=1;r<t.length-1;++r)n=ti(n,t[r]);return n})}},a2=class extends jc{constructor(e){super(e)}mergeFunction(e){return K(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=ne(t,e[n]);return t})}};a2.className="Add";le.registerClass(a2);var i2=class extends jc{constructor(e){super(e)}mergeFunction(e){return K(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=G(t,e[n]);return t})}};i2.className="Multiply";le.registerClass(i2);var s2=class extends jc{constructor(e){super(e)}mergeFunction(e){return K(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=ne(t,e[n]);return G(1/e.length,t)})}};s2.className="Average";le.registerClass(s2);var o2=class extends jc{constructor(e){super(e)}mergeFunction(e){return K(()=>{let t=e[0];for(let n=1;n<e.length;++n)t=ls(t,e[n]);return t})}};o2.className="Maximum";le.registerClass(o2);var l2=class extends jc{constructor(e){super(e)}mergeFunction(e){return K(()=>{let t=e[0];for(let n=1;n<e.length;++n)t=Do(t,e[n]);return t})}};l2.className="Minimum";le.registerClass(l2);var u2=class extends jc{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new X("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let t=!0;for(let r of e)if(r!=null){t=!1;break}if(t)return;let n=[];for(let r=0;r<e.length;++r){let a=e[r].slice();a.splice(this.axis,1);let i=!1;for(let s of n)if(k.arraysEqual(s,a)){i=!0;break}i||n.push(a)}if(n.length>1)throw new X("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return K(()=>cE(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new X("A `Concatenate` layer should be called on a list of inputs.");let t=e,n=t[0].slice(),r=this.axis<0?n.length+this.axis:this.axis;for(let a of t.slice(1)){if(n[r]==null||a[r]==null){n[r]=null;break}n[r]+=a[r]}return n}computeMask(e,t){if(t==null)return null;if(!Array.isArray(t))throw new X("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new X("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new X("Mismatch in the length of mask (".concat(t.length,") and the legnth of inputs (").concat(e.length,")"));return K(()=>{let n=!0;if(t.forEach(i=>{if(i!=null){n=!1;return}}),n)return null;let r=[];for(let i=0;i<e.length;++i)t[i]==null?r.push(de(ma(e[i]),"bool")):t[i].rank<e[i].rank?r.push(Vn(t[i],-1)):r.push(t[i]);let a=wt(r,this.axis);return dx(a,-1,!1)})}getConfig(){let e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}};u2.className="Concatenate";le.registerClass(u2);function gf(e,t){for(;e<0;)e+=t;return e}function Cce(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new Xe("batchDot is not implemented for tensors of 4D or higher rank yet");if(k.assert(e.shape.length>=2,()=>"batchDot requires the rank of x to be >= 2, but got ".concat(e.shape.length)),k.assert(e.shape.length>=2,()=>"batchDot requires the rank of y to be >= 2, but got ".concat(t.shape.length)),typeof n=="number"&&(n=[n,n]),e.dtype==="complex64"||t.dtype==="complex64")throw new Xe("batchDot is not implemented for complex64-type Tensors yet.");let r=e.shape.length,a=t.shape.length;n==null&&(n=[r-1,a-2]);let i=n;return K(()=>{let s;if(r>a){s=r-a;let l=[];for(let c=0;c<s;++c)l.push(1);t=q(t,t.shape.concat(l))}else if(a>r){s=a-r;let l=[];for(let c=0;c<s;++c)l.push(1);e=q(e,e.shape.concat(l))}else s=0;let o;if(e.shape.length===2&&t.shape.length===2)i[0]===i[1]?o=Se(G(e,t),i[0]):o=Se(G(Ye(e,[1,0]),t),i[1]);else{let l=i[0]!==e.shape.length-1,c=i[1]===t.shape.length-1;o=Ke(e,t,l,c)}if(s>0){let l;r>a?l=r+a-3:l=r-1;let c=[];for(let u=l;u<l+s;++u)c.push(u);o=el(o,c)}return o.shape.length===1&&(o=Vn(o,1)),o})}var c2=class extends jc{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){k.assert(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");let t=e[0],n=e[1];if(t.length>3||n.length>3)throw new Xe("Dot layer does not support tensors of 4D or higher rank yet.");let r=this.interpretAxes(t,n);if(t[r[0]]!==n[r[1]])throw new X("Dimension incompatibility: ".concat(t[r[0]]," !== ").concat(n[r[1]]))}mergeFunction(e){if(e.length!==2)throw new X("A `Dot` layer must be called on exactly 2 inputs, but received ".concat(e.length," input(s)."));let t=e[0],n=e[1],r;return Array.isArray(this.axes)?r=this.axes.map((a,i)=>gf(a,e[i].shape.length)):r=[gf(this.axes,t.shape.length),gf(this.axes,n.shape.length)],this.normalize&&(t=Av(t,r[0]),n=Av(n,r[1])),Cce(t,n,r)}interpretAxes(e,t){let n;return Array.isArray(this.axes)?n=this.axes:n=[gf(this.axes,e.length),gf(this.axes,t.length)],n}computeOutputShape(e){k.assert(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");let t=e[0].slice(),n=e[1].slice();if(t.length>3||n.length>3)throw new Xe("Dot layer does not support tensors of 4D or higher rank yet.");let r=this.interpretAxes(t,n);t.splice(r[0],1),n.splice(r[1],1),n.splice(0,1);let a=t.concat(n);return a.length===1&&a.push(1),a}computeMask(e,t){return null}getConfig(){let e={axes:this.axes,normalize:this.normalize},t=super.getConfig();return Object.assign(e,t),e}};c2.className="Dot";le.registerClass(c2);var d2=class extends Qe{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={stddev:this.stddev};return Object.assign(t,e),t}call(e,t){return K(()=>{this.invokeCallHook(e,t);let n=Oe(e);return jg(()=>ne(Hx(n.shape,0,this.stddev),n),()=>n,t.training||!1)})}};d2.className="GaussianNoise";le.registerClass(d2);var p2=class extends Qe{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return K(()=>{this.invokeCallHook(e,t);let n=Oe(e);return this.rate>0&&this.rate<1?jg(()=>{let r=Math.sqrt(this.rate/(1-this.rate));return G(n,Hx(n.shape,1,r))},()=>n,t.training||!1):n})}};p2.className="GaussianDropout";le.registerClass(p2);var h2=class extends Qe{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||Oe(e).shape}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return K(()=>{if(this.rate<1&&this.rate>0){let n=this._getNoiseShape(e);return jg(()=>{let r=Oe(e),a=1.6732632423543772,i=1.0507009873554805,s=-a*i,o=Us(Qo(n),this.rate);o=Ls(o,"float32");let l=((1-this.rate)*(1+this.rate*s**2))**-.5,c=-l*s*this.rate,u=ne(G(r,o),G(ne(o,-1),s));return ne(G(u,l),c)},()=>Oe(e),t.training||!1)}return e})}};h2.className="AlphaDropout";le.registerClass(h2);function Rm(e,t,n,r,a,i=.001){let s;if(e.rank===2)s=tC(e,t,n,r,a,i);else if(e.rank===3)s=nC(e,t,n,r,a,i);else if(e.rank===4)s=rC(e,t,n,r,a,i);else throw new Xe("batchNormalization is not implemented for array of rank ".concat(e.rank," yet"));return s}function Ece(e,t,n,r,a=.001){return K(()=>{let i=Mg(e,r),s=i.mean,o=i.variance;return[Rm(e,s,o,n,t,a),s,o]})}function Tce(e,t,n,r,a=.001){return K(()=>{let i=Mg(e,r),s=i.mean,o=i.variance,l=[];for(let h of Di(0,e.rank))r.indexOf(h)!==-1?l.push(1):l.push(e.shape[h]);let c=q(s,l),u=q(o,l),d=t==null?null:q(t,l),p=n==null?null:q(n,l);return[Rm(e,c,u,p,d,a),s,o]})}function Nce(e,t,n,r,a=.001){return k.arraysEqual(r.slice().sort(),Di(0,e.rank-1))?Ece(e,t,n,r,a):Tce(e,t,n,r,a)}var f2=class extends Qe{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=Bt(e.betaInitializer||"zeros"),this.gammaInitializer=Bt(e.gammaInitializer||"ones"),this.movingMeanInitializer=Bt(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=Bt(e.movingVarianceInitializer||"ones"),this.betaConstraint=Cn(e.betaConstraint),this.gammaConstraint=Cn(e.gammaConstraint),this.betaRegularizer=Wt(e.betaRegularizer),this.gammaRegularizer=Wt(e.gammaRegularizer)}build(e){e=lt(e);let t=this.axis>=0?this.axis:this.axis+e.length,n=e[t];if(n==null)throw new X("Axis ".concat(t," of input tensor should have a defined dimension but the layer received an input with shape ").concat(JSON.stringify(e),"."));this.inputSpec=[new dn({ndim:e.length,axes:{[t]:n}})];let r=[n];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,t){return K(()=>{let n=t.training==null?!1:t.training,r=Oe(e),a=r.shape,i=a.length,s=Di(0,i),o=this.axis>=0?this.axis:this.axis+i;s.splice(o,1);let l=lu(1,i);l[o]=a[o];let c=s.slice();c.sort();let u=!k.arraysEqual(c,Di(0,i).slice(0,i-1)),d=()=>{if(u){let g=q(this.movingMean.read(),l),y=q(this.movingVariance.read(),l),b=this.center?q(this.beta.read(),l):null,v=this.scale?q(this.gamma.read(),l):null;return Rm(r,g,y,b,v,this.epsilon)}else return Rm(r,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!n)return d();let[p,h,f]=Nce(r,this.gamma.read(),this.beta.read(),s,this.epsilon),m=(g,y,b)=>{K(()=>{let v=1-b,x=g.read(),w=G(xe(x,y),v);g.write(xe(x,w))})};return m(this.movingMean,h,this.momentum),m(this.movingVariance,f,this.momentum),p})}getConfig(){let e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Kt(this.betaInitializer),gammaInitializer:Kt(this.gammaInitializer),movingMeanInitializer:Kt(this.movingMeanInitializer),movingVarianceInitializer:Kt(this.movingVarianceInitializer),betaRegularizer:Ct(this.betaRegularizer),gammaRegularizer:Ct(this.gammaRegularizer),betaConstraint:$n(this.betaConstraint),gammaConstraint:$n(this.gammaConstraint)},t=super.getConfig();return Object.assign(e,t),e}};f2.className="BatchNormalization";le.registerClass(f2);var m2=class extends Qe{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error("Expected axis to be an integer, but received ".concat(this.axis))}else if(Array.isArray(this.axis)){for(let t of this.axis)if(!Number.isInteger(t))throw new Error("Expected axis to be an array of integers, but received ".concat(JSON.stringify(this.axis)))}else throw new Error("Expected axis to be an integer or an array of integers, but received ".concat(JSON.stringify(this.axis)));this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=Bt(e.betaInitializer||"zeros"),this.gammaInitializer=Bt(e.gammaInitializer||"ones"),this.betaRegularizer=Wt(e.betaRegularizer),this.gammaRegularizer=Wt(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=lt(e);let t=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let a=0;a<this.axis.length;++a)this.axis[a]<0&&(this.axis[a]+=t);for(let a of this.axis)if(a<0||a>=t)throw new Error("Invalid axis: ".concat(a));if(this.axis.length!==So(this.axis).length)throw new Error("Found duplicate axes in: ".concat(this.axis));let n=this.axis.map(a=>e[a]),r=!0;this.scale?this.gamma=this.addWeight("gamma",n,"float32",this.gammaInitializer,this.gammaRegularizer,r):this.gamma=null,this.center?this.beta=this.addWeight("beta",n,"float32",this.betaInitializer,this.betaRegularizer,r):this.beta=null,this.built=!0}call(e,t){let n=Oe(e),r=n.shape,a=r.length;return K(()=>{let{mean:i,variance:s}=Mg(n,this.axis,!0),o=lu(1,a);for(let h of this.axis)o[h]=r[h];let l=h=>h!=null&&h.shape.length!==a?q(h,o):h,c=this.scale?l(this.gamma.read()):null,u=this.center?l(this.beta.read()):null,d=[],p=[];for(let h=0;h<a;++h)this.axis.indexOf(h)!==-1?(d.push(r[h]),p.push(1)):(d.push(1),p.push(r[h]));return i=sa(i,d),s=sa(s,d),c!=null&&(c=sa(c,p)),u!=null&&(u=sa(u,p)),Rm(n,i,s,u,c,this.epsilon)})}getConfig(){let e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Kt(this.betaInitializer),gammaInitializer:Kt(this.gammaInitializer),betaRegularizer:Ct(this.betaRegularizer),gammaRegularizer:Ct(this.gammaRegularizer)},t=super.getConfig();return Object.assign(e,t),e}};m2.className="LayerNormalization";le.registerClass(m2);function _ce(e,t,n){return K(()=>{if(e.rank!==4)throw new X("temporalPadding expects input tensor to be 4-D, but received a ".concat(e.rank,"-D tensor."));if(t==null&&(t=[[1,1],[1,1]]),t.length!==2||t[0].length!==2||t[1].length!==2)throw new X("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=Fi()),n!=="channelsLast"&&n!=="channelsFirst")throw new X("Unknown data format: ".concat(n,". Supported data formats are 'channelsLast' and 'channelsFirst."));let r;return n==="channelsFirst"?r=[[0,0],[0,0],t[0],t[1]]:r=[[0,0],t[0],t[1],[0,0]],Oi(e,r)})}var g2=class extends Qe{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?Fi():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new X("ZeroPadding2D expects padding to be a length-2 array, but received a length-".concat(e.padding.length," array."));let t,n;if(typeof e.padding[0]=="number")t=[e.padding[0],e.padding[0]],n=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new X("ZeroPadding2D expects height padding to be a length-2 array, but received a length-".concat(e.padding[0].length," array."));if(t=e.padding[0],e.padding[1].length!==2)throw new X("ZeroPadding2D expects width padding to be a length-2 array, but received a length-".concat(e.padding[1].length," array."));n=e.padding[1]}this.padding=[t,n]}this.inputSpec=[new dn({ndim:4})]}computeOutputShape(e){e=lt(e);let t,n;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?t=e[2]+this.padding[0][0]+this.padding[0][1]:t=null,e[3]!=null&&e[3]>=0?n=e[3]+this.padding[1][0]+this.padding[1][1]:n=null,[e[0],e[1],t,n]):(e[1]!=null&&e[1]>=0?t=e[1]+this.padding[0][0]+this.padding[0][1]:t=null,e[2]!=null&&e[2]>=0?n=e[2]+this.padding[1][0]+this.padding[1][1]:n=null,[e[0],t,n,e[3]])}call(e,t){return K(()=>_ce(Oe(e),this.padding,this.dataFormat))}getConfig(){let e={padding:this.padding,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}};g2.className="ZeroPadding2D";le.registerClass(g2);function ow(e,t,n,r,a,i){return K(()=>{an(a),wz(i),za(r),n==null&&(n=[1,1]),r==null&&(r="valid"),a==null&&(a=Fi()),i==null&&(i="max"),e=LE(e,a);let s,o=r==="same"?"same":"valid";return i==="max"?s=Rn(e,t,n,o):s=Ws(e,t,n,o),a==="channelsFirst"&&(s=Ye(s,[0,3,1,2])),s})}function gB(e,t,n,r,a,i){return K(()=>{an(a),wz(i),za(r),n==null&&(n=[1,1,1]),r==null&&(r="valid"),a==null&&(a=Fi()),i==null&&(i="max"),e=dB(e,a);let s,o=r==="same"?"same":"valid";return i==="max"?s=TC(e,t,n,o):s=eC(e,t,n,o),a==="channelsFirst"&&(s=Ye(s,[0,4,1,2,3])),s})}var yB=class extends Qe{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new X("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ".concat(JSON.stringify(e.poolSize)));if(Ln(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new X("strides for 1D convolutional layer must be a number or an Array of a single number, but received ".concat(JSON.stringify(e.strides)));Ln(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,za(this.padding),this.inputSpec=[new dn({ndim:3})]}computeOutputShape(e){e=lt(e);let t=Ni(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}call(e,t){return K(()=>{this.invokeCallHook(e,t),e=Vg(Oe(e),2);let n=this.poolingFunction(Oe(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return el(n,[2])})}getConfig(){let e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=super.getConfig();return Object.assign(e,t),e}},y2=class extends yB{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return an(a),za(r),ow(e,t,n,r,a,"max")}};y2.className="MaxPooling1D";le.registerClass(y2);var b2=class extends yB{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return an(a),za(r),ow(e,t,n,r,a,"avg")}};b2.className="AveragePooling1D";le.registerClass(b2);var bB=class extends Qe{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new X("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ".concat(e.strides.length,"."));this.strides=e.strides}else this.strides=[e.strides,e.strides];Ln(this.poolSize,"poolSize"),Ln(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,an(this.dataFormat),za(this.padding),this.inputSpec=[new dn({ndim:4})]}computeOutputShape(e){e=lt(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],n=this.dataFormat==="channelsFirst"?e[3]:e[2];return t=Ni(t,this.poolSize[0],this.padding,this.strides[0]),n=Ni(n,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],t,n]:[e[0],t,n,e[3]]}call(e,t){return K(()=>(this.invokeCallHook(e,t),this.poolingFunction(Oe(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){let e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}},v2=class extends bB{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return an(a),za(r),ow(e,t,n,r,a,"max")}};v2.className="MaxPooling2D";le.registerClass(v2);var x2=class extends bB{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return an(a),za(r),ow(e,t,n,r,a,"avg")}};x2.className="AveragePooling2D";le.registerClass(x2);var vB=class extends Qe{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new X("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ".concat(e.strides.length,"."));this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];Ln(this.poolSize,"poolSize"),Ln(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,an(this.dataFormat),za(this.padding),this.inputSpec=[new dn({ndim:5})]}computeOutputShape(e){e=lt(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],n=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[4]:e[3];return t=Ni(t,this.poolSize[0],this.padding,this.strides[0]),n=Ni(n,this.poolSize[1],this.padding,this.strides[1]),r=Ni(r,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],t,n,r]:[e[0],t,n,r,e[4]]}call(e,t){return K(()=>(this.invokeCallHook(e,t),this.poolingFunction(Oe(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){let e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}},w2=class extends vB{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return an(a),za(r),gB(e,t,n,r,a,"max")}};w2.className="MaxPooling3D";le.registerClass(w2);var k2=class extends vB{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return an(a),za(r),gB(e,t,n,r,a,"avg")}};k2.className="AveragePooling3D";le.registerClass(k2);var xB=class extends Qe{constructor(e){super(e),this.inputSpec=[new dn({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,t){throw new Xe}},S2=class extends xB{constructor(e){super(e||{})}call(e,t){return K(()=>{let n=Oe(e);return Gt(n,1)})}};S2.className="GlobalAveragePooling1D";le.registerClass(S2);var I2=class extends xB{constructor(e){super(e||{})}call(e,t){return K(()=>{let n=Oe(e);return _a(n,1)})}};I2.className="GlobalMaxPooling1D";le.registerClass(I2);var wB=class extends Qe{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,an(this.dataFormat),this.inputSpec=[new dn({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,t){throw new Xe}getConfig(){let e={dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}},$2=class extends wB{call(e,t){return K(()=>{let n=Oe(e);return this.dataFormat==="channelsLast"?Gt(n,[1,2]):Gt(n,[2,3])})}};$2.className="GlobalAveragePooling2D";le.registerClass($2);var C2=class extends wB{call(e,t){return K(()=>{let n=Oe(e);return this.dataFormat==="channelsLast"?_a(n,[1,2]):_a(n,[2,3])})}};C2.className="GlobalMaxPooling2D";le.registerClass(C2);var kB=class extends Qe{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){let e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=super.getConfig();return Object.assign(e,t),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,t,n={}){let r=t.layer,a=Ti(r,n);delete t.layer;let i={layer:a};return Object.assign(i,t),new e(i)}},E2=class extends kB{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=lt(e),e.length<3)throw new X("TimeDistributed layer expects an input shape >= 3D, but received input shape ".concat(JSON.stringify(e)));this.inputSpec=[{shape:e}];let t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=lt(e);let t=[e[0]].concat(e.slice(2)),n=this.layer.computeOutputShape(t),r=e[1];return[n[0],r].concat(n.slice(1))}call(e,t){return K(()=>(e=Oe(e),fB((n,r)=>[Oe(this.layer.call(n,t)),[]],e,[],!1,null,null,!1,!0)[1]))}};E2.className="TimeDistributed";le.registerClass(E2);function Ace(e){Vc(Mle,"BidirectionalMergeMode",e)}var Rce="concat",T2=class extends kB{constructor(e){super(e);let t=e.layer.getConfig(),n={};n.className=e.layer.getClassName(),n.config=t,this.forwardLayer=Ti(n),t.goBackwards=t.goBackwards!==!0;let r={};if(r.className=e.layer.getClassName(),r.config=t,this.backwardLayer=Ti(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?Rce:e.mergeMode,Ace(this.mergeMode),e.weights)throw new Xe("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){let t=e.length,n=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,n)),this.backwardLayer.setWeights(e.slice(n))}computeOutputShape(e){let t=this.forwardLayer.computeOutputShape(e);Array.isArray(t)&&Array.isArray(t[0])||(t=[t]),t=t;let n,r,a;return this.returnState&&(a=t.slice(1)),n=t[0],n=n,this.mergeMode==="concat"?(n[n.length-1]*=2,r=[n]):this.mergeMode==null?r=[n,n.slice()]:r=[n],this.returnState?this.mergeMode==null?r.concat(a).concat(a.slice()):[n].concat(a).concat(a.slice()):Br(r)}apply(e,t){let n=t==null?null:t.initialState,r=t==null?null:t.constants;t==null&&(t={});let a=hB(e,n,r,this.numConstants);if(e=a.inputs,n=a.initialState,r=a.constants,Array.isArray(e)&&(n=e.slice(1),e=e[0]),(n==null||n.length===0)&&r==null)return super.apply(e,t);let i=[],s=[];if(n!=null){let l=n.length;if(l%2>0)throw new X("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=n,i.push(...n);let c=n.map(u=>new dn({shape:u.shape}));this.forwardLayer.stateSpec=c.slice(0,l/2),this.backwardLayer.stateSpec=c.slice(l/2),s.push(...c)}if(r!=null)throw new Xe("Support for constants in Bidirectional layers is not implemented yet.");let o=i[0]instanceof wi;for(let l of i)if(l instanceof wi!==o)throw new X("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(o){let l=[e].concat(i),c=this.inputSpec.concat(s),u=this.inputSpec;this.inputSpec=c;let d=super.apply(l,t);return this.inputSpec=u,d}else return super.apply(e,t)}call(e,t){return K(()=>{let n=t.initialState,r,a;if(n==null)r=this.forwardLayer.call(e,t),a=this.backwardLayer.call(e,t);else{let o=n.slice(0,n.length/2),l=n.slice(n.length/2);r=this.forwardLayer.call(e,Object.assign(t,{initialState:o})),a=this.backwardLayer.call(e,Object.assign(t,{initialState:l}))}let i;this.returnState&&(Array.isArray(r)&&(i=r.slice(1).concat(a.slice(1))),r=r[0],a=a[0]),this.returnSequences&&(a=Da(a,1));let s;return this.mergeMode==="concat"?s=cE([r,a]):this.mergeMode==="sum"?s=ne(r,a):this.mergeMode==="ave"?s=G(.5,ne(r,a)):this.mergeMode==="mul"?s=G(r,a):this.mergeMode==null&&(s=[r,a]),this.returnState?this.mergeMode==null?s.concat(i):[s].concat(i):s})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){Ol(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),Ol(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,t){Array.isArray(t)&&(t=t[0]);let n;if(this.returnSequences?this.mergeMode==null?n=[t,t]:n=t:this.mergeMode==null?n=[null,null]:n=null,this.returnState){let r=this.forwardLayer.states.map(a=>null);return Array.isArray(n)?n.concat(r).concat(r):[n].concat(r).concat(r)}else return n}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){let e={mergeMode:this.mergeMode},t=super.getConfig();return Object.assign(e,t),e}static fromConfig(e,t){let n=Ti(t.layer);if(delete t.layer,t.numConstants!=null)throw new Xe("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");let r=t;return r.layer=n,new e(r)}};T2.className="Bidirectional";le.registerClass(T2);var N2=class extends Qe{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){let e={scale:this.scale,offset:this.offset},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return K(()=>(e=Oe(e),e.dtype!=="float32"&&(e=Ls(e,"float32")),ne(G(e,this.scale),this.offset)))}};N2.className="Rescaling";le.registerClass(N2);var{resizeBilinear:Dce,cropAndResize:Fce}=$a,_2=class extends Qe{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,t,n,r,a,i,s,o){return K(()=>{let l,c=!1,u=t/i,d=n/s,p=(r+t)/i,h=(a+n)/s,f=[u,d,p,h],m=[];e.rank===3?(c=!0,l=Sn([e])):l=e;for(let v=0;v<l.shape[0];v++)m.push(f);let g=wr(m,[m.length,4]),y=ou(0,m.length,1,"int32"),b=Fce(l,g,y,[r,a],"nearest");return Ls(c?Oe(en(b)):b,o)})}upsize(e,t,n,r){return K(()=>{let a=Dce(e,[t,n]);return Ls(a,r)})}call(e,t){return K(()=>{let n=Oe(e),r=n.dtype,a=n.shape,i=a[a.length-3],s=a[a.length-2],o=0;i!==this.height&&(o=Math.floor((i-this.height)/2));let l=0;return s!==this.width&&(l=Math.floor((s-this.width)/2),l===0&&(l=1)),o>=0&&l>=0?this.centerCrop(n,o,l,this.height,this.width,i,s,r):this.upsize(e,this.height,this.width,r)})}getConfig(){let e={height:this.height,width:this.width},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){e=lt(e);let t=e.length-3,n=e.length-2;return e[t]=this.height,e[n]=this.width,e}};_2.className="CenterCrop";le.registerClass(_2);function Mce(e,t,n,r){let a=Oe(e);if(a.dtype!=="int32"&&(a=Ls(a,"int32")),t==="int")return a;let i=a.shape;if(a.rank===0&&(a=Vn(a,-1)),t==="oneHot"&&a.shape[a.shape.length-1]!==1&&(a=Vn(a,-1)),a.rank>2)throw new X("When outputMode is not int, maximum output rank is 2 Received outputMode ".concat(t," and input shape ").concat(i," which would result in output rank ").concat(a.rank,"."));let s=["multiHot","oneHot"].includes(t),o=a,l;if(typeof r<"u"&&t==="count"?l=Cv(o,r,n,s):l=Cv(o,[],n,s),t!=="tfIdf")return l;if(r)return G(l,r);throw new X("When outputMode is 'tfIdf', weights must be provided.")}var A2=class extends Qe{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){let e={numTokens:this.numTokens,outputMode:this.outputMode},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){return e=lt(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,t){return K(()=>{e=Oe(e),e.dtype!=="int32"&&(e=Ls(e,"int32"));let n;if(typeof t.countWeights<"u"){if(this.outputMode!=="count")throw new X("countWeights is not used when outputMode !== count.\n              Received countWeights=".concat(t.countWeights));n=Oe(t.countWeights)}let r=_a(e),a=sp(e),i=Dr(this.numTokens,r).bufferSync().get(0),s=Us(a,0).bufferSync().get(0);if(!(i&&s))throw new X("Input values must be between 0 < values <= numTokens with numTokens=".concat(this.numTokens));return Mce(e,this.outputMode,this.numTokens,n)})}};A2.className="CategoryEncoding";le.registerClass(A2);var Oce=["bilinear","nearest"],RR=new Set(Oce),R2=class extends Qe{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(RR.has(e.interpolation))this.interpolation=e.interpolation;else throw new X("Invalid interpolation parameter: ".concat(e.interpolation," is not implemented"));else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=lt(e);let t=e[2];return[this.height,this.width,t]}getConfig(){let e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return K(()=>{let n=[this.height,this.width];if(this.interpolation==="bilinear")return $a.resizeBilinear(e,n,!this.cropToAspectRatio);if(this.interpolation==="nearest")return $a.resizeNearestNeighbor(e,n,!this.cropToAspectRatio);throw new Error("Interpolation is ".concat(this.interpolation," but only ").concat([...RR]," are supported"))})}};R2.className="Resizing";le.registerClass(R2);var SB=class{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}};SB.className="RandomSeed";var IB=class extends Qe{constructor(e){super(e),this.randomGenerator=new SB(e.seed)}getConfig(){let e={seed:this.randomGenerator.seed},t=super.getConfig();return Object.assign(e,t),e}};IB.className="BaseRandomLayer";var Lce=["bilinear","nearest"],DR=new Set(Lce),D2=class extends IB{constructor(e){super(e);let{factor:t,interpolation:n="bilinear"}=e;if(this.factor=t,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new X("Invalid factor: ".concat(this.factor,". Must be positive number or tuple of 2 numbers"));if(this.widthLower<-1||this.widthUpper<-1)throw new X("factor must have values larger than -1. Got: ".concat(this.factor));if(this.widthUpper<this.widthLower)throw new X("factor cannot have upper bound less than lower bound.\n        Got upper bound: ".concat(this.widthUpper,".\n        Got lower bound: ").concat(this.widthLower,"\n      "));if(n)if(DR.has(n))this.interpolation=n;else throw new X("Invalid interpolation parameter: ".concat(n," is not implemented"))}getConfig(){let e={factor:this.factor,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){e=lt(e);let t=e[2];return[this.imgHeight,-1,t]}call(e,t){return K(()=>{let n=Oe(e);this.imgHeight=n.shape[n.shape.length-3];let r=n.shape[n.shape.length-2];this.widthFactor=Qo([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let a=this.widthFactor.dataSync()[0]*r;a=Math.round(a);let i=[this.imgHeight,a];switch(this.interpolation){case"bilinear":return $a.resizeBilinear(e,i);case"nearest":return $a.resizeNearestNeighbor(e,i);default:throw new Error("Interpolation is ".concat(this.interpolation,"\n          but only ").concat([...DR]," are supported"))}})}};D2.className="RandomWidth";le.registerClass(D2);function Pce(e){return new Uh(e)}function zce(e){return new FE(e)}function Bce(e){return new AE(e)}function Wce(e){return new RE(e)}function Uce(e){return new DE(e)}function Vce(e){return new OE(e)}function Hce(e){return new ME(e)}function jce(e){return new tw(e)}function Gce(e){return new Xg(e)}function qce(e){return new zE(e)}function Kce(e){return new Yg(e)}function Xce(e){return new BE(e)}function Yce(e){return new WE(e)}function Zce(e){return new UE(e)}function Qce(e){return new VE(e)}function Jce(e){return new HE(e)}function ede(e){return new QE(e)}function tde(e){return new YE(e)}function nde(e){return new sw(e)}function rde(e){return new XE(e)}function ade(e){return new ZE(e)}function ide(e){return new JE(e)}function sde(e){return new e2(e)}function ode(e){return new t2(e)}function lde(e){return new r2(e)}function ude(e){return new a2(e)}function cde(e){return new s2(e)}function dde(e){return new u2(e)}function pde(e){return new o2(e)}function hde(e){return new l2(e)}function fde(e){return new i2(e)}function mde(e){return new c2(e)}function gde(e){return new f2(e)}function yde(e){return new m2(e)}function bde(e){return new g2(e)}function F2(e){return new b2(e)}function vde(e){return F2(e)}function xde(e){return F2(e)}function M2(e){return new x2(e)}function wde(e){return M2(e)}function kde(e){return M2(e)}function O2(e){return new k2(e)}function Sde(e){return O2(e)}function Ide(e){return O2(e)}function $de(e){return new S2(e)}function Cde(e){return new $2(e)}function $B(e){return new I2(e)}function CB(e){return new C2(e)}function EB(e){return new y2(e)}function TB(e){return new v2(e)}function Ede(e){return new w2(e)}function Tde(e){return new GE(e)}function Nde(e){return new rw(e)}function _de(e){return new qE(e)}function Ade(e){return new Qg(e)}function Rde(e){return new jE(e)}function Dde(e){return new nw(e)}function Fde(e){return new KE(e)}function Mde(e){return new iw(e)}function Ode(e){return new cs(e)}function Lde(e){return new aw(e)}function Pde(e){return new T2(e)}function zde(e){return new E2(e)}var Bde=$B,Wde=CB,Ude=EB,Vde=TB;function Hde(e){return new d2(e)}function jde(e){return new p2(e)}function Gde(e){return new h2(e)}function qde(e){return new n2(e)}function Kde(e){return new N2(e)}function Xde(e){return new _2(e)}function Yde(e){return new R2(e)}function Zde(e){return new A2(e)}function Qde(e){return new D2(e)}var NB={};Ue(NB,{MAPE:()=>upe,MSE:()=>ppe,binaryAccuracy:()=>Jde,binaryCrossentropy:()=>epe,categoricalAccuracy:()=>npe,categoricalCrossentropy:()=>rpe,cosineProximity:()=>spe,mape:()=>cpe,meanAbsoluteError:()=>ope,meanAbsolutePercentageError:()=>lpe,meanSquaredError:()=>dpe,mse:()=>hpe,precision:()=>ape,recall:()=>ipe,sparseCategoricalAccuracy:()=>tpe});function Jde(e,t){return $E(e,t)}function epe(e,t){return Wz(e,t)}function tpe(e,t){return Uz(e,t)}function npe(e,t){return CE(e,t)}function rpe(e,t){return EE(e,t)}function ape(e,t){return Bz(e,t)}function ipe(e,t){return zue(e,t)}function spe(e,t){return IE(e,t)}function ope(e,t){return Jx(e,t)}function lpe(e,t){return Vh(e,t)}function upe(e,t){return Vh(e,t)}function cpe(e,t){return Vh(e,t)}function dpe(e,t){return Hc(e,t)}function ppe(e,t){return Hc(e,t)}function hpe(e,t){return Hc(e,t)}var _B={};Ue(_B,{modelFromJSON:()=>hce});var AB={};Ue(AB,{l1:()=>mpe,l1l2:()=>fpe,l2:()=>gpe});function fpe(e){return new qg(e)}function mpe(e){return xce(e)}function gpe(e){return wce(e)}var RB=class extends mp{constructor(){super(...arguments),this.model=null}setModel(e){if(!(e instanceof Ts))throw new Error("model must be a LayersModel, not some other Container");this.model=e}};function Ky(e,t){return e<t}function FR(e,t){return e>t}var DB=class extends RB{constructor(e){if(super(),e==null&&(e={}),e.restoreBestWeights)throw new Xe("restoreBestWeights = True is not implemented in EarlyStopping yet.");this.monitor=e.monitor||"val_loss",this.minDelta=Math.abs(e.minDelta||0),this.patience=e.patience||0,this.verbose=e.verbose||0,this.mode=e.mode||"auto",this.baseline=e.baseline,["auto","min","max"].indexOf(this.mode)===-1&&(console.warn("EarlyStopping mode '".concat(this.mode,"' is invalid. Falling back to mode 'auto'.")),this.mode="auto"),this.mode==="min"?this.monitorFunc=Ky:this.mode==="max"?this.monitorFunc=FR:this.monitor.indexOf("acc")!==-1?this.monitorFunc=FR:this.monitorFunc=Ky,this.monitorFunc===Ky&&(this.minDelta*=-1)}async onTrainBegin(e){this.wait=0,this.stoppedEpoch=0,this.baseline!=null?this.best=this.baseline:this.best=this.monitorFunc===Ky?1/0:-1/0}async onEpochEnd(e,t){await Zs(t);let n=this.getMonitorValue(t);n!=null&&(this.monitorFunc(n-this.minDelta,this.best)?(this.best=n,this.wait=0):(this.wait++,this.wait>=this.patience&&(this.stoppedEpoch=e,this.model.stopTraining=!0)))}async onTrainEnd(e){this.stoppedEpoch>0&&this.verbose&&console.log("Epoch ".concat(this.stoppedEpoch,": early stopping."))}getMonitorValue(e){e==null&&(e={});let t=e[this.monitor];return t==null&&console.warn("Metric for EarlyStopping ".concat(this.monitor," is not available. Available metrics are: ").concat(Object.keys(e))),t}};function ype(e){return new DB(e)}var bpe={earlyStopping:ype},vpe=Z();vpe.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,e=>{e&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});var Ua;(function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_QINT16=15]="DT_QINT16",e[e.DT_QUINT16=16]="DT_QUINT16",e[e.DT_UINT16=17]="DT_UINT16",e[e.DT_COMPLEX128=18]="DT_COMPLEX128",e[e.DT_HALF=19]="DT_HALF",e[e.DT_RESOURCE=20]="DT_RESOURCE",e[e.DT_VARIANT=21]="DT_VARIANT",e[e.DT_UINT32=22]="DT_UINT32",e[e.DT_UINT64=23]="DT_UINT64",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",e[e.DT_QINT16_REF=115]="DT_QINT16_REF",e[e.DT_QUINT16_REF=116]="DT_QUINT16_REF",e[e.DT_UINT16_REF=117]="DT_UINT16_REF",e[e.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",e[e.DT_HALF_REF=119]="DT_HALF_REF",e[e.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",e[e.DT_VARIANT_REF=121]="DT_VARIANT_REF",e[e.DT_UINT32_REF=122]="DT_UINT32_REF",e[e.DT_UINT64_REF=123]="DT_UINT64_REF"})(Ua||(Ua={}));var MR;(function(e){(function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"})(e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))})(MR||(MR={}));var L2={};function xpe(e,t){let n={tfOpName:e,category:"custom",inputs:[],attrs:[],customExecutor:t};L2[e]=n}function FB(e){return L2[e]}function wpe(e){delete L2[e]}function S(e,t,n,r,a){let i=t.inputParams[e];if(i&&i.inputIndexStart!==void 0){let o=i.inputIndexStart,l=i.inputIndexEnd===0?void 0:i.inputIndexEnd===void 0?o+1:i.inputIndexEnd,c=o<0?t.inputNames.length+o:o;if(i.type==="tensor")return Hn(t.inputNames[c],n,r,a);if(i.type==="tensors"){let p=t.inputs.slice(o,l);return t.inputNames.slice(o,l).filter((h,f)=>{var m;return((m=p[f])===null||m===void 0?void 0:m.op)!=="NoOp"}).map(h=>Hn(h,n,r,a))}let u=Hn(t.inputNames[c],n,r,a),d=u.dataSync();return i.type==="number"?d[0]:k.toNestedArray(u.shape,d)}let s=t.attrParams[e];return s&&s.value}function Hn(e,t,n,r){let[a,i]=ta(e,n);if(r!=null){let o=r.getHashTableHandleByName(a);if(o!=null)return o}let s=n.currentContextIds.find(o=>!!t[Ov(a,o)]);return s!==void 0?t[Ov(a,s)][i]:void 0}function OR(e,t,n){return t[Ov(e,n.currentContextId)]}function vs(e,t){let[n,r,a]=ta(e,t);return[Ov(n,t&&t.currentContextId),r,a]}function Ov(e,t){return t?"".concat(e,"-").concat(t):e}function ta(e,t){if(e==="")return["",0,void 0];let n=t!=null&&t.parseNodeNameCache!=null;if(n){let i=t.parseNodeNameCache.get(e);if(i!=null)return i}let r=e.split(":"),a;if(r.length===1)a=[e,0,void 0];else{let i=r[0],s=r.length===3?r[1]:void 0,o=Number(r[r.length-1]);a=[i,o,s]}return n&&t.parseNodeNameCache.set(e,a),a}function kb(e,t,n){let r=S("pad",e,t,n);if(r==="explicit"){r=S("explicitPaddings",e,t,n);let a=[[0,0],[0,0],[0,0],[0,0]];for(let i=0;i<4;i++)a[i][0]=r[i*2],a[i][1]=r[i*2+1];return a}return r}function xs(e){return e.kept?e:es(e)}var MB={};Ue(MB,{json:()=>kpe});var kpe=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],OB={};Ue(OB,{json:()=>Spe});var Spe=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],LB={};Ue(LB,{json:()=>Ipe});var Ipe=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],PB={};Ue(PB,{json:()=>$pe});var $pe=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],zB={};Ue(zB,{json:()=>Cpe});var Cpe=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],BB={};Ue(BB,{json:()=>Epe});var Epe=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],WB={};Ue(WB,{json:()=>Tpe});var Tpe=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],UB={};Ue(UB,{json:()=>Npe});var Npe=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],VB={};Ue(VB,{json:()=>_pe});var _pe=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],HB={};Ue(HB,{json:()=>Ape});var Ape=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],jB={};Ue(jB,{json:()=>Rpe});var Rpe=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],GB={};Ue(GB,{json:()=>Dpe});var Dpe=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],qB={};Ue(qB,{json:()=>Fpe});var Fpe=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],KB={};Ue(KB,{json:()=>Mpe});var Mpe=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],XB={};Ue(XB,{json:()=>Ope});var Ope=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],YB={};Ue(YB,{json:()=>Lpe});var Lpe=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],ZB={};Ue(ZB,{json:()=>Ppe});var Ppe=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],QB={};Ue(QB,{json:()=>zpe});var zpe=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],JB={};Ue(JB,{json:()=>Bpe});var Bpe=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],LR=class{static get Instance(){return this._instance||(this._instance=new this)}constructor(){let e=[MB,OB,LB,PB,zB,BB,WB,UB,VB,HB,jB,GB,qB,KB,XB,YB,ZB,QB,JB],t=[].concat(...e.map(n=>n.json));this.opMappers=t.reduce((n,r)=>(n[r.tfOpName]=r,n),{})}transformGraph(e,t={}){let n=e.node,r=[],a=[],i=[],s=n.reduce((f,m)=>(f[m.name]=this.mapNode(m),m.op.startsWith("Placeholder")?r.push(f[m.name]):m.op==="Const"?a.push(f[m.name]):(m.input==null||m.input.length===0)&&i.push(f[m.name]),f),{}),o=[],l=[],c={},u={};t!=null&&(c=this.mapSignatureEntries(t.inputs),u=this.mapSignatureEntries(t.outputs));let d=Object.keys(s);d.forEach(f=>{let m=s[f];m.inputNames.forEach((g,y)=>{let[b,,v]=vs(g),x=s[b];if(x.outputs!=null){let w=x.outputs.indexOf(v);if(w!==-1){let $="".concat(b,":").concat(w);m.inputNames[y]=$}}m.inputs.push(x),x.children.push(m)})}),Object.keys(u).length===0?d.forEach(f=>{let m=s[f];m.children.length===0&&l.push(m)}):Object.keys(u).forEach(f=>{let[m]=vs(f),g=s[m];g!=null&&(g.signatureKey=u[f],l.push(g))}),Object.keys(c).length>0?Object.keys(c).forEach(f=>{let[m]=vs(f),g=s[m];g&&(g.signatureKey=c[f],o.push(g))}):o=r;let p={};e.library!=null&&e.library.function!=null&&(p=e.library.function.reduce((f,m)=>(f[m.signature.name]=this.mapFunction(m),f),{}));let h={nodes:s,inputs:o,outputs:l,weights:a,placeholders:r,signature:t,functions:p};return i.length>0&&(h.initNodes=i),h}mapSignatureEntries(e){return Object.keys(e||{}).reduce((t,n)=>(t[e[n].name]=n,t),{})}mapNode(e){let t=FB(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});let n={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map(r=>r.startsWith("^")?r.slice(1):r),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:t.outputs};return t.inputs!=null&&(n.inputParams=t.inputs.reduce((r,a)=>(r[a.name]={type:a.type,inputIndexStart:a.start,inputIndexEnd:a.end},r),{})),t.attrs!=null&&(n.attrParams=t.attrs.reduce((r,a)=>{let i=a.type,s;switch(a.type){case"string":s=bS(e.attr,a.tfName,a.defaultValue),s===void 0&&a.tfDeprecatedName&&(s=bS(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"string[]":s=$S(e.attr,a.tfName,a.defaultValue),s===void 0&&a.tfDeprecatedName&&(s=$S(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"number":s=xS(e.attr,a.tfName,a.defaultValue||0),s===void 0&&a.tfDeprecatedName&&(s=xS(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"number[]":s=IS(e.attr,a.tfName,a.defaultValue),s===void 0&&a.tfDeprecatedName&&(s=IS(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"bool":s=vS(e.attr,a.tfName,a.defaultValue),s===void 0&&a.tfDeprecatedName&&(s=vS(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"bool[]":s=ES(e.attr,a.tfName,a.defaultValue),s===void 0&&a.tfDeprecatedName&&(s=ES(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"shape":s=SS(e.attr,a.tfName,a.defaultValue),s===void 0&&a.tfDeprecatedName&&(s=SS(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"shape[]":s=CS(e.attr,a.tfName,a.defaultValue),s===void 0&&a.tfDeprecatedName&&(s=CS(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"dtype":s=wS(e.attr,a.tfName,a.defaultValue),s===void 0&&a.tfDeprecatedName&&(s=wS(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"dtype[]":s=kS(e.attr,a.tfName,a.defaultValue),s===void 0&&a.tfDeprecatedName&&(s=kS(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"func":s=PR(e.attr,a.tfName,a.defaultValue),s===void 0&&a.tfDeprecatedName&&(s=PR(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: ".concat(a.type," for op: ").concat(e.op))}return r[a.name]={value:s,type:i},r},{})),n}mapFunction(e){let t=e.nodeDef,n=[],r=[],a={};t!=null&&(a=t.reduce((c,u)=>(c[u.name]=this.mapNode(u),u.op==="Const"&&r.push(c[u.name]),c),{}));let i=[],s=[];e.signature.inputArg.forEach(c=>{let[u]=vs(c.name),d={name:u,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:P2(c.type),type:"dtype"}},children:[]};d.signatureKey=c.name,i.push(d),a[u]=d}),Object.keys(a).forEach(c=>{let u=a[c];u.inputNames.forEach((d,p)=>{let[h,,f]=vs(d),m=a[h];if(m.outputs!=null){let g=m.outputs.indexOf(f);if(g!==-1){let y="".concat(h,":").concat(g);u.inputNames[p]=y}}u.inputs.push(m),m.children.push(u)})});let o=e.ret;e.signature.outputArg.forEach(c=>{let[u,d]=vs(o[c.name]),p=a[u];p!=null&&(p.defaultOutput=d,s.push(p))});let l=this.mapArgsToSignature(e);return{nodes:a,inputs:i,outputs:s,weights:r,placeholders:n,signature:l}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((t,n)=>(t[n.name]=this.mapArgToTensorInfo(n),t),{}),outputs:e.signature.outputArg.reduce((t,n)=>(t[n.name]=this.mapArgToTensorInfo(n,e.ret),t),{})}}mapArgToTensorInfo(e,t){let n=e.name;return t!=null&&(n=t[n]),{name:n,dtype:e.type}}};function Wpe(e){let t=Z().global;if(typeof t.atob<"u")return t.atob(e);if(typeof Buffer<"u")return new Buffer(e,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function eW(e,t){let n=Array.isArray(e)?String.fromCharCode.apply(null,e):Wpe(e);return t?n:n.toLowerCase()}function bS(e,t,n,r=!1){let a=e[t];return a!=null?eW(a.s,r):n}function vS(e,t,n){let r=e[t];return r?r.b:n}function xS(e,t,n){let r=e[t]||{},a=r.i!=null?r.i:r.f!=null?r.f:n;return typeof a=="number"?a:parseInt(a,10)}function P2(e){switch(typeof e=="string"&&(e=Ua[e]),e){case Ua.DT_FLOAT:case Ua.DT_HALF:return"float32";case Ua.DT_INT32:case Ua.DT_INT64:case Ua.DT_INT8:case Ua.DT_UINT8:return"int32";case Ua.DT_BOOL:return"bool";case Ua.DT_DOUBLE:return"float32";case Ua.DT_STRING:return"string";default:return null}}function PR(e,t,n){let r=e[t];return r&&r.func?r.func.name:n}function wS(e,t,n){let r=e[t];return r&&r.type?P2(r.type):n}function kS(e,t,n){let r=e[t];return r&&r.list&&r.list.type?r.list.type.map(a=>P2(a)):n}function tW(e){if(!e.unknownRank)return e.dim!=null?e.dim.map(t=>typeof t.size=="number"?t.size:parseInt(t.size,10)):[]}function SS(e,t,n){let r=e[t];return r&&r.shape?tW(r.shape):n}function IS(e,t,n){let r=e[t];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map(a=>typeof a=="number"?a:parseInt(a,10)):n}function $S(e,t,n,r=!1){let a=e[t];return a&&a.list&&a.list.s?a.list.s.map(i=>eW(i,r)):n}function CS(e,t,n){let r=e[t];return r&&r.list&&r.list.shape?r.list.shape.map(a=>tW(a)):n}function ES(e,t,n){let r=e[t];return r&&r.list&&r.list.b?r.list.b:n}var Upe=class{constructor(e,t,n){this.node=e,this.tensorMap=t,this.context=n,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(r=>this.getInput(r)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((r,a)=>(r[a]=this.getAttr(a),r),{}))}getInput(e){return Hn(e,this.tensorMap,this.context)}getAttr(e,t){let n=this.node.rawAttrs[e];if(n.tensor!=null)return Hn(e,this.tensorMap,this.context);if(n.i!=null||n.f!=null)return xS(this.node.rawAttrs,e,t);if(n.s!=null)return bS(this.node.rawAttrs,e,t);if(n.b!=null)return vS(this.node.rawAttrs,e,t);if(n.shape!=null)return SS(this.node.rawAttrs,e,t);if(n.type!=null)return wS(this.node.rawAttrs,e,t);if(n.list!=null){if(n.list.i!=null||n.list.f!=null)return IS(this.node.rawAttrs,e,t);if(n.list.s!=null)return $S(this.node.rawAttrs,e,t);if(n.list.shape!=null)return CS(this.node.rawAttrs,e,t);if(n.list.b!=null)return ES(this.node.rawAttrs,e,t);if(n.list.type!=null)return kS(this.node.rawAttrs,e,t)}return t}},Bn={};Ue(Bn,{OP_SCOPE_SUFFIX:()=>W$,abs:()=>un,acos:()=>j$,acosh:()=>G$,add:()=>ne,addN:()=>NP,all:()=>dx,any:()=>Cm,argMax:()=>nu,argMin:()=>q$,asin:()=>K$,asinh:()=>X$,atan:()=>Y$,atan2:()=>Z$,atanh:()=>Q$,avgPool:()=>Ws,avgPool3d:()=>eC,basicLSTMCell:()=>DP,batchNorm:()=>zc,batchNorm2d:()=>tC,batchNorm3d:()=>nC,batchNorm4d:()=>rC,batchToSpaceND:()=>Ng,bincount:()=>aC,bitwiseAnd:()=>FP,booleanMaskAsync:()=>I3,broadcastArgs:()=>MP,broadcastTo:()=>Ml,buffer:()=>Ze,cast:()=>de,ceil:()=>iC,clipByValue:()=>lr,clone:()=>es,complex:()=>Ms,concat:()=>wt,concat1d:()=>sC,concat2d:()=>oC,concat3d:()=>lC,concat4d:()=>uC,conv1d:()=>px,conv2d:()=>$r,conv2dTranspose:()=>hx,conv3d:()=>dC,conv3dTranspose:()=>pC,cos:()=>_g,cosh:()=>fx,cosineWindow:()=>Lx,cumprod:()=>Nm,cumsum:()=>mx,denseBincount:()=>Cv,depthToSpace:()=>hC,depthwiseConv2d:()=>Bc,diag:()=>LP,dilation2d:()=>fC,div:()=>ke,divNoNan:()=>mC,dot:()=>gC,dropout:()=>GC,einsum:()=>zP,elu:()=>Mh,enclosingPowerOfTwo:()=>qC,ensureShape:()=>BP,equal:()=>ha,erf:()=>yC,euclideanNorm:()=>xC,exp:()=>Cr,expandDims:()=>Vn,expm1:()=>wC,eye:()=>gx,fft:()=>zg,fill:()=>da,floor:()=>Lh,floorDiv:()=>cx,fused:()=>pp,gather:()=>Ph,gatherND:()=>T3,greater:()=>Dr,greaterEqual:()=>Us,ifft:()=>dp,imag:()=>Ag,image:()=>$a,inTopKAsync:()=>N3,irfft:()=>_x,isFinite:()=>kC,isInf:()=>SC,isNaN:()=>IC,leakyRelu:()=>Rg,less:()=>op,lessEqual:()=>Zo,linalg:()=>YC,linspace:()=>jP,localResponseNormalization:()=>$C,log:()=>fa,log1p:()=>Dg,logSigmoid:()=>CC,logSoftmax:()=>bx,logSumExp:()=>vx,logicalAnd:()=>ti,logicalNot:()=>Fg,logicalOr:()=>xx,logicalXor:()=>EC,losses:()=>W3,lowerBound:()=>qP,matMul:()=>Ke,max:()=>_a,maxPool:()=>Rn,maxPool3d:()=>TC,maxPoolWithArgmax:()=>KP,maximum:()=>ls,mean:()=>Gt,meshgrid:()=>XP,min:()=>sp,minimum:()=>Do,mirrorPad:()=>NC,mod:()=>_C,moments:()=>Mg,movingAverage:()=>$3,mul:()=>G,multiRNNCell:()=>YP,multinomial:()=>ZP,neg:()=>_t,norm:()=>Oh,notEqual:()=>su,oneHot:()=>lp,ones:()=>oa,onesLike:()=>ma,op:()=>H,outerProduct:()=>QP,pad:()=>Oi,pad1d:()=>JP,pad2d:()=>e3,pad3d:()=>t3,pad4d:()=>n3,pool:()=>AC,pow:()=>Os,prelu:()=>Lg,print:()=>H$,prod:()=>RC,raggedGather:()=>r3,raggedRange:()=>a3,raggedTensorToTensor:()=>i3,rand:()=>s3,randomGamma:()=>c3,randomNormal:()=>kx,randomStandardNormal:()=>d3,randomUniform:()=>Qo,randomUniformInt:()=>p3,range:()=>ou,real:()=>up,reciprocal:()=>LC,relu:()=>ft,relu6:()=>Sx,reshape:()=>q,reverse:()=>Da,reverse1d:()=>h3,reverse2d:()=>f3,reverse3d:()=>m3,reverse4d:()=>g3,rfft:()=>Bg,round:()=>Ix,rsqrt:()=>$x,scalar:()=>Ae,scatterND:()=>C3,searchSorted:()=>wx,selu:()=>Cx,separableConv2d:()=>zh,setdiff1dAsync:()=>y3,sigmoid:()=>Qa,sign:()=>PC,signal:()=>B3,sin:()=>Ex,sinh:()=>Tx,slice:()=>et,slice1d:()=>Pg,slice2d:()=>Nx,slice3d:()=>Bh,slice4d:()=>cp,softmax:()=>Jo,softplus:()=>Wc,spaceToBatchND:()=>Og,sparse:()=>U3,sparseToDense:()=>E3,spectral:()=>z3,split:()=>Ur,sqrt:()=>Kn,square:()=>vt,squaredDifference:()=>Ax,squeeze:()=>el,stack:()=>Sn,step:()=>Uc,stridedSlice:()=>zC,string:()=>V3,sub:()=>xe,sum:()=>Se,tan:()=>BC,tanh:()=>au,tensor:()=>wr,tensor1d:()=>ht,tensor2d:()=>ts,tensor3d:()=>Rx,tensor4d:()=>Fo,tensor5d:()=>b3,tensor6d:()=>v3,tensorScatterUpdate:()=>w3,tile:()=>sa,topk:()=>UC,transpose:()=>Ye,truncatedNormal:()=>Mx,unique:()=>VC,unsortedSegmentSum:()=>Ox,unstack:()=>en,upperBound:()=>k3,variable:()=>HC,where:()=>Pn,whereAsync:()=>jC,zeros:()=>qt,zerosLike:()=>nt});var Vpe=(e,t,n,r=Bn)=>{switch(e.op){case"BiasAdd":case"AddV2":case"Add":return[r.add(S("a",e,t,n),S("b",e,t,n))];case"AddN":return[r.addN(S("tensors",e,t,n))];case"FloorMod":case"Mod":return[r.mod(S("a",e,t,n),S("b",e,t,n))];case"Mul":return[r.mul(S("a",e,t,n),S("b",e,t,n))];case"RealDiv":case"Div":return[r.div(S("a",e,t,n),S("b",e,t,n))];case"DivNoNan":return[r.divNoNan(S("a",e,t,n),S("b",e,t,n))];case"FloorDiv":return[r.floorDiv(S("a",e,t,n),S("b",e,t,n))];case"Sub":return[r.sub(S("a",e,t,n),S("b",e,t,n))];case"Minimum":return[r.minimum(S("a",e,t,n),S("b",e,t,n))];case"Maximum":return[r.maximum(S("a",e,t,n),S("b",e,t,n))];case"Pow":return[r.pow(S("a",e,t,n),S("b",e,t,n))];case"SquaredDifference":return[r.squaredDifference(S("a",e,t,n),S("b",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},Hpe=(e,t,n,r=Bn)=>{switch(e.op){case"Abs":case"ComplexAbs":return[r.abs(S("x",e,t,n))];case"Acos":return[r.acos(S("x",e,t,n))];case"Acosh":return[r.acosh(S("x",e,t,n))];case"Asin":return[r.asin(S("x",e,t,n))];case"Asinh":return[r.asinh(S("x",e,t,n))];case"Atan":return[r.atan(S("x",e,t,n))];case"Atan2":return[r.atan2(S("x",e,t,n),S("y",e,t,n))];case"Atanh":return[r.atanh(S("x",e,t,n))];case"Ceil":return[r.ceil(S("x",e,t,n))];case"Complex":return[r.complex(S("real",e,t,n),S("imag",e,t,n))];case"Cos":return[r.cos(S("x",e,t,n))];case"Cosh":return[r.cosh(S("x",e,t,n))];case"Elu":return[r.elu(S("x",e,t,n))];case"Erf":return[r.erf(S("x",e,t,n))];case"Exp":return[r.exp(S("x",e,t,n))];case"Expm1":return[r.expm1(S("x",e,t,n))];case"Floor":return[r.floor(S("x",e,t,n))];case"Log":return[r.log(S("x",e,t,n))];case"Log1p":return[r.log1p(S("x",e,t,n))];case"Imag":return[r.imag(S("x",e,t,n))];case"Neg":return[r.neg(S("x",e,t,n))];case"Reciprocal":return[r.reciprocal(S("x",e,t,n))];case"Real":return[r.real(S("x",e,t,n))];case"Relu":return[r.relu(S("x",e,t,n))];case"Round":return[r.round(S("x",e,t,n))];case"Selu":return[r.selu(S("x",e,t,n))];case"Sigmoid":return[r.sigmoid(S("x",e,t,n))];case"Sin":return[r.sin(S("x",e,t,n))];case"Sign":return[r.sign(S("x",e,t,n))];case"Sinh":return[r.sinh(S("x",e,t,n))];case"Softplus":return[r.softplus(S("x",e,t,n))];case"Sqrt":return[r.sqrt(S("x",e,t,n))];case"Square":return[r.square(S("x",e,t,n))];case"Tanh":return[r.tanh(S("x",e,t,n))];case"Tan":return[r.tan(S("x",e,t,n))];case"ClipByValue":return[r.clipByValue(S("x",e,t,n),S("clipValueMin",e,t,n),S("clipValueMax",e,t,n))];case"Relu6":return[r.relu6(S("x",e,t,n))];case"Rsqrt":return[r.rsqrt(Hn(e.inputNames[0],t,n))];case"LeakyRelu":return[r.leakyRelu(S("x",e,t,n),S("alpha",e,t,n))];case"Prelu":return[r.prelu(S("x",e,t,n),S("alpha",e,t,n))];case"IsNan":return[r.isNaN(Hn(e.inputNames[0],t,n))];case"IsInf":return[r.isInf(Hn(e.inputNames[0],t,n))];case"IsFinite":return[r.isFinite(Hn(e.inputNames[0],t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}};function Ga(e,t,n=""){if(!(typeof e=="number"||typeof t=="number")){k.assert(e.length===t.length,()=>n+" Shapes ".concat(e," and ").concat(t," must match"));for(let r=0;r<e.length;r++){let a=e[r],i=t[r];k.assert(a<0||i<0||a===i,()=>n+" Shapes ".concat(e," and ").concat(t," must match"))}}}function zR(e){return!(typeof e=="number"||e.some(t=>t<0))}function yf(e,t,n){let r=TS(e,n),a=!zR(r);if(a&&t.length===0)throw new Error("Tried to calculate elements of an empty list with non-fully-defined elementShape: ".concat(r));if(a&&t.forEach(i=>{r=TS(i.shape,r)}),!zR(r))throw new Error("Non-fully-defined elementShape: ".concat(r));return r}function TS(e,t){if(typeof e=="number")return t;if(typeof t=="number")return e;if(e.length!==t.length)throw new Error("Incompatible ranks during merge: ".concat(e," vs. ").concat(t));let n=[];for(let r=0;r<e.length;++r){let a=e[r],i=t[r];if(a>=0&&i>=0&&a!==i)throw new Error("Incompatible shape during merge: ".concat(e," vs. ").concat(t));n[r]=a>=0?a:i}return n}var jpe=class{constructor(e,t,n,r,a,i,s){this.name=e,this.dtype=t,this.maxSize=n,this.elementShape=r,this.identicalElementShapes=a,this.dynamicSize=i,this.clearAfterRead=s,this.tensors=[],this.closed_=!1,this.idTensor=Ae(0),wn(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(t=>{(e==null||!e.has(t.tensor.id))&&t.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(e<0||e>=this.size())throw new Error("Tried to read from index ".concat(e,", but array size is: ").concat(this.size()));let t=this.tensors[e];if(t.cleared)throw new Error("TensorArray ".concat(this.name,": Could not read index ").concat(e," twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?)."));return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}readMany(e){return e.map(t=>this.read(t))}write(e,t){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error("Tried to write to index ".concat(e,", but array is not resizeable and size is: ").concat(this.maxSize));let n=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,",\n          because the value dtype is ").concat(t.dtype,", but TensorArray dtype is ").concat(this.dtype,"."));if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=t.shape),Ga(this.elementShape,t.shape,"TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,".")),n.read)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,", because it has already been read."));if(n.written)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,", because it has already been written."));n.tensor=t,wn(t),n.written=!0,this.tensors[e]=n}writeMany(e,t){if(e.length!==t.length)throw new Error("TensorArray ".concat(this.name,": could not write multiple tensors,because the index size: ").concat(e.length," is not the same as tensors size: ").concat(t.length,"."));e.forEach((n,r)=>this.write(n,t[r]))}gather(e,t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but gather requested dtype ").concat(t));if(e)e=e.slice(0,this.size());else{e=[];for(let r=0;r<this.size();r++)e.push(r)}if(e.length===0)return wr([],[0].concat(this.elementShape));let n=this.readMany(e);return Ga(this.elementShape,n[0].shape,"TensorArray shape mismatch: "),Sn(n,0)}concat(e){if(e&&e!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but concat requested dtype ").concat(e));if(this.size()===0)return wr([],[0].concat(this.elementShape));let t=[];for(let r=0;r<this.size();r++)t.push(r);let n=this.readMany(t);return Ga(this.elementShape,n[0].shape,"TensorArray shape mismatch: tensor array shape (".concat(this.elementShape,") vs first tensor shape (").concat(n[0].shape,")")),wt(n,0)}scatter(e,t){if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(t.dtype));if(e.length!==t.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(e.length," vs. ").concat(t.shape[0]));let n=Math.max(...e);if(!this.dynamicSize&&n>=this.maxSize)throw new Error("Max index must be < array size (".concat(n,"  vs. ").concat(this.maxSize,")"));this.writeMany(e,en(t,0))}split(e,t){if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(t.dtype));let n=0,r=e.map(o=>(n+=o,n));if(n!==t.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(n,", and tensor's shape is: ").concat(t.shape));if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths (".concat(this.maxSize," vs. ").concat(e.length,"), and the TensorArray is not marked as dynamically resizeable"));let a=n===0?0:t.size/n,i=[];K(()=>{t=q(t,[1,n,a]);for(let o=0;o<e.length;++o){let l=[0,o===0?0:r[o-1],0],c=[1,e[o],a];i[o]=q(et(t,l,c),this.elementShape)}return i});let s=[];for(let o=0;o<e.length;o++)s[o]=o;this.writeMany(s,i)}},yp=class{get id(){return this.idTensor.id}constructor(e,t,n,r=-1){this.tensors=e,this.elementShape=t,this.elementDtype=n,e!=null&&e.forEach(a=>{if(n!==a.dtype)throw new Error("Invalid data types; op elements ".concat(n,", but list elements ").concat(a.dtype));Ga(t,a.shape,"TensorList shape mismatch: "),wn(a)}),this.idTensor=Ae(0),this.maxNumElements=r,wn(this.idTensor)}copy(){return new yp([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(t=>{(e==null||!e.has(t.id))&&t.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,t,n=-1){if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));if(n!==-1&&this.tensors.length!==n)throw new Error("Operation expected a list with ".concat(n," elements but got a list with ").concat(this.tensors.length," elements."));Ga(e,this.elementShape,"TensorList shape mismatch: ");let r=yf(this.elementShape,this.tensors,e);return K(()=>{let a=this.tensors.map(i=>q(i,r));return Sn(a,0)})}popBack(e,t){if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));if(this.size()===0)throw new Error("Trying to pop from an empty list.");let n=yf(this.elementShape,this.tensors,e),r=this.tensors.pop();return r.kept=!1,Ga(r.shape,e,"TensorList shape mismatch: "),q(r,n)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(e.dtype,", but list elements ").concat(this.elementDtype));if(Ga(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");wn(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error("TensorListResize expects size to be non-negative. Got: ".concat(e));if(this.maxNumElements!==-1&&e>this.maxNumElements)throw new Error("TensorListResize input size ".concat(e," is greater maxNumElement ").concat(this.maxNumElements,"."));let t=new yp([],this.elementShape,this.elementDtype,this.maxNumElements);t.tensors.length=e;for(let n=0;n<Math.min(this.tensors.length,e);++n)t.tensors[n]=this.tensors[n];return t}getItem(e,t,n){if(n!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(n,", but list elements ").concat(this.elementDtype));if(e<0||e>this.tensors.length)throw new Error("Trying to access element ".concat(e," in a list with ").concat(this.tensors.length," elements."));if(this.tensors[e]==null)throw new Error("element at index ".concat(e," is null."));Ga(this.tensors[e].shape,t,"TensorList shape mismatch: ");let r=yf(this.elementShape,this.tensors,t);return q(this.tensors[e],r)}setItem(e,t){if(t.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t.dtype,", but list elements ").concat(this.elementDtype));if(e<0||this.maxNumElements!==-1&&e>=this.maxNumElements)throw new Error("Trying to set element ".concat(e," in a list with max ").concat(this.maxNumElements," elements."));Ga(this.elementShape,t.shape,"TensorList shape mismatch: "),wn(t),this.tensors[e]!=null&&(this.tensors[e].kept=!1),this.tensors[e]=t}gather(e,t,n){if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));Ga(this.elementShape,n,"TensorList shape mismatch: "),e=e.slice(0,this.size());let r=yf(this.elementShape,this.tensors,n);return e.length===0?wr([],[0].concat(r)):K(()=>{let a=e.map(i=>q(this.tensors[i],r));return Sn(a,0)})}concat(e,t){if(e&&e!==this.elementDtype)throw new Error("TensorList dtype is ".concat(this.elementDtype," but concat requested dtype ").concat(e));Ga(this.elementShape,t,"TensorList shape mismatch: ");let n=yf(this.elementShape,this.tensors,t);return this.size()===0?wr([],[0].concat(n)):K(()=>{let r=this.tensors.map(a=>q(a,n));return wt(r,0)})}};function Gpe(e,t,n){let r=e.dtype;if(e.shape.length<1)throw new Error("Tensor must be at least a vector, but saw shape: ".concat(e.shape));if(e.dtype!==n)throw new Error("Invalid data types; op elements ".concat(e.dtype,", but list elements ").concat(n));let a=e.shape.slice(1);Ga(a,t,"TensorList shape mismatch: ");let i=en(e);return new yp(i,t,r)}function qpe(e,t,n,r){return new yp([],e,t,r)}function Kpe(e,t,n,r){if(t.length!==e.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(t.length," vs. ").concat(e.shape[0]));let a=Math.max(...t);if(r!=null&&r!==-1&&a>=r)throw new Error("Max index must be < array size (".concat(a,"  vs. ").concat(r,")"));let i=new yp([],n,e.dtype,r),s=en(e,0);return t.forEach((o,l)=>{i.setItem(o,s[l])}),i}function Xpe(e,t,n){let r=0,a=t.map(u=>(r+=u,r));if(r!==e.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(r,", and tensor's shape is: ").concat(e.shape));let i=e.shape.slice(1),s=TS(i,n),o=r===0?0:e.size/r,l=K(()=>{let u=[];e=q(e,[1,r,o]);for(let d=0;d<t.length;++d){let p=[0,d===0?0:a[d-1],0],h=[1,t[d],o];u[d]=q(et(e,p,h),s)}return e.dispose(),u}),c=new yp([],n,e.dtype,t.length);for(let u=0;u<l.length;u++)c.setItem(u,l[u]);return c}var Ype=async(e,t,n)=>{switch(e.op){case"If":case"StatelessIf":{let r=S("thenBranch",e,t,n),a=S("elseBranch",e,t,n),i=S("cond",e,t,n),s=S("args",e,t,n);return(await i.data())[0]?n.functionMap[r].executeFunctionAsync(s,n.tensorArrayMap,n.tensorListMap):n.functionMap[a].executeFunctionAsync(s,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{let r=S("body",e,t,n),a=S("cond",e,t,n),i=S("args",e,t,n),s=await n.functionMap[a].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap),o=i.map(u=>u.id),l=await s[0].data();s.forEach(u=>{!u.kept&&o.indexOf(u.id)===-1&&u.dispose()});let c=i;for(;l[0];){let u=c;c=await n.functionMap[r].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap);let d=c.map(h=>h.id);u.forEach(h=>{!h.kept&&o.indexOf(h.id)===-1&&d.indexOf(h.id)===-1&&h.dispose()});let p=await n.functionMap[a].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap);l=await p[0].data(),p.forEach(h=>{!h.kept&&o.indexOf(h.id)===-1&&d.indexOf(h.id)===-1&&h.dispose()})}return c}case"LoopCond":{let r=S("pred",e,t,n);return[xs(r)]}case"Switch":{let r=S("pred",e,t,n),a=S("data",e,t,n);return a.kept||(a=xs(a)),(await r.data())[0]?[void 0,a]:[a,void 0]}case"Merge":{let r=e.inputNames.find(a=>Hn(a,t,n)!==void 0);if(r){let a=Hn(r,t,n);return[xs(a)]}return}case"Enter":{let r=S("frameName",e,t,n),a=S("tensor",e,t,n);return n.enterFrame(r),[xs(a)]}case"Exit":{let r=S("tensor",e,t,n);return n.exitFrame(),[xs(r)]}case"NextIteration":{let r=S("tensor",e,t,n);return n.nextIteration(),[xs(r)]}case"TensorArrayV3":{let r=S("size",e,t,n),a=S("dtype",e,t,n),i=S("elementShape",e,t,n),s=S("dynamicSize",e,t,n),o=S("clearAfterRead",e,t,n),l=S("identicalElementShapes",e,t,n),c=S("name",e,t,n),u=new jpe(c,a,r,i,l,s,o);return n.addTensorArray(u),[u.idTensor,Ae(1)]}case"TensorArrayWriteV3":{let r=S("tensorArrayId",e,t,n),a=S("index",e,t,n),i=S("tensor",e,t,n),s=n.getTensorArray(r.id);return s.write(a,i),[s.idTensor]}case"TensorArrayReadV3":{let r=S("tensorArrayId",e,t,n),a=S("index",e,t,n);return[n.getTensorArray(r.id).read(a)]}case"TensorArrayGatherV3":{let r=S("tensorArrayId",e,t,n),a=S("indices",e,t,n),i=S("dtype",e,t,n);return[n.getTensorArray(r.id).gather(a,i)]}case"TensorArrayScatterV3":{let r=S("tensorArrayId",e,t,n),a=S("indices",e,t,n),i=S("tensor",e,t,n),s=n.getTensorArray(r.id);return s.scatter(a,i),[s.idTensor]}case"TensorArrayConcatV3":{let r=S("tensorArrayId",e,t,n),a=n.getTensorArray(r.id),i=S("dtype",e,t,n);return[a.concat(i)]}case"TensorArraySplitV3":{let r=S("tensorArrayId",e,t,n),a=S("tensor",e,t,n),i=S("lengths",e,t,n),s=n.getTensorArray(r.id);return s.split(i,a),[s.idTensor]}case"TensorArraySizeV3":{let r=S("tensorArrayId",e,t,n),a=n.getTensorArray(r.id);return[Ae(a.size(),"int32")]}case"TensorArrayCloseV3":{let r=S("tensorArrayId",e,t,n),a=n.getTensorArray(r.id);return a.clearAndClose(),[a.idTensor]}case"TensorListSetItem":{let r=S("tensorListId",e,t,n),a=S("index",e,t,n),i=S("tensor",e,t,n),s=n.getTensorList(r.id);return s.setItem(a,i),[s.idTensor]}case"TensorListGetItem":{let r=S("tensorListId",e,t,n),a=S("index",e,t,n),i=S("elementShape",e,t,n),s=S("elementDType",e,t,n);return[n.getTensorList(r.id).getItem(a,i,s)]}case"TensorListScatterV2":case"TensorListScatter":{let r=S("indices",e,t,n),a=S("tensor",e,t,n),i=S("elementShape",e,t,n),s=S("numElements",e,t,n),o=Kpe(a,r,i,s);return n.addTensorList(o),[o.idTensor]}case"TensorListReserve":case"EmptyTensorList":{let r=S("elementShape",e,t,n),a=S("elementDType",e,t,n),i;e.op==="TensorListReserve"?i="numElements":i="maxNumElements";let s=S(i,e,t,n),o=e.op==="TensorListReserve"?-1:s,l=qpe(r,a,s,o);return n.addTensorList(l),[l.idTensor]}case"TensorListGather":{let r=S("tensorListId",e,t,n),a=S("indices",e,t,n),i=S("elementShape",e,t,n),s=S("elementDType",e,t,n);return[n.getTensorList(r.id).gather(a,s,i)]}case"TensorListStack":{let r=S("tensorListId",e,t,n),a=S("elementShape",e,t,n),i=S("elementDType",e,t,n),s=S("numElements",e,t,n);return[n.getTensorList(r.id).stack(a,i,s)]}case"TensorListFromTensor":{let r=S("tensor",e,t,n),a=S("elementShape",e,t,n),i=S("elementDType",e,t,n),s=Gpe(r,a,i);return n.addTensorList(s),[s.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{let r=S("tensorListId",e,t,n),a=n.getTensorList(r.id),i=S("dtype",e,t,n),s=S("elementShape",e,t,n);return[a.concat(i,s)]}case"TensorListPushBack":{let r=S("tensorListId",e,t,n),a=S("tensor",e,t,n),i=n.getTensorList(r.id);return i.pushBack(a),[i.idTensor]}case"TensorListPopBack":{let r=S("tensorListId",e,t,n),a=S("elementShape",e,t,n),i=S("elementDType",e,t,n);return[n.getTensorList(r.id).popBack(a,i)]}case"TensorListSplit":{let r=S("tensor",e,t,n),a=S("elementShape",e,t,n),i=S("lengths",e,t,n),s=Xpe(r,i,a);return n.addTensorList(s),[s.idTensor]}case"TensorListLength":{let r=S("tensorListId",e,t,n),a=n.getTensorList(r.id);return[Ae(a.size(),"int32")]}case"TensorListResize":{let r=S("tensorListId",e,t,n),a=S("size",e,t,n),i=n.getTensorList(r.id).resize(a);return n.addTensorList(i),[i.idTensor]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}};function BR(e,t,n){let[r,a]=S("fusedOps",e,t,n),i=r==="biasadd",s=!i,o=a==="prelu",l=r==="fusedbatchnorm",c=S("numArgs",e,t,n);if(i){if(o&&c!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&i&&c!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");let u=S("strides",e,t,n),d=kb(e,t,n),p=S("dataFormat",e,t,n).toUpperCase(),h=S("dilations",e,t,n),[f,m]=S("args",e,t,n);s&&(m=f,f=void 0);let g=S("leakyreluAlpha",e,t,n);return{stride:u,pad:d,dataFormat:p,dilations:h,biasArg:f,preluArg:m,activationFunc:a,leakyreluAlpha:g}}var Zpe=(e,t,n,r=Bn)=>{switch(e.op){case"Conv1D":{let a=S("stride",e,t,n),i=S("pad",e,t,n),s=S("dataFormat",e,t,n).toUpperCase(),o=S("dilation",e,t,n);return[r.conv1d(S("x",e,t,n),S("filter",e,t,n),a,i,s,o)]}case"Conv2D":{let a=S("strides",e,t,n),i=kb(e,t,n),s=S("dataFormat",e,t,n).toUpperCase(),o=S("dilations",e,t,n);return[r.conv2d(S("x",e,t,n),S("filter",e,t,n),[a[1],a[2]],i,s,[o[1],o[2]])]}case"_FusedConv2D":{let{stride:a,pad:i,dataFormat:s,dilations:o,biasArg:l,preluArg:c,activationFunc:u,leakyreluAlpha:d}=BR(e,t,n);return[r.fused.conv2d({x:S("x",e,t,n),filter:S("filter",e,t,n),strides:[a[1],a[2]],pad:i,dataFormat:s,dilations:[o[1],o[2]],bias:l,activation:u,preluActivationWeights:c,leakyreluAlpha:d})]}case"FusedDepthwiseConv2dNative":{let{stride:a,pad:i,dataFormat:s,dilations:o,biasArg:l,preluArg:c,activationFunc:u,leakyreluAlpha:d}=BR(e,t,n);return[r.fused.depthwiseConv2d({x:S("x",e,t,n),filter:S("filter",e,t,n),strides:[a[1],a[2]],pad:i,dataFormat:s,dilations:[o[1],o[2]],bias:l,activation:u,preluActivationWeights:c,leakyreluAlpha:d})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{let a=S("outputShape",e,t,n),i=S("strides",e,t,n),s=kb(e,t,n);return[r.conv2dTranspose(S("x",e,t,n),S("filter",e,t,n),a,[i[1],i[2]],s)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{let a=S("strides",e,t,n),i=kb(e,t,n),s=S("dilations",e,t,n),o=S("dataFormat",e,t,n).toUpperCase();return[r.depthwiseConv2d(S("input",e,t,n),S("filter",e,t,n),[a[1],a[2]],i,o,[s[1],s[2]])]}case"Conv3D":{let a=S("strides",e,t,n),i=S("pad",e,t,n),s=S("dataFormat",e,t,n).toUpperCase(),o=S("dilations",e,t,n);return[r.conv3d(S("x",e,t,n),S("filter",e,t,n),[a[1],a[2],a[3]],i,s,[o[1],o[2],o[3]])]}case"AvgPool":{let a=S("strides",e,t,n),i=S("pad",e,t,n),s=S("kernelSize",e,t,n);return[r.avgPool(S("x",e,t,n),[s[1],s[2]],[a[1],a[2]],i)]}case"MaxPool":{let a=S("strides",e,t,n),i=S("pad",e,t,n),s=S("kernelSize",e,t,n);return[r.maxPool(S("x",e,t,n),[s[1],s[2]],[a[1],a[2]],i)]}case"MaxPoolWithArgmax":{let a=S("strides",e,t,n),i=S("pad",e,t,n),s=S("kernelSize",e,t,n),o=S("includeBatchInIndex",e,t,n),{result:l,indexes:c}=r.maxPoolWithArgmax(S("x",e,t,n),[s[1],s[2]],[a[1],a[2]],i,o);return[l,c]}case"AvgPool3D":{let a=S("strides",e,t,n),i=S("pad",e,t,n),s=S("kernelSize",e,t,n);return[r.avgPool3d(S("x",e,t,n),[s[1],s[2],s[3]],[a[1],a[2],a[3]],i)]}case"MaxPool3D":{let a=S("strides",e,t,n),i=S("pad",e,t,n),s=S("kernelSize",e,t,n);return[r.maxPool3d(S("x",e,t,n),[s[1],s[2],s[3]],[a[1],a[2],a[3]],i)]}case"Dilation2D":{let a=S("strides",e,t,n),i=S("pad",e,t,n),s=S("dilations",e,t,n),o=a[1],l=a[2],c=s[1],u=s[2];return[r.dilation2d(S("x",e,t,n),S("filter",e,t,n),[o,l],i,[c,u],"NHWC")]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},Qpe=(e,t,n,r=Bn)=>{switch(e.op){case"Fill":{let a=S("shape",e,t,n),i=S("dtype",e,t,n),s=S("value",e,t,n);return[r.fill(a,s,i)]}case"LinSpace":{let a=S("start",e,t,n),i=S("stop",e,t,n),s=S("num",e,t,n);return[r.linspace(a,i,s)]}case"Multinomial":{let a=S("logits",e,t,n),i=S("numSamples",e,t,n),s=S("seed",e,t,n);return[r.multinomial(a,i,s)]}case"OneHot":{let a=S("indices",e,t,n),i=S("depth",e,t,n),s=S("onValue",e,t,n),o=S("offValue",e,t,n),l=S("dtype",e,t,n);return[r.oneHot(a,i,s,o,l)]}case"Ones":return[r.ones(S("shape",e,t,n),S("dtype",e,t,n))];case"OnesLike":return[r.onesLike(S("x",e,t,n))];case"RandomStandardNormal":return[r.randomStandardNormal(S("shape",e,t,n),S("dtype",e,t,n),S("seed",e,t,n))];case"RandomUniform":return[r.randomUniform(S("shape",e,t,n),S("minval",e,t,n),S("maxval",e,t,n),S("dtype",e,t,n))];case"RandomUniformInt":return[r.randomUniformInt(S("shape",e,t,n),S("minval",e,t,n),S("maxval",e,t,n),S("seed",e,t,n))];case"Range":{let a=S("start",e,t,n),i=S("stop",e,t,n),s=S("step",e,t,n);return[r.range(a,i,s,S("dtype",e,t,n))]}case"TruncatedNormal":{let a=S("shape",e,t,n),i=S("mean",e,t,n),s=S("stdDev",e,t,n),o=S("seed",e,t,n);return[r.truncatedNormal(a,i,s,S("dtype",e,t,n),o)]}case"Zeros":return[r.zeros(S("shape",e,t,n),S("dtype",e,t,n))];case"ZerosLike":return[r.zerosLike(S("x",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}};function C1(e,t,n){let r=S("boxes",e,t,n),a=S("scores",e,t,n),i=S("maxOutputSize",e,t,n),s=S("iouThreshold",e,t,n),o=S("scoreThreshold",e,t,n),l=S("softNmsSigma",e,t,n);return{boxes:r,scores:a,maxOutputSize:i,iouThreshold:s,scoreThreshold:o,softNmsSigma:l}}var Jpe=async(e,t,n,r,a=Bn)=>{switch(e.op){case"NonMaxSuppressionV5":{let{boxes:i,scores:s,maxOutputSize:o,iouThreshold:l,scoreThreshold:c,softNmsSigma:u}=C1(e,t,n),d=await a.image.nonMaxSuppressionWithScoreAsync(i,s,o,l,c,u);return[d.selectedIndices,d.selectedScores]}case"NonMaxSuppressionV4":{let{boxes:i,scores:s,maxOutputSize:o,iouThreshold:l,scoreThreshold:c}=C1(e,t,n),u=S("padToMaxOutputSize",e,t,n),d=await a.image.nonMaxSuppressionPaddedAsync(i,s,o,l,c,u);return[d.selectedIndices,d.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{let{boxes:i,scores:s,maxOutputSize:o,iouThreshold:l,scoreThreshold:c}=C1(e,t,n);return[await a.image.nonMaxSuppressionAsync(i,s,o,l,c)]}case"Where":{let i=a.cast(S("condition",e,t,n),"bool"),s=[await a.whereAsync(i)];return i.dispose(),s}case"ListDiff":return a.setdiff1dAsync(S("x",e,t,n),S("y",e,t,n));default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},ehe=(e,t,n,r=Bn)=>{switch(e.op){case"LowerBound":{let a=S("sortedSequence",e,t,n),i=S("values",e,t,n);return[r.lowerBound(a,i)]}case"TopKV2":{let a=S("x",e,t,n),i=S("k",e,t,n),s=S("sorted",e,t,n),o=r.topk(a,i,s);return[o.values,o.indices]}case"UpperBound":{let a=S("sortedSequence",e,t,n),i=S("values",e,t,n);return[r.upperBound(a,i)]}case"Unique":{let a=S("x",e,t,n),i=r.unique(a);return[i.values,i.indices]}case"UniqueV2":{let a=S("x",e,t,n),i=S("axis",e,t,n),s=r.unique(a,i);return[s.values,s.indices]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},the=(e,t,n,r=Bn)=>{switch(e.op){case"Const":return t[e.name];case"PlaceholderWithDefault":let a=S("default",e,t,n);return[Hn(e.name,t,n)||a];case"Placeholder":return[Hn(e.name,t,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{let u=S("x",e,t,n);return[xs(u)]}case"IdentityN":return S("x",e,t,n).map(u=>xs(u));case"Snapshot":let i=S("x",e,t,n);return[xs(i)];case"Shape":return[r.tensor1d(S("x",e,t,n).shape,"int32")];case"ShapeN":return S("x",e,t,n).map(u=>r.tensor1d(u.shape));case"Size":return[r.scalar(S("x",e,t,n).size,"int32")];case"Rank":return[r.scalar(S("x",e,t,n).rank,"int32")];case"NoOp":return[r.scalar(1)];case"Print":let s=S("x",e,t,n),o=S("data",e,t,n),l=S("message",e,t,n),c=S("summarize",e,t,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(l);for(let u=0;u<o.length;u++)console.log(Array.prototype.slice.call(o[u].dataSync()).slice(0,c));return[s];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},nhe=class{get id(){return this.handle.id}constructor(e,t){this.keyDType=e,this.valueDType=t,this.handle=Ae(0),this.tensorMap=new Map,wn(this.handle)}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return Ae(this.size(),"int32")}async import(e,t){this.checkKeyAndValueTensor(e,t);let n=await e.data();return this.tensorMap.forEach(r=>r.dispose()),this.tensorMap.clear(),K(()=>{let r=en(t),a=n.length,i=r.length;k.assert(a===i,()=>"The number of elements doesn't match, keys has ".concat(a," elements, the values has ").concat(i," elements."));for(let s=0;s<a;s++){let o=n[s],l=r[s];wn(l),this.tensorMap.set(o,l)}return this.handle})}async find(e,t){this.checkKeyAndValueTensor(e,t);let n=await e.data();return K(()=>{let r=[];for(let a=0;a<n.length;a++){let i=n[a],s=this.findWithDefault(i,t);r.push(s)}return Sn(r)})}findWithDefault(e,t){let n=this.tensorMap.get(e);return n!=null?n:t}checkKeyAndValueTensor(e,t){if(e.dtype!==this.keyDType)throw new Error("Expect key dtype ".concat(this.keyDType,", but got ").concat(e.dtype));if(t.dtype!==this.valueDType)throw new Error("Expect value dtype ".concat(this.valueDType,", but got ").concat(t.dtype))}},rhe=async(e,t,n,r)=>{switch(e.op){case"HashTable":case"HashTableV2":{let a=r.getHashTableHandleByName(e.name);if(a!=null)return[a];{let i=S("keyDType",e,t,n),s=S("valueDType",e,t,n),o=new nhe(i,s);return r.addHashTable(e.name,o),[o.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{let a=S("tableHandle",e,t,n,r),i=S("keys",e,t,n),s=S("values",e,t,n);return[await r.getHashTableById(a.id).import(i,s)]}case"LookupTableFind":case"LookupTableFindV2":{let a=S("tableHandle",e,t,n,r),i=S("keys",e,t,n),s=S("defaultValue",e,t,n);return[await r.getHashTableById(a.id).find(i,s)]}case"LookupTableSize":case"LookupTableSizeV2":{let a=S("tableHandle",e,t,n,r);return[r.getHashTableById(a.id).tensorSize()]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},ahe=(e,t,n,r=Bn)=>{switch(e.op){case"ResizeBilinear":{let a=S("images",e,t,n),i=S("size",e,t,n),s=S("alignCorners",e,t,n),o=S("halfPixelCenters",e,t,n);return[r.image.resizeBilinear(a,[i[0],i[1]],s,o)]}case"ResizeNearestNeighbor":{let a=S("images",e,t,n),i=S("size",e,t,n),s=S("alignCorners",e,t,n),o=S("halfPixelCenters",e,t,n);return[r.image.resizeNearestNeighbor(a,[i[0],i[1]],s,o)]}case"CropAndResize":{let a=S("image",e,t,n),i=S("boxes",e,t,n),s=S("boxInd",e,t,n),o=S("cropSize",e,t,n),l=S("method",e,t,n),c=S("extrapolationValue",e,t,n);return[r.image.cropAndResize(a,i,s,o,l,c)]}case"ImageProjectiveTransformV3":{let a=S("images",e,t,n),i=S("transforms",e,t,n),s=S("outputShape",e,t,n),o=S("fillValue",e,t,n),l=S("interpolation",e,t,n),c=S("fillMode",e,t,n);return[r.image.transform(a,i,l.toLowerCase(),c.toLowerCase(),o,s)]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},ihe=(e,t,n,r=Bn)=>{switch(e.op){case"Equal":return[r.equal(S("a",e,t,n),S("b",e,t,n))];case"NotEqual":return[r.notEqual(S("a",e,t,n),S("b",e,t,n))];case"Greater":return[r.greater(S("a",e,t,n),S("b",e,t,n))];case"GreaterEqual":return[r.greaterEqual(S("a",e,t,n),S("b",e,t,n))];case"Less":return[r.less(S("a",e,t,n),S("b",e,t,n))];case"LessEqual":return[r.lessEqual(S("a",e,t,n),S("b",e,t,n))];case"LogicalAnd":return[r.logicalAnd(S("a",e,t,n),S("b",e,t,n))];case"LogicalNot":return[r.logicalNot(S("a",e,t,n))];case"LogicalOr":return[r.logicalOr(S("a",e,t,n),S("b",e,t,n))];case"Select":case"SelectV2":return[r.where(S("condition",e,t,n),S("a",e,t,n),S("b",e,t,n))];case"BitwiseAnd":return[r.bitwiseAnd(S("a",e,t,n),S("b",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},she=(e,t,n,r=Bn)=>{switch(e.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[r.matMul(S("a",e,t,n),S("b",e,t,n),S("transposeA",e,t,n),S("transposeB",e,t,n))];case"Einsum":return[r.einsum(S("equation",e,t,n),...S("tensors",e,t,n))];case"Transpose":return[r.transpose(S("x",e,t,n),S("perm",e,t,n))];case"_FusedMatMul":let[a,i]=S("fusedOps",e,t,n),s=a==="biasadd",o=i==="prelu",l=S("numArgs",e,t,n),c=S("leakyreluAlpha",e,t,n);if(s){if(o&&l!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&l!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}let[u,d]=S("args",e,t,n);return[r.fused.matMul({a:S("a",e,t,n),b:S("b",e,t,n),transposeA:S("transposeA",e,t,n),transposeB:S("transposeB",e,t,n),bias:u,activation:i,preluActivationWeights:d,leakyreluAlpha:c})];case"MatrixBandPart":return[r.linalg.bandPart(S("a",e,t,n),S("numLower",e,t,n),S("numUpper",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},ohe=(e,t,n,r=Bn)=>{switch(e.op){case"EuclideanNorm":return[r.euclideanNorm(S("x",e,t,n),S("axis",e,t,n),S("keepDims",e,t,n))];case"FusedBatchNorm":case"FusedBatchNormV2":return[r.batchNorm(S("x",e,t,n),S("mean",e,t,n),S("variance",e,t,n),S("offset",e,t,n),S("scale",e,t,n),S("epsilon",e,t,n))];case"FusedBatchNormV3":return[r.batchNorm(S("x",e,t,n),S("mean",e,t,n),S("variance",e,t,n),S("offset",e,t,n),S("scale",e,t,n),S("epsilon",e,t,n))];case"LRN":return[r.localResponseNormalization(S("x",e,t,n),S("radius",e,t,n),S("bias",e,t,n),S("alpha",e,t,n),S("beta",e,t,n))];case"Softmax":return[r.softmax(S("x",e,t,n))];case"LogSoftmax":return[r.logSoftmax(S("x",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},lhe=(e,t,n,r=Bn)=>{switch(e.op){case"RaggedGather":{let{outputNestedSplits:a,outputDenseValues:i}=r.raggedGather(S("paramsNestedSplits",e,t,n),S("paramsDenseValues",e,t,n),S("indices",e,t,n),S("outputRaggedRank",e,t,n));return a.concat(i)}case"RaggedRange":{let{rtNestedSplits:a,rtDenseValues:i}=r.raggedRange(S("starts",e,t,n),S("limits",e,t,n),S("splits",e,t,n));return[a,i]}case"RaggedTensorToTensor":return[r.raggedTensorToTensor(S("shape",e,t,n),S("values",e,t,n),S("defaultValue",e,t,n),S("rowPartitionTensors",e,t,n),S("rowPartitionTypes",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},uhe=(e,t,n,r=Bn)=>{switch(e.op){case"Max":{let o=S("axis",e,t,n),l=S("keepDims",e,t,n);return[r.max(S("x",e,t,n),o,l)]}case"Mean":{let o=S("axis",e,t,n),l=S("keepDims",e,t,n);return[r.mean(S("x",e,t,n),o,l)]}case"Min":{let o=S("axis",e,t,n),l=S("keepDims",e,t,n);return[r.min(S("x",e,t,n),o,l)]}case"Sum":{let o=S("axis",e,t,n),l=S("keepDims",e,t,n);return[r.sum(S("x",e,t,n),o,l)]}case"All":{let o=S("axis",e,t,n),l=S("keepDims",e,t,n);return[r.all(S("x",e,t,n),o,l)]}case"Any":{let o=S("axis",e,t,n),l=S("keepDims",e,t,n);return[r.any(S("x",e,t,n),o,l)]}case"ArgMax":{let o=S("axis",e,t,n);return[r.argMax(S("x",e,t,n),o)]}case"ArgMin":{let o=S("axis",e,t,n);return[r.argMin(S("x",e,t,n),o)]}case"Prod":{let o=S("axis",e,t,n),l=S("keepDims",e,t,n);return[r.prod(S("x",e,t,n),o,l)]}case"Cumprod":{let o=S("axis",e,t,n),l=S("exclusive",e,t,n),c=S("reverse",e,t,n);return[r.cumprod(S("x",e,t,n),o,l,c)]}case"Cumsum":{let o=S("axis",e,t,n),l=S("exclusive",e,t,n),c=S("reverse",e,t,n);return[r.cumsum(S("x",e,t,n),o,l,c)]}case"Bincount":let a=S("x",e,t,n),i=S("weights",e,t,n),s=S("size",e,t,n);return[r.bincount(a,i,s)];case"DenseBincount":{let o=S("x",e,t,n),l=S("weights",e,t,n),c=S("size",e,t,n),u=S("binaryOutput",e,t,n);return[r.denseBincount(o,l,c,u)]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},che=(e,t,n,r=Bn)=>{switch(e.op){case"ConcatV2":case"Concat":{let a=S("n",e,t,n),i=S("axis",e,t,n),s=S("tensors",e,t,n);return s=s.slice(0,a),[r.concat(s,i)]}case"Gather":{let a=S("x",e,t,n),i=S("indices",e,t,n);return[r.gather(a,r.cast(i,"int32"),0)]}case"GatherV2":{let a=S("axis",e,t,n),i=S("batchDims",e,t,n),s=S("x",e,t,n),o=S("indices",e,t,n);return[r.gather(s,r.cast(o,"int32"),a,i)]}case"Reverse":{let a=S("dims",e,t,n),i=[];for(let o=0;o<a.length;o++)a[o]&&i.push(o);let s=S("x",e,t,n);return[r.reverse(s,i)]}case"ReverseV2":{let a=S("axis",e,t,n),i=S("x",e,t,n);return[r.reverse(i,a)]}case"Slice":{let a=S("begin",e,t,n),i=S("size",e,t,n);return[r.slice(S("x",e,t,n),a,i)]}case"StridedSlice":{let a=S("begin",e,t,n),i=S("end",e,t,n),s=S("strides",e,t,n),o=S("beginMask",e,t,n),l=S("endMask",e,t,n),c=S("ellipsisMask",e,t,n),u=S("newAxisMask",e,t,n),d=S("shrinkAxisMask",e,t,n),p=S("x",e,t,n);return[r.stridedSlice(p,a,i,s,o,l,c,u,d)]}case"Pack":return K(()=>{let a=S("axis",e,t,n),i=S("tensors",e,t,n),s=i[0].shape,o=r.squeeze(i[0]).shape,l=i.map(c=>{let u=k.arraysEqual(c.shape,s);if(!u&&!k.arraysEqual(r.squeeze(c).shape,o))throw new Error("the input tensors shape does not match");return u?c:r.reshape(c,s)});return[r.stack(l,a)]});case"Unpack":{let a=S("axis",e,t,n),i=S("tensor",e,t,n);return r.unstack(i,a)}case"Tile":{let a=S("reps",e,t,n);return[r.tile(S("x",e,t,n),a)]}case"Split":case"SplitV":{let a=S("axis",e,t,n),i=S("numOrSizeSplits",e,t,n),s=S("x",e,t,n);return r.split(s,i,a)}case"ScatterNd":{let a=S("indices",e,t,n),i=S("values",e,t,n),s=S("shape",e,t,n);return[r.scatterND(a,i,s)]}case"GatherNd":{let a=S("x",e,t,n),i=S("indices",e,t,n);return[r.gatherND(a,i)]}case"SparseToDense":{let a=S("sparseIndices",e,t,n),i=S("outputShape",e,t,n),s=S("sparseValues",e,t,n),o=S("defaultValue",e,t,n);return[r.sparseToDense(a,s,i,s.dtype===o.dtype?o:r.cast(o,s.dtype))]}case"TensorScatterUpdate":{let a=S("indices",e,t,n),i=S("values",e,t,n),s=S("tensor",e,t,n);return[r.tensorScatterUpdate(s,a,i)]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},dhe=(e,t,n,r=Bn)=>{switch(e.op){case"SparseFillEmptyRows":{let{outputIndices:a,outputValues:i,emptyRowIndicator:s,reverseIndexMap:o}=r.sparse.sparseFillEmptyRows(S("indices",e,t,n),S("values",e,t,n),S("denseShape",e,t,n),S("defaultValue",e,t,n));return[a,i,s,o]}case"SparseReshape":{let{outputIndices:a,outputShape:i}=r.sparse.sparseReshape(S("inputIndices",e,t,n),S("inputShape",e,t,n),S("newShape",e,t,n));return[a,i]}case"SparseSegmentMean":return[r.sparse.sparseSegmentMean(S("data",e,t,n),S("indices",e,t,n),S("segmentIds",e,t,n))];case"SparseSegmentSum":return[r.sparse.sparseSegmentSum(S("data",e,t,n),S("indices",e,t,n),S("segmentIds",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},phe=(e,t,n,r=Bn)=>{switch(e.op){case"FFT":return[r.fft(S("x",e,t,n))];case"IFFT":return[r.ifft(S("x",e,t,n))];case"RFFT":return[r.rfft(S("x",e,t,n))];case"IRFFT":return[r.irfft(S("x",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},hhe=(e,t,n,r=Bn)=>{switch(e.op){case"StaticRegexReplace":return[r.string.staticRegexReplace(S("input",e,t,n),S("pattern",e,t,n),S("rewrite",e,t,n),S("replaceGlobal",e,t,n))];case"StringNGrams":{let{nGrams:a,nGramsSplits:i}=r.string.stringNGrams(S("data",e,t,n),S("dataSplits",e,t,n),S("separator",e,t,n),S("nGramWidths",e,t,n),S("leftPad",e,t,n),S("rightPad",e,t,n),S("padWidth",e,t,n),S("preserveShortSequences",e,t,n));return[a,i]}case"StringSplit":{let{indices:a,values:i,shape:s}=r.string.stringSplit(S("input",e,t,n),S("delimiter",e,t,n),S("skipEmpty",e,t,n));return[a,i,s]}case"StringToHashBucketFast":return[r.string.stringToHashBucketFast(S("input",e,t,n),S("numBuckets",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},fhe=(e,t,n,r=Bn)=>{switch(e.op){case"Cast":return[r.cast(S("x",e,t,n),S("dtype",e,t,n))];case"ExpandDims":{let a=S("axis",e,t,n);return[r.expandDims(S("x",e,t,n),a)]}case"Squeeze":{let a=S("axis",e,t,n);return[r.squeeze(S("x",e,t,n),a)]}case"Reshape":return[r.reshape(S("x",e,t,n),S("shape",e,t,n))];case"EnsureShape":return[r.ensureShape(S("x",e,t,n),S("shape",e,t,n))];case"MirrorPad":return[r.mirrorPad(S("x",e,t,n),S("padding",e,t,n),S("mode",e,t,n))];case"PadV2":case"Pad":return[r.pad(S("x",e,t,n),S("padding",e,t,n),S("constantValue",e,t,n))];case"SpaceToBatchND":{let a=S("blockShape",e,t,n),i=S("paddings",e,t,n);return[r.spaceToBatchND(S("x",e,t,n),a,i)]}case"BatchToSpaceND":{let a=S("blockShape",e,t,n),i=S("crops",e,t,n);return[r.batchToSpaceND(S("x",e,t,n),a,i)]}case"DepthToSpace":{let a=S("blockSize",e,t,n),i=S("dataFormat",e,t,n).toUpperCase();return[r.depthToSpace(S("x",e,t,n),a,i)]}case"BroadcastTo":return[r.broadcastTo(S("x",e,t,n),S("shape",e,t,n))];case"BroadcastArgs":return[r.broadcastArgs(S("s0",e,t,n),S("s1",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}};function WR(e,t,n,r,a=K){let i=((s,o,l)=>{switch(s.category){case"arithmetic":return a(()=>Vpe(s,o,l));case"basic_math":return a(()=>Hpe(s,o,l));case"control":return Ype(s,o,l);case"convolution":return a(()=>Zpe(s,o,l));case"creation":return a(()=>Qpe(s,o,l));case"dynamic":return Jpe(s,o,l);case"evaluation":return a(()=>ehe(s,o,l));case"image":return a(()=>ahe(s,o,l));case"graph":return a(()=>the(s,o,l));case"logical":return a(()=>ihe(s,o,l));case"matrices":return a(()=>she(s,o,l));case"normalization":return a(()=>ohe(s,o,l));case"ragged":return a(()=>lhe(s,o,l));case"reduction":return a(()=>uhe(s,o,l));case"slice_join":return a(()=>che(s,o,l));case"sparse":return a(()=>dhe(s,o,l));case"spectral":return a(()=>phe(s,o,l));case"string":return a(()=>hhe(s,o,l));case"transformation":return a(()=>fhe(s,o,l));case"hash_table":return rhe(s,o,l,r);case"custom":let c=FB(s.op);if(c&&c.customExecutor)return c.customExecutor(new Upe(s,o,l));throw TypeError("Custom op ".concat(s.op," is not registered."));default:throw TypeError("Unknown op '".concat(s.op,"'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()"))}})(e,t,n);return k.isPromise(i)?i.then(s=>[].concat(s)):[].concat(i)}var UR=class{constructor(e={},t={},n={},r={},a){this.weightMap=e,this.tensorArrayMap=t,this.tensorListMap=n,this.functionMap=r,this.parseNodeNameCache=a,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,t){return{id:e,frameName:t,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){let e=[];for(let t=0;t<this.contexts.length-1;t++){let n=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(n))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(t=>t.id===0&&t.iterationId===0?"":"".concat(t.frameName,"-").concat(t.iterationId)).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;let e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(let t in this.tensorArrayMap)this.tensorArrayMap[t].clearAndClose(e);for(let t in this.tensorListMap)this.tensorListMap[t].clearAndClose(e)}};function VR(e,t,n,r){let a=new Set,i=[],s=null,o=null,l=new Set,c=new Set(Object.keys(e).map(p=>ta(p)[0]));r=r||[];let u=new Set(r.map(p=>ta(p.name)[0])),d=[...t];for(;d.length>0;){let p=d.pop();if((Sl(p)||khe(p)||She(p))&&s==null&&(s=p,o=s.children.map(h=>h.name).filter(h=>a.has(h))),a.add(p.name),n[p.name]==null&&!c.has(p.name)&&!u.has(p.name)){if(p.inputs.length===0){i.push(p.name);continue}p.inputs.forEach(h=>{l.has(h.name)||(l.add(h.name),d.push(h))})}}return{inputs:e,outputs:t,usedNodes:a,missingInputs:i,dynamicNode:s,syncInputs:o}}function mhe(e,t){let{usedNodes:n,inputs:r}=t,a=Object.keys(r).map(g=>ta(g)[0]).map(g=>e.nodes[g]),i=e.initNodes||[],s=g=>n.has(typeof g=="string"?g:g.name);function o(g){return[...new Map(g.map(y=>[y.name,y])).values()]}let l=o([...a,...e.weights,...i]).filter(s),c=o([...l,...Object.values(e.nodes)]).filter(s),u=new Map(c.map(g=>[g.name,g])),d={};for(let g of c){d[g.name]=d[g.name]||0;for(let y of g.children)s(y)||(d[y.name]=Number.POSITIVE_INFINITY),d[y.name]=(d[y.name]||0)+1}let p=Object.entries(d).filter(([,g])=>g===0).map(([g])=>g),h=[...p];for(;p.length>0;){let g=p.pop(),y=u.get(g);for(let b of y.children.filter(s))--d[b.name]===0&&(h.push(b.name),p.push(b.name))}let f=h.map(g=>u.get(g)),m=ghe(f,l);return yhe(m,l),m}function ghe(e,t){let n=new Map(e.map(i=>[i.name,i])),r=t.map(i=>i.name),a=new Set(r);for(;r.length>0;){let i=r.pop(),s=n.get(i);for(let o of s.children)!n.has(o.name)||a.has(o.name)||(a.add(o.name),r.push(o.name))}return e.filter(i=>a.has(i.name))}var Xy=class extends Error{constructor(e){super("NodesExecutionOrderError: ".concat(e))}};function yhe(e,t){let n=new Map(e.map((o,l)=>[o.name,l])),r=new Set(t.map(o=>o.name)),a=o=>r.has(typeof o=="string"?o:o.name),i=new Set(e.map(o=>o.name)),s=o=>i.has(typeof o=="string"?o:o.name);for(let o of e){for(let l of o.children.filter(s)){if(!n.has(l.name))throw new Xy("Child ".concat(l.name," of node ").concat(o.name," is unreachable."));if(n.get(o.name)>n.get(l.name))throw new Xy("Node ".concat(o.name," is scheduled to run after its child ").concat(l.name,"."))}if(!a(o))for(let l of o.inputs){if(!n.has(l.name))throw new Xy("Input ".concat(l.name," of node ").concat(o.name," is unreachable."));if(n.get(l.name)>n.get(o.name))throw new Xy("Node ".concat(o.name," is scheduled to run before its input ").concat(l.name,"."))}}}function bhe(e){let t=new Map(e.map((o,l)=>[o.name,l])),n=Number.MAX_SAFE_INTEGER,r=e.map((o,l)=>Sl(o)?n:l),a=o=>{let l=r[t.get(o.name)];return l==null?-1:l},i=e.map((o,l)=>o.children.map(a).reduce((c,u)=>Math.max(c,u),r[l])),s=new Map;for(let o=0;o<e.length;++o){let l=i[o];if(l===n)continue;let c=e[o],u=e[l];s.has(u.name)||s.set(u.name,[]),s.get(u.name).push(c)}return s}var vhe=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),xhe=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),whe=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function Sl(e){return vhe.has(e.op)}function khe(e){return xhe.has(e.op)}function She(e){return whe.has(e.op)}var NS=class{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){let t=Object.keys(e).map(n=>e[n].map(r=>r.id));this._weightIds=[].concat(...t),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{let t=e.signatureKey||e.name;return e.defaultOutput?"".concat(t,":").concat(e.defaultOutput):t})}get functions(){return Object.keys(this._functions).reduce((e,t)=>(e[t]=this._functions[t].signature,e),{})}constructor(e,t){this.graph=e,this.parent=t,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,e.functions!=null&&Object.keys(e.functions).forEach(n=>{this._functionExecutorMap[n]=new NS(e.functions[n],this)})}getCompilationKey(e,t){let n=e.map(a=>a.name).sort(),r=t.map(a=>a.name).sort();return n.join(this.SEPARATOR)+"--"+r.join(this.SEPARATOR)}compile(e,t){let n=VR(e,t,this.weightMap,this._initNodes),{missingInputs:r,dynamicNode:a,syncInputs:i}=n;if(a!=null)throw new Error("This execution contains the node '".concat(a.name,"', which has the dynamic op '").concat(a.op,"'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [").concat(i,"]"));if(r.length>0){let l=t.map(u=>u.name),c=Object.keys(e);throw new Error("Cannot compute the outputs [".concat(l,"] from the provided inputs [").concat(c,"]. Missing the following inputs: [").concat(r,"]"))}let s=mhe(this.graph,n),o=bhe(s);return{orderedNodes:s,nodeLiveUntilMap:o}}cloneAndKeepTensor(e){if(e==null)return null;let t=e.clone();return wn(t),t}cloneTensorList(e){return e?e.map(t=>this.cloneAndKeepTensor(t)):null}cloneTensorMap(e){return Object.fromEntries(Object.entries(e).map(([t,n])=>[t,this.cloneTensorList(n)]))}execute(e,t){this.disposeIntermediateTensors(),e=this.mapInputs(e);let n=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);let r=n.map(d=>this.graph.nodes[ta(d)[0]]),a=t.map(d=>ta(d)[0]),i=new Set(a),s=a.map(d=>this.graph.nodes[d]);s.length===0&&(s=this._outputs);let o=this.getCompilationKey(r,s),l=this.compiledMap.get(o);l==null&&(l=this.compile(e,s),this.compiledMap.set(o,l));try{this.keepIntermediateTensors=Z().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(d){this.keepIntermediateTensors=!1,console.warn(d.message)}let c={},u={};return K(()=>{let d=new UR(this.weightMap,c,u,this.functionExecutorMap,this.parseNodeNameCache),p=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(e).forEach(g=>{let[y,b]=ta(g,d),v=[];v[b]=e[g],p[y]=v,this.keepIntermediateTensors&&(this.clonedTensorsMap[y]=this.cloneTensorList(v))});let h=this.getFrozenTensorIds(p),{orderedNodes:f,nodeLiveUntilMap:m}=l;for(let g of f){if(p[g.name])continue;let y=WR(g,p,d,this._resourceManager);if(k.isPromise(y))throw new Error("The execution of the op '".concat(g.op,"' returned a promise. Please use model.executeAsync() instead."));p[g.name]=y,this.keepIntermediateTensors&&(this.clonedTensorsMap[g.name]=this.cloneTensorList(y)),this.checkTensorForDisposalWithNodeLiveUntilInfo(g,p,d,h,i,m.get(g.name))}return this.parent==null&&d.dispose(h),t.map(g=>Hn(g,p,d))})}getFrozenTensorIds(e){let t=[].concat.apply([],Object.keys(e).map(n=>e[n]).map(n=>n.map(r=>r.id)));return new Set(t)}checkTensorForDisposal(e,t,n,r,a,i,s){if(!(Sl(t)||i.has(e))){for(let o of n[e])o!=null&&(s[o.id]=(s[o.id]||0)+t.children.length);for(let o of t.inputs){if(Sl(o))continue;let l=OR(o.name,n,r);if(l!=null)for(let c of l){if(!c||c.kept||a.has(c.id))continue;let u=s[c.id];u===1?(c.dispose(),delete s[c.id]):u!=null&&s[c.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(e,t,n,r,a,i){function s(o){return Sl(o)||a.has(o.name)}if(!(Sl(e)||i==null))for(let o of i){if(s(o))continue;let l=OR(o.name,t,n);for(let c of l)!c||c.kept||r.has(c.id)||c.dispose()}}async executeAsync(e,t){return this._executeAsync(e,t)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(e=>{for(let t of e)t&&!t.isDisposed&&t.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(e,t,n=!1,r={},a={}){this.disposeIntermediateTensors(),n||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t));try{this.keepIntermediateTensors=Z().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(d){this.keepIntermediateTensors=!1,console.warn(d.message)}let i=new UR(this.weightMap,r,a,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));let s=await this.executeWithControlFlow(e,i,t,n),o=t.map(d=>Hn(d,s,i)),l=o.map(d=>d.id),c=Object.keys(e).map(d=>e[d].id),u=new Set([...l,...c,...this.weightIds]);return Object.values(s).forEach(d=>{d.forEach(p=>{p&&!p.isDisposed&&!u.has(p.id)&&p.dispose()})}),this.parent==null&&i.dispose(u),o}async executeFunctionAsync(e,t,n){let r=e.reduce((a,i,s)=>(a[this.inputs[s].name]=i,a),{});return this._executeAsync(r,this.outputNodes,!0,t,n)}async executeWithControlFlow(e,t,n,r){let a=Object.keys(e),i=a.map(v=>this.graph.nodes[ta(v)[0]]),s=n.map(v=>ta(v)[0]),o=new Set(s),l=s.map(v=>this.graph.nodes[v]);l.length===0&&(l=this._outputs);let{usedNodes:c,missingInputs:u,dynamicNode:d,syncInputs:p}=VR(e,l,this.weightMap,this._initNodes),h=[...i,...this.graph.weights,...this._initNodes||[]].map(v=>({node:v,contexts:t.currentContext})),f=Object.assign({},this.weightMap);Object.keys(e).forEach(v=>{let[x,w]=ta(v),$=[];$[w]=e[v],f[x]=$});let m={},g=this.getFrozenTensorIds(f),y={};for(;h.length>0;){let v=this.processStack(i,h,t,f,y,g,o,m,c);await Promise.all(v)}d==null&&!r&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");let b=l.filter(v=>!Sl(v)&&!Hn(v.name,f,t)).map(v=>v.name);if(b.length>0){let v="";throw d!=null&&(v="Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [".concat(p,"]")),new Error("Cannot compute the outputs [".concat(b,"] from the provided inputs [").concat(a,"]. Consider providing the following inputs: [").concat(u,"]. ").concat(v))}return f}processStack(e,t,n,r,a,i,s,o,l){let c=[];for(;t.length>0;){let u=t.pop();n.currentContext=u.contexts;let d="";if(u.node.op==="Enter"&&S("isConstant",u.node,r,n)&&([d]=vs(u.node.name,n)),r[u.node.name]==null){let p=WR(u.node,r,n,this._resourceManager);d||([d]=vs(u.node.name,n));let h=n.currentContext;k.isPromise(p)?c.push(p.then(f=>(r[d]=f,this.keepIntermediateTensors&&(this.clonedTensorsMap[d]=this.cloneTensorList(f)),n.currentContext=h,this.checkTensorForDisposal(d,u.node,r,n,i,s,o),this.processChildNodes(u.node,t,n,r,a,l),f))):(r[d]=p,this.keepIntermediateTensors&&(this.clonedTensorsMap[d]=this.cloneTensorList(p)),this.checkTensorForDisposal(d,u.node,r,n,i,s,o),this.processChildNodes(u.node,t,n,r,a,l))}else this.processChildNodes(u.node,t,n,r,a,l)}return c}processChildNodes(e,t,n,r,a,i){e.children.forEach(s=>{let[o]=vs(s.name,n);a[o]||!i.has(s.name)||(s.op==="Merge"?s.inputNames.some(l=>!!Hn(l,r,n))&&(a[o]=!0,t.push({contexts:n.currentContext,node:s})):s.inputNames.every(l=>!!Hn(l,r,n))&&(a[o]=!0,t.push({contexts:n.currentContext,node:s})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(t=>t.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(t=>{let n=e[t],[r]=ta(t),a=this.graph.nodes[r];if(a.attrParams.shape&&a.attrParams.shape.value){let i=a.attrParams.shape.value,s=i.length===n.shape.length&&n.shape.every((o,l)=>i[l]===-1||i[l]===o);k.assert(s,()=>"The shape of dict['".concat(a.name,"'] provided in model.execute(dict) must be [").concat(i,"], but was [").concat(n.shape,"]"))}a.attrParams.dtype&&a.attrParams.dtype.value&&k.assert(n.dtype===a.attrParams.dtype.value,()=>"The dtype of dict['".concat(a.name,"'] provided in model.execute(dict) must be ").concat(a.attrParams.dtype.value,", but was ").concat(n.dtype))})}mapInputs(e){var t,n;let r={};for(let a in e){let i=(n=(t=this._signature)===null||t===void 0?void 0:t.inputs)===null||n===void 0?void 0:n[a];i!=null?r[i.name]=e[a]:r[a]=e[a]}return r}checkInputs(e){let t=Object.keys(e).filter(n=>{let[r]=ta(n);return this.graph.nodes[r]==null});if(t.length>0)throw new Error("The dict provided in model.execute(dict) has keys: [".concat(t,"] that are not part of graph"))}mapOutputs(e){return e.map(t=>{var n,r;let a=(r=(n=this._signature)===null||n===void 0?void 0:n.outputs)===null||r===void 0?void 0:r[t];return a!=null?a.name:t},{})}checkOutputs(e){e.forEach(t=>{let[n]=ta(t);if(!this.graph.nodes[n])throw new Error("The output '".concat(t,"' is not found in the graph"))})}},Ihe=class{constructor(e={},t={}){this.hashTableNameToHandle=e,this.hashTableMap=t}addHashTable(e,t){this.hashTableNameToHandle[e]=t.handle,this.hashTableMap[t.id]=t}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(let e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(let e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}},$he="?tfjs-format=file",Che="model.json",z2=class{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(e,t={},n=Gn){this.modelUrl=e,this.loadOptions=t,this.version="n/a",this.io=n,t==null&&(this.loadOptions={}),this.resourceManager=new Ihe}findIOHandler(){let e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{let t=this.io.getLoadHandlers(e,this.loadOptions);if(t.length===0)t.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(t.length>1)throw new Error("Found more than one (".concat(t.length,") load handlers for URL '").concat([e],"'"));this.handler=t[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");let e=this.handler.load();return k.isPromise(e)?e.then(t=>this.loadSync(t)):this.loadSync(e)}loadSync(e){this.artifacts=e;let t=this.artifacts.modelTopology,n=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){let a=this.artifacts.userDefinedMetadata;a.signature!=null&&(n=a.signature),a.structuredOutputKeys!=null&&(this.structuredOutputKeys=a.structuredOutputKeys)}this.signature=n,this.version="".concat(t.versions.producer,".").concat(t.versions.minConsumer);let r=this.io.decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs);if(this.executor=new NS(LR.Instance.transformGraph(t,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(r),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){let a=LR.Instance.transformGraph(e.modelInitializer);this.initializer=new NS(a),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}async save(e,t){if(typeof e=="string"){let n=this.io.getSaveHandlers(e);if(n.length===0)throw new Error("Cannot find any save handlers for URL '".concat(e,"'"));if(n.length>1)throw new Error("Found more than one (".concat(n.length,") save handlers for URL '").concat(e,"'"));e=n[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}addStructuredOutputNames(e){if(this.structuredOutputKeys){let t=e instanceof He?[e]:e,n={};return t.forEach((r,a)=>n[this.structuredOutputKeys[a]]=r),n}return e}predict(e,t){let n=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(n)}async predictAsync(e,t){let n=await this.executeAsync(e,this.outputNodes);return this.addStructuredOutputNames(n)}normalizeInputs(e){var t;if(!(e instanceof He)&&!Array.isArray(e)){let a=(t=this.signature)===null||t===void 0?void 0:t.inputs;if(a!=null)for(let i in a){let s=a[i];s.resourceId!=null&&(e[i]=this.resourceIdToCapturedInput[s.resourceId])}return e}e=Array.isArray(e)?e:[e];let n=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+n!==this.inputNodes.length)throw new Error("Input tensor count mismatch, the graph model has ".concat(this.inputNodes.length-n," non-resource placeholders, while there are ").concat(e.length," input tensors provided."));let r=0;return this.inputNodes.reduce((a,i)=>{var s,o,l;let c=(l=(o=(s=this.signature)===null||s===void 0?void 0:s.inputs)===null||o===void 0?void 0:o[i])===null||l===void 0?void 0:l.resourceId;return c!=null?a[i]=this.resourceIdToCapturedInput[c]:a[i]=e[r++],a},{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}executeInitializerGraph(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(e){if(this.resourceIdToCapturedInput={},this.initializerSignature){let t=this.initializerSignature.outputs,n=Object.keys(t);for(let r=0;r<n.length;r++){let a=n[r],i=t[a];this.resourceIdToCapturedInput[i.resourceId]=e[r]}}}execute(e,t){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);let n=this.executor.execute(e,t);return n.length>1?n:n[0]}async executeAsync(e,t){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);let n=await this.executor.executeAsync(e,t);return n.length>1?n:n[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((t,n)=>(t[n]=[e[n]],t),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&We(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}};async function Ehe(e,t={},n=Gn){if(e==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");t==null&&(t={}),t.fromTFHub&&typeof e=="string"&&(e=Nhe(e));let r=new z2(e,t,n);return await r.load(),r}function The(e){if(e==null)throw new Error("modelUrl in loadGraphModelSync() cannot be null. Please provide model artifacts or an IOHandler that loads the model");let t;if(e instanceof Array){let[r,a]=e;if(!r)throw new Error("modelJSON must be the first element of the array");if(!a||!(a instanceof ArrayBuffer))throw new Error("An ArrayBuffer of weights must be the second element of the array");if(!("modelTopology"in r))throw new Error("Model JSON is missing 'modelTopology'");if(!("weightsManifest"in r))throw new Error("Model JSON is missing 'weightsManifest'");let i=Gn.getWeightSpecs(r.weightsManifest),s=Gn.getModelArtifactsForJSONSync(r,i,a);t=Gn.fromMemorySync(s)}else if("load"in e)t=e;else if("modelTopology"in e&&"weightSpecs"in e&&"weightData"in e)t=Gn.fromMemorySync(e);else throw new Error("Unknown model format");let n=new z2(t);return n.load(),n}function Nhe(e){return e.endsWith("/")||(e=e+"/"),"".concat(e).concat(Che).concat($he)}var _he="4.7.0",nW={};Ue(nW,{CSVDataset:()=>dW,Dataset:()=>Hh,FileDataSource:()=>bW,TextLineDataset:()=>cW,URLDataSource:()=>vW,array:()=>Jhe,csv:()=>cfe,func:()=>dfe,generator:()=>pfe,microphone:()=>ffe,version_data:()=>mfe,webcam:()=>hfe,zip:()=>efe});var Ahe=jo(j0()),Rhe=jo(j0());function Dhe(e,t){return Lv(e,t)}function Lv(e,t,n=new Map,r=new Set){if(e==null)return null;if(typeof Blob=="function"&&e instanceof Blob)return e.slice();if(r.has(e))throw new Error("Circular references are not supported.");if(n.has(e))return n.get(e);let a=t(e);if(a.recurse&&a.value!==null)throw new Error("A deep map function may not return both a value and recurse=true.");if(a.recurse)if(bp(e)){let i=Array.isArray(e)?[]:{};r.add(e);for(let s in e){let o=e[s],l=Lv(o,t,n,r);i[s]=l}return r.delete(e),e.__proto__&&(i.__proto__=e.__proto__),i}else throw new Error("Can't recurse into non-iterable type: ".concat(e));else return n.set(e,a.value),a.value}function Fhe(e,t=aW){return rW(e,t)}function rW(e,t,n=new Set){let r=e[0];if(n.has(r))throw new Error("Circular references are not supported.");let a=t(e);if(a.recurse&&a.value!==null)throw new Error("A deep zip function may not return both a value and recurse=true.");if(a.recurse)if(bp(r)){let i=Array.isArray(r)?[]:{};n.add(r);for(let s in r){let o=e.map(c=>c[s]),l=rW(o,t,n);i[s]=l}return n.delete(r),i}else throw new Error("Can't recurse into non-iterable type: ".concat(r));else return a.value}function aW(e){return e===null?null:bp(e[0])?{value:null,recurse:!0}:{value:e,recurse:!1}}async function iW(e,t){let n=new Map;Lv(e,t,n);for(let r of Array.from(n.keys())){let a=n.get(r);if(k.isPromise(a)){let i=await a;n.set(r,i)}}return Lv(e,t,n)}function bp(e){let t=!1;if(Z().get("IS_BROWSER"))t=e instanceof TextDecoder;else{let{StringDecoder:n}=WL();t=e instanceof n}return e!=null&&!ArrayBuffer.isView(e)&&(Array.isArray(e)||typeof e=="object"&&!(e instanceof He)&&!(e instanceof Promise)&&!t)}function Mhe(e){return e==null||Ohe(e)||Array.isArray(e)||typeof e=="object"&&e instanceof He||k.isTypedArray(e)}function Ohe(e){return e===null||typeof e!="object"&&typeof e!="function"}function Lhe(e){return Dhe(e,Phe)}function Phe(e){return e instanceof He?{value:e.clone(),recurse:!1}:bp(e)?{value:null,recurse:!0}:{value:e,recurse:!1}}var sW=class{constructor(e){if(this.capacity=e,this.begin=0,this.end=0,e==null)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(e<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(e),this.doubledCapacity=2*e}wrap(e){for(;e<0;)e+=this.doubledCapacity;return e%this.doubledCapacity}get(e){if(e<0)throw new RangeError("Can't get item at a negative index.");return this.data[e%this.capacity]}set(e,t){if(e<0)throw new RangeError("Can't set item at a negative index.");this.data[e%this.capacity]=t}length(){let e=this.end-this.begin;return e<0&&(e=this.doubledCapacity+e),e}isFull(){return this.length()===this.capacity}isEmpty(){return this.length()===0}push(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,e),this.end=this.wrap(this.end+1)}pushAll(e){for(let t of e)this.push(t)}pop(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);let e=this.get(this.end);return this.set(this.end,void 0),e}unshift(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,e)}shift(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");let e=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),e}shuffleExcise(e){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");let t=this.wrap(this.begin+e),n=this.get(t);return this.set(t,this.pop()),n}},B2=class extends sW{constructor(){super(B2.INITIAL_CAPACITY)}isFull(){return!1}push(e){super.isFull()&&this.expand(),super.push(e)}unshift(e){super.isFull()&&this.expand(),super.unshift(e)}expand(){let e=this.capacity*2,t=new Array(e),n=this.length();for(let r=0;r<n;r++)t[r]=this.get(this.wrap(this.begin+r));this.data=t,this.capacity=e,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n}};B2.INITIAL_CAPACITY=32;function oW(e){return new Whe(e)}function W2(e){return new Uhe(e)}function zhe(e,t){return new lW(e,t)}function Bhe(e,t=co.FAIL){return new Zhe(e,t)}var zn=class{async toArray(){let e=[],t=await this.next();for(;!t.done;)e.push(t.value),t=await this.next();return e}async toArrayForTest(){let e=this.prefetch(100),t=[],n=await e.next();for(;!n.done;)t.push(n.value),n=await e.next();return t}async resolveFully(){let e=await this.next();for(;!e.done;)e=await this.next()}async resolveWhile(e){let t=await this.next(),n=e(t.value);for(;!t.done&&n;)t=await this.next(),n=e(t.value)}handleErrors(e){return new Xhe(this,e)}filter(e){return new qhe(this,e)}map(e){return new Khe(this,e)}mapAsync(e){return new HR(this,e)}serialMapAsync(e){return new HR(this,e).serial()}flatmap(e){return new Yhe(this,e)}async forEachAsync(e){return this.map(e).resolveFully()}async serialForEach(e){return this.serialMapAsync(e).resolveWhile(t=>t===!0)}rowMajorBatch(e,t=!0){return new Ghe(this,e,t)}columnMajorBatch(e,t=!0,n=aW){return this.rowMajorBatch(e,t).map(r=>Fhe(r,n))}concatenate(e,t){return new lW(oW([this,e]),t)}take(e){return e<0||e==null?this:new jhe(this,e)}skip(e){return e<0||e==null?this:new Hhe(this,e)}prefetch(e){return new uW(this,e)}shuffle(e,t){return new Qhe(this,e,t)}serial(){return new Vhe(this)}},Whe=class extends zn{constructor(e){super(),this.items=e,this.trav=0}summary(){return"Array of ".concat(this.items.length," items")}async next(){if(this.trav>=this.items.length)return{value:null,done:!0};let e=this.items[this.trav];return this.trav++,{value:Lhe(e),done:!1}}},Uhe=class extends zn{constructor(e){super(),this.nextFn=e}summary(){return"Function call"}async next(){try{return this.nextFn()}catch(e){throw e.message="Error thrown while iterating through a dataset: ".concat(e.message),e}}},Vhe=class extends zn{constructor(e){super(),this.upstream=e,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> Serial")}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){return this.upstream.next()}},Hhe=class extends zn{constructor(e,t){super(),this.upstream=e,this.maxCount=t,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> Skip")}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.count++<this.maxCount;){let e=await this.upstream.next();if(e.done)return e;We(e.value)}return this.upstream.next()}},jhe=class extends zn{constructor(e,t){super(),this.upstream=e,this.maxCount=t,this.count=0}summary(){return"".concat(this.upstream.summary()," -> Take")}async next(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()}},Ghe=class extends zn{constructor(e,t,n=!0){super(),this.upstream=e,this.batchSize=t,this.enableSmallLastBatch=n,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> RowMajorBatch")}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){let e=[];for(;e.length<this.batchSize;){let t=await this.upstream.next();if(t.done)return this.enableSmallLastBatch&&e.length>0?{value:e,done:!1}:{value:null,done:!0};e.push(t.value)}return{value:e,done:!1}}},qhe=class extends zn{constructor(e,t){super(),this.upstream=e,this.predicate=t,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> Filter")}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;){let e=await this.upstream.next();if(e.done||this.predicate(e.value))return e;We(e.value)}}},Khe=class extends zn{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return"".concat(this.upstream.summary()," -> Map")}async next(){let e=await this.upstream.next();if(e.done)return{value:null,done:!0};let t=Ei.getTensorsInContainer(e.value),n=this.transform(e.value),r=Ei.getTensorsInContainer(n);for(let a of t)Ei.isTensorInList(a,r)||a.dispose();return{value:n,done:!1}}},Xhe=class extends zn{constructor(e,t){super(),this.upstream=e,this.handler=t,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> handleErrors")}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;)try{return await this.upstream.next()}catch(e){if(!this.handler(e))return{value:null,done:!0}}}},HR=class extends zn{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return"".concat(this.upstream.summary()," -> AsyncMap")}async next(){let e=await this.upstream.next();if(e.done)return{value:null,done:!0};let t=Ei.getTensorsInContainer(e.value),n=await this.transform(e.value),r=Ei.getTensorsInContainer(n);for(let a of t)Ei.isTensorInList(a,r)||a.dispose();return{value:n,done:!1}}},U2=class extends zn{constructor(){super(),this.outputQueue=new B2,this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.outputQueue.length()===0;)if(!await this.pump())return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}}},Yhe=class extends U2{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return"".concat(this.upstream.summary()," -> Flatmap")}async pump(){let e=await this.upstream.next();if(e.done)return!1;let t=Ei.getTensorsInContainer(e.value),n=this.transform(e.value),r=Ei.getTensorsInContainer(n);this.outputQueue.pushAll(n);for(let a of t)Ei.isTensorInList(a,r)||a.dispose();return!0}},lW=class extends zn{constructor(e,t){super(),this.baseErrorHandler=t,this.lastRead=null,this.iterator=null,this.moreIterators=e}summary(){return"TODO: fill in upstream of chained summaries -> Chained"}async next(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead}async readFromChain(e){if(await e,this.iterator==null){let n=await this.moreIterators.next();if(n.done)return{value:null,done:!0};this.iterator=n.value,this.baseErrorHandler!=null&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}let t=await this.iterator.next();return t.done?(this.iterator=null,this.readFromChain(e)):t}},co;(function(e){e[e.FAIL=0]="FAIL",e[e.SHORTEST=1]="SHORTEST",e[e.LONGEST=2]="LONGEST"})(co||(co={}));var Zhe=class extends zn{constructor(e,t=co.FAIL){super(),this.iterators=e,this.mismatchMode=t,this.count=0,this.currentPromise=null}summary(){return"{TODO: fill in upstream of zip summaries} -> Zip"}async nextState(e){await e;let t=0,n=0;function r(i){return i instanceof zn?{value:i.next().then(s=>(t++,s.done&&n++,s.value)),recurse:!1}:{value:null,recurse:!0}}let a=await iW(this.iterators,r);if(t===n)return{value:null,done:!0};if(n>0)switch(this.mismatchMode){case co.FAIL:throw new Error("Zipped streams should have the same length. Mismatched at element ".concat(this.count,"."));case co.SHORTEST:return{value:null,done:!0};case co.LONGEST:}return this.count++,{value:a,done:!1}}async next(){return this.currentPromise=this.nextState(this.currentPromise),this.currentPromise}},uW=class extends zn{constructor(e,t){super(),this.upstream=e,this.bufferSize=t,this.buffer=new sW(t)}summary(){return"".concat(this.upstream.summary()," -> Prefetch")}refill(){for(;!this.buffer.isFull();){let e=this.upstream.next();this.buffer.push(e)}}next(){return this.refill(),this.buffer.shift()}},Qhe=class extends uW{constructor(e,t,n){super(e,t),this.upstream=e,this.windowSize=t,this.upstreamExhausted=!1,this.random=Rhe.alea(n||k.now().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}randomInt(e){return Math.floor(this.random()*e)}chooseIndex(){return this.randomInt(this.buffer.length())}async serialNext(){for(this.upstreamExhausted||this.refill();!this.buffer.isEmpty();){let e=this.chooseIndex(),t=await this.buffer.shuffleExcise(e);if(t.done)this.upstreamExhausted=!0;else return this.refill(),t}return{value:null,done:!0}}},Hh=class{constructor(){this.size=null}batch(e,t=!0){let n=this;k.assert(e>0,()=>"batchSize needs to be positive, but it is\n      ".concat(e));let r;return this.size===1/0||this.size==null?r=this.size:t?r=Math.ceil(this.size/e):r=Math.floor(this.size/e),ea(async()=>(await n.iterator()).columnMajorBatch(e,t,tfe),r)}concatenate(e){let t=this,n;return this.size===1/0||e.size===1/0?n=1/0:this.size!=null&&e.size!=null?n=this.size+e.size:n=null,ea(async()=>(await t.iterator()).concatenate(await e.iterator()),n)}filter(e){let t=this,n;return this.size===1/0?n=1/0:n=null,ea(async()=>(await t.iterator()).filter(r=>K(()=>e(r))),n)}async forEachAsync(e){return(await this.iterator()).forEachAsync(e)}map(e){let t=this;return ea(async()=>(await t.iterator()).map(n=>K(()=>e(n))),this.size)}mapAsync(e){let t=this;return ea(async()=>(await t.iterator()).mapAsync(e),this.size)}prefetch(e){if(e==null)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");let t=this;return ea(async()=>(await t.iterator()).prefetch(e),this.size)}repeat(e){let t=this,n;return this.size!=null&&e>0?n=this.size*e:e===0?n=0:this.size!=null&&(e===void 0||e<0)?n=1/0:n=null,ea(async()=>{let r=W2(async()=>({value:await t.iterator(),done:!1}));return zhe(r.take(e))},n)}skip(e){let t=this,n;return this.size!=null&&e>=0&&this.size>=e?n=this.size-e:this.size!=null&&(this.size<e||e===void 0||e<0)?n=0:n=null,ea(async()=>(await t.iterator()).skip(e),n)}shuffle(e,t,n=!0){if(e==null||e<0)throw this.size==null?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting bufferSize to the dataset size (".concat(this.size," elements)"));let r=this,a=Ahe.alea(t||k.now().toString());return ea(async()=>{let i=a.int32();return n&&(i+=a.int32()),(await r.iterator()).shuffle(e,i.toString())},this.size)}take(e){let t=this,n;return this.size!=null&&this.size>e?n=e:this.size!=null&&this.size<=e?n=this.size:n=null,ea(async()=>(await t.iterator()).take(e),n)}async toArray(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArray()}async toArrayForTest(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArrayForTest()}};Hh.MAX_BUFFER_SIZE=1e4;function ea(e,t=null){return new class extends Hh{constructor(){super(...arguments),this.size=t}async iterator(){return e()}}}function Jhe(e){return ea(async()=>oW(e),e.length)}function efe(e){if(!bp(e))throw new Error("The argument to zip() must be an object or array.");let t;if(Array.isArray(e))for(let n=0;n<e.length;n++)t=t==null?e[n].size:Math.min(t,e[n].size);else if(e instanceof Object)for(let n in e)t=t==null?e[n].size:Math.min(t,e[n].size);return ea(async()=>{let n=await iW(e,r=>{if(r instanceof Hh)return{value:r.iterator(),recurse:!1};if(bp(r))return{value:null,recurse:!0};throw new Error("Leaves of the structure passed to zip() must be Datasets, not primitives.")});return Bhe(n,co.SHORTEST)},t)}function tfe(e){if(e===null)return null;let t=e[0];return Mhe(t)?{value:nfe(e),recurse:!1}:{value:null,recurse:!0}}function nfe(e){if(e.length===0)throw new Error("Can't make a batch of zero elements.");return e[0]instanceof He?Sn(e):wr(e)}var cW=class extends Hh{constructor(e){super(),this.input=e}async iterator(){return(await this.input.iterator()).decodeUTF8().split("\n").map(e=>(e.endsWith("\r")&&(e=e.slice(0,-1)),e))}},Yy='"',bf=Symbol("out"),jR=Symbol("field"),Zy=Symbol("quote"),E1=Symbol("quoteafterquote"),GR=Symbol("quoteinquote"),dW=class extends Hh{async columnNames(){return this.columnNamesValidated||await this.setColumnNames(),this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames}async setColumnNames(){let e=await this.maybeReadHeaderLine();if(!this.fullColumnNames&&!e)throw new Error("Column names must be provided if there is no header line.");this.fullColumnNames&&e&&k.assert(e.length===this.fullColumnNames.length,()=>"The length of provided columnNames ("+this.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+e.length.toString()+")."),this.fullColumnNames||(this.fullColumnNames=e);let t=this.fullColumnNames.reduce((r,a)=>(r[a]=r[a]+1||1,r),{}),n=Object.keys(t).filter(r=>t[r]>1);if(k.assert(n.length===0,()=>"Duplicate column names found: "+n.toString()),this.columnConfigs){for(let r of Object.keys(this.columnConfigs))if(this.fullColumnNames.indexOf(r)===-1)throw new Error('The key "'+r+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").")}this.columnNamesValidated=!0}async maybeReadHeaderLine(){if(this.hasHeader){let e=await(await this.base.iterator()).next();if(e.done)throw new Error("No data was found for CSV parsing.");let t=e.value;return this.parseRow(t,!1)}else return null}constructor(e,t){super(),this.input=e,this.hasHeader=!0,this.fullColumnNames=null,this.columnNamesValidated=!1,this.columnConfigs=null,this.configuredColumnsOnly=!1,this.delimiter=",",this.delimWhitespace=!1,this.base=new cW(e),t||(t={}),this.hasHeader=t.hasHeader!==!1,this.fullColumnNames=t.columnNames,this.columnConfigs=t.columnConfigs,this.configuredColumnsOnly=t.configuredColumnsOnly,t.delimWhitespace?(k.assert(t.delimiter==null,()=>"Delimiter should not be provided when delimWhitespace is true."),this.delimWhitespace=!0,this.delimiter=" "):this.delimiter=t.delimiter?t.delimiter:","}async iterator(){this.columnNamesValidated||await this.setColumnNames();let e=await this.base.iterator();return this.hasHeader&&(e=e.skip(1)),e.map(t=>this.makeDataElement(t))}makeDataElement(e){let t=this.parseRow(e),n={},r={};for(let a=0;a<this.fullColumnNames.length;a++){let i=this.fullColumnNames[a],s=this.columnConfigs?this.columnConfigs[i]:null;if(!(this.configuredColumnsOnly&&!s)){let o=t[a],l=null;if(o==="")if(s&&s.default!==void 0)l=s.default;else{if(s&&(s.required||s.isLabel))throw new Error("Required column ".concat(i," is empty in this line: ").concat(e));l=void 0}else{let c=Number(o);if(isNaN(c))s&&s.dtype==="bool"?l=this.getBoolean(o):l=o;else if(!s||!s.dtype)l=c;else switch(s.dtype){case"float32":l=c;break;case"int32":l=Math.floor(c);break;case"bool":l=this.getBoolean(o);break;default:l=c}}s&&s.isLabel?r[i]=l:n[i]=l}}return Object.keys(r).length===0?n:{xs:n,ys:r}}getBoolean(e){return e==="1"||e.toLowerCase()==="true"?1:0}parseRow(e,t=!0){let n=[],r=0,a=e.length,i=bf;for(let s=0;s<a;s++)switch(i){case bf:switch(e.charAt(s)){case Yy:r=s+1,i=Zy;break;case this.delimiter:if(r=s+1,this.delimiter===" "&&this.delimWhitespace)break;n.push(""),i=bf;break;default:i=jR,r=s;break}break;case jR:switch(e.charAt(s)){case this.delimiter:n.push(e.substring(r,s)),i=bf,r=s+1;break}break;case Zy:switch(e.charAt(s)){case Yy:i=E1;break}break;case E1:switch(e.charAt(s)){case this.delimiter:n.push(e.substring(r,s-1)),i=bf,r=s+1;break;case Yy:i=Zy;break;default:i=GR;break}break;case GR:switch(e.charAt(s)){case Yy:i=Zy;break}break}if(i===E1?n.push(e.substring(r,a-1)):n.push(e.substring(r)),t&&n.length!==this.fullColumnNames.length)throw new Error("Invalid row in csv file. Should have ".concat(this.fullColumnNames.length," elements in a row, but got ").concat(n));return n}},pW=class extends zn{constructor(e){super(),this.microphoneConfig=e,this.isClosed=!1,this.fftSize=e.fftSize||1024;let t=Math.log2(this.fftSize);if(this.fftSize<0||t<4||t>14||!Number.isInteger(t))throw new Error("Invalid fftSize: it must be a power of 2 between 2 to 4 and 2 to 14, but got ".concat(this.fftSize));if(this.numFrames=e.numFramesPerSpectrogram||43,this.sampleRateHz=e.sampleRateHz,this.columnTruncateLength=e.columnTruncateLength||this.fftSize,this.audioTrackConstraints=e.audioTrackConstraints,this.smoothingTimeConstant=e.smoothingTimeConstant||0,this.includeSpectrogram=e.includeSpectrogram!==!1,this.includeWaveform=e.includeWaveform===!0,!this.includeSpectrogram&&!this.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.")}summary(){return"microphone"}static async create(e={}){if(!Z().get("IS_BROWSER"))throw new Error("microphone API is only supported in browser environment.");let t=new pW(e);return await t.start(),t}async start(){try{this.stream=await navigator.mediaDevices.getUserMedia({audio:this.audioTrackConstraints==null?!0:this.audioTrackConstraints,video:!1})}catch(n){throw new Error("Error thrown while initializing video stream: ".concat(n.message))}if(!this.stream)throw new Error("Could not obtain audio from microphone.");let e=window.AudioContext||window.webkitAudioContext;if(this.audioContext=new e,!this.sampleRateHz)this.sampleRateHz=this.audioContext.sampleRate;else if(this.audioContext.sampleRate!==this.sampleRateHz)throw new Error("Mismatch in sampling rate: Expected: ".concat(this.sampleRateHz,"; Actual: ").concat(this.audioContext.sampleRate));let t=this.audioContext.createMediaStreamSource(this.stream);this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=this.fftSize*2,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,t.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize)}async next(){if(this.isClosed)return{value:null,done:!0};let e,t,n=await this.getAudioData();if(this.includeSpectrogram){let r=this.flattenQueue(n.freqDataQueue);e=this.getTensorFromAudioDataArray(r,[this.numFrames,this.columnTruncateLength,1])}if(this.includeWaveform){let r=this.flattenQueue(n.timeDataQueue);t=this.getTensorFromAudioDataArray(r,[this.numFrames*this.fftSize,1])}return{value:{spectrogram:e,waveform:t},done:!1}}async capture(){return(await this.next()).value}async getAudioData(){let e=[],t=[],n=0;return new Promise(r=>{let a=setInterval(()=>{this.includeSpectrogram&&(this.analyser.getFloatFrequencyData(this.freqData),this.freqData[0]===-1/0&&r({freqDataQueue:e,timeDataQueue:t}),e.push(this.freqData.slice(0,this.columnTruncateLength))),this.includeWaveform&&(this.analyser.getFloatTimeDomainData(this.timeData),t.push(this.timeData.slice())),++n===this.numFrames&&(clearInterval(a),r({freqDataQueue:e,timeDataQueue:t}))},this.fftSize/this.sampleRateHz*1e3)})}stop(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),this.stream!=null&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())}toArray(){throw new Error("Can not convert infinite audio stream to array.")}getSampleRate(){return this.sampleRateHz}flattenQueue(e){let t=e[0].length,n=new Float32Array(e.length*t);return e.forEach((r,a)=>n.set(r,a*t)),n}getTensorFromAudioDataArray(e,t){let n=new Float32Array(k.sizeFromShape(t));return n.set(e,n.length-e.length),wr(n,t)}},hW=class extends zn{constructor(e,t){if(super(),this.webcamVideoElement=e,this.webcamConfig=t,this.isClosed=!0,this.resize=!1,this.needToResize())if(this.resize=!0,this.cropSize=[this.webcamConfig.resizeHeight,this.webcamConfig.resizeWidth],this.cropBoxInd=ht([0],"int32"),this.webcamConfig.centerCrop){let n=this.webcamConfig.resizeWidth*1/this.webcamVideoElement.width,r=this.webcamConfig.resizeHeight*1/this.webcamVideoElement.height,a=(1-n)/2,i=(1-r)/2,s=a+n,o=r+i;this.cropBox=ts([i,a,o,s],[1,4])}else this.cropBox=ts([0,0,1,1],[1,4])}summary(){return"webcam"}static async create(e,t={}){if(!Z().get("IS_BROWSER"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!e){if(e=document.createElement("video"),!t.resizeWidth||!t.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");e.width=t.resizeWidth,e.height=t.resizeHeight}let n=new hW(e,t);return await n.start(),n}async start(){this.webcamConfig.facingMode&&k.assert(this.webcamConfig.facingMode==="user"||this.webcamConfig.facingMode==="environment",()=>"Invalid webcam facing mode: ".concat(this.webcamConfig.facingMode,". Please provide 'user' or 'environment'"));try{this.stream=await navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})}catch(e){throw e.message="Error thrown while initializing video stream: ".concat(e.message),e}if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(e){console.log(e),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,new Promise(e=>{this.webcamVideoElement.onloadedmetadata=()=>{e()}})}async next(){if(this.isClosed)return{value:null,done:!0};let e;try{e=Wg.fromPixels(this.webcamVideoElement)}catch(t){throw new Error("Error thrown converting video to pixels: ".concat(JSON.stringify(t)))}if(this.resize)try{return{value:this.cropAndResizeFrame(e),done:!1}}catch(t){throw new Error("Error thrown cropping the video: ".concat(t.message))}finally{e.dispose()}else return{value:e,done:!1}}needToResize(){return!!(this.webcamConfig.resizeWidth&&this.webcamConfig.resizeHeight&&(this.webcamVideoElement.width!==this.webcamConfig.resizeWidth||this.webcamVideoElement.height!==this.webcamConfig.resizeHeight))}cropAndResizeFrame(e){return K(()=>{let t=Vn(de(e,"float32"),0),n;n=$a.cropAndResize(t,this.cropBox,this.cropBoxInd,this.cropSize,"bilinear");let r=n.shape;return q(n,r.slice(1))})}async capture(){return(await this.next()).value}stop(){this.stream.getTracks().forEach(e=>e.stop());try{this.webcamVideoElement.srcObject=null}catch(e){console.log(e),this.webcamVideoElement.src=null}this.isClosed=!0}toArray(){throw new Error("Can not convert infinite video stream to array.")}},fW=class{},mW=class extends zn{split(e){return new rfe(this,e)}},rfe=class extends mW{constructor(e,t){super(),this.upstream=e,this.impl=new afe(e,t)}summary(){return this.impl.summary()}async next(){return this.impl.next()}},afe=class extends U2{constructor(e,t){super(),this.upstream=e,this.separator=t,this.carryover=""}summary(){return"".concat(this.upstream.summary()," -> Split('").concat(this.separator,"')")}async pump(){let e=await this.upstream.next();if(e.done)return this.carryover===""?!1:(this.outputQueue.push(this.carryover),this.carryover="",!0);let t=e.value.split(this.separator);t[0]=this.carryover+t[0];for(let n of t.slice(0,-1))this.outputQueue.push(n);return this.carryover=t[t.length-1],!0}},ife=class extends zn{decodeUTF8(){return new sfe(this)}},sfe=class extends mW{constructor(e){super(),this.upstream=e,this.impl=new ofe(e)}summary(){return this.impl.summary()}async next(){return this.impl.next()}},ofe=class extends U2{constructor(e){if(super(),this.upstream=e,Z().get("IS_BROWSER"))this.decoder=new TextDecoder("utf-8");else{let{StringDecoder:t}=WL();this.decoder=new t("utf8")}}summary(){return"".concat(this.upstream.summary()," -> Utf8")}async pump(){let e=await this.upstream.next(),t;if(e.done)return!1;t=e.value;let n;return Z().get("IS_BROWSER")?n=this.decoder.decode(t,{stream:!0}):n=this.decoder.write(Buffer.from(t.buffer)),this.outputQueue.push(n),!0}},gW=class extends ife{constructor(e,t={}){super(),this.file=e,this.options=t,k.assert(e instanceof Uint8Array||(Z().get("IS_BROWSER")?e instanceof File||e instanceof Blob:!1),()=>"FileChunkIterator only supports File, Blob and Uint8Array right now."),this.offset=t.offset||0,this.chunkSize=t.chunkSize||1024*1024}summary(){return"FileChunks ".concat(this.file)}async next(){return this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size)?{value:null,done:!0}:{value:await new Promise((e,t)=>{let n=this.offset+this.chunkSize;if(this.file instanceof Uint8Array)e(new Uint8Array(this.file.slice(this.offset,n)));else{let r=new FileReader;r.onload=i=>{let s=r.result;if(s instanceof ArrayBuffer&&(s=new Uint8Array(s)),!(s instanceof Uint8Array))return t(new TypeError("FileReader returned unknown type."));e(s)},r.onabort=i=>t(new Error("Aborted")),r.onerror=i=>t(new Error(i.type));let a=this.file.slice(this.offset,n);r.readAsArrayBuffer(a)}this.offset=n}),done:!1}}};async function lfe(e,t={},n){let r,a;typeof e=="string"?r=e:(r=e.url,a=ufe(e));let i=await(n||k.fetch)(r,a);if(i.ok){let s=new Uint8Array(await i.arrayBuffer());return new gW(s,t)}else throw new Error(i.statusText)}var ufe=e=>({method:e.method,headers:e.headers,body:e.body,mode:e.mode,credentials:e.credentials,cache:e.cache,redirect:e.redirect,referrer:e.referrer,integrity:e.integrity});function yW(e){return typeof e=="string"&&e.slice(0,7)==="file://"}var bW=class extends fW{constructor(e,t={}){super(),this.input=e,this.options=t}async iterator(){if(yW(this.input)&&Z().get("IS_NODE")){let e=D$();this.input=e.readFileSync(this.input.slice(7))}return new gW(this.input,this.options)}},vW=class extends fW{constructor(e,t={}){super(),this.url=e,this.fileOptions=t}async iterator(){return yW(this.url)?new bW(this.url,this.fileOptions).iterator():lfe(this.url,this.fileOptions)}};function cfe(e,t={}){return new dW(new vW(e),t)}function dfe(e){let t=W2(e);return ea(async()=>t)}function pfe(e){return ea(async()=>{let t=await e();return W2(()=>t.next())})}async function hfe(e,t){return hW.create(e,t)}async function ffe(e){return pW.create(e)}var mfe="4.7.0";function $e(e,t){Array.isArray(e)||(e=[e]),e.forEach(n=>{n!=null&&k.assert(n.dtype!=="complex64",()=>"".concat(t," does not support complex64 tensors in the CPU backend."))})}var gfe=us.whereImpl,lw=class extends eg{nextDataId(){return lw.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new G0(this,ja())}write(e,t,n){this.firstUse&&(this.firstUse=!1,Z().get("IS_NODE")&&T.warn("\n============================\nHi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. \n============================"));let r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:n,refCount:1}),r}makeTensorInfo(e,t,n){let r;if(t==="string"&&n!=null&&n.length>0&&k.isString(n[0])){let a=n.map(i=>k.encodeString(i));r=this.write(a,e,t)}else r=this.write(n,e,t);return{dataId:r,shape:e,dtype:t}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){let t=this.data.get(e);t.refCount++}decRef(e){if(this.data.has(e)){let t=this.data.get(e);t.refCount--}}move(e,t,n,r,a){this.data.set(e,{values:t,dtype:r,refCount:a})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){let{dtype:t,complexTensorInfos:n}=this.data.get(e);if(t==="complex64"){let r=this.readSync(n.real.dataId),a=this.readSync(n.imag.dataId);return T.mergeRealAndImagArrays(r,a)}return k.convertBackendValuesAndArrayBuffer(this.data.get(e).values,t)}bufferSync(e){let t=this.readSync(e.dataId);if(e.dtype==="string")try{let n=t.map(r=>k.decodeString(r));return Ze(e.shape,e.dtype,n)}catch(n){throw new Error("Failed to decode encoded string bytes into utf-8")}return Ze(e.shape,e.dtype,t)}makeOutput(e,t,n){return ja().makeTensorFromTensorInfo(this.makeTensorInfo(t,n,e),this)}disposeData(e,t=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!t&&this.data.get(e).refCount>0)return!1;let{complexTensorInfos:n}=this.data.get(e);n!=null&&(this.disposeData(n.real.dataId,!0),this.disposeData(n.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){let t=k.now();return e(),{kernelMs:k.now()-t}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){$e([e],"where");let t=this.readSync(e.dataId);return gfe(e.shape,t)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}};lw.nextDataId=0;var V2={};Ue(V2,{addImpl:()=>kW,bincountImpl:()=>j2,bincountReduceImpl:()=>SW,bitwiseAndImpl:()=>IW,castImpl:()=>wW,ceilImpl:()=>$W,concatImpl:()=>G2,equalImpl:()=>CW,expImpl:()=>TW,expm1Impl:()=>_W,floorDivImpl:()=>RW,floorImpl:()=>AW,gatherNdImpl:()=>DW,gatherV2Impl:()=>FW,greaterEqualImpl:()=>OW,greaterImpl:()=>MW,lessEqualImpl:()=>PW,lessImpl:()=>LW,linSpaceImpl:()=>zW,logImpl:()=>BW,maxImpl:()=>WW,maximumImpl:()=>UW,minimumImpl:()=>VW,multiplyImpl:()=>q2,negImpl:()=>HW,notEqualImpl:()=>jW,prodImpl:()=>GW,raggedGatherImpl:()=>qW,raggedRangeImpl:()=>KW,raggedTensorToTensorImpl:()=>XW,rangeImpl:()=>X2,rsqrtImpl:()=>YW,scatterImpl:()=>Al,sigmoidImpl:()=>fme,simpleAbsImpl:()=>xW,sliceImpl:()=>zv,sparseFillEmptyRowsImpl:()=>QW,sparseReshapeImpl:()=>JW,sparseSegmentReductionImpl:()=>Y2,sqrtImpl:()=>yme,squaredDifferenceImpl:()=>e4,staticRegexReplaceImpl:()=>t4,stridedSliceImpl:()=>n4,stringNGramsImpl:()=>Z2,stringSplitImpl:()=>Q2,stringToHashBucketFastImpl:()=>J2,subImpl:()=>r4,tileImpl:()=>a4,topKImpl:()=>s4,transposeImpl:()=>K2,uniqueImpl:()=>tT});function xW(e){let t=new Float32Array(e.length);for(let n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t}var yfe=e=>{let{x:t}=e.inputs,n=e.backend;$e(t,"abs");let r=new Float32Array(k.sizeFromShape(t.shape)),a=n.data.get(t.dataId).values;return r=xW(a),n.makeOutput(r,t.shape,t.dtype)},bfe={kernelName:Rp,backendName:"cpu",kernelFunc:yfe};function sn(e){return(t,n,r,a,i)=>{let s=T.assertAndGetBroadcastShape(t,n),o=s.length,l=k.computeStrides(s),c=k.sizeFromShape(s),u=k.getTypedArrayFromDType(i,c),d=t.length,p=n.length,h=k.computeStrides(t),f=k.computeStrides(n),m=T.getBroadcastDims(t,s),g=T.getBroadcastDims(n,s);if(m.length+g.length===0)for(let y=0;y<u.length;++y)u[y]=e(r[y%r.length],a[y%a.length]);else for(let y=0;y<u.length;++y){let b=k.indexToLoc(y,o,l),v=b.slice(-d);m.forEach(C=>v[C]=0);let x=k.locToIndex(v,d,h),w=b.slice(-p);g.forEach(C=>w[C]=0);let $=k.locToIndex(w,p,f);u[y]=e(r[x],a[$])}return[u,s]}}function ra(e){let{inputs:t,backend:n}=e,{real:r,imag:a}=t,i=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,o=n.makeTensorInfo(r.shape,"complex64"),l=n.data.get(o.dataId);return l.complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",i),imag:n.makeTensorInfo(a.shape,"float32",s)},o}var vfe={kernelName:X0,backendName:"cpu",kernelFunc:ra};function Pv(e,t,n="float32"){if(n==="complex64"){let a=Pv(e,t,"float32"),i=Pv(e,t,"float32");return ra({inputs:{real:a,imag:i},backend:e})}let r=k.makeZerosTypedArray(k.sizeFromShape(t),n);return e.makeTensorInfo(t,n,r)}function is(e){let{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var xfe={kernelName:Yu,backendName:"cpu",kernelFunc:is};function uu(e){let{inputs:t,backend:n}=e,{input:r}=t,a=n.data.get(r.dataId).complexTensorInfos.real,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}var wfe={kernelName:sx,backendName:"cpu",kernelFunc:uu};function wW(e,t,n,r){if(r==="int32"){let a=Int32Array.from(e);return[t,"int32",a]}if(r==="bool"){let a=k.toTypedArray([0],n),[i,s]=sn((o,l)=>o!==l?1:0)(t,[],e,a,"bool");return[s,"bool",i]}throw new Error("Error in Cast: failed to cast ".concat(n," to ").concat(r))}function zo(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{dtype:i}=r;if(i==="complex64"){if(a.dtype==="complex64")return is({inputs:{x:a},backend:n});let u=Pv(n,a.shape,a.dtype),d=zo({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),p=ra({inputs:{real:d,imag:u},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),p}if(a.dtype==="complex64"){let u=uu({inputs:{input:a},backend:n}),d=zo({inputs:{x:u},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(u),d}if(!k.hasEncodingLoss(a.dtype,i)){let u=is({inputs:{x:a},backend:n});return{dataId:u.dataId,shape:u.shape,dtype:i}}let s=n.data.get(a.dataId).values,[o,l,c]=wW(s,a.shape,a.dtype,i);return n.makeTensorInfo(o,l,c)}var kfe={kernelName:Au,backendName:"cpu",kernelFunc:zo};function En(e,t,n,r){return n==null?({inputs:a,backend:i})=>{let{a:s,b:o}=a,l=i;$e([s,o],e);let c=l.data.get(s.dataId).values,u=l.data.get(o.dataId).values,d=s.dtype==="string"?T.fromUint8ToStringArray(c):c,p=s.dtype==="string"?T.fromUint8ToStringArray(u):u,h=r||s.dtype,[f,m]=t(s.shape,o.shape,d,p,h);return l.makeTensorInfo(m,h,f)}:({inputs:a,backend:i})=>{let{a:s,b:o}=a,l=i;if(s.dtype==="complex64"||o.dtype==="complex64"){let c=zo({inputs:{x:s},backend:l,attrs:{dtype:"complex64"}}),u=l.data.get(c.dataId),d=u.complexTensorInfos.real,p=u.complexTensorInfos.imag,h=l.data.get(d.dataId).values,f=l.data.get(p.dataId).values,m=zo({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),g=l.data.get(m.dataId),y=g.complexTensorInfos.real,b=g.complexTensorInfos.imag,v=l.data.get(y.dataId).values,x=l.data.get(b.dataId).values,[w,$,C]=n(s.shape,o.shape,h,f,v,x),E=l.makeTensorInfo(C,"float32",w),_=l.makeTensorInfo(C,"float32",$),R=ra({inputs:{real:E,imag:_},backend:l});return l.disposeIntermediateTensorInfo(c),l.disposeIntermediateTensorInfo(m),l.disposeIntermediateTensorInfo(E),l.disposeIntermediateTensorInfo(_),R}else{let c=l.data.get(s.dataId).values,u=l.data.get(o.dataId).values,d=r||s.dtype,[p,h]=t(s.shape,o.shape,c,u,d);return l.makeTensorInfo(h,d,p)}}}function H2(e){return(t,n,r,a,i,s)=>{let o=T.assertAndGetBroadcastShape(t,n),l=k.sizeFromShape(o),c=o.length,u=k.computeStrides(o),d=k.getTypedArrayFromDType("float32",l),p=k.getTypedArrayFromDType("float32",l),h=T.getBroadcastDims(t,o),f=T.getBroadcastDims(n,o),m=T.mergeRealAndImagArrays(r,a),g=T.mergeRealAndImagArrays(i,s),y=t.length,b=k.computeStrides(t),v=n.length,x=k.computeStrides(n);if(h.length+f.length===0)for(let w=0;w<d.length;w++){let $=w%m.length,C=w%g.length,E=e(m[$*2],m[$*2+1],g[C*2],g[C*2+1]);d[w]=E.real,p[w]=E.imag}else for(let w=0;w<d.length;w++){let $=k.indexToLoc(w,c,u),C=$.slice(-y);h.forEach(I=>C[I]=0);let E=k.locToIndex(C,y,b),_=$.slice(-v);f.forEach(I=>_[I]=0);let R=k.locToIndex(_,v,x),N=e(m[E*2],m[E*2+1],g[R*2],g[R*2+1]);d[w]=N.real,p[w]=N.imag}return[d,p,o]}}var kW=sn((e,t)=>e+t),Sfe=H2((e,t,n,r)=>({real:e+n,imag:t+r})),vp=En(Go,kW,Sfe),Ife={kernelName:Go,backendName:"cpu",kernelFunc:vp};function j2(e,t,n,r,a){let i=k.sizeFromShape(r),s=k.makeZerosTypedArray(a,n);for(let o=0;o<e.length;o++){let l=e[o];if(l<0)throw new Error("Input x must be non-negative!");l>=a||(i>0?s[l]+=t[o]:s[l]+=1)}return s}function SW(e,t,n,r=!1){let a=e.shape[0],i=e.shape[1],s=Ze([a,n],t.dtype);for(let o=0;o<a;o++)for(let l=0;l<i;l++){let c=e.get(o,l);if(c<0)throw new Error("Input x must be non-negative!");c>=n||(r?s.set(1,o,c):t.size>0?s.set(s.get(o,c)+t.get(o,l),o,c):s.set(s.get(o,c)+1,o,c))}return s}var IW=sn((e,t)=>e&t),$fe=En(Bp,IW),Cfe={kernelName:Bp,backendName:"cpu",kernelFunc:$fe};function ds(e){return(t,n,r)=>{let a=k.getArrayFromDType(n,t.length);for(let i=0;i<t.length;++i)a[i]=e(t[i],r);return a}}function mt(e,t,n){let r=ds(t);return tl(e,r,n)}function tl(e,t,n){return({inputs:r,attrs:a,backend:i})=>{let{x:s}=r;$e(s,e);let o=i,l=o.data.get(s.dataId).values,c;if(s.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");c=T.fromUint8ToStringArray(l)}else c=l;let u=n||s.dtype,d=t(c,u,a);return o.makeTensorInfo(s.shape,u,d)}}var $W=ds(e=>Math.ceil(e)),Efe=tl(Ru,$W),Tfe={kernelName:Ru,backendName:"cpu",kernelFunc:Efe};function G2(e,t,n,r){let a=k.getArrayFromDType(n,k.sizeFromShape(t));if(r&&n!=="string"){let i=0;e.forEach(s=>{let o=k.sizeFromShape(s.shape);a.set(s.vals,i),i+=o})}else{let i=0;e.forEach(s=>{let o=n==="string"?T.fromUint8ToStringArray(s.vals):s.vals,l=0;for(let c=0;c<s.shape[0];++c){let u=c*t[1]+i;for(let d=0;d<s.shape[1];++d)a[u+d]=o[l++]}i+=s.shape[1]})}return a}var CW=sn((e,t)=>e===t?1:0),EW=En(Kp,CW,null,"bool"),Nfe={kernelName:Kp,backendName:"cpu",kernelFunc:EW},TW=ds(e=>Math.exp(e)),NW=tl(Hu,TW,"float32"),_fe={kernelName:Hu,backendName:"cpu",kernelFunc:NW},_W=ds(e=>Math.expm1(e)),Afe=tl(ju,_W),Rfe={kernelName:ju,backendName:"cpu",kernelFunc:Afe},AW=ds(e=>Math.floor(e)),Dfe=tl(Gu,AW),Ffe={kernelName:Gu,backendName:"cpu",kernelFunc:Dfe},RW=sn((e,t)=>Math.floor(e/t)),Mfe=En(qu,RW,null,"int32"),Ofe={kernelName:qu,backendName:"cpu",kernelFunc:Mfe};function DW(e,t,n,r,a,i,s,o,l){let c=Ze([r,i],n);for(let u=0;u<r;u++){let d=[],p=0;for(let h=0;h<a;h++){let f=e[u*a+h];p+=f*s[h],d.push(f)}if(p<0||p>=l/i)throw new Error("Invalid indices: ".concat(d," does not index into ").concat(o));for(let h=0;h<i;h++)c.values[u*i+h]=t.get(...t.indexToLoc(p*i+h))}return c}function FW(e,t,n){let r=Ze(n,e.dtype);for(let a=0;a<r.size;++a){let i=r.indexToLoc(a).slice(),s=i[0],o=i[2],l=t.locToIndex([s,o]);i[2]=t.values[l];let c=e.locToIndex(i);0<=c&&c<e.values.length&&(r.values[a]=e.values[c])}return r}var MW=sn((e,t)=>e>t?1:0),Lfe=En(Jp,MW,null,"bool"),Pfe={kernelName:Jp,backendName:"cpu",kernelFunc:Lfe},OW=sn((e,t)=>e>=t?1:0),zfe=En(Xu,OW,null,"bool"),Bfe={kernelName:Xu,backendName:"cpu",kernelFunc:zfe},LW=sn((e,t)=>e<t?1:0),Wfe=En(eh,LW,null,"bool"),Ufe={kernelName:eh,backendName:"cpu",kernelFunc:Wfe},PW=sn((e,t)=>e<=t?1:0),Vfe=En(th,PW,null,"bool"),Hfe={kernelName:th,backendName:"cpu",kernelFunc:Vfe};function zW(e,t,n){let r=(t-e)/(n-1),a=k.makeZerosTypedArray(n,"float32");a[0]=e;for(let i=1;i<a.length;i++)a[i]=a[i-1]+r;return a}var BW=ds(e=>Math.log(e)),jfe=tl(tc,BW),Gfe={kernelName:tc,backendName:"cpu",kernelFunc:jfe};function WW(e,t,n,r){let a=k.getTypedArrayFromDType(r,k.sizeFromShape(n));for(let i=0;i<a.length;++i){let s=i*t,o=e[s];for(let l=0;l<t;++l){let c=e[s+l];(Number.isNaN(c)||c>o)&&(o=c)}a[i]=o}return a}var UW=sn((e,t)=>Math.max(e,t)),qfe=En(ic,UW),Kfe={kernelName:ic,backendName:"cpu",kernelFunc:qfe},VW=sn((e,t)=>Math.min(e,t)),Xfe=En(uc,VW),Yfe={kernelName:uc,backendName:"cpu",kernelFunc:Xfe},q2=sn((e,t)=>e*t),Zfe=H2((e,t,n,r)=>({real:e*n-t*r,imag:e*r+t*n})),uw=En(pc,q2,Zfe),Qfe={kernelName:pc,backendName:"cpu",kernelFunc:uw};function HW(e,t,n){let r=k.createScalarValue(-1,n);return q2([],t,r,e,n)}function Jfe(e){let{inputs:t,backend:n}=e,{x:r}=t;$e(r,"neg");let a=n.data.get(r.dataId).values,[i,s]=HW(a,r.shape,r.dtype);return n.makeTensorInfo(s,r.dtype,i)}var eme={kernelName:uh,backendName:"cpu",kernelFunc:Jfe},jW=sn((e,t)=>e!==t?1:0),tme=En(ch,jW,null,"bool"),nme={kernelName:ch,backendName:"cpu",kernelFunc:tme};function K2(e,t,n,r,a){let i=t.length,s=k.sizeFromShape(t),o=k.computeStrides(t),l=k.computeStrides(a),c=k.getTypedArrayFromDType(n,k.sizeFromShape(a));for(let u=0;u<s;++u){let d=k.indexToLoc(u,i,o),p=new Array(d.length);for(let f=0;f<p.length;f++)p[f]=d[r[f]];let h=k.locToIndex(p,i,l);c[h]=e[u]}return c}function Gr(e){let{inputs:t,attrs:n,backend:r}=e,{x:a}=t,{perm:i}=n;$e(a,"transpose");let s=a.shape.length,o=new Array(s);for(let u=0;u<o.length;u++)o[u]=a.shape[i[u]];let l=r.data.get(a.dataId).values,c=K2(l,a.shape,a.dtype,i,o);return{dataId:r.write(c,o,a.dtype),shape:o,dtype:a.dtype}}var rme={kernelName:Es,backendName:"cpu",kernelFunc:Gr};function GW(e,t,n,r){let[a,i]=T.computeOutAndReduceShapes(e,r),s=Ra(t,"int32"),o=k.makeZerosTypedArray(k.sizeFromShape(a),s),l=k.sizeFromShape(i);for(let c=0;c<o.length;++c){let u=c*l,d=1;for(let p=0;p<l;++p)d*=n[u+p];o[c]=d}return{outVals:o,outShape:a,outDtype:s}}function ame(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:s}=r;$e(a,"prod");let o=a.shape.length,l=k.parseAxisParam(i,a.shape),c=T.getAxesPermutation(l,o),u=l,d=a,p=[];c!=null&&(d=Gr({inputs:{x:a},backend:n,attrs:{perm:c}}),p.push(d),u=T.getInnerMostAxes(u.length,o));let h=n.data.get(d.dataId).values,{outVals:f,outShape:m,outDtype:g}=GW(d.shape,d.dtype,h,u),y=m;return s&&(y=T.expandShapeToKeepDim(m,l)),p.forEach(b=>n.disposeIntermediateTensorInfo(b)),n.makeTensorInfo(y,g,f)}var ime={kernelName:yc,backendName:"cpu",kernelFunc:ame};function sme(e,t,n){e.forEach((r,a)=>{if(r<0||r>=n){let i=k.indexToLoc(a,t.length,k.computeStrides(t)).join(",");throw new Error("indices[".concat(i,"] = ").concat(r," is not in [0, ").concat(n,")"))}})}function ome(e,t){for(let n=0;n<e.length;++n){let r=e[n],a=n===e.length-1?t:e[n+1].length;if(r.length===0)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>a)throw new Error("Ragged splits must not point past values");for(let i=1;i<r.length;++i)if(r[i-1]>r[i])throw new Error("Ragged splits must be sorted in ascending order")}}function lme(e,t,n,r){let a=[],i=0,s=t.length-1+n.length,o=new Array(s).fill(null).map(()=>[0]);ome(n,r);let l=1;for(let c=0;c<t.length-1;++c){l*=t[c];let u=t[c+1];for(let d=1;d<l+1;++d)o[c].push(d*u)}for(let c=0;c<e.length;++c){let u=e[c],d=e[c]+1;for(let p=0;p<n.length;++p){let h=n[p],f=p+t.length-1;if(f>=0){let m=o[f],g=m[m.length-1]-h[u];for(let y=u;y<d;++y)o[f].push(h[y+1]+g)}u=h[u],d=h[d]}d!==u&&(a.push([u,d]),i+=d-u)}return{outSplits:o,valueSlices:a,numValues:i}}function ume(e){let t=[];for(let n=0;n<e.length;++n){let r=e[n].length,a=k.getArrayFromDType("int32",r);t.push(a),e[n].forEach((i,s)=>a[s]=i)}return t}function qR(e,t){let n=e.slice(0,t);for(;n.length<t;)n.push(1);for(let r=t;r<e.length;r++)n[t-1]*=e[r];return n}function cme(e,t,n,r,a,i){let s=qR(t,2)[1],o=qR(i,2)[1],l=0;for(let c of n)for(let u=c[0];u<c[1];++u){for(let d=0;d<r;++d)a[l*o+d]=e[u*s+d];++l}}function dme(e,t,n,r,a){let i=t.slice();i[0]=a;let s=k.getArrayFromDType(n,k.sizeFromShape(i)),o=e.length,l=o===0?0:o/t[0];return cme(e,t,r,l,s,i),[s,i]}function qW(e,t,n,r,a,i,s,o){if(e.length===0)throw new Error("paramsNestedSplits must be non empty");if(t[0].length===0)throw new Error("Split tensors must not be scalars");let l=t[0][0]-1;if(sme(i,s,l),r.length===0)throw new Error("params.rank must be nonzero");let c=r[0],{outSplits:u,valueSlices:d,numValues:p}=lme(i,s,e,c),h=ume(u),f=dme(n,r,a,d,p);return[h,f[0],f[1]]}var KR=2147483647;function KW(e,t,n,r,a,i,s){if(t.length>1)throw new Error("starts must be a scalar or vector");if(a.length>1)throw new Error("limits must be a scalar or vector");if(s.length>1)throw new Error("deltas must be a scalar or vector");let o=t.length===0,l=a.length===0,c=s.length===0,u=[];o||u.push(t[0]),l||u.push(a[0]),c||u.push(s[0]);for(let g=1;g<u.length;++g)if(u[g]!==u[g-1])throw new Error("starts, limits, and deltas must have the same shape");let d=u.length===0?1:u[0],p=k.getArrayFromDType("int32",d+1);p[0]=0;for(let g=0;g<d;++g){let y=o?e[0]:e[g],b=l?r[0]:r[g],v=c?i[0]:i[g];if(v===0)throw new Error("Requires delta != 0");let x;if(v>0&&b<y||v<0&&b>y)x=0;else if(x=Math.ceil(Math.abs((b-y)/v)),x>KR)throw new Error("Requires ((limit - start) / delta) <= ".concat(KR));p[g+1]=p[g]+x}let h=p[d],f=k.getArrayFromDType(n,h),m=0;for(let g=0;g<d;++g){let y=p[g+1]-p[g],b=o?e[0]:e[g],v=c?i[0]:i[g];for(let x=0;x<y;++x)f[m++]=b,b+=v}return[p,f]}var Wa=T.RowPartitionType,_S=class{constructor(e,t,n,r,a,i,s,o,l,c){this.shape=e,this.shapeShape=t,this.values=n,this.valuesShape=r,this.valuesDType=a,this.defaultValue=i,this.defaultValueShape=s,this.rowPartitionValues=o,this.rowPartitionValuesShapes=l,this.rowPartitionTypes=T.getRowPartitionTypesHelper(c),this.raggedRank=T.getRaggedRank(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===Wa.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===Wa.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){let t=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case Wa.VALUE_ROWIDS:return _S.getMaxWidthValueRowID(t);case Wa.ROW_SPLITS:return _S.getMaxWidthRowSplit(t);default:throw new Error("Cannot handle partition type ".concat(Wa[this.getRowPartitionTypeByDimension(e-1)]))}}static getMaxWidthRowSplit(e){let t=e.length;if(t===0||t===1)return 0;let n=0;for(let r=0;r<t-1;++r){let a=e[r+1]-e[r];a>n&&(n=a)}return n}static getMaxWidthValueRowID(e){let t=e.length;if(t===0)return 0;let n=0,r=e[0],a=0;for(let i=1;i<t;++i){let s=e[i];s!==r&&(r=s,a=Math.max(i-n,a),n=i)}return Math.max(t-n,a)}tensorShapeFromTensor(e,t,n=!0){if(t.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return YR(e,n)}calculateOutputSize(e){let t=this.valuesShape,n=this.defaultValueShape;T.validateDefaultValueShape(n,t);let r=this.tensorShapeFromTensor(this.shape,this.shapeShape),a=T.combineRaggedTensorToTensorShapes(this.raggedRank,r,t);a[0]<0&&(a[0]=e);for(let i=1;i<=this.raggedRank;++i)a[i]<0&&(a[i]=this.getMaxWidth(i));return a}calculateFirstParentOutputIndex(e,t,n){let r=Math.min(e,n),a=[],i=0;for(let s=0;s<r;++s,i+=t)a.push(i);for(let s=r;s<e;++s)a.push(-1);return k.assert(a.length===e,()=>"Final length of result must be equal to firstDimension."),a}calculateOutputIndexRowSplit(e,t,n,r){let a=e.length,i=[];for(let s=0;s<a-1;++s){let o=e[s+1]-e[s],l=Math.min(r,o),c=t[s];c===-1&&(l=0);for(let u=0;u<l;++u)i.push(c),c+=n;for(let u=0;u<o-l;++u)i.push(-1)}if(a>0&&i.length!==e[a-1])throw new Error("Invalid row split size.");return i}calculateOutputIndexValueRowID(e,t,n,r){let a=e.length,i=[];if(a===0)return[];let s=0,o=e[0];if(o>=t.length)throw new Error("Got currentValueRowId=".concat(o,", which is not less than ").concat(t.length));let l=t[o];i.push(l);for(let c=1;c<a;++c){let u=e[c];if(u===o)l>=0&&(++s,s<r?l+=n:l=-1);else{if(s=0,o=u,u>=t.length)throw new Error("Got nextValueRowId=".concat(u," which is not less than ").concat(t.length));l=t[u]}i.push(l)}if(i.length!==e.length)throw new Error("Invalid row ids.");return i}calculateOutputIndex(e,t,n,r){let a=this.getRowPartitionTensor(e),i=this.getRowPartitionTypeByDimension(e);switch(i){case Wa.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(a,t,n,r);case Wa.ROW_SPLITS:if(a.length-1>t.length)throw new Error("Row partition size is greater than output size: ".concat(a.length-1," > ").concat(t.length));return this.calculateOutputIndexRowSplit(a,t,n,r);default:throw new Error("Unsupported partition type: ".concat(Wa[i]))}}getFirstDimensionSize(){let e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");let t=this.rowPartitionTypes[0];switch(t){case Wa.FIRST_DIM_SIZE:return e[0];case Wa.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case Wa.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error("Cannot handle type ".concat(Wa[t]))}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");let e=this.getFirstDimensionSize(),t=this.calculateOutputSize(e),n=new Array(this.raggedRank+1);n[n.length-1]=1;for(let i=n.length-2;i>=0;--i)n[i]=n[i+1]*t[i+1];let r=YR(t,!1),a=k.getArrayFromDType(this.valuesDType,k.sizeFromShape(r));if(n[0]*t[0]>0){let i=this.calculateFirstParentOutputIndex(e,n[0],t[0]);for(let s=1;s<=this.raggedRank;++s)i=this.calculateOutputIndex(s-1,i,n[s],t[s]);this.setOutput(this.raggedRank,i,a,r)}return[r,a]}setOutput(e,t,n,r){if(n.length===0)return;let a=this.values,i=n,s=r.slice();s=s.slice(e+1);let o=k.sizeFromShape(s),l=t.length,c=this.defaultValue;if(c.length!==o&&c.length!==1){let h=this.defaultValueShape;K(()=>{let f=q(c,h);c=Ml(f,s).dataSync()})}let u=0,d=0,p=0;for(let h=0;h<=l;++h){let f=h<l?t[h]:-1;if(f===p){++p;continue}if(d<p){let m=a.subarray(u*o),g=i.subarray(d*o),y=(p-d)*o;XR(g,m,y)}if(h>=l){let m=n.length;f=Math.floor(m/o)}if(f>p)if(this.defaultValue.length===1)i.subarray(p*o,f*o).fill(this.defaultValue[0]),p=f;else for(;f>p;){let m=i.slice(p*o);XR(m,c,o),++p}f<0?(u=h+1,d=p):(u=h,d=p,p=d+1)}}};function XR(e,t,n){for(let r=0;r<n;r++)e[r]=t[r]}function YR(e,t){let n=[];for(let r of e){if(r<0){if(!t)throw new Error("Dimension ".concat(r," must be >= 0"));if(r<-1)throw new Error("Dimension ".concat(r," must be >= -1"));r=-1}n.push(r)}return n}function XW(e,t,n,r,a,i,s,o,l,c){return new _S(e,t,n,r,a,i,s,o,l,c).compute()}function X2(e,t,n,r){let a=e===t,i=e<t&&n<0,s=t<e&&n>1;if(a||i||s)return k.makeZerosTypedArray(0,r);let o=Math.abs(Math.ceil((t-e)/n)),l=k.makeZerosTypedArray(o,r);t<e&&n===1&&(n=-1),l[0]=e;for(let c=1;c<l.length;c++)l[c]=l[c-1]+n;return l}var YW=ds(e=>1/Math.sqrt(e)),pme=tl($c,YW),hme={kernelName:$c,backendName:"cpu",kernelFunc:pme};function Al(e,t,n,r,a,i,s,o,l,c){let u=[r/a,a],d=e.values,p=t.values;if(r===0)return Ze(n,t.dtype);let h=l instanceof hn?l:Ze(u,t.dtype);typeof l=="string"||typeof l=="number"?h.values.fill(l):typeof l=="boolean"&&h.values.fill(+l);for(let f=0;f<i;f++){let m=[],g=0;for(let y=0;y<s;y++){let b=d[f*s+y];m.push(b),g+=b*o[y]}if(g<0||g>=r/a)throw new Error("Invalid indices: ".concat(m," does not index into ").concat(n));for(let y=0;y<a;y++)c?h.values[g*a+y]+=p[f*a+y]:h.values[g*a+y]=t.rank===0?p[0]:p[f*a+y]}return h}var fme=ds(e=>1/(1+Math.exp(-e))),ZW=mt(_c,e=>1/(1+Math.exp(-e))),mme={kernelName:_c,backendName:"cpu",kernelFunc:ZW};function zv(e,t,n,r,a){let i=In.isSliceContinous(r,t,n),s=k.sizeFromShape(n),o=k.computeStrides(r);if(i){let d=In.computeFlatOffset(t,o);return a==="string"?e.slice(d,d+s):e.subarray(d,d+s)}let l=a==="string"?T.fromUint8ToStringArray(e):e,c=Ze(r,a,l),u=Ze(n,a);for(let d=0;d<u.size;++d){let p=u.indexToLoc(d),h=p.map((f,m)=>f+t[m]);u.set(c.get(...h),...p)}return a==="string"?T.fromStringArrayToUint8(u.values):u.values}function cu(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{begin:i,size:s}=r;$e(a,"slice");let[o,l]=In.parseSliceParams(a,i,s);In.assertParamsValid(a,o,l);let c=n.data.get(a.dataId).values,u=zv(c,o,l,a.shape,a.dtype);return n.makeTensorInfo(l,a.dtype,u)}var gme={kernelName:Sh,backendName:"cpu",kernelFunc:cu};function QW(e,t,n,r,a,i,s){let o=t[0],l=i[0],c=new Array(l),u=new Array(o),d=t[1];if(l===0){if(o!==0)throw new Error(T.getSparseFillEmptyRowsIndicesDenseShapeMismatch(o));let g=k.getArrayFromDType(n,0),y=k.getArrayFromDType(a,0);return[g,[0,d],y,c,u]}let p=!0,h=0,f=new Array(l).fill(0);for(let g=0;g<o;++g){let y=e[g*d];if(y<0)throw new Error(T.getSparseFillEmptyRowsNegativeIndexErrorMessage(g,y));if(y>=l)throw new Error(T.getSparseFillEmptyRowsOutOfRangeIndexErrorMessage(g,y,l));++f[y],p=p&&y>=h,h=y}let m=!0;for(let g=0;g<l;++g){let y=f[g]===0;c[g]=y,m=m&&!y,f[g]=Math.max(f[g],1),g>0&&(f[g]+=f[g-1])}if(m&&p){let g=e,y=r;for(let b=0;b<o;++b)u[b]=b;return[g,[o,d],y,c,u]}else{let g=f[l-1],y=k.getArrayFromDType(n,g*d),b=k.getArrayFromDType(a,g),v=new Array(l).fill(0);for(let x=0;x<o;++x){let w=e[x*d],$=v[w],C=(w===0?0:f[w-1])+$;v[w]++;for(let E=0;E<d;++E)y[C*d+E]=e[x*d+E];b[C]=r[x],u[x]=C}for(let x=0;x<l;++x)if(v[x]===0){let w=x===0?0:f[x-1];y[w*d+0]=x;for(let $=1;$<d;++$)y[w*d+$]=0;b[w]=s}return[y,[g,d],b,c,u]}}function JW(e,t,n,r,a){let i=k.sizeFromShape(r),s=t[0],o=a.length,l=[],c=1,u=-1;for(let m=0;m<o;++m){let g=a[m];if(g===-1){if(u!==-1)throw new Error(T.getSparseReshapeMultipleNegativeOneOutputDimErrorMessage(u,m));u=m,l.push(1)}else{if(g<0)throw new Error(T.getSparseReshapeNegativeOutputDimErrorMessage(m,g));c*=g,l.push(g)}}if(u!==-1){if(c<=0)throw new Error(T.getSparseReshapeEmptyTensorZeroOutputDimErrorMessage());let m=Math.trunc(i/c);if(c*m!==i)throw new Error(T.getSparseReshapeInputOutputMultipleErrorMessage(r,l));l[u]=m}if(k.sizeFromShape(l)!==i)throw new Error(T.getSparseReshapeInputOutputMismatchErrorMessage(r,l));let d=r.length,p=[];if(d>0){p[d-1]=1;for(let m=d-2;m>=0;--m)p[m]=p[m+1]*r[m+1]}let h=[];if(o>0){h[o-1]=1;for(let m=o-2;m>=0;--m)h[m]=h[m+1]*l[m+1]}let f=k.getArrayFromDType(n,s*o);for(let m=0;m<s;++m){let g=0;for(let y=0;y<d;++y)g+=e[m*d+y]*p[y];for(let y=0;y<o;++y)f[m*o+y]=Math.trunc(g/h[y]),g%=h[y]}return[f,[s,o],l]}function Y2(e,t,n,r,a,i=!1,s=0){let o=r.length,l=[t[0],e.length/t[0]],c=l[1],u=o>0?a[o-1]+1:0;if(u<0)throw new Error(T.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let d=t.slice();d[0]=u;let p=d.reduce((b,v)=>b*v,1),h=k.getArrayFromDType(n,p);if(o===0)return u>0&&h.fill(s),[h,d];if(u<=0)throw new Error(T.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let f=0,m=1,g=0,y=a[f];for(;;){let b=0;if(m<o){if(b=a[m],y===b){++m;continue}if(y>=b)throw new Error(T.getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage())}if(y<0||y>=u)throw new Error(T.getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage(y,u));y>g&&h.fill(s,g*c,y*c);for(let v=f;v<m;++v){let x=r[v];if(x<0||x>=l[0])throw new Error(T.getSparseSegmentReductionIndicesOutOfRangeErrorMessage(v,r[v],l[0]));for(let w=0;w<c;w++)h[y*c+w]+=e[x*c+w]}if(i)for(let v=0;v<c;v++)h[y*c+v]/=m-f;if(f=m,++m,g=y+1,y=b,m>o)break}return g<u&&h.fill(s,g*c,u*c),[h,d]}var yme=ds(e=>Math.sqrt(e)),bme=mt(Rc,e=>Math.sqrt(e)),vme={kernelName:Rc,backendName:"cpu",kernelFunc:bme},e4=sn((e,t)=>{let n=e-t;return n*n}),xme=En(Mc,e4),wme={kernelName:Mc,backendName:"cpu",kernelFunc:xme},t4=ds((e,t)=>{let{pattern:n,replaceGlobal:r,rewrite:a}=t;return e.replace(new RegExp(n,r?"g":""),a)}),kme=tl(yg,t4),Sme={kernelName:yg,backendName:"cpu",kernelFunc:kme};function n4(e,t,n,r){let a=Ze(e,t.dtype);for(let i=0;i<a.size;i++){let s=a.indexToLoc(i),o=new Array(s.length);for(let l=0;l<o.length;l++)o[l]=s[l]*n[l]+r[l];a.set(t.get(...o),...s)}return a}var Ime=class{constructor(e,t,n,r,a,i){this.separator=k.encodeString(e),this.nGramWidths=t,this.leftPad=k.encodeString(n),this.rightPad=k.encodeString(r),this.padWidth=a,this.preserveShort=i}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){let n=this.getPadWidth(t);return Math.max(0,e+2*n-t+1)}createNGrams(e,t,n,r,a,i){for(let s=0;s<a;++s){let o=this.getPadWidth(i),l=Math.max(0,o-s),c=Math.max(0,o-(a-(s+1))),u=i-(l+c),d=t+(l>0?0:s-o),p=0;p+=l*this.leftPad.length;for(let y=0;y<u;++y)p+=e[d+y].length;p+=c*this.rightPad.length;let h=l+c+u-1;p+=h*this.separator.length,n[r+s]=new Uint8Array(p);let f=n[r+s],m=0,g=y=>y.forEach(b=>f[m++]=b);for(let y=0;y<l;++y)g(this.leftPad),g(this.separator);for(let y=0;y<u-1;++y)g(e[d+y]),g(this.separator);if(u>0){g(e[d+u-1]);for(let y=0;y<c;++y)g(this.separator),g(this.rightPad)}else{for(let y=0;y<c-1;++y)g(this.rightPad),g(this.separator);g(this.rightPad)}}}compute(e,t){let n=e.length,r=t.length;if(r>0){let o=t[0];if(o!==0)throw new Error("First split value must be 0, got ".concat(o));for(let l=1;l<r;++l){let c=t[l]>=o;if(c=c&&t[l]<=n,!c)throw new Error("Invalid split value ".concat(t[l],", must be in [").concat(o,", ").concat(n,"]"));o=t[l]}if(o!==n)throw new Error("Last split value must be data size. Expected ".concat(n,", got ").concat(o))}let a=r-1,i=k.getArrayFromDType("int32",r);if(n===0||r===0){let o=new Array(n);for(let l=0;l<=a;++l)i[l]=0;return[o,i]}i[0]=0;for(let o=1;o<=a;++o){let l=t[o]-t[o-1],c=0;this.nGramWidths.forEach(u=>{c+=this.getNumNGrams(l,u)}),this.preserveShort&&l>0&&c===0&&(c=1),i[o]=i[o-1]+c}let s=new Array(i[a]);for(let o=0;o<a;++o){let l=t[o],c=i[o];if(this.nGramWidths.forEach(u=>{let d=t[o+1]-t[o],p=this.getNumNGrams(d,u);this.createNGrams(e,l,s,c,p,u),c+=p}),this.preserveShort&&c===i[o]){let u=t[o+1]-t[o];if(u===0)continue;let d=u+2*this.padWidth,p=1;this.createNGrams(e,l,s,c,p,d)}}return[s,i]}};function Z2(e,t,n,r,a,i,s,o){return new Ime(n,r,a,i,s,o).compute(e,t)}function $me(e,t,n,r){if(!e.length)return;if(t.length===0){for(let i=0;i<e.length;++i)r.push(e.subarray(i,i+1));return}if(t.length===1){let i=t[0],s=e.indexOf(i);for(;s!==-1;){let o=e.subarray(0,s);(!n||o.length!==0)&&r.push(o),e=e.subarray(s+1),s=e.indexOf(i)}(!n||e.length!==0)&&r.push(e);return}let a=0;for(let i=0;i<e.length+1;i++)if(i===e.length||t.indexOf(e[i])!==-1){let s=e.subarray(a,i);(!n||s.length!==0)&&r.push(s),a=i+1}}function Q2(e,t,n){let r=e.length,a=[],i=0,s=0,o=new Array(r);for(let p=0;p<r;++p){let h=a.length;$me(e[p],t,n,a);let f=a.length-h;o[p]=f,i+=f,s=Math.max(s,f)}let l=k.getArrayFromDType("int32",i*2),c=new Array(i),u=[r,s],d=0;for(let p=0;p<r;++p)for(let h=0;h<o[p];++h)l[d*2]=p,l[d*2+1]=h,c[d]=a[d],++d;return[l,c,u]}function J2(e,t){let n=k.getArrayFromDType("int32",e.length);for(let r=0;r<e.length;++r)n[r]=k.fingerPrint64(e[r]).modulo(t).getLowBitsUnsigned();return n}var r4=sn((e,t)=>e-t),Cme=H2((e,t,n,r)=>({real:e-n,imag:t-r})),eT=En(Oc,r4,Cme),Eme={kernelName:Oc,backendName:"cpu",kernelFunc:eT};function a4(e,t){let n=new Array(e.rank);for(let a=0;a<n.length;a++)n[a]=e.shape[a]*t[a];let r=Ze(n,e.dtype);for(let a=0;a<r.values.length;++a){let i=r.indexToLoc(a),s=new Array(e.rank);for(let l=0;l<s.length;l++)s[l]=i[l]%e.shape[l];let o=e.locToIndex(s);r.values[a]=e.values[o]}return r}var Ef=(e,t)=>{let n=t.value-e.value;return n===0?e.index-t.index:n};function i4(e,t,n=0,r=e.length-1){for(;r>n;){if(r-n>600){let o=r-n+1,l=t-n+1,c=Math.log(o),u=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*u*(o-u)/o)*Math.sign(l-o/2),p=Math.max(n,Math.floor(t-l*u/o+d)),h=Math.min(r,Math.floor(t+(o-l)*u/o+d));i4(e,t,p,h)}let a=e[t],i=n,s=r;for(k.swap(e,n,t),Ef(e[r],a)>0&&k.swap(e,n,r);i<s;){for(k.swap(e,i,s),i++,s--;Ef(e[i],a)<0;)i=i+1;for(;Ef(e[s],a)>0;)s=s-1}Ef(e[n],a)===0?k.swap(e,n,s):(s=s+1,k.swap(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}}function s4(e,t,n,r,a){let i=t[t.length-1],[s,o]=[e.length/i,i],l=k.getTypedArrayFromDType(n,s*r),c=k.getTypedArrayFromDType("int32",s*r);for(let d=0;d<s;d++){let p=d*o,h=e.subarray(p,p+o),f=new Array(h.length);h.forEach((b,v)=>f[v]={value:b,index:v}),r<f.length&&(i4(f,r),f=f.slice(0,r)),a&&f.sort(Ef);let m=d*r,g=l.subarray(m,m+r),y=c.subarray(m,m+r);for(let b=0;b<r;b++)g[b]=f[b].value,y[b]=f[b].index}let u=t.slice();return u[u.length-1]=r,[Ze(u,n,l),Ze(u,"int32",c)]}function tT(e,t,n,r){let a=k.parseAxisParam(t,n)[0],i=[1,n[0],1];for(let f=0;f<a;f++)i[0]*=n[f];i[1]=n[a];for(let f=a+1;f<n.length;f++)i[2]*=n[f];let s=new Map,o=new Int32Array(n[a]),l=new hn(i,r,e),c=[],u=i[0]===1&&i[2]===1;for(let f=0;f<n[a];f++){let m;if(u)m=e[f].toString();else{let y=[];for(let b=0;b<i[0];b++)for(let v=0;v<i[2];v++)y.push(l.get(b,f,v));m=y.join(",")}let g=s.get(m);if(g!=null)o[f]=g;else{let y=s.size;s.set(m,y),o[f]=y,c.push(f)}}let d=i.slice();d[1]=s.size;let p=new hn(d,r);c.forEach((f,m)=>{for(let g=0;g<i[0];g++)for(let y=0;y<i[2];y++)p.set(l.get(g,f,y),g,m,y)});let h=n.slice();return h[a]=d[1],{outputValues:p.values,outputShape:h,indices:o}}var Tme="4.7.0";ux("cpu",()=>new lw,1);var o4=mt(Uu,e=>e>=0?e:Math.exp(e)-1),Nme={kernelName:Uu,backendName:"cpu",kernelFunc:o4};function l4(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{alpha:i}=r;$e([a],"leakyRelu");let s=k.sizeFromShape(a.shape),o=n.data.get(a.dataId).values,l=k.getTypedArrayFromDType("float32",s);for(let c=0;c<o.length;c++)l[c]=o[c]<0?i*o[c]:o[c];return n.makeTensorInfo(a.shape,"float32",l)}var _me={kernelName:ec,backendName:"cpu",kernelFunc:l4},Ame=sn((e,t)=>e<0?t*e:e);function u4(e){let{inputs:t,backend:n}=e,{x:r,alpha:a}=t;$e([r,a],"prelu");let i=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,[o,l]=Ame(r.shape,a.shape,i,s,"float32");return n.makeTensorInfo(l,"float32",o)}var Rme={kernelName:gc,backendName:"cpu",kernelFunc:u4},c4=mt(vc,e=>Math.max(0,e)),Dme={kernelName:vc,backendName:"cpu",kernelFunc:c4},d4=mt(kc,e=>Math.min(Math.max(0,e),6)),Fme={kernelName:kc,backendName:"cpu",kernelFunc:d4};function Bv(e,t,n,r,a){if(n==="linear")return is({inputs:{x:t},backend:e});if(n==="relu")return c4({inputs:{x:t},backend:e});if(n==="elu")return o4({inputs:{x:t},backend:e});if(n==="relu6")return d4({inputs:{x:t},backend:e});if(n==="prelu")return u4({inputs:{x:t,alpha:r},backend:e});if(n==="leakyrelu")return l4({inputs:{x:t},backend:e,attrs:{alpha:a}});if(n==="sigmoid")return ZW({inputs:{x:t},backend:e});throw new Error("Activation ".concat(n," has not been implemented for the CPU backend."))}function At(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{shape:i}=r,s=k.sizeFromShape(a.shape),o=k.inferFromImplicitShape(i,s),l=k.sizeFromShape(o);k.assert(s===l,()=>"The new shape (".concat(o,") has ").concat(l," elements and the old shape (").concat(a.shape,") has ").concat(s," elements. The new shape and old shape must have the same number of elements.")),n.incRef(a.dataId);let c=n.data.get(a.dataId);if(c.complexTensorInfos!=null){let u=c.complexTensorInfos.real,d=c.complexTensorInfos.imag;u.shape=o,d.shape=o}return{dataId:a.dataId,shape:o,dtype:a.dtype}}var Mme={kernelName:gh,backendName:"cpu",kernelFunc:At};function p4(e){let{inputs:t,backend:n,attrs:r}=e,{a,b:i}=t,{transposeA:s,transposeB:o}=r;$e([a,i],"matMul");let l=a.shape.length,c=i.shape.length,u=s?a.shape[l-2]:a.shape[l-1],d=o?i.shape[c-1]:i.shape[c-2],p=s?a.shape[l-1]:a.shape[l-2],h=o?i.shape[c-2]:i.shape[c-1],f=a.shape.slice(0,-2),m=i.shape.slice(0,-2),g=k.sizeFromShape(f),y=k.sizeFromShape(m),b=Fh.assertAndGetBroadcastShape(a.shape.slice(0,-2),i.shape.slice(0,-2)).concat([p,h]);k.assert(u===d,()=>"Error in matMul: inner shapes (".concat(u,") and (").concat(d,") of Tensors with shapes ").concat(a.shape," and ").concat(i.shape," and transposeA=").concat(s," and transposeB=").concat(o," must match."));let v=s?[g,u,p]:[g,p,u],x=o?[y,h,d]:[y,d,h],w=At({inputs:{x:a},backend:n,attrs:{shape:v}}),$=At({inputs:{x:i},backend:n,attrs:{shape:x}}),C=s?w.shape[1]:w.shape[2],E=s?w.shape[2]:w.shape[1],_=o?$.shape[1]:$.shape[2],R=Math.max(g,y),N=n.data.get(w.dataId).values,I=n.data.get($.dataId).values,O=k.computeStrides(w.shape),P=k.computeStrides($.shape),[L,U,D]=s?[O[0],1,O[1]]:[O[0],O[1],1],[F,z,B]=o?[1,P[1],P[0]]:[P[1],1,P[0]],j=E*_,Y=Ze([R,E,_],w.dtype),Q=Y.values,ae=n.blockSize;for(let se=0;se<R;se++){let fe=se%g,me=se%y;for(let he=0;he<E;he+=ae){let Te=Math.min(he+ae,E);for(let Fe=0;Fe<_;Fe+=ae){let Ve=Math.min(Fe+ae,_);for(let Pe=0;Pe<C;Pe+=ae){let pt=Math.min(Pe+ae,C);for(let Je=he;Je<Te;Je++)for(let tt=Fe;tt<Ve;tt++){let Le=0;for(let st=Pe;st<pt;st++){let gt=N[fe*L+Je*U+st*D],pr=I[st*F+tt*z+me*B];Le+=gt*pr}Q[se*j+(Je*_+tt)]+=Le}}}}}return n.disposeIntermediateTensorInfo(w),n.disposeIntermediateTensorInfo($),n.makeTensorInfo(b,Y.dtype,Y.values)}var Ome={kernelName:_u,backendName:"cpu",kernelFunc:p4};function Lme(e){let{inputs:t,backend:n,attrs:r}=e,{a,b:i,bias:s,preluActivationWeights:o}=t,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:d}=r,p,h,f,m=[];p=p4({inputs:{a,b:i},attrs:{transposeA:l,transposeB:c},backend:n}),s&&(h=vp({inputs:{a:p,b:s},backend:n}),m.push(p),p=h),u&&(f=Bv(n,p,u,o,d),m.push(p),p=f);for(let g of m)n.disposeIntermediateTensorInfo(g);return p}var Pme={kernelName:Yl,backendName:"cpu",kernelFunc:Lme},zme=mt(wu,e=>Math.acos(e)),Bme={kernelName:wu,backendName:"cpu",kernelFunc:zme},Wme=mt(ku,e=>Math.acosh(e)),Ume={kernelName:ku,backendName:"cpu",kernelFunc:Wme};function Vme(e){let{inputs:t,backend:n}=e,r=t;$e(t,"addN");let a=r.map(o=>n.data.get(o.dataId).values),i=Ze(r[0].shape,r[0].dtype),s=i.values;for(let o=0;o<r.length;o++){let l=a[o];for(let c=0;c<s.length;c++)s[c]+=l[c]}return n.makeTensorInfo(i.shape,i.dtype,i.values)}var Hme={kernelName:Su,backendName:"cpu",kernelFunc:Vme};function jme(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:s}=r;$e(a,"all");let o=k.parseAxisParam(i,a.shape),l=o,c=T.getAxesPermutation(l,a.shape.length),u=a;c!=null&&(u=Gr({inputs:{x:a},backend:n,attrs:{perm:c}}),l=T.getInnerMostAxes(l.length,a.shape.length)),T.assertAxesAreInnerMostDims("all",l,u.shape.length);let[d,p]=T.computeOutAndReduceShapes(u.shape,l),h=k.sizeFromShape(p),f=k.makeZerosTypedArray(k.sizeFromShape(d),u.dtype),m=n.data.get(u.dataId).values;for(let y=0;y<f.length;++y){let b=y*h,v=m[b];for(let x=0;x<h;++x){let w=m[b+x];v=v&&w}f[y]=v}c!=null&&n.disposeIntermediateTensorInfo(u);let g=n.makeTensorInfo(d,u.dtype,f);if(s){let y=T.expandShapeToKeepDim(d,o),b=At({inputs:{x:g},backend:n,attrs:{shape:y}});return n.disposeIntermediateTensorInfo(g),b}return g}var Gme={kernelName:Dp,backendName:"cpu",kernelFunc:jme};function qme(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:s}=r;$e(a,"any");let o=k.parseAxisParam(i,a.shape),l=o,c=T.getAxesPermutation(l,a.shape.length),u=a;c!=null&&(u=Gr({inputs:{x:a},backend:n,attrs:{perm:c}}),l=T.getInnerMostAxes(l.length,a.shape.length)),T.assertAxesAreInnerMostDims("any",l,u.shape.length);let[d,p]=T.computeOutAndReduceShapes(u.shape,l),h=k.sizeFromShape(p),f=k.makeZerosTypedArray(k.sizeFromShape(d),u.dtype),m=n.data.get(u.dataId).values;for(let y=0;y<f.length;++y){let b=y*h,v=m[b];for(let x=0;x<h;++x){let w=m[b+x];v=v||w}f[y]=v}c!=null&&n.disposeIntermediateTensorInfo(u);let g=n.makeTensorInfo(d,u.dtype,f);if(s){let y=T.expandShapeToKeepDim(d,o),b=At({inputs:{x:g},backend:n,attrs:{shape:y}});return n.disposeIntermediateTensorInfo(g),b}return g}var Kme={kernelName:Fp,backendName:"cpu",kernelFunc:qme};function Xme(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i}=r;$e(a,"argMax");let s=k.parseAxisParam(i,a.shape),o=T.getAxesPermutation(s,a.shape.length),l=a,c=[];o!=null&&(l=Gr({inputs:{x:a},backend:n,attrs:{perm:o}}),c.push(l),s=T.getInnerMostAxes(s.length,l.shape.length)),s=[s[0]],T.assertAxesAreInnerMostDims("argMax",s,l.shape.length);let[u,d]=T.computeOutAndReduceShapes(l.shape,s),p=k.sizeFromShape(u),h=k.makeZerosTypedArray(p,"int32"),f=k.sizeFromShape(d),m=n.data.get(l.dataId).values;for(let g=0;g<h.length;++g){let y=g*f,b=m[y],v=0;for(let x=0;x<f;++x){let w=m[y+x];w>b&&(b=w,v=x)}h[g]=v}return c.forEach(g=>n.disposeIntermediateTensorInfo(g)),n.makeTensorInfo(u,"int32",h)}var Yme={kernelName:Mp,backendName:"cpu",kernelFunc:Xme};function Zme(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i}=r;$e(a,"argMin");let s=k.parseAxisParam(i,a.shape),o=T.getAxesPermutation(s,a.shape.length),l=a,c=[];o!=null&&(l=Gr({inputs:{x:a},backend:n,attrs:{perm:o}}),c.push(l),s=T.getInnerMostAxes(s.length,l.shape.length)),s=[s[0]],T.assertAxesAreInnerMostDims("argMin",s,l.shape.length);let[u,d]=T.computeOutAndReduceShapes(l.shape,s),p=k.sizeFromShape(u),h=k.makeZerosTypedArray(p,"int32"),f=k.sizeFromShape(d),m=n.data.get(l.dataId).values;for(let g=0;g<h.length;++g){let y=g*f,b=m[y],v=0;for(let x=0;x<f;++x){let w=m[y+x];w<b&&(b=w,v=x)}h[g]=v}return c.forEach(g=>n.disposeIntermediateTensorInfo(g)),n.makeTensorInfo(u,"int32",h)}var Qme={kernelName:Op,backendName:"cpu",kernelFunc:Zme},Jme=mt(Iu,e=>Math.asin(e)),ege={kernelName:Iu,backendName:"cpu",kernelFunc:Jme},tge=mt($u,e=>Math.asinh(e)),nge={kernelName:$u,backendName:"cpu",kernelFunc:tge},rge=mt(Cu,e=>Math.atan(e)),age={kernelName:Cu,backendName:"cpu",kernelFunc:rge},ige=sn((e,t)=>Math.atan2(e,t)),sge=En(Tu,ige),oge={kernelName:Tu,backendName:"cpu",kernelFunc:sge},lge=mt(Eu,e=>Math.atanh(e)),uge={kernelName:Eu,backendName:"cpu",kernelFunc:lge};function nT(e,t,n,r,a,i){let s=a.strideHeight,o=a.strideWidth,l=a.dilationHeight,c=a.dilationWidth,u=a.effectiveFilterHeight,d=a.effectiveFilterWidth,p=a.padInfo.top,h=a.padInfo.left,f=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=Ze(a.outShape,n),g=m.values,y=a.outShape[1]*a.outShape[2]*a.outShape[3],b=a.outShape[2]*a.outShape[3],v=a.outShape[3];for(let x=0;x<a.batchSize;++x){let w=x*y,$=x*r[0];for(let C=0;C<a.inChannels;++C)for(let E=0;E<a.outHeight;++E){let _=E*s-p,R=Math.max(0,_),N=Math.min(a.inHeight,u+_),I=w+E*b;for(let O=0;O<a.outWidth;++O){let P=O*o-h,L=Math.max(0,P),U=Math.min(a.inWidth,d+P),D=f,F=0,z=0;for(let j=R;j<N;j+=l){let Y=$+j*r[1];for(let Q=L;Q<U;Q+=c){let ae=Y+Q*r[2],se=e[ae+C];i==="max"&&se>D?D=se:i==="avg"&&(F+=se,z++)}if(isNaN(D))break}let B=I+O*v+C;g[B]=i==="avg"?F/z:D}}}return m}function h4(e,t,n,r,a=!1,i=!1){let s=Ze(r.outShape,"int32"),o=r.strideHeight,l=r.strideWidth,c=r.dilationHeight,u=r.dilationWidth,d=r.effectiveFilterHeight,p=r.effectiveFilterWidth,h=r.padInfo.top,f=r.padInfo.left,m=Ze(t,n,e);for(let g=0;g<r.batchSize;++g)for(let y=0;y<r.inChannels;++y)for(let b=0;b<r.outHeight;++b){let v=b*o-h,x=v;for(;x<0;)x+=c;let w=Math.min(r.inHeight,d+v);for(let $=0;$<r.outWidth;++$){let C=$*l-f,E=C;for(;E<0;)E+=u;let _=Math.min(r.inWidth,p+C),R=Number.NEGATIVE_INFINITY,N=-1;for(let I=x;I<w;I+=c){let O=I-v;for(let P=E;P<_;P+=u){let L=P-C,U=m.get(g,I,P,y);U>R&&(R=U,a?N=i?((g*r.inHeight+I)*r.inWidth+P)*r.inChannels+y:(I*r.inWidth+P)*r.inChannels+y:N=O*p+L)}}s.set(N,g,b,$,y)}}return s}function f4(e,t,n,r,a,i){let s=a.strideDepth,o=a.strideHeight,l=a.strideWidth,c=a.dilationDepth,u=a.dilationHeight,d=a.dilationWidth,p=a.effectiveFilterDepth,h=a.effectiveFilterHeight,f=a.effectiveFilterWidth,m=a.padInfo.front,g=a.padInfo.top,y=a.padInfo.left,b=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=Ze(a.outShape,n),x=v.values,w=a.outShape[1]*a.outShape[2]*a.outShape[3]*a.outShape[4],$=a.outShape[2]*a.outShape[3]*a.outShape[4],C=a.outShape[3]*a.outShape[4],E=a.outShape[4];for(let _=0;_<a.batchSize;++_){let R=_*w,N=_*r[0];for(let I=0;I<a.inChannels;++I)for(let O=0;O<a.outDepth;++O){let P=O*s-m,L=P;for(;L<0;)L+=c;let U=Math.min(a.inDepth,p+P),D=R+O*$;for(let F=0;F<a.outHeight;++F){let z=F*o-g,B=z;for(;B<0;)B+=u;let j=Math.min(a.inHeight,h+z),Y=D+F*C;for(let Q=0;Q<a.outWidth;++Q){let ae=Q*l-y,se=ae;for(;se<0;)se+=d;let fe=Math.min(a.inWidth,f+ae),me=Y+Q*E,he=b,Te=0,Fe=0;for(let Pe=L;Pe<U;Pe+=c){let pt=N+Pe*r[1];for(let Je=B;Je<j;Je+=u){let tt=pt+Je*r[2];for(let Le=se;Le<fe;Le+=d){let st=tt+Le*r[3],gt=e[st+I];if(i==="max"&&gt>he?he=gt:i==="avg"&&(Te+=gt,Fe++),isNaN(he))break}if(isNaN(he))break}if(isNaN(he))break}let Ve=me+I;x[Ve]=i==="avg"?Te/Math.max(Fe,1):he}}}}return v}function cge(e,t){let n=Ze(t.outShape,"int32"),r=t.strideDepth,a=t.strideHeight,i=t.strideWidth,s=t.dilationDepth,o=t.dilationHeight,l=t.dilationWidth,c=t.effectiveFilterDepth,u=t.effectiveFilterHeight,d=t.effectiveFilterWidth,p=t.padInfo.front,h=t.padInfo.top,f=t.padInfo.left;for(let m=0;m<t.batchSize;++m)for(let g=0;g<t.inChannels;++g)for(let y=0;y<t.outDepth;++y){let b=y*r-p,v=b;for(;v<0;)v+=s;let x=Math.min(t.inDepth,c+b);for(let w=0;w<t.outHeight;++w){let $=w*a-h,C=$;for(;C<0;)C+=o;let E=Math.min(t.inHeight,u+$);for(let _=0;_<t.outWidth;++_){let R=_*i-f,N=R;for(;N<0;)N+=l;let I=Math.min(t.inWidth,d+R),O=Number.NEGATIVE_INFINITY,P=-1;for(let L=v;L<x;L+=s){let U=L-b;for(let D=C;D<E;D+=o){let F=D-$;for(let z=N;z<I;z+=l){let B=z-R,j=e.get(m,L,D,z,g);j>=O&&(O=j,P=U*u*d+F*u+B)}}}n.set(P,m,y,w,_,g)}}}return n}function dge(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t;$e(a,"avgPool");let{filterSize:i,strides:s,pad:o,dimRoundingMode:l}=r,c=1;k.assert(T.eitherStridesOrDilationsAreOne(s,c),()=>"Error in avgPool: Either strides or dilations must be 1. Got strides ".concat(s," and dilations '").concat(c,"'"));let u=T.computePool2DInfo(a.shape,i,s,c,o,l),d;if(u.filterWidth===1&&u.filterHeight===1&&k.arraysEqual(u.inShape,u.outShape))d=is({inputs:{x:a},backend:n});else{let p=n.data.get(a.dataId).values,h=k.computeStrides(a.shape),f=nT(p,a.shape,a.dtype,h,u,"avg");d=n.makeTensorInfo(u.outShape,a.dtype,f.values)}return d}var pge={kernelName:Nu,backendName:"cpu",kernelFunc:dge};function hge(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:i,strides:s,pad:o,dimRoundingMode:l,dataFormat:c}=r;$e(a,"avgPool3d");let u=T.computePool3DInfo(a.shape,i,s,1,o,l,c),d=n.data.get(a.dataId).values,p=f4(d,a.shape,a.dtype,k.computeStrides(a.shape),u,"avg");return n.makeTensorInfo(p.shape,"float32",p.values)}var fge={kernelName:Lp,backendName:"cpu",kernelFunc:hge};function mge(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,{filterSize:s,strides:o,pad:l,dimRoundingMode:c}=r;$e([a,i],"avgPool3DGrad");let u=T.computePool3DInfo(i.shape,s,o,1,l,c),d=u.strideDepth,p=u.strideHeight,h=u.strideWidth,f=u.filterDepth,m=u.filterHeight,g=u.filterWidth,y=u.dilationDepth,b=u.dilationHeight,v=u.dilationWidth,x=u.effectiveFilterDepth,w=u.effectiveFilterHeight,$=u.effectiveFilterWidth,C=x-1-u.padInfo.front,E=$-1-u.padInfo.left,_=w-1-u.padInfo.top,R=Ze(i.shape,"float32"),N=1/(f*m*g),I=n.bufferSync(a);for(let O=0;O<u.batchSize;++O)for(let P=0;P<u.inChannels;++P)for(let L=0;L<u.inDepth;++L)for(let U=0;U<u.inHeight;++U)for(let D=0;D<u.inWidth;++D){let F=L-C,z=U-_,B=D-E,j=0;for(let Y=0;Y<x;Y+=y){let Q=(F+Y)/d;if(!(Q<0||Q>=u.outDepth||Math.floor(Q)!==Q))for(let ae=0;ae<w;ae+=b){let se=(z+ae)/p;if(!(se<0||se>=u.outHeight||Math.floor(se)!==se))for(let fe=0;fe<$;fe+=v){let me=(B+fe)/h;if(me<0||me>=u.outWidth||Math.floor(me)!==me)continue;let he=I.get(O,Q,se,me,P);j+=he}}}R.set(j*N,O,L,U,D,P)}return n.makeTensorInfo(R.shape,R.dtype,R.values)}var gge={kernelName:rg,backendName:"cpu",kernelFunc:mge};function yge(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,s=i;$e([a,i],"avgPoolGrad");let{filterSize:o,strides:l,pad:c}=r,u=T.computePool2DInfo(s.shape,o,l,1,c),d=u.strideHeight,p=u.strideWidth,h=u.filterHeight,f=u.filterWidth,m=u.dilationHeight,g=u.dilationWidth,y=u.effectiveFilterHeight,b=u.effectiveFilterWidth,v=b-1-u.padInfo.left,x=y-1-u.padInfo.top,w=Ze(s.shape,"float32"),$=1/(h*f),C=n.data.get(a.dataId).values,E=Ze(a.shape,"float32",C);for(let _=0;_<u.batchSize;++_)for(let R=0;R<u.inChannels;++R)for(let N=0;N<u.inHeight;++N)for(let I=0;I<u.inWidth;++I){let O=N-x,P=I-v,L=0;for(let U=0;U<y;U+=m){let D=(O+U)/d;if(!(D<0||D>=u.outHeight||Math.floor(D)!==D))for(let F=0;F<b;F+=g){let z=(P+F)/p;if(z<0||z>=u.outWidth||Math.floor(z)!==z)continue;let B=E.get(_,D,z,R);L+=B}}w.set(L*$,_,N,I,R)}return n.makeTensorInfo(w.shape,w.dtype,w.values)}var bge={kernelName:ng,backendName:"cpu",kernelFunc:yge};function vge(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,scale:i,offset:s,mean:o,variance:l}=t;k.assert(o.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),k.assert(s==null||o.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),k.assert(i==null||o.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),$e([a,o,l,i,s],"batchNorm");let{varianceEpsilon:c}=r;c==null&&(c=.001);let u=n.data.get(a.dataId).values,d=n.data.get(o.dataId).values,p=n.data.get(l.dataId).values,h=i?n.data.get(i.dataId).values:new Float32Array([1]),f=s?n.data.get(s.dataId).values:new Float32Array([0]),m=new Float32Array(u.length),g=f.length,y=h.length,b=p.length,v=d.length,x=0,w=0,$=0,C=0;for(let E=0;E<u.length;++E)m[E]=f[x++]+(u[E]-d[w++])*h[$++]/Math.sqrt(p[C++]+c),x>=g&&(x=0),w>=v&&(w=0),$>=y&&($=0),C>=b&&(C=0);return n.makeTensorInfo(a.shape,a.dtype,m)}var xge={kernelName:Ku,backendName:"cpu",kernelFunc:vge};function wge(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:i,crops:s}=r;$e([a],"batchToSpaceND");let o=i.reduce((y,b)=>y*b),l=T.getReshaped(a.shape,i,o),c=T.getPermuted(l.length,i.length),u=T.getReshapedPermuted(a.shape,i,o),d=T.getSliceBeginCoords(s,i.length),p=T.getSliceSize(u,s,i.length),h=At({inputs:{x:a},backend:n,attrs:{shape:l}}),f=Gr({inputs:{x:h},backend:n,attrs:{perm:c}}),m=At({inputs:{x:f},backend:n,attrs:{shape:u}}),g=cu({inputs:{x:m},backend:n,attrs:{begin:d,size:p}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),g}var kge={kernelName:Pp,backendName:"cpu",kernelFunc:wge};function Sge(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,weights:i}=t,{size:s}=r,o=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,c=j2(o,l,i.dtype,i.shape,s);return n.makeTensorInfo([s],i.dtype,c)}var Ige={kernelName:zp,backendName:"cpu",kernelFunc:Sge};function $ge(e){let{inputs:t,backend:n}=e,{s0:r,s1:a}=t,i=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,o=T.assertAndGetBroadcastShape(Array.from(i),Array.from(s));return n.makeTensorInfo([o.length],"int32",Int32Array.from(o))}var Cge={kernelName:ag,backendName:"cpu",kernelFunc:$ge},Ege=mt(qo,(e,t)=>{let n=t;return e>n.clipValueMax?n.clipValueMax:e<n.clipValueMin?n.clipValueMin:e}),Tge={kernelName:qo,backendName:"cpu",kernelFunc:Ege},Nge=e=>{let{x:t}=e.inputs,n=e.backend,r=new Float32Array(k.sizeFromShape(t.shape)),a=n.data.get(t.dataId),i=a.complexTensorInfos.real,s=a.complexTensorInfos.imag,o=n.data.get(i.dataId).values,l=n.data.get(s.dataId).values;for(let c=0;c<o.length;c++){let u=o[c],d=l[c];r[c]=Math.hypot(u,d)}return n.makeOutput(r,t.shape,"float32")},_ge={kernelName:ig,backendName:"cpu",kernelFunc:Nge};function xp(e){let{inputs:t,backend:n}=e,{input:r}=t,a=n.data.get(r.dataId).complexTensorInfos.imag,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}var Age={kernelName:nx,backendName:"cpu",kernelFunc:xp};function wp(e){let{inputs:t,backend:n,attrs:r}=e,{axis:a}=r,i=k.parseAxisParam(a,t[0].shape)[0],s=t.map(m=>m.shape);T.assertParamsConsistent(s,i);let o=T.computeOutShape(t.map(m=>m.shape),i);if(k.sizeFromShape(o)===0)return n.makeTensorInfo(o,t[0].dtype,[]);let l=t.filter(m=>k.sizeFromShape(m.shape)>0);if(l.length===1)return is({inputs:{x:l[0]},backend:n});if(l[0].dtype==="complex64"){let m=l.map(x=>uu({inputs:{input:x},backend:n})),g=l.map(x=>xp({inputs:{input:x},backend:n})),y=wp({inputs:m,backend:n,attrs:{axis:i}}),b=wp({inputs:g,backend:n,attrs:{axis:i}}),v=ra({inputs:{real:y,imag:b},backend:n});return m.forEach(x=>n.disposeIntermediateTensorInfo(x)),g.forEach(x=>n.disposeIntermediateTensorInfo(x)),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(b),v}let c=l.map(m=>{let g=[-1,k.sizeFromShape(m.shape.slice(i))];return At({inputs:{x:m},backend:n,attrs:{shape:g}})}),u=c.map(m=>({vals:n.data.get(m.dataId).values,shape:m.shape}));o=T.computeOutShape(c.map(m=>m.shape),1);let d=c[0].shape[0]===1,p=G2(u,o,t[0].dtype,d),h=T.computeOutShape(l.map(m=>m.shape),i),f=n.makeTensorInfo(h,t[0].dtype,p);return c.forEach(m=>n.disposeIntermediateTensorInfo(m)),f}var Rge={kernelName:Wp,backendName:"cpu",kernelFunc:wp};function m4(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:s,pad:o,dataFormat:l,dilations:c,dimRoundingMode:u}=r;$e([a,i],"conv2d");let d=T.convertConv2DDataFormat(l),p=T.computeConv2DInfo(a.shape,i.shape,s,c,o,u,!1,d),h=p.filterHeight,f=p.filterWidth,m=p.dilationHeight,g=p.dilationWidth,y=p.padInfo.left,b=p.padInfo.top,v=p.dataFormat==="channelsLast",x=new hn(p.outShape,a.dtype),w=k.computeStrides(a.shape),$=k.computeStrides(i.shape),C=w[0],E=v?w[1]:w[2],_=v?w[2]:1,R=v?1:w[1],N=x.strides[0],I=v?x.strides[1]:x.strides[2],O=v?x.strides[2]:1,P=v?1:x.strides[1],L=n.data.get(a.dataId).values,U=n.data.get(i.dataId).values,D=x.values;for(let F=0;F<p.batchSize;++F){let z=F*C,B=F*N;for(let j=0;j<p.outHeight;++j){let Y=B+j*I,Q=j*p.strideHeight-b;for(let ae=0;ae<h;++ae){let se=Q+ae*m;if(se<0||se>=p.inHeight)continue;let fe=ae*$[0],me=z+se*E;for(let he=0;he<p.outWidth;++he){let Te=Y+he*O,Fe=he*p.strideWidth-y;for(let Ve=0;Ve<f;++Ve){let Pe=Fe+Ve*g;if(Pe<0||Pe>=p.inWidth)continue;let pt=fe+Ve*$[1],Je=me+Pe*_,tt=pt;for(let Le=0;Le<p.inChannels;++Le){let st=L[Je+Le*R];for(let gt=0;gt<p.outChannels;++gt)D[Te+gt*P]+=st*U[tt+gt];tt+=p.outChannels}}}}}}return n.makeTensorInfo(x.shape,x.dtype,D)}var Dge={kernelName:Du,backendName:"cpu",kernelFunc:m4};function Fge(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,dy:i}=t,{strides:s,pad:o,dataFormat:l,dimRoundingMode:c,filterShape:u}=r;$e([a,i],"conv2dBackpropFilter");let d=T.convertConv2DDataFormat(l),p=T.computeConv2DInfo(a.shape,u,s,1,o,c,!1,d),{strideHeight:h,strideWidth:f,filterHeight:m,filterWidth:g}=p,y=p.dataFormat==="channelsLast",b=new hn(p.filterShape,"float32"),v=p.padInfo.left,x=p.padInfo.top,w=n.data.get(a.dataId).values,$=n.data.get(i.dataId).values,C=new hn(a.shape,a.dtype,w),E=new hn(i.shape,i.dtype,$);for(let _=0;_<m;++_){let R=Math.max(0,Math.ceil((x-_)/h)),N=Math.min(p.outHeight,(p.inHeight+x-_)/h);for(let I=0;I<g;++I){let O=Math.max(0,Math.ceil((v-I)/f)),P=Math.min(p.outWidth,(p.inWidth+v-I)/f);for(let L=0;L<p.inChannels;++L)for(let U=0;U<p.outChannels;++U){let D=0;for(let F=0;F<p.batchSize;++F)for(let z=R;z<N;++z){let B=_+z*h-x;for(let j=O;j<P;++j){let Y=I+j*f-v;y?D+=C.get(F,B,Y,L)*E.get(F,z,j,U):D+=C.get(F,L,B,Y)*E.get(F,U,z,j)}}b.set(D,_,I,L,U)}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}var Mge={kernelName:Y0,backendName:"cpu",kernelFunc:Fge};function Oge(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:i}=t,{inputShape:s,strides:o,pad:l,dataFormat:c,dimRoundingMode:u}=r;$e([a,i],"conv2dBackpropInput");let d=k.computeStrides(i.shape),p=k.computeStrides(a.shape),h=T.convertConv2DDataFormat(c),f=T.computeConv2DInfo(s,i.shape,o,1,l,u,!1,h),m=new hn(f.inShape,"float32"),g=m.values,y=n.data.get(a.dataId).values,b=n.data.get(i.dataId).values,[v,x,w]=d,{batchSize:$,filterHeight:C,filterWidth:E,inChannels:_,inHeight:R,inWidth:N,outChannels:I,outHeight:O,outWidth:P,strideHeight:L,strideWidth:U}=f;h=f.dataFormat;let D=C-1-f.padInfo.top,F=E-1-f.padInfo.left,z=h==="channelsLast",B=m.strides[0],j=z?m.strides[1]:m.strides[2],Y=z?m.strides[2]:1,Q=z?1:m.strides[1],ae=p[0],se=z?p[1]:p[2],fe=z?p[2]:1,me=z?1:p[1];for(let he=0;he<$;++he)for(let Te=0;Te<_;++Te)for(let Fe=0;Fe<R;++Fe){let Ve=Fe-D,Pe=Math.max(0,Math.ceil(Ve/L)),pt=Math.min(O,(C+Ve)/L);for(let Je=0;Je<N;++Je){let tt=Je-F,Le=Math.max(0,Math.ceil(tt/U)),st=Math.min(P,(E+tt)/U),gt=0;for(let Ot=Pe;Ot<pt;++Ot){let Qn=Ot*L-Ve;for(let yn=Le;yn<st;++yn){let Jn=yn*U-tt,Yr=ae*he+se*Ot+fe*yn,hr=v*(C-1-Qn)+x*(E-1-Jn)+w*Te;for(let er=0;er<I;++er){let bn=y[Yr+me*er],Tn=b[hr+er];gt+=bn*Tn}}}let pr=B*he+j*Fe+Y*Je+Q*Te;g[pr]=gt}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}var Lge={kernelName:Fu,backendName:"cpu",kernelFunc:Oge};function Pge(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:s,pad:o,dilations:l}=r;$e([a,i],"conv3d");let c=T.computeConv3DInfo(a.shape,i.shape,s,l,o),{filterDepth:u,filterHeight:d,filterWidth:p,dilationDepth:h,dilationHeight:f,dilationWidth:m,padInfo:g}=c,y=g.front,b=g.left,v=g.top,x=new hn(c.outShape,a.dtype),w=n.data.get(a.dataId).values,$=n.data.get(i.dataId).values,C=x.values,E=k.computeStrides(a.shape),_=k.computeStrides(i.shape);for(let R=0;R<c.batchSize;++R){let N=R*E[0],I=R*x.strides[0];for(let O=0;O<c.outDepth;++O){let P=I+O*x.strides[1],L=O*c.strideDepth-y;for(let U=0;U<u;++U){let D=L+U*h;if(D<0||D>=c.inDepth)continue;let F=U*_[0],z=N+D*E[1];for(let B=0;B<c.outHeight;++B){let j=P+B*x.strides[2],Y=B*c.strideHeight-v;for(let Q=0;Q<d;++Q){let ae=Y+Q*f;if(ae<0||ae>=c.inHeight)continue;let se=F+Q*_[1],fe=z+ae*E[2];for(let me=0;me<c.outWidth;++me){let he=j+me*c.outChannels,Te=me*c.strideWidth-b;for(let Fe=0;Fe<p;++Fe){let Ve=Te+Fe*m;if(Ve<0||Ve>=c.inWidth)continue;let Pe=se+Fe*_[2],pt=fe+Ve*c.inChannels,Je=Pe;for(let tt=0;tt<c.inChannels;++tt){let Le=w[pt+tt];for(let st=0;st<c.outChannels;++st)C[he+st]+=Le*$[Je+st];Je+=c.outChannels}}}}}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}var zge={kernelName:Mu,backendName:"cpu",kernelFunc:Pge};function Bge(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,dy:i}=t,{strides:s,pad:o,filterShape:l}=r;$e([a,i],"conv3dBackpropFilterV2");let c=k.computeStrides(a.shape),u=k.computeStrides(i.shape),d=T.computeConv3DInfo(a.shape,l,s,1,o),p=d.strideDepth,h=d.strideHeight,f=d.strideWidth,m=d.filterDepth,g=d.filterHeight,y=d.filterWidth,b=new hn(d.filterShape,"float32"),v=b.values,[x,w,$,C]=b.strides,E=n.data.get(i.dataId).values,[_,R,N,I]=u,O=n.data.get(a.dataId).values,[P,L,U,D]=c,F=d.padInfo.front,z=d.padInfo.left,B=d.padInfo.top;for(let j=0;j<m;++j){let Y=Math.max(0,Math.ceil((F-j)/p)),Q=Math.min(d.outDepth,(d.inDepth+F-j)/p),ae=j*x;for(let se=0;se<g;++se){let fe=Math.max(0,Math.ceil((B-se)/h)),me=Math.min(d.outHeight,(d.inHeight+B-se)/h),he=se*w+ae;for(let Te=0;Te<y;++Te){let Fe=Math.max(0,Math.ceil((z-Te)/f)),Ve=Math.min(d.outWidth,(d.inWidth+z-Te)/f),Pe=Te*$+he;for(let pt=0;pt<d.inChannels;++pt){let Je=pt*C+Pe;for(let tt=0;tt<d.outChannels;++tt){let Le=0;for(let st=0;st<d.batchSize;++st){let gt=st*P,pr=st*_;for(let Ot=Y;Ot<Q;++Ot){let Qn=(j+Ot*p-F)*L+gt,yn=Ot*R+pr;for(let Jn=fe;Jn<me;++Jn){let Yr=(se+Jn*h-B)*U+Qn,hr=Jn*N+yn;for(let er=Fe;er<Ve;++er){let bn=(Te+er*f-z)*D+Yr,Tn=er*I+hr;Le+=O[bn+pt]*E[Tn+tt]}}}}v[Je+tt]=Le}}}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}var Wge={kernelName:Up,backendName:"cpu",kernelFunc:Bge};function Uge(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:i}=t,{pad:s,strides:o,inputShape:l}=r;$e([a],"conv3dBackpropInputV2");let c=k.computeStrides(a.shape),u=k.computeStrides(i.shape),d=T.computeConv3DInfo(l,i.shape,o,1,s),p=new hn(d.inShape,"float32"),h=p.values,[f,m,g,y]=p.strides,b=n.data.get(a.dataId).values,[v,x,w,$]=c,C=n.data.get(i.dataId).values,[E,_,R,N]=u,{batchSize:I,filterDepth:O,filterHeight:P,filterWidth:L,inChannels:U,inDepth:D,inHeight:F,inWidth:z,outChannels:B,outDepth:j,outHeight:Y,outWidth:Q,strideDepth:ae,strideHeight:se,strideWidth:fe}=d,me=O-1-d.padInfo.front,he=P-1-d.padInfo.top,Te=L-1-d.padInfo.left;for(let Fe=0;Fe<I;++Fe)for(let Ve=0;Ve<U;++Ve)for(let Pe=0;Pe<D;++Pe){let pt=Pe-me,Je=Math.max(0,Math.ceil(pt/ae)),tt=Math.min(j,(O+pt)/ae);for(let Le=0;Le<F;++Le){let st=Le-he,gt=Math.max(0,Math.ceil(st/se)),pr=Math.min(Y,(P+st)/se);for(let Ot=0;Ot<z;++Ot){let Qn=Ot-Te,yn=Math.max(0,Math.ceil(Qn/fe)),Jn=Math.min(Q,(L+Qn)/fe),Yr=0;for(let hr=Je;hr<tt;++hr){let er=hr*ae-pt;for(let bn=gt;bn<pr;++bn){let Tn=bn*se-st;for(let Mr=yn;Mr<Jn;++Mr){let ii=Mr*fe-Qn,on=v*Fe+x*hr+w*bn+$*Mr,Zr=E*(O-1-er)+_*(P-1-Tn)+R*(L-1-ii)+N*Ve;for(let tr=0;tr<B;++tr){let Bi=b[on+tr],vn=C[Zr+tr];Yr+=Bi*vn}}}}h[f*Fe+m*Pe+g*Le+y*Ot+Ve]=Yr}}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}var Vge={kernelName:Vp,backendName:"cpu",kernelFunc:Uge},Hge=mt(Ou,e=>Math.cos(e)),jge={kernelName:Ou,backendName:"cpu",kernelFunc:Hge},Gge=mt(Lu,e=>Math.cosh(e)),qge={kernelName:Lu,backendName:"cpu",kernelFunc:Gge};function Kge(e){let{inputs:t,backend:n,attrs:r}=e,{image:a,boxes:i,boxInd:s}=t,{cropSize:o,method:l,extrapolationValue:c}=r,[u,d,p,h]=a.shape,f=i.shape[0],[m,g]=o,y=Ze([f,m,g,h],"float32"),b=n.data.get(i.dataId).values,v=n.data.get(s.dataId).values,x=n.data.get(a.dataId).values,w=k.computeStrides(a.shape),$=k.computeStrides(y.shape);for(let C=0;C<f;C++){let E=C*4,_=b[E],R=b[E+1],N=b[E+2],I=b[E+3],O=v[C];if(O>=u)continue;let P=m>1?(N-_)*(d-1)/(m-1):0,L=g>1?(I-R)*(p-1)/(g-1):0;for(let U=0;U<m;U++){let D=m>1?_*(d-1)+U*P:.5*(_+N)*(d-1);if(D<0||D>d-1){for(let F=0;F<g;F++)for(let z=0;z<h;z++){let B=z+F*$[2]+U*$[1]+C*$[0];y.values[B]=c}continue}if(l==="bilinear"){let F=Math.floor(D),z=Math.ceil(D),B=D-F;for(let j=0;j<g;j++){let Y=g>1?R*(p-1)+j*L:.5*(R+I)*(p-1);if(Y<0||Y>p-1){for(let fe=0;fe<h;fe++){let me=fe+j*$[2]+U*$[1]+C*$[0];y.values[me]=c}continue}let Q=Math.floor(Y),ae=Math.ceil(Y),se=Y-Q;for(let fe=0;fe<h;fe++){let me=fe+Q*w[2]+F*w[1]+O*w[0],he=x[me];me=fe+ae*w[2]+F*w[1]+O*w[0];let Te=x[me];me=fe+Q*w[2]+z*w[1]+O*w[0];let Fe=x[me];me=fe+ae*w[2]+z*w[1]+O*w[0];let Ve=x[me],Pe=he+(Te-he)*se,pt=Fe+(Ve-Fe)*se;me=fe+j*$[2]+U*$[1]+C*$[0],y.values[me]=Pe+(pt-Pe)*B}}}else for(let F=0;F<g;++F){let z=g>1?R*(p-1)+F*L:.5*(R+I)*(p-1);if(z<0||z>p-1){for(let Y=0;Y<h;Y++){let Q=Y+F*$[2]+U*$[1]+C*$[0];y.values[Q]=c}continue}let B=Math.round(z),j=Math.round(D);for(let Y=0;Y<h;Y++){let Q=Y+B*w[2]+j*w[1]+O*w[0],ae=Y+F*$[2]+U*$[1]+C*$[0];y.values[ae]=x[Q]}}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}var Xge={kernelName:jp,backendName:"cpu",kernelFunc:Kge};function Yge(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,exclusive:s,reverse:o}=r;$e(a,"cumprod");let l=T.getAxesPermutation([i],a.shape.length),c=a;l!=null&&(c=Gr({inputs:{x:a},backend:n,attrs:{perm:l}}));let u=T.getInnerMostAxes(1,a.shape.length)[0];if(u!==c.shape.length-1)throw new Error("backend.cumprod in CPU expects an inner-most axis=".concat(c.shape.length-1," but got axis=").concat(u));let d=Ra(c.dtype,"int32"),p=k.makeOnesTypedArray(k.sizeFromShape(c.shape),d),h=n.data.get(c.dataId).values,f=c.shape[c.shape.length-1],m=o?(y,b)=>y+f-b-1:(y,b)=>y+b;for(let y=0;y<h.length;y+=f)for(let b=0;b<f;b++){let v=m(y,b);if(b===0)p[v]=s?1:h[v];else{let x=m(y,b-1);p[v]=s?h[x]*p[x]:h[v]*p[x]}}let g=n.makeTensorInfo(c.shape,d,p);if(l!=null){let y=T.getUndoAxesPermutation(l),b=Gr({inputs:{x:g},backend:n,attrs:{perm:y}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(c),b}return g}var Zge={kernelName:Hp,backendName:"cpu",kernelFunc:Yge};function Qge(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,exclusive:s,reverse:o}=r;$e(a,"cumsum");let l=T.getAxesPermutation([i],a.shape.length),c=a;l!=null&&(c=Gr({inputs:{x:a},backend:n,attrs:{perm:l}}));let u=T.getInnerMostAxes(1,a.shape.length)[0];if(u!==c.shape.length-1)throw new Error("backend.cumsum in CPU expects an inner-most axis=".concat(c.shape.length-1," but got axis=").concat(u));let d=Ra(c.dtype,"int32"),p=k.makeZerosTypedArray(k.sizeFromShape(c.shape),d),h=n.data.get(c.dataId).values,f=c.shape[c.shape.length-1],m=o?(y,b)=>y+f-b-1:(y,b)=>y+b;for(let y=0;y<h.length;y+=f)for(let b=0;b<f;b++){let v=m(y,b);if(b===0)p[v]=s?0:h[v];else{let x=m(y,b-1);p[v]=s?h[x]+p[x]:h[v]+p[x]}}let g=n.makeTensorInfo(c.shape,d,p);if(l!=null){let y=T.getUndoAxesPermutation(l),b=Gr({inputs:{x:g},backend:n,attrs:{perm:y}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(c),b}return g}var Jge={kernelName:Pu,backendName:"cpu",kernelFunc:Qge};function eye(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,weights:i}=t,{size:s,binaryOutput:o}=r;if(a.shape.length===1){let l=n.data.get(a.dataId).values,c=n.data.get(i.dataId).values,u=j2(l,c,i.dtype,i.shape,s);return n.makeTensorInfo([s],i.dtype,u)}else if(a.shape.length===2){let l=n.bufferSync(a),c=n.bufferSync(i),u=SW(l,c,s,o);return n.makeTensorInfo(u.shape,i.dtype,u.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank".concat(a.shape.length,"."))}var tye={kernelName:sg,backendName:"cpu",kernelFunc:eye};function nye(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockSize:i,dataFormat:s}=r;k.assert(s==="NHWC",()=>"Only NHWC dataFormat supported on CPU for depthToSpace. Got ".concat(s));let o=a.shape[0],l=a.shape[1],c=a.shape[2],u=a.shape[3],d=l*i,p=c*i,h=u/(i*i),f=n.data.get(a.dataId).values,m=new Float32Array(o*d*p*h),g=0;for(let y=0;y<o;++y)for(let b=0;b<d;++b){let v=Math.floor(b/i),x=b%i;for(let w=0;w<p;++w){let $=Math.floor(w/i),C=w%i,E=(x*i+C)*h;for(let _=0;_<h;++_){let R=_+E+u*($+c*(v+l*y));m[g++]=f[R]}}}return n.makeTensorInfo([o,d,p,h],a.dtype,m)}var rye={kernelName:Gp,backendName:"cpu",kernelFunc:nye};function g4(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:s,pad:o,dilations:l,dimRoundingMode:c}=r;$e([a,i],"depthwiseConv2DNative");let u=k.computeStrides(a.shape),d=k.computeStrides(i.shape),p=l;p==null&&(p=[1,1]),k.assert(T.eitherStridesOrDilationsAreOne(s,p),()=>"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ".concat(s," and dilations '").concat(p,"'"));let h=T.computeConv2DInfo(a.shape,i.shape,s,p,o,c,!0),{filterHeight:f,filterWidth:m,dilationHeight:g,dilationWidth:y,padInfo:b}=h,v=b.left,x=b.top,w=h.outChannels/h.inChannels,$=new hn(h.outShape,a.dtype),C=n.data.get(a.dataId).values,E=n.data.get(i.dataId).values,_=$.values;for(let R=0;R<h.batchSize;++R){let N=R*u[0],I=R*$.strides[0];for(let O=0;O<h.outHeight;++O){let P=I+O*$.strides[1],L=O*h.strideHeight-x;for(let U=0;U<f;++U){let D=L+U*g;if(D<0||D>=h.inHeight)continue;let F=U*d[0],z=N+D*u[1];for(let B=0;B<h.outWidth;++B){let j=P+B*$.strides[2],Y=B*h.strideWidth-v;for(let Q=0;Q<m;++Q){let ae=Y+Q*y;if(ae<0||ae>=h.inWidth)continue;let se=F+Q*d[1],fe=z+ae*h.inChannels,me=j,he=se;for(let Te=0;Te<h.inChannels;++Te){let Fe=C[fe+Te];for(let Ve=0;Ve<w;++Ve)_[me+Ve]+=Fe*E[he+Ve];me+=w,he+=w}}}}}}return n.makeTensorInfo($.shape,$.dtype,$.values)}var aye={kernelName:zu,backendName:"cpu",kernelFunc:g4};function iye(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,dy:i}=t,{strides:s,dilations:o,pad:l,dimRoundingMode:c,filterShape:u}=r;$e([a,i],"depthwiseConv2dNativeBackpropFilter");let d=T.computeConv2DInfo(a.shape,u,s,o,l,c,!0),{strideHeight:p,strideWidth:h,filterHeight:f,filterWidth:m}=d,g=new hn(d.filterShape,"float32"),y=d.padInfo.left,b=d.padInfo.top,v=d.outChannels/d.inChannels,x=n.data.get(a.dataId).values,w=new hn(a.shape,a.dtype,x),$=n.data.get(i.dataId).values,C=new hn(i.shape,i.dtype,$);for(let E=0;E<f;++E){let _=Math.max(0,Math.ceil((b-E)/p)),R=Math.min(d.outHeight,(d.inHeight+b-E)/p);for(let N=0;N<m;++N){let I=Math.max(0,Math.ceil((y-N)/h)),O=Math.min(d.outWidth,(d.inWidth+y-N)/h);for(let P=0;P<d.outChannels;++P){let L=Math.trunc(P/v),U=P%v,D=0;for(let F=0;F<d.batchSize;++F)for(let z=_;z<R;++z){let B=E+z*p-b;for(let j=I;j<O;++j){let Y=N+j*h-y;D+=w.get(F,B,Y,L)*C.get(F,z,j,P)}}g.set(D,E,N,L,U)}}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}var sye={kernelName:Z0,backendName:"cpu",kernelFunc:iye};function oye(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:i}=t,{strides:s,dilations:o,pad:l,dimRoundingMode:c,inputShape:u}=r;$e([a,i],"depthwiseConv2DNativeBackpropInput");let d=k.computeStrides(a.shape),p=k.computeStrides(i.shape),h=T.computeConv2DInfo(u,i.shape,s,o,l,c,!0),f=new hn(h.inShape,"float32"),m=f.values,[g,y,b]=f.strides,v=n.data.get(a.dataId).values,[x,w,$]=d,C=n.data.get(i.dataId).values,[E,_,R]=p,{batchSize:N,filterHeight:I,filterWidth:O,inChannels:P,inHeight:L,inWidth:U,outChannels:D,outHeight:F,outWidth:z,strideHeight:B,strideWidth:j}=h,Y=I-1-h.padInfo.top,Q=O-1-h.padInfo.left,ae=D/P;for(let se=0;se<N;++se)for(let fe=0;fe<P;++fe)for(let me=0;me<L;++me){let he=me-Y,Te=Math.max(0,Math.ceil(he/B)),Fe=Math.min(F,(I+he)/B);for(let Ve=0;Ve<U;++Ve){let Pe=Ve-Q,pt=Math.max(0,Math.ceil(Pe/j)),Je=Math.min(z,(O+Pe)/j),tt=0;for(let Le=Te;Le<Fe;++Le){let st=Le*B-he;for(let gt=pt;gt<Je;++gt){let pr=gt*j-Pe,Ot=x*se+w*Le+$*gt,Qn=E*(I-1-st)+_*(O-1-pr)+R*fe;for(let yn=0;yn<ae;++yn){let Jn=fe*ae+yn,Yr=v[Ot+Jn],hr=C[Qn+yn];tt+=Yr*hr}}}m[g*se+y*me+b*Ve+fe]=tt}}return n.makeTensorInfo(f.shape,f.dtype,f.values)}var lye={kernelName:Q0,backendName:"cpu",kernelFunc:oye};function uye(e){let{inputs:t,backend:n}=e,{x:r}=t,a=k.sizeFromShape(r.shape),i=n.data.get(r.dataId).values,s=Ze([a,a],r.dtype),o=s.values;for(let c=0;c<i.length;c++)o[c*a+c]=i[c];let l=[...r.shape,...r.shape];return n.makeTensorInfo(l,s.dtype,s.values)}var cye={kernelName:og,backendName:"cpu",kernelFunc:uye},dye={kernelName:Bu,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{let{x:r,filter:a}=e,{strides:i,pad:s,dilations:o}=n,l=t,c=l.data.get(r.dataId).values,u=r.shape.length,d=l.data.get(a.dataId).values,p=a.shape.length,{batchSize:h,inHeight:f,inWidth:m,inChannels:g,outHeight:y,outWidth:b,padInfo:v,strideHeight:x,strideWidth:w,filterHeight:$,filterWidth:C,dilationHeight:E,dilationWidth:_,outShape:R}=T.computeDilation2DInfo(r.shape,a.shape,i,s,"NHWC",o),N=k.sizeFromShape(R),I=R.length,O=k.getArrayFromDType(r.dtype,N);for(let P=0;P<h;++P)for(let L=0;L<y;++L){let U=L*x-v.top;for(let D=0;D<b;++D){let F=D*w-v.left;for(let z=0;z<g;++z){let B=Number.MIN_SAFE_INTEGER;for(let Y=0;Y<$;++Y){let Q=U+Y*E;if(Q>=0&&Q<f)for(let ae=0;ae<C;++ae){let se=F+ae*_;if(se>=0&&se<m){let fe=k.locToIndex([P,Q,se,z],u,k.computeStrides(r.shape)),me=k.locToIndex([Y,ae,z],p,k.computeStrides(a.shape)),he=c[fe]+d[me];he>B&&(B=he)}}}let j=k.locToIndex([P,L,D,z],I,k.computeStrides(R));O[j]=B}}}return{dataId:l.write(k.toTypedArray(O,r.dtype),R,r.dtype),shape:R,dtype:r.dtype}}},pye={kernelName:ap,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{let{x:r,filter:a,dy:i}=e,{strides:s,pad:o,dilations:l}=n,c=t,u=k.toNestedArray(r.shape,c.data.get(r.dataId).values),d=k.toNestedArray(a.shape,c.data.get(a.dataId).values),{batchSize:p,inHeight:h,inWidth:f,inChannels:m,outHeight:g,outWidth:y,padInfo:b,strideHeight:v,strideWidth:x,filterHeight:w,filterWidth:$,dilationHeight:C,dilationWidth:E,outShape:_}=T.computeDilation2DInfo(r.shape,a.shape,s,o,"NHWC",l);k.assert(i.rank===_.length,()=>"Error in ".concat(ap,", dy must have the same rank as output ").concat(_.length,", but got ").concat(i.rank));let R=k.toNestedArray(_,c.data.get(i.dataId).values),N=k.makeZerosNestedTypedArray(a.shape,a.dtype);for(let I=0;I<p;++I)for(let O=0;O<g;++O){let P=O*v-b.top;for(let L=0;L<y;++L){let U=L*x-b.left;for(let D=0;D<m;++D){let F=Number.MIN_SAFE_INTEGER,z=0,B=0;for(let j=0;j<w;++j){let Y=P+j*C;if(Y>=0&&Y<h)for(let Q=0;Q<$;++Q){let ae=U+Q*E;if(ae>=0&&ae<f){let se=u[I][Y][ae][D]+d[j][Q][D];se>F&&(F=se,z=j,B=Q)}}}N[z][B][D]+=R[I][O][L][D]}}}return{dataId:c.write(k.toTypedArray(N,r.dtype),a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}},hye={kernelName:rp,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{let{x:r,filter:a,dy:i}=e,{strides:s,pad:o,dilations:l}=n,c=t,u=k.toNestedArray(r.shape,c.data.get(r.dataId).values),d=k.toNestedArray(a.shape,c.data.get(a.dataId).values),{batchSize:p,inHeight:h,inWidth:f,inChannels:m,outHeight:g,outWidth:y,padInfo:b,strideHeight:v,strideWidth:x,filterHeight:w,filterWidth:$,dilationHeight:C,dilationWidth:E,outShape:_}=T.computeDilation2DInfo(r.shape,a.shape,s,o,"NHWC",l);k.assert(i.rank===_.length,()=>"Error in ".concat(rp,", dy must have the same rank as output ").concat(_.length,", but got ").concat(i.rank));let R=k.toNestedArray(_,c.data.get(i.dataId).values),N=k.makeZerosNestedTypedArray(r.shape,r.dtype);for(let I=0;I<p;++I)for(let O=0;O<g;++O){let P=O*v-b.top;for(let L=0;L<y;++L){let U=L*x-b.left;for(let D=0;D<m;++D){let F=Number.MIN_SAFE_INTEGER,z=P<0?0:P,B=U<0?0:U;for(let j=0;j<w;++j){let Y=P+j*C;if(Y>=0&&Y<h)for(let Q=0;Q<$;++Q){let ae=U+Q*E;if(ae>=0&&ae<f){let se=u[I][Y][ae][D]+d[j][Q][D];se>F&&(F=se,z=Y,B=ae)}}}N[I][z][B][D]+=R[I][O][L][D]}}}return{dataId:c.write(k.toTypedArray(N,r.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};function fye(e){let{inputs:t,backend:n,attrs:r}=e,{image:a}=t,{canvas:i,options:s}=r,{contextOptions:o,imageOptions:l}=s||{},c=(l==null?void 0:l.alpha)||1,u=(o==null?void 0:o.contextType)||"2d";if(u!=="2d")throw new Error("Context type ".concat(o.contextType," is not supported by the CPU backend."));let d=i.getContext(u,(o==null?void 0:o.contextAttributes)||{});if(d==null)throw new Error("Could not get the context with ".concat(u," type."));let[p,h]=a.shape.slice(0,2),f=a.shape.length===2?1:a.shape[2],m=n.data.get(a.dataId).values,g=a.dtype==="float32"?255:1,y=new Uint8ClampedArray(h*p*4);for(let v=0;v<p*h;++v){let x=[0,0,0,255*c];for(let $=0;$<f;$++){let C=m[v*f+$];if(a.dtype==="float32"){if(C<0||C>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ".concat(C,"."))}else if(a.dtype==="int32"&&(C<0||C>255))throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ".concat(C,"."));f===1?(x[0]=C*g,x[1]=C*g,x[2]=C*g):x[$]=C*g}let w=v*4;y[w+0]=Math.round(x[0]),y[w+1]=Math.round(x[1]),y[w+2]=Math.round(x[2]),y[w+3]=Math.round(x[3])}i.width=h,i.height=p;let b=new ImageData(y,h,p);return d.putImageData(b,0,0),a}var mye={kernelName:P$,backendName:"cpu",kernelFunc:fye};function Jg(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:s}=r;$e(a,"sum");let o;a.dtype==="bool"?o=zo({inputs:{x:a},backend:n,attrs:{dtype:"int32"}}):o=is({inputs:{x:a},backend:n});let l=o.shape.length,c=k.parseAxisParam(i,o.shape),u=T.getAxesPermutation(c,l),d=c,p=o;u!=null&&(p=Gr({inputs:{x:o},backend:n,attrs:{perm:u}}),d=T.getInnerMostAxes(d.length,l)),T.assertAxesAreInnerMostDims("sum",d,p.shape.length);let[h,f]=T.computeOutAndReduceShapes(p.shape,d),m=T.upcastType(p.dtype,"int32"),g=Pv(n,h,m),y=k.sizeFromShape(f),b=n.data.get(g.dataId).values,v=n.data.get(p.dataId).values;for(let x=0;x<b.length;++x){let w=x*y,$=0;for(let C=0;C<y;++C)$+=v[w+C];b[x]=$}if(s){let x=T.expandShapeToKeepDim(g.shape,c),w=g;g=At({inputs:{x:g},backend:n,attrs:{shape:x}}),n.disposeIntermediateTensorInfo(w)}return n.disposeIntermediateTensorInfo(o),u!=null&&n.disposeIntermediateTensorInfo(p),g}var gye={kernelName:Dc,backendName:"cpu",kernelFunc:Jg};function yye(e){let{inputs:t,backend:n,attrs:r}=e,{equation:a}=r,i=t,{allDims:s,summedDims:o,idDims:l}=T.decodeEinsumEquation(a,i.length);T.checkEinsumDimSizes(s.length,l,i);let{path:c,steps:u}=T.getEinsumComputePath(o,l),d=u.length,p=null,h=s.length,f=[];for(let m=0;m<d;++m){for(let g of u[m]){let{permutationIndices:y,expandDims:b}=T.getEinsumPermutation(h,l[g]),v;T.isIdentityPermutation(y)?v=i[g]:(v=Gr({inputs:{x:i[g]},backend:n,attrs:{perm:y}}),f.push(v));let x=v.shape.slice();for(let w=0;w<b.length;++w)x.splice(b[w],0,1);k.arraysEqual(v.shape,x)||(v=At({inputs:{x:v},backend:n,attrs:{shape:x}}),f.push(v)),p===null?p=v:(p=uw({inputs:{a:v,b:p},backend:n}),f.push(p))}m<d-1&&(c[m]>=0&&(p=Jg({inputs:{x:p},backend:n,attrs:{axis:c[m]-(s.length-h),keepDims:!1}}),f.push(p)),h--)}for(let m of f)m!==p&&n.disposeIntermediateTensorInfo(m);return p}var bye={kernelName:J0,backendName:"cpu",kernelFunc:yye};function vye(e){let{inputs:t,backend:n}=e,{dy:r,y:a}=t;$e([r,a],"eluGrad");let i=new Float32Array(k.sizeFromShape(a.shape)),s=n.data.get(a.dataId).values,o=n.data.get(r.dataId).values;for(let l=0;l<s.length;++l){let c=s[l];c>=0?i[l]=o[l]:i[l]=o[l]*(c+1)}return n.makeTensorInfo(a.shape,"float32",i)}var xye={kernelName:qp,backendName:"cpu",kernelFunc:vye},wye=T.ERF_P,kye=T.ERF_A1,Sye=T.ERF_A2,Iye=T.ERF_A3,$ye=T.ERF_A4,Cye=T.ERF_A5,Eye=mt(Vu,e=>{let t=Math.sign(e),n=Math.abs(e),r=1/(1+wye*n);return t*(1-((((Cye*r+$ye)*r+Iye)*r+Sye)*r+kye)*r*Math.exp(-n*n))}),Tye={kernelName:Vu,backendName:"cpu",kernelFunc:Eye};function Wv(e){let{inputs:t,backend:n,attrs:r}=e,{input:a}=t,{dim:i}=r,s=a.shape.length,o=a.shape.slice(),l=i;return i<0&&(k.assert(-(s+1)<=i,()=>"Axis must be in the interval [".concat(-(s+1),", ").concat(s,"]")),l=s+i+1),o.splice(l,0,1),At({inputs:{x:a},backend:n,attrs:{shape:o}})}var Nye={kernelName:Xp,backendName:"cpu",kernelFunc:Wv},_ye=sn((e,t)=>e/t),rT=En(Wu,_ye),AS={kernelName:Wu,backendName:"cpu",kernelFunc:rT};function y4(e,t,n){let r=e.shape,a=r[0],i=r[1],s=n.data.get(e.dataId),o=s.complexTensorInfos.real,l=s.complexTensorInfos.imag,c=[a,i],u=k.sizeFromShape(c),d=k.getTypedArrayFromDType("float32",u),p=k.getTypedArrayFromDType("float32",u);for(let g=0;g<a;g++){let y=cu({inputs:{x:o},backend:n,attrs:{begin:[g,0],size:[1,i]}}),b=cu({inputs:{x:l},backend:n,attrs:{begin:[g,0],size:[1,i]}}),v=ra({inputs:{real:y,imag:b},backend:n}),{real:x,imag:w}=Aye(v,t,n),$=T.mergeRealAndImagArrays(x,w);for(let C=0;C<i;C++){let E=T.getComplexWithIndex($,C);d[g*i+C]=E.real,p[g*i+C]=E.imag}n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(v)}let h=n.makeTensorInfo(c,"float32",d),f=n.makeTensorInfo(c,"float32",p),m=ra({inputs:{real:h,imag:f},backend:n});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),m}function Aye(e,t,n){let r=k.sizeFromShape(e.shape),a=n.data.get(e.dataId),i=n.data.get(a.complexTensorInfos.real.dataId).values,s=n.data.get(a.complexTensorInfos.imag.dataId).values;if(Rye(r)){let o=RS(i,s,r,t,n),l=[e.shape[0],e.shape[1]];if(t){let c=n.makeTensorInfo(l,"float32",o.real),u=n.makeTensorInfo(l,"float32",o.imag),d=n.makeTensorInfo([],"float32",k.createScalarValue(r,"float32")),p=is({inputs:{x:d},backend:n}),h=AS.kernelFunc({inputs:{a:c,b:d},backend:n}),f=AS.kernelFunc({inputs:{a:u,b:p},backend:n}),m=n.data.get(h.dataId).values,g=n.data.get(f.dataId).values;return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),{real:m,imag:g}}return o}else{let o=T.mergeRealAndImagArrays(i,s),l=Dye(o,r,t);return T.splitRealAndImagArrays(l)}}function Rye(e){return(e&e-1)===0}function RS(e,t,n,r,a){if(n===1)return{real:e,imag:t};let i=T.mergeRealAndImagArrays(e,t),s=n/2,o=T.complexWithEvenIndex(i),l=o.real,c=o.imag,u=[l.length],d=a.makeTensorInfo(u,"float32",l),p=a.makeTensorInfo(u,"float32",c),h=ra({inputs:{real:d,imag:p},backend:a}),f=T.complexWithOddIndex(i),m=f.real,g=f.imag,y=[m.length],b=a.makeTensorInfo(y,"float32",m),v=a.makeTensorInfo(y,"float32",g),x=ra({inputs:{real:b,imag:v},backend:a}),w=RS(l,c,s,r,a),$=w.real,C=w.imag,E=[$.length],_=a.makeTensorInfo(E,"float32",$),R=a.makeTensorInfo(E,"float32",C),N=ra({inputs:{real:_,imag:R},backend:a}),I=RS(m,g,s,r,a),O=I.real,P=I.imag,L=[O.length],U=a.makeTensorInfo(L,"float32",O),D=a.makeTensorInfo(L,"float32",P),F=ra({inputs:{real:U,imag:D},backend:a}),z=T.exponents(n,r),B=[z.real.length],j=a.makeTensorInfo(B,"float32",z.real),Y=a.makeTensorInfo(B,"float32",z.imag),Q=ra({inputs:{real:j,imag:Y},backend:a}),ae=uw({inputs:{a:Q,b:F},backend:a}),se=vp({inputs:{a:N,b:ae},backend:a}),fe=eT({inputs:{a:N,b:ae},backend:a}),me=uu({inputs:{input:se},backend:a}),he=uu({inputs:{input:fe},backend:a}),Te=xp({inputs:{input:se},backend:a}),Fe=xp({inputs:{input:fe},backend:a}),Ve=wp({inputs:[me,he],backend:a,attrs:{axis:0}}),Pe=wp({inputs:[Te,Fe],backend:a,attrs:{axis:0}}),pt=a.data.get(Ve.dataId).values,Je=a.data.get(Pe.dataId).values;return a.disposeIntermediateTensorInfo(d),a.disposeIntermediateTensorInfo(p),a.disposeIntermediateTensorInfo(h),a.disposeIntermediateTensorInfo(b),a.disposeIntermediateTensorInfo(v),a.disposeIntermediateTensorInfo(x),a.disposeIntermediateTensorInfo(_),a.disposeIntermediateTensorInfo(R),a.disposeIntermediateTensorInfo(N),a.disposeIntermediateTensorInfo(U),a.disposeIntermediateTensorInfo(D),a.disposeIntermediateTensorInfo(F),a.disposeIntermediateTensorInfo(j),a.disposeIntermediateTensorInfo(Y),a.disposeIntermediateTensorInfo(Q),a.disposeIntermediateTensorInfo(ae),a.disposeIntermediateTensorInfo(se),a.disposeIntermediateTensorInfo(fe),a.disposeIntermediateTensorInfo(me),a.disposeIntermediateTensorInfo(Te),a.disposeIntermediateTensorInfo(he),a.disposeIntermediateTensorInfo(Fe),a.disposeIntermediateTensorInfo(Ve),a.disposeIntermediateTensorInfo(Pe),{real:pt,imag:Je}}function Dye(e,t,n){let r=new Float32Array(t*2);for(let a=0;a<t;a++){let i=0,s=0;for(let o=0;o<t;o++){let l=T.exponent(a*o,t,n),c=T.getComplexWithIndex(e,o);i+=c.real*l.real-c.imag*l.imag,s+=c.real*l.imag+c.imag*l.real}n&&(i/=t,s/=t),T.assignToTypedArray(r,i,s,a)}return r}function Fye(e){let{inputs:t,backend:n}=e,{input:r}=t,a=k.sizeFromShape(r.shape),i=r.shape[r.shape.length-1],s=a/i,o=At({inputs:{x:r},backend:n,attrs:{shape:[s,i]}}),l=y4(o,!1,n),c=At({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),c}var Mye={kernelName:ex,backendName:"cpu",kernelFunc:Fye};function aT(e){let{backend:t,attrs:n}=e,{shape:r,value:a,dtype:i}=n,s=i||k.inferDtype(a),o=k.getArrayFromDType(s,k.sizeFromShape(r));return Lye(o,a),t.makeTensorInfo(r,s,o)}var Oye={kernelName:lg,backendName:"cpu",kernelFunc:aT};function Lye(e,t,n){e.fill(t)}var Pye={kernelName:Yp,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{image:r}=e,a=n,i=k.getTypedArrayFromDType(r.dtype,k.sizeFromShape(r.shape)),[s,o,l,c]=r.shape,u=a.data.get(r.dataId).values;for(let d=0;d<s;d++){let p=d*l*o*c;for(let h=0;h<o;h++){let f=h*(l*c);for(let m=0;m<l;m++){let g=m*c;for(let y=0;y<c;y++){let b=Math.round(l-m-1),v=p+f+g+y,x=u[v];if(b>=0&&b<l){let w=b*c,$=p+f+w+y;x=u[$]}i[v]=x}}}}return{dataId:a.write(i,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};function zye(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i,bias:s,preluActivationWeights:o}=t,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:p,activation:h,leakyreluAlpha:f}=r,m=m4({inputs:{x:a,filter:i},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:p}});if(s){let g=m;if(u==="NCHW"&&s.shape.length===1&&s.shape[0]!==1){let y=At({inputs:{x:s},backend:n,attrs:{shape:[s.shape[0],1,1]}});m=vp({inputs:{a:m,b:y},backend:n}),n.disposeIntermediateTensorInfo(y)}else m=vp({inputs:{a:m,b:s},backend:n});n.disposeIntermediateTensorInfo(g)}if(h){let g=m;if(u==="NCHW"&&h==="prelu"&&o.shape.length===1&&o.shape[0]!==1){let y=At({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});m=Bv(n,m,h,y,f),n.disposeIntermediateTensorInfo(y)}else m=Bv(n,m,h,o,f);n.disposeIntermediateTensorInfo(g)}return m}var Bye={kernelName:Zl,backendName:"cpu",kernelFunc:zye};function Wye(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i,bias:s,preluActivationWeights:o}=t,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:p,activation:h,leakyreluAlpha:f}=r,m=g4({inputs:{x:a,filter:i},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:p}});if(s){let g=m;m=vp({inputs:{a:m,b:s},backend:n}),n.disposeIntermediateTensorInfo(g)}if(h){let g=m;m=Bv(n,m,h,o,f),n.disposeIntermediateTensorInfo(g)}return m}var Uye={kernelName:Ql,backendName:"cpu",kernelFunc:Wye};function Vye(e){let{inputs:t,backend:n}=e,{params:r,indices:a}=t,i=k.sizeFromShape(r.shape),s=a.shape,o=s[s.length-1],[l,c,u,d]=T.prepareAndValidate(r,a);if(c===0)return n.makeTensorInfo(l,r.dtype,[]);let p=n.data.get(a.dataId).values,h=n.bufferSync(r),f=DW(p,h,r.dtype,c,o,u,d,r.shape,i);return n.makeTensorInfo(l,r.dtype,f.values)}var Hye={kernelName:Qp,backendName:"cpu",kernelFunc:Vye};function jye(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,indices:i}=t,{axis:s,batchDims:o}=r;$e([a,i],"gatherV2");let l=k.parseAxisParam(s,a.shape)[0],c=n.data.get(i.dataId).values,u=a.shape[l];for(let x=0;x<c.length;++x){let w=c[x];k.assert(w<=u-1&&w>=0,()=>"GatherV2: the index value ".concat(w," is not in [0, ").concat(u-1,"]"))}let d=o;o==null&&(d=0);let p=k.sizeFromShape(i.shape),h=T.segment_util.collectGatherOpShapeInfo(a,i,l,d),f=At({inputs:{x:a},backend:n,attrs:{shape:[h.batchSize,h.outerSize,h.dimSize,h.sliceSize]}}),m=At({inputs:{x:i},backend:n,attrs:{shape:[h.batchSize,p/h.batchSize]}}),g=[h.batchSize,h.outerSize,p/h.batchSize,h.sliceSize],y=n.bufferSync(m),b=n.bufferSync(f),v=FW(b,y,g);return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.makeTensorInfo(h.outputShape,v.dtype,v.values)}var Gye={kernelName:Zp,backendName:"cpu",kernelFunc:jye};function qye(e){let{inputs:t,backend:n}=e,{input:r}=t,a=k.sizeFromShape(r.shape),i=r.shape[r.shape.length-1],s=a/i,o=At({inputs:{x:r},backend:n,attrs:{shape:[s,i]}}),l=y4(o,!0,n),c=At({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),c}var Kye={kernelName:tx,backendName:"cpu",kernelFunc:qye},Xye=mt(Zu,e=>Number.isFinite(e)?1:0,"bool"),Yye={kernelName:Zu,backendName:"cpu",kernelFunc:Xye},Zye=mt(Qu,e=>Math.abs(e)===1/0?1:0,"bool"),Qye={kernelName:Qu,backendName:"cpu",kernelFunc:Zye},Jye=mt(Ju,e=>Number.isNaN(e)?1:0,"bool"),ebe={kernelName:Ju,backendName:"cpu",kernelFunc:Jye};function tbe(e){let{backend:t,attrs:n}=e,{start:r,stop:a,num:i}=n,s=zW(r,a,i);return t.makeTensorInfo([s.length],"float32",s)}var nbe={kernelName:nh,backendName:"cpu",kernelFunc:tbe},rbe=mt(nc,e=>Math.log1p(e)),abe={kernelName:nc,backendName:"cpu",kernelFunc:rbe},ibe=sn((e,t)=>e&&t),sbe=En(rh,ibe,null,"bool"),obe={kernelName:rh,backendName:"cpu",kernelFunc:sbe},lbe=mt(ah,e=>e?0:1,"bool"),ube={kernelName:ah,backendName:"cpu",kernelFunc:lbe},cbe=sn((e,t)=>e||t),dbe=En(ih,cbe,null,"bool"),pbe={kernelName:ih,backendName:"cpu",kernelFunc:dbe};function hbe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{depthRadius:i,bias:s,alpha:o,beta:l}=r;$e(a,"LRN");let c=a.shape[3],u=c-1,d=n.data.get(a.dataId).values,p=k.sizeFromShape(a.shape),h=new Float32Array(p);function f(m){let g=m%c,y=m-g+Math.max(0,g-i),b=m-g+Math.min(g+i,u),v=0;for(;y<=b;y++){let x=d[y];v+=x*x}return v}for(let m=0;m<p;m++){let g=f(m),y=d[m]*Math.pow(s+o*g,-l);h[m]=y}return n.makeTensorInfo(a.shape,a.dtype,h)}var fbe={kernelName:rc,backendName:"cpu",kernelFunc:hbe};function mbe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,y:i,dy:s}=t,{depthRadius:o,bias:l,alpha:c,beta:u}=r;$e(s,"LRNGrad");let d=k.sizeFromShape(s.shape),p=s.shape[3],h=n.data.get(s.dataId).values,f=n.data.get(a.dataId).values,m=n.data.get(i.dataId).values,g=new Float32Array(d),y=d;for(let b=0;b<y;b++){let v=b%p,x=b-v+Math.max(0,v-o),w=b-v+Math.min(p,v+o+1),$=0;for(let C=x;C<w;C++)$+=Math.pow(f[C],2);$=c*$+l;for(let C=x;C<w;C++){let E=-2*c*u*f[C]*m[b]/$;b===C&&(E+=Math.pow($,-u)),E*=h[b],g[C]+=E}}return n.makeTensorInfo(s.shape,a.dtype,g)}var gbe={kernelName:sh,backendName:"cpu",kernelFunc:mbe};function b4(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{reductionIndices:i,keepDims:s}=r,o=n,l=a.shape,c=l.length,u=k.parseAxisParam(i,l),d=u,p=T.getAxesPermutation(d,c),h=o.data.get(a.dataId).values;if(p!=null){let x=new Array(c);for(let w=0;w<x.length;w++)x[w]=l[p[w]];h=K2(h,l,a.dtype,p,x),d=T.getInnerMostAxes(d.length,c),l=x}$e(a,"max"),T.assertAxesAreInnerMostDims("max",d,c);let[f,m]=T.computeOutAndReduceShapes(l,d),g=k.sizeFromShape(m),y=WW(h,g,f,a.dtype),b=o.write(y,f,a.dtype),v=f;return s&&(v=T.expandShapeToKeepDim(f,u)),{dataId:b,shape:v,dtype:a.dtype}}var ybe={kernelName:ac,backendName:"cpu",kernelFunc:b4};function bbe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t;$e(a,"maxPool");let{filterSize:i,strides:s,pad:o,dimRoundingMode:l}=r,c=1;k.assert(T.eitherStridesOrDilationsAreOne(s,c),()=>"Error in maxPool: Either strides or dilations must be 1. Got strides ".concat(s," and dilations '").concat(c,"'"));let u=T.computePool2DInfo(a.shape,i,s,c,o,l),d;if(u.filterWidth===1&&u.filterHeight===1&&k.arraysEqual(u.inShape,u.outShape))d=is({inputs:{x:a},backend:n});else{let p=n.data.get(a.dataId).values,h=k.computeStrides(a.shape),f=nT(p,a.shape,a.dtype,h,u,"max");d=n.makeTensorInfo(u.outShape,a.dtype,f.values)}return d}var vbe={kernelName:sc,backendName:"cpu",kernelFunc:bbe};function xbe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:i,strides:s,pad:o,dimRoundingMode:l,dataFormat:c}=r;$e(a,"maxPool3d");let u=T.computePool3DInfo(a.shape,i,s,1,o,l,c),d=n.data.get(a.dataId).values,p=f4(d,a.shape,a.dtype,k.computeStrides(a.shape),u,"max");return n.makeTensorInfo(p.shape,"float32",p.values)}var wbe={kernelName:oh,backendName:"cpu",kernelFunc:xbe};function kbe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,{filterSize:s,strides:o,pad:l,dimRoundingMode:c}=r;$e([a,i],"maxPool3DGrad");let u=T.computePool3DInfo(i.shape,s,o,1,l,c),d=n.bufferSync(i),p=cge(d,u),h=u.strideDepth,f=u.strideHeight,m=u.strideWidth,g=u.dilationDepth,y=u.dilationHeight,b=u.dilationWidth,v=u.effectiveFilterDepth,x=u.effectiveFilterHeight,w=u.effectiveFilterWidth,$=v-1-u.padInfo.front,C=w-1-u.padInfo.left,E=x-1-u.padInfo.top,_=Ze(i.shape,"float32"),R=n.bufferSync(a);for(let N=0;N<u.batchSize;++N)for(let I=0;I<u.inChannels;++I)for(let O=0;O<u.inDepth;++O)for(let P=0;P<u.inHeight;++P)for(let L=0;L<u.inWidth;++L){let U=O-$,D=P-E,F=L-C,z=0;for(let B=0;B<v;B+=g){let j=(U+B)/h;if(!(j<0||j>=u.outDepth||Math.floor(j)!==j))for(let Y=0;Y<x;Y+=y){let Q=(D+Y)/f;if(!(Q<0||Q>=u.outHeight||Math.floor(Q)!==Q))for(let ae=0;ae<w;ae+=b){let se=(F+ae)/m;if(se<0||se>=u.outWidth||Math.floor(se)!==se)continue;let fe=v*x*w-1-p.get(N,j,Q,se,I),me=B*x*w+Y*w+ae,he=fe===me?1:0;if(he===0)continue;let Te=R.get(N,j,Q,se,I);z+=Te*he}}}_.set(z,N,O,P,L,I)}return n.makeTensorInfo(_.shape,_.dtype,_.values)}var Sbe={kernelName:cg,backendName:"cpu",kernelFunc:kbe};function Ibe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i,output:s}=t,o=i;$e([i,s],"maxPoolGrad");let{filterSize:l,strides:c,pad:u,dimRoundingMode:d}=r,p=T.computePool2DInfo(o.shape,l,c,1,u,d),h=n.data.get(o.dataId).values,f=Ze(p.outShape,o.dtype,h4(h,o.shape,o.dtype,p).values),m=p.strideHeight,g=p.strideWidth,y=p.dilationHeight,b=p.dilationWidth,v=p.effectiveFilterHeight,x=p.effectiveFilterWidth,w=x-1-p.padInfo.left,$=v-1-p.padInfo.top,C=Ze(o.shape,"float32"),E=n.data.get(a.dataId).values,_=Ze(a.shape,"float32",E);for(let R=0;R<p.batchSize;++R)for(let N=0;N<p.inChannels;++N)for(let I=0;I<p.inHeight;++I)for(let O=0;O<p.inWidth;++O){let P=I-$,L=O-w,U=0;for(let D=0;D<v;D+=y){let F=(P+D)/m;if(!(F<0||F>=p.outHeight||Math.floor(F)!==F))for(let z=0;z<x;z+=b){let B=(L+z)/g;if(B<0||B>=p.outWidth||Math.floor(B)!==B)continue;let j=v*x-1-f.get(R,F,B,N),Y=D*x+z,Q=j===Y?1:0;if(Q===0)continue;let ae=_.get(R,F,B,N);U+=ae*Q}}C.set(U,R,I,O,N)}return n.makeTensorInfo(C.shape,C.dtype,C.values)}var $be={kernelName:ug,backendName:"cpu",kernelFunc:Ibe};function Cbe(e,t,n,r,a){let i=k.computeStrides(t),s=nT(e,t,n,i,a,"max"),o=h4(e,t,n,a,!0,r);return[s.values,o.values]}var Ebe={kernelName:dg,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{x:r}=e,{filterSize:a,strides:i,pad:s,includeBatchInIndex:o}=t,l=n;$e(r,"MaxPoolWithArgmax");let c=l.data.get(r.dataId).values,u=T.computePool2DInfo(r.shape,a,i,[1,1],s),[d,p]=Cbe(c,r.shape,r.dtype,o,u),h=l.write(d,u.outShape,r.dtype),f=l.write(p,u.outShape,r.dtype);return[{dataId:h,shape:u.outShape,dtype:r.dtype},{dataId:f,shape:u.outShape,dtype:"int32"}]}};function Tbe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:s}=r,o=k.parseAxisParam(i,a.shape),l=T.computeOutAndReduceShapes(a.shape,o)[1],c=k.sizeFromShape(l),u=[],d=n.makeTensorInfo([],"float32",new Float32Array([c]));u.push(d);let p=zo({inputs:{x:a},backend:n,attrs:{dtype:"float32"}});u.push(p);let h=rT({inputs:{a:p,b:d},backend:n});u.push(h);let f=Jg({inputs:{x:h},backend:n,attrs:{axis:i,keepDims:s}});return u.forEach(m=>n.disposeIntermediateTensorInfo(m)),f}var Nbe={kernelName:oc,backendName:"cpu",kernelFunc:Tbe};function _be(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:s}=r;$e(a,"min");let o=k.parseAxisParam(i,a.shape),l=o,c=T.getAxesPermutation(l,a.shape.length),u=a;c!=null&&(u=Gr({inputs:{x:a},backend:n,attrs:{perm:c}}),l=T.getInnerMostAxes(l.length,a.shape.length)),T.assertAxesAreInnerMostDims("min",l,u.shape.length);let[d,p]=T.computeOutAndReduceShapes(u.shape,l),h=k.sizeFromShape(p),f=k.makeZerosTypedArray(k.sizeFromShape(d),u.dtype),m=n.data.get(u.dataId).values;for(let y=0;y<f.length;++y){let b=y*h,v=m[b];for(let x=0;x<h;++x){let w=m[b+x];(Number.isNaN(w)||w<v)&&(v=w)}f[y]=v}c!=null&&n.disposeIntermediateTensorInfo(u);let g=n.makeTensorInfo(d,u.dtype,f);if(s){let y=T.expandShapeToKeepDim(d,o),b=At({inputs:{x:g},backend:n,attrs:{shape:y}});return n.disposeIntermediateTensorInfo(g),b}return g}var Abe={kernelName:lc,backendName:"cpu",kernelFunc:_be};function Rbe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{paddings:i,mode:s}=r;$e(a,"mirrorPad");let o=i.map((b,v)=>b[0]+a.shape[v]+b[1]),l=i.map(b=>b[0]),c=i.map((b,v)=>b[0]+a.shape[v]),u=s==="reflect"?0:1,d=n.data.get(a.dataId).values,p=a.shape.length,h=k.computeStrides(a.shape),f=k.sizeFromShape(o),m=o.length,g=k.computeStrides(o),y=k.getTypedArrayFromDType(a.dtype,f);for(let b=0;b<f;b++){let v=k.indexToLoc(b,m,g);for(let w=0;w<m;w++)v[w]<l[w]?v[w]=l[w]*2-v[w]-u:v[w]>=c[w]&&(v[w]=(c[w]-1)*2-v[w]+u);v=v.map((w,$)=>w-l[$]);let x=k.locToIndex(v,p,h);y[b]=d[x]}return{dataId:n.write(y,o,a.dtype),shape:o,dtype:a.dtype}}var Dbe={kernelName:cc,backendName:"cpu",kernelFunc:Rbe},Fbe=sn((e,t)=>{let n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t}),Mbe=En(dc,Fbe),Obe={kernelName:dc,backendName:"cpu",kernelFunc:Mbe},Lbe=jo(j0());function v4(e){let{inputs:t,backend:n,attrs:r}=e,{logits:a}=t,{dim:i}=r,s=a.shape.length,o=i;if(o===-1&&(o=s-1),o!==s-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank ".concat(s," and dim was ").concat(o));let l=k.parseAxisParam([o],a.shape),c=b4({inputs:{x:a},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),u=T.expandShapeToKeepDim(c.shape,l),d=At({inputs:{x:c},backend:n,attrs:{shape:u}}),p=eT({inputs:{a,b:d},backend:n}),h=NW({inputs:{x:p},backend:n}),f=Jg({inputs:{x:h},backend:n,attrs:{axis:l,keepDims:!1}}),m=At({inputs:{x:f},backend:n,attrs:{shape:u}}),g=rT({inputs:{a:h,b:m},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),g}var Pbe={kernelName:Fc,backendName:"cpu",kernelFunc:v4};function zbe(e){let{inputs:t,backend:n,attrs:r}=e,{logits:a}=t,{numSamples:i,seed:s,normalized:o}=r;$e(a,"multinomial");let l=o?a:v4({inputs:{logits:a},backend:n,attrs:{dim:-1}}),c=l.shape[0],u=l.shape[1],d=n.data.get(l.dataId).values,p=[c,i],h=k.makeZerosTypedArray(k.sizeFromShape(p),"int32");for(let f=0;f<c;++f){let m=f*u,g=new Float32Array(u-1);g[0]=d[m];for(let v=1;v<g.length;++v)g[v]=g[v-1]+d[m+v];let y=Lbe.alea(s.toString()),b=f*i;for(let v=0;v<i;++v){let x=y();h[b+v]=g.length;for(let w=0;w<g.length;w++)if(x<g[w]){h[b+v]=w;break}}}return o||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(p,"int32",h)}var Bbe={kernelName:lh,backendName:"cpu",kernelFunc:zbe},Wbe=us.nonMaxSuppressionV3Impl;function Ube(e){let{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:i}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l}=r;$e(a,"NonMaxSuppression");let c=n.data.get(a.dataId).values,u=n.data.get(i.dataId).values,{selectedIndices:d}=Wbe(c,u,s,o,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}var Vbe={kernelName:dh,backendName:"cpu",kernelFunc:Ube},Hbe=us.nonMaxSuppressionV4Impl;function jbe(e){let{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:i}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:c}=r;$e(a,"NonMaxSuppressionPadded");let u=n.data.get(a.dataId).values,d=n.data.get(i.dataId).values,{selectedIndices:p,validOutputs:h}=Hbe(u,d,s,o,l,c);return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([],"int32",new Int32Array([h]))]}var Gbe={kernelName:ph,backendName:"cpu",kernelFunc:jbe},qbe=us.nonMaxSuppressionV5Impl;function Kbe(e){let{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:i}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l,softNmsSigma:c}=r;$e(a,"NonMaxSuppressionWithScore");let u=n.data.get(a.dataId).values,d=n.data.get(i.dataId).values,p=s,h=o,f=l,m=c,{selectedIndices:g,selectedScores:y}=qbe(u,d,p,h,f,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}var Xbe={kernelName:hh,backendName:"cpu",kernelFunc:Kbe};function Ybe(e){let{inputs:t,backend:n,attrs:r}=e,{indices:a}=t,{dtype:i,depth:s,onValue:o,offValue:l}=r;$e(a,"oneHot");let c=k.sizeFromShape(a.shape),u=new Float32Array(c*s);u.fill(l);let d=n.data.get(a.dataId).values;for(let p=0;p<c;++p)d[p]>=0&&d[p]<s&&(u[p*s+d[p]]=o);return n.makeTensorInfo([...a.shape,s],i,u)}var Zbe={kernelName:hc,backendName:"cpu",kernelFunc:Ybe};function Uv(e){let{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(r.dtype==="complex64"){let a=uu({inputs:{input:r},backend:n}),i=Uv({inputs:{x:a},backend:n}),s=xp({inputs:{input:r},backend:n}),o=Uv({inputs:{x:s},backend:n}),l=ra({inputs:{real:i,imag:o},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),l}else return aT({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}var Qbe={kernelName:Rh,backendName:"cpu",kernelFunc:Uv};function x4(e){let{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(r.dtype==="complex64"){let a=uu({inputs:{input:r},backend:n}),i=x4({inputs:{x:a},backend:n}),s=xp({inputs:{input:r},backend:n}),o=Uv({inputs:{x:s},backend:n}),l=ra({inputs:{real:i,imag:o},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),l}else return aT({backend:n,attrs:{shape:r.shape,value:1,dtype:r.dtype}})}var Jbe={kernelName:fh,backendName:"cpu",kernelFunc:x4};function w4(e){let{inputs:t,backend:n,attrs:r}=e,{axis:a}=r;if(t.length===1)return Wv({inputs:{input:t[0]},backend:n,attrs:{dim:a}});let i=t[0].shape,s=t[0].dtype;t.forEach(u=>{k.assertShapesMatch(i,u.shape,"All tensors passed to stack must have matching shapes"),k.assert(s===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});let o=[],l=t.map(u=>{let d=Wv({inputs:{input:u},backend:n,attrs:{dim:a}});return o.push(d),d}),c=wp({inputs:l,backend:n,attrs:{axis:a}});return o.forEach(u=>n.disposeIntermediateTensorInfo(u)),c}var eve={kernelName:mh,backendName:"cpu",kernelFunc:w4};function tve(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{paddings:i,constantValue:s}=r;$e(a,"pad");let o=i.map((y,b)=>y[0]+a.shape[b]+y[1]),l=i.map(y=>y[0]),c=n.data.get(a.dataId).values,u=k.sizeFromShape(a.shape),d=a.shape.length,p=k.computeStrides(a.shape),h=k.sizeFromShape(o),f=o.length,m=k.computeStrides(o),g=k.getTypedArrayFromDType(a.dtype,h);s!==0&&g.fill(s);for(let y=0;y<u;y++){let b=k.indexToLoc(y,d,p).map((x,w)=>x+l[w]),v=k.locToIndex(b,f,m);g[v]=c[y]}return{dataId:n.write(g,o,a.dtype),shape:o,dtype:a.dtype}}var k4={kernelName:fc,backendName:"cpu",kernelFunc:tve},nve=sn((e,t)=>Math.pow(e,t)),rve=En(mc,nve),ave={kernelName:mc,backendName:"cpu",kernelFunc:rve};function ive(e){let{inputs:t,backend:n,attrs:r}=e,{paramsNestedSplits:a,paramsDenseValues:i,indices:s}=t,o=a.map(g=>n.data.get(g.dataId).values),l=a.map(g=>g.shape),c=n.data.get(i.dataId).values,u=n.data.get(s.dataId).values,[d,p,h]=qW(o,l,c,i.shape,i.dtype,u,s.shape),f=d.map(g=>n.makeTensorInfo([g.length],"int32",g)),m=n.makeTensorInfo(h,i.dtype,p);return f.concat([m])}var sve={kernelName:rx,backendName:"cpu",kernelFunc:ive};function ove(e){let{inputs:t,backend:n}=e,{starts:r,limits:a,deltas:i}=t,s=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,[c,u]=KW(s,r.shape,r.dtype,o,a.shape,l,i.shape),d=n.makeTensorInfo([c.length],"int32",c),p=n.makeTensorInfo([u.length],r.dtype,u);return[d,p]}var lve={kernelName:ax,backendName:"cpu",kernelFunc:ove};function uve(e){let{inputs:t,backend:n,attrs:r}=e,{shape:a,values:i,defaultValue:s,rowPartitionTensors:o}=t,{rowPartitionTypes:l}=r,c=n.data.get(a.dataId).values,u=n.data.get(i.dataId).values,d=n.data.get(s.dataId).values,p=o.map(g=>n.data.get(g.dataId).values),h=o.map(g=>g.shape),[f,m]=XW(c,a.shape,u,i.shape,i.dtype,d,s.shape,p,h,l);return n.makeTensorInfo(f,i.dtype,m)}var cve={kernelName:ix,backendName:"cpu",kernelFunc:uve};function dve(e){let{backend:t,attrs:n}=e,{start:r,stop:a,dtype:i,step:s}=n,o=X2(r,a,s,i);return t.makeTensorInfo([o.length],i,o)}var pve={kernelName:pg,backendName:"cpu",kernelFunc:dve},hve=mt(bc,e=>1/e),fve={kernelName:bc,backendName:"cpu",kernelFunc:hve};function mve(e){let{inputs:t,backend:n,attrs:r}=e,{images:a}=t,{alignCorners:i,halfPixelCenters:s,size:o}=r;$e(a,"resizeBilinear");let l=k.computeStrides(a.shape),[c,u]=o,[d,p,h,f]=a.shape,m=n.data.get(a.dataId).values,g=new Float32Array(k.sizeFromShape([d,c,u,f])),y=[i&&c>1?p-1:p,i&&u>1?h-1:h],b=[i&&c>1?c-1:c,i&&u>1?u-1:u],v=0,x=y[0]/b[0],w=y[1]/b[1];for(let $=0;$<d;$++)for(let C=0;C<c;C++){let E;s?E=x*(C+.5)-.5:E=x*C;let _=Math.max(0,Math.floor(E)),R=E-_,N=Math.min(p-1,Math.ceil(E)),I=$*l[0]+_*l[1],O=$*l[0]+N*l[1];for(let P=0;P<u;P++){let L;s?L=w*(P+.5)-.5:L=w*P;let U=Math.max(0,Math.floor(L)),D=L-U,F=Math.min(h-1,Math.ceil(L)),z=I+U*l[2],B=O+U*l[2],j=I+F*l[2],Y=O+F*l[2];for(let Q=0;Q<f;Q++){let ae=m[z+Q],se=m[B+Q],fe=m[j+Q],me=m[Y+Q],he=ae+(fe-ae)*D,Te=se+(me-se)*D,Fe=he+(Te-he)*R;g[v++]=Fe}}}return n.makeTensorInfo([d,c,u,f],"float32",g)}var gve={kernelName:wc,backendName:"cpu",kernelFunc:mve};function yve(e){let{inputs:t,backend:n,attrs:r}=e,{images:a,dy:i}=t,{alignCorners:s}=r;$e([i,a],"resizeBilinearGrad");let o=k.computeStrides(a.shape),[l,c,u,d]=a.shape,[,p,h]=i.shape,f=new Float32Array(l*c*u*d),m=[s&&p>1?c-1:c,s&&h>1?u-1:u],g=[s&&p>1?p-1:p,s&&h>1?h-1:h],y=m[0]/g[0],b=m[1]/g[1],v=n.data.get(i.dataId).values,x=0;for(let w=0;w<l;w++){let $=w*o[0];for(let C=0;C<p;C++){let E=C*y,_=Math.floor(E),R=Math.min(Math.ceil(E),c-1),N=$+_*o[1],I=$+R*o[1],O=E-_,P=1-O;for(let L=0;L<h;L++){let U=L*b,D=Math.floor(U),F=Math.min(Math.ceil(U),u-1),z=U-D,B=1-z,j=N+D*o[2],Y=N+F*o[2],Q=I+D*o[2],ae=I+F*o[2],se=P*B,fe=P*z,me=O*B,he=O*z;for(let Te=0;Te<d;Te++){let Fe=v[x++];f[j+Te]+=Fe*se,f[Y+Te]+=Fe*fe,f[Q+Te]+=Fe*me,f[ae+Te]+=Fe*he}}}}return n.makeTensorInfo([l,u,c,d],"float32",f)}var bve={kernelName:bh,backendName:"cpu",kernelFunc:yve};function vve(e){let{inputs:t,backend:n,attrs:r}=e,{images:a}=t,{alignCorners:i,halfPixelCenters:s,size:o}=r;$e(a,"resizeNearestNeighbor");let l=k.computeStrides(a.shape),[c,u]=o,[d,p,h,f]=a.shape,m=n.data.get(a.dataId).values,g=new Float32Array(d*c*u*f),y=[i&&c>1?p-1:p,i&&u>1?h-1:h],b=[i&&c>1?c-1:c,i&&u>1?u-1:u],v=y[0]/b[0],x=y[1]/b[1],w=0;for(let $=0;$<d;$++){let C=$*l[0];for(let E=0;E<c;E++){let _=s?v*(E+.5):v*E,R=Math.min(p-1,i?Math.round(_):Math.floor(_));s&&(R=Math.max(0,R));let N=C+R*l[1];for(let I=0;I<u;I++){let O=s?x*(I+.5):x*I,P=Math.min(h-1,i?Math.round(O):Math.floor(O));s&&(P=Math.max(0,P));let L=N+P*l[2];for(let U=0;U<f;U++){let D=m[L+U];g[w++]=D}}}}return n.makeTensorInfo([d,c,u,f],a.dtype,g)}var xve={kernelName:xc,backendName:"cpu",kernelFunc:vve};function wve(e){let{inputs:t,backend:n,attrs:r}=e,{images:a,dy:i}=t,{alignCorners:s}=r;$e([i,a],"resizeNearestNeighborGrad");let o=k.computeStrides(a.shape),l=k.computeStrides(i.shape),[c,u,d,p]=a.shape,[,h,f]=i.shape,m=new Float32Array(c*u*d*p),g=n.data.get(i.dataId).values,y=[s&&h>1?u-1:u,s&&f>1?d-1:d],b=[s&&h>1?h-1:h,s&&f>1?f-1:f],v=y[0]/b[0],x=y[1]/b[1],w=1/v,$=1/x,C=Math.ceil(w)*2+2,E=Math.ceil($)*2+2;for(let _=0;_<c;_++){let R=_*o[0];for(let N=0;N<u;N++){let I=R+N*o[1],O=Math.floor(N*w),P=Math.floor(O-C/2);for(let L=0;L<d;L++){let U=I+L*o[2],D=Math.floor(L*$),F=Math.floor(D-E/2);for(let z=0;z<p;z++){let B=0;for(let j=0;j<C;j++){let Y=j+P;if(Y<0||Y>=h)continue;let Q=R+Y*l[1],ae=Y*v,se=Math.min(u-1,s?Math.round(ae):Math.floor(ae));if(N===se)for(let fe=0;fe<E;fe++){let me=fe+F;if(me<0||me>=f)continue;let he=Q+me*l[2],Te=me*x,Fe=Math.min(d-1,s?Math.round(Te):Math.floor(Te));L===Fe&&(B+=g[he+z])}}m[U+z]=B}}}}return n.makeTensorInfo(a.shape,a.dtype,m)}var kve={kernelName:yh,backendName:"cpu",kernelFunc:wve};function Sve(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{dims:i}=r;$e(a,"reverse");let s=a.shape.length,o=k.parseAxisParam(i,a.shape);if(s===0)return is({inputs:{x:a},backend:n});let l=new hn(a.shape,a.dtype),c=n.bufferSync(a);for(let u=0;u<l.size;u++){let d=l.indexToLoc(u),p=d.slice();o.forEach(h=>p[h]=a.shape[h]-1-p[h]),l.set(c.get(...p),...d)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}var Ive={kernelName:Sc,backendName:"cpu",kernelFunc:Sve},$ve={kernelName:Dh,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{image:r}=e,{radians:a,fillValue:i,center:s}=t,o=n,l=k.getTypedArrayFromDType(r.dtype,k.sizeFromShape(r.shape)),[c,u,d,p]=r.shape,[h,f]=T.getImageCenter(s,u,d),m=255,g=Math.sin(a),y=Math.cos(a),b=o.data.get(r.dataId).values;for(let v=0;v<c;v++){let x=v*d*u*p;for(let w=0;w<u;w++){let $=w*(d*p);for(let C=0;C<d;C++){let E=C*p;for(let _=0;_<p;_++){let R=[c,w,C,_],N=R[2],I=R[1],O=(N-h)*y-(I-f)*g,P=(N-h)*g+(I-f)*y;O=Math.round(O+h),P=Math.round(P+f);let L=i;if(typeof i!="number"&&(_===3?L=m:L=i[_]),O>=0&&O<d&&P>=0&&P<u){let D=P*(d*p),F=O*p,z=x+D+F+_;L=b[z]}let U=x+$+E+_;l[U]=L}}}}return{dataId:o.write(l,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},Cve=mt(Ic,e=>{let t=Math.floor(e);return e-t<.5?Math.floor(e):e-t>.5?Math.ceil(e):t%2===0?t:t+1}),Eve={kernelName:Ic,backendName:"cpu",kernelFunc:Cve};function Tve(e){let{inputs:t,backend:n,attrs:r}=e,{indices:a,updates:i}=t,{shape:s}=r,{sliceRank:o,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=T.calculateShapes(i,a,s),p=!0,h=n.bufferSync(a),f=n.bufferSync(i),m=Al(h,f,s,d,c,l,o,u,0,p);return n.makeTensorInfo(s,m.dtype,m.values)}var Nve={kernelName:vh,backendName:"cpu",kernelFunc:Tve};function _ve(e,t){let n=0,r=e.length,a=0;for(;n<r;)a=Math.floor((n+r)/2),e[a]<t?n=a+1:r=a;return r}function Ave(e,t){let n=0,r=e.length,a=0;for(;n<r;)a=Math.floor((n+r)/2),e[a]<=t?n=a+1:r=a;return r}function Rve(e,t,n,r,a,i){let s=k.getArrayFromDType("int32",n*a);for(let o=0;o<n;++o){let l=e.slice(o*r,(o+1)*r),c=o*a;for(let u=0;u<a;++u)s[c+u]=i==="left"?_ve(l,t[u+c]):Ave(l,t[u+c])}return s}function Dve(e){let{inputs:t,backend:n,attrs:r}=e,{sortedSequence:a,values:i}=t,{side:s}=r,o=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,c=Rve(o,l,a.shape[0],a.shape[1],i.shape[1],s);return n.makeTensorInfo(i.shape,"int32",c)}var Fve={kernelName:wh,backendName:"cpu",kernelFunc:Dve};function Mve(e){let{inputs:t,backend:n}=e,{condition:r,t:a,e:i}=t;$e([r,a,i],"select");let s=r.shape.length,o=n.data.get(r.dataId).values,l=n.data.get(a.dataId).values,c=n.data.get(i.dataId).values,u=Ra(a.dtype,i.dtype),d=k.makeZerosTypedArray(k.sizeFromShape(a.shape),u),p=0,h=s===0||s>1||a.shape.length===1?1:k.sizeFromShape(a.shape.slice(1));for(let f=0;f<o.length;f++)for(let m=0;m<h;m++)o[f]===1?d[p++]=l[f]:d[p++]=c[f];return n.makeTensorInfo(a.shape,u,d)}var Ove={kernelName:kh,backendName:"cpu",kernelFunc:Mve},Lve=T.SELU_SCALEALPHA,Pve=T.SELU_SCALE,zve=mt(Cc,e=>e>=0?Pve*e:Lve*(Math.exp(e)-1)),Bve={kernelName:Cc,backendName:"cpu",kernelFunc:zve},Wve=mt(Nc,e=>e<0?-1:e>0?1:0),Uve={kernelName:Nc,backendName:"cpu",kernelFunc:Wve},Vve=mt(Ec,e=>Math.sin(e)),Hve={kernelName:Ec,backendName:"cpu",kernelFunc:Vve},jve=mt(Tc,e=>Math.sinh(e)),Gve={kernelName:Tc,backendName:"cpu",kernelFunc:jve},qve=11920928955078125e-23,ZR=Math.log(qve)+2,Kve=mt(Ac,e=>{let t=e>-ZR,n=e<ZR,r=Math.exp(e),a;return n?a=r:t?a=e:a=Math.log(1+r),a}),Xve={kernelName:Ac,backendName:"cpu",kernelFunc:Kve};function Yve(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:i,paddings:s}=r;$e([a],"spaceToBatchND");let o=k.sizeFromShape(i),l=[[0,0]];l.push(...s);for(let g=1+i.length;g<a.shape.length;++g)l.push([0,0]);let c=k4.kernelFunc({inputs:{x:a},backend:n,attrs:{paddings:l,constantValue:0}}),u=T.getReshaped(c.shape,i,o,!1),d=T.getPermuted(u.length,i.length,!1),p=T.getReshapedPermuted(c.shape,i,o,!1),h=At({inputs:{x:c},backend:n,attrs:{shape:u}}),f=Gr({inputs:{x:h},backend:n,attrs:{perm:d}}),m=At({inputs:{x:f},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),m}var Zve={kernelName:Ih,backendName:"cpu",kernelFunc:Yve};function Qve(e){let{inputs:t,backend:n}=e,{indices:r,values:a,denseShape:i,defaultValue:s}=t;if(i.shape.length!==1)throw new Error("Dense shape must be a vector, saw:\n        ".concat(i.shape));if(r.shape.length!==2)throw new Error("Indices must be a matrix, saw:\n        ".concat(r.shape));if(a.shape.length!==1)throw new Error("Values must be a vector, saw:\n        ".concat(a.shape));if(s.shape.length!==0)throw new Error("Default value must be a scalar, saw:\n        ".concat(s.shape));let o=n.data.get(r.dataId).values,l=n.data.get(a.dataId).values,c=n.data.get(i.dataId).values,u=n.data.get(s.dataId).values[0],[d,p,h,f,m]=QW(o,r.shape,r.dtype,l,a.dtype,c,u);return[n.makeTensorInfo(p,r.dtype,d),n.makeTensorInfo([p[0]],a.dtype,h),n.makeTensorInfo([f.length],"bool",new Uint8Array(f.map(g=>Number(g)))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}var Jve={kernelName:hg,backendName:"cpu",kernelFunc:Qve};function e0e(e){let{inputs:t,backend:n}=e,{inputIndices:r,inputShape:a,newShape:i}=t;if(r.shape.length!==2)throw new Error("Input indices should be a matrix but received shape\n        ".concat(r.shape));if(a.shape.length!==1)throw new Error("Input shape should be a vector but received shape\n        ".concat(a.shape));if(i.shape.length!==1)throw new Error("Target shape should be a vector but received shape ".concat(i.shape));let s=Array.from(n.data.get(a.dataId).values),o=n.data.get(r.dataId).values,l=Array.from(n.data.get(i.dataId).values),[c,u,d]=JW(o,r.shape,r.dtype,s,l);return[n.makeTensorInfo(u,r.dtype,c),n.makeTensorInfo([d.length],i.dtype,new Int32Array(d))]}var t0e={kernelName:Ch,backendName:"cpu",kernelFunc:e0e};function n0e(e){let{inputs:t,backend:n}=e,{data:r,indices:a,segmentIds:i}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error("Indices should be a vector but received shape\n          ".concat(a.shape));if(i.shape.length!==1)throw new Error("Segment ids should be a vector but received shape\n          ".concat(i.shape));if(a.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");let s=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,[c,u]=Y2(s,r.shape,r.dtype,o,l,!0);return n.makeTensorInfo(u,r.dtype,c)}var r0e={kernelName:fg,backendName:"cpu",kernelFunc:n0e};function a0e(e){let{inputs:t,backend:n}=e,{data:r,indices:a,segmentIds:i}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error("Indices should be a vector but received shape\n         ".concat(a.shape));if(i.shape.length!==1)throw new Error("Segment ids should be a vector but received shape\n         ".concat(i.shape));if(a.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");let s=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,[c,u]=Y2(s,r.shape,r.dtype,o,l);return n.makeTensorInfo(u,r.dtype,c)}var i0e={kernelName:mg,backendName:"cpu",kernelFunc:a0e};function s0e(e){let{inputs:t,backend:n,attrs:r}=e,{sparseIndices:a,sparseValues:i,defaultValue:s}=t,{outputShape:o}=r,{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:p}=T.calculateShapes(i,a,o),h=!1,f=n.bufferSync(a),m;switch(i.dtype){case"bool":{let g=n.bufferSync(i),y=!!n.data.get(s.dataId).values[0];m=Al(f,g,o,p,u,c,l,d,y,h);break}case"float32":{let g=n.bufferSync(i),y=n.data.get(s.dataId).values[0];m=Al(f,g,o,p,u,c,l,d,y,h);break}case"int32":{let g=n.bufferSync(i),y=n.data.get(s.dataId).values[0];m=Al(f,g,o,p,u,c,l,d,y,h);break}case"string":{let g=n.bufferSync(i),y=k.decodeString(n.data.get(s.dataId).values[0]);m=Al(f,g,o,p,u,c,l,d,y,h);break}default:throw new Error("Unsupported type ".concat(i.dtype))}return n.makeTensorInfo(o,m.dtype,m.values)}var o0e={kernelName:Eh,backendName:"cpu",kernelFunc:s0e};function l0e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{numOrSizeSplits:i,axis:s}=r,o=k.parseAxisParam(s,a.shape)[0],l=T.prepareSplitSize(a,i,o),c=new Array(a.shape.length).fill(0),u=a.shape.slice();return l.map(d=>{let p=[...u];p[o]=d;let h=cu({inputs:{x:a},backend:n,attrs:{begin:c,size:p}});return c[o]+=d,h})}var u0e={kernelName:$h,backendName:"cpu",kernelFunc:l0e},c0e={kernelName:gg,backendName:"cpu",kernelFunc:({inputs:e,backend:t})=>{let{x:n}=e,r=t;$e(n,"square");let a=r.data.get(n.dataId).values,i=new Float32Array(a.length);for(let s=0;s<a.length;++s){let o=a[s];i[s]=o*o}return{dataId:r.write(i,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}},d0e=mt(Xo,(e,t)=>{let n=t;return isNaN(e)?NaN:e>0?1:n.alpha}),p0e={kernelName:Xo,backendName:"cpu",kernelFunc:d0e};function h0e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{begin:i,end:s,strides:o,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:p}=r;$e(a,"stridedSlice");let{finalShapeSparse:h,finalShape:f,isIdentity:m,sliceDim0:g,isSimpleSlice:y,begin:b,end:v,strides:x}=In.sliceInfo(a.shape,i,s,o,l,c,u,d,p),w;if(m)w=At({inputs:{x:a},backend:n,attrs:{shape:f}});else if(g||y){k.assert(a.shape.length>=1,()=>"Input must have rank at least 1, got: ".concat(a.shape.length));let $=In.computeOutShape(b,v,x),C=cu({inputs:{x:a},backend:n,attrs:{begin:b,size:$}});w=At({inputs:{x:C},backend:n,attrs:{shape:f}}),n.disposeIntermediateTensorInfo(C)}else{let $=n.bufferSync(a),C=n4(h,$,x,b);w=n.makeTensorInfo(f,C.dtype,C.values)}return w}var f0e={kernelName:Th,backendName:"cpu",kernelFunc:h0e};function m0e(e){let{inputs:t,backend:n,attrs:r}=e,{separator:a,nGramWidths:i,leftPad:s,rightPad:o,padWidth:l,preserveShortSequences:c}=r,{data:u,dataSplits:d}=t,p=n.data.get(u.dataId).values,h=n.data.get(d.dataId).values,[f,m]=Z2(p,h,a,i,s,o,l,c);return[n.makeTensorInfo([f.length],"string",f),n.makeTensorInfo(d.shape,"int32",m)]}var g0e={kernelName:bg,backendName:"cpu",kernelFunc:m0e};function y0e(e){let{inputs:t,backend:n,attrs:r}=e,{skipEmpty:a}=r,{input:i,delimiter:s}=t;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error("Input must be a vector, got shape: ".concat(i.shape));if(s.shape.length!==0)throw new Error("Delimiter must be a scalar, got shape: ".concat(s.shape));let o=n.data.get(i.dataId).values,l=n.data.get(s.dataId).values[0],[c,u,d]=Q2(o,l,a),p=u.length;return[n.makeTensorInfo([p,2],"int32",c),n.makeTensorInfo([p],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(d))]}var b0e={kernelName:vg,backendName:"cpu",kernelFunc:y0e};function v0e(e){let{inputs:t,backend:n,attrs:r}=e,{numBuckets:a}=r,{input:i}=t;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(a<=0)throw new Error("Number of buckets must be at least 1");let s=n.data.get(i.dataId).values,o=J2(s,a);return n.makeTensorInfo(i.shape,"int32",o)}var x0e={kernelName:xg,backendName:"cpu",kernelFunc:v0e},w0e=mt(Lc,e=>Math.tan(e)),k0e={kernelName:Lc,backendName:"cpu",kernelFunc:w0e},S0e=mt(Pc,e=>Math.tanh(e)),I0e={kernelName:Pc,backendName:"cpu",kernelFunc:S0e};function $0e(e){let{inputs:t,backend:n}=e,{tensor:r,indices:a,updates:i}=t,{sliceRank:s,numUpdates:o,sliceSize:l,strides:c,outputSize:u}=T.calculateShapes(i,a,r.shape),d=!1,p=n.bufferSync(a),h=n.bufferSync(i),f=n.bufferSync(r),m=Al(p,h,r.shape,u,l,o,s,c,f,d);return n.makeTensorInfo(r.shape,m.dtype,m.values)}var C0e={kernelName:xh,backendName:"cpu",kernelFunc:$0e};function E0e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{reps:i}=r;$e(a,"tile");let s=a4(n.bufferSync(a),i);return n.makeTensorInfo(s.shape,s.dtype,s.values)}var T0e={kernelName:Ko,backendName:"cpu",kernelFunc:E0e};function N0e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{k:i,sorted:s}=r;$e(a,"topk");let o=n.data.get(a.dataId).values,[l,c]=s4(o,a.shape,a.dtype,i,s);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(c.shape,c.dtype,c.values)]}var _0e={kernelName:Nh,backendName:"cpu",kernelFunc:N0e};function A0e(e){let{inputs:t,attrs:n,backend:r}=e,{image:a,transforms:i}=t,{interpolation:s,fillMode:o,fillValue:l,outputShape:c}=n,[u,d,p,h]=a.shape,[f,m]=c!=null?c:[d,p],g=[u,f,m,h],y=k.computeStrides(a.shape),b=y[0],v=y[1],x=y[2],w=k.computeStrides(g),$=w[0],C=w[1],E=w[2],_=k.getTypedArrayFromDType(a.dtype,k.sizeFromShape(g));_.fill(l);let R=r.data.get(a.dataId).values,N=r.data.get(i.dataId).values;for(let I=0;I<u;++I){let O=i.shape[0]===1?N:N.subarray(I*8,I*8+8);for(let P=0;P<f;++P)for(let L=0;L<m;++L)for(let U=0;U<h;++U){let D,F=O[6]*L+O[7]*P+1;if(F===0)continue;let z=(O[0]*L+O[1]*P+O[2])/F,B=(O[3]*L+O[4]*P+O[5])/F,j=QR(z,p,o),Y=QR(B,d,o);switch(s){case"nearest":D=L0e(R,d,p,b,v,x,I,Y,j,U,l);break;case"bilinear":D=P0e(R,d,p,b,v,x,I,Y,j,U,l);break;default:throw new Error("Error in Transform: Expect 'nearest' or 'bilinear', but got ".concat(s))}let Q=I*$+P*C+L*E+U;_[Q]=D}return r.makeTensorInfo(g,a.dtype,_)}return{dataId:r.write(_,g,a.dtype),shape:a.shape,dtype:a.dtype}}var R0e={kernelName:_h,backendName:"cpu",kernelFunc:A0e};function QR(e,t,n){switch(n){case"reflect":return D0e(e,t);case"wrap":return F0e(e,t);case"nearest":return O0e(e,t);case"constant":default:return M0e(e)}}function D0e(e,t){let n=e;if(n<0)if(t<=1)n=0;else{let r=2*t;n<r&&(n=r*Math.trunc(-n/r)+n),n=n<-t?n+r:-n-1}else if(n>t-1)if(t<=1)n=0;else{let r=2*t;n-=r*Math.trunc(n/r),n>=t&&(n=r-n-1)}return k.clamp(0,n,t-1)}function F0e(e,t){let n=e;if(n<0)if(t<=1)n=0;else{let r=t-1;n+=t*(Math.trunc(-n/r)+1)}else if(n>t-1)if(t<=1)n=0;else{let r=t-1;n-=t*Math.trunc(n/r)}return k.clamp(0,n,t-1)}function M0e(e,t){return e}function O0e(e,t){return k.clamp(0,e,t-1)}function Tf(e,t,n,r,a,i,s,o,l,c,u){let d=s*r+o*a+l*i+c;return 0<=o&&o<t&&0<=l&&l<n?e[d]:u}function L0e(e,t,n,r,a,i,s,o,l,c,u){let d=Math.round(o),p=Math.round(l);return Tf(e,t,n,r,a,i,s,d,p,c,u)}function P0e(e,t,n,r,a,i,s,o,l,c,u){let d=Math.floor(o),p=Math.floor(l),h=d+1,f=p+1,m=(f-l)*Tf(e,t,n,r,a,i,s,d,p,c,u)+(l-p)*Tf(e,t,n,r,a,i,s,d,f,c,u),g=(f-l)*Tf(e,t,n,r,a,i,s,h,p,c,u)+(l-p)*Tf(e,t,n,r,a,i,s,h,f,c,u);return(h-o)*m+(o-d)*g}function z0e(e){let{inputs:t,attrs:n,backend:r}=e,{axis:a}=n,{x:i}=t;$e(i,"unique");let s=r.data.get(i.dataId).values,{outputValues:o,outputShape:l,indices:c}=tT(s,a,i.shape,i.dtype);return[r.makeTensorInfo(l,i.dtype,o),r.makeTensorInfo([c.length],"int32",c)]}var B0e={kernelName:wg,backendName:"cpu",kernelFunc:z0e};function W0e(e){let{inputs:t,backend:n,attrs:r}=e,{value:a}=t,{axis:i}=r;i<0&&(i+=a.shape.length);let s=a.shape.length,o=a.shape[i],l=new Array(s-1),c=0;for(let h=0;h<s;h++)h!==i&&(l[c++]=a.shape[h]);let u=new Array(s).fill(0),d=a.shape.slice();d[i]=1;let p=new Array(o);for(let h=0;h<p.length;h++){u[i]=h;let f=cu({inputs:{x:a},backend:n,attrs:{begin:u,size:d}});p[h]=At({inputs:{x:f},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(f)}return p}var U0e={kernelName:Ah,backendName:"cpu",kernelFunc:W0e};function V0e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,segmentIds:i}=t,{numSegments:s}=r;$e(a,"unsortedSegmentSum");let o=a.shape.length,l=i.shape.length,c=[],u=[],d=o-l,p=i;for(let f=0;f<d;++f){let m=Wv({inputs:{input:p},backend:n,attrs:{dim:f+1}});p=m,u.push(m)}for(let f=0;f<s;++f){let m=k.createScalarValue(f,"int32"),g=n.makeTensorInfo([],"int32",m),y=EW({inputs:{a:g,b:p},backend:n}),b=zo({inputs:{x:y},backend:n,attrs:{dtype:"float32"}}),v=uw({inputs:{a:b,b:a},backend:n}),x=Jg({inputs:{x:v},backend:n,attrs:{axis:0,keepDims:!1}});c.push(x),u.push(g),u.push(y),u.push(b),u.push(v),u.push(x)}let h=w4({inputs:c,backend:n,attrs:{axis:0}});return u.forEach(f=>n.disposeIntermediateTensorInfo(f)),h}var H0e={kernelName:kg,backendName:"cpu",kernelFunc:V0e},j0e=[Pme,bfe,Bme,Ume,Ife,Hme,Gme,Kme,Yme,Qme,ege,nge,age,oge,uge,pge,fge,gge,bge,Ome,xge,kge,Ige,Cfe,Cge,kfe,Tfe,Tge,vfe,_ge,Rge,Dge,Mge,Lge,zge,Wge,Vge,jge,qge,Xge,Zge,Jge,tye,rye,aye,sye,lye,cye,dye,pye,hye,mye,bye,Nme,xye,Nfe,Tye,_fe,Nye,Rfe,Mye,Oye,Pye,Ffe,Ofe,Bye,Uye,Hye,Gye,Pfe,Bfe,xfe,Kye,Age,Yye,Qye,ebe,_me,Ufe,Hfe,nbe,Gfe,abe,obe,ube,pbe,fbe,gbe,ybe,Kfe,vbe,wbe,Sbe,$be,Ebe,Nbe,Abe,Yfe,Dbe,Obe,Bbe,Qfe,eme,Vbe,Gbe,Xbe,nme,Zbe,Jbe,eve,k4,ave,Rme,ime,sve,lve,cve,pve,wfe,AS,fve,Dme,Fme,Mme,gve,bve,xve,kve,Ive,$ve,Eve,hme,Nve,Fve,Ove,Bve,mme,Uve,Hve,Gve,gme,Pbe,Xve,Zve,Jve,t0e,r0e,i0e,o0e,u0e,vme,c0e,wme,Sme,p0e,f0e,g0e,b0e,x0e,Eme,gye,k0e,I0e,C0e,T0e,_0e,R0e,rme,B0e,U0e,H0e,Qbe];for(let e of j0e)Sg(e);var S4={};Ue(S4,{assertNotComplex:()=>Gh,bindCanvasToFramebuffer:()=>nxe,bindColorTextureToFramebuffer:()=>Ib,bindTextureToProgramUniformSampler:()=>z4,bindTextureUnit:()=>O4,bindVertexBufferToProgramAttribute:()=>DS,callAndCheck:()=>be,canBeRepresented:()=>$4,createFragmentShader:()=>T4,createFramebuffer:()=>M4,createProgram:()=>N4,createStaticIndexBuffer:()=>R4,createStaticVertexBuffer:()=>A4,createTexture:()=>D4,createVertexShader:()=>E4,getBatchDim:()=>du,getExtensionOrThrow:()=>Nf,getFramebufferErrorMessage:()=>B4,getMaxTexturesInShader:()=>H4,getNumChannels:()=>exe,getProgramUniformLocation:()=>P4,getProgramUniformLocationOrThrow:()=>L4,getRowsCols:()=>pu,getShapeAs3D:()=>Af,getTextureShapeFromLogicalShape:()=>U4,getWebGLDisjointQueryTimerVersion:()=>j4,getWebGLErrorMessage:()=>C4,getWebGLMaxTextureSize:()=>V4,hasExtension:()=>Ea,isCapableOfRenderingToFloatTexture:()=>G4,isDownloadFloatTextureEnabled:()=>q4,isReshapeFree:()=>Fm,isWebGLFenceEnabled:()=>K4,isWebGLVersionEnabled:()=>MS,linkProgram:()=>_4,logShaderSourceAndInfoLog:()=>sT,resetMaxTextureSize:()=>rxe,resetMaxTexturesInShader:()=>axe,unbindColorTextureFromFramebuffer:()=>FS,unbindTextureUnit:()=>txe,validateFramebuffer:()=>_f,validateProgram:()=>Sb,validateTextureSize:()=>F4});var Il={},Qy={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function I4(e,t){Il[e]=t}function Mi(e,t){if(!(e in Il)||t!=null){let r=q0e(e,t);if(r!==null)Il[e]=r;else return console.log("Could not get context for WebGL version",e),null}let n=Il[e];return n==null||n.isContextLost()?(delete Il[e],Mi(e)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),Il[e])}function G0e(e){if(!Z().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&e===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function q0e(e,t){if(e!==1&&e!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");let n=t==null?G0e(e):t;return n.addEventListener("webglcontextlost",r=>{r.preventDefault(),delete Il[e]},!1),Z().getBool("SOFTWARE_WEBGL_ENABLED")&&(Qy.failIfMajorPerformanceCaveat=!1),e===1?n.getContext("webgl",Qy)||n.getContext("experimental-webgl",Qy):n.getContext("webgl2",Qy)}var Dm;(function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"})(Dm||(Dm={}));var Ca;(function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"})(Ca||(Ca={}));var jn;(function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(jn||(jn={}));function ey(e,t){return[t,e]}function K0e(e,t){return e*t}function Jy(e){let t=k.sizeFromShape(e),n=Math.ceil(t/4);return k.sizeToSquarishShape(n)}function jh(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function X0e(e,t){let[n,r]=jh(e,t);return n*r*4}function iT(e,t){let n=e,r,a,i,s,o,l,c,u,d,p;return Z().getNumber("WEBGL_VERSION")===2?(r=n.R32F,a=n.R16F,i=n.RGBA16F,s=n.RGBA32F,o=n.RED,c=4,u=1,d=n.HALF_FLOAT,p=n.FLOAT,l=n.RGBA8):(r=e.RGBA,a=e.RGBA,i=e.RGBA,s=n.RGBA,o=e.RGBA,c=4,u=4,d=t!=null?t.HALF_FLOAT_OES:null,p=e.FLOAT,l=e.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:a,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:s,textureFormatFloat:o,downloadTextureFormat:l,downloadUnpackNumChannels:c,defaultNumChannels:u,textureTypeHalfFloat:d,textureTypeFloat:p}}function be(e,t){let n=t();return Z().getBool("DEBUG")&&Y0e(e),n}function Y0e(e){let t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+C4(e,t))}var Z0e=596e-10,Q0e=65504;function $4(e){return!!(Z().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||e===0||Z0e<Math.abs(e)&&Math.abs(e)<Q0e)}function C4(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code ".concat(t)}}function Nf(e,t){return js(e,()=>e.getExtension(t),'Extension "'+t+'" not supported on this browser.')}function E4(e,t){let n=js(e,()=>e.createShader(e.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(be(e,()=>e.shaderSource(n,t)),be(e,()=>e.compileShader(n)),e.getShaderParameter(n,e.COMPILE_STATUS)===!1)throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function T4(e,t){let n=js(e,()=>e.createShader(e.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(be(e,()=>e.shaderSource(n,t)),be(e,()=>e.compileShader(n)),Z().get("ENGINE_COMPILE_ONLY"))return n;if(e.getShaderParameter(n,e.COMPILE_STATUS)===!1)throw sT(t,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}var J0e=/ERROR: [0-9]+:([0-9]+):/g;function sT(e,t){let n=J0e.exec(t);if(n==null){console.log("Couldn't parse line number in error: ".concat(t)),console.log(e);return}let r=+n[1],a=e.split("\n"),i=a.length.toString().length+2,s=a.map((d,p)=>k.rightPad((p+1).toString(),i)+d),o=0;for(let d=0;d<s.length;d++)o=Math.max(s[d].length,o);let l=s.slice(0,r-1),c=s.slice(r-1,r),u=s.slice(r);console.log(l.join("\n")),console.log(t.split("\n")[0]),console.log("%c ".concat(k.rightPad(c[0],o)),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(u.join("\n"))}function N4(e){return js(e,()=>e.createProgram(),"Unable to create WebGLProgram.")}function _4(e,t){if(be(e,()=>e.linkProgram(t)),!Z().get("ENGINE_COMPILE_ONLY")&&e.getProgramParameter(t,e.LINK_STATUS)===!1)throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}function Sb(e,t){if(be(e,()=>e.validateProgram(t)),e.getProgramParameter(t,e.VALIDATE_STATUS)===!1)throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function A4(e,t){let n=js(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return be(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),be(e,()=>e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)),n}function R4(e,t){let n=js(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return be(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n)),be(e,()=>e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)),n}function exe(){return Z().getNumber("WEBGL_VERSION")===2?1:4}function D4(e){return js(e,()=>e.createTexture(),"Unable to create WebGLTexture.")}function F4(e,t){let n=Z().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){let r="[".concat(e,"x").concat(t,"]");throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n){let r="[".concat(e,"x").concat(t,"]"),a="[".concat(n,"x").concat(n,"]");throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+a+".")}}function M4(e){return js(e,()=>e.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function DS(e,t,n,r,a,i,s){let o=e.getAttribLocation(t,n);return o===-1?!1:(be(e,()=>e.bindBuffer(e.ARRAY_BUFFER,r)),be(e,()=>e.vertexAttribPointer(o,a,e.FLOAT,!1,i,s)),be(e,()=>e.enableVertexAttribArray(o)),!0)}function O4(e,t,n){W4(e,n),be(e,()=>e.activeTexture(e.TEXTURE0+n)),be(e,()=>e.bindTexture(e.TEXTURE_2D,t))}function txe(e,t){W4(e,t),be(e,()=>e.activeTexture(e.TEXTURE0+t)),be(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function L4(e,t,n){return js(e,()=>e.getUniformLocation(t,n),'uniform "'+n+'" not present in program.')}function P4(e,t,n){return e.getUniformLocation(t,n)}function z4(e,t,n,r){be(e,()=>O4(e,t,r)),be(e,()=>e.uniform1i(n,r))}function nxe(e){be(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),be(e,()=>e.viewport(0,0,e.canvas.width,e.canvas.height)),be(e,()=>e.scissor(0,0,e.canvas.width,e.canvas.height))}function Ib(e,t,n){be(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,n)),be(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0))}function FS(e,t){be(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,t)),be(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0))}function _f(e){let t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+B4(e,t))}function B4(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error ".concat(t)}}function js(e,t,n){let r=be(e,()=>t());if(r==null)throw new Error(n);return r}function W4(e,t){let n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n){let a="[gl.TEXTURE0, gl.TEXTURE".concat(n,"]");throw new Error("textureUnit must be in ".concat(a,"."))}}function du(e,t=2){return k.sizeFromShape(e.slice(0,e.length-t))}function pu(e){if(e.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function Af(e){let t=[1,1,1];return e.length===0||e.length===1&&e[0]===1||(t=[du(e),...pu(e)]),t}function U4(e,t=!1){let n=Z().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=Z().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&Z().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),t&&(n=n*2,r=r*2,e=e.map((o,l)=>l>=e.length-2?k.nearestLargerEven(e[l]):e[l]),e.length===1&&(e=[2,e[0]])),e.length!==2&&(e=k.squeezeShape(e).newShape);let a=k.sizeFromShape(e),i=null;e.length<=1&&a<=n?i=[1,a]:e.length===2&&e[0]<=n&&e[1]<=n?i=e:e.length===3&&e[0]*e[1]<=n&&e[2]<=n?i=[e[0]*e[1],e[2]]:e.length===3&&e[0]<=n&&e[1]*e[2]<=n?i=[e[0],e[1]*e[2]]:e.length===4&&e[0]*e[1]*e[2]<=n&&e[3]<=n?i=[e[0]*e[1]*e[2],e[3]]:e.length===4&&e[0]<=n&&e[1]*e[2]*e[3]<=n&&(i=[e[0],e[1]*e[2]*e[3]]);let s=i!=null&&Math.max(...i)>r&&Math.min(...i)<=(t?2:1)&&Math.min(...i)>0;if(i==null||s)if(t){let o=du(e),l=2,c=2;e.length&&([l,c]=pu(e)),a=o*(l/2)*(c/2),i=k.sizeToSquarishShape(a).map(u=>u*2)}else i=k.sizeToSquarishShape(a);return i}function eb(e){return e%2===0}function Fm(e,t){if(e=e.slice(-2),t=t.slice(-2),k.arraysEqual(e,t)||!e.length||!t.length||e[0]===0||e[1]===0||t[0]===0||t[1]===0)return!0;if(e.length!==t.length){let n=e[e.length-1],r=t[t.length-1];if(n===r||eb(n)&&eb(r)&&(e[0]===1||t[0]===1))return!0}return e[1]===t[1]&&eb(e[0])&&eb(t[0])}var $b,Cb;function V4(e){if($b==null){let t=Mi(e);$b=t.getParameter(t.MAX_TEXTURE_SIZE)}return $b}function rxe(){$b=null}function axe(){Cb=null}function H4(e){if(Cb==null){let t=Mi(e);Cb=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Cb)}function j4(e){if(e===0)return 0;let t,n=Mi(e);return Ea(n,"EXT_disjoint_timer_query_webgl2")&&e===2?t=2:Ea(n,"EXT_disjoint_timer_query")?t=1:t=0,t}function Ea(e,t){return e.getExtension(t)!=null}function MS(e){try{if(Mi(e)!=null)return!0}catch(t){return console.log("Error when getting WebGL context: ",t),!1}return!1}function G4(e){if(e===0)return!1;let t=Mi(e);if(e===1){if(!Ea(t,"OES_texture_float"))return!1}else if(!Ea(t,"EXT_color_buffer_float"))return!1;return OS(t)}function q4(e){if(e===0)return!1;let t=Mi(e);if(e===1){if(!Ea(t,"OES_texture_float")||!Ea(t,"WEBGL_color_buffer_float"))return!1}else{if(Ea(t,"EXT_color_buffer_float"))return OS(t);let n="EXT_color_buffer_half_float";if(Ea(t,n)){let r=t.getExtension(n);return ixe(t,r)}return!1}return OS(t)}function OS(e){let t=iT(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n);let r=1,a=1;e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,r,a,0,t.textureFormatFloat,t.textureTypeFloat,null);let i=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,i),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);let s=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(i),s}function ixe(e,t){let n=iT(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r);let a=1,i=1;e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,a,i,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);let s=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,s),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);let o=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(s),o}function K4(e){return e!==2?!1:Mi(e).fenceSync!=null}function Gh(e,t){Array.isArray(e)||(e=[e]),e.forEach(n=>{n!=null&&k.assert(n.dtype!=="complex64",()=>"".concat(t," does not support complex64 tensors in the WebGL backend."))})}var Ee=Z();Ee.registerFlag("HAS_WEBGL",()=>Ee.getNumber("WEBGL_VERSION")>0);Ee.registerFlag("WEBGL_VERSION",()=>MS(2)?2:MS(1)?1:0);Ee.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Ee.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Ee.get("WEBGL_VERSION")===2);Ee.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Ee.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Ee.registerFlag("WEBGL_PACK",()=>Ee.getBool("HAS_WEBGL"));Ee.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Ee.getBool("WEBGL_PACK"));Ee.registerFlag("WEBGL_PACK_CLIP",()=>Ee.getBool("WEBGL_PACK"));Ee.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Ee.getBool("WEBGL_PACK"));Ee.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Ee.getBool("WEBGL_PACK"));Ee.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Ee.getBool("WEBGL_PACK"));Ee.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Ee.getBool("WEBGL_PACK"));Ee.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Ee.getBool("WEBGL_PACK"));Ee.registerFlag("WEBGL_PACK_REDUCE",()=>Ee.getBool("WEBGL_PACK"));Ee.registerFlag("WEBGL_LAZILY_UNPACK",()=>Ee.getBool("WEBGL_PACK"));Ee.registerFlag("WEBGL_CONV_IM2COL",()=>Ee.getBool("WEBGL_PACK"));Ee.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>V4(Ee.getNumber("WEBGL_VERSION")));Ee.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>H4(Ee.getNumber("WEBGL_VERSION")));Ee.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{let e=Ee.getNumber("WEBGL_VERSION");return e===0?0:j4(e)});Ee.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Ee.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!Cg.isMobile());Ee.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>G4(Ee.getNumber("WEBGL_VERSION")));Ee.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Ee.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Ee.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Ee.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>q4(Ee.getNumber("WEBGL_VERSION")));Ee.registerFlag("WEBGL_FENCE_API_ENABLED",()=>K4(Ee.getNumber("WEBGL_VERSION")));Ee.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Ee.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Ee.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,e=>{if(e<0&&e!==-1)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ".concat(e,"."))});Ee.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>Cg.isMobile()?1:-1,e=>{if(e<0&&e!==-1)throw new Error("WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ".concat(e,"."))});Ee.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);Ee.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);Ee.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);Ee.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);Ee.registerFlag("WEBGL_EXP_CONV",()=>!1);Ee.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Ee.getBool("IS_TEST"));Ee.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);Ee.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);Ee.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);Ee.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);function Fr(){let e,t,n,r,a,i,s,o,l,c;return Z().getNumber("WEBGL_VERSION")===2?(e="#version 300 es",t="in",n="out",r="in",a="texture",i="outputColor",s="out vec4 outputColor;",o=Z().getBool("WEBGL2_ISNAN_CUSTOM")?"\n      bool isnan_custom(float val) {\n        uint floatToUint = floatBitsToUint(val);\n        return (floatToUint & 0x7fffffffu) > 0x7f800000u;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ":"",l="",c="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(e="",t="attribute",n="varying",r="varying",a="texture2D",i="gl_FragColor",s="",o="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",l="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",c="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:a,output:i,defineOutput:s,defineSpecialNaN:o,defineSpecialInf:l,defineRound:c}}function Gc(e,t,n="index"){let r=k.computeStrides(t);return r.map((a,i)=>{let s="int ".concat(e[i]," = ").concat(n," / ").concat(a),o=i===r.length-1?"int ".concat(e[i+1]," = ").concat(n," - ").concat(e[i]," * ").concat(a):"index -= ".concat(e[i]," * ").concat(a);return"".concat(s,"; ").concat(o,";")}).join("")}function cw(e,t,n="index"){let r=k.computeStrides(t);return r.map((a,i)=>{let s="int ".concat(e[i]," = ").concat(n," / outShapeStrides[").concat(i,"]"),o=i===r.length-1?"int ".concat(e[i+1]," = ").concat(n," - ").concat(e[i]," * outShapeStrides[").concat(i,"]"):"index -= ".concat(e[i]," * outShapeStrides[").concat(i,"]");return"".concat(s,"; ").concat(o,";")}).join("")}function sxe(e,t){let n=e.length,r=e.map(i=>"".concat(t,"[").concat(i,"]")),a=new Array(n-1);a[n-2]=r[n-1];for(let i=n-3;i>=0;--i)a[i]="(".concat(a[i+1]," * ").concat(r[i+1],")");return a}function oxe(e,t,n="index"){let r=e.map((i,s)=>s),a=sxe(r,t);return a.map((i,s)=>{let o="int ".concat(e[s]," = ").concat(n," / ").concat(a[s]),l=s===a.length-1?"int ".concat(e[s+1]," = ").concat(n," - ").concat(e[s]," * ").concat(a[s]):"index -= ".concat(e[s]," * ").concat(a[s]);return"".concat(o,"; ").concat(l,";")}).join("")}function oT(e){let t=k.computeStrides(e).map(n=>n.toString());return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ".concat(t[0]," + coords.y * ").concat(t[1]," + coords.z;\n  }\n")}function lT(){return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n"}var X4="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",{getBroadcastDims:Y4}=T;function lxe(e,t,n){let r=[];if(e.forEach(p=>{let h=k.sizeFromShape(p.shapeInfo.logicalShape);if(p.shapeInfo.isUniform?r.push("uniform float ".concat(p.name).concat(h>1?"[".concat(h,"]"):"",";")):(r.push("uniform sampler2D ".concat(p.name,";")),r.push("uniform int offset".concat(p.name,";"))),n.enableShapeUniforms){let{uniformShape:f}=uT(n.packedInputs,p.shapeInfo.logicalShape,p.shapeInfo.texShape);switch(f.length){case 1:r.push("uniform int ".concat(p.name,"Shape;"));break;case 2:r.push("uniform ivec2 ".concat(p.name,"Shape;"));break;case 3:r.push("uniform ivec3 ".concat(p.name,"Shape;"));break;case 4:r.push("uniform ivec4 ".concat(p.name,"Shape;"));break}r.push("uniform ivec2 ".concat(p.name,"TexShape;"))}}),n.enableShapeUniforms){switch(t.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;");break}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(p=>{r.push("uniform ".concat(p.type," ").concat(p.name).concat(p.arrayIndex?"[".concat(p.arrayIndex,"]"):"",";"))});let a=r.join("\n"),i=e.map(p=>uxe(p,t,n.packedInputs,n.enableShapeUniforms)).join("\n"),s=t.texShape,o=Fr(),l=pxe(o),c,u,d=mxe(o);return t.isPacked?(c=cxe(t.logicalShape,s,n.enableShapeUniforms),u=fxe(o)):(c=dxe(t.logicalShape,s,n.enableShapeUniforms),u=hxe(o)),n.packedInputs&&(d+=vxe),[d,l,u,a,c,i,n.userCode].join("\n")}function qh(e,t=!1){let n=e.shapeInfo.logicalShape;switch(n.length){case 0:return Axe(e,t);case 1:return Dxe(e,t);case 2:return Mxe(e,t);case 3:return Lxe(e,t);case 4:return zxe(e,t);case 5:return Bxe(e);case 6:return Wxe(e);default:throw new Error("".concat(n.length,"-D input sampling is not yet supported"))}}function Z4(e,t){switch(e.shapeInfo.logicalShape.length){case 0:return _xe(e);case 1:return Rxe(e,t);case 2:return Fxe(e,t);case 3:return Oxe(e,t);default:return Pxe(e,t)}}function uxe(e,t,n=!1,r){let a="";n?a+=Z4(e,r):a+=qh(e,r);let i=e.shapeInfo.logicalShape,s=t.logicalShape;return i.length<=s.length&&(n?a+=Uxe(e,t):a+=Vxe(e,t)),a}function cxe(e,t,n){switch(e.length){case 0:return Q4();case 1:return xxe(e,t,n);case 2:return Txe(e,t,n);case 3:return kxe(e,t,n);default:return Ixe(e,t,n)}}function dxe(e,t,n){switch(e.length){case 0:return Q4();case 1:return wxe(e,t,n);case 2:return Nxe(e,t,n);case 3:return Sxe(e,t,n);case 4:return $xe(e,t,n);case 5:return Cxe(e,t);case 6:return Exe(e,t);default:throw new Error("".concat(e.length,"-D output sampling is not yet supported"))}}function pxe(e){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ".concat(e.texture2D,"(textureSampler, uv).r;\n    }\n  ")}function hxe(e){return"\n    void setOutput(float val) {\n      ".concat(e.output," = vec4(val, 0, 0, 0);\n    }\n  ")}function fxe(e){return"\n    void setOutput(vec4 val) {\n      ".concat(e.output," = val;\n    }\n  ")}function mxe(e){return"".concat(e.version,"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ").concat(e.varyingFs," vec2 resultUV;\n    ").concat(e.defineOutput,"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ").concat(e.defineSpecialNaN,"\n    ").concat(e.defineSpecialInf,"\n    ").concat(e.defineRound,"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ").concat(gxe,"\n    ").concat(yxe,"\n    ").concat(bxe,"\n  ")}var gxe="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",yxe="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",bxe="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",vxe="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function Q4(){return"\n    int getOutputCoords() {\n      return 0;\n    }\n  "}function xxe(e,t,n){let r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];return r[0]===1?n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ".concat(r[1],".0);\n      }\n    "):r[1]===1?n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ".concat(r[0],".0);\n      }\n    "):n?"\n    int getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);\n    }\n  ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n      return 2 * (resTexRC.x * ").concat(r[1]," + resTexRC.y);\n    }\n  ")}function wxe(e,t,n){return t[0]===1?n?"\n      int getOutputCoords() {\n        return int(resultUV.x * float(outTexShape[1]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.x * ".concat(t[1],".0);\n      }\n    "):t[1]===1?n?"\n      int getOutputCoords() {\n        return int(resultUV.y * float(outTexShape[0]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.y * ".concat(t[0],".0);\n      }\n    "):n?"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      return resTexRC.x * outTexShape[1] + resTexRC.y;\n    }\n  ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      return resTexRC.x * ").concat(t[1]," + resTexRC.y;\n    }\n  ")}function kxe(e,t,n){if(n)return"\n    ivec3 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";let r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],a=Math.ceil(e[2]/2),i=a*Math.ceil(e[1]/2);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n\n      int b = index / ").concat(i,";\n      index -= b * ").concat(i,";\n\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ")}function Sxe(e,t,n){if(n)return"\n  ivec3 getOutputCoords() {\n    ivec2 resTexRC = ivec2(resultUV.yx *\n                           vec2(outTexShape[0], outTexShape[1]));\n    int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n    ".concat(cw(["r","c","d"],e),"\n    return ivec3(r, c, d);\n  }\n");let r=Gc(["r","c","d"],e);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(r,"\n      return ivec3(r, c, d);\n    }\n  ")}function Ixe(e,t,n){if(n)return"\n    ivec4 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatchN = texelsInBatch * outShape[1];\n\n      int b2 = index / texelsInBatchN;\n      index -= b2 * texelsInBatchN;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec4(b2, b, r, c);\n    }\n  ";let r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],a=Math.ceil(e[e.length-1]/2),i=a*Math.ceil(e[e.length-2]/2),s=i,o="",l="b, r, c";for(let c=2;c<e.length-1;c++)s*=e[e.length-c-1],o="\n      int b".concat(c," = index / ").concat(s,";\n      index -= b").concat(c," * ").concat(s,";\n    ")+o,l="b".concat(c,", ")+l;return"\n    ivec".concat(e.length," getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(").concat(r[0],", ").concat(r[1],"));\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n\n      ").concat(o,"\n\n      int b = index / ").concat(i,";\n      index -= b * ").concat(i,";\n\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec").concat(e.length,"(").concat(l,");\n    }\n  ")}function $xe(e,t,n){if(n)return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      ".concat(cw(["r","c","d","d2"],e),"\n      return ivec4(r, c, d, d2);\n    }\n  ");let r=Gc(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(r,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}function Cxe(e,t){let n=Gc(["r","c","d","d2","d3"],e);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(".concat(t[0],",\n                             ").concat(t[1],"));\n\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  ")}function Exe(e,t){let n=Gc(["r","c","d","d2","d3","d4"],e);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  ")}function Txe(e,t,n){let r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(k.arraysEqual(e,t))return n?"\n      ivec2 getOutputCoords() {\n        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(".concat(r[0],", ").concat(r[1],"));\n      }\n    ");let a=Math.ceil(e[1]/2);return n?"\n    ivec2 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec2(r, c);\n    }\n  ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec2(r, c);\n    }\n  ")}function Nxe(e,t,n){return k.arraysEqual(e,t)?n?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(".concat(t[0],", ").concat(t[1],"));\n      }\n    "):e[1]===1?n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    "):e[0]===1?n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(0, index);\n      }\n    "):n?"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      int r = index / outShape[1];\n      int c = index - r * outShape[1];\n      return ivec2(r, c);\n    }\n  ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      int r = index / ").concat(e[1],";\n      int c = index - r * ").concat(e[1],";\n      return ivec2(r, c);\n    }\n  ")}function qc(e){return"offset".concat(e)}function _xe(e){let t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=Fr();return"\n    vec4 ".concat(n,"() {\n      return ").concat(r.texture2D,"(").concat(t,", halfCR);\n    }\n  ")}function Axe(e,t){let n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return"float ".concat(r,"() {return ").concat(n,";}");let[a,i]=e.shapeInfo.texShape;if(a===1&&i===1)return"\n      float ".concat(r,"() {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");let s=qc(n);if(t)return"\n    float ".concat(r,"() {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");let[o,l]=e.shapeInfo.texShape;return"\n    float ".concat(r,"() {\n      vec2 uv = uvFromFlat(").concat(o,", ").concat(l,", ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}function Rxe(e,t){let n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape,i=Fr();if(t)return"\n    vec4 ".concat(r,"(int index) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      vec2 uv = packedUVfrom1D(\n        packedTexShape[0], packedTexShape[1], index);\n      return ").concat(i.texture2D,"(").concat(n,", uv);\n    }\n  ");let s=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];return"\n    vec4 ".concat(r,"(int index) {\n      vec2 uv = packedUVfrom1D(\n        ").concat(s[0],", ").concat(s[1],", index);\n      return ").concat(i.texture2D,"(").concat(n,", uv);\n    }\n  ")}function Dxe(e,t){let n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int index) {\n        ").concat(Kh(e),"\n      }\n    ");let a=e.shapeInfo.texShape,i=a[0],s=a[1];if(s===1&&i===1)return"\n      float ".concat(r,"(int index) {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");let o=qc(n);return s===1?t?"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(o,") + 0.5) / float(").concat(n,"TexShape[0]));\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(o,") + 0.5) / ").concat(i,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):i===1?t?"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(o,") + 0.5) / float(").concat(n,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(o,") + 0.5) / ").concat(s,".0, 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):t?"\n    float ".concat(r,"(int index) {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], index + ").concat(o,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  "):"\n    float ".concat(r,"(int index) {\n      vec2 uv = uvFromFlat(").concat(i,", ").concat(s,", index + ").concat(o,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}function Fxe(e,t){let n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape,s=i[0],o=i[1],l=Fr();if(i!=null&&k.arraysEqual(n,i))return t?"\n      vec4 ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n\n        return ").concat(l.texture2D,"(").concat(r,", uv);\n      }\n    "):"\n      vec4 ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(o,".0, ").concat(s,".0);\n\n        return ").concat(l.texture2D,"(").concat(r,", uv);\n      }\n    ");if(t)return"\n    vec4 ".concat(a,"(int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(r,"TexShape[0]) / 2.0), ceil(float(").concat(r,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(r,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);\n      return ").concat(l.texture2D,"(").concat(r,", uv);\n    }\n  ");let c=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],u=Math.ceil(n[1]/2);return"\n    vec4 ".concat(a,"(int row, int col) {\n      vec2 uv = packedUVfrom2D(").concat(u,", ").concat(c[0],", ").concat(c[1],", row, col);\n      return ").concat(l.texture2D,"(").concat(r,", uv);\n    }\n  ")}function Mxe(e,t){let n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape;if(i!=null&&k.arraysEqual(n,i)){if(t)return"\n      float ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");let p=i[0],h=i[1];return"\n    float ".concat(a,"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(h,".0, ").concat(p,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ")}let{newShape:s,keptDims:o}=k.squeezeShape(n),l=s;if(l.length<n.length){let p=Xh(e,l),h=["row","col"];return"\n      ".concat(qh(p,t),"\n      float ").concat(a,"(int row, int col) {\n        return ").concat(a,"(").concat(Yh(h,o),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(").concat(n[1],", 1)));\n        ").concat(Kh(e),"\n      }\n    ");let c=i[0],u=i[1],d=qc(r);return u===1?t?"\n      float ".concat(a,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(d,"), vec3(").concat(r,"Shape[1], 1, 1));\n        vec2 uv = vec2(0.5, (index + 0.5) / float(").concat(r,"TexShape[0]));\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(d,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ").concat(c,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  "):c===1?t?"\n      float ".concat(a,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(d,"), vec3(").concat(r,"Shape[1], 1, 1));\n        vec2 uv = vec2((index + 0.5) / float(").concat(r,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(d,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2((index + 0.5) / ").concat(u,".0, 0.5);\n      return sampleTexture(").concat(r,", uv);\n    }\n  "):t?"\n      float ".concat(a,"(int row, int col) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(r,"Shape[1] + col + ").concat(d,";\n        vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n  float ".concat(a,"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ").concat(n[1]," + col + ").concat(d,";\n    vec2 uv = uvFromFlat(").concat(c,", ").concat(u,", index);\n    return sampleTexture(").concat(r,", uv);\n  }\n")}function Oxe(e,t){let n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape,s=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(n[0]===1){let p=n.slice(1),h=[1,2],f=Xh(e,p),m=["b","row","col"];return"\n        ".concat(Z4(f,t),"\n        vec4 ").concat(a,"(int b, int row, int col) {\n          return ").concat(a,"(").concat(Yh(m,h),");\n        }\n      ")}let o=Fr();if(t)return"\n    vec4 ".concat(a,"(int b, int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(r,"TexShape[0]) / 2.0), ceil(float(").concat(r,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(r,"Shape[2]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(r,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom3D(\n        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);\n      return ").concat(o.texture2D,"(").concat(r,", uv);\n    }\n  ");let l=s[0],c=s[1],u=Math.ceil(n[2]/2),d=u*Math.ceil(n[1]/2);return"\n    vec4 ".concat(a,"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ").concat(l,", ").concat(c,", ").concat(d,", ").concat(u,", b, row, col);\n      return ").concat(o.texture2D,"(").concat(r,", uv);\n    }\n  ")}function Lxe(e,t){let n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[1]*n[2],s=n[2],{newShape:o,keptDims:l}=k.squeezeShape(n),c=o;if(c.length<n.length){let m=Xh(e,c),g=["row","col","depth"];return"\n        ".concat(qh(m,t),"\n        float ").concat(a,"(int row, int col, int depth) {\n          return ").concat(a,"(").concat(Yh(g,l),");\n        }\n      ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(").concat(i,", ").concat(s,", 1)));\n        ").concat(Kh(e),"\n      }\n    ");let u=e.shapeInfo.texShape,d=u[0],p=u[1],h=e.shapeInfo.flatOffset;if(p===i&&h==null)return t?"\n      float ".concat(a,"(int row, int col, int depth) {\n        int stride1 = ").concat(r,"Shape[2];\n        float texR = float(row);\n        float texC = dot(vec2(col, depth), vec2(stride1, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n        float ".concat(a,"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(").concat(s,", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(").concat(p,".0, ").concat(d,".0);\n          return sampleTexture(").concat(r,", uv);\n        }\n      ");if(p===s&&h==null)return t?"\n      float ".concat(a,"(int row, int col, int depth) {\n        float texR = dot(vec2(row, col), vec2(").concat(r,"Shape[1], 1));\n        float texC = float(depth);\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(").concat(n[1],", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(p,".0, ").concat(d,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");let f=qc(r);return t?"\n    float ".concat(a,"(int row, int col, int depth) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int stride0 = ").concat(r,"Shape[1] * ").concat(r,"Shape[2];\n      int stride1 = ").concat(r,"Shape[2];\n      int index = row * stride0 + col * stride1 + depth + ").concat(f,";\n      vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index);\n      return sampleTexture(").concat(r,", uv);\n    }\n    "):"\n      float ".concat(a,"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(i," + col * ").concat(s," + depth + ").concat(f,";\n        vec2 uv = uvFromFlat(").concat(d,", ").concat(p,", index);\n        return sampleTexture(").concat(r,", uv);\n      }\n  ")}function Pxe(e,t){let n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=Fr();if(t)return"\n    vec4 ".concat(r,"(int b2, int b, int row, int col) {\n      int valuesPerRow = int(ceil(float(").concat(n,"Shape[3]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(n,"Shape[2]) / 2.0));\n      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);\n      texelsInBatch *= ").concat(n,"Shape[1];\n      index = b2 * texelsInBatch + index;\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      int texR = index / packedTexShape[1];\n      int texC = index - texR * packedTexShape[1];\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ").concat(a.texture2D,"(").concat(n,", uv);\n    }\n  ");let i=e.shapeInfo.logicalShape,s=i.length,o=e.shapeInfo.texShape,l=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],c=l[0],u=l[1],d=Math.ceil(i[s-1]/2),p=d*Math.ceil(i[s-2]/2),h="int b, int row, int col",f="b * ".concat(p," + (row / 2) * ").concat(d," + (col / 2)");for(let m=2;m<s-1;m++)h="int b".concat(m,", ")+h,p*=i[s-m-1],f="b".concat(m," * ").concat(p," + ")+f;return"\n    vec4 ".concat(r,"(").concat(h,") {\n      int index = ").concat(f,";\n      int texR = index / ").concat(u,";\n      int texC = index - texR * ").concat(u,";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(u,", ").concat(c,");\n      return ").concat(a.texture2D,"(").concat(n,", uv);\n    }\n  ")}function zxe(e,t){let n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[3],s=n[2]*i,o=n[1]*s,{newShape:l,keptDims:c}=k.squeezeShape(n);if(l.length<n.length){let b=Xh(e,l),v=["row","col","depth","depth2"];return"\n      ".concat(qh(b,t),"\n      float ").concat(a,"(int row, int col, int depth, int depth2) {\n        return ").concat(a,"(").concat(Yh(v,c),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(").concat(o,", ").concat(s,", ").concat(i,", 1)));\n        ").concat(Kh(e),"\n      }\n    ");let u=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,p=d[0],h=d[1],f="int stride2 = ".concat(r,"Shape[3];"),m="int stride1 = ".concat(r,"Shape[2] * stride2;"),g="int stride0 = ".concat(r,"Shape[1] * stride1;");if(h===o&&u==null)return t?"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        ").concat(f,"\n        ").concat(m,"\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(stride1, stride2, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(").concat(s,", ").concat(i,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(h,".0, ").concat(p,".0);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");if(h===i&&u==null)return t?"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(r,"Shape[1] * ").concat(r,"Shape[2], ").concat(r,"Shape[2], 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(n[1]*n[2],", ").concat(n[2],", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(h,".0, ").concat(p,".0);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");let y=qc(r);return t?"\n    float ".concat(a,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      ").concat(f,"\n      ").concat(m,"\n      ").concat(g,"\n      int index = row * stride0 + col * stride1 +\n          depth * stride2 + depth2;\n      vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index + ").concat(y,");\n      return sampleTexture(").concat(r,", uv);\n    }\n  "):"\n    float ".concat(a,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(o," + col * ").concat(s," +\n          depth * ").concat(i," + depth2;\n      vec2 uv = uvFromFlat(").concat(p,", ").concat(h,", index + ").concat(y,");\n      return sampleTexture(").concat(r,", uv);\n    }\n  ")}function Bxe(e){let t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[4],i=t[3]*a,s=t[2]*i,o=t[1]*s,{newShape:l,keptDims:c}=k.squeezeShape(t);if(l.length<t.length){let m=Xh(e,l),g=["row","col","depth","depth2","depth3"];return"\n      ".concat(qh(m),"\n      float ").concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        return ").concat(r,"(").concat(Yh(g,c),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(o,", ").concat(s,", ").concat(i,", ").concat(a,")) +\n          depth3;\n        ").concat(Kh(e),"\n      }\n    ");let u=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,p=d[0],h=d[1];if(h===o&&u==null)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(").concat(s,", ").concat(i,", ").concat(a,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(h,".0, ").concat(p,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(h===a&&u==null)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3],",\n               ").concat(t[2]*t[3],", ").concat(t[3],", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(h,".0, ").concat(p,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");let f=qc(n);return"\n    float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(o," + col * ").concat(s," + depth * ").concat(i," +\n          depth2 * ").concat(a," + depth3 + ").concat(f,";\n      vec2 uv = uvFromFlat(").concat(p,", ").concat(h,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}function Wxe(e){let t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:a,keptDims:i}=k.squeezeShape(t);if(a.length<t.length){let g=Xh(e,a),y=["row","col","depth","depth2","depth3","depth4"];return"\n      ".concat(qh(g),"\n      float ").concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ").concat(r,"(").concat(Yh(y,i),");\n      }\n    ")}let s=t[5],o=t[4]*s,l=t[3]*o,c=t[2]*l,u=t[1]*c;if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(u,", ").concat(c,", ").concat(l,", ").concat(o,")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(").concat(s,", 1)));\n        ").concat(Kh(e),"\n      }\n    ");let d=e.shapeInfo.flatOffset,p=e.shapeInfo.texShape,h=p[0],f=p[1];if(f===u&&d==null)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(").concat(c,", ").concat(l,", ").concat(o,", ").concat(s,")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(f,".0, ").concat(h,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(f===s&&d==null)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3]*t[4],",\n               ").concat(t[2]*t[3]*t[4],",\n               ").concat(t[3]*t[4],",\n               ").concat(t[4],")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(f,".0, ").concat(h,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");let m=qc(n);return"\n    float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(u," + col * ").concat(c," + depth * ").concat(l," +\n          depth2 * ").concat(o," + depth3 * ").concat(s," + depth4 + ").concat(m,";\n      vec2 uv = uvFromFlat(").concat(h,", ").concat(f,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}function Kh(e){let t=e.name,n=k.sizeFromShape(e.shapeInfo.logicalShape);return n<2?"return ".concat(t,";"):"\n    for (int i = 0; i < ".concat(n,"; i++) {\n      if (i == index) {\n        return ").concat(t,"[i];\n      }\n    }\n  ")}function Uxe(e,t){let n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",i=e.shapeInfo.logicalShape.length,s=t.logicalShape.length,o=Y4(e.shapeInfo.logicalShape,t.logicalShape),l=St(s),c=s-i,u,d=["x","y","z","w","u","v"];i===0?u="":s<2&&o.length>=1?u="coords = 0;":u=o.map(g=>"coords.".concat(d[g+c]," = 0;")).join("\n");let p="";s<2&&i>0?p="coords":p=e.shapeInfo.logicalShape.map((g,y)=>"coords.".concat(d[y+c])).join(", ");let h="return outputValue;",f=k.sizeFromShape(e.shapeInfo.logicalShape)===1,m=k.sizeFromShape(t.logicalShape)===1;if(i===1&&!f&&!m)h="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";else if(f&&!m)s===1?h="\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":h="\n        return vec4(outputValue.x);\n      ";else if(o.length){let g=i-2,y=i-1;o.indexOf(g)>-1&&o.indexOf(y)>-1?h="return vec4(outputValue.x);":o.indexOf(g)>-1?h="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":o.indexOf(y)>-1&&(h="return vec4(outputValue.xx, outputValue.zz);")}return"\n    vec4 ".concat(a,"() {\n      ").concat(l," coords = getOutputCoords();\n      ").concat(u,"\n      vec4 outputValue = get").concat(r,"(").concat(p,");\n      ").concat(h,"\n    }\n  ")}function Vxe(e,t){let n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",i=t.texShape,s=e.shapeInfo.texShape,o=e.shapeInfo.logicalShape.length,l=t.logicalShape.length;if(!e.shapeInfo.isUniform&&o===l&&e.shapeInfo.flatOffset==null&&k.arraysEqual(s,i))return"\n      float ".concat(a,"() {\n        return sampleTexture(").concat(n,", resultUV);\n      }\n    ");let c=St(l),u=Y4(e.shapeInfo.logicalShape,t.logicalShape),d=l-o,p,h=["x","y","z","w","u","v"];o===0?p="":l<2&&u.length>=1?p="coords = 0;":p=u.map(m=>"coords.".concat(h[m+d]," = 0;")).join("\n");let f="";return l<2&&o>0?f="coords":f=e.shapeInfo.logicalShape.map((m,g)=>"coords.".concat(h[g+d])).join(", "),"\n    float ".concat(a,"() {\n      ").concat(c," coords = getOutputCoords();\n      ").concat(p,"\n      return get").concat(r,"(").concat(f,");\n    }\n  ")}function St(e){if(e<=1)return"int";if(e===2)return"ivec2";if(e===3)return"ivec3";if(e===4)return"ivec4";if(e===5)return"ivec5";if(e===6)return"ivec6";throw Error("GPU for rank ".concat(e," is not yet supported"))}function uT(e,t,n){let{newShape:r,keptDims:a}=k.squeezeShape(t),i=t.length,s=e&&i===3&&t[0]===1,o=s?t.slice(1):r,l=!e&&i>1&&!k.arraysEqual(t,n)&&r.length<i||s;return{useSqueezeShape:l,uniformShape:l?o:t,keptDims:a}}function Xh(e,t){let n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function Yh(e,t){return t.map(n=>e[n]).join(", ")}function Hxe(e,t,n,r){let a=n.map((u,d)=>{let p={logicalShape:u.shape,texShape:u.isUniform?null:u.texData.texShape,isUniform:u.isUniform,isPacked:u.isUniform?!1:u.texData.isPacked,flatOffset:null};return u.texData!=null&&u.texData.slice!=null&&u.texData.slice.flatOffset>0&&(p.flatOffset=u.texData.slice.flatOffset),{name:t.variableNames[d],shapeInfo:p}}),i=a.map(u=>u.shapeInfo),s={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},o=lxe(a,s,t),l=T4(e.gl,o),c=e.createProgram(l);return Z().get("ENGINE_COMPILE_ONLY")?{program:t,fragmentShader:l,source:o,webGLProgram:c,inShapeInfos:i,outShapeInfo:s,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(e.buildVao(c),Object.assign({program:t,fragmentShader:l,source:o,webGLProgram:c,inShapeInfos:i,outShapeInfo:s},J4(e,t,c)))}function J4(e,t,n){let r=[],a=[],i,s,o,l=null,c=null;c=e.getUniformLocation(n,"NAN",!1),Z().getNumber("WEBGL_VERSION")===1&&(l=e.getUniformLocation(n,"INFINITY",!1));let u=!1;for(let d of t.variableNames){let p={name:d,uniform:e.getUniformLocation(n,d,u),offset:e.getUniformLocation(n,"offset".concat(d),u)};t.enableShapeUniforms&&(p.shape=e.getUniformLocation(n,"".concat(d,"Shape"),u),p.texShape=e.getUniformLocation(n,"".concat(d,"TexShape"),u)),r.push(p)}if(t.enableShapeUniforms&&(i=e.getUniformLocation(n,"outShape",u),o=e.getUniformLocation(n,"outShapeStrides",u),s=e.getUniformLocation(n,"outTexShape",u)),t.customUniforms)for(let d of t.customUniforms)a.push(e.getUniformLocation(n,d.name,u));return{variablesLocations:r,customUniformLocations:a,infLoc:l,nanLoc:c,outShapeLocation:i,outShapeStridesLocation:o,outTexShapeLocation:s}}function JR(e,t){if(e.length!==t.length)throw Error("Binary was compiled with ".concat(e.length," inputs, but was executed with ").concat(t.length," inputs"));e.forEach((n,r)=>{let a=n.logicalShape,i=t[r],s=i.shape;if(!k.arraysEqual(a,s))throw Error("Binary was compiled with different shapes than the current args. Shapes ".concat(a," and ").concat(s," must match"));if(n.isUniform&&i.isUniform)return;let o=n.texShape,l=i.isUniform?null:i.texData.texShape;if(!k.arraysEqual(o,l))throw Error("Binary was compiled with different texture shapes than the current args. Shape ".concat(o," and ").concat(l," must match"))})}function jxe(e,t,n,r,a){t.program.enableShapeUniforms||(JR(t.inShapeInfos,n),JR([t.outShapeInfo],[r]));let i=r.texData.texture,s=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(i.texture,s[0],s[1]):e.setOutputMatrixTexture(i.texture,s[0],s[1]),e.setProgram(t.webGLProgram),e.bindVertexArray(t.webGLProgram.vao),Z().getNumber("WEBGL_VERSION")===1&&t.infLoc!==null&&e.gl.uniform1f(t.infLoc,1/0),t.nanLoc!==null&&e.gl.uniform1f(t.nanLoc,NaN);for(let l=0;l<n.length;++l){let c=n[l],{uniform:u,offset:d,shape:p,texShape:h}=t.variablesLocations[l];if(p){let{uniformShape:f}=uT(t.program.packedInputs,c.shape,c.texData.texShape);switch(f.length){case 1:e.gl.uniform1iv(p,new Int32Array(f));break;case 2:e.gl.uniform2iv(p,new Int32Array(f));break;case 3:e.gl.uniform3iv(p,new Int32Array(f));break;case 4:e.gl.uniform4iv(p,new Int32Array(f));break}}if(h&&e.gl.uniform2i(h,c.texData.texShape[0],c.texData.texShape[1]),u!=null){if(c.isUniform){if(k.sizeFromShape(c.shape)<2)e.gl.uniform1f(u,c.uniformValues[0]);else{let f=c.uniformValues;f instanceof Float32Array||(f=new Float32Array(f)),e.gl.uniform1fv(u,f)}continue}c.texData.slice!=null&&d!=null&&e.gl.uniform1i(d,c.texData.slice.flatOffset),e.setInputMatrixTexture(c.texData.texture.texture,u,l)}}let o=t.outShapeLocation;if(o)switch(r.shape.length){case 1:e.gl.uniform1iv(o,new Int32Array(r.shape));break;case 2:e.gl.uniform2iv(o,new Int32Array(r.shape));break;case 3:e.gl.uniform3iv(o,new Int32Array(r.shape));break;case 4:e.gl.uniform4iv(o,new Int32Array(r.shape));break}if(t.outShapeStridesLocation){let l=k.computeStrides(r.shape);switch(r.shape.length){case 2:e.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(l));break;case 3:e.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(l));break;case 4:e.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(l));break}}if(t.outTexShapeLocation&&e.gl.uniform2i(t.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),t.program.customUniforms&&a)for(let l=0;l<t.program.customUniforms.length;++l){let c=t.program.customUniforms[l],u=t.customUniformLocations[l],d=a[l];if(c.type==="float")e.gl.uniform1fv(u,d);else if(c.type==="vec2")e.gl.uniform2fv(u,d);else if(c.type==="vec3")e.gl.uniform3fv(u,d);else if(c.type==="vec4")e.gl.uniform4fv(u,d);else if(c.type==="int")e.gl.uniform1iv(u,d);else if(c.type==="ivec2")e.gl.uniform2iv(u,d);else if(c.type==="ivec3")e.gl.uniform3iv(u,d);else if(c.type==="ivec4")e.gl.uniform4iv(u,d);else throw Error("uniform type ".concat(c.type," is not supported yet."))}e.executeProgram()}function Gxe(e,t,n){let r="";t.concat(n).forEach(s=>{let o=s.texData!=null&&s.texData.slice!=null&&s.texData.slice.flatOffset>0;if(e.enableShapeUniforms&&!s.isUniform){let l=s.texData.texShape,{useSqueezeShape:c,uniformShape:u,keptDims:d}=uT(e.packedInputs,s.shape,l),p="",h="",f="";if(u.length===1&&e.packedInputs){let w=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];p="".concat(w[0]>1,"_").concat(w[1]>1)}else if(u.length===2&&!e.packedInputs)h="".concat(u[0]>1,"_").concat(u[1]>1);else if(u.length>2&&!e.packedInputs){let w=k.computeStrides(u);f="".concat(w[0]===l[1],"_").concat(w[w.length-1]===l[1])}let m=s.shape.length,g=u.length===2&&k.arraysEqual(s.shape,l),y=k.sizeFromShape(s.shape)===1,b=T.getBroadcastDims(s.shape,n.shape),v=!e.packedInputs&&m===n.shape.length&&k.arraysEqual(l,n.texData.texShape),x=e.packedInputs||u.length>2?"":"".concat(l[0]>1,"_").concat(l[1]>1);r+="".concat(m,"_").concat(v,"_").concat(c?d:"","_").concat(u.length,"_").concat(y,"_").concat(b,"_").concat(g,"_").concat(p,"_").concat(h,"_").concat(f,"_").concat(x,"_").concat(o)}else{let l=s.isUniform?"uniform":s.texData.texShape;r+="".concat(s.shape,"_").concat(l,"_").concat(o)}});let a=e.userCode,i=e.constructor.name;return i+="_"+r+"_"+a+"".concat(Z().getNumber("WEBGL_VERSION")),i}function dr(e){return Z().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&e<=4}var qxe=class{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Dm.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];let t=Fr();this.outputShape=e,this.enableShapeUniforms=dr(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?cw(["r","c","d"],e):Gc(["r","c","d"],e),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ").concat(t.output," = result;\n      }\n    ")}},Kxe=class{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Dm.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];let t=Fr();this.outputShape=e,this.enableShapeUniforms=dr(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?cw(["r","c","d"],e):Gc(["r","c","d"],e),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ").concat(t.output," = result;\n      }\n    ")}},Xxe=class{constructor(e){this.variableNames=["A"],this.outTexUsage=Ca.DOWNLOAD;let t=Fr();this.outputShape=e,this.userCode="\n      ".concat(X4,"\n\n      void main() {\n        float x = getAAtOutCoords();\n        ").concat(t.output," = encode_float(x);\n      }\n    ")}},Yxe=class{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Ca.DOWNLOAD;let t=Fr();this.outputShape=e,this.userCode="\n      ".concat(X4,"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ").concat(t.output," = encode_float(x);\n      }\n    ")}},Zxe={R:0,G:1,B:2,A:3},eD=class{constructor(e,t=!1,n="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];let r=Fr();this.outputShape=e,this.enableShapeUniforms=dr(this.outputShape.length);let a="result";t&&(a="floor(result * 255. + 0.5)");let i="";for(let s=0;s<n.length;s++){let o=n[s];i+="\n          if(offset == ".concat(s,") {\n            result = values[").concat(Zxe[o],"];\n          }")}this.userCode="\n      ".concat(this.enableShapeUniforms?lT():oT(e),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int flatIndex = getFlatIndex(coords);\n        float result = 0.;\n        int offset = imod(flatIndex, ").concat(n.length,");\n\n        flatIndex = idiv(flatIndex, ").concat(n.length,", 1.);\n\n        int r = flatIndex / texShape[1];\n        if (r < texShape[0]) {\n          int c = imod(flatIndex, texShape[1]);\n          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n          vec4 values = ").concat(r.texture2D,"(A, uv);\n          ").concat(i,"\n        }\n        ").concat(r.output," = vec4(").concat(a,", 0., 0., 0.);\n      }\n    ")}},Qxe=class{constructor(e,t=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];let n=Fr();this.outputShape=e,this.enableShapeUniforms=dr(this.outputShape.length);let r="",a="result";t&&(a="floor(result * 255. + 0.5)");for(let i=0;i<=1;i++)for(let s=0;s<=1;s++){let o=i*2+s;r+="\n          localCoords = coords;\n          if(localCoords[2] + ".concat(s," < ").concat(this.enableShapeUniforms?"outShape[2]":"".concat(e[2]),") {\n          localCoords[2] += ").concat(s,";\n          if (localCoords[1] + ").concat(i," < ").concat(this.enableShapeUniforms?"outShape[1]":"".concat(e[1]),") {\n            localCoords[1] += ").concat(i,";\n\n            flatIndex = getFlatIndex(localCoords);\n            offset = imod(flatIndex, 4);\n\n            flatIndex = idiv(flatIndex, 4, 1.);\n\n            int r = flatIndex / texShape[1];\n            int c = imod(flatIndex, texShape[1]);\n            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n            values = ").concat(n.texture2D,"(A, uv);\n\n            if (offset == 0) {\n              result[").concat(o,"] = values[0];\n            } else if (offset == 1) {\n              result[").concat(o,"] = values[1];\n            } else if (offset == 2) {\n              result[").concat(o,"] = values[2];\n            } else {\n              result[").concat(o,"] = values[3];\n            }\n          }\n        }\n        ")}this.userCode="\n        ".concat(this.enableShapeUniforms?lT():oT(e),"\n\n        void main() {\n          ivec3 coords = getOutputCoords();\n\n          vec4 result = vec4(0.);\n          int flatIndex, r, c, offset;\n          ivec3 localCoords;\n          vec2 uv;\n          vec4 values;\n\n          ").concat(r,"\n\n          ").concat(n.output," = ").concat(a,";\n        }\n    ")}},eU={};Ue(eU,{bindVertexProgramAttributeStreams:()=>uU,createBufferFromOutputTexture:()=>pU,createFloat16MatrixTexture:()=>iU,createFloat16PackedMatrixTexture:()=>lU,createFloat32MatrixTexture:()=>aU,createIndexBuffer:()=>rU,createPackedMatrixTexture:()=>oU,createUnsignedBytesMatrixTexture:()=>sU,createVertexBuffer:()=>nU,createVertexShader:()=>tU,downloadByteEncodedFloatMatrixFromOutputTexture:()=>fU,downloadFloat32MatrixFromBuffer:()=>hU,downloadMatrixFromPackedOutputTexture:()=>gU,downloadPackedMatrixFromBuffer:()=>mU,getInternalFormatForFloat16MatrixTexture:()=>dT,getInternalFormatForFloat16PackedMatrixTexture:()=>fT,getInternalFormatForFloat32MatrixTexture:()=>cT,getInternalFormatForPackedMatrixTexture:()=>hT,getInternalFormatForUnsignedBytesMatrixTexture:()=>pT,uploadDenseMatrixToTexture:()=>cU,uploadPixelDataToTexture:()=>dU});function tU(e){let t=Fr(),n="".concat(t.version,"\n    precision highp float;\n    ").concat(t.attribute," vec3 clipSpacePos;\n    ").concat(t.attribute," vec2 uv;\n    ").concat(t.varyingVs," vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }");return E4(e,n)}function nU(e){let t=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return A4(e,t)}function rU(e){let t=new Uint16Array([0,1,2,2,1,3]);return R4(e,t)}function ty(e,t,n,r,a,i){F4(t,n);let s=D4(e),o=e.TEXTURE_2D;return be(e,()=>e.bindTexture(o,s)),be(e,()=>e.texParameteri(o,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)),be(e,()=>e.texParameteri(o,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),be(e,()=>e.texParameteri(o,e.TEXTURE_MIN_FILTER,e.NEAREST)),be(e,()=>e.texParameteri(o,e.TEXTURE_MAG_FILTER,e.NEAREST)),Z().getNumber("WEBGL_VERSION")===1?be(e,()=>e.texImage2D(o,0,r,t,n,0,a,i,null)):be(e,()=>e.texStorage2D(o,1,r,t,n)),be(e,()=>e.bindTexture(e.TEXTURE_2D,null)),{texture:s,texShape:[n,t]}}function cT(e){return e.internalFormatFloat}function aU(e,t,n,r){let[a,i]=ey(t,n);return ty(e,a,i,cT(r),r.textureFormatFloat,e.FLOAT)}function dT(e){return e.internalFormatHalfFloat}function iU(e,t,n,r){let[a,i]=ey(t,n);return ty(e,a,i,dT(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function pT(e){return e.downloadTextureFormat}function sU(e,t,n,r){let[a,i]=ey(t,n);return ty(e,a,i,pT(r),e.RGBA,e.UNSIGNED_BYTE)}function hT(e){return e.internalFormatPackedFloat}function oU(e,t,n,r){let[a,i]=jh(t,n);return ty(e,a,i,hT(r),e.RGBA,e.FLOAT)}function fT(e){return e.internalFormatPackedHalfFloat}function lU(e,t,n,r){let[a,i]=jh(t,n);return ty(e,a,i,fT(r),e.RGBA,r.textureTypeHalfFloat)}function uU(e,t,n){return be(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),DS(e,t,"clipSpacePos",n,3,20,0)&&DS(e,t,"uv",n,2,20,12)}function cU(e,t,n,r,a,i){be(e,()=>e.bindTexture(e.TEXTURE_2D,t));let s,o,l;a instanceof Uint8Array?(s=new Uint8Array(n*r*4),o=e.UNSIGNED_BYTE,l=e.RGBA):(s=new Float32Array(n*r*4),o=e.FLOAT,l=i.internalFormatPackedFloat),s.set(a),Z().getNumber("WEBGL_VERSION")===2?be(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n,r,e.RGBA,o,s)):be(e,()=>e.texImage2D(e.TEXTURE_2D,0,l,n,r,0,e.RGBA,o,s)),be(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function dU(e,t,n){be(e,()=>e.bindTexture(e.TEXTURE_2D,t)),n.data instanceof Uint8Array?Z().getNumber("WEBGL_VERSION")===2?be(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n.width,n.height,e.RGBA,e.UNSIGNED_BYTE,n.data)):be(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data)):Z().getNumber("WEBGL_VERSION")===2?be(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,n)):be(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)),be(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function pU(e,t,n,r){let a=e.createBuffer();be(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,a));let i=4*4*t*n;return be(e,()=>e.bufferData(e.PIXEL_PACK_BUFFER,i,e.STREAM_READ)),be(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0)),be(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,null)),a}function hU(e,t,n){let r=e,a=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,a),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),a}function fU(e,t,n,r){let[a,i]=ey(t,n),s=4,o=new Uint8Array(K0e(t*n,s));return be(e,()=>e.readPixels(0,0,a,i,r.downloadTextureFormat,e.UNSIGNED_BYTE,o)),new Float32Array(o.buffer)}function mU(e,t,n,r,a,i,s,o){let l=e,c=new Float32Array(X0e(i,s));return l.bindBuffer(l.PIXEL_PACK_BUFFER,t),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,c),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),c}function gU(e,t,n){let r=new Float32Array(t*n*4);return be(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,r)),r}var Eb=class{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];let t=Z().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,I4(t,e)):this.gl=Mi(t),e=this.gl,Z().getNumber("WEBGL_VERSION")===2){let a=e;this.createVertexArray=()=>be(a,()=>a.createVertexArray()),this.bindVertexArray=i=>be(a,()=>a.bindVertexArray(i)),this.deleteVertexArray=i=>be(a,()=>a.deleteVertexArray(i)),this.getVertexArray=()=>be(a,()=>a.getParameter(a.VERTEX_ARRAY_BINDING))}else if(e!=null){let a=e.getExtension("OES_vertex_array_object");if(a==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>be(e,()=>a.createVertexArrayOES()),this.bindVertexArray=i=>be(e,()=>a.bindVertexArrayOES(i)),this.deleteVertexArray=i=>be(e,()=>a.deleteVertexArrayOES(i)),this.getVertexArray=()=>be(e,()=>e.getParameter(a.VERTEX_ARRAY_BINDING_OES))}let n="WEBGL_color_buffer_float",r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),Z().getNumber("WEBGL_VERSION")===1){let a="OES_texture_float",i="OES_texture_half_float";if(this.textureFloatExtension=Nf(this.gl,a),Ea(this.gl,i))this.textureHalfFloatExtension=Nf(this.gl,i);else if(Z().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),Ea(this.gl,r))this.colorBufferHalfFloatExtension=Nf(this.gl,r);else if(Z().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",Ea(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else if(Ea(this.gl,r))this.colorBufferHalfFloatExtension=this.gl.getExtension(r);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=nU(this.gl),this.indexBuffer=rU(this.gl),this.framebuffer=M4(this.gl),this.textureConfig=iT(this.gl,this.textureHalfFloatExtension)}get debug(){return Z().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");let e=this.gl;be(e,()=>e.finish()),be(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),be(e,()=>e.deleteFramebuffer(this.framebuffer)),be(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),be(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),be(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,t){return this.throwIfDisposed(),aU(this.gl,e,t,this.textureConfig)}createFloat16MatrixTexture(e,t){return this.throwIfDisposed(),iU(this.gl,e,t,this.textureConfig)}createUnsignedBytesMatrixTexture(e,t){return this.throwIfDisposed(),sU(this.gl,e,t,this.textureConfig)}uploadPixelDataToTexture(e,t){this.throwIfDisposed(),dU(this.gl,e,t)}uploadDenseMatrixToTexture(e,t,n,r){this.throwIfDisposed(),cU(this.gl,e,t,n,r,this.textureConfig)}createFloat16PackedMatrixTexture(e,t){return this.throwIfDisposed(),lU(this.gl,e,t,this.textureConfig)}createPackedMatrixTexture(e,t){return this.throwIfDisposed(),oU(this.gl,e,t,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(FS(this.gl,this.framebuffer),this.outputTexture=null),be(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,t,n){return this.downloadMatrixDriver(e,()=>fU(this.gl,t,n,this.textureConfig))}downloadPackedMatrixFromBuffer(e,t,n,r,a,i){return mU(this.gl,e,t,n,r,a,i,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,t){return hU(this.gl,e,t)}createBufferFromTexture(e,t,n){this.bindTextureToFrameBuffer(e);let r=pU(this.gl,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){let e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,n;if(Z().getBool("WEBGL_FENCE_API_ENABLED")){let r=e,a=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=()=>{let i=r.clientWaitSync(a,0,0);return i===r.ALREADY_SIGNALED||i===r.CONDITION_SATISFIED},t=a}else Z().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=()=>this.isQueryAvailable(t,Z().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):n=()=>!0;return{query:t,isFencePassed:n}}downloadMatrixFromPackedTexture(e,t,n){return this.downloadMatrixDriver(e,()=>gU(this.gl,t,n))}createProgram(e){this.throwIfDisposed();let t=this.gl;this.vertexShader==null&&(this.vertexShader=tU(t));let n=N4(t);be(t,()=>t.attachShader(n,this.vertexShader)),be(t,()=>t.attachShader(n,e)),_4(t,n);let r=Object.assign(n,{vao:this.createVertexArray()});return this.debug&&Sb(t,r),r}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);let t=this.gl;be(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),uU(t,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(be(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&Sb(this.gl,this.program),be(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,t,n=!0){return this.throwIfDisposed(),n?L4(this.gl,e,t):P4(this.gl,e,t)}getAttributeLocation(e,t){return this.throwIfDisposed(),be(this.gl,()=>this.gl.getAttribLocation(e,t))}getUniformLocationNoThrow(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}setInputMatrixTexture(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),z4(this.gl,e,t,n)}setOutputMatrixTexture(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)}setOutputPackedMatrixTexture(e,t,n){this.throwIfDisposed();let[r,a]=jh(t,n);this.setOutputMatrixTextureDriver(e,r,a)}setOutputMatrixWriteRegion(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)}setOutputPackedMatrixWriteRegion(e,t,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&Sb(this.gl,this.program),_f(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();let e=this.gl;if(this.debug){let t=this.getVertexArray();console.assert(t===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}be(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),be(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Nf(this.gl,Z().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(Z().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){let n=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=n.createQuery();return n.beginQuery(r.TIME_ELAPSED_EXT,a),a}let e=this.getQueryTimerExtensionWebGL1(),t=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,t),t}endQuery(){if(Z().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){let t=this.gl,n=this.getQueryTimerExtensionWebGL2();t.endQuery(n.TIME_ELAPSED_EXT);return}let e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await k.repeatedTry(()=>this.disposed||this.isQueryAvailable(e,Z().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,Z().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,t){if(t===0)return null;if(t===2){let n=this.gl;return n.getQueryParameter(e,n.QUERY_RESULT)/1e6}else{let n=this.getQueryTimerExtensionWebGL1();return n.getQueryObjectEXT(e,n.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,t){if(t===0)return!0;if(t===2){let n=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint}else{let n=this.getQueryTimerExtensionWebGL1(),r=n.getQueryObjectEXT(e,n.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(n.GPU_DISJOINT_EXT)),r&&!this.disjoint}}pollFence(e){return new Promise(t=>{this.addItemToPoll(()=>e.isFencePassed(),()=>t())})}pollItems(){let e=Jxe(this.itemsToPoll.map(t=>t.isDoneFn));for(let t=0;t<=e;++t){let{resolveFn:n}=this.itemsToPoll[t];n()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1)return;let n;"setTimeoutCustom"in Z().platform&&(n=Z().platform.setTimeoutCustom.bind(Z().platform)),k.repeatedTry(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,n)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),Ib(this.gl,e,this.framebuffer),this.debug&&_f(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(Ib(this.gl,this.outputTexture,this.framebuffer),this.debug&&_f(this.gl)):FS(this.gl,this.framebuffer)}downloadMatrixDriver(e,t){this.bindTextureToFrameBuffer(e);let n=t();return this.unbindTextureToFrameBuffer(),n}setOutputMatrixTextureDriver(e,t,n){this.throwIfDisposed();let r=this.gl;Ib(r,e,this.framebuffer),this.debug&&_f(r),this.outputTexture=e,be(r,()=>r.viewport(0,0,t,n)),be(r,()=>r.scissor(0,0,t,n))}setOutputMatrixWriteRegionDriver(e,t,n,r){this.throwIfDisposed(),be(this.gl,()=>this.gl.scissor(e,t,n,r))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}};function Jxe(e){let t=0;for(;t<e.length&&e[t]();++t);return t-1}var{addImpl:ewe,bincountImpl:yU,bincountReduceImpl:twe,bitwiseAndImpl:nwe,castImpl:rwe,ceilImpl:awe,concatImpl:iwe,equalImpl:swe,expImpl:owe,expm1Impl:lwe,floorImpl:uwe,gatherNdImpl:cwe,gatherV2Impl:dwe,greaterImpl:pwe,greaterEqualImpl:hwe,lessImpl:fwe,lessEqualImpl:mwe,linSpaceImpl:gwe,logImpl:ywe,maxImpl:bwe,maximumImpl:vwe,minimumImpl:xwe,multiplyImpl:wwe,negImpl:kwe,notEqualImpl:Swe,prodImpl:Iwe,raggedGatherImpl:$we,raggedRangeImpl:Cwe,raggedTensorToTensorImpl:Ewe,rangeImpl:Twe,rsqrtImpl:Nwe,scatterImpl:_we,sigmoidImpl:Awe,simpleAbsImpl:bU,sliceImpl:Rwe,sparseFillEmptyRowsImpl:Dwe,sparseReshapeImpl:Fwe,sparseSegmentReductionImpl:vU,sqrtImpl:Mwe,staticRegexReplaceImpl:Owe,stridedSliceImpl:Lwe,stringNGramsImpl:Pwe,stringSplitImpl:zwe,stringToHashBucketFastImpl:Bwe,subImpl:Wwe,tileImpl:Uwe,topKImpl:Vwe,transposeImpl:mT,uniqueImpl:Hwe}=V2;function xU(e,t){return["x","y","z","w","u","v"].slice(0,t).map(n=>"".concat(e,".").concat(n))}function xr(e,t){return t===1?[e]:xU(e,t)}function jwe(e,t){if(e===1)return"rc";let n="";for(let r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}var Gwe=class{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=dr(this.outputShape.length),this.rank===0)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{let t=xr("rc",this.rank),n=St(this.rank),r=this.getOutOfBoundsCondition(t),a=this.getSetup(t),i=this.getOutput(t);this.userCode="\n        void main() {\n          ".concat(n," rc = getOutputCoords();\n\n          if(").concat(r,") {\n            setOutput(vec4(0));\n          } else {\n            ").concat(a,"\n\n            setOutput(vec4(").concat(i,"));\n          }\n        }\n      ")}}getSourceCoordsArr(e){let t=[];for(let n=0;n<=1;n++)for(let r=0;r<=1;r++){let a="".concat(n===0?"r":"rp1",", ").concat(r===0?"c":"cp1");for(let i=2;i<this.rank;i++)a="".concat(e[e.length-1-i],",")+a;t.push(a)}return t}getOutOfBoundsCondition(e){if(this.rank===1)return"rc > ".concat(this.enableShapeUniforms?"outShape":this.outputShape[0]);let t="";for(let n=this.rank-2;n<this.rank;n++)t+="".concat(e[n]," >= ").concat(this.enableShapeUniforms?"outShape[".concat(n,"]"):this.outputShape[n]),n<this.rank-1&&(t+="||");return t}getSetup(e){if(this.rank===1)return"";let t=e.slice(-2),n=this.enableShapeUniforms?"outShape[".concat(this.rank," - 1]"):this.outputShape[this.rank-1],r=this.enableShapeUniforms?"outShape[".concat(this.rank," - 2]"):this.outputShape[this.rank-2];return"\n      int r = ".concat(t[0],";\n      int c = ").concat(t[1],";\n      int rp1 = r + 1;\n      int cp1 = c + 1;\n\n      bool cEdge = cp1 >= ").concat(n,";\n      bool rEdge = rp1 >= ").concat(r,";\n    ")}getOutput(e){let t=this.getSourceCoordsArr(e);return this.rank===1?"getA(rc), (rc + 1 >= ".concat(this.enableShapeUniforms?"outShape":this.outputShape[0]," ? 0. : getA(rc + 1)), 0, 0"):"getA(".concat(t[0],"),\n            cEdge ? 0. : getA(").concat(t[1],"),\n            rEdge ? 0. : getA(").concat(t[2],"),\n            rEdge || cEdge ? 0. : getA(").concat(t[3],")")}},wU=class{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=dr(this.outputShape.length);let n="";for(let r=0;r<4;r++){let a="thisRC = rc;";r%2===1&&(a+="thisRC.z += 1;"),r>1&&(a+="thisRC.y += 1;"),n+="\n        ".concat(a,"\n        ").concat(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"","\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[").concat(r,"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ").concat(r>0?"}":"","\n      ")}this.userCode="\n      ".concat(qwe(t,this.enableShapeUniforms),"\n      ").concat(this.enableShapeUniforms?lT():oT(e),"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ").concat(this.enableShapeUniforms?"outShape[1]":e[1],";\n        int cols = ").concat(this.enableShapeUniforms?"outShape[2]":e[2],";\n\n        ").concat(n,"\n\n        setOutput(result);\n      }\n    ")}};function qwe(e,t){return"\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ".concat(t?oxe(["r","c","d"],"inputShape"):Gc(["r","c","d"],e),"\n      return ivec3(r, c, d);\n    }\n  ")}var Kwe=class{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,t,n){let r=nD(t,n),a=rD(e,r,n);a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]);let i=tD(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=i,this.log();let o=this.freeTextures[a].pop();return this.usedTextures[a].push(o),o}let s;return r===jn.PACKED_2X2_FLOAT32?s=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===jn.PACKED_2X2_FLOAT16?s=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===jn.UNPACKED_FLOAT32?s=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===jn.UNPACKED_FLOAT16?s=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===jn.PACKED_4X1_UNSIGNED_BYTE&&(s=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[a].push(s),this.numUsedTextures++,this._numBytesAllocated+=i,this.log(),s}releaseTexture(e,t,n,r){if(this.freeTextures==null)return;let a=nD(n,r),i=rD(t,a,r);i in this.freeTextures||(this.freeTextures[i]=[]);let s=tD(t,a,this.gpgpu.gl,this.gpgpu.textureConfig,r),o=Z().get("WEBGL_DELETE_TEXTURE_THRESHOLD");o!==-1&&this._numBytesAllocated>o?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=s):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=s),this.numUsedTextures--;let l=this.usedTextures[i],c=l&&l.indexOf(e);if(c==null||c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");l[c]=l[l.length-1],l.pop(),this.log()}log(){if(!this.logEnabled)return;let e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used","".concat(this.numFreeTextures," / ").concat(this.numUsedTextures),"(".concat(e,")"));let t=this._numBytesFree/this._numBytesAllocated;console.log("Bytes allocated: ".concat(this._numBytesAllocated)),console.log("Bytes unused: ".concat(this._numBytesFree," (").concat(Math.round(100*t),"%)"))}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(let e in this.freeTextures)this.freeTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});for(let e in this.usedTextures)this.usedTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}};function Xwe(e,t){let n=e;if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F||t===e.RGBA)return 16;if(t===n.RGBA16F)return 8;if(t===n.RGBA8)return 4;throw new Error("Unknown internal format ".concat(t))}function tD(e,t,n,r,a){let i=Ywe(t,r),s;if(a){let[l,c]=jh(e[0],e[1]);s=l*c}else{let[l,c]=ey(e[0],e[1]);s=l*c}let o=Xwe(n,i);return s*o}function Ywe(e,t){switch(e){case jn.PACKED_2X2_FLOAT32:return hT(t);case jn.PACKED_2X2_FLOAT16:return fT(t);case jn.UNPACKED_FLOAT32:return cT(t);case jn.UNPACKED_FLOAT16:return dT(t);case jn.PACKED_4X1_UNSIGNED_BYTE:return pT(t);default:throw new Error("Unknown physical texture type ".concat(e))}}function Zwe(e){return Z().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?jn.PACKED_2X2_FLOAT32:jn.UNPACKED_FLOAT32:e?jn.PACKED_2X2_FLOAT16:jn.UNPACKED_FLOAT16}function nD(e,t){if(e===Ca.UPLOAD)return jn.PACKED_2X2_FLOAT32;if(e===Ca.RENDER||e==null)return Zwe(t);if(e===Ca.DOWNLOAD||e===Ca.PIXELS)return jn.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type ".concat(e))}function rD(e,t,n){return"".concat(e[0],"_").concat(e[1],"_").concat(t,"_").concat(n)}var Zi=class{constructor(e,t){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=dr(this.outputShape.length),this.userCode="\n      float unaryOperation(float x) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")}},ai="if (isnan(x)) return x;",Qwe="return x;",aD="return abs(x);",Jwe="return (x >= 0.0) ? x : (exp(x) - 1.0);",e1e=ai+"\n  return (x < 0.0) ? 0.0 : x;\n",t1e=ai+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",to="return x;",n1e="return 1.0 / (1.0 + exp(-1.0 * x));",r1e="return x;",a1e="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",i1e="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",s1e="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",o1e="return 1.0 / (1.0 + exp(-1.0 * x));",po=class{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=dr(this.outputShape.length),this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        ".concat(t,"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")}},l1e=class{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=dr(this.outputShape.length);let t=e.length,n=xr("rc",t),r=St(t),a=jwe(t,n),i=n.slice(-2),s=t<=1?"rc":"vec2(".concat(i.join(","),")");this.userCode="\n      void main() {\n        ".concat(r," rc = getOutputCoords();\n        vec4 packedInput = getA(").concat(a,");\n\n        setOutput(getChannel(packedInput, ").concat(s,"));\n      }\n    ")}},u1e=us.whereImpl,c1e=1e-7,d1e=1e-4,T1={};function p1e(e){return e in T1||(T1[e]={}),T1[e]}var h1e=Z().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),f1e=600;function m1e(){return Z().global.screen==null?1024:Z().global.screen.height*Z().global.screen.width*window.devicePixelRatio*f1e/1024/1024}var dw=class extends eg{nextDataId(){return dw.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!Z().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let t;if(e!=null){if(e instanceof Eb)t=e;else{let n=Mi(Z().getNumber("WEBGL_VERSION"),e);t=new Eb(n)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{let n=Mi(Z().getNumber("WEBGL_VERSION"));t=new Eb(n),this.binaryCache=p1e(Z().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=t,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new Kwe(this.gpgpu),this.numMBBeforeWarning=m1e(),this.texData=new G0(this,ja())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,t,n,r,a,i){let s=this.makeTensorInfo(t,n),o=this.texData.get(s.dataId);o.isPacked=!1,o.texture={texture:e,texShape:[r,a]},o.texShape=[r,a];let l=Af(t),c=new eD(l,!1,i),u=this.runWebGLProgram(c,[s],n,[[r,a]]);return u.shape=t,o.texture=null,this.disposeIntermediateTensorInfo(s),u.dataId}write(e,t,n){if((Z().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||Z().getBool("DEBUG"))&&this.checkNumericalProblems(e),n==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");let r={id:this.nextDataId()};return this.texData.set(r,{shape:t,dtype:n,values:e,usage:Ca.UPLOAD,refCount:1}),r}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){let t=this.texData.get(e);t.refCount++}decRef(e){if(this.texData.has(e)){let t=this.texData.get(e);t.refCount--}}move(e,t,n,r,a){if(Z().getBool("DEBUG")&&this.checkNumericalProblems(t),r==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:r,values:t,usage:Ca.UPLOAD,refCount:a})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){let t=this.texData.get(e),{values:n,dtype:r,complexTensorInfos:a,slice:i,shape:s,isPacked:o}=t;if(i!=null){let d;o?d=new po(s,to):d=new Zi(s,to);let p=this.runWebGLProgram(d,[{dataId:e,shape:s,dtype:r}],r),h=this.readSync(p.dataId);return this.disposeIntermediateTensorInfo(p),h}if(n!=null)return this.convertAndCacheOnCPU(e);if(r==="string")return n;let l=this.activeTimers!=null,c;l&&(c=k.now());let u;if(r==="complex64"){let d=this.readSync(a.real.dataId),p=this.readSync(a.imag.dataId);u=T.mergeRealAndImagArrays(d,p)}else u=this.getValuesFromTexture(e);return l&&(this.downloadWaitMs+=k.now()-c),this.convertAndCacheOnCPU(e,u)}async read(e){if(this.pendingRead.has(e)){let h=this.pendingRead.get(e);return new Promise(f=>h.push(f))}let t=this.texData.get(e),{values:n,shape:r,slice:a,dtype:i,complexTensorInfos:s,isPacked:o}=t;if(a!=null){let h;o?h=new po(r,to):h=new Zi(r,to);let f=this.runWebGLProgram(h,[{dataId:e,shape:r,dtype:i}],i),m=this.read(f.dataId);return this.disposeIntermediateTensorInfo(f),m}if(n!=null)return this.convertAndCacheOnCPU(e);if(Z().getBool("DEBUG")&&!Z().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&Z().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let l=null,c;if(i!=="complex64"&&Z().get("WEBGL_BUFFER_SUPPORTED")){c=this.decode(e);let h=this.texData.get(c.dataId);l=this.gpgpu.createBufferFromTexture(h.texture.texture,...Jy(r))}this.pendingRead.set(e,[]),i!=="complex64"&&await this.gpgpu.createAndWaitForFence();let u;if(i==="complex64"){let h=await Promise.all([this.read(s.real.dataId),this.read(s.imag.dataId)]),f=h[0],m=h[1];u=T.mergeRealAndImagArrays(f,m)}else if(l==null)u=this.getValuesFromTexture(e);else{let h=k.sizeFromShape(r);u=this.gpgpu.downloadFloat32MatrixFromBuffer(l,h)}if(c!=null&&this.disposeIntermediateTensorInfo(c),l!=null){let h=this.gpgpu.gl;be(h,()=>h.deleteBuffer(l))}let d=this.convertAndCacheOnCPU(e,u),p=this.pendingRead.get(e);return this.pendingRead.delete(e),p.forEach(h=>h(d)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&ja().removeDataId(e,this),this.pendingDeletes--),d}readToGPU(e,t={}){let n=this.texData.get(e),{values:r,shape:a,slice:i,dtype:s,isPacked:o,texture:l}=n;if(s==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(i!=null){let p;o?p=new po(a,to):p=new Zi(a,to);let h=this.runWebGLProgram(p,[{dataId:e,shape:a,dtype:s}],s),f=this.readToGPU(h,t);return this.disposeIntermediateTensorInfo(h),f}if(l==null)throw r!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");let c=this.decode(e,t.customTexShape),u=ja().makeTensorFromTensorInfo(c),d=this.texData.get(c.dataId);return Object.assign({tensorRef:u},d.texture)}bufferSync(e){let t=this.readSync(e.dataId);if(e.dtype==="string")try{let n=t.map(r=>k.decodeString(r));return Ze(e.shape,e.dtype,n)}catch(n){throw new Error("Failed to decode encoded string bytes into utf-8")}return Ze(e.shape,e.dtype,t)}checkNumericalProblems(e){if(e!=null)for(let t=0;t<e.length;t++){let n=e[t];if(!$4(n))throw Z().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value ".concat(n," cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'")):Error("The value ".concat(n," cannot be represented on this device."))}}getValuesFromTexture(e){let{shape:t,dtype:n,isPacked:r}=this.texData.get(e),a=k.sizeFromShape(t);if(Z().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){let d=this.decode(e),p=this.texData.get(d.dataId),h=this.gpgpu.downloadMatrixFromPackedTexture(p.texture.texture,...Jy(t)).subarray(0,a);return this.disposeIntermediateTensorInfo(d),h}let i=Z().getBool("WEBGL_PACK")&&r===!0,s=i?Af(t):t,o=i?new Yxe(s):new Xxe(s),l=this.runWebGLProgram(o,[{shape:s,dtype:n,dataId:e}],"float32"),c=this.texData.get(l.dataId),u=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(c.texture.texture,c.texShape[0],c.texShape[1]).subarray(0,a);return this.disposeIntermediateTensorInfo(l),u}timerAvailable(){return Z().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){let t=this.activeTimers,n=[],r=!1;this.programTimersStack==null?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,e();let a=k.flatten(this.activeTimers.map(o=>o.query)).filter(o=>o!=null),i=k.flatten(this.activeTimers.map(o=>o.name)).filter(o=>o!=null);this.activeTimers=t,r&&(this.programTimersStack=null);let s={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(Z().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){let o=await Promise.all(a);s.kernelMs=k.sum(o),s.getExtraProfileInfo=()=>o.map((l,c)=>({name:i[c],ms:l})).map(l=>"".concat(l.name,": ").concat(l.ms)).join(", ")}else s.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,s})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return Z().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:k.now(),endMs:null}}endTimer(e){return Z().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=k.now(),e)}async getQueryTime(e){if(Z().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);let t=e;return t.endMs-t.startMs}disposeData(e,t=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);let{complexTensorInfos:n}=this.texData.get(e);return n!=null&&(this.disposeData(n.real.dataId,t),this.disposeData(n.imag.dataId,t)),this.texData.delete(e),!0}releaseGPUData(e){let{texture:t,dtype:n,texShape:r,usage:a,isPacked:i,slice:s}=this.texData.get(e),o=s&&s.origDataId||e,l=this.dataRefCount.get(o);l>1?this.dataRefCount.set(o,l-1):(this.dataRefCount.delete(o),t!=null&&(this.numBytesInGPU-=this.computeBytes(r,n),this.textureManager.releaseTexture(t,r,a,i)));let c=this.texData.get(e);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,t=h1e){return Z().getBool("WEBGL_CPU_FORWARD")&&e.every(n=>this.texData.get(n.dataId).texture==null&&k.sizeFromShape(n.shape)<t)}getGPGPUContext(){return this.gpgpu}where(e){T.warn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");let t=e.dataSync();return u1e(e.shape,t)}packedUnaryOp(e,t,n){let r=new po(e.shape,t),a=this.compileAndRun(r,[e],n);return ja().makeTensorFromTensorInfo(a)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){let r=bU(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,r)}if(Z().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,aD,e.dtype);let t=new Zi(e.shape,aD),n=this.compileAndRun(t,[e]);return ja().makeTensorFromTensorInfo(n)}makeTensorInfo(e,t,n){let r;if(t==="string"&&n!=null&&n.length>0&&k.isString(n[0])){let a=n.map(i=>k.encodeString(i));r=this.write(a,e,t)}else r=this.write(n,e,t);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:t}}makeOutput(e,t,n){return ja().makeTensorFromTensorInfo(this.makeTensorInfo(e,t,n),this)}unpackTensor(e){let t=new l1e(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}packTensor(e){let t=new Gwe(e.shape),n=!0;return this.runWebGLProgram(t,[e],e.dtype,null,n)}packedReshape(e,t){let n=[du(e.shape),...pu(e.shape)],r={dtype:e.dtype,shape:n,dataId:e.dataId},a=[du(t),...pu(t)],i=new wU(a,n),s=!0,o=[n],l=this.runWebGLProgram(i,[r],e.dtype,o,s);return{dataId:l.dataId,shape:t,dtype:l.dtype}}decode(e,t){let n=this.texData.get(e),{isPacked:r,shape:a,dtype:i}=n;if(t!=null){let d=k.sizeFromShape(a),p=t[0]*t[1]*4;k.assert(d<=p,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}let s=Af(a),o;r?o=new Kxe(s):o=new qxe(s);let l=!0,c=[t!=null?t:Jy(s)],u=this.runWebGLProgram(o,[{shape:s,dtype:i,dataId:e}],i,c,l,t);return{dtype:i,shape:a,dataId:u.dataId}}runWebGLProgram(e,t,n,r,a=!1,i){let s=this.makeTensorInfo(e.outputShape,n),o=this.texData.get(s.dataId);if(e.packedOutput&&(o.isPacked=!0),e.outPackingScheme===Dm.DENSE){let g=i!=null?i:Jy(e.outputShape);o.texShape=g.map(y=>y*2)}if(e.outTexUsage!=null&&(o.usage=e.outTexUsage),k.sizeFromShape(s.shape)===0)return o.values=k.getTypedArrayFromDType(s.dtype,0),s;let l=[],c=t.map(g=>{if(g.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let y=this.texData.get(g.dataId);if(y.texture==null){if(!e.packedInputs&&k.sizeFromShape(g.shape)<=Z().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:g.shape,texData:null,isUniform:!0,uniformValues:y.values};e.packedInputs&&(y.isPacked=!0,y.shape=g.shape)}if(this.uploadToGPU(g.dataId),!!y.isPacked!=!!e.packedInputs)g=y.isPacked?this.unpackTensor(g):this.packTensor(g),l.push(g),y=this.texData.get(g.dataId);else if(y.isPacked&&!Fm(y.shape,g.shape)){let b=g,v=g.shape;g.shape=y.shape,g=this.packedReshape(g,v),l.push(g),y=this.texData.get(g.dataId),b.shape=v}return{shape:g.shape,texData:y,isUniform:!1}});this.uploadToGPU(s.dataId);let u={shape:s.shape,texData:o,isUniform:!1},d=Gxe(e,c,u),p=this.getAndSaveBinary(d,()=>Hxe(this.gpgpu,e,c,u)),h=this.activeTimers!=null,f;h&&(f=this.startTimer()),Z().get("ENGINE_COMPILE_ONLY")||jxe(this.gpgpu,p,c,u,r),l.forEach(g=>this.disposeIntermediateTensorInfo(g)),h&&(f=this.endTimer(f),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(f)}));let m=Z().get("WEBGL_FLUSH_THRESHOLD");if(m>0){let g=k.now();g-this.lastGlFlushTime>m&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=g)}if(!Z().getBool("WEBGL_LAZILY_UNPACK")&&o.isPacked&&a===!1){let g=this.unpackTensor(s);return this.disposeIntermediateTensorInfo(s),g}return s}compileAndRun(e,t,n,r,a=!1){return n=n||t[0].dtype,this.runWebGLProgram(e,t,n,r,a)}getAndSaveBinary(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(Z().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(e=>{this.gpgpu.deleteProgram(this.binaryCache[e].webGLProgram),delete this.binaryCache[e]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=K(()=>{if(!Z().get("WEBGL_RENDER_FLOAT32_ENABLED")){let e=Z().getBool("DEBUG");Z().set("DEBUG",!1);let t=this.abs(Ae(1e-8)).dataSync()[0];if(Z().set("DEBUG",e),t>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?c1e:d1e}uploadToGPU(e){let t=this.texData.get(e),{shape:n,dtype:r,values:a,texture:i,usage:s,isPacked:o}=t;if(i!=null)return;let l=this.activeTimers!=null,c;l&&(c=k.now());let u=t.texShape;if(u==null&&(u=U4(n,o),t.texShape=u),a!=null){let d=Af(n),p,h=u[1],f=u[0],m=a instanceof Uint8Array||a instanceof Uint8ClampedArray;(o||!m)&&([h,f]=jh(u[0],u[1])),o?p=new Qxe(d,m):p=new eD(d,m);let g=m?[f,h]:u,y=this.makeTensorInfo(g,r),b=this.texData.get(y.dataId);m?b.usage=Ca.PIXELS:b.usage=Ca.UPLOAD,b.texShape=g,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(y.dataId),h,f,a);let v=[[f,h]],x=!0,w=this.runWebGLProgram(p,[y],r,v,x),$=this.texData.get(w.dataId);t.texShape=$.texShape,t.isPacked=$.isPacked,t.usage=$.usage,Z().get("ENGINE_COMPILE_ONLY")?this.disposeData(w.dataId):(t.texture=$.texture,t.values=null,this.texData.delete(w.dataId)),this.disposeIntermediateTensorInfo(y),l&&(this.uploadWaitMs+=k.now()-c)}else{let d=this.acquireTexture(u,s,r,o);t.texture=d}}convertAndCacheOnCPU(e,t){let n=this.texData.get(e),{dtype:r}=n;return t!=null&&(n.values=g1e(t,r)),n.values}acquireTexture(e,t,n,r){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){let a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: ".concat(a," MB, most likely due to a memory leak"))}return this.textureManager.acquireTexture(e,t,r)}computeBytes(e,t){return e[0]*e[1]*k.bytesPerElement(t)}checkCompileCompletion(){for(let[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){let e=[];if(this.gpgpu.parallelCompilationExtension){for(let[,t]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(t));return Promise.all(e)}else{for(let[,t]of Object.entries(this.binaryCache)){let n=new Promise(r=>{try{this.checkCompletion_(t),r(!0)}catch(a){throw a}});e.push(n)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await sE(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(sT(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(let e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);let{variablesLocations:t,customUniformLocations:n,infLoc:r,nanLoc:a,outShapeLocation:i,outShapeStridesLocation:s,outTexShapeLocation:o}=J4(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=t,e.customUniformLocations=n,e.infLoc=r,e.nanLoc=a,e.outShapeLocation=i,e.outShapeStridesLocation=s,e.outTexShapeLocation=o}}createTensorFromGPUData(e,t,n){e.channels=e.channels||"RGBA";let{texture:r,height:a,width:i,channels:s}=e,o=ja().backend;if(!o.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");let l=o.writeTexture(r,t,n,a,i,s);return ja().makeTensorFromDataId(l,t,n,o)}};dw.nextDataId=0;function g1e(e,t){if(t==="float32"||t==="complex64")return e;if(t==="int32"||t==="bool"){let n=t==="int32"?new Int32Array(e.length):new Uint8Array(e.length);for(let r=0;r<n.length;++r)n[r]=Math.round(e[r]);return n}else throw new Error("Unknown dtype ".concat(t))}var y1e="4.7.0";function kU(){Z().set("WEBGL_FORCE_F16_TEXTURES",!0)}Cg.isBrowser()&&ux("webgl",()=>new dw,2);var b1e={forceHalfFloat:kU},gT="\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n",hu=class{constructor(e,t,n){this.variableNames=["A","B"],this.outputShape=T.assertAndGetBroadcastShape(t,n),this.enableShapeUniforms=dr(this.outputShape.length),this.userCode="\n      float binaryOperation(float a, float b) {\n        ".concat(e,"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    ")}},Kc="\n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n",Zh=class{constructor(e,t,n,r=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=T.assertAndGetBroadcastShape(t,n);let a=this.outputShape.length;this.enableShapeUniforms=dr(a);let i="";if(r)if(a===0||k.sizeFromShape(this.outputShape)===1)i="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(i="\n          ".concat(St(a)," coords = getOutputCoords();\n        "),a===1)this.enableShapeUniforms?i+="\n            result.y = (coords + 1) >= outShape ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ":i+="\n            result.y = (coords + 1) >= ".concat(this.outputShape[0]," ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ");else{let s=xr("coords",a);this.enableShapeUniforms?i+="\n            bool nextRowOutOfBounds =\n              (".concat(s[a-2]," + 1) >= outShape[").concat(a," - 2];\n            bool nextColOutOfBounds =\n              (").concat(s[a-1]," + 1) >= outShape[").concat(a," - 1];\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "):i+="\n            bool nextRowOutOfBounds =\n              (".concat(s[a-2]," + 1) >= ").concat(this.outputShape[a-2],";\n            bool nextColOutOfBounds =\n              (").concat(s[a-1]," + 1) >= ").concat(this.outputShape[a-1],";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          ")}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ".concat(e,"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ").concat(i,"\n\n        setOutput(result);\n      }\n    ")}};function ga(e){let{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var v1e={kernelName:Yu,backendName:"webgl",kernelFunc:ga};function nl(e){let{inputs:t,backend:n}=e,{real:r,imag:a}=t,i=n.makeTensorInfo(r.shape,"complex64"),s=n.texData.get(i.dataId),o=ga({inputs:{x:r},backend:n}),l=ga({inputs:{x:a},backend:n});return s.complexTensorInfos={real:o,imag:l},i}var x1e={kernelName:X0,backendName:"webgl",kernelFunc:nl},SU="return (a < 0.) ? b * a : a;",IU="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";function w1e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{alpha:i}=r,s=n.makeTensorInfo([],"float32",k.createScalarValue(i,"float32")),o=Z().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Zh(IU,a.shape,s.shape):new hu(SU,a.shape,s.shape),l=n.runWebGLProgram(o,[a,s],"float32");return n.disposeIntermediateTensorInfo(s),l}var k1e={kernelName:ec,backendName:"webgl",kernelFunc:w1e},$U="return (a < 0.) ? b * a : a;",CU="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";function S1e(e){let{inputs:t,backend:n}=e,{x:r,alpha:a}=t,i=Z().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Zh(CU,r.shape,a.shape):new hu($U,r.shape,a.shape);return n.runWebGLProgram(i,[r,a],"float32")}var I1e={kernelName:gc,backendName:"webgl",kernelFunc:S1e},Qh="if (isnan(x)) return x;";function it({opSnippet:e,packedOpSnippet:t,cpuKernelImpl:n,dtype:r}){return({inputs:a,backend:i})=>{let{x:s}=a,o=i,l=r||s.dtype;if(o.shouldExecuteOnCPU([s])&&n!=null){let d=o.texData.get(s.dataId),p=n(d.values,l);return o.makeTensorInfo(s.shape,l,p)}let c=Z().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&t!=null,u;return c?u=new po(s.shape,t):u=new Zi(s.shape,e),o.runWebGLProgram(u,[s],l)}}function Zn({opSnippet:e,packedOpSnippet:t,checkOutOfBounds:n=!1,supportsComplex:r=!1,cpuKernelImpl:a,dtype:i}){return({inputs:s,backend:o})=>{let{a:l,b:c}=s,u=o;if(r&&l.dtype==="complex64"){let f=u.texData.get(l.dataId),m=u.texData.get(c.dataId),[g,y]=[[f.complexTensorInfos.real,m.complexTensorInfos.real],[f.complexTensorInfos.imag,m.complexTensorInfos.imag]].map(v=>{let[x,w]=v,$={dataId:x.dataId,dtype:x.dtype,shape:l.shape},C={dataId:w.dataId,dtype:w.dtype,shape:c.shape},E=new hu(e,l.shape,c.shape);return u.runWebGLProgram(E,[$,C],Ra(x.dtype,w.dtype))}),b=nl({inputs:{real:g,imag:y},backend:u});return u.disposeIntermediateTensorInfo(g),u.disposeIntermediateTensorInfo(y),b}let d=i||Ra(l.dtype,c.dtype);if((l.dtype==="string"||c.dtype==="string"||u.shouldExecuteOnCPU([l,c]))&&a!=null){let f=u.texData.get(l.dataId).values,m=u.texData.get(c.dataId).values,g=l.dtype==="string"?T.fromUint8ToStringArray(f):f,y=l.dtype==="string"?T.fromUint8ToStringArray(m):m,[b,v]=a(l.shape,c.shape,g,y,d),x=u.makeTensorInfo(v,d),w=u.texData.get(x.dataId);return w.values=b,x}let p=Z().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&t!=null,h;return p?h=new Zh(t,l.shape,c.shape,n):h=new hu(e,l.shape,c.shape),u.runWebGLProgram(h,[l,c],d)}}function Mm(e,t=!1){if(e==="linear")return t?r1e:Qwe;if(e==="relu")return t?i1e:e1e;if(e==="elu")return t?a1e:Jwe;if(e==="relu6")return t?s1e:t1e;if(e==="prelu")return t?CU:$U;if(e==="leakyrelu")return t?IU:SU;if(e==="sigmoid")return t?o1e:n1e;throw new Error("Activation ".concat(e," has not been implemented for the WebGL backend."))}var EU=class{constructor(e,t,n,r=!1,a=!1,i=!1,s=null,o=!1,l=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.enableShapeUniforms=dr(this.outputShape.length);let c=r?e[1]:e[2],u=Math.ceil(c/2),d=r?"i * 2, rc.y":"rc.y, i * 2",p=a?"rc.z, i * 2":"i * 2, rc.z",h=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],f=a?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],m="",g="";s&&(o?m="vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(s,"\n        }"):l?m="vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(s,"\n        }"):m="vec4 activation(vec4 x) {\n          ".concat(s,"\n        }"),g="result = activation(result);");let y=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),l&&this.variableNames.push("leakyreluAlpha");let b="rc.x",v="rc.x";e[0]<t[0]?b="imod(rc.x, ".concat(e[0],")"):t[0]<e[0]&&(v="imod(rc.x, ".concat(t[0],")")),this.userCode="\n      ".concat(m,"\n      // Don't use uniform for sharedDimensionPacked for performance.\n      const float sharedDimension = ").concat(u,".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        int batchA = ").concat(b,";\n        int batchB = ").concat(v,";\n        for (int i = 0; i < ").concat(u,"; i++) {\n          vec4 a = getMatrixA(batchA, ").concat(d,");\n          vec4 b = getMatrixB(batchB, ").concat(p,");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (").concat(h[0]," * ").concat(f[0],");\n          result += (").concat(h[1]," * ").concat(f[1],");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ").concat(y,"\n\n        ").concat(g,"\n\n        setOutput(result);\n      }\n    ")}},iD={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"},sD=class{constructor(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=T.assertAndGetBroadcastShape(t,n),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ".concat(e,"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    ")}},oD="return a * b;";function yT(e){let{inputs:t,backend:n}=e,{a:r,b:a}=t,i=T.upcastType(r.dtype,a.dtype);if(r.dtype==="complex64"){let o=n.texData.get(r.dataId),l=n.texData.get(a.dataId),c=new sD(iD.REAL,r.shape,a.shape),u=new sD(iD.IMAG,r.shape,a.shape),d=[{dataId:o.complexTensorInfos.real.dataId,dtype:o.complexTensorInfos.real.dtype,shape:r.shape},{dataId:o.complexTensorInfos.imag.dataId,dtype:o.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:a.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:a.shape}],p=n.runWebGLProgram(c,d,"float32"),h=n.runWebGLProgram(u,d,"float32"),f=nl({inputs:{real:p,imag:h},backend:n});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h),f}if(n.shouldExecuteOnCPU([r,a])){let o=n.texData.get(r.dataId),l=n.texData.get(a.dataId),[c,u]=wwe(r.shape,a.shape,o.values,l.values,i),d=n.makeTensorInfo(u,i),p=n.texData.get(d.dataId);return p.values=c,d}let s;return Z().getBool("WEBGL_PACK_BINARY_OPERATIONS")?s=new Zh(oD,r.shape,a.shape):s=new hu(oD,r.shape,a.shape),n.runWebGLProgram(s,[r,a],i)}var $1e={kernelName:pc,backendName:"webgl",kernelFunc:yT};function C1e(e,t,n){let r=[du(e.shape),...pu(e.shape)],a={dtype:e.dtype,shape:r,dataId:e.dataId},i=[du(t),...pu(t)],s=new wU(i,r),o=!0,l=[r],c=n.runWebGLProgram(s,[a],e.dtype,l,o);return{dataId:c.dataId,shape:t,dtype:c.dtype}}function ye(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{shape:i}=r,s=n,o=k.sizeFromShape(a.shape),l=k.inferFromImplicitShape(i,o),c=k.sizeFromShape(l);k.assert(o===c,()=>"The new shape (".concat(l,") has ").concat(c," elements and the old shape (").concat(a.shape,") has ").concat(o," elements. The new shape and old shape must have the same number of elements."));let u=s.texData.get(a.dataId);return u.isPacked&&!Fm(a.shape,l)&&!(u.texture!==null&&Fm(u.shape,l))?C1e(a,l,s):(s.incRef(a.dataId),{dataId:a.dataId,shape:l,dtype:a.dtype})}var E1e={kernelName:gh,backendName:"webgl",kernelFunc:ye},lD=class{constructor(e,t){this.variableNames=["x"];let{windowSize:n,batchSize:r,inSize:a,outSize:i}=e;this.outputShape=[r,i];let s=Math.floor(n/4)*4,o=n%4,l="sumValue += dot(values, ones);";if(t!=null){let u=1/t;l="sumValue += dot(values * ".concat(k.isInt(u)?u.toPrecision(2):u,", ones);")}let c="";a%n>0&&(c="\n        if (inIdx < 0 || inIdx >= ".concat(a,") {\n          return 0.0;\n        }\n      ")),this.userCode="\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ".concat(c,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(n,";\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(s,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(l,"\n        }\n\n        int inIdx = inOffset + ").concat(s,";\n        if (").concat(o===1,") {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ").concat(l,"\n        } else if (").concat(o===2,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ").concat(l,"\n        } else if (").concat(o===3,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ").concat(l,"\n        }\n        setOutput(sumValue);\n      }\n    ")}},T1e=class{constructor(e,t){this.variableNames=["x"];let{windowSize:n,batchSize:r,inSize:a,outSize:i}=e;this.outputShape=[r,i];let s="0.0",o="";t==="prod"?s="1.0":t==="min"?(s="1.0 / 1e-20",o="min"):t==="max"&&(s="-1.0 / 1e-20",o="max");let l="".concat(t,"(").concat(t,"(").concat(t,"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])");t==="sum"?l="sumValue":t==="prod"?l="prodValue":t==="all"?l="allValue":t==="any"&&(l="anyValue");let c=Math.floor(n/4)*4,u=n%4,d="\n      if (".concat(t==="sum",") {\n        sumValue += dot(values, ones);\n      } else if (").concat(t==="prod",") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ").concat(o,"(values, minMaxValue);\n        if (").concat(t==="min"," || ").concat(t==="max",") {\n          minMaxValue = ").concat(o,"(values, minMaxValue);\n          bvec4 isNaN = isnan(values);\n          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {\n            minMaxValue = vec4(NAN);\n          }\n        }\n      }\n    "),p="vec4";t==="all"?(s="1.0",d="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",p="bvec4"):t==="any"&&(s="0.0",d="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",p="bvec4");let h="";a%n>0&&(h="\n        if (inIdx < 0 || inIdx >= ".concat(a,") {\n          return initializationValue;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat(s,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ").concat(h,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(n,";\n\n        vec4 minMaxValue = vec4(").concat(s,");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ").concat(c,"; i += 4) {\n          int inIdx = inOffset + i;\n          ").concat(p," values = ").concat(p,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(d,"\n        }\n\n        int inIdx = inOffset + ").concat(c,";\n        if (").concat(u===1,") {\n          ").concat(p," values = ").concat(p,"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(d,"\n        } else if (").concat(u===2,") {\n          ").concat(p," values = ").concat(p,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(d,"\n        } else if (").concat(u===3,") {\n          ").concat(p," values = ").concat(p,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ").concat(d,"\n        }\n        setOutput(").concat(l,");\n      }\n    ")}};function N1e(e){let t=[];for(;t.length===0||t[t.length-1].outSize!==1;){let n=t.length?t[t.length-1].outSize:e[1],r=T.computeOptimalWindowSize(n);t.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return t}function Xc(e,t,n,r){let a=N1e(e.shape),i=e;for(let s=0;s<a.length;s++){let{inSize:o,windowSize:l,outSize:c}=a[s],u,d;n==="mean"?u=s===0?new lD({windowSize:l,inSize:o,batchSize:e.shape[0],outSize:c},o):new lD({windowSize:l,inSize:o,batchSize:e.shape[0],outSize:c}):u=new T1e({windowSize:l,inSize:o,batchSize:e.shape[0],outSize:c},n),d=i,i=r.runWebGLProgram(u,[i],t),d.dataId!==e.dataId&&r.disposeIntermediateTensorInfo(d)}return i}var _1e=class{constructor(e,t){this.variableNames=["A"];let n=new Array(e.length);for(let i=0;i<n.length;i++)n[i]=e[t[i]];this.outputShape=n,this.rank=n.length;let r=St(this.rank),a=A1e(t);this.userCode="\n    void main() {\n      ".concat(r," resRC = getOutputCoords();\n      setOutput(getA(").concat(a,"));\n    }\n    ")}};function A1e(e){let t=e.length;if(t>6)throw Error("Transpose for rank ".concat(t," is not yet supported"));let n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t);for(let a=0;a<e.length;a++)r[e[a]]=n[a];return r.join()}var R1e=class{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;let n=new Array(e.length);for(let c=0;c<n.length;c++)n[c]=e[t[c]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank ".concat(this.rank," is not yet supported."));let r=St(this.rank),a=xU("rc",this.rank),i=new Array(this.rank);for(let c=0;c<t.length;c++)i[t[c]]=a[c];let s="vec2(".concat(i.slice(-2).join(),")"),o="++".concat(a[this.rank-1]," < ").concat(n[this.rank-1]),l="getChannel(getA(".concat(i.join(),"), ").concat(s,")");this.userCode="\n    void main() {\n      ".concat(r," rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ").concat(l,";\n      if(").concat(o,") {\n        result[1] = ").concat(l,";\n      }\n      --").concat(a[this.rank-1],";\n      if(++").concat(a[this.rank-2]," < ").concat(n[this.rank-2],") {\n        result[2] = ").concat(l,";\n        if(").concat(o,") {\n          result[3] = ").concat(l,";\n        }\n      }\n      setOutput(result);\n    }\n    ")}};function pw(e,t,n){let r=Z().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new R1e(e.shape,t):new _1e(e.shape,t);return n.runWebGLProgram(r,[e],e.dtype)}function D1e(e,t,n,r){let a=t,i=e.shape.length,s=k.parseAxisParam(a,e.shape),o=s,l=T.getAxesPermutation(o,i),c=l!=null,u=e;c&&(u=pw(e,l,r),o=T.getInnerMostAxes(o.length,i)),T.assertAxesAreInnerMostDims("sum",o,i);let[d,p]=T.computeOutAndReduceShapes(u.shape,o),h=d;n&&(h=T.expandShapeToKeepDim(d,s));let f=k.sizeFromShape(p),m=k.sizeFromShape(e.shape)/f,g=ye({inputs:{x:u},attrs:{shape:[m,f]},backend:r}),y=lx(e.dtype),b=Xc(g,y,"sum",r),v=ye({inputs:{x:b},attrs:{shape:h},backend:r});return r.disposeIntermediateTensorInfo(g),r.disposeIntermediateTensorInfo(b),c&&r.disposeIntermediateTensorInfo(u),v}function hw(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:s}=r;return D1e(a,i,s,n)}var F1e={kernelName:Dc,backendName:"webgl",kernelFunc:hw};function Er(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{perm:i}=r,s=n,o=a.shape.length,l=new Array(o);for(let u=0;u<l.length;u++)l[u]=a.shape[i[u]];let c;if(s.shouldExecuteOnCPU([a])){let u=s.texData.get(a.dataId).values,d=mT(u,a.shape,a.dtype,i,l);c=s.makeTensorInfo(l,a.dtype);let p=s.texData.get(c.dataId);p.values=d}else c=pw(a,i,s);return c}var M1e={kernelName:Es,backendName:"webgl",kernelFunc:Er},TU=1e3;function Vv({a:e,b:t,transposeA:n,transposeB:r,backend:a,bias:i=null,preluActivationWeights:s=null,leakyreluAlpha:o=0,activation:l=null}){let c=e.shape.length,u=t.shape.length,d=n?e.shape[c-2]:e.shape[c-1],p=r?t.shape[u-1]:t.shape[u-2],h=n?e.shape[c-1]:e.shape[c-2],f=r?t.shape[u-2]:t.shape[u-1],m=e.shape.slice(0,-2),g=t.shape.slice(0,-2),y=k.sizeFromShape(m),b=k.sizeFromShape(g),v=Fh.assertAndGetBroadcastShape(e.shape.slice(0,-2),t.shape.slice(0,-2)).concat([h,f]);k.assert(d===p,()=>"Error in matMul: inner shapes (".concat(d,") and (").concat(p,") of Tensors with shapes ").concat(e.shape," and ").concat(t.shape," and transposeA=").concat(n," and transposeB=").concat(r," must match."));let x=n?[y,d,h]:[y,h,d],w=r?[b,f,p]:[b,p,f],$=ye({inputs:{x:e},backend:a,attrs:{shape:x}}),C=ye({inputs:{x:t},backend:a,attrs:{shape:w}}),E=[$,C],_=Math.max(y,b),R=n?$.shape[1]:$.shape[2],N=i!=null,I=s!=null,O=l==="leakyrelu",P=l!=null?Mm(l,!0):null,L=N||I||O||P!=null,U;if((h===1||f===1)&&R>TU&&L===!1){let F=$,z=C;n&&(F=Er({inputs:{x:$},backend:a,attrs:{perm:[0,2,1]}}),E.push(F)),r&&(z=Er({inputs:{x:C},backend:a,attrs:{perm:[0,2,1]}}),E.push(z));let B=f!==1,j=f===1,Y=F;B&&(Y=ye({inputs:{x:F},backend:a,attrs:{shape:[_,R,1]}}),E.push(Y));let Q=f===1?2:1,ae=z;j&&(ae=ye({inputs:{x:z},backend:a,attrs:{shape:[_,1,R]}}),E.push(ae));let se=yT({inputs:{a:Y,b:ae},backend:a});U=hw({inputs:{x:se},backend:a,attrs:{axis:Q,keepDims:!0}}),E.push(se)}else{let F=Ra(e.dtype,t.dtype),z=new EU(x,w,[_,h,f],n,r,N,P,I,O),B=[$,C];if(i!=null&&B.push(i),I&&B.push(s),O){let j=a.makeTensorInfo([],"float32",k.createScalarValue(o,"float32"));B.push(j),E.push(j)}U=a.runWebGLProgram(z,B,F)}let D=ye({inputs:{x:U},backend:a,attrs:{shape:v}});E.push(U);for(let F of E)a.disposeIntermediateTensorInfo(F);return D}function O1e(e){let{inputs:t,backend:n,attrs:r}=e,{a,b:i,bias:s,preluActivationWeights:o}=t,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:d}=r;return Vv({a,b:i,transposeA:l,transposeB:c,backend:n,bias:s,preluActivationWeights:o,leakyreluAlpha:d,activation:u})}var L1e={kernelName:Yl,backendName:"webgl",kernelFunc:O1e},uD="return abs(x);";function P1e(e){let{inputs:t,backend:n}=e,{x:r}=t;if(n.shouldExecuteOnCPU([r])&&r.dtype!=="complex64"){let i=n.texData.get(r.dataId),s=bU(i.values);return n.makeTensorInfo(r.shape,r.dtype,s)}let a;return Z().getBool("WEBGL_PACK_UNARY_OPERATIONS")?a=new po(r.shape,uD):a=new Zi(r.shape,uD),n.runWebGLProgram(a,[r],r.dtype)}var z1e={kernelName:Rp,backendName:"webgl",kernelFunc:P1e},B1e=ai+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n",W1e=it({opSnippet:B1e}),U1e={kernelName:wu,backendName:"webgl",kernelFunc:W1e},V1e=ai+"\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));",H1e=it({opSnippet:V1e}),j1e={kernelName:ku,backendName:"webgl",kernelFunc:H1e},cD="return a + b;",G1e=Zn({opSnippet:cD,packedOpSnippet:cD,supportsComplex:!0,cpuKernelImpl:ewe}),q1e={kernelName:Go,backendName:"webgl",kernelFunc:G1e},K1e=class{constructor(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map((a,i)=>"T".concat(i));let n=[];this.variableNames.forEach(a=>{n.push("float v".concat(a," = get").concat(a,"AtOutCoords();"))});let r=this.variableNames.map(a=>"v".concat(a)).join(" + ");this.userCode="\n      void main() {\n        ".concat(n.join("\n        "),"\n\n        float result = ").concat(r,";\n        setOutput(result);\n      }\n    ")}},X1e=class{constructor(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map((a,i)=>"T".concat(i));let n=[];this.variableNames.forEach(a=>{n.push("vec4 v".concat(a," = get").concat(a,"AtOutCoords();"))});let r=this.variableNames.map(a=>"v".concat(a)).join(" + ");this.userCode="\n      void main() {\n        ".concat(n.join("\n        "),"\n\n        vec4 result = ").concat(r,";\n        setOutput(result);\n      }\n    ")}};function Tb(e){let{inputs:t,backend:n}=e,r=t;if(r.length===1)return ga({inputs:{x:r[0]},backend:n});if(r.length>Z().get("WEBGL_MAX_TEXTURES_IN_SHADER")){let o=Math.floor(r.length/2),l=Tb({inputs:r.slice(0,o),backend:n}),c=Tb({inputs:r.slice(o),backend:n});return Tb({inputs:[l,c],backend:n})}let a=r.map(o=>o.dtype).reduce((o,l)=>Ra(o,l)),i=r.map(o=>o.shape),s=Z().getBool("WEBGL_PACK")?new X1e(r[0].shape,i):new K1e(r[0].shape,i);return n.runWebGLProgram(s,r,a)}var Y1e={kernelName:Su,backendName:"webgl",kernelFunc:Tb};function Z1e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:s}=r,o=a.shape.length,l=k.parseAxisParam(i,a.shape),c=l,u=T.getAxesPermutation(c,o),d=a;u!=null&&(d=Er({inputs:{x:a},backend:n,attrs:{perm:u}}),c=T.getInnerMostAxes(c.length,o)),T.assertAxesAreInnerMostDims("all",c,o);let[p,h]=T.computeOutAndReduceShapes(d.shape,c),f=k.sizeFromShape(h),m=ye({inputs:{x:d},backend:n,attrs:{shape:[-1,f]}}),g=Xc(m,m.dtype,"all",n),y;if(s){let b=T.expandShapeToKeepDim(p,l);y=ye({inputs:{x:g},backend:n,attrs:{shape:b}})}else y=ye({inputs:{x:g},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),u!=null&&n.disposeIntermediateTensorInfo(d),y}var Q1e={kernelName:Dp,backendName:"webgl",kernelFunc:Z1e};function J1e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:s}=r,o=a.shape.length,l=k.parseAxisParam(i,a.shape),c=l,u=T.getAxesPermutation(c,o),d=a;u!=null&&(d=Er({inputs:{x:a},backend:n,attrs:{perm:u}}),c=T.getInnerMostAxes(c.length,o)),T.assertAxesAreInnerMostDims("any",c,o);let[p,h]=T.computeOutAndReduceShapes(d.shape,c),f=k.sizeFromShape(h),m=ye({inputs:{x:d},backend:n,attrs:{shape:[-1,f]}}),g=Xc(m,m.dtype,"any",n),y;if(s){let b=T.expandShapeToKeepDim(p,l);y=ye({inputs:{x:g},backend:n,attrs:{shape:b}})}else y=ye({inputs:{x:g},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),u!=null&&n.disposeIntermediateTensorInfo(d),y}var eke={kernelName:Fp,backendName:"webgl",kernelFunc:J1e},tke=class{constructor(e,t,n){this.variableNames=["A"];let{windowSize:r,batchSize:a,outSize:i}=e;n||this.variableNames.push("bestIndicesA"),this.outputShape=[a,i];let s=t==="max"?">":"<",o=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ".concat(r,";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ").concat(r,"; i++) {\n          int inIdx = ").concat(o,";\n          float candidate = getA(batch, inIdx);\n          if (candidate ").concat(s," bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    ")}},nke=class{constructor(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,k.assert(e.length>2,()=>"Packed arg".concat(n.charAt(0).toUpperCase()+n.slice(1)," supports only inputs with rank above 2."));let a=e[e.length-1],i=Math.ceil(a/t);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");let s=this.outputShape,o=s.length,l=St(o),c=xr("coords",o),u,d;if(i===1){d=o+1;let C=St(d);u="\n        ".concat(C," sourceLocR = ").concat(C,"(").concat(c.join(),", 0);\n        ++").concat(c[o-1],";\n        ").concat(C," sourceLocG = ").concat(C,"(").concat(c.join(),", 0);\n        ++").concat(c[o-2],";\n        ").concat(C," sourceLocA = ").concat(C,"(").concat(c.join(),", 0);\n        --").concat(c[o-1],";\n        ").concat(C," sourceLocB = ").concat(C,"(").concat(c.join(),", 0);\n        --").concat(c[o-2],";")}else d=o,u="\n        ".concat(l," sourceLocR = coords;\n        ++").concat(c[o-1],";\n        ").concat(l," sourceLocG = coords;\n        ++").concat(c[o-2],";\n        ").concat(l," sourceLocA = coords;\n        --").concat(c[o-1],";\n        ").concat(l," sourceLocB = coords;\n        --").concat(c[o-2],";");let p=["x","y","z","w","u","v"].slice(0,d),h="."+p[d-1],f=p.map(C=>"int "+C),m=xr("sourceLocR",d-1).concat("inIdx.r"),g=xr("sourceLocG",d-1).concat("inIdx.g"),y=xr("sourceLocB",d-1).concat("inIdx.b"),b=xr("sourceLocA",d-1).concat("inIdx.a"),v=n==="max"?"greaterThan":"lessThan",x=r?"":"\n          inIdx = round(vec4(getBestIndicesAChannel(".concat(m.join(),"),\n                             getBestIndicesAChannel(").concat(g.join(),"),\n                             getBestIndicesAChannel(").concat(y.join(),"),\n                             getBestIndicesAChannel(").concat(b.join(),")));"),w="vec4(\n            getAChannel(".concat(m.join(),"),\n            hasNextCol ? getAChannel(").concat(g.join(),") : 0.,\n            hasNextRow ? getAChannel(").concat(y.join(),") : 0.,\n            hasNextRow && hasNextCol ? getAChannel(").concat(b.join(),") : 0.)"),$=r?"":"\n      float getBestIndicesAChannel(".concat(f.join(),") {\n        return getChannel(getBestIndicesA(").concat(p.join(),"),\n                                          vec2(").concat(p.slice(-2).join(),"));\n      }");this.userCode="\n      float getAChannel(".concat(f.join(),") {\n        return getChannel(getA(").concat(p.join(),"),\n                               vec2(").concat(p.slice(-2).join(),"));\n      }\n      ").concat($,"\n      void main() {\n        ").concat(l," coords = getOutputCoords();\n        bool hasNextCol = ").concat(c[o-1]," < ").concat(s[o-1]-1,";\n        bool hasNextRow = ").concat(c[o-2]," < ").concat(s[o-2]-1,";\n        ").concat(u,"\n        ivec4 srcIdx = ivec4(sourceLocR").concat(h,", sourceLocG").concat(h,",\n          sourceLocB").concat(h,", sourceLocA").concat(h,") * ").concat(t,";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ").concat(w,";\n\n        for (int i = 0; i < ").concat(t,"; i++) {\n          inIdx = srcIdx;\n          ").concat(x,"\n          vec4 candidate = ").concat(w,";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(").concat(v,"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    ")}};function NU(e,t,n,r=null){let a=t.shape[0],i=t.shape[1];r!=null&&(a=r.shape[0],i=r.shape[1]);let s=T.computeOptimalWindowSize(i),o={windowSize:s,inSize:i,batchSize:a,outSize:Math.ceil(i/s)},l=new tke(o,n,r==null),c=[t];r!=null&&c.push(r);let u=e.runWebGLProgram(l,c,"int32");if(u.shape[1]===1)return u;let d=NU(e,t,n,u);return e.disposeIntermediateTensorInfo(u),d}function _U(e,t,n,r=null){let a=r!=null?r.shape:t.shape,i=a[a.length-1],s=T.computeOptimalWindowSize(i),o=new nke(a,s,n,r==null),l=r==null?[t]:[t,r],c=e.runWebGLProgram(o,l,"int32");if(c.shape.length===t.shape.length){let u=_U(e,t,n,c);return e.disposeIntermediateTensorInfo(c),u}return c}function AU(e,t,n,r){let a=[n];if(T.assertAxesAreInnerMostDims("arg"+r.charAt(0).toUpperCase()+r.slice(1),a,t.shape.length),!Z().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){let i=[],s=e.texData.get(t.dataId),o=s!==null&&s.isPacked,l=t;o&&(l=e.unpackTensor(t),i.push(l));let[c,u]=T.computeOutAndReduceShapes(l.shape,a),d=k.sizeFromShape(u),p=ye({inputs:{x:l},backend:e,attrs:{shape:[-1,d]}});i.push(p);let h=NU(e,p,r);i.push(h);let f=ye({inputs:{x:h},backend:e,attrs:{shape:c}});return i.forEach(m=>e.disposeIntermediateTensorInfo(m)),f}return _U(e,t,r)}function rke(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i}=r,s=k.parseAxisParam(i,a.shape),o=T.getAxesPermutation(s,a.shape.length),l=a,c=[];o!=null&&(l=Er({inputs:{x:a},backend:n,attrs:{perm:o}}),c.push(l),s=T.getInnerMostAxes(s.length,l.shape.length)),T.assertAxesAreInnerMostDims("argMax",[s[0]],l.shape.length);let u=AU(n,l,s[0],"max");return c.forEach(d=>n.disposeIntermediateTensorInfo(d)),u}var ake={kernelName:Mp,backendName:"webgl",kernelFunc:rke};function ike(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i}=r,s=k.parseAxisParam(i,a.shape),o=T.getAxesPermutation(s,a.shape.length),l=a,c=[];o!=null&&(l=Er({inputs:{x:a},backend:n,attrs:{perm:o}}),c.push(l),s=T.getInnerMostAxes(s.length,l.shape.length)),T.assertAxesAreInnerMostDims("argMin",[s[0]],l.shape.length);let u=AU(n,l,s[0],"min");return c.forEach(d=>n.disposeIntermediateTensorInfo(d)),u}var ske={kernelName:Op,backendName:"webgl",kernelFunc:ike},oke=ai+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n",lke=it({opSnippet:oke}),uke={kernelName:Iu,backendName:"webgl",kernelFunc:lke},cke=ai+"return log(x + sqrt(x * x + 1.0));",dke=it({opSnippet:cke}),pke={kernelName:$u,backendName:"webgl",kernelFunc:dke},hke=ai+"\n  return atan(x);\n",fke=it({opSnippet:hke}),mke={kernelName:Cu,backendName:"webgl",kernelFunc:fke},gke=gT+"\n  return atan(a, b);\n",yke="\n  vec4 result = atan(a, b);\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+Kc+"\n  return result;\n",bke=Zn({opSnippet:gke,packedOpSnippet:yke}),vke={kernelName:Tu,backendName:"webgl",kernelFunc:bke},xke=ai+"\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;",wke=it({opSnippet:xke}),kke={kernelName:Eu,backendName:"webgl",kernelFunc:wke},Om=class{constructor(e,t,n,r=!1,a=!1){if(this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");let i=e.filterWidth,s=e.strideHeight,o=e.strideWidth,l=e.dilationHeight,c=e.dilationWidth,u=e.effectiveFilterHeight,d=e.effectiveFilterWidth,p=e.padInfo.top,h=e.padInfo.left;this.outputShape=e.outShape;let f=t==="avg",m="((batch  * ".concat(e.inHeight," + xR) * ").concat(e.inWidth," + xC) * ").concat(e.inChannels," + d"),g="(xR * ".concat(e.inWidth," + xC) * ").concat(e.inChannels," + d"),y="0.0";if(f||(y="-1.0 / 1e-20"),n){let C=">=";this.userCode="\n        const ivec2 strides = ivec2(".concat(s,", ").concat(o,");\n        const ivec2 pads = ivec2(").concat(p,", ").concat(h,");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ").concat(u,";\n              wR += ").concat(l,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(d,";\n                wC += ").concat(c,") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ").concat(C," currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ").concat(r?a?m:g:"wR * ".concat(d," + wC"),";\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ");return}let b="max",v="".concat(t,"(").concat(t,"(").concat(t,"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])");t==="avg"&&(v="avgValue / max(count, 1.0)");let x=Math.floor(i/4)*4,w=i%4,$="\n      if (".concat(f,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat(b,"(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec2 strides = ivec2(".concat(s,", ").concat(o,");\n      const ivec2 pads = ivec2(").concat(p,", ").concat(h,");\n      const float initializationValue = ").concat(y,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ").concat(e.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(y,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ").concat(u,";\n            wR += ").concat(l,") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ").concat(e.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(x,"; wC += 4) {\n            int xC = xCCorner + wC * ").concat(c,";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(c,", d),\n              getValue(batch, xR, xC + 2 * ").concat(c,", d),\n              getValue(batch, xR, xC + 3 * ").concat(c,", d)\n            );\n\n            ").concat($,"\n          }\n\n          int xC = xCCorner + ").concat(x,";\n          if (").concat(w===1,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat($,"\n          } else if (").concat(w===2,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(c,", d),\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat($,"\n          } else if (").concat(w===3,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(c,", d),\n              getValue(batch, xR, xC + 2 * ").concat(c,", d),\n              initializationValue\n            );\n\n            ").concat($,"\n          }\n        }\n        setOutput(").concat(v,");\n      }\n    ")}},bT=class{constructor(e,t,n,r=!1,a=!1){if(this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");let i=e.filterWidth,s=e.strideDepth,o=e.strideHeight,l=e.strideWidth,c=e.dilationDepth,u=e.dilationHeight,d=e.dilationWidth,p=e.effectiveFilterDepth,h=e.effectiveFilterHeight,f=e.effectiveFilterWidth,m=e.padInfo.front,g=e.padInfo.top,y=e.padInfo.left;this.outputShape=e.outShape;let b=t==="avg",v="0.0";if(b||(v="-1.0 / 1e-20"),n){let _=">=";this.userCode="\n        const ivec3 strides =\n            ivec3(".concat(s,", ").concat(o,", ").concat(l,");\n        const ivec3 pads = ivec3(").concat(m,", ").concat(g,", ").concat(y,");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ").concat(p,";\n              wD += ").concat(c,") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ").concat(e.inDepth,") {\n              continue;\n            }\n\n            for (int wR = 0; wR < ").concat(h,";\n                wR += ").concat(u,") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ").concat(e.inHeight,") {\n                continue;\n              }\n\n              for (int wC = 0; wC < ").concat(f,";\n                  wC += ").concat(d,") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value ").concat(_," currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ").concat(r?a?"(((batch * ".concat(e.inDepth," + xD) * ").concat(e.inHeight," + xR) * ").concat(e.inWidth," + xC) * ").concat(e.inChannels," + ch"):"((xD * ".concat(e.inHeight," + xR) * ").concat(e.inWidth," + xC) * ").concat(e.inChannels," + ch"):"wD * ".concat(h," * ").concat(f," +\n                      wR * ").concat(f," + wC"),";\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ");return}let x="max",w="".concat(t,"(").concat(t,"(").concat(t,"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])");t==="avg"&&(w="avgValue / max(count, 1.0)");let $=Math.floor(i/4)*4,C=i%4,E="\n      if (".concat(b,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat(x,"(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec3 strides =\n        ivec3(".concat(s,", ").concat(o,", ").concat(l,");\n      const ivec3 pads = ivec3(").concat(m,", ").concat(g,", ").concat(y,");\n      const float initializationValue = ").concat(v,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ").concat(e.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(v,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ").concat(p,";\n            wD += ").concat(c,") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ").concat(e.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(h,";\n            wR += ").concat(u,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat($,"; wC += 4) {\n              int xC = xCCorner + wC * ").concat(d,";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(d,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(d,", ch),\n                getValue(batch, xD, xR, xC + 3 * ").concat(d,", ch)\n              );\n\n              ").concat(E,"\n            }\n\n            int xC = xCCorner + ").concat($,";\n            if (").concat(C===1,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(E,"\n            } else if (").concat(C===2,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(d,", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(E,"\n            } else if (").concat(C===3,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(d,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(d,", ch),\n                initializationValue\n              );\n\n              ").concat(E,"\n            }\n          }\n        }\n        setOutput(").concat(w,");\n      }\n    ")}};function Ske(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t;Gh(a,"avgPool");let{filterSize:i,strides:s,pad:o,dimRoundingMode:l}=r,c=1;k.assert(T.eitherStridesOrDilationsAreOne(s,c),()=>"Error in avgPool: Either strides or dilations must be 1. Got strides ".concat(s," and dilations '").concat(c,"'"));let u=T.computePool2DInfo(a.shape,i,s,c,o,l);if(u.filterWidth===1&&u.filterHeight===1&&k.arraysEqual(u.inShape,u.outShape))return ga({inputs:{x:a},backend:n});let d=new Om(u,"avg",!1);return n.runWebGLProgram(d,[a],"float32")}var Ike={kernelName:Nu,backendName:"webgl",kernelFunc:Ske};function $ke(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:i,strides:s,pad:o,dimRoundingMode:l,dataFormat:c}=r,u=[1,1,1],d=T.computePool3DInfo(a.shape,i,s,u,o,l,c),p=new bT(d,"avg",!1);return n.runWebGLProgram(p,[a],"float32")}var Cke={kernelName:Lp,backendName:"webgl",kernelFunc:$ke},Eke=class{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;let t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,a=e.strideWidth,i=e.dilationHeight,s=e.dilationWidth,o=e.effectiveFilterHeight,l=e.effectiveFilterWidth,c=o-1-e.padInfo.top,u=l-1-e.padInfo.left,d=1/(t*n);this.userCode="\n      const ivec2 pads = ivec2(".concat(c,", ").concat(u,");\n      const float avgMultiplier = float(").concat(d,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(o,";\n            wR += ").concat(i,") {\n          float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(l,";\n            wC+= ").concat(s,") {\n            float dyC = float(dyCCorner + wC) / ").concat(a,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}},Tke=class{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;let t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,a=e.strideDepth,i=e.strideHeight,s=e.strideWidth,o=e.dilationDepth,l=e.dilationHeight,c=e.dilationWidth,u=e.effectiveFilterDepth,d=e.effectiveFilterHeight,p=e.effectiveFilterWidth,h=u-1-e.padInfo.front,f=d-1-e.padInfo.top,m=p-1-e.padInfo.left,g=1/(t*n*r);this.userCode="\n      const ivec3 pads = ivec3(".concat(h,", ").concat(f,", ").concat(m,");\n      const float avgMultiplier = float(").concat(g,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(u,";\n            wD += ").concat(o,") {\n          float dyD = float(dyDCorner + wD) / ").concat(a,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(e.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(d,";\n              wR += ").concat(l,") {\n            float dyR = float(dyRCorner + wR) / ").concat(i,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(p,";\n                wC += ").concat(c,") {\n              float dyC = float(dyCCorner + wC) / ").concat(s,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}};function Nke(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,s=i,{filterSize:o,strides:l,pad:c,dimRoundingMode:u}=r,d=[1,1,1],p=T.computePool3DInfo(s.shape,o,l,d,c,u),h=new Tke(p);return n.runWebGLProgram(h,[a],s.dtype)}var _ke={kernelName:rg,backendName:"webgl",kernelFunc:Nke};function Ake(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,s=i;Gh([a,i],"avgPoolGrad");let{filterSize:o,strides:l,pad:c}=r,u=T.computePool2DInfo(s.shape,o,l,1,c),d=new Eke(u);return n.runWebGLProgram(d,[a],s.dtype)}var Rke={kernelName:ng,backendName:"webgl",kernelFunc:Ake};function Dke(e){let{inputs:t,backend:n,attrs:r}=e,{a,b:i}=t,{transposeA:s,transposeB:o}=r;return Vv({a,b:i,transposeA:s,transposeB:o,backend:n})}var Fke={kernelName:_u,backendName:"webgl",kernelFunc:Dke},Mke=class{constructor(e,t,n,r,a,i){this.outputShape=[],this.variableNames=["x","mean","variance"],T.assertAndGetBroadcastShape(e,t),T.assertAndGetBroadcastShape(e,n);let s="0.0";r!=null&&(T.assertAndGetBroadcastShape(e,r),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");let o="1.0";a!=null&&(T.assertAndGetBroadcastShape(e,a),this.variableNames.push("scale"),o="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ".concat(s,";\n        float scale = ").concat(o,";\n        float inv = scale * inversesqrt(variance + float(").concat(i,"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    ")}},Oke=class{constructor(e,t,n,r,a,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],T.assertAndGetBroadcastShape(e,t),T.assertAndGetBroadcastShape(e,n);let s="vec4(0.0)";r!=null&&(T.assertAndGetBroadcastShape(e,r),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");let o="vec4(1.0)";a!=null&&(T.assertAndGetBroadcastShape(e,a),this.variableNames.push("scale"),o="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        vec4 offset = ".concat(s,";\n        vec4 scale = ").concat(o,";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(").concat(i,"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    ")}},Lke=({inputs:e,backend:t,attrs:n})=>{let{x:r,mean:a,variance:i,offset:s,scale:o}=e;k.assert(a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),k.assert(s==null||a.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),k.assert(o==null||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);let c=[r,a,i],u=null;s!=null&&(u=s.shape,c.push(s));let d=null;o!=null&&(d=o.shape,c.push(o));let p=Z().getBool("WEBGL_PACK_NORMALIZATION")?new Oke(r.shape,a.shape,i.shape,u,d,l):new Mke(r.shape,a.shape,i.shape,u,d,l);return t.runWebGLProgram(p,c,c[0].dtype)},Pke={kernelName:Ku,backendName:"webgl",kernelFunc:Lke},zke=class{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;let t=St(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];let n=Bke(this.rank),r,a=e.map((i,s)=>"sourceLoc.".concat(LS[s]," = start[").concat(s,"] + coords.").concat(LS[s],";"));r="\n        ".concat(t," sourceLoc;\n        ").concat(t," coords = getOutputCoords();\n        ").concat(a.join("\n"),"\n      "),this.userCode="\n      void main() {\n        ".concat(r,"\n        setOutput(getSource(").concat(n,"));\n      }\n    ")}},LS=["x","y","z","w","u","v"];function Bke(e){if(e===1)return"sourceLoc";if(e<=6)return LS.slice(0,e).map(t=>"sourceLoc."+t).join(",");throw Error("Slicing for rank ".concat(e," is not yet supported"))}var Wke=class{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];let t=St(this.rank),n=xr("coords",this.rank),r=xr("sourceLoc",this.rank),a=this.rank===1?"sourceLoc":"vec2(".concat(r.slice(-2).join(),")"),i="getChannel(getSource(".concat(r.join(),"), ").concat(a,")"),s="\n      result.x = ".concat(i,";\n      if (++").concat(n[this.rank-1]," < ").concat(e[this.rank-1],") {\n        ++").concat(r[this.rank-1],";\n        result.y = ").concat(i,";\n        --").concat(r[this.rank-1],";\n      }\n    "),o=this.rank===1?"":"\n      --".concat(n[this.rank-1],";\n      if (++").concat(n[this.rank-2]," < ").concat(e[this.rank-2],") {\n        ++").concat(r[this.rank-2],";\n        result.z = ").concat(i,";\n        if (++").concat(n[this.rank-1]," < ").concat(e[this.rank-1],") {\n          ++").concat(r[this.rank-1],";\n          result.w = ").concat(i,";\n        }\n      }\n    "),l=this.rank<=4?"sourceLoc = coords +\n            ".concat(t,"(").concat(e.map((c,u)=>"start[".concat(u,"]")).join(),");"):e.map((c,u)=>"".concat(r[u]," = ").concat(n[u]," + start[").concat(u,"];")).join("\n");this.userCode="\n      void main() {\n        ".concat(t," coords = getOutputCoords();\n        ").concat(t," sourceLoc;\n        ").concat(l,"\n        vec4 result = vec4(0.);\n        ").concat(s,"\n        ").concat(o,"\n        setOutput(result);\n      }\n    ")}};function Uke(e,t,n,r){let a=r.texData.get(e.dataId),i=r.makeTensorInfo(n,e.dtype),s=r.texData.get(i.dataId);Object.assign(s,a),s.refCount=1,s.shape=n,s.dtype=e.dtype;let o=In.computeFlatOffset(t,k.computeStrides(e.shape));a.slice&&(o+=a.slice.flatOffset),s.slice={flatOffset:o,origDataId:a.slice&&a.slice.origDataId||e.dataId};let l=r.dataRefCount.get(s.slice.origDataId)||1;return r.dataRefCount.set(s.slice.origDataId,l+1),i}function Jh(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{begin:i,size:s}=r,[o,l]=In.parseSliceParams(a,i,s);if(In.assertParamsValid(a,o,l),k.sizeFromShape(l)===0)return n.makeTensorInfo(l,a.dtype,[]);if(n.shouldExecuteOnCPU([a])||a.dtype==="string"){let d=n.texData.get(a.dataId),p=Rwe(d.values,o,l,a.shape,a.dtype);return n.makeTensorInfo(l,a.dtype,p)}let{isPacked:c}=n.texData.get(a.dataId),u=In.isSliceContinous(a.shape,o,l);if(c||!u){let d=Z().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Wke(l):new zke(l),p=[o];return n.runWebGLProgram(d,[a],a.dtype,p)}return n.uploadToGPU(a.dataId),Uke(a,o,l,n)}var Vke={kernelName:Sh,backendName:"webgl",kernelFunc:Jh},Hke=e=>{let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:i,crops:s}=r;k.assert(a.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");let o=i.reduce((b,v)=>b*v),l=T.getReshaped(a.shape,i,o),c=T.getPermuted(l.length,i.length),u=T.getReshapedPermuted(a.shape,i,o),d=T.getSliceBeginCoords(s,i.length),p=T.getSliceSize(u,s,i.length),h=[],f=ye({inputs:{x:a},backend:n,attrs:{shape:l}}),m=Er({inputs:{x:f},backend:n,attrs:{perm:c}}),g=ye({inputs:{x:m},backend:n,attrs:{shape:u}}),y=Jh({inputs:{x:g},backend:n,attrs:{begin:d,size:p}});return h.push(f),h.push(m),h.push(g),h.forEach(b=>n.disposeIntermediateTensorInfo(b)),y},jke={kernelName:Pp,backendName:"webgl",kernelFunc:Hke};function Gke(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,weights:i}=t,{size:s}=r,o=n.readSync(a.dataId),l=n.readSync(i.dataId),c=yU(o,l,i.dtype,i.shape,s);return n.makeTensorInfo([s],i.dtype,c)}var qke={kernelName:zp,backendName:"webgl",kernelFunc:Gke},Kke="\n  int r = int(a.r) & int(b.r);\n  int g = int(a.g) & int(b.g);\n  int rb = int(a.b) & int(b.b);\n  int ra = int(a.a) & int(b.a);\n  return vec4(r, g, rb, ra);\n",Xke="\n  return float(int(a.r) & int(b.r));\n";function Yke(e){let{inputs:t,backend:n}=e,{a:r,b:a}=t,i=Z().getBool("WEBGL_PACK_BINARY_OPERATIONS"),s=Z().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([r,a])||s===1){let l=n.texData.get(r.dataId).values,c=n.texData.get(a.dataId).values,[u,d]=nwe(r.shape,a.shape,l,c,r.dtype),p=n.makeTensorInfo(d,r.dtype),h=n.texData.get(p.dataId);return h.values=u,p}let o;return i?o=new Zh(Kke,r.shape,a.shape,!1):o=new hu(Xke,r.shape,a.shape),n.runWebGLProgram(o,[r,a],r.dtype)}var Zke={kernelName:Bp,backendName:"webgl",kernelFunc:Yke};function Qke(e){let{inputs:t,backend:n}=e,{s0:r,s1:a}=t,i=n.readSync(r.dataId),s=n.readSync(a.dataId),o=T.assertAndGetBroadcastShape(Array.from(i),Array.from(s));return n.makeTensorInfo([o.length],"int32",Int32Array.from(o))}var Jke={kernelName:ag,backendName:"webgl",kernelFunc:Qke},eSe="return float(a != b);",RU=Zn({opSnippet:eSe,cpuKernelImpl:Swe,dtype:"bool"}),tSe={kernelName:ch,backendName:"webgl",kernelFunc:RU};function ny(e){let{inputs:t,backend:n}=e,{input:r}=t,a=n.texData.get(r.dataId);return ga({inputs:{x:a.complexTensorInfos.real},backend:n})}var nSe={kernelName:sx,backendName:"webgl",kernelFunc:ny},rSe="return float(int(x));";function aSe(e,t){let n=new Zi(e.shape,rSe),r=t.runWebGLProgram(n,[e],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}function PS(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{dtype:i}=r;if(i==="complex64"){if(a.dtype==="complex64")return ga({inputs:{x:a},backend:n});let s=qt(a.shape),o=PS({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),l=nl({inputs:{real:o,imag:s},backend:n});return s.dispose(),n.disposeIntermediateTensorInfo(o),l}if(a.dtype==="complex64"){let s=ny({inputs:{input:a},backend:n}),o=PS({inputs:{x:s},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(s),o}if(!k.hasEncodingLoss(a.dtype,i)){let s=ga({inputs:{x:a},backend:n});return{dataId:s.dataId,shape:s.shape,dtype:i}}if(n.shouldExecuteOnCPU([a])){let s=n.texData.get(a.dataId).values,[o,l,c]=rwe(s,a.shape,a.dtype,i);return n.makeTensorInfo(o,l,c)}if(i==="int32")return aSe(a,n);if(i==="bool"){let s=n.makeTensorInfo([],"bool",k.getTypedArrayFromDType("bool",1)),o=RU({inputs:{a,b:s},backend:n});return n.disposeIntermediateTensorInfo(s),o}throw new Error("Error in Cast: failed to cast ".concat(a.dtype," to ").concat(i))}var iSe={kernelName:Au,backendName:"webgl",kernelFunc:PS},dD="return ceil(x);",sSe=it({opSnippet:dD,packedOpSnippet:dD,cpuKernelImpl:awe}),oSe={kernelName:Ru,backendName:"webgl",kernelFunc:sSe},lSe=class{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode="\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}},uSe=class{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode="\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}};function cSe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{clipValueMin:i,clipValueMax:s}=r,o;Z().getBool("WEBGL_PACK_CLIP")?o=new uSe(a.shape):o=new lSe(a.shape);let l=[[i],[s]];return n.runWebGLProgram(o,[a],a.dtype,l)}var dSe={kernelName:qo,backendName:"webgl",kernelFunc:cSe},pSe=class{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}};function pD(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}function hSe(e){let{inputs:t,backend:n}=e,{x:r}=t,a=n.texData.get(r.dataId),i=new pSe(r.shape),s=[pD(r,a.complexTensorInfos.real),pD(r,a.complexTensorInfos.imag)];return n.runWebGLProgram(i,s,s[0].dtype)}var fSe={kernelName:ig,backendName:"webgl",kernelFunc:hSe},mSe=class{constructor(e){this.outputShape=[],this.outputShape=T.computeOutShape(e,1),this.variableNames=e.map((i,s)=>"T".concat(s));let t=new Array(e.length-1);t[0]=e[0][1];for(let i=1;i<t.length;i++)t[i]=t[i-1]+e[i][1];let n=["if (yC < ".concat(t[0],") setOutput(getT0(yR, yC));")];for(let i=1;i<t.length;i++){let s=t[i-1];n.push("else if (yC < ".concat(t[i],") setOutput(getT").concat(i,"(yR, yC-").concat(s,"));"))}let r=t.length,a=t[t.length-1];n.push("else setOutput(getT".concat(r,"(yR, yC-").concat(a,"));")),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ".concat(n.join("\n        "),"\n      }\n    ")}},gSe=class{constructor(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=T.computeOutShape(e,t);let n=this.outputShape,r=n.length,a=St(r),i=xr("coords",r),s=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map((f,m)=>"T".concat(m));let o=new Array(e.length-1);o[0]=e[0][t];for(let f=1;f<o.length;f++)o[f]=o[f-1]+e[f][t];let l=s[t],c=s.slice(-2),u=s.join(),d="if (".concat(l," < ").concat(o[0],") {\n        return getChannel(\n            getT0(").concat(u,"), vec2(").concat(c.join(),"));\n        }");for(let f=1;f<o.length;f++){let m=o[f-1];d+="\n        if (".concat(l," < ").concat(o[f],"  && ").concat(l," >= ").concat(o[f-1],") {\n          return getChannel(\n            getT").concat(f,"(").concat(tb(s,l,m),"),\n            vec2(").concat(tb(c,l,m),"));\n        }")}let p=o.length,h=o[o.length-1];d+="\n        return getChannel(\n          getT".concat(p,"(").concat(tb(s,l,h),"),\n          vec2(").concat(tb(c,l,h),"));"),this.userCode="\n      float getValue(".concat(s.map(f=>"int "+f),") {\n        ").concat(d,"\n      }\n\n      void main() {\n        ").concat(a," coords = getOutputCoords();\n        vec4 result = vec4(getValue(").concat(i,"), 0., 0., 0.);\n\n        ").concat(i[r-1]," = ").concat(i[r-1]," + 1;\n        if (").concat(i[r-1]," < ").concat(n[r-1],") {\n          result.g = getValue(").concat(i,");\n        }\n\n        ").concat(i[r-2]," = ").concat(i[r-2]," + 1;\n        if (").concat(i[r-2]," < ").concat(n[r-2],") {\n          result.a = getValue(").concat(i,");\n        }\n\n        ").concat(i[r-1]," = ").concat(i[r-1]," - 1;\n        if (").concat(i[r-2]," < ").concat(n[r-2]," &&\n            ").concat(i[r-1]," < ").concat(n[r-1],") {\n          result.b = getValue(").concat(i,");\n        }\n        setOutput(result);\n      }\n    ")}};function tb(e,t,n){let r=e.indexOf(t);return e.map((a,i)=>i===r?"".concat(a," - ").concat(n):a).join()}function fw(e){let{inputs:t,backend:n}=e,{input:r}=t,a=n.texData.get(r.dataId);return ga({inputs:{x:a.complexTensorInfos.imag},backend:n})}var ySe={kernelName:nx,backendName:"webgl",kernelFunc:fw};function Rf(e,t,n){let r=e[0].dtype;if(r==="complex64"){let h=e.map(b=>ny({inputs:{input:b},backend:n})),f=e.map(b=>fw({inputs:{input:b},backend:n})),m=Rf(h,t,n),g=Rf(f,t,n),y=nl({inputs:{real:m,imag:g},backend:n});return h.forEach(b=>n.disposeIntermediateTensorInfo(b)),f.forEach(b=>n.disposeIntermediateTensorInfo(b)),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),y}let a=n.shouldExecuteOnCPU(e);if(r==="string"&&(a=!0),a){let h=e.map(x=>{let w=[-1,k.sizeFromShape(x.shape.slice(t))];return ye({inputs:{x},backend:n,attrs:{shape:w}})}),f=h.map(x=>({vals:n.readSync(x.dataId),shape:x.shape})),m=T.computeOutShape(h.map(x=>x.shape),1),g=h[0].shape[0]===1,y=iwe(f,m,r,g),b=T.computeOutShape(e.map(x=>x.shape),t),v=n.makeTensorInfo(b,r,y);return h.forEach(x=>n.disposeIntermediateTensorInfo(x)),v}let i=e.filter(h=>k.sizeFromShape(h.shape)>0),s=Z().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&i[0].shape.length>1;if(i.length===1){let h=s?new Zi(e[0].shape,to):new po(e[0].shape,to);return n.runWebGLProgram(h,e,r)}let o=Z().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(i.length>o){let h=[];for(let m=0;m<i.length;m+=o){let g=i.slice(m,m+o);h.push(Rf(g,t,n))}let f=Rf(h,t,n);for(let m of h)n.disposeIntermediateTensorInfo(m);return f}if(s){let h=new gSe(i.map(f=>f.shape),t);return n.runWebGLProgram(h,i,r)}let{tensors2D:l,outShape:c}=bSe(i,t,n),u=new mSe(l.map(h=>h.shape)),d=n.runWebGLProgram(u,l,r);l.forEach(h=>n.disposeIntermediateTensorInfo(h));let p=ye({inputs:{x:d},attrs:{shape:c},backend:n});return n.disposeIntermediateTensorInfo(d),p}function bSe(e,t,n){let r=T.computeOutShape(e.map(a=>a.shape),t);return{tensors2D:e.map(a=>ye({inputs:{x:a},attrs:{shape:[-1,k.sizeFromShape(a.shape.slice(t))]},backend:n})),outShape:r}}function DU(e){let{inputs:t,backend:n,attrs:r}=e,{axis:a}=r,i=k.parseAxisParam(a,t[0].shape)[0],s=t.map(c=>c.shape);T.assertParamsConsistent(s,i);let o=T.computeOutShape(t.map(c=>c.shape),i);if(k.sizeFromShape(o)===0)return n.makeTensorInfo(o,t[0].dtype,[]);let l=t.filter(c=>k.sizeFromShape(c.shape)>0);return l.length===1?ga({inputs:{x:l[0]},backend:n}):Rf(l,i,n)}var vSe={kernelName:Wp,backendName:"webgl",kernelFunc:DU},FU=class{constructor(e,t=!1,n=null,r=!1,a=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;let i=e.padInfo.top,s=e.padInfo.left,o=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,u=e.dilationWidth,d=e.filterHeight,p=e.filterWidth,h=Math.floor(e.inChannels/4)*4,f=e.inChannels%4,m=e.dataFormat==="channelsLast",g=m?1:2,y=m?2:3,b=m?3:1,v="",x="";n&&(r?v="float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):a?v="float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):v="\n          float activation(float x) {\n            ".concat(n,"\n          }\n        "),x="result = activation(result);");let w=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(v,"\n\n      const ivec2 strides = ivec2(").concat(o,", ").concat(l,");\n      const ivec2 pads = ivec2(").concat(i,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[").concat(b,"];\n\n        ivec2 xRCCorner =\n            ivec2(coords[").concat(g,"], coords[").concat(y,"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(d,"; wR++) {\n          int xR = xRCorner + wR * ").concat(c,";\n\n          if (xR < 0 || xR >= ").concat(e.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(p,"; wC++) {\n            int xC = xCCorner + wC * ").concat(u,";\n\n            if (xC < 0 || xC >= ").concat(e.inWidth,") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ").concat(h,"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (").concat(m,") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (").concat(f===1,") {\n\n              if (").concat(m,") {\n                dotProd +=\n                    getX(batch, xR, xC, ").concat(h,") *\n                    getW(wR, wC, ").concat(h,", d2);\n              } else {\n                dotProd +=\n                    getX(batch, ").concat(h,", xR, xC) *\n                    getW(wR, wC, ").concat(h,", d2);\n              }\n\n            } else if (").concat(f===2,") {\n              vec2 wValues = vec2(\n                getW(wR, wC, ").concat(h,", d2),\n                getW(wR, wC, ").concat(h," + 1, d2)\n              );\n\n              if (").concat(m,") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ").concat(h,"),\n                  getX(batch, xR, xC, ").concat(h," + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ").concat(h,", xR, xC),\n                  getX(batch, ").concat(h," + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (").concat(f===3,") {\n              vec3 wValues = vec3(\n                getW(wR, wC, ").concat(h,", d2),\n                getW(wR, wC, ").concat(h," + 1, d2),\n                getW(wR, wC, ").concat(h," + 2, d2)\n              );\n\n              if (").concat(m,") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ").concat(h,"),\n                  getX(batch, xR, xC, ").concat(h," + 1),\n                  getX(batch, xR, xC, ").concat(h," + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ").concat(h,", xR, xC),\n                  getX(batch, ").concat(h," + 1, xR, xC),\n                  getX(batch, ").concat(h," + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ").concat(w,"\n        ").concat(x,"\n        setOutput(result);\n      }\n    ")}},xSe=class{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;let t=e.padInfo.front,n=e.padInfo.top,r=e.padInfo.left,a=e.strideDepth,i=e.strideHeight,s=e.strideWidth,o=e.dilationDepth,l=e.dilationHeight,c=e.dilationWidth,u=e.filterDepth,d=e.filterHeight,p=e.filterWidth,h=Math.floor(e.inChannels/4)*4,f=e.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3(".concat(a,", ").concat(i,", ").concat(s,");\n      const ivec3 pads = ivec3(").concat(t,", ").concat(n,", ").concat(r,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(u,"; wF++) {\n          int xF = xFCorner + wF * ").concat(o,";\n\n          if (xF < 0 || xF >= ").concat(e.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(d,"; wR++) {\n            int xR = xRCorner + wR * ").concat(l,";\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(p,"; wC++) {\n              int xC = xCCorner + wC * ").concat(c,";\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ").concat(h,"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (").concat(f===1,") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ").concat(h,") *\n                  getW(wF, wR, wC, ").concat(h,", d2);\n              } else if (").concat(f===2,") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ").concat(h,"),\n                  getX(batch, xF, xR, xC, ").concat(h," + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ").concat(h,", d2),\n                  getW(wF, wR, wC, ").concat(h," + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (").concat(f===3,") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ").concat(h,"),\n                  getX(batch, xF, xR, xC, ").concat(h," + 1),\n                  getX(batch, xF, xR, xC, ").concat(h," + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ").concat(h,", d2),\n                  getW(wF, wR, wC, ").concat(h," + 1, d2),\n                  getW(wF, wR, wC, ").concat(h," + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}},MU=class{constructor(e,t=!1,n=null,r=!1,a=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=dr(this.outputShape.length);let i=e.padInfo.left,s=e.strideWidth,o=e.dilationWidth,l=e.filterHeight,c=e.filterWidth,u=c,d="\n       int xR; int xC; int xCOffset;\n       vec4 wTexel; vec4 previous; vec4 final;";for(let m=0;m<c;m++)d+="\n           vec4 xTexelC".concat(m*2,";\n           int xTexelC").concat(m*2,"Ready;\n           vec4 xTexelC").concat(m*2+1,";\n           int xTexelC").concat(m*2+1,"Ready;\n           vec4 xC").concat(m,";");d+="\n     for (int r = 0; r < ".concat(l,"; r++) {\n      for (int d1 = 0; d1 < ").concat(e.inChannels,"; d1 += 2) {\n       ");for(let m=0;m<c;m++)d+="\n           xTexelC".concat(m*2," = vec4(0.0);\n           xTexelC").concat(m*2,"Ready = 0;\n           xTexelC").concat(m*2+1," = vec4(0.0);\n           xTexelC").concat(m*2+1,"Ready = 0;\n           xC").concat(m," = vec4(0.0);");d+="\n         xR = xRCorner + r * dilations[0];\n         if (xR >=0 && xR < inDims[0]) {\n       ";for(let m=0;m<(u+1)/2;m++){let g=m*2;if(d+="\n           xC = xCCorner + ".concat(g*o,";\n           "),s===1){if(g<c&&(i%2===1?(d+="\n                 xCOffset = xC + 1;\n                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(g,"Ready == 0) {\n                   xTexelC").concat(g," = getX(batch, xR, xCOffset, d1);\n\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(g,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(g,"Ready = 1;\n                 }\n               "),o===1&&g>0?d+="\n                 xC".concat(g," = vec4(xTexelC").concat(g-2,".zw, xTexelC").concat(g,".xy);\n                 "):d+="\n                   xCOffset = xC + 1 - 2;\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       previous.zw = vec2(0.0);\n                     }\n\n                     xC".concat(g," = vec4(previous.zw, xTexelC").concat(g,".xy);\n                   } else {\n                     xC").concat(g," = vec4(0.0, 0.0, xTexelC").concat(g,".xy);\n                   }\n                   ")):d+="\n                 if (xC >= 0 && xC < inDims[1] && xTexelC".concat(g,"Ready == 0) {\n                   xTexelC").concat(g," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(g,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(g,"Ready = 1;\n                 }\n\n                 xC").concat(g," = xTexelC").concat(g,";\n                 "),g+1<c)){let y=i%2===0?k.nearestLargerEven(o):o;o%2===0&&i%2===1||o%2!==0&&i%2!==1?(d+="\n                   xCOffset = xC + imod(pads[1], 2) + ".concat(y,";\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(g+1,"Ready == 0) {\n                     xTexelC").concat(g+1," = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       xTexelC").concat(g+1,".zw = vec2(0.0);\n                     }\n                     xTexelC").concat(g+1,"Ready = 1;\n                   }\n                   "),o>1?d+="\n                     xCOffset -= 2;\n                     if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                      previous = getX(batch, xR, xCOffset, d1);\n                      xC".concat(g+1," = vec4(previous.zw, xTexelC").concat(g+1,".xy);\n                     } else {\n                      xC").concat(g+1," = vec4(0.0, 0.0, xTexelC").concat(g+1,".xy);\n                     }\n                     "):d+="\n                     xC".concat(g+1," = vec4(xTexelC").concat(g,".zw, xTexelC").concat(g+1,".xy);\n                     ")):y===1?d+="\n                     xC".concat(g+1," = xTexelC").concat(g,";\n                     "):d+="\n                     xCOffset = xC + ".concat(y,";\n\n                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(g+1,"Ready == 0) {\n                       xTexelC").concat(g+1," = getX(batch, xR, xCOffset, d1);\n                       if (xCOffset + 1 >= inDims[1]) {\n                         xTexelC").concat(g+1,".zw = vec2(0.0);\n                       }\n                       xTexelC").concat(g+1,"Ready = 1;\n                     }\n\n                     xC").concat(g+1," = xTexelC").concat(g+1,";\n                     ")}}else g<c&&(i%2===1?(d+="\n                 xCOffset = xC + 1 - strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(g,"Ready == 0) {\n                   xTexelC").concat(g," = getX(batch, xR, xCOffset, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(g,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(g,"Ready = 1;\n                 }\n\n                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(g+1,"Ready == 0) {\n                   xTexelC").concat(g+1," = getX(batch, xR, xC + 1, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xC + 2 >= inDims[1]) {\n                     xTexelC").concat(g+1,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(g+1,"Ready = 1;\n                 }\n\n                 xC").concat(g," = vec4(xTexelC").concat(g,".zw, xTexelC").concat(g+1,".zw);\n               "),g+1<c&&(d+="\n                   final = vec4(0.0);\n                   xCOffset = xC + 1 + strides[1];\n                   if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                     final = getX(batch, xR, xCOffset, d1);\n                   }\n                   xC".concat(g+1," = vec4(xTexelC").concat(g+1,".xy, final.xy);\n                 "))):(d+="\n                 if(xC >= 0 && xC < inDims[1] && xTexelC".concat(g,"Ready == 0) {\n                   xTexelC").concat(g," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(g,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(g,"Ready = 1;\n                 }\n\n                 xCOffset = xC + strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(g+1,"Ready == 0) {\n                   xTexelC").concat(g+1," = getX(batch, xR, xCOffset, d1);\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(g+1,".zw = vec2(0.);\n                   }\n                   xTexelC").concat(g+1,"Ready = 1;\n                 }\n\n                 xC").concat(g," = vec4(\n                   xTexelC").concat(g,".xy, xTexelC").concat(g+1,".xy);\n               "),g+1<c&&(d+="\n                   xC".concat(g+1," = vec4(xTexelC").concat(g,".zw, xTexelC").concat(g+1,".zw);\n                 "))));g<c&&(d+="\n             wTexel = getW(r, ".concat(g,", d1, d2);\n             dotProd += xC").concat(g,".xxzz * vec4(wTexel.xy, wTexel.xy);\n             if(d1 + 1 < ").concat(e.inChannels,") {\n               dotProd += xC").concat(g,".yyww * vec4(wTexel.zw, wTexel.zw);\n             }\n           "),g+1<c&&(d+="\n               wTexel = getW(r, ".concat(g+1,", d1, d2);\n               dotProd += xC").concat(g+1,".xxzz * vec4(wTexel.xy, wTexel.xy);\n               if(d1 + 1 < ").concat(e.inChannels,") {\n                 dotProd += xC").concat(g+1,".yyww * vec4(wTexel.zw, wTexel.zw);\n               }\n             ")))}d+="\n     }\n   ",d+="\n     }\n   ",d+="\n     }\n   ";let p="",h="";n&&(r?p="vec4 activation(vec4 a) {\n           vec4 b = getPreluActivationWeightsAtOutCoords();\n           ".concat(n,"\n         }"):a?p="vec4 activation(vec4 a) {\n           vec4 b = getLeakyreluAlphaAtOutCoords();\n           ".concat(n,"\n         }"):p="vec4 activation(vec4 x) {\n           ".concat(n,"\n         }"),h="result = activation(result);");let f=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n       ".concat(p,"\n\n       void main() {\n         ivec4 coords = getOutputCoords();\n         int batch = coords.x;\n         ivec2 xRCCorner = coords.yz * strides - pads;\n         int d2 = coords.w;\n         int xRCorner = xRCCorner.x;\n         int xCCorner = xRCCorner.y;\n\n         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n         vec4 dotProd = vec4(0.000000000000001);\n\n         ").concat(d,"\n\n         vec4 result = dotProd - vec4(0.000000000000001);\n         ").concat(f,"\n         ").concat(h,"\n         setOutput(result);\n       }\n     ")}},wSe=class{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=dr(this.outputShape.length);let{dataFormat:n}=t,r=Fr(),a=n==="channelsLast",i=a?1:2,s=a?2:3,o=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":"if(blockIndex < ".concat(e[2]," && pos < ").concat(e[1],") {"),l="";for(let c=0;c<=1;c++)for(let u=0;u<=1;u++)l+="\n          blockIndex = rc.z + ".concat(u,";\n          pos = rc.y + ").concat(c,";\n\n          ").concat(o,"\n            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];\n            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);\n\n            if(d0 < inputShape[").concat(i,"] && d0 >= 0) {\n              // Use custom imod instead mod. On Intel GPU, mod may generate\n              // unexpected value.\n              // https://github.com/tensorflow/tfjs/issues/5447\n              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];\n              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /\n                  inChannels);\n\n              if(d1 < inputShape[").concat(s,"] && d1 >= 0) {\n\n                ch = imod(pos, inChannels);\n\n                if (").concat(a,") {\n                  innerDims = vec2(d1, ch);\n                  result[").concat(c*2+u,"] = getChannel(\n                    getA(rc.x, d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[").concat(c*2+u,"] = getChannel(\n                    getA(rc.x, ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ");this.userCode="\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ".concat(l,"\n\n        ").concat(r.output," = result;\n      }\n    ")}};function Hv(e,t){let n=e.length;return n>=3?t?[...e.slice(0,-3),e[n-3]*e[n-2],e[n-1]]:[...e.slice(0,-3),e[n-3],e[n-2]*e[n-1]]:!t&&n===1&&e[0]>1?[e[0],1]:null}function OU({x:e,filter:t,convInfo:n,backend:r,bias:a=null,preluActivationWeights:i=null,leakyreluAlpha:s=0,activation:o=null}){let l=e.shape,c=r.texData.get(e.dataId),u=n.inChannels,d=l[0]*l[1]*l[2],p=n.outChannels,h=n.dataFormat==="channelsLast",f=!1,m=!1,g,y=[];if(i!=null){let b=Hv(i.shape,h);b!=null&&(i=ye({inputs:{x:i},backend:r,attrs:{shape:b}}),y.push(i))}if(a!=null){let b=Hv(a.shape,h);b!=null&&(a=ye({inputs:{x:a},backend:r,attrs:{shape:b}}),y.push(a))}if(!((d===1||p===1)&&u>TU)&&c.isPacked&&h&&c.texture!=null&&l[2]%2!==0&&k.arraysEqual(c.shape.slice(-3),l.slice(-3))){let b=l[0]*l[1]*(l[2]+1),v={dataId:e.dataId,shape:[1,b,n.inChannels],dtype:e.dtype},x=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,k.assert(Fm(c.shape,v.shape),()=>"packed reshape ".concat(c.shape," to ").concat(v.shape," isn't free"));let w=ye({inputs:{x:t},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});y.push(w);let $=Vv({a:v,b:w,backend:r,transposeA:f,transposeB:m,bias:a,activation:o,preluActivationWeights:i,leakyreluAlpha:s}),C=r.texData.get($.dataId);k.assert(C.isPacked,()=>"batchMatMul result is expected to be packed"),c.shape=x,C.shape=n.outShape,g=ga({inputs:{x:$},backend:r}),g.shape=n.outShape,y.push($)}else{let b=n.outHeight*n.outWidth,v=ye({inputs:{x:e},backend:r,attrs:{shape:h?[n.batchSize,b,n.inChannels]:[n.batchSize,n.inChannels,b]}}),x=ye({inputs:{x:t},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}}),w=Vv({a:h?v:x,b:h?x:v,transposeA:!h,transposeB:m,backend:r,bias:a,activation:o,preluActivationWeights:i,leakyreluAlpha:s});g=ye({inputs:{x:w},backend:r,attrs:{shape:n.outShape}}),y.push(v),y.push(x),y.push(w)}for(let b of y)r.disposeIntermediateTensorInfo(b);return g}function LU({x:e,filter:t,convInfo:n,backend:r,bias:a=null,preluActivationWeights:i=null,leakyreluAlpha:s=0,activation:o=null}){let{filterWidth:l,filterHeight:c,inChannels:u,outWidth:d,outHeight:p,dataFormat:h}=n,f=h==="channelsLast",m=l*c*u,g=p*d,y=[n.batchSize,m,g],b=!0,v=!1,x=[];if(i!=null){let F=Hv(i.shape,f);F!=null&&(i=ye({inputs:{x:i},backend:r,attrs:{shape:F}}),x.push(i))}if(a!=null){let F=Hv(a.shape,f);F!=null&&(a=ye({inputs:{x:a},backend:r,attrs:{shape:F}}),x.push(a))}let w=ye({inputs:{x:t},backend:r,attrs:{shape:[1,m,k.sizeFromShape(t.shape)/m]}});x.push(w);let $=new wSe(y,n),C=[e.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],E=r.runWebGLProgram($,[e],"float32",C),_=ye({inputs:{x:E},backend:r,attrs:{shape:y}});x.push(E),x.push(_);let R=a!=null,N=i!=null,I=o==="leakyrelu",O=o?Mm(o,!0):null,P=new EU(f?_.shape:w.shape,f?w.shape:_.shape,f?[n.batchSize,g,n.outChannels]:[n.batchSize,n.outChannels,g],b,v,R,O,N,I),L=f?[_,w]:[w,_];if(a&&L.push(a),N&&L.push(i),I){let F=r.makeTensorInfo([],"float32",k.createScalarValue(s,"float32"));L.push(F),x.push(F)}let U=r.runWebGLProgram(P,L,"float32"),D=ye({inputs:{x:U},backend:r,attrs:{shape:n.outShape}});x.push(U);for(let F of x)r.disposeIntermediateTensorInfo(F);return D}function kSe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:s,pad:o,dataFormat:l,dilations:c,dimRoundingMode:u}=r,d=T.convertConv2DDataFormat(l),p=T.computeConv2DInfo(a.shape,i.shape,s,c,o,u,!1,d),h;if(p.filterHeight===1&&p.filterWidth===1&&p.dilationHeight===1&&p.dilationWidth===1&&p.strideHeight===1&&p.strideWidth===1&&(p.padInfo.type==="SAME"||p.padInfo.type==="VALID"))h=OU({x:a,filter:i,convInfo:p,backend:n});else if(p.strideWidth<=2&&d==="channelsLast"&&Z().getBool("WEBGL_EXP_CONV")){let m=new MU(p),g=[[p.padInfo.top,p.padInfo.left],[p.strideHeight,p.strideWidth],[p.dilationHeight,p.dilationWidth],[p.inHeight,p.inWidth]];h=n.runWebGLProgram(m,[a,i],"float32",g)}else if(Z().getBool("WEBGL_CONV_IM2COL"))h=LU({x:a,filter:i,convInfo:p,backend:n});else{let m=new FU(p);h=n.runWebGLProgram(m,[a,i],"float32")}let f=ye({inputs:{x:h},backend:n,attrs:{shape:p.outShape}});return n.disposeIntermediateTensorInfo(h),f}var SSe={kernelName:Du,backendName:"webgl",kernelFunc:kSe},ISe=class{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;let t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,a=e.padInfo.left,i=e.dataFormat==="channelsLast";this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(e.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(e.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(t," - ").concat(r,";\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(e.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(n," - ").concat(a,";\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              ").concat(i?"float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);":"float dyValue = getDy(b, d2, yR, yC);\n              float xValue = getX(b, d1, xR, xC);\n              dotProd += (xValue * dyValue);","\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}},$Se=class{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;let t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,a=e.strideWidth,i=e.dataFormat==="channelsLast",s=t-1-e.padInfo.top,o=n-1-e.padInfo.left,l=i?1:2,c=i?2:3,u=i?3:1;this.userCode="\n      const ivec2 pads = ivec2(".concat(s,", ").concat(o,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[").concat(u,"];\n\n        ivec2 dyCorner = ivec2(coords[").concat(l,"], coords[").concat(c,"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(t,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(t," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(a,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2++) {\n\n              if (").concat(i,") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}},CSe=class{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;let t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,a=e.padInfo.front,i=e.padInfo.top,s=e.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(e.batchSize,"; b++) {\n          for (int yF = 0; yF < ").concat(e.outDepth,"; yF++) {\n            int xF = wF + yF * ").concat(t," - ").concat(a,";\n\n            if (xF < 0 || xF >= ").concat(e.inDepth,") {\n              continue;\n            }\n\n            for (int yR = 0; yR < ").concat(e.outHeight,"; yR++) {\n              int xR = wR + yR * ").concat(n," - ").concat(i,";\n\n              if (xR < 0 || xR >= ").concat(e.inHeight,") {\n                continue;\n              }\n\n              for (int yC = 0; yC < ").concat(e.outWidth,"; yC++) {\n                int xC = wC + yC * ").concat(r," - ").concat(s,";\n\n                if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}},ESe=class{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;let t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,a=e.strideDepth,i=e.strideHeight,s=e.strideWidth,o=t-1-e.padInfo.front,l=n-1-e.padInfo.top,c=r-1-e.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3(".concat(o,", ").concat(l,", ").concat(c,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(t,"; wF++) {\n          float dyF = float(dyFCorner + wF) / ").concat(a,".0;\n\n          if (dyF < 0.0 || dyF >= ").concat(e.outDepth,".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ").concat(t," - 1 - wF;\n\n          for (int wR = 0; wR < ").concat(n,"; wR++) {\n            float dyR = float(dyRCorner + wR) / ").concat(i,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ").concat(n," - 1 - wR;\n\n            for (int wC = 0; wC < ").concat(r,"; wC++) {\n              float dyC = float(dyCCorner + wC) / ").concat(s,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ").concat(r," - 1 - wC;\n\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}};function TSe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,dy:i}=t,{strides:s,pad:o,dataFormat:l,dimRoundingMode:c,filterShape:u}=r,d=T.convertConv2DDataFormat(l),p=T.computeConv2DInfo(a.shape,u,s,1,o,c,!1,d),h=new ISe(p);return n.runWebGLProgram(h,[a,i],"float32")}var NSe={kernelName:Y0,backendName:"webgl",kernelFunc:TSe},_Se=class{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=dr(this.outputShape.length);let t=e.filterHeight,n=e.filterWidth,r=t-1-e.padInfo.top,a=n-1-e.padInfo.left;this.userCode="\n      const ivec2 pads = ivec2(".concat(r,", ").concat(a,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n\n        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        vec4 result = vec4(0.);\n        for (int wR = 0; wR < ").concat(t,"; wR++) {\n          float dyR = float(dyRCorner + wR) / strides[0];\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n          int wRPerm = ").concat(t," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            float dyC = float(dyCCorner + wC) / strides[1];\n            bool idyCVal = (dyC >= 0.0) && (dyC < ").concat(e.outWidth,".0)\n              && (fract(dyC) == 0.0);\n            int idyC = int(dyC);\n\n            float dyC2 = float(dyCCorner + wC + 1) / strides[1];\n            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ").concat(e.outWidth,".0)\n              && (fract(dyC2) == 0.0);\n            int idyC2 = int(dyC2);\n\n            if (idyCVal && idyCVal2) {\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?\n                  dySample : getDy(batch, idyR, idyC2, d2);\n\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n\n                dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample2.xy : dySample2.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal) {\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal2) {\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC2, d2);\n                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            }\n          }\n        }\n        setOutput(result);\n      }\n    ")}};function ASe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:i}=t,{inputShape:s,strides:o,pad:l,dataFormat:c,dimRoundingMode:u}=r,d=T.convertConv2DDataFormat(c),p=T.computeConv2DInfo(s,i.shape,o,1,l,u,!1,d);if(Z().getBool("WEBGL_PACK")&&d==="channelsLast"){let h=[[p.strideHeight,p.strideWidth]],f=new _Se(p);return n.runWebGLProgram(f,[a,i],"float32",h)}else{let h=new $Se(p);return n.runWebGLProgram(h,[a,i],"float32")}}var RSe={kernelName:Fu,backendName:"webgl",kernelFunc:ASe};function DSe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:s,pad:o,dilations:l}=r,c=T.computeConv3DInfo(a.shape,i.shape,s,l,o),u=new xSe(c);return n.runWebGLProgram(u,[a,i],"float32")}var FSe={kernelName:Mu,backendName:"webgl",kernelFunc:DSe};function MSe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,dy:i}=t,{strides:s,pad:o,filterShape:l}=r,c=T.computeConv3DInfo(a.shape,l,s,1,o),u=new CSe(c);return n.runWebGLProgram(u,[a,i],"float32")}var OSe={kernelName:Up,backendName:"webgl",kernelFunc:MSe};function LSe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:i}=t,{pad:s,strides:o,inputShape:l}=r,c=T.computeConv3DInfo(l,i.shape,o,1,s),u=new ESe(c);return n.runWebGLProgram(u,[a,i],"float32")}var PSe={kernelName:Vp,backendName:"webgl",kernelFunc:LSe},zSe=Qh+"\n  return cos(x);\n",BSe="\n  vec4 result = cos(x);\n  bvec4 isNaN = isnan(x);\n  ".concat(Kc,"\n  return result;\n"),WSe=it({opSnippet:zSe,packedOpSnippet:BSe}),USe={kernelName:Ou,backendName:"webgl",kernelFunc:WSe},VSe="\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n",HSe=it({opSnippet:VSe}),jSe={kernelName:Lu,backendName:"webgl",kernelFunc:HSe},GSe=class{constructor(e,t,n,r,a){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];let[i,s,o,l]=e,[c]=t,[u,d]=n;this.outputShape=[c,u,d,l];let p=r==="bilinear"?1:0,[h,f]=["".concat(s-1,".0"),"".concat(o-1,".0")],[m,g,y]=u>1?["".concat((s-1)/(u-1)),"(y2-y1) * height_ratio","y1*".concat(h," + float(y)*(height_scale)")]:["0.0","0.0","0.5 * (y1+y2) * ".concat(h)],[b,v,x]=d>1?["".concat((o-1)/(d-1)),"(x2-x1) * width_ratio","x1*".concat(f," + float(x)*(width_scale)")]:["0.0","0.0","0.5 * (x1+x2) * ".concat(f)];this.userCode="\n      const float height_ratio = float(".concat(m,");\n      const float width_ratio = float(").concat(b,");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ").concat(i,") {\n          return;\n        }\n\n        float height_scale = ").concat(g,";\n        float width_scale = ").concat(v,";\n\n        float in_y = ").concat(y,";\n        if( in_y < 0.0 || in_y > ").concat(h," ) {\n          setOutput(float(").concat(a,"));\n          return;\n        }\n        float in_x = ").concat(x,";\n        if( in_x < 0.0 || in_x > ").concat(f," ) {\n          setOutput(float(").concat(a,"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(").concat(p," == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    ")}},qSe=e=>{let{inputs:t,backend:n,attrs:r}=e,{image:a,boxes:i,boxInd:s}=t,{cropSize:o,method:l,extrapolationValue:c}=r,u=new GSe(a.shape,i.shape,o,l,c);return n.runWebGLProgram(u,[a,i,s],"float32")},KSe={kernelName:jp,backendName:"webgl",kernelFunc:qSe},Lm;(function(e){e.Prod="*",e.Sum="+"})(Lm||(Lm={}));var hD=class{constructor(e,t,n,r){this.op=e,this.outputShape=t,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];let a=this.outputShape.length,i=this.op===Lm.Prod?"1.0":"0.0",s=n?i:"getX(".concat(fD(a,"coords",this.op),")"),o=this.outputShape[this.outputShape.length-1],l="",c="";n?(l=r?"end != ".concat(o-1):"end != 0",c=r?"end + 1":"end - 1"):(l=r?"end + pow2 < ".concat(o):"end >= pow2",c=r?"end + pow2":"end - pow2"),this.userCode="\n      void main() {\n        ".concat(St(a)," coords = getOutputCoords();\n        int end = ").concat(mD(a,"coords",this.op),";\n        float val = ").concat(s,";\n        int pow2 = int(pow(2.0, index));\n        if (").concat(l,") {\n          int idx = ").concat(c,";\n          ").concat(mD(a,"coords",this.op)," = idx;\n          val ").concat(this.op,"= getX(").concat(fD(a,"coords",this.op),");\n        }\n        setOutput(val);\n      }\n    ")}};function fD(e,t,n){if(e===1)return"".concat(t);if(e===2)return"".concat(t,".x, ").concat(t,".y");if(e===3)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z");if(e===4)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z, ").concat(t,".w");throw new Error("Cumulative ".concat(n," for rank ").concat(e," is not yet supported"))}function mD(e,t,n){if(e===1)return"".concat(t);if(e===2)return"".concat(t,".y");if(e===3)return"".concat(t,".z");if(e===4)return"".concat(t,".w");throw new Error("Cumulative ".concat(n," for rank ").concat(e," is not yet supported"))}function PU(e,t,n,r,a,i){let s=t.shape.length,o=T.getAxesPermutation([r],s),l=t;o!=null&&(l=Er({inputs:{x:t},backend:n,attrs:{perm:o}}));let c=T.getInnerMostAxes(1,s)[0];if(c!==s-1)throw new Error("WebGL cumprod shader expects an inner-most axis=".concat(t.shape.length-1," but got axis=").concat(r));let u=l.shape[c],d=ga({inputs:{x:l},backend:n});for(let p=0;p<=Math.ceil(Math.log2(u))-1;p++){let h=new hD(e,l.shape,!1,i),f=[[p]],m=d;d=n.runWebGLProgram(h,[d],d.dtype,f),n.disposeIntermediateTensorInfo(m)}if(a){let p=new hD(e,l.shape,a,i),h=d;d=n.runWebGLProgram(p,[d],d.dtype),n.disposeIntermediateTensorInfo(h)}if(o!=null){let p=T.getUndoAxesPermutation(o),h=Er({inputs:{x:d},backend:n,attrs:{perm:p}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(l),h}return d}function XSe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,exclusive:s,reverse:o}=r;return PU(Lm.Prod,a,n,i,s,o)}var YSe={kernelName:Hp,backendName:"webgl",kernelFunc:XSe};function ZSe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,exclusive:s,reverse:o}=r;return PU(Lm.Sum,a,n,i,s,o)}var QSe={kernelName:Pu,backendName:"webgl",kernelFunc:ZSe};function JSe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,weights:i}=t,{size:s,binaryOutput:o}=r;if(a.shape.length===1){let l=n.readSync(a.dataId),c=n.readSync(i.dataId),u=yU(l,c,i.dtype,i.shape,s);return n.makeTensorInfo([s],i.dtype,u)}else if(a.shape.length===2){let l=n.bufferSync(a),c=n.bufferSync(i),u=twe(l,c,s,o);return n.makeTensorInfo(u.shape,i.dtype,u.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank".concat(a.shape.length,"."))}var eIe={kernelName:sg,backendName:"webgl",kernelFunc:JSe},tIe=class{constructor(e,t,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=n,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ".concat(this.getHeightCoordString(),";\n      int w = ").concat(this.getWidthCoordString(),";\n      int d = ").concat(this.getDepthCoordString(),";\n\n      int in_h = h / ").concat(t,";\n      int offset_h = imod(h, ").concat(t,");\n      int in_w = w / ").concat(t,";\n      int offset_w = imod(w, ").concat(t,");\n      int offset_d = (offset_h * ").concat(t," + offset_w) *\n        ").concat(this.getOutputDepthSize(),";\n      int in_d = d + offset_d;\n\n      float result = ").concat(this.getInputSamplingString(),";\n      setOutput(result);\n    }\n  ")}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}};function nIe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockSize:i,dataFormat:s}=r,o=a.shape[0],l=s==="NHWC"?a.shape[1]:a.shape[2],c=s==="NHWC"?a.shape[2]:a.shape[3],u=s==="NHWC"?a.shape[3]:a.shape[1],d=l*i,p=c*i,h=u/(i*i),f=s==="NHWC"?[o,d,p,h]:[o,h,d,p],m=new tIe(f,i,s);return n.runWebGLProgram(m,[a],a.dtype)}var rIe={kernelName:Gp,backendName:"webgl",kernelFunc:nIe},zU=class{constructor(e,t=!1,n=null,r=!1,a=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=dr(this.outputShape.length);let i=e.filterHeight,s=e.filterWidth,o=e.outChannels/e.inChannels,l="",c="";n&&(r?l="float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):a?l="float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):l="\n          float activation(float x) {\n            ".concat(n,"\n          }\n        "),c="result = activation(result);");let u=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(l,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(o,";\n        int q = d2 - d1 * ").concat(o,";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ").concat(i,"; wR++) {\n          int xR = xRCorner + wR * dilations[0];\n\n          if (xR < 0 || xR >= inDims[0]) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(s,"; wC++) {\n            int xC = xCCorner + wC * dilations[1];\n\n            if (xC < 0 || xC >= inDims[1]) {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ").concat(u,"\n        ").concat(c,"\n        setOutput(result);\n      }\n    ")}},BU=class{constructor(e,t=!1,n=null,r=!1,a=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=dr(this.outputShape.length);let i=e.outChannels/e.inChannels,s=e.padInfo.left,o=e.strideWidth,l=e.dilationWidth,c=e.filterHeight,u=e.filterWidth,d=u,p="\n      int xR; int xC; int xCOffset;\n      vec4 wTexel; vec4 previous; vec4 final;";for(let g=0;g<u;g++)p+="\n          vec4 xTexelC".concat(g*2,";\n          int xTexelC").concat(g*2,"Ready;\n          vec4 xTexelC").concat(g*2+1,";\n          int xTexelC").concat(g*2+1,"Ready;\n          vec4 xC").concat(g,";");p+="\n    for (int r = 0; r < ".concat(c,"; r++) {\n      ");for(let g=0;g<u;g++)p+="\n          xTexelC".concat(g*2," = vec4(0.0);\n          xTexelC").concat(g*2,"Ready = 0;\n          xTexelC").concat(g*2+1," = vec4(0.0);\n          xTexelC").concat(g*2+1,"Ready = 0;\n          xC").concat(g," = vec4(0.0);");p+="\n        xR = xRCorner + r * dilations[0];\n        if (xR >=0 && xR < inDims[0]) {\n      ";for(let g=0;g<(d+1)/2;g++){let y=g*2;if(p+="\n          xC = xCCorner + ".concat(y*l,";\n          "),o===1){if(y<u&&(s%2===1?(p+="\n                xCOffset = xC + 1;\n                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(y,"Ready == 0) {\n                  xTexelC").concat(y," = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(y,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(y,"Ready = 1;\n                }\n              "),l===1&&y>0?p+="\n                xC".concat(y," = vec4(xTexelC").concat(y-2,".zw, xTexelC").concat(y,".xy);\n                "):p+="\n                  xCOffset = xC + 1 - 2;\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                    previous = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      previous.zw = vec2(0.0);\n                    }\n\n                    xC".concat(y," = vec4(previous.zw, xTexelC").concat(y,".xy);\n                  } else {\n                    xC").concat(y," = vec4(0.0, 0.0, xTexelC").concat(y,".xy);\n                  }\n                  ")):p+="\n                if (xC >= 0 && xC < inDims[1] && xTexelC".concat(y,"Ready == 0) {\n                  xTexelC").concat(y," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(y,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(y,"Ready = 1;\n                }\n\n                xC").concat(y," = xTexelC").concat(y,";\n                "),y+1<u)){let b=s%2===0?k.nearestLargerEven(l):l;l%2===0&&s%2===1||l%2!==0&&s%2!==1?(p+="\n                  xCOffset = xC + imod(pads[1], 2) + ".concat(b,";\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(y+1,"Ready == 0) {\n                    xTexelC").concat(y+1," = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      xTexelC").concat(y+1,".zw = vec2(0.0);\n                    }\n                    xTexelC").concat(y+1,"Ready = 1;\n                  }\n                  "),l>1?p+="\n                    xCOffset -= 2;\n                    if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n                     xC".concat(y+1," = vec4(previous.zw, xTexelC").concat(y+1,".xy);\n                    } else {\n                     xC").concat(y+1," = vec4(0.0, 0.0, xTexelC").concat(y+1,".xy);\n                    }\n                    "):p+="\n                    xC".concat(y+1," = vec4(xTexelC").concat(y,".zw, xTexelC").concat(y+1,".xy);\n                    ")):b===1?p+="\n                    xC".concat(y+1," = xTexelC").concat(y,";\n                    "):p+="\n                    xCOffset = xC + ".concat(b,";\n\n                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(y+1,"Ready == 0) {\n                      xTexelC").concat(y+1," = getX(batch, xR, xCOffset, d1);\n                      if (xCOffset + 1 >= inDims[1]) {\n                        xTexelC").concat(y+1,".zw = vec2(0.0);\n                      }\n                      xTexelC").concat(y+1,"Ready = 1;\n                    }\n\n                    xC").concat(y+1," = xTexelC").concat(y+1,";\n                    ")}}else y<u&&(s%2===1?(p+="\n                xCOffset = xC + 1 - strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(y,"Ready == 0) {\n                  xTexelC").concat(y," = getX(batch, xR, xCOffset, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(y,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(y,"Ready = 1;\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(y+1,"Ready == 0) {\n                  xTexelC").concat(y+1," = getX(batch, xR, xC + 1, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xC + 2 >= inDims[1]) {\n                    xTexelC").concat(y+1,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(y+1,"Ready = 1;\n                }\n\n                xC").concat(y," = vec4(xTexelC").concat(y,".zw, xTexelC").concat(y+1,".zw);\n              "),y+1<u&&(p+="\n                  final = vec4(0.0);\n                  xCOffset = xC + 1 + strides[1];\n                  if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xC".concat(y+1," = vec4(xTexelC").concat(y+1,".xy, final.xy);\n                "))):(p+="\n                if(xC >= 0 && xC < inDims[1] && xTexelC".concat(y,"Ready == 0) {\n                  xTexelC").concat(y," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(y,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(y,"Ready = 1;\n                }\n\n                xCOffset = xC + strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(y+1,"Ready == 0) {\n                  xTexelC").concat(y+1," = getX(batch, xR, xCOffset, d1);\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(y+1,".zw = vec2(0.);\n                  }\n                  xTexelC").concat(y+1,"Ready = 1;\n                }\n\n                xC").concat(y," = vec4(\n                  xTexelC").concat(y,".xy, xTexelC").concat(y+1,".xy);\n              "),y+1<u&&(p+="\n                  xC".concat(y+1," = vec4(xTexelC").concat(y,".zw, xTexelC").concat(y+1,".zw);\n                "))));y<u&&(p+="\n            wTexel = getW(r, ".concat(y,", d1, q);\n            dotProd += xC").concat(y," * vec4(wTexel.xz, wTexel.xz);\n          "),y+1<u&&(p+="\n              wTexel = getW(r, ".concat(y+1,", d1, q);\n              dotProd += xC").concat(y+1," * vec4(wTexel.xz, wTexel.xz);\n            ")))}p+="\n    }\n  ",p+="\n      }\n    ";let h="",f="";n&&(r?h="vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):a?h="vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):h="vec4 activation(vec4 x) {\n          ".concat(n,"\n        }"),f="result = activation(result);");let m=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(h,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(i,";\n        int q = d2 - d1 * ").concat(i,";\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n        vec4 dotProd = vec4(0.000000000000001);\n\n        ").concat(p,"\n\n        vec4 result = dotProd - vec4(0.000000000000001);\n        ").concat(m,"\n        ").concat(f,"\n        setOutput(result);\n      }\n    ")}};function aIe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:s,pad:o,dilations:l,dimRoundingMode:c}=r,u=l;u==null&&(u=[1,1]),k.assert(T.eitherStridesOrDilationsAreOne(s,u),()=>"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ".concat(s," and dilations '").concat(u,"'"));let d=T.computeConv2DInfo(a.shape,i.shape,s,u,o,c,!0),p;Z().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?p=new BU(d):p=new zU(d);let h=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(p,[a,i],"float32",h)}var iIe={kernelName:zu,backendName:"webgl",kernelFunc:aIe},sIe=class{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;let t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,a=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ".concat(i," + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ").concat(e.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(e.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(t," - ").concat(r,";\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(e.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(n," - ").concat(a,";\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}},oIe=class{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;let t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,a=e.strideWidth,i=t-1-e.padInfo.top,s=n-1-e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode="\n      const ivec2 pads = ivec2(".concat(i,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ").concat(t,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(t," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(a,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ").concat(o,"; dm++) {\n              int d2 = d1 * ").concat(o," + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}};function lIe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,dy:i}=t,{strides:s,dilations:o,pad:l,dimRoundingMode:c,filterShape:u}=r,d=T.computeConv2DInfo(a.shape,u,s,o,l,c,!0),p=new sIe(d);return n.runWebGLProgram(p,[a,i],"float32")}var uIe={kernelName:Z0,backendName:"webgl",kernelFunc:lIe};function cIe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:i}=t,{strides:s,dilations:o,pad:l,dimRoundingMode:c,inputShape:u}=r,d=T.computeConv2DInfo(u,i.shape,s,o,l,c,!0),p=new oIe(d);return n.runWebGLProgram(p,[a,i],"float32")}var dIe={kernelName:Q0,backendName:"webgl",kernelFunc:cIe},pIe=class{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}};function hIe(e){let{inputs:t,backend:n}=e,{x:r}=t,a=[...r.shape,...r.shape],i=k.sizeFromShape(r.shape),s=ye({inputs:{x:r},backend:n,attrs:{shape:[i]}}),o=new pIe(i),l=n.runWebGLProgram(o,[s],s.dtype),c=ye({inputs:{x:l},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(l),c}var fIe={kernelName:og,backendName:"webgl",kernelFunc:hIe},mIe=class{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;let{inHeight:t,inWidth:n,padInfo:r,strideHeight:a,strideWidth:i,filterHeight:s,filterWidth:o,dilationHeight:l,dilationWidth:c}=e,{top:u,left:d}=r;this.userCode="\n      const ivec2 strides = ivec2(".concat(a,", ").concat(i,");\n      const ivec2 pads = ivec2(").concat(u,", ").concat(d,");\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ").concat(s,"; h++) {\n          int hIn = hBeg + h * ").concat(l,";\n\n          if (hIn >= 0 && hIn < ").concat(t,") {\n            for (int w = 0; w < ").concat(o,"; w++) {\n              int wIn = wBeg + w * ").concat(c,";\n\n              if (wIn >= 0 && wIn < ").concat(n,") {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    ")}};function gIe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:s,pad:o,dilations:l}=r,c=T.computeDilation2DInfo(a.shape,i.shape,s,o,"NHWC",l),u,d=new mIe(c);u=n.runWebGLProgram(d,[a,i],"float32");let p=ye({inputs:{x:u},backend:n,attrs:{shape:c.outShape}});return n.disposeIntermediateTensorInfo(u),p}var yIe={kernelName:Bu,backendName:"webgl",kernelFunc:gIe};function bIe(e){let{inputs:t,backend:n,attrs:r}=e,{equation:a}=r,i=t,{allDims:s,summedDims:o,idDims:l}=T.decodeEinsumEquation(a,i.length);T.checkEinsumDimSizes(s.length,l,i);let{path:c,steps:u}=T.getEinsumComputePath(o,l),d=u.length,p=null,h=s.length,f=[];for(let m=0;m<d;++m){for(let g of u[m]){let{permutationIndices:y,expandDims:b}=T.getEinsumPermutation(h,l[g]),v;T.isIdentityPermutation(y)?v=i[g]:(v=Er({inputs:{x:i[g]},backend:n,attrs:{perm:y}}),f.push(v));let x=v.shape.slice();for(let w=0;w<b.length;++w)x.splice(b[w],0,1);k.arraysEqual(v.shape,x)||(v=ye({inputs:{x:v},backend:n,attrs:{shape:x}}),f.push(v)),p===null?p=v:(p=yT({inputs:{a:v,b:p},backend:n}),f.push(p))}m<d-1&&(c[m]>=0&&(p=hw({inputs:{x:p},backend:n,attrs:{axis:c[m]-(s.length-h),keepDims:!1}}),f.push(p)),h--)}for(let m of f)m!==p&&n.disposeIntermediateTensorInfo(m);return p}var vIe={kernelName:J0,backendName:"webgl",kernelFunc:bIe},xIe="return (x >= 0.0) ? x : (exp(x) - 1.0);",wIe="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",kIe=it({opSnippet:xIe,packedOpSnippet:wIe}),SIe={kernelName:Uu,backendName:"webgl",kernelFunc:kIe},IIe="return (b >= 0.0) ? a : a * (b + 1.0);",$Ie="\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",CIe=e=>{let{inputs:t,backend:n}=e,{dy:r,y:a}=t,i=Z().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Zh($Ie,r.shape,a.shape):new hu(IIe,r.shape,a.shape);return n.runWebGLProgram(i,[r,a],r.dtype)},EIe={kernelName:qp,backendName:"webgl",kernelFunc:CIe},TIe="\n  return vec4(equal(a, b));\n",NIe="return float(a == b);",_Ie=Zn({opSnippet:NIe,packedOpSnippet:TIe,dtype:"bool",cpuKernelImpl:swe}),AIe={kernelName:Kp,backendName:"webgl",kernelFunc:_Ie},RIe='\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = '.concat(T.ERF_P,";\n  float a1 = ").concat(T.ERF_A1,";\n  float a2 = ").concat(T.ERF_A2,";\n  float a3 = ").concat(T.ERF_A3,";\n  float a4 = ").concat(T.ERF_A4,";\n  float a5 = ").concat(T.ERF_A5,";\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n"),DIe=it({opSnippet:RIe}),FIe={kernelName:Vu,backendName:"webgl",kernelFunc:DIe},MIe=Qh+"\n  return exp(x);\n",OIe="\n  vec4 result = exp(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",WU=it({opSnippet:MIe,packedOpSnippet:OIe,cpuKernelImpl:owe,dtype:"float32"}),LIe={kernelName:Hu,backendName:"webgl",kernelFunc:WU};function zS(e){let{inputs:t,attrs:n,backend:r}=e,{dim:a}=n,{input:i}=t,s=i.shape.length,o=i.shape.slice(),l=a;return a<0&&(k.assert(-(s+1)<=a,()=>"Axis must be in the interval [".concat(-(s+1),", ").concat(s,"]")),l=s+a+1),o.splice(l,0,1),ye({inputs:{x:i},backend:r,attrs:{shape:o}})}var PIe={kernelName:Xp,backendName:"webgl",kernelFunc:zS},gD="return exp(x) - 1.0;",zIe=it({opSnippet:gD,packedOpSnippet:gD,cpuKernelImpl:lwe}),BIe={kernelName:ju,backendName:"webgl",kernelFunc:zIe},yD=class{constructor(e,t,n){this.variableNames=["real","imag"];let r=t[1];this.outputShape=t;let a=n?"2.0 * ".concat(Math.PI):"-2.0 * ".concat(Math.PI),i=n?"".concat(r,".0"):"1.0",s;if(e==="real")s="return real * expR - imag * expI;";else if(e==="imag")s="return real * expI + imag * expR;";else throw new Error('FFT component must be either "real" or "imag", got '.concat(e,"."));this.userCode="\n      const float exponentMultiplier = ".concat(a,";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ").concat(s,"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(").concat(r,");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ").concat(r,"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ").concat(i,";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    ")}};function UU(e,t,n){let r=n.texData.get(e.dataId),a=k.sizeFromShape(e.shape),i=e.shape[e.shape.length-1],s=a/i,o=ye({inputs:{x:e},backend:n,attrs:{shape:[s,i]}}),l=o.shape,c=new yD("real",l,t),u=new yD("imag",l,t),d=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:l},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:l}],p=n.runWebGLProgram(c,d,"float32"),h=n.runWebGLProgram(u,d,"float32"),f=nl({inputs:{real:p,imag:h},backend:n});n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h);let m=ye({inputs:{x:f},backend:n,attrs:{shape:e.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(f),m}function WIe(e){let{inputs:t,backend:n}=e,{input:r}=t;return UU(r,!1,n)}var UIe={kernelName:ex,backendName:"webgl",kernelFunc:WIe},VIe=class{constructor(e,t){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode="\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}};function ry(e){let{backend:t,attrs:n}=e,{shape:r,value:a}=n,{dtype:i}=n;if(i=i||k.inferDtype(a),i==="string"){let s=k.getArrayFromDType(i,k.sizeFromShape(r));return s.fill(a),t.makeTensorInfo(r,i,s)}else{let s=new VIe(r,a),o=[[a]];return t.runWebGLProgram(s,[],i,o)}}var HIe={kernelName:lg,backendName:"webgl",kernelFunc:ry},jIe=class{constructor(e){this.variableNames=["Image"],this.outputShape=[];let t=e[2];this.outputShape=e,this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ".concat(t," - x - 1;\n          float outputValue;\n          if(coordX >= 0 && coordX < ").concat(t,") {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")}},GIe={kernelName:Yp,backendName:"webgl",kernelFunc:({inputs:e,backend:t})=>{let{image:n}=e,r=t,a=new jIe(n.shape);return r.runWebGLProgram(a,[n],n.dtype)}},bD="return floor(x);",qIe=it({opSnippet:bD,packedOpSnippet:bD,cpuKernelImpl:uwe}),KIe={kernelName:Gu,backendName:"webgl",kernelFunc:qIe},XIe="\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",YIe="\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",ZIe=Zn({opSnippet:XIe,packedOpSnippet:YIe,dtype:"int32"}),QIe={kernelName:qu,backendName:"webgl",kernelFunc:ZIe},JIe=class{constructor(e){this.variableNames=["A"];let t=Fr(),[n,r]=e;this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(".concat(r,".0, ").concat(n,".0);\n\n        vec4 values = ").concat(t.texture2D,"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    ")}},e$e=class{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;let t=Fr(),[n,r]=e;this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(".concat(r,".0, ").concat(n,".0);\n            vec4 values = ").concat(t.texture2D,"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ").concat(t.output," = result;\n      }\n    ")}},t$e={kernelName:xv,backendName:"webgl",kernelFunc:n$e},od,N1=Z().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function n$e(e){let{inputs:t,backend:n,attrs:r}=e,{pixels:a}=t,{numChannels:i}=r,s=typeof HTMLVideoElement<"u"&&a instanceof HTMLVideoElement,o=typeof HTMLImageElement<"u"&&a instanceof HTMLImageElement,[l,c]=s?[a.videoWidth,a.videoHeight]:[a.width,a.height],u=[c,l],d=[c,l,i];if(o||s){let m=Z().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(od==null||m!==N1)&&(N1=m,od=document.createElement("canvas").getContext("2d",{willReadFrequently:N1})),od.canvas.width=l,od.canvas.height=c,od.drawImage(a,0,0,l,c),a=od.canvas}let p=n.makeTensorInfo(u,"int32");n.texData.get(p.dataId).usage=Ca.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(p.dataId),a);let h=Z().getBool("WEBGL_PACK")?new e$e(d):new JIe(d),f=n.runWebGLProgram(h,[p],"int32");return n.disposeData(p.dataId),f}function r$e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i,bias:s,preluActivationWeights:o}=t,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:p,activation:h,leakyreluAlpha:f}=r,m=T.convertConv2DDataFormat(u),g=T.computeConv2DInfo(a.shape,i.shape,l,d,c,p,!1,m),y,b=[],v=s!=null,x=o!=null,w=h==="leakyrelu",$=()=>{let E=[a,i],_=(R,N)=>{if(N==="NCHW"&&R.shape.length===1&&R.shape[0]!==1){let I=ye({inputs:{x:R},backend:n,attrs:{shape:[R.shape[0],1,1]}});return b.push(I),I}return R};if(v&&E.push(_(s,u)),x&&E.push(_(o,u)),w){let R=n.makeTensorInfo([],"float32",k.createScalarValue(f,"float32"));E.push(R),b.push(R)}return E};if(g.filterHeight===1&&g.filterWidth===1&&g.dilationHeight===1&&g.dilationWidth===1&&g.strideHeight===1&&g.strideWidth===1&&(g.padInfo.type==="SAME"||g.padInfo.type==="VALID"))y=OU({x:a,filter:i,convInfo:g,backend:n,bias:s,activation:h,preluActivationWeights:o,leakyreluAlpha:f});else if(g.strideWidth<=2&&m==="channelsLast"&&Z().getBool("WEBGL_EXP_CONV")){let E=h?Mm(h,!0):null,_=new MU(g,v,E,x,w),R=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],N=$();y=n.runWebGLProgram(_,N,"float32",R)}else if(Z().getBool("WEBGL_CONV_IM2COL"))y=LU({x:a,filter:i,convInfo:g,backend:n,bias:s,activation:h,preluActivationWeights:o,leakyreluAlpha:f});else{let E=h?Mm(h,!1):null,_=new FU(g,v,E,x,w),R=$();y=n.runWebGLProgram(_,R,"float32")}let C=ye({inputs:{x:y},backend:n,attrs:{shape:g.outShape}});return b.push(y),b.forEach(E=>n.disposeIntermediateTensorInfo(E)),C}var a$e={kernelName:Zl,backendName:"webgl",kernelFunc:r$e};function i$e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i,bias:s,preluActivationWeights:o}=t,{strides:l,pad:c,dilations:u,dimRoundingMode:d,activation:p,leakyreluAlpha:h}=r,f=[],m=u;m==null&&(m=[1,1]),k.assert(T.eitherStridesOrDilationsAreOne(l,m),()=>"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ".concat(l," and dilations '").concat(m,"'"));let g=T.computeConv2DInfo(a.shape,i.shape,l,m,c,d,!0),y=Z().getBool("WEBGL_PACK_DEPTHWISECONV")&&g.strideWidth<=2&&g.outChannels/g.inChannels===1,b=p?Mm(p,y):null,v=[a,i],x=s!=null,w=o!=null,$=p==="leakyrelu";if(x&&v.push(s),w&&v.push(o),$){let R=n.makeTensorInfo([],"float32",k.createScalarValue(h,"float32"));v.push(R),f.push(R)}let C;y?C=new BU(g,x,b,w,$):C=new zU(g,x,b,w,$);let E=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],_=n.runWebGLProgram(C,v,"float32",E);return f.forEach(R=>n.disposeIntermediateTensorInfo(R)),_}var s$e={kernelName:Ql,backendName:"webgl",kernelFunc:i$e},o$e=class{constructor(e,t,n,r){this.sliceDim=e,this.strides=t,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=n;let a=St(n.length),i="\n    int index;";for(let s=0;s<this.sliceDim;s++)i+="\n          index = round(getIndices(coords[0], ".concat(s,"));\n          out_of_bounds = out_of_bounds || index < 0;\n          out_of_bounds = out_of_bounds || index >= ").concat(this.paramsShape[s],";\n          flattenIndex += index * ").concat(this.strides[s],";");this.userCode="\n         void main() {\n          ".concat(a," coords = getOutputCoords();\n          int flattenIndex = 0;\n          bool out_of_bounds = false;\n\n          ").concat(i,"\n\n          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));\n        }\n      ")}};function l$e(e){let{inputs:t,backend:n}=e,{params:r,indices:a}=t,i=a.shape,s=i[i.length-1],o=k.sizeFromShape(r.shape),[l,c,u,d]=T.prepareAndValidate(r,a),p=ye({inputs:{x:a},backend:n,attrs:{shape:[c,s]}}),h=ye({inputs:{x:r},backend:n,attrs:{shape:[k.sizeFromShape(r.shape)/u,u]}});if(n.shouldExecuteOnCPU([r,a])||r.dtype==="string"){let y=n.readSync(a.dataId),b=n.bufferSync(r),v=cwe(y,b,r.dtype,c,s,u,d,r.shape,o);return n.makeTensorInfo(l,r.dtype,v.values)}let f=new o$e(s,d,[c,u],r.shape),m=n.runWebGLProgram(f,[h,p],h.dtype),g=ye({inputs:{x:m},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(m),g}var u$e={kernelName:Qp,backendName:"webgl",kernelFunc:l$e},c$e=class{constructor(e,t){this.variableNames=["A","indices"],this.outputShape=t,this.rank=t.length;let n=St(this.rank),r=d$e(e);this.userCode="\n      void main() {\n        ".concat(n," resRC = getOutputCoords();\n        int index = int(getIndices(resRC.x, resRC.z));\n        float inBounds = (index >= 0) && (index < ").concat(e[2],") ? 1.0 : 0.0;\n        setOutput(inBounds * getA(").concat(r,"));\n      }\n    ")}};function d$e(e,t){let n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let a=0;a<e.length;a++)a===2?r.push("index"):r.push("".concat(n[a]));return r.join()}function VU(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,indices:i}=t,{axis:s,batchDims:o}=r,l=k.parseAxisParam(s,a.shape)[0];if(Z().get("DEBUG")){let b=n.readSync(i.dataId),v=a.shape[l];for(let x=0;x<b.length;++x){let w=b[x];k.assert(w<=v-1&&w>=0,()=>"GatherV2: the index value ".concat(w," is not in [0, ").concat(v-1,"]"))}}let c=T.segment_util.collectGatherOpShapeInfo(a,i,l,o),u=k.sizeFromShape(i.shape),d=[],p=ye({inputs:{x:a},backend:n,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),h=ye({inputs:{x:i},backend:n,attrs:{shape:[c.batchSize,u/c.batchSize]}});d.push(p),d.push(h);let f=[c.batchSize,c.outerSize,u/c.batchSize,c.sliceSize];if(n.shouldExecuteOnCPU([a,i])||a.dtype==="string"){let b=n.bufferSync(h),v=n.bufferSync(p),x=dwe(v,b,f);return d.forEach(w=>n.disposeIntermediateTensorInfo(w)),n.makeTensorInfo(c.outputShape,x.dtype,x.values)}let m=new c$e(p.shape,f),g=n.runWebGLProgram(m,[p,h],p.dtype);d.push(g);let y=ye({inputs:{x:g},backend:n,attrs:{shape:c.outputShape}});return d.forEach(b=>n.disposeIntermediateTensorInfo(b)),y}var p$e={kernelName:Zp,backendName:"webgl",kernelFunc:VU},h$e="return float(a > b);",f$e="\n  return vec4(greaterThan(a, b));\n",m$e=Zn({opSnippet:h$e,packedOpSnippet:f$e,cpuKernelImpl:pwe,dtype:"bool"}),g$e={kernelName:Jp,backendName:"webgl",kernelFunc:m$e},y$e="return float(a >= b);",b$e="\n  return vec4(greaterThanEqual(a, b));\n",v$e=Zn({opSnippet:y$e,packedOpSnippet:b$e,dtype:"bool",cpuKernelImpl:hwe}),x$e={kernelName:Xu,backendName:"webgl",kernelFunc:v$e};function w$e(e){let{inputs:t,backend:n}=e,{input:r}=t;return UU(r,!0,n)}var k$e={kernelName:tx,backendName:"webgl",kernelFunc:w$e},S$e="return float(!isnan(x) && !isinf(x));",I$e=it({opSnippet:S$e,dtype:"bool"}),$$e={kernelName:Zu,backendName:"webgl",kernelFunc:I$e},C$e="return float(isinf(x));",E$e=it({opSnippet:C$e,dtype:"bool"}),T$e={kernelName:Qu,backendName:"webgl",kernelFunc:E$e},N$e="return float(isnan(x));",_$e=it({opSnippet:N$e,dtype:"bool"}),A$e={kernelName:Ju,backendName:"webgl",kernelFunc:_$e},R$e="return float(a < b);",D$e="\n  return vec4(lessThan(a, b));\n",F$e=Zn({opSnippet:R$e,packedOpSnippet:D$e,cpuKernelImpl:fwe,dtype:"bool"}),M$e={kernelName:eh,backendName:"webgl",kernelFunc:F$e},O$e="return float(a <= b);",L$e="\n  return vec4(lessThanEqual(a, b));\n",P$e=Zn({opSnippet:O$e,packedOpSnippet:L$e,cpuKernelImpl:mwe,dtype:"bool"}),z$e={kernelName:th,backendName:"webgl",kernelFunc:P$e};function B$e(e){let{backend:t,attrs:n}=e,{start:r,stop:a,num:i}=n,s=gwe(r,a,i);return t.makeTensorInfo([s.length],"float32",s)}var W$e={kernelName:nh,backendName:"webgl",kernelFunc:B$e},U$e=Qh+"\n  return x < 0.0 ? 0./0. : log(x);\n",V$e="\n  vec4 result = log(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);\n  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);\n  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);\n  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);\n  return result;\n",H$e=it({opSnippet:U$e,packedOpSnippet:V$e,cpuKernelImpl:ywe}),j$e={kernelName:tc,backendName:"webgl",kernelFunc:H$e},G$e=Qh+"\n  return log(1.0 + x);\n",q$e=it({opSnippet:G$e}),K$e={kernelName:nc,backendName:"webgl",kernelFunc:q$e},X$e="return float(a >= 1.0 && b >= 1.0);",Y$e="\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",Z$e=Zn({opSnippet:X$e,packedOpSnippet:Y$e,dtype:"bool"}),Q$e={kernelName:rh,backendName:"webgl",kernelFunc:Z$e},J$e="return float(!(x >= 1.0));",eCe=it({opSnippet:J$e}),tCe={kernelName:ah,backendName:"webgl",kernelFunc:eCe},nCe="return float(a >= 1.0 || b >= 1.0);",rCe="\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",aCe=Zn({opSnippet:nCe,packedOpSnippet:rCe,dtype:"bool"}),iCe={kernelName:ih,backendName:"webgl",kernelFunc:aCe},sCe=class{constructor(e,t,n,r,a){this.variableNames=["x"],this.outputShape=[];let i=t,s=e[3]-1;this.outputShape=e;let o,l="float(".concat(n,") + float(").concat(r,") * sum");a===.5?o="inversesqrt(".concat(l,")"):a===1?o="1.0/(".concat(l,")"):o="exp(log(".concat(l,") * float(-").concat(a,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -".concat(i,"; j <= ").concat(i,"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ").concat(s,") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ").concat(o,";\n        setOutput(val);\n      }\n    ")}},oCe=class{constructor(e,t,n,r,a){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;let i=t,s=e[3]-1;this.outputShape=e;let o,l="float(".concat(n,") + float(").concat(r,") * sum");a===.5?o="inversesqrt(".concat(l,")"):a===1?o="1.0/(".concat(l,")"):o="exp(log(".concat(l,") * float(-").concat(a,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ".concat(this.outputShape[3],";\n        bool hasNextRow = c < ").concat(this.outputShape[2],";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ").concat(i,";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ").concat(i,"; j <= ").concat(i,"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(").concat(s,"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ").concat(o,";\n        setOutput(result);\n      }\n    ")}},lCe=e=>{let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{depthRadius:i,bias:s,alpha:o,beta:l}=r,c=Z().getBool("WEBGL_PACK_NORMALIZATION")?new oCe(a.shape,i,s,o,l):new sCe(a.shape,i,s,o,l);return n.runWebGLProgram(c,[a],a.dtype)},uCe={kernelName:rc,backendName:"webgl",kernelFunc:lCe},cCe=class{constructor(e,t,n,r,a){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=r,this.beta=a,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ".concat(this.depth,"; ++d) {\n          int depthBegin = int(max(0.0, float(d - ").concat(t,")));\n          int depthEnd = int(min(float(").concat(this.depth,"),\n              float(d + ").concat(t," + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ").concat(this.depth,";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(").concat(r,") * norm + float(").concat(n,");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(").concat(r,")\n                * float(").concat(a,")\n                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ").concat(a,");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    ")}},dCe=e=>{let{inputs:t,backend:n,attrs:r}=e,{x:a,y:i,dy:s}=t,{depthRadius:o,bias:l,alpha:c,beta:u}=r,d=new cCe(a.shape,o,l,c,u);return n.runWebGLProgram(d,[a,i,s],a.dtype)},pCe={kernelName:sh,backendName:"webgl",kernelFunc:dCe};function hCe(e,t,n,r){let a=k.sizeFromShape(t),i=k.sizeFromShape(e.shape)/a,s=ye({inputs:{x:e},attrs:{shape:[i,a]},backend:r}),o=Xc(s,e.dtype,"max",r),l=ye({inputs:{x:o},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(s),r.disposeIntermediateTensorInfo(o),l}function HU(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{reductionIndices:i,keepDims:s}=r,o=a.shape.length,l=k.parseAxisParam(i,a.shape),c=l,u=T.getAxesPermutation(c,o),d=u!=null,p=n.shouldExecuteOnCPU([a]),h=a;if(d){if(p){let b=n.texData.get(h.dataId).values,v=new Array(o);for(let $=0;$<v.length;$++)v[$]=a.shape[u[$]];let x=mT(b,a.shape,a.dtype,u,v);h=n.makeTensorInfo(v,a.dtype);let w=n.texData.get(h.dataId);w.values=x}else h=pw(a,u,n);c=T.getInnerMostAxes(c.length,o)}T.assertAxesAreInnerMostDims("max",c,o);let[f,m]=T.computeOutAndReduceShapes(h.shape,c),g=f;s&&(g=T.expandShapeToKeepDim(f,l));let y;if(p){let b=n.texData.get(h.dataId).values,v=bwe(b,k.sizeFromShape(m),g,a.dtype);y=n.makeTensorInfo(g,a.dtype);let x=n.texData.get(y.dataId);x.values=v}else y=hCe(h,m,g,n);return d&&n.disposeIntermediateTensorInfo(h),y}var fCe={kernelName:ac,backendName:"webgl",kernelFunc:HU},mCe=gT+"\n  return max(a, b);\n",gCe="\n  vec4 result = vec4(max(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+Kc+"\n  return result;\n",yCe=Zn({opSnippet:mCe,packedOpSnippet:gCe,cpuKernelImpl:vwe}),bCe={kernelName:ic,backendName:"webgl",kernelFunc:yCe};function vCe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t;Gh(a,"maxPool");let{filterSize:i,strides:s,pad:o,dimRoundingMode:l}=r,c=1;k.assert(T.eitherStridesOrDilationsAreOne(s,c),()=>"Error in maxPool: Either strides or dilations must be 1. Got strides ".concat(s," and dilations '").concat(c,"'"));let u=T.computePool2DInfo(a.shape,i,s,c,o,l);if(u.filterWidth===1&&u.filterHeight===1&&k.arraysEqual(u.inShape,u.outShape))return ga({inputs:{x:a},backend:n});let d=new Om(u,"max",!1);return n.runWebGLProgram(d,[a],a.dtype)}var xCe={kernelName:sc,backendName:"webgl",kernelFunc:vCe};function wCe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:i,strides:s,pad:o,dataFormat:l,dimRoundingMode:c}=r,u=[1,1,1],d=T.computePool3DInfo(a.shape,i,s,u,o,c,l),p=new bT(d,"max",!1);return n.runWebGLProgram(p,[a],a.dtype)}var kCe={kernelName:oh,backendName:"webgl",kernelFunc:wCe},SCe=class{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;let t=e.strideHeight,n=e.strideWidth,r=e.dilationHeight,a=e.effectiveFilterHeight,i=e.effectiveFilterWidth,s=a-1-e.padInfo.top,o=i-1-e.padInfo.left,l=a*i-1;this.userCode="\n      const ivec2 pads = ivec2(".concat(s,", ").concat(o,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(a,";\n          wR += ").concat(r,") {\n          float dyR = float(dyRCorner + wR) / ").concat(t,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(i,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(n,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ").concat(l," - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ").concat(i," + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}},ICe=class{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;let t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,a=e.dilationDepth,i=e.dilationHeight,s=e.dilationWidth,o=e.effectiveFilterDepth,l=e.effectiveFilterHeight,c=e.effectiveFilterWidth,u=o-1-e.padInfo.front,d=l-1-e.padInfo.top,p=c-1-e.padInfo.left,h=o*l*c-1;this.userCode="\n      const ivec3 pads = ivec3(".concat(u,", ").concat(d,", ").concat(p,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(o,";\n           wD += ").concat(a,") {\n          float dyD = float(dyDCorner + wD) / ").concat(t,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(e.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(l,";\n              wR += ").concat(i,") {\n            float dyR = float(dyRCorner + wR) / ").concat(n,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(c,";\n                wC += ").concat(s,") {\n              float dyC = float(dyCCorner + wC) / ").concat(r,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ").concat(h," -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ").concat(l," * ").concat(c," +\n                  wR * ").concat(c," + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}};function $Ce(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,s=i,{filterSize:o,strides:l,pad:c,dimRoundingMode:u}=r,d=[1,1,1],p=T.computePool3DInfo(s.shape,o,l,d,c,u),h=new bT(p,"max",!0),f=n.runWebGLProgram(h,[s],s.dtype),m=new ICe(p),g=n.runWebGLProgram(m,[a,f],s.dtype);return n.disposeIntermediateTensorInfo(f),g}var CCe={kernelName:cg,backendName:"webgl",kernelFunc:$Ce};function ECe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i,output:s}=t,o=i;Gh([i,s],"maxPoolGrad");let{filterSize:l,strides:c,pad:u,dimRoundingMode:d}=r,p=T.computePool2DInfo(o.shape,l,c,1,u,d),h=!0,f=new Om(p,"max",h),m=n.runWebGLProgram(f,[o],o.dtype),g=new SCe(p),y=n.runWebGLProgram(g,[a,m],o.dtype);return n.disposeIntermediateTensorInfo(m),y}var TCe={kernelName:ug,backendName:"webgl",kernelFunc:ECe};function NCe(e,t,n,r){let a=new Om(n,"max",!1),i=r.runWebGLProgram(a,[e],"float32");a=new Om(n,"max",!0,!0,t);let s=r.runWebGLProgram(a,[e],"float32");return[i,s]}var _Ce={kernelName:dg,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{x:r}=e,{filterSize:a,strides:i,pad:s,includeBatchInIndex:o}=t,l=n;k.assert(r.shape.length===4,()=>"Error in maxPool: input must be rank 4 but got rank ".concat(r.shape.length,"."));let c=[1,1];k.assert(T.eitherStridesOrDilationsAreOne(i,c),()=>"Error in maxPool: Either strides or dilations must be 1. Got strides ".concat(i," and dilations '").concat(c,"'"));let u=T.computePool2DInfo(r.shape,a,i,c,s),[d,p]=NCe(r,o,u,l);return[d,p]}};function ACe(e,t,n,r){let a=k.sizeFromShape(t),i=k.sizeFromShape(e.shape)/a,s=ye({inputs:{x:e},attrs:{shape:[i,a]},backend:r}),o=Xc(s,"float32","mean",r),l=ye({inputs:{x:o},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(s),r.disposeIntermediateTensorInfo(o),l}var RCe={kernelName:oc,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{x:r}=e,{keepDims:a,axis:i}=t,s=n,o=r.shape.length,l=k.parseAxisParam(i,r.shape),c=l,u=T.getAxesPermutation(c,o),d=u!=null,p=s.shouldExecuteOnCPU([r]),h=[],f=r;if(d){if(p){let v=s.texData.get(f.dataId).values,x=new Array(o);for(let C=0;C<x.length;C++)x[C]=r.shape[u[C]];let w=mT(v,r.shape,r.dtype,u,x);f=s.makeTensorInfo(x,r.dtype);let $=s.texData.get(f.dataId);$.values=w}else f=pw(r,u,s);h.push(f),c=T.getInnerMostAxes(c.length,o)}T.assertAxesAreInnerMostDims("sum",c,o);let[m,g]=T.computeOutAndReduceShapes(f.shape,c),y=m;a&&(y=T.expandShapeToKeepDim(m,l));let b=ACe(f,g,y,s);for(let v of h)s.disposeIntermediateTensorInfo(v);return b}};function DCe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:s}=r,o=a.shape.length,l=k.parseAxisParam(i,a.shape),c=l,u=T.getAxesPermutation(c,o),d=a;u!=null&&(d=Er({inputs:{x:a},backend:n,attrs:{perm:u}}),c=T.getInnerMostAxes(c.length,a.shape.length)),T.assertAxesAreInnerMostDims("min",c,o);let[p,h]=T.computeOutAndReduceShapes(d.shape,c),f=k.sizeFromShape(h),m=ye({inputs:{x:d},backend:n,attrs:{shape:[-1,f]}}),g=Xc(m,m.dtype,"min",n),y;if(s){let b=T.expandShapeToKeepDim(p,l);y=ye({inputs:{x:g},backend:n,attrs:{shape:b}})}else y=ye({inputs:{x:g},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),u!=null&&n.disposeIntermediateTensorInfo(d),y}var FCe={kernelName:lc,backendName:"webgl",kernelFunc:DCe},MCe=gT+"\n  return min(a, b);\n",OCe="\n  vec4 result = vec4(min(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+Kc+"\n  return result;\n",LCe=Zn({opSnippet:MCe,packedOpSnippet:OCe,cpuKernelImpl:xwe}),PCe={kernelName:uc,backendName:"webgl",kernelFunc:LCe},zCe=class{constructor(e,t,n){this.variableNames=["x"],this.outputShape=t.map((c,u)=>c[0]+e[u]+c[1]);let r=e.length,a=St(r),i=t.map(c=>c[0]).join(","),s=t.map((c,u)=>c[0]+e[u]).join(","),o=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),l=n==="reflect"?0:1;if(r===1){this.userCode="\n        int start = ".concat(i,";\n        int end = ").concat(s,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ").concat(l,";\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ").concat(l,";\n          }\n          setOutput(getX(outC - start));\n        }\n      ");return}this.userCode="\n      ".concat(a," start = ").concat(a,"(").concat(i,");\n      ").concat(a," end = ").concat(a,"(").concat(s,");\n\n      void main() {\n        ").concat(a," outC = getOutputCoords();\n        for (int i = 0; i < ").concat(r,"; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ").concat(l,";\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ").concat(l,";\n          }\n        }\n        ").concat(a," coords = outC - start;\n        setOutput(getX(").concat(o,"));\n      }\n    ")}},BCe=class{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map((h,f)=>h[0]+e[f]+h[1]);let r=e.length,a=St(r),i=t.map(h=>h[0]).join(","),s=t.map((h,f)=>h[0]+e[f]).join(","),o=xr("rc",r),l=xr("source",r),c="".concat(o[r-1]," < ").concat(this.outputShape[r-1]),u=r===1?"source":"vec2(".concat(l.slice(-2).join(),")"),d=n==="reflect"?0:1,p="";if(r===1){let h="\n        ".concat(a," source = rc;\n        if (source < start) {\n          source = start * 2 - source - ").concat(d,";\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ").concat(d,";\n        }\n        source -= start;\n      ");p="\n        ".concat(a," rc = outputLoc;\n        ").concat(h,"\n        result[0] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n        ").concat(o[r-1]," += 1;\n        if(").concat(c,") {\n          ").concat(h,"\n          result[1] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n        }\n      ")}else{let h="\n        ".concat(a," source = rc;\n        ").concat(a," lt = ").concat(a,"(lessThan(source, start));\n        ").concat(a," gte = ").concat(a,"(greaterThanEqual(source, end));\n        ").concat(a," orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ").concat(d,") +\n                gte * ((end - 1) * 2 - source + ").concat(d,");\n        source -= start;\n      ");p="\n        ".concat(a," rc = outputLoc;\n        ").concat(h,"\n        result[0] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n        ").concat(o[r-1]," += 1;\n        if(").concat(c,") {\n          ").concat(h,"\n          result[1] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n        }\n        rc = outputLoc;\n        ").concat(o[r-2]," += 1;\n        if(").concat(o[r-2]," < ").concat(this.outputShape[r-2],") {\n          ").concat(h,"\n          result[2] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n          ").concat(o[r-1]," += 1;\n          if(").concat(c,") {\n            ").concat(h,"\n            result[3] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n          }\n        }\n      ")}this.userCode="\n      const ".concat(a," start = ").concat(a,"(").concat(i,");\n      const ").concat(a," end = ").concat(a,"(").concat(s,");\n\n      void main() {\n        ").concat(a," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(p,"\n        setOutput(result);\n      }\n    ")}},WCe=({inputs:e,backend:t,attrs:n})=>{let{x:r}=e,{paddings:a,mode:i}=n,s=Z().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new BCe(r.shape,a,i):new zCe(r.shape,a,i);return t.runWebGLProgram(s,[r],r.dtype)},UCe={kernelName:cc,backendName:"webgl",kernelFunc:WCe},VCe="if (b == 0.0) return NAN;\n  return mod(a, b);",HCe="\n  vec4 result = mod(a, b);\n  bvec4 isNaN = equal(b, vec4(0.0));\n  "+Kc+"\n  return result;\n",jCe=Zn({opSnippet:VCe,packedOpSnippet:HCe}),GCe={kernelName:dc,backendName:"webgl",kernelFunc:jCe},qCe=class{constructor(e,t,n){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,n],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ".concat(t-1,"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(").concat(t-1,"));\n      }\n    ")}},KCe="\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",XCe="\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",jU=Zn({opSnippet:KCe,packedOpSnippet:XCe,checkOutOfBounds:!0}),YCe={kernelName:Wu,backendName:"webgl",kernelFunc:jU},vD="return a - b;",GU=Zn({opSnippet:vD,packedOpSnippet:vD,supportsComplex:!0,cpuKernelImpl:Wwe}),ZCe={kernelName:Oc,backendName:"webgl",kernelFunc:GU};function qU(e){let{inputs:t,backend:n,attrs:r}=e,{logits:a}=t,{dim:i}=r,s=k.parseAxisParam([i],a.shape),o=HU({inputs:{x:a},backend:n,attrs:{reductionIndices:s,keepDims:!1}}),l=T.expandShapeToKeepDim(o.shape,s),c=ye({inputs:{x:o},backend:n,attrs:{shape:l}}),u=GU({inputs:{a,b:c},backend:n}),d=WU({inputs:{x:u},backend:n}),p=hw({inputs:{x:d},backend:n,attrs:{axis:s,keepDims:!1}}),h=ye({inputs:{x:p},backend:n,attrs:{shape:l}}),f=jU({inputs:{a:d,b:h},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h),f}var QCe={kernelName:Fc,backendName:"webgl",kernelFunc:qU};function JCe(e){let{inputs:t,backend:n,attrs:r}=e,{logits:a}=t,{numSamples:i,seed:s,normalized:o}=r,l=o?a:qU({inputs:{logits:a},backend:n,attrs:{dim:a.shape.length-1}}),c=l.shape[0],u=l.shape[1],d=new qCe(c,u,i),p=[[s]],h=n.runWebGLProgram(d,[l],"int32",p);return o||n.disposeIntermediateTensorInfo(l),h}var eEe={kernelName:lh,backendName:"webgl",kernelFunc:JCe},tEe=ai+"\n  return -x;\n",nEe="\n  vec4 result = -x;\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n";function rEe(e){let{inputs:t,backend:n}=e,{x:r}=t;if(n.shouldExecuteOnCPU([r])){let i=n.texData.get(r.dataId),[s,o]=kwe(i.values,r.shape,r.dtype);return n.makeTensorInfo(o,r.dtype,s)}let a;return Z().getBool("WEBGL_PACK_UNARY_OPERATIONS")?a=new po(r.shape,nEe):a=new Zi(r.shape,tEe),n.runWebGLProgram(a,[r],r.dtype)}var aEe={kernelName:uh,backendName:"webgl",kernelFunc:rEe},iEe=us.nonMaxSuppressionV3Impl;function sEe(e){T.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:i}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l}=r,c=n.readSync(a.dataId),u=n.readSync(i.dataId),{selectedIndices:d}=iEe(c,u,s,o,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}var oEe={kernelName:dh,backendName:"webgl",kernelFunc:sEe},lEe=us.nonMaxSuppressionV4Impl;function uEe(e){T.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:i}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:c}=r,u=n.readSync(a.dataId),d=n.readSync(i.dataId),{selectedIndices:p,validOutputs:h}=lEe(u,d,s,o,l,c);return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([],"int32",new Int32Array([h]))]}var cEe={kernelName:ph,backendName:"webgl",kernelFunc:uEe},dEe=us.nonMaxSuppressionV5Impl;function pEe(e){T.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:i}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l,softNmsSigma:c}=r,u=n.readSync(a.dataId),d=n.readSync(i.dataId),p=s,h=o,f=l,m=c,{selectedIndices:g,selectedScores:y}=dEe(u,d,p,h,f,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}var hEe={kernelName:hh,backendName:"webgl",kernelFunc:pEe},fEe=class{constructor(e,t,n,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(".concat(r,"), float(").concat(n,"),\n                      float(index == coords.y)));\n      }\n    ")}},mEe=e=>{let{inputs:t,backend:n,attrs:r}=e,{indices:a}=t,{dtype:i,depth:s,onValue:o,offValue:l}=r,c=k.sizeFromShape(a.shape),u=new fEe(c,s,o,l),d=ye({inputs:{x:a},backend:n,attrs:{shape:[c]}}),p=n.runWebGLProgram(u,[d],i);n.disposeIntermediateTensorInfo(d);let h=[...a.shape,s],f=ye({inputs:{x:p},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(p),f},gEe={kernelName:hc,backendName:"webgl",kernelFunc:mEe};function jv(e){let{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype==="complex64"){let a=ny({inputs:{input:r},backend:n}),i=jv({inputs:{x:a},backend:n}),s=fw({inputs:{input:r},backend:n}),o=jv({inputs:{x:s},backend:n}),l=nl({inputs:{real:i,imag:o},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),l}else return ry({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:n})}var yEe={kernelName:Rh,backendName:"webgl",kernelFunc:jv};function KU(e){let{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){let a=ny({inputs:{input:r},backend:n}),i=KU({inputs:{x:a},backend:n}),s=fw({inputs:{input:r},backend:n}),o=jv({inputs:{x:s},backend:n}),l=nl({inputs:{real:i,imag:o},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),l}else return ry({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:n})}var bEe={kernelName:fh,backendName:"webgl",kernelFunc:KU};function vEe(e){let{inputs:t,backend:n,attrs:r}=e,{axis:a}=r;if(t.length===1)return zS({inputs:{input:t[0]},backend:n,attrs:{dim:a}});let i=t[0].shape,s=t[0].dtype;t.forEach(u=>{k.assertShapesMatch(i,u.shape,"All tensors passed to stack must have matching shapes"),k.assert(s===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});let o=[],l=t.map(u=>{let d=zS({inputs:{input:u},backend:n,attrs:{dim:a}});return o.push(d),d}),c=DU({inputs:l,backend:n,attrs:{axis:a}});return o.forEach(u=>n.disposeIntermediateTensorInfo(u)),c}var xEe={kernelName:mh,backendName:"webgl",kernelFunc:vEe},wEe=class{constructor(e,t,n){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((l,c)=>l[0]+e[c]+l[1]);let r=e.length,a=St(r),i=t.map(l=>l[0]).join(","),s=t.map((l,c)=>l[0]+e[c]).join(","),o=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);if(r===1){this.userCode="\n        int start = ".concat(i,";\n        int end = ").concat(s,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(value);\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      ");return}this.userCode="\n      ".concat(a," start = ").concat(a,"(").concat(i,");\n      ").concat(a," end = ").concat(a,"(").concat(s,");\n\n      void main() {\n        ").concat(a," outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(value);\n        } else {\n          ").concat(a," coords = outC - start;\n          setOutput(getX(").concat(o,"));\n        }\n      }\n    ")}},kEe=class{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((f,m)=>f[0]+e[m]+f[1]);let r=e.length,a=St(r),i=t.map(f=>f[0]).join(","),s=t.map((f,m)=>f[0]+e[m]).join(","),o=xr("rc",r),l=xr("source",r),c="".concat(o[r-1]," < ").concat(this.outputShape[r-1]),u=r===1?"source":"vec2(".concat(l.slice(-2).join(),")"),d=["".concat(a," rc = outputLoc;"),"".concat(o[r-1]," += 1;\n       if(").concat(c,") {\n      "),r===1?"":"}\n       rc = outputLoc;\n       ".concat(o[r-2]," += 1;\n       if(").concat(o[r-2]," < ").concat(this.outputShape[r-2],") {"),r===1?"":"  ".concat(o[r-1]," += 1;\n         if(").concat(c,") {")],p=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",h="";for(let f=0,m=r===1?2:4;f<m;f++)h+="\n        ".concat(d[f],"\n        if (").concat(p,") {\n          result[").concat(f,"] = float(value);\n        } else {\n          ").concat(a," source = rc - start;\n          result[").concat(f,"] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n        }\n      ");h+=r===1?"} ":"}}",this.userCode="\n      const ".concat(a," start = ").concat(a,"(").concat(i,");\n      const ").concat(a," end = ").concat(a,"(").concat(s,");\n\n      void main() {\n        ").concat(a," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(h,"\n        setOutput(result);\n      }\n    ")}},XU=e=>{let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{paddings:i,constantValue:s}=r;if(k.sizeFromShape(a.shape)===0){let c=i.map((u,d)=>u[0]+a.shape[d]+u[1]);return ry({backend:n,attrs:{shape:c,value:s,dtype:a.dtype}})}let o=Z().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new kEe(a.shape,i,s):new wEe(a.shape,i,s),l=[[s]];return n.runWebGLProgram(o,[a],a.dtype,l)},SEe={kernelName:fc,backendName:"webgl",kernelFunc:XU},IEe="\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",$Ee="\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  bvec4 isNaN1 = lessThan(a, vec4(0.0));\n  bvec4 isNaN2 = lessThan(floor(b), b);\n  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);\n  "+Kc+"\n  return result;\n",CEe=Zn({opSnippet:IEe,packedOpSnippet:$Ee}),EEe={kernelName:mc,backendName:"webgl",kernelFunc:CEe};function TEe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:s}=r,o=a.shape.length,l=[],c=k.parseAxisParam(i,a.shape),u=c,d=T.getAxesPermutation(u,o),p=a;d!=null&&(p=Er({inputs:{x:a},backend:n,attrs:{perm:d}}),u=T.getInnerMostAxes(u.length,o),l.push(p)),T.assertAxesAreInnerMostDims("prod",u,o);let h;if(n.shouldExecuteOnCPU([p])){let f=n.texData.get(p.dataId).values,{outVals:m,outShape:g,outDtype:y}=Iwe(p.shape,p.dtype,f,u);h=n.makeTensorInfo(g,y,m)}else{let[f,m]=T.computeOutAndReduceShapes(p.shape,u),g=k.sizeFromShape(m),y=ye({inputs:{x:p},backend:n,attrs:{shape:[-1,g]}}),b=lx(a.dtype),v=Xc(y,b,"prod",n);h=ye({inputs:{x:v},backend:n,attrs:{shape:f}}),l.push(y),l.push(v)}if(s){l.push(h);let f=T.expandShapeToKeepDim(h.shape,c);h=ye({inputs:{x:h},backend:n,attrs:{shape:f}})}return l.forEach(f=>n.disposeIntermediateTensorInfo(f)),h}var NEe={kernelName:yc,backendName:"webgl",kernelFunc:TEe};function _Ee(e){let{inputs:t,backend:n,attrs:r}=e,{paramsNestedSplits:a,paramsDenseValues:i,indices:s}=t,{outputRaggedRank:o}=r,l=a.map(y=>n.readSync(y.dataId)),c=a.map(y=>y.shape),u=n.readSync(i.dataId),d=n.readSync(s.dataId),[p,h,f]=$we(l,c,u,i.shape,i.dtype,d,s.shape,o),m=p.map(y=>n.makeTensorInfo([y.length],"int32",y)),g=n.makeTensorInfo(f,i.dtype,h);return m.concat([g])}var AEe={kernelName:rx,backendName:"webgl",kernelFunc:_Ee};function REe(e){let{inputs:t,backend:n}=e,{starts:r,limits:a,deltas:i}=t,s=n.readSync(r.dataId),o=n.readSync(a.dataId),l=n.readSync(i.dataId),[c,u]=Cwe(s,r.shape,r.dtype,o,a.shape,l,i.shape),d=n.makeTensorInfo([c.length],"int32",c),p=n.makeTensorInfo([u.length],r.dtype,u);return[d,p]}var DEe={kernelName:ax,backendName:"webgl",kernelFunc:REe};function FEe(e){let{inputs:t,backend:n,attrs:r}=e,{shape:a,values:i,defaultValue:s,rowPartitionTensors:o}=t,{rowPartitionTypes:l}=r,c=n.readSync(a.dataId),u=n.readSync(i.dataId),d=n.readSync(s.dataId),p=o.map(g=>n.readSync(g.dataId)),h=o.map(g=>g.shape),[f,m]=Ewe(c,a.shape,u,i.shape,i.dtype,d,s.shape,p,h,l);return n.makeTensorInfo(f,i.dtype,m)}var MEe={kernelName:ix,backendName:"webgl",kernelFunc:FEe},YU=e=>{let{backend:t,attrs:n}=e,{start:r,stop:a,step:i,dtype:s}=n,o=Twe(r,a,i,s);return t.makeTensorInfo([o.length],s,o)},OEe={kernelName:pg,backendName:"webgl",kernelFunc:YU},LEe="return 1.0 / x;",PEe=it({opSnippet:LEe}),zEe={kernelName:bc,backendName:"webgl",kernelFunc:PEe},BEe=ai+"\n  return (x < 0.0) ? 0.0 : x;\n",WEe="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",UEe=it({opSnippet:BEe,packedOpSnippet:WEe}),VEe={kernelName:vc,backendName:"webgl",kernelFunc:UEe},HEe=ai+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",jEe="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",GEe=it({opSnippet:HEe,packedOpSnippet:jEe}),qEe={kernelName:kc,backendName:"webgl",kernelFunc:GEe},KEe=class{constructor(e,t,n,r,a){this.variableNames=["A"],this.outputShape=[];let[i,s,o,l]=e;this.outputShape=[i,t,n,l];let c=[r&&t>1?s-1:s,r&&n>1?o-1:o],u=[r&&t>1?t-1:t,r&&n>1?n-1:n],d;a?d="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":d="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(c[0]/u[0],",\n          ").concat(c[1]/u[1],");\n      const vec2 inputShapeRC = vec2(").concat(s,".0, ").concat(o,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(d,";\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    ")}},XEe=class{constructor(e,t,n,r,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];let[i,s,o,l]=e;this.outputShape=[i,t,n,l];let c=[r&&t>1?s-1:s,r&&n>1?o-1:o],u=[r&&t>1?t-1:t,r&&n>1?n-1:n],d;a?d="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":d="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(c[0]/u[0],",\n          ").concat(c[1]/u[1],",\n          ").concat(c[1]/u[1],");\n      const vec3 inputShapeRC = vec3(").concat(s,".0, ").concat(o,".0,\n                                     ").concat(o,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(d,";\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(l-1,";\n        bool hasNextRow = coords.z < ").concat(n-1,";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    ")}};function YEe(e){let{inputs:t,backend:n,attrs:r}=e,{images:a}=t,{alignCorners:i,halfPixelCenters:s,size:o}=r,[l,c]=o,u=Z().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new XEe(a.shape,l,c,i,s):new KEe(a.shape,l,c,i,s);return n.runWebGLProgram(u,[a],"float32")}var ZEe={kernelName:wc,backendName:"webgl",kernelFunc:YEe},QEe=class{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;let[,r,a]=t,[,i,s]=e,o=[n&&i>1?r-1:r,n&&s>1?a-1:a],l=[n&&i>1?i-1:i,n&&s>1?s-1:s],c=o[0]/l[0],u=o[1]/l[1],d=1/c,p=1/u,h=Math.ceil(d)*2+2,f=Math.ceil(p)*2+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(c,");\n        const float widthScale = float(").concat(u,");\n\n        const float invHeightScale = float(").concat(d,");\n        const float invWidthScale = float(").concat(p,");\n\n        const int winHeight = int(").concat(h,");\n        const int winWidth = int(").concat(f,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(i,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(s,") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ").concat(r-1,".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ").concat(a-1,".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}};function JEe(e){let{inputs:t,backend:n,attrs:r}=e,{images:a,dy:i}=t,{alignCorners:s}=r,o=new QEe(i.shape,a.shape,s);return n.runWebGLProgram(o,[i],i.dtype)}var e2e={kernelName:bh,backendName:"webgl",kernelFunc:JEe},t2e=class{constructor(e,t,n,r,a){this.variableNames=["A"],this.outputShape=[];let[i,s,o,l]=e;this.outputShape=[i,t,n,l];let c=[r&&t>1?s-1:s,r&&n>1?o-1:o],u=[r&&t>1?t-1:t,r&&n>1?n-1:n],d=r?"0.5":"0.0",p;a?p="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":p="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(c[0]/u[0],",\n          ").concat(c[1]/u[1],");\n      const vec2 inputShapeRC = vec2(").concat(s,".0, ").concat(o,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(p,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(d,")));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    ")}},n2e=class{constructor(e,t,n,r,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];let[i,s,o,l]=e;this.outputShape=[i,t,n,l];let c=[r&&t>1?s-1:s,r&&n>1?o-1:o],u=[r&&t>1?t-1:t,r&&n>1?n-1:n],d=r?"0.5":"0.0",p;a?p="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":p="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(c[0]/u[0],",\n          ").concat(c[1]/u[1],",\n          ").concat(c[1]/u[1],");\n      const vec3 inputShapeRC = vec3(").concat(s,".0, ").concat(o,".0,\n                                     ").concat(o,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(p,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec3 sourceNearestRC = ivec3(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(d,")));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(l-1,";\n        bool hasNextRow = coords.z < ").concat(n-1,";\n\n        vec4 newValue = vec4(\n          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),\n          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);\n\n        setOutput(newValue);\n      }\n    ")}};function r2e(e){let{inputs:t,backend:n,attrs:r}=e,{images:a}=t,{alignCorners:i,halfPixelCenters:s,size:o}=r,[l,c]=o,u=Z().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new n2e(a.shape,l,c,i,s):new t2e(a.shape,l,c,i,s);return n.runWebGLProgram(u,[a],a.dtype)}var a2e={kernelName:xc,backendName:"webgl",kernelFunc:r2e},i2e=class{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;let[,r,a]=t,[,i,s]=e,o=[n&&i>1?r-1:r,n&&s>1?a-1:a],l=[n&&i>1?i-1:i,n&&s>1?s-1:s],c=o[0]/l[0],u=o[1]/l[1],d=1/c,p=1/u,h=Math.ceil(d)*2+2,f=Math.ceil(p)*2+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(c,");\n        const float widthScale = float(").concat(u,");\n\n        const float invHeightScale = float(").concat(d,");\n        const float invWidthScale = float(").concat(p,");\n\n        const int winHeight = int(").concat(h,");\n        const int winWidth = int(").concat(f,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(i,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(s,") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(").concat(o[0],") *\n                (float(dyR) / float(").concat(l[0],"));\n\n            float sourceFracCol =\n                float(").concat(o[1],") *\n                  (float(dyC) / float(").concat(l[1],"));\n\n            int sourceNearestRow = int(min(\n                float(int(").concat(r,") - 1),\n                ").concat(n," ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(").concat(a,") - 1),\n                ").concat(n," ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}};function s2e(e){let{inputs:t,backend:n,attrs:r}=e,{images:a,dy:i}=t,{alignCorners:s}=r,o=new i2e(i.shape,a.shape,s);return n.runWebGLProgram(o,[i],i.dtype)}var o2e={kernelName:yh,backendName:"webgl",kernelFunc:s2e},l2e=class{constructor(e,t){this.variableNames=["x"];let n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-".concat(n," tensor is not yet supported"));if(this.outputShape=e,n===1){this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(".concat(e[0]," - coord - 1));\n        }\n      ");return}let r=s=>t.indexOf(s)!==-1&&e[s]!==1?"".concat(e[s]," - coords[").concat(s,"] - 1"):"coords[".concat(s,"]"),a=e.map((s,o)=>r(o)).join(","),i=St(n);this.userCode="\n      void main() {\n        ".concat(i," coords = getOutputCoords();\n        setOutput(getX(").concat(a,"));\n      }\n    ")}},u2e=class{constructor(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;let n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-".concat(n," tensor is not yet supported"));this.outputShape=e;let r=xr("rc",n),a="".concat(r[n-1]," + 1 < ").concat(this.outputShape[n-1]),i="".concat(r[n-2]," + 1 < ").concat(this.outputShape[n-2]),s=St(n);n===1?this.userCode="\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(".concat(e[0]," - rc - 1),\n            ").concat(e[0]," - rc - 1);\n          if(").concat(a,"){\n              result.g = getChannel(getX(").concat(e[0]," - (rc  + 1) - 1),\n                ").concat(e[0]," - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      "):this.userCode="\n        void main() {\n          ".concat(s," rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ").concat(o(r.slice()),";\n          if(").concat(a,"){\n            result.g = ").concat(l(r.slice()),";\n          }\n          if(").concat(i,") {\n            result.b = ").concat(c(r.slice()),";\n            if(").concat(a,") {\n              result.a = ").concat(u(r.slice()),";\n            }\n          }\n          setOutput(result);\n        }\n    ");function o(h){return d(h)}function l(h){return h[n-1]="("+h[n-1]+" + 1)",d(h)}function c(h){return h[n-2]="("+h[n-2]+" + 1)",d(h)}function u(h){return h[n-1]="("+h[n-1]+" + 1)",h[n-2]="("+h[n-2]+" + 1)",d(h)}function d(h){let f=e.map((y,b)=>p(b,h)),m=f.join(","),g=f.slice(-2).join(",");return"getChannel(getX(".concat(m,"), vec2(").concat(g,"))")}function p(h,f){return t.indexOf(h)!==-1&&e[h]!==1?"".concat(e[h]," - ").concat(f[h]," - 1"):"".concat(f[h])}}};function c2e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{dims:i}=r,s=a.shape.length,o=k.parseAxisParam(i,a.shape);if(s===0)return ga({inputs:{x:a},backend:n});let l=Z().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new u2e(a.shape,o):new l2e(a.shape,o);return n.runWebGLProgram(l,[a],a.dtype)}var d2e={kernelName:Sc,backendName:"webgl",kernelFunc:c2e},p2e=class{constructor(e,t){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];let n=e[1],r=e[2];this.outputShape=e;let a="";typeof t=="number"?a="float outputValue = ".concat(t.toFixed(2),";"):a="\n        vec3 fill = vec3(".concat(t.join(","),");\n        float outputValue = fill[coords[3]];"),this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - params[0]) * params[3] -\n            (float(y) - params[1]) * params[2];\n          float coordYFloat = (float(x) - params[0]) * params[2] +\n            (float(y) - params[1]) * params[3];\n          int coordX = int(round(coordXFloat + params[0]));\n          int coordY = int(round(coordYFloat + params[1]));\n          ".concat(a,"\n          if(coordX >= 0 && coordX < ").concat(r," && coordY >= 0 && coordY < ").concat(n,") {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")}},h2e={kernelName:Dh,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{image:r}=e,{radians:a,fillValue:i,center:s}=t,o=n,l=new p2e(r.shape,i),[c,u]=T.getImageCenter(s,r.shape[1],r.shape[2]),d=[[c,u,Math.sin(a),Math.cos(a)]];return o.runWebGLProgram(l,[r],r.dtype,d)}},f2e="\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n",m2e=it({opSnippet:f2e}),g2e={kernelName:Ic,backendName:"webgl",kernelFunc:m2e},y2e="return inversesqrt(x);",b2e=it({opSnippet:y2e,cpuKernelImpl:Nwe}),v2e={kernelName:$c,backendName:"webgl",kernelFunc:b2e},vT=class{constructor(e,t,n,r,a,i,s=!0,o=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;let l=St(a.length),c=St(i.length),u="";n===1?u="i":n===2&&(u="i, j");let d="getIndices(".concat(u,")"),p="";r===1?p="i":r===2&&(p="i, coords[1]");let h="getUpdates(".concat(p,")"),f="";o&&(f="coords[0], coords[1]");let m="getDefaultValue(".concat(f,")"),g=t>1?"strides[j]":"strides";this.userCode="\n        ".concat(l," strides = ").concat(l,"(").concat(a,");\n\n        void main() {\n          ").concat(c," coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ").concat(e,"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ").concat(t,"; j++) {\n              int index = round(").concat(d,");\n              flattenedIndex += index * ").concat(g,";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ").concat(h,";\n              found = true;\n            }\n          }\n          setOutput(mix(").concat(m,", sum, float(found)));\n        }\n      ")}},x2e=class{constructor(e,t,n,r,a,i,s=!0,o=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=i;let l=St(a.length),c=St(i.length),u="";n===1?u="i":n===2&&(u="i, j");let d="getIndices(".concat(u,")"),p="";r===1?p="i":r===2&&(p="i, coords[1]");let h="getUpdates(".concat(p,")"),f="";o&&(f="coords[0], coords[1]");let m="getDefaultValue(".concat(f,")"),g=t>1?"strides[j]":"strides",y=t>1?"strides[j + 1]":"strides";this.userCode="\n        ".concat(l," strides = ").concat(l,"(").concat(a,");\n\n        void main() {\n          ").concat(c," coords = getOutputCoords();\n          vec4 sum = vec4(0.);\n          vec4 found = vec4(0.);\n          for (int i = 0; i < ").concat(e,"; i+=2) {\n            ivec2 flattenedIndex = ivec2(0);\n            for (int j = 0; j < ").concat(t,"; j+=2) {\n              ivec4 index = round(").concat(d,");\n              flattenedIndex += index.xz * ").concat(g,";\n              if (j + 1 < ").concat(t,") {\n                flattenedIndex += index.yw * ").concat(y,";\n              }\n            }\n            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||\n                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {\n              vec4 updVals = ").concat(h,";\n              if (flattenedIndex[0] == coords[0]) {\n                sum.xy += updVals.xy;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[0] == coords[0] + 1) {\n                sum.zw += updVals.xy;\n                found.zw = vec2(1.);\n              }\n              if (flattenedIndex[1] == coords[0]) {\n                sum.xy += updVals.zw;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[1] == coords[0] + 1) {\n                sum.zw += updVals.zw;\n                found.zw = vec2(1.);\n              }\n            }\n          }\n          setOutput(mix(").concat(m,", sum, found));\n        }\n      ")}};function w2e(e){let{inputs:t,backend:n,attrs:r}=e,{indices:a,updates:i}=t,{shape:s}=r,{sliceRank:o,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=T.calculateShapes(i,a,s),p=[d/c,c];if(d===0)return n.makeTensorInfo(s,a.dtype);let h=ye({inputs:{x:a},backend:n,attrs:{shape:[l,o]}}),f=ye({inputs:{x:i},backend:n,attrs:{shape:[l,c]}}),m=n.makeTensorInfo([],"float32",new Float32Array([0])),g;Z().getBool("WEBGL_PACK")?g=new x2e(l,o,h.shape.length,f.shape.length,u,p):g=new vT(l,o,h.shape.length,f.shape.length,u,p);let y=n.runWebGLProgram(g,[f,h,m],f.dtype),b=ye({inputs:{x:y},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(m),b}var k2e={kernelName:vh,backendName:"webgl",kernelFunc:w2e},S2e=class{constructor(e,t,n,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,n];let a="while (left < right) {",i="for (int i = 0; i < ".concat(Math.ceil(Math.log2(t+1)),"; ++i) { if (left >= right) break;"),s=Z().getNumber("WEBGL_VERSION")===2?a:i,o=r==="left"?"<":"<=";this.userCode="\n       int findBound(int batch, float value) {\n         int left = 0;\n         int right = numInputs;\n         int mid;\n         ".concat(s,"\n           mid = (left + right) / 2;\n           if (getSortedSequence(batch, mid) ").concat(o," value) {\n             left = mid + 1;\n           } else {\n             right = mid;\n           }\n         }\n         return right;\n       }\n\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int valueIndex = coords[1];\n\n         float value = getValues(batch, valueIndex);\n\n         setOutput(float(findBound(batch, value)));\n       }\n     ")}};function I2e(e){let{inputs:t,backend:n,attrs:r}=e,{sortedSequence:a,values:i}=t,{side:s}=r,o=new S2e(a.shape[0],a.shape[1],i.shape[1],s),l=[[a.shape[1]]];return n.runWebGLProgram(o,[a,i],"int32",l)}var $2e={kernelName:wh,backendName:"webgl",kernelFunc:I2e},C2e=class{constructor(e,t,n){this.variableNames=["c","a","b"],this.outputShape=t;let r,a;if(n>4)throw Error("Where for rank ".concat(n," is not yet supported"));if(n===1)a="resRC",r="resRC";else{let s=["resRC.x","resRC.y","resRC.z","resRC.w"],o=[],l=[];for(let c=0;c<t.length;c++)l.push("".concat(s[c])),c<e&&o.push("".concat(s[c]));r=o.join(),a=l.join()}let i=St(n);this.userCode="\n      void main() {\n        ".concat(i," resRC = getOutputCoords();\n        float cVal = getC(").concat(r,");\n        if (cVal >= 1.0) {\n          setOutput(getA(").concat(a,"));\n        } else {\n          setOutput(getB(").concat(a,"));\n        }\n      }\n    ")}};function E2e(e){let{inputs:t,backend:n}=e,{condition:r,t:a,e:i}=t,s=new C2e(r.shape.length,a.shape,a.shape.length);return n.runWebGLProgram(s,[r,a,i],Ra(a.dtype,i.dtype))}var T2e={kernelName:kh,backendName:"webgl",kernelFunc:E2e},N2e="\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ".concat(T.SELU_SCALEALPHA,";\n  float scale = ").concat(T.SELU_SCALE,";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n"),_2e=it({opSnippet:N2e}),A2e={kernelName:Cc,backendName:"webgl",kernelFunc:_2e},R2e=Qh+"\n  return 1.0 / (1.0 + exp(-1.0 * x));\n",D2e="\n  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",F2e=it({opSnippet:R2e,packedOpSnippet:D2e,cpuKernelImpl:Awe}),M2e={kernelName:_c,backendName:"webgl",kernelFunc:F2e},O2e="\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n",L2e=it({opSnippet:O2e}),P2e={kernelName:Nc,backendName:"webgl",kernelFunc:L2e},z2e=Qh+"\n  return sin(x);\n",B2e="\n  vec4 result = sin(x);\n  bvec4 isNaN = isnan(x);\n  ".concat(Kc,"\n  return result;\n"),W2e=it({opSnippet:z2e,packedOpSnippet:B2e}),U2e={kernelName:Ec,backendName:"webgl",kernelFunc:W2e},V2e="\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n",H2e=it({opSnippet:V2e}),j2e={kernelName:Tc,backendName:"webgl",kernelFunc:H2e},G2e="\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n",q2e=it({opSnippet:G2e}),K2e={kernelName:Ac,backendName:"webgl",kernelFunc:q2e},X2e=e=>{let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:i,paddings:s}=r;k.assert(a.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");let o=i.reduce((y,b)=>y*b),l=[[0,0]];l.push(...s);for(let y=1+i.length;y<a.shape.length;++y)l.push([0,0]);let c=[],u=XU({inputs:{x:a},backend:n,attrs:{paddings:l,constantValue:0}}),d=T.getReshaped(u.shape,i,o,!1),p=T.getPermuted(d.length,i.length,!1),h=T.getReshapedPermuted(u.shape,i,o,!1),f=ye({inputs:{x:u},backend:n,attrs:{shape:d}}),m=Er({inputs:{x:f},backend:n,attrs:{perm:p}}),g=ye({inputs:{x:m},backend:n,attrs:{shape:h}});return c.push(u),c.push(f),c.push(m),c.forEach(y=>n.disposeIntermediateTensorInfo(y)),g},Y2e={kernelName:Ih,backendName:"webgl",kernelFunc:X2e};function Z2e(e){let{inputs:t,backend:n}=e,{indices:r,values:a,denseShape:i,defaultValue:s}=t;if(i.shape.length!==1)throw new Error("Dense shape must be a vector, saw:\n         ".concat(i.shape));if(r.shape.length!==2)throw new Error("Indices must be a matrix, saw:\n         ".concat(r.shape));if(a.shape.length!==1)throw new Error("Values must be a vector, saw:\n         ".concat(a.shape));if(s.shape.length!==0)throw new Error("Default value must be a scalar, saw:\n        ".concat(s.shape));let o=n.readSync(r.dataId),l=n.readSync(a.dataId),c=n.readSync(i.dataId),u=n.readSync(s.dataId)[0],[d,p,h,f,m]=Dwe(o,r.shape,r.dtype,l,a.dtype,c,u);return[n.makeTensorInfo(p,r.dtype,d),n.makeTensorInfo([p[0]],a.dtype,h),n.makeTensorInfo([f.length],"bool",new Uint8Array(f.map(g=>Number(g)))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}var Q2e={kernelName:hg,backendName:"webgl",kernelFunc:Z2e};function J2e(e){let{inputs:t,backend:n}=e,{inputIndices:r,inputShape:a,newShape:i}=t;if(r.shape.length!==2)throw new Error("Input indices should be a matrix but received shape ".concat(r.shape));if(a.shape.length!==1)throw new Error("Input shape should be a vector but received shape ".concat(a.shape));if(i.shape.length!==1)throw new Error("Target shape should be a vector but received shape ".concat(i.shape));let s=Array.from(n.readSync(a.dataId)),o=n.readSync(r.dataId),l=Array.from(n.readSync(i.dataId)),[c,u,d]=Fwe(o,r.shape,r.dtype,s,l);return[n.makeTensorInfo(u,r.dtype,c),n.makeTensorInfo([d.length],i.dtype,new Int32Array(d))]}var eTe={kernelName:Ch,backendName:"webgl",kernelFunc:J2e};function tTe(e){let{inputs:t,backend:n}=e,{data:r,indices:a,segmentIds:i}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error("Indices should be a vector but received shape\n              ".concat(a.shape));if(i.shape.length!==1)throw new Error("Segment ids should be a vector but received shape\n              ".concat(i.shape));let s=n.readSync(r.dataId),o=n.readSync(a.dataId),l=n.readSync(i.dataId),[c,u]=vU(s,r.shape,r.dtype,o,l,!0);return n.makeTensorInfo(u,r.dtype,c)}var nTe={kernelName:fg,backendName:"webgl",kernelFunc:tTe};function rTe(e){let{inputs:t,backend:n}=e,{data:r,indices:a,segmentIds:i}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error("Indices should be a vector but received shape\n             ".concat(a.shape));if(i.shape.length!==1)throw new Error("Segment ids should be a vector but received shape\n             ".concat(i.shape));let s=n.readSync(r.dataId),o=n.readSync(a.dataId),l=n.readSync(i.dataId),[c,u]=vU(s,r.shape,r.dtype,o,l);return n.makeTensorInfo(u,r.dtype,c)}var aTe={kernelName:mg,backendName:"webgl",kernelFunc:rTe};function iTe(e){let{inputs:t,backend:n,attrs:r}=e,{sparseIndices:a,sparseValues:i,defaultValue:s}=t,{outputShape:o}=r,{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:p}=T.calculateShapes(i,a,o),h=!1;if(i.dtype==="string"){let y=n.bufferSync(a),b=n.bufferSync(i),v=k.decodeString(n.readSync(s.dataId)[0]),x=_we(y,b,o,p,u,c,l,d,v,h);return n.makeTensorInfo(o,x.dtype,x.values)}let f=new vT(c,l,a.shape.length,i.shape.length,d,[p,1],h),m=n.runWebGLProgram(f,[i,a,s],i.dtype),g=ye({inputs:{x:m},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(m),g}var sTe={kernelName:Eh,backendName:"webgl",kernelFunc:iTe};function oTe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{numOrSizeSplits:i,axis:s}=r,o=k.parseAxisParam(s,a.shape)[0],l=T.prepareSplitSize(a,i,o),c=a.shape.length,u=new Array(c).fill(0),d=a.shape.slice();return l.map(p=>{let h=[...d];h[o]=p;let f=Jh({inputs:{x:a},backend:n,attrs:{begin:u,size:h}});return u[o]+=p,f})}var lTe={kernelName:$h,backendName:"webgl",kernelFunc:oTe},xD="return sqrt(x);",uTe=it({opSnippet:xD,packedOpSnippet:xD,cpuKernelImpl:Mwe}),cTe={kernelName:Rc,backendName:"webgl",kernelFunc:uTe},dTe="return x * x;",pTe=it({opSnippet:dTe}),hTe={kernelName:gg,backendName:"webgl",kernelFunc:pTe},wD="return (a - b) * (a - b);",fTe=Zn({opSnippet:wD,packedOpSnippet:wD}),mTe={kernelName:Mc,backendName:"webgl",kernelFunc:fTe};function gTe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t;if(a.dtype!=="string")throw new Error("Input must be of datatype string");let i=n.readSync(a.dataId),s=T.fromUint8ToStringArray(i),o=Owe(s,"string",r);return n.makeTensorInfo(a.shape,"string",o)}var yTe={kernelName:yg,backendName:"webgl",kernelFunc:gTe};function bTe({inputs:e,attrs:t,backend:n}){let{x:r}=e,a=ai+"\n    return x > 0.0 ? 1.0 : float(".concat(t.alpha,");\n  "),i=new Zi(r.shape,a);return n.runWebGLProgram(i,[r],r.dtype)}var vTe={kernelName:Xo,backendName:"webgl",kernelFunc:bTe},xTe=class{constructor(e,t,n){this.variableNames=["x"],this.outputShape=n;let r=n.length,a=St(n.length),i=St(n.length),s="";if(r===1)s="coords * strides + begin";else{let o=0;s=n.map((l,c)=>(o++,n.length===1?"coords * strides[".concat(c,"] + begin[").concat(c,"]"):"coords[".concat(o-1,"] * strides[").concat(c,"] + begin[").concat(c,"]"))).join(",")}this.userCode="\n      ".concat(a," begin = ").concat(a,"(").concat(e,");\n      ").concat(a," strides = ").concat(a,"(").concat(t,");\n\n      void main() {\n        ").concat(i," coords = getOutputCoords();\n        setOutput(getX(").concat(s,"));\n      }\n    ")}};function wTe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{begin:i,end:s,strides:o,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:p}=r,{finalShapeSparse:h,finalShape:f,isIdentity:m,sliceDim0:g,isSimpleSlice:y,begin:b,end:v,strides:x}=In.sliceInfo(a.shape,i,s,o,l,c,u,d,p),w;if(m)w=ye({inputs:{x:a},backend:n,attrs:{shape:f}});else if(g||y){k.assert(a.shape.length>=1,()=>"Input must have rank at least 1, got: ".concat(a.shape.length));let C=In.computeOutShape(b,v,x),E=Jh({inputs:{x:a},backend:n,attrs:{begin:b,size:C}});w=ye({inputs:{x:E},backend:n,attrs:{shape:f}}),n.disposeIntermediateTensorInfo(E)}else if(n.shouldExecuteOnCPU([a])){let C=n.readSync(a.dataId),E=Ze(a.shape,a.dtype,C),_=Lwe(h,E,x,b);w=n.makeTensorInfo(f,a.dtype,_.values)}else{let C=new xTe(b,x,h);w=n.runWebGLProgram(C,[a],a.dtype)}let $=ye({inputs:{x:w},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(w),$}var kTe={kernelName:Th,backendName:"webgl",kernelFunc:wTe};function STe(e){let{inputs:t,backend:n,attrs:r}=e,{separator:a,nGramWidths:i,leftPad:s,rightPad:o,padWidth:l,preserveShortSequences:c}=r,{data:u,dataSplits:d}=t,p=n.readSync(u.dataId),h=n.readSync(d.dataId),[f,m]=Pwe(p,h,a,i,s,o,l,c);return[n.makeTensorInfo([f.length],"string",f),n.makeTensorInfo(d.shape,"int32",m)]}var ITe={kernelName:bg,backendName:"webgl",kernelFunc:STe};function $Te(e){let{inputs:t,backend:n,attrs:r}=e,{skipEmpty:a}=r,{input:i,delimiter:s}=t;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error("Input must be a vector, got shape: ".concat(i.shape));if(s.shape.length!==0)throw new Error("Delimiter must be a scalar, got shape: ".concat(s.shape));let o=n.readSync(i.dataId),l=n.readSync(s.dataId)[0],[c,u,d]=zwe(o,l,a),p=u.length;return[n.makeTensorInfo([p,2],"int32",c),n.makeTensorInfo([p],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(d))]}var CTe={kernelName:vg,backendName:"webgl",kernelFunc:$Te};function ETe(e){let{inputs:t,backend:n,attrs:r}=e,{numBuckets:a}=r,{input:i}=t;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(a<=0)throw new Error("Number of buckets must be at least 1");let s=n.readSync(i.dataId),o=Bwe(s,a);return n.makeTensorInfo(i.shape,"int32",o)}var TTe={kernelName:xg,backendName:"webgl",kernelFunc:ETe},NTe="return tan(x);",_Te=it({opSnippet:NTe}),ATe={kernelName:Lc,backendName:"webgl",kernelFunc:_Te},RTe="\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n",DTe=it({opSnippet:RTe}),FTe={kernelName:Pc,backendName:"webgl",kernelFunc:DTe};function MTe(e){let{inputs:t,backend:n,attrs:r}=e,{tensor:a,indices:i,updates:s}=t,{sliceRank:o,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=T.calculateShapes(s,i,a.shape),p=[d/c,c];if(d===0)return n.makeTensorInfo(a.shape,i.dtype);let h=ye({inputs:{x:i},backend:n,attrs:{shape:[l,o]}}),f=ye({inputs:{x:s},backend:n,attrs:{shape:[l,c]}}),m=ye({inputs:{x:a},backend:n,attrs:{shape:p}}),g=new vT(l,o,h.shape.length,f.shape.length,u,p,!1,!0),y=n.runWebGLProgram(g,[f,h,m],m.dtype),b=ye({inputs:{x:y},backend:n,attrs:{shape:a.shape}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),b}var OTe={kernelName:xh,backendName:"webgl",kernelFunc:MTe},LTe=class{constructor(e,t){this.variableNames=["A"];let n=new Array(e.length);for(let i=0;i<n.length;i++)n[i]=e[i]*t[i];this.outputShape=n,this.rank=n.length;let r=St(this.rank),a=PTe(e);this.userCode="\n      void main() {\n        ".concat(r," resRC = getOutputCoords();\n        setOutput(getA(").concat(a,"));\n      }\n    ")}};function PTe(e){let t=e.length;if(t>5)throw Error("Tile for rank ".concat(t," is not yet supported"));if(t===1)return"imod(resRC, ".concat(e[0],")");let n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let a=0;a<e.length;a++)r.push("imod(".concat(n[a],", ").concat(e[a],")"));return r.join()}function ZU(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{reps:i}=r;if(a.dtype==="string"||a.shape.length>5){let o=n.readSync(a.dataId),l=a.dtype==="string"?o.map(d=>k.decodeString(d)):o,c=Ze(a.shape,a.dtype,l),u=Uwe(c,i);return n.makeTensorInfo(u.shape,u.dtype,u.values)}let s=new LTe(a.shape,i);return n.runWebGLProgram(s,[a],a.dtype)}var zTe={kernelName:Ko,backendName:"webgl",kernelFunc:ZU},BTe=class{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode="\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // We compare elements pair-wise within a group of size 2 * inc.\n         // The comparing rule for each group alternates between ascending\n         // and descending. Within each group, we compare each pair at\n         // positions i and i+inc. To decide whether an element at position i\n         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than\n         // inc, it is in the first half of the group, we denote it as x0,\n         // otherwise we denote it as x1.\n         // For example, as shown in the Bitonic top K paper referenced above,\n         // Figure5(a) shows that element[1] is in the\n         // second half of the group when group size is 2, but it is in the\n         // first half of the group when group size is 4.\n\n         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;\n         int i = isFirstInPair ? elemIdx : elemIdx - inc;\n\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));\n         float x0 = i0 < n ? getX(batch, i0) : negativeInf;\n         float x1 = i1 < n ? getX(batch, i1) : negativeInf;\n\n         // Denotes which direction indices are in (ascending or descending).\n         bool reverse = imod(elemIdx, 2 * dir) >= dir;\n         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);\n         if (reverse == isGreater) { // Elements in opposite order of direction\n           int iTemp = i0;\n           i0 = i1;\n           i1 = iTemp;\n         }\n         if (isFirstInPair) {\n            setOutput(float(i0));\n         } else {\n            setOutput(float(i1));\n         }\n       }\n     "}},WTe=class{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode="\n    void main() {\n         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // The output size is half of the previous size.\n         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),\n         // we only need to output the indices at positions |, the indices at\n         // positions _ can be thrown away, see Figure5(b) After Phase 2\n         // (Merge phase) in the Bitonic Top K paper referenced above.\n         // For example, the paper shows we only need to output the orange bars.\n         // The output sequence should look like this | | | | | | | |.\n         // Because the sequence is halved, to map the output index back\n         // to the previous sequence to find the corresponding value,\n         // we need to double the index. When we double the index,\n         // we basically interpolate a position, so 2i looks like\n         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position\n         // of each 2k positions by - elemIdx % k. E.g. for output at\n         // index 4,5,6,7, we want to get the corresponding element at\n         // original index 8,9,10,11, for output at index 8,9,10,11,\n         // we want to get the corresponding element at original index\n         // 16,17,18,19, so on and so forth.\n\n         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));\n\n         float x0 = getX(batch, i0);\n         float x1 = i1 < n ? getX(batch, i1) : x0;\n\n         setOutput(x0 >= x1 ? float(i0) : float(i1));\n       }\n     "}};function hl(e,t){t!==null&&e.disposeIntermediateTensorInfo(t)}function kD(e){let t=1;for(;t<e;)t*=2;return t}function UTe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{k:i,sorted:s}=r,o=Z().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=Z().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=a.shape,u=c[c.length-1];if(n.shouldExecuteOnCPU([a])||u<o||i>l){let _=n.readSync(a.dataId),[R,N]=Vwe(_,c,a.dtype,i,s);return[n.makeTensorInfo(R.shape,R.dtype,R.values),n.makeTensorInfo(N.shape,N.dtype,N.values)]}if(i===0)return c[c.length-1]=0,[n.makeTensorInfo(c,a.dtype,[]),n.makeTensorInfo(c,"int32",[])];if(u===1)return[a,ry({attrs:{shape:c,dtype:"int32",value:0},backend:n})];let d=n.texData.get(a.dataId),p=d!==null&&d.isPacked,h=p?n.unpackTensor(a):a,f=k.sizeFromShape(c)/u,m=ye({inputs:{x:h},attrs:{shape:[f,u]},backend:n});p&&hl(n,h);let g=kD(i),y=kD(u),b=null,v=()=>b===null?[m,m]:[m,b],x=(_,R,N)=>{let I=v(),O=new BTe(N),P=[[u],[b===null?1:0],[Number.NEGATIVE_INFINITY],[_],[R]],L=b;b=n.runWebGLProgram(O,I,"int32",P),hl(n,L)};for(let _=1;_<g;_*=2){let R=_*2;for(let N=_;N>=1;N/=2)x(R,N,[f,y])}for(let _=y;_>g;_/=2){let R=v(),N=new WTe([f,_/2]),I=[[u],[b===null?1:0],[g]],O=b;b=n.runWebGLProgram(N,R,"int32",I),hl(n,O);let P=g/2,L=P*2;for(let U=P;U>=1;U/=2)x(L,U,b.shape)}let w=b;b=Jh({inputs:{x:b},backend:n,attrs:{begin:0,size:[f,i]}}),hl(n,w);let $=VU({inputs:{x:m,indices:b},backend:n,attrs:{axis:1,batchDims:1}});hl(n,m);let C=c.slice(0,-1);C.push(i),w=b,b=ye({inputs:{x:b},attrs:{shape:C},backend:n}),hl(n,w);let E=$;return $=ye({inputs:{x:$},attrs:{shape:C},backend:n}),hl(n,E),[$,b]}var VTe={kernelName:Nh,backendName:"webgl",kernelFunc:UTe},HTe=class{constructor(e,t,n,r,a,i){this.variableNames=["Image","Transforms"],this.outputShape=i;let s=n==="nearest"?1:2,o;switch(r){case"constant":o=1;break;case"reflect":o=2;break;case"wrap":o=3;break;case"nearest":o=4;break;default:o=1;break}this.userCode="\n            float mapCoord(float outCoord, float len) {\n              float inCoord = outCoord;\n              if(".concat(o," == 2) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    if (inCoord < sz2) {\n                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +\n                      inCoord;\n                    }\n                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    inCoord -= sz2 * float(int(float(inCoord / sz2)));\n                    if (inCoord >= len) {\n                      inCoord = sz2 - inCoord - 1.0;\n                    }\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(o," == 3) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord -= len * float(int(float(inCoord / sz)));\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(o," == 4) {\n                return clamp(outCoord, 0.0, len - 1.0);\n              } else {\n                return outCoord;\n              }\n            }\n\n            float readWithFillValue(int batch, int coordY, int coordX,\n              int channel) {\n              float outputValue;\n              if (0 <= coordY && coordY < ").concat(e," && 0 <= coordX && coordX < ").concat(t,") {\n                  outputValue = getImage(batch, coordY, coordX, channel);\n              } else {\n                outputValue = float(").concat(a,");\n              }\n              return outputValue;\n            }\n\n            void main() {\n              ivec4 coords = getOutputCoords();\n              float outputValue;\n              int batch = coords[0];\n              int x = coords[2];\n              int y = coords[1];\n              int channel = coords[3];\n              float xf = float(x);\n              float yf = float(y);\n              float a1 = getTransforms(batch, 0);\n              float a2 = getTransforms(batch, 1);\n              float a3 = getTransforms(batch, 2);\n              float b1 = getTransforms(batch, 3);\n              float b2 = getTransforms(batch, 4);\n              float b3 = getTransforms(batch, 5);\n              float c1 = getTransforms(batch, 6);\n              float c2 = getTransforms(batch, 7);\n              float projection = c1 * xf + c2 * yf + 1.0;\n              if (projection == 0.0) {\n                outputValue = float(").concat(a,");\n              } else {\n                float inX = (a1 * xf + a2 * yf + a3) / projection;\n                float inY = (b1 * xf + b2 * yf + b3) / projection;\n                float mapX = mapCoord(inX, float(").concat(t,"));\n                float mapY = mapCoord(inY, float(").concat(e,"));\n\n                if (").concat(s," == 1) {\n                  int coordY = int(round(mapY));\n                  int coordX = int(round(mapX));\n                  outputValue = readWithFillValue(batch, coordY, coordX,\n                    channel);\n                } else {\n                  float yFloor = floor(mapY);\n                  float xFloor = floor(mapX);\n                  float yCeil = yFloor + 1.0;\n                  float xCeil = xFloor + 1.0;\n                  float valueYFloor = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);\n                  float valueYCeil = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);\n                  outputValue = (yCeil - mapY) * valueYFloor +\n                  (mapY - yFloor) * valueYCeil;\n                }\n              }\n              setOutput(outputValue);\n            }\n        ")}};function jTe(e){let{inputs:t,backend:n,attrs:r}=e,{image:a,transforms:i}=t,{interpolation:s,fillMode:o,fillValue:l,outputShape:c}=r,[u,d,p,h]=a.shape,[f,m]=c!=null?c:[d,p],g=[u,f,m,h],y=new HTe(d,p,s,o,l,g);return n.runWebGLProgram(y,[a,i],"float32")}var GTe={kernelName:_h,backendName:"webgl",kernelFunc:jTe};function qTe(e){let{inputs:t,attrs:n,backend:r}=e,{axis:a}=n,{x:i}=t;Gh(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");let s=r.readSync(i.dataId),{outputValues:o,outputShape:l,indices:c}=Hwe(s,a,i.shape,i.dtype);return[r.makeTensorInfo(l,i.dtype,o),r.makeTensorInfo([c.length],"int32",c)]}var KTe={kernelName:wg,backendName:"webgl",kernelFunc:qTe};function XTe(e){let{inputs:t,backend:n,attrs:r}=e,{value:a}=t,{axis:i}=r;i<0&&(i+=a.shape.length);let s=a,o=s.shape.length,l=a.shape[i],c=new Array(o-1),u=0;for(let m=0;m<o;m++)m!==i&&(c[u++]=s.shape[m]);let d=[],p=new Array(o).fill(0),h=s.shape.slice();h[i]=1;let f=new Array(l);for(let m=0;m<f.length;m++){p[i]=m;let g=Jh({inputs:{x:s},backend:n,attrs:{begin:p,size:h}}),y=ye({inputs:{x:g},backend:n,attrs:{shape:c}});f[m]=y,d.push(g)}return d.forEach(m=>n.disposeIntermediateTensorInfo(m)),f}var YTe={kernelName:Ah,backendName:"webgl",kernelFunc:XTe},ZTe=class{constructor(e,t){this.variableNames=["x","segmentIds"];let n=e.windowSize,r=e.batchSize,a=e.inSize,i=e.numSegments,s=i*Math.ceil(a/n);this.outputShape=[r,s];let o="0.0",l="sumValue",c=Math.floor(n/4)*4,u=n%4,d="\n        sumValue += dot(values, segFilter);\n    ",p="";a%n>0&&(p="\n        if (inIdx < 0 || inIdx >= ".concat(a,") {\n          return initializationValue;\n        }\n      "));let h="";a%n>0&&(h="\n        if (inIdx < 0 || inIdx >= ".concat(a,") {\n          return -1.0;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat(o,";\n\n      float getValue(int batch, int inIdx) {\n        ").concat(p,"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ").concat(h,"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ").concat(i,")) * float(").concat(n,"));\n        int currentSeg = int(mod(float(outIdx), float(").concat(i,")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(c,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ").concat(d,"\n        }\n\n        int inIdx = inOffset + ").concat(c,";\n        if (").concat(u===1,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ").concat(d,"\n        } else if (").concat(u===2,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ").concat(d,"\n        } else if (").concat(u===3,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ").concat(d,"\n        }\n        setOutput(").concat(l,");\n      }\n    ")}};function QTe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,segmentIds:i}=t,{numSegments:s}=r,o=a.shape.length,l=[],c=0,u=T.getAxesPermutation([c],o),d=a;u!=null&&(d=Er({inputs:{x:a},backend:n,attrs:{perm:u}}),l.push(d),c=T.getInnerMostAxes(1,o)[0]);let p=T.segment_util.computeOutShape(d.shape,c,s),h=k.sizeFromShape([d.shape[c]]),f=ye({inputs:{x:d},backend:n,attrs:{shape:[-1,h]}});l.push(f);let m=lx(a.dtype),g=(x,w,$,C,E)=>{let _=x.shape[0],R=x.shape[1],N=T.segment_util.segOpComputeOptimalWindowSize(R,E),I={windowSize:N,inSize:R,batchSize:_,numSegments:E},O=new ZTe(I,w),P=n.compileAndRun(O,[x,$],C);if(l.push(P),P.shape[1]===E)return P;let L=YU({backend:n,attrs:{start:0,stop:E,step:1,dtype:"float32"}}),U=ZU({inputs:{x:L},backend:n,attrs:{reps:[R/N]}});return l.push(L),l.push(U),g(P,w,U,C,E)},y=g(f,"unsortedSegmentSum",i,m,s),b=ye({inputs:{x:y},backend:n,attrs:{shape:p}}),v=b;if(u!=null){l.push(b);let x=T.getUndoAxesPermutation(u);v=Er({inputs:{x:v},backend:n,attrs:{perm:x}})}return l.forEach(x=>n.disposeIntermediateTensorInfo(x)),v}var JTe={kernelName:kg,backendName:"webgl",kernelFunc:QTe},eNe=[L1e,z1e,U1e,j1e,q1e,Y1e,Q1e,eke,ake,ske,uke,pke,mke,vke,kke,Ike,Cke,_ke,Rke,Fke,Pke,jke,qke,Zke,Jke,iSe,oSe,dSe,x1e,fSe,vSe,SSe,NSe,RSe,FSe,OSe,PSe,USe,jSe,KSe,YSe,QSe,eIe,rIe,iIe,uIe,dIe,fIe,yIe,vIe,SIe,EIe,AIe,FIe,LIe,PIe,BIe,UIe,HIe,GIe,KIe,QIe,t$e,a$e,s$e,u$e,p$e,g$e,x$e,v1e,k$e,ySe,$$e,T$e,A$e,k1e,M$e,z$e,W$e,j$e,K$e,Q$e,tCe,iCe,uCe,pCe,fCe,bCe,xCe,kCe,CCe,TCe,_Ce,RCe,FCe,PCe,UCe,GCe,eEe,$1e,aEe,oEe,cEe,hEe,tSe,gEe,bEe,xEe,SEe,EEe,I1e,NEe,AEe,DEe,MEe,OEe,nSe,YCe,zEe,VEe,qEe,E1e,ZEe,e2e,a2e,o2e,d2e,h2e,g2e,v2e,k2e,$2e,T2e,A2e,M2e,P2e,U2e,j2e,Vke,QCe,K2e,Y2e,Q2e,eTe,nTe,aTe,sTe,lTe,cTe,hTe,mTe,yTe,vTe,kTe,ITe,CTe,TTe,ZCe,F1e,ATe,FTe,OTe,zTe,VTe,GTe,M1e,KTe,YTe,JTe,yEe];for(let e of eNe)Sg(e);var ut;(function(e){e[e.float32=0]="float32",e[e.int32=1]="int32",e[e.bool=2]="bool",e[e.string=3]="string",e[e.complex64=4]="complex64"})(ut||(ut={}));var Pm;(function(e){e[e.linear=0]="linear",e[e.relu=1]="relu",e[e.relu6=2]="relu6",e[e.prelu=3]="prelu",e[e.leakyrelu=4]="leakyrelu",e[e.sigmoid=5]="sigmoid",e[e.elu=6]="elu"})(Pm||(Pm={}));var QU;function tNe(e){QU=e.wasm.cwrap(Yl,null,["number","array","number","number","array","number","number","number","number","number","number","number","number"])}function nNe(e){let{inputs:t,backend:n,attrs:r}=e,{a,b:i,bias:s,preluActivationWeights:o}=t;if(a.dtype!=="float32"||i.dtype!=="float32")throw new Error("_FusedMatMul for non non-float32 tensors not yet supported.");let{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:d}=r,p=n.dataIdMap.get(a.dataId).id,h=n.dataIdMap.get(i.dataId).id,f=0;if(s!=null){let E=n.dataIdMap.get(s.dataId);if(E.shape.length!==1)throw new Error("_FusedMatMul only supports rank-1 bias but got rank ".concat(E.shape.length,"."));f=E.id}let m=o==null?0:n.dataIdMap.get(o.dataId).id,g=Pm[u];if(g==null)throw new Error("".concat(u," activation not yet supported for FusedConv2D in the wasm backend."));let y=l?a.shape[2]:a.shape[1],b=c?i.shape[1]:i.shape[2],v=Fh.assertAndGetBroadcastShape(a.shape.slice(0,-2),i.shape.slice(0,-2)),x=n.makeOutput([...v,y,b],a.dtype),w=n.dataIdMap.get(x.dataId).id,$=new Uint8Array(new Int32Array(a.shape).buffer),C=new Uint8Array(new Int32Array(i.shape).buffer);return QU(p,$,a.shape.length,h,C,i.shape.length,l,c,g,f,m,d||0,w),x}var rNe={kernelName:Yl,backendName:"wasm",setupFunc:tNe,kernelFunc:nNe};function at(e,t){let n;function r(i){n=i.wasm.cwrap(e,null,["number","number","number"])}function a(i){let{backend:s,inputs:{x:o}}=i,l=s.dataIdMap.get(o.dataId).id,c=s.makeOutput(o.shape,t||o.dtype),u=s.dataIdMap.get(c.dataId).id;return k.sizeFromShape(c.shape)===0||n(l,ut[o.dtype],u),c}return{kernelName:e,backendName:"wasm",setupFunc:r,kernelFunc:a}}var aNe=at(Rp),iNe=at(wu),sNe=at(ku);function gn(e,t,n){let r;function a(s){r=s.wasm.cwrap(e,null,["number","array","number","number","array","number","number","number"])}function i(s){let{backend:o,inputs:l}=s,{a:c,b:u}=l,d=o.dataIdMap.get(c.dataId).id,p=o.dataIdMap.get(u.dataId).id,h=n!=null?n:c.dtype,f=T.assertAndGetBroadcastShape(c.shape,u.shape),m=o.makeOutput(f,h);if(k.sizeFromShape(f)===0)return m;let g=new Uint8Array(new Int32Array(c.shape).buffer),y=new Uint8Array(new Int32Array(u.shape).buffer),b=o.dataIdMap.get(m.dataId).id;return r(d,g,c.shape.length,p,y,u.shape.length,ut[c.dtype],b),m}return{kernelName:e,backendName:"wasm",setupFunc:a,kernelFunc:i}}var oNe=gn(Go),JU;function lNe(e){JU=e.wasm.cwrap(Su,null,["array","number","number","number"])}function uNe(e){let{inputs:t,backend:n}=e,r=n.makeOutput(t[0].shape,t[0].dtype);if(k.sizeFromShape(r.shape)===0)return r;let a=t.map(o=>n.dataIdMap.get(o.dataId).id),i=new Uint8Array(new Int32Array(a).buffer),s=n.dataIdMap.get(r.dataId).id;return JU(i,a.length,ut[r.dtype],s),r}var cNe={kernelName:Su,backendName:"wasm",setupFunc:lNe,kernelFunc:uNe};function mw(e){let{inputs:{x:t},backend:n}=e;if(t.dtype==="string")return wr(n.readSync(t.dataId),t.shape,t.dtype);let r=n.makeOutput(t.shape,t.dtype),a=n.typedArrayFromHeap(t);return n.typedArrayFromHeap(r).set(a),r}var dNe={kernelName:Yu,backendName:"wasm",kernelFunc:mw},eV;function pNe(e){eV=e.wasm.cwrap(Es,null,["number","array","number","number","number","array","number"])}function Bo(e){let{inputs:t,backend:n,attrs:r}=e,[a,i]=fNe(t.x.shape,r.perm),s=!0;for(let f=0;f<i.length;f++)i[f]!==f&&(s=!1);let o=hNe(t.x.shape,r.perm),l={dataId:t.x.dataId,shape:a,dtype:t.x.dtype};if(s){let f=mw({inputs:t,backend:n});return f.shape=o,f}let c=n.makeOutput(o,l.dtype),u=n.dataIdMap.get(l.dataId).id,d=n.dataIdMap.get(c.dataId).id,p=new Uint8Array(new Int32Array(i).buffer),h=new Uint8Array(new Int32Array(l.shape).buffer);return eV(u,h,l.shape.length,ut[l.dtype],d,p,i.length),c}function hNe(e,t){let n=new Array(e.length);for(let r=0;r<n.length;r++)n[r]=e[t[r]];return n}function fNe(e,t){let n=[],r=[];for(let a=0;a<e.length;++a)e[a]!==1&&n.push(e[a]),e[t[a]]!==1&&r.push(t[a]);for(let a=0;a<r.length;++a){let i=-1;for(let s=0;s<r.length;++s)r[s]>=a&&(i===-1||r[i]>r[s])&&(i=s);r[i]=a}return[n,r]}var mNe={kernelName:Es,backendName:"wasm",kernelFunc:Bo,setupFunc:pNe};function rl(e,t,n){let r=e.shape,a=e.shape.length,i=k.parseAxisParam(t,r),s=i,o=T.getAxesPermutation(s,a),l=null,c=!1;if(o!=null){let u=new Array(a);for(let p=0;p<u.length;p++)u[p]=r[o[p]];s=T.getInnerMostAxes(s.length,a),l=Bo({inputs:{x:e},attrs:{perm:o},backend:n});let d=n.dataIdMap.get(e.dataId).id;n.dataIdMap.get(l.dataId).id!==d&&(c=!0)}return{transposed:l,originalAxes:i,axes:s,inputWasTransposed:c}}var tV;function gNe(e){tV=e.wasm.cwrap(Dp,null,["number, number, number"])}function yNe(e){let{backend:t,inputs:n,attrs:r}=e,{axis:a,keepDims:i}=r,{x:s}=n,o=t.dataIdMap.get(s.dataId).id,l=s,{transposed:c,axes:u,originalAxes:d,inputWasTransposed:p}=rl(s,a,t);if(p){let b=t.dataIdMap.get(c.dataId).id;l=c,o=b}let h=l.shape.length;T.assertAxesAreInnerMostDims("all",u,h);let[f,m]=T.computeOutAndReduceShapes(l.shape,u),g=k.sizeFromShape(m),y=t.makeOutput(f,s.dtype);if(k.sizeFromShape(l.shape)!==0){let b=t.dataIdMap.get(y.dataId).id;tV(o,g,b)}if(p&&t.disposeData(c.dataId),i){let b=T.expandShapeToKeepDim(y.shape,d);y.shape=b}return y}var bNe={kernelName:Dp,backendName:"wasm",setupFunc:gNe,kernelFunc:yNe},nV;function vNe(e){nV=e.wasm.cwrap(Fp,null,["number, number, number"])}function xNe(e){let{backend:t,inputs:n,attrs:r}=e,{axis:a,keepDims:i}=r,{x:s}=n,o=t.dataIdMap.get(s.dataId).id,l=s,{transposed:c,axes:u,originalAxes:d,inputWasTransposed:p}=rl(s,a,t);if(p){let b=t.dataIdMap.get(c.dataId).id;l=c,o=b}let h=l.shape.length;T.assertAxesAreInnerMostDims("any",u,h);let[f,m]=T.computeOutAndReduceShapes(l.shape,u),g=k.sizeFromShape(m),y=t.makeOutput(f,s.dtype);if(k.sizeFromShape(l.shape)!==0){let b=t.dataIdMap.get(y.dataId).id;nV(o,g,b)}if(p&&t.disposeData(c.dataId),i){let b=T.expandShapeToKeepDim(y.shape,d);y.shape=b}return y}var wNe={kernelName:Fp,backendName:"wasm",setupFunc:vNe,kernelFunc:xNe};function rV(e){let t;function n(a){t=a.wasm.cwrap(e,null,["number","number","number","number","number"])}function r(a){let{backend:i,inputs:s,attrs:o}=a,{axis:l}=o,{x:c}=s,u=i.dataIdMap.get(c.dataId).id,d=u,p=c,{transposed:h,axes:f,inputWasTransposed:m}=rl(c,l,i);if(m){let w=i.dataIdMap.get(h.dataId).id;w!==u&&(p=h,d=w)}let g=p.shape.slice(0,-1),y=i.makeOutput(g,"int32"),b=i.dataIdMap.get(y.dataId).id,v=k.sizeFromShape(y.shape),x=p.shape[f[0]];return t(d,ut[p.dtype],v,x,b),m&&i.disposeData(h.dataId),y}return{kernelName:e,backendName:"wasm",setupFunc:n,kernelFunc:r}}var kNe=rV(Mp),SNe=rV(Op),INe=at(Iu),$Ne=at($u),CNe=at(Cu),ENe=gn(Tu),TNe=at(Eu),aV;function NNe(e){aV=e.wasm.cwrap(Nu,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function _Ne(e){let{inputs:t,attrs:n,backend:r}=e,a=t.x,i=r.dataIdMap.get(a.dataId).id,{filterSize:s,strides:o,pad:l,dimRoundingMode:c}=n,u=T.computePool2DInfo(a.shape,s,o,1,l,c),d=u.filterHeight,p=u.filterWidth,h=u.padInfo.top,f=u.padInfo.right,m=u.padInfo.bottom,g=u.padInfo.left,y=u.strideHeight,b=u.strideWidth,v=u.inChannels;if(u.dataFormat!=="channelsLast")throw new Error("wasm backend does not support dataFormat:'".concat(u.dataFormat,"'. Please use 'channelsLast'."));if(u.dilationWidth!==1||u.dilationHeight!==1)throw new Error("was backend only supports average pooling with dilation = [1, 1], got [".concat(u.dilationHeight,", ").concat(u.dilationWidth,"]."));let x=r.makeOutput(u.outShape,"float32"),w=r.dataIdMap.get(x.dataId).id;return aV(i,a.shape[0],a.shape[1],a.shape[2],d,p,h,f,m,g,y,b,v,w),x}var ANe={kernelName:Nu,backendName:"wasm",setupFunc:NNe,kernelFunc:_Ne},iV;function RNe(e){iV=e.wasm.cwrap("AvgPool3D",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function DNe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:i,strides:s,pad:o,dimRoundingMode:l,dataFormat:c}=r,u=T.computePool3DInfo(a.shape,i,s,1,o,l,c),d=n.makeOutput(u.outShape,a.dtype);return iV(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(d.dataId).id,u.batchSize,u.inChannels,u.inDepth,u.inHeight,u.inWidth,u.outDepth,u.outHeight,u.outWidth,u.strideDepth,u.strideHeight,u.strideWidth,u.dilationDepth,u.dilationHeight,u.dilationWidth,u.effectiveFilterDepth,u.effectiveFilterHeight,u.effectiveFilterWidth,u.padInfo.front,u.padInfo.top,u.padInfo.left),d}var FNe={kernelName:Lp,backendName:"wasm",setupFunc:RNe,kernelFunc:DNe},sV;function MNe(e){sV=e.wasm.cwrap("AvgPool3DGrad",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function ONe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,{filterSize:s,strides:o,pad:l,dimRoundingMode:c}=r,u=T.computePool3DInfo(i.shape,s,o,1,l,c),d=n.makeOutput(i.shape,i.dtype);return sV(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(d.dataId).id,u.batchSize,u.inChannels,u.inDepth,u.inHeight,u.inWidth,u.outDepth,u.outHeight,u.outWidth,u.strideDepth,u.strideHeight,u.strideWidth,u.dilationDepth,u.dilationHeight,u.dilationWidth,u.effectiveFilterDepth,u.effectiveFilterHeight,u.effectiveFilterWidth,u.padInfo.front,u.padInfo.top,u.padInfo.left,u.filterDepth,u.filterHeight,u.filterWidth),d}var LNe={kernelName:rg,backendName:"wasm",setupFunc:MNe,kernelFunc:ONe},oV;function PNe(e){oV=e.wasm.cwrap("AvgPoolGrad",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function zNe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,{filterSize:s,strides:o,pad:l}=r,c=T.computePool2DInfo(i.shape,s,o,1,l),u=n.makeOutput(i.shape,i.dtype);return oV(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(u.dataId).id,c.batchSize,c.inChannels,c.inHeight,c.inWidth,c.outHeight,c.outWidth,c.strideHeight,c.strideWidth,c.dilationHeight,c.dilationWidth,c.effectiveFilterHeight,c.effectiveFilterWidth,c.padInfo.top,c.padInfo.left,c.filterHeight,c.filterWidth),u}var BNe={kernelName:ng,backendName:"wasm",setupFunc:PNe,kernelFunc:zNe};function Vr(e){let{inputs:t,attrs:n}=e,{x:r}=t,{shape:a}=n,i=k.sizeFromShape(r.shape),s=k.inferFromImplicitShape(a,i);return k.assert(i===k.sizeFromShape(s),()=>"new shape: ".concat(s,", old shape: ").concat(r.shape,". New shape and old shape must have the same number of elements.")),e.backend.incRef(r.dataId),{dataId:r.dataId,shape:s,dtype:r.dtype}}var WNe={kernelName:gh,backendName:"wasm",kernelFunc:Vr},lV;function UNe(e){lV=e.wasm.cwrap(_u,null,["number","array","number","number","array","number","number","number","number"])}function VNe(e){let{inputs:t,backend:n,attrs:r}=e,{a,b:i}=t,{transposeA:s,transposeB:o}=r;if(a.dtype!=="float32"||i.dtype!=="float32")throw new Error("BatchMatMul for non non-float32 tensors not yet supported.");let l=a.shape.length,c=i.shape.length,u=s?a.shape[l-2]:a.shape[l-1],d=o?i.shape[c-1]:i.shape[c-2],p=s?a.shape[l-1]:a.shape[l-2],h=o?i.shape[c-2]:i.shape[c-1],f=a.shape.slice(0,-2),m=i.shape.slice(0,-2),g=k.sizeFromShape(f),y=k.sizeFromShape(m),b=Fh.assertAndGetBroadcastShape(a.shape.slice(0,-2),i.shape.slice(0,-2)).concat([p,h]);k.assert(u===d,()=>"Error in matMul: inner shapes (".concat(u,") and (").concat(d,") of Tensors with shapes ").concat(a.shape," and ").concat(i.shape," and transposeA=").concat(s," and transposeB=").concat(o," must match."));let v=s?[g,u,p]:[g,p,u],x=o?[y,h,d]:[y,d,h],w=Vr({inputs:{x:a},backend:n,attrs:{shape:v}}),$=Vr({inputs:{x:i},backend:n,attrs:{shape:x}}),C=n.dataIdMap.get(w.dataId).id,E=n.dataIdMap.get($.dataId).id,_=s?w.shape[2]:w.shape[1],R=o?$.shape[1]:$.shape[2],N=Math.max(g,y),I=n.makeOutput([N,_,R],w.dtype),O=n.dataIdMap.get(I.dataId).id,P=new Uint8Array(new Int32Array(w.shape).buffer),L=new Uint8Array(new Int32Array($.shape).buffer);return lV(C,P,w.shape.length,E,L,$.shape.length,s,o,O),n.disposeData(w.dataId),n.disposeData($.dataId),I.shape=b,I}var HNe={kernelName:_u,backendName:"wasm",setupFunc:UNe,kernelFunc:VNe};function fu(e){let{inputs:{x:t},attrs:{begin:n,size:r},backend:a}=e,[i,s]=In.parseSliceParams(t,n,r),o=In.isSliceContinous(t.shape,i,s),l=a.readSync(t.dataId),c=a.makeOutput(s,t.dtype),u=k.computeStrides(t.shape),d=a.dataIdMap.get(c.dataId);if(o){let f=In.computeFlatOffset(i,u);return t.dtype==="string"?d.stringBytes=l.slice(f,f+k.sizeFromShape(s)):a.typedArrayFromHeap(c).set(l.subarray(f,f+k.sizeFromShape(s))),c}if(t.dtype==="string"){let f=zv(l,i,s,t.shape,t.dtype);return d.stringBytes=f,c}let p=a.typedArrayFromHeap(c),h=t.shape.length;if(h===2)jNe(l,u[0],p,i,s);else if(h===3)GNe(l,u[0],u[1],p,i,s);else if(h===4)qNe(l,u[0],u[1],u[2],p,i,s);else{let f=zv(l,i,s,t.shape,t.dtype);p.set(f)}return c}function jNe(e,t,n,r,a){let i=0,s=r[0],o=r[1],l=s+a[0];for(let c=s;c<l;c++){let u=c*t+o;n.set(e.subarray(u,u+a[1]),i),i+=a[1]}}function GNe(e,t,n,r,a,i){let s=0,o=a[0],l=a[1],c=a[2],u=o+i[0],d=l+i[1];for(let p=o;p<u;p++)for(let h=l;h<d;h++){let f=p*t+h*n+c;r.set(e.subarray(f,f+i[2]),s),s+=i[2]}}function qNe(e,t,n,r,a,i,s){let o=0,l=i[0],c=i[1],u=i[2],d=l+s[0],p=c+s[1],h=u+s[2],f=i[3];for(let m=l;m<d;m++)for(let g=c;g<p;g++)for(let y=u;y<h;y++){let b=m*t+g*n+y*r+f;a.set(e.subarray(b,b+s[3]),o),o+=s[3]}}var KNe={kernelName:Sh,backendName:"wasm",kernelFunc:fu};function XNe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:i,crops:s}=r,o=i.reduce((y,b)=>y*b),l=T.getReshaped(a.shape,i,o),c=T.getPermuted(l.length,i.length),u=T.getReshapedPermuted(a.shape,i,o),d=T.getSliceBeginCoords(s,i.length),p=T.getSliceSize(u,s,i.length),h=Vr({inputs:{x:a},backend:n,attrs:{shape:l}}),f=Bo({inputs:{x:h},backend:n,attrs:{perm:c}}),m=Vr({inputs:{x:f},backend:n,attrs:{shape:u}}),g=fu({inputs:{x:m},backend:n,attrs:{begin:d,size:p}});return n.disposeData(h.dataId),n.disposeData(f.dataId),n.disposeData(h.dataId),g}var YNe={kernelName:Pp,backendName:"wasm",kernelFunc:XNe},uV;function ZNe(e){uV=e.wasm.cwrap(zp,null,["number","number","boolean","number","number","number"])}function QNe(e){let{backend:t,inputs:n,attrs:r}=e,{x:a,weights:i}=n,{size:s}=r,o=i.shape.reduce((d,p)=>d*p,1)!==0,l=a.shape.length===1?[s]:[a.shape[0],s],c=t.makeOutput(l,i.dtype);function u(d){return t.dataIdMap.get(d.dataId).id}return uV(u(a),s,o,u(i),ut[i.dtype],u(c)),c}var JNe={kernelName:zp,backendName:"wasm",setupFunc:ZNe,kernelFunc:QNe},e_e=gn(Bp);function t_e(e){let{inputs:t,backend:n}=e,{s0:r,s1:a}=t,i=n.typedArrayFromHeap(r),s=n.typedArrayFromHeap(a),o=T.assertAndGetBroadcastShape(Array.from(i),Array.from(s));return n.makeOutput([o.length],"int32",void 0,new Int32Array(o))}var n_e={kernelName:ag,backendName:"wasm",kernelFunc:t_e};function al(e){let{inputs:{x:t},attrs:{dtype:n},backend:r}=e,a=r.makeOutput(t.shape,n),i=r.typedArrayFromHeap(t);return r.typedArrayFromHeap(a).set(i),a}var r_e={kernelName:Au,backendName:"wasm",kernelFunc:al},a_e=at(Ru),cV;function i_e(e){cV=e.wasm.cwrap(qo,null,["number","number","number","number"])}function s_e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{clipValueMin:i,clipValueMax:s}=r,o=n.dataIdMap.get(a.dataId).id,l=n.makeOutput(a.shape,a.dtype),c=n.dataIdMap.get(l.dataId).id;return cV(o,i,s,c),l}var o_e={kernelName:qo,backendName:"wasm",setupFunc:i_e,kernelFunc:s_e};function dV(e){let{inputs:t,backend:n}=e,r=k.parseAxisParam(e.attrs.axis,t[0].shape)[0],a=t.map(h=>h.shape);T.assertParamsConsistent(a,r);let i=T.computeOutShape(t.map(h=>h.shape),r),s=t.filter(h=>k.sizeFromShape(h.shape)>0);if(s.length===1)return mw({inputs:{x:s[0]},backend:n});let o=n.makeOutput(i,t[0].dtype);if(k.sizeFromShape(i)===0)return o;if(s[0].dtype==="string"){let h=s.map(v=>{let x=[-1,k.sizeFromShape(v.shape.slice(r))];return Vr({inputs:{x:v},backend:n,attrs:{shape:x}})}),f=h.map(v=>({vals:n.readSync(v.dataId),shape:v.shape}));i=T.computeOutShape(h.map(v=>v.shape),1);let m=h[0].shape[0]===1,g=G2(f,i,t[0].dtype,m),y=T.computeOutShape(s.map(v=>v.shape),r);o.shape=y;let b=n.dataIdMap.get(o.dataId);return b.stringBytes=T.fromStringArrayToUint8(g),h.forEach(v=>n.disposeData(v.dataId)),o}let l=k.sizeFromShape(s[0].shape.slice(0,r)),c=0,u=s.map(h=>{let f=k.sizeFromShape(h.shape.slice(r));return c+=f,f}),d=s.map(h=>n.typedArrayFromHeap(h)),p=n.typedArrayFromHeap(o);for(let h=0;h<l;h++){let f=h*c;for(let m=0;m<d.length;m++){let g=u[m],y=h*g,b=d[m].subarray(y,y+g);p.set(b,f),f+=g}}return o}var l_e={kernelName:Wp,backendName:"wasm",kernelFunc:dV},pV;function u_e(e){pV=e.wasm.cwrap(Du,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function c_e(e){let{inputs:t,attrs:n,backend:r}=e,{x:a,filter:i}=t,s=r.dataIdMap.get(a.dataId).id,o=r.dataIdMap.get(i.dataId).id,{strides:l,dilations:c,pad:u,dimRoundingMode:d,dataFormat:p}=n,h=T.convertConv2DDataFormat(p),f=T.computeConv2DInfo(a.shape,i.shape,l,c,u,d,!1,h),m=f.filterHeight,g=f.filterWidth,y=f.padInfo.top,b=f.padInfo.right,v=f.padInfo.bottom,x=f.padInfo.left,w=f.dilationHeight,$=f.dilationWidth,C=f.strideHeight,E=f.strideWidth,_=f.inChannels,R=f.outChannels,N=f.padInfo.type==="SAME"?1:0;if(f.dataFormat!=="channelsLast")throw new Error("wasm backend Conv2D does not support dataFormat:'".concat(f.dataFormat,"'. Please use 'channelsLast'."));let I=r.makeOutput(f.outShape,"float32"),O=r.dataIdMap.get(I.dataId).id;return pV(s,a.shape[0],a.shape[1],a.shape[2],o,m,g,y,b,v,x,N,w,$,C,E,_,R,O),I}var d_e={kernelName:Du,backendName:"wasm",setupFunc:u_e,kernelFunc:c_e},hV;function p_e(e){hV=e.wasm.cwrap(Fu,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function h_e(e){let{backend:t,inputs:n,attrs:r}=e,{dy:a,filter:i}=n,{strides:s,pad:o,dataFormat:l,dimRoundingMode:c,inputShape:u}=r,d=1,p=T.convertConv2DDataFormat(l),h=T.computeConv2DInfo(u,i.shape,s,d,o,c,!1,p),{batchSize:f,filterHeight:m,filterWidth:g,inChannels:y,inHeight:b,inWidth:v,outChannels:x,outHeight:w,outWidth:$,strideHeight:C,strideWidth:E}=h,_=m-1-h.padInfo.top,R=g-1-h.padInfo.left,N=h.dataFormat==="channelsLast",I=k.computeStrides(h.inShape),O=k.computeStrides(a.shape),[P,L,U]=k.computeStrides(i.shape),D=I[0],F=N?I[1]:I[2],z=N?I[2]:1,B=N?1:I[1],j=O[0],Y=N?O[1]:O[2],Q=N?O[2]:1,ae=N?1:O[1],se=t.makeOutput(h.inShape,"float32"),fe=t.dataIdMap.get(se.dataId).id,me=t.dataIdMap.get(a.dataId).id,he=t.dataIdMap.get(i.dataId).id;return hV(me,he,f,m,g,b,v,y,w,$,x,C,E,_,R,P,L,U,D,F,z,B,j,Y,Q,ae,fe),se}var f_e={kernelName:Fu,backendName:"wasm",setupFunc:p_e,kernelFunc:h_e},fV;function m_e(e){fV=e.wasm.cwrap(Mu,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function g_e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:s,pad:o,dilations:l}=r;if(a.dtype!=="float32")throw new Error("Tensor x must have dtype float32, got ".concat(a.dtype));if(i.dtype!=="float32")throw new Error("Tensor filter must have dtype float32, got ".concat(i.dtype));let c=T.computeConv3DInfo(a.shape,i.shape,s,l,o),u=n.makeOutput(c.outShape,a.dtype);return fV(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(u.dataId).id,c.batchSize,c.inDepth,c.inHeight,c.inWidth,c.inChannels,c.outDepth,c.outHeight,c.outWidth,c.outChannels,c.strideDepth,c.strideHeight,c.strideWidth,c.dilationDepth,c.dilationHeight,c.dilationWidth,c.filterDepth,c.filterHeight,c.filterWidth,c.padInfo.front,c.padInfo.top,c.padInfo.left),u}var y_e={kernelName:Mu,backendName:"wasm",setupFunc:m_e,kernelFunc:g_e},mV;function b_e(e){mV=e.wasm.cwrap(Up,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function v_e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,dy:i}=t,{strides:s,pad:o,filterShape:l}=r;if(a.dtype!=="float32")throw new Error("Tensor dy must have dtype float32, got ".concat(a.dtype));if(i.dtype!=="float32")throw new Error("Tensor filter must have dtype float32, got ".concat(i.dtype));let c=T.computeConv3DInfo(a.shape,l,s,1,o),u=n.makeOutput(c.filterShape,i.dtype);return mV(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(u.dataId).id,c.batchSize,c.inDepth,c.inHeight,c.inWidth,c.inChannels,c.outDepth,c.outHeight,c.outWidth,c.outChannels,c.strideDepth,c.strideHeight,c.strideWidth,c.dilationDepth,c.dilationHeight,c.dilationWidth,c.filterDepth,c.filterHeight,c.filterWidth,c.padInfo.front,c.padInfo.top,c.padInfo.left),u}var x_e={kernelName:Up,backendName:"wasm",setupFunc:b_e,kernelFunc:v_e},gV;function w_e(e){gV=e.wasm.cwrap(Vp,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function k_e(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:i}=t,{pad:s,strides:o,inputShape:l}=r;if(a.dtype!=="float32")throw new Error("Tensor dy must have dtype float32, got ".concat(a.dtype));if(i.dtype!=="float32")throw new Error("Tensor filter must have dtype float32, got ".concat(i.dtype));let c=T.computeConv3DInfo(l,i.shape,o,1,s),u=n.makeOutput(c.inShape,a.dtype);return gV(n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(u.dataId).id,c.batchSize,c.inDepth,c.inHeight,c.inWidth,c.inChannels,c.outDepth,c.outHeight,c.outWidth,c.outChannels,c.strideDepth,c.strideHeight,c.strideWidth,c.dilationDepth,c.dilationHeight,c.dilationWidth,c.filterDepth,c.filterHeight,c.filterWidth,c.padInfo.front,c.padInfo.top,c.padInfo.left),u}var S_e={kernelName:Vp,backendName:"wasm",setupFunc:w_e,kernelFunc:k_e},I_e=at(Ou),$_e=at(Lu),BS;(function(e){e[e.bilinear=0]="bilinear",e[e.nearest=1]="nearest"})(BS||(BS={}));var yV;function C_e(e){yV=e.wasm.cwrap(jp,null,["number","number","number","number","array","number","number","number","number","number"])}function E_e(e){let{backend:t,inputs:n,attrs:r}=e,{method:a,extrapolationValue:i,cropSize:s}=r,{image:o,boxes:l,boxInd:c}=n,u=l.shape[0],[d,p]=s,h=[u,d,p,o.shape[3]],f=t.dataIdMap.get(o.dataId),m;o.dtype!=="float32"&&(m=al({backend:t,inputs:{x:o},attrs:{dtype:"float32"}}),f=t.dataIdMap.get(m.dataId));let g=f.id,y=t.dataIdMap.get(l.dataId).id,b=t.dataIdMap.get(c.dataId).id,v=t.makeOutput(h,"float32"),x=t.dataIdMap.get(v.dataId).id,w=new Uint8Array(new Int32Array(o.shape).buffer);return yV(g,y,b,u,w,d,p,BS[a],i,x),m!=null&&t.disposeData(m.dataId),v}var T_e={kernelName:jp,backendName:"wasm",setupFunc:C_e,kernelFunc:E_e},bV;function N_e(e){bV=e.wasm.cwrap(Hp,null,["number","number","number","number","number","number"])}function __e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,exclusive:s,reverse:o}=r,l=a.shape.length;k.assert(a.dtype==="float32"||a.dtype==="int32",()=>"cumprod does not support ".concat(a.dtype," tensors in the WASM backend"));let c=T.getAxesPermutation([i],l),u=a;c!==null&&(u=Bo({inputs:{x:a},attrs:{perm:c},backend:n}));let d=T.getInnerMostAxes(1,l)[0];T.assertAxesAreInnerMostDims("cumprod",[d],l);let p=n.makeOutput(u.shape,u.dtype),h=u.shape[d],f=n.dataIdMap.get(u.dataId).id,m=n.dataIdMap.get(p.dataId).id;bV(f,s?1:0,o?1:0,h,m,ut[a.dtype]);let g=p;if(c!==null){let y=T.getUndoAxesPermutation(c);g=Bo({inputs:{x:p},attrs:{perm:y},backend:n}),n.disposeData(u.dataId),n.disposeData(p.dataId)}return g}var A_e={kernelName:Hp,backendName:"wasm",setupFunc:N_e,kernelFunc:__e},vV;function R_e(e){vV=e.wasm.cwrap(Pu,null,["number","number","number","number","number","number"])}function D_e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,exclusive:s,reverse:o}=r,l=a.shape.length;k.assert(a.dtype==="float32"||a.dtype==="int32",()=>"cumsum does not support ".concat(a.dtype," tensors in the WASM backend"));let c=T.getAxesPermutation([i],l),u=a;c!==null&&(u=Bo({inputs:{x:a},attrs:{perm:c},backend:n}));let d=T.getInnerMostAxes(1,l)[0];T.assertAxesAreInnerMostDims("cumsum",[d],l);let p=n.makeOutput(u.shape,u.dtype),h=u.shape[d],f=n.dataIdMap.get(u.dataId).id,m=n.dataIdMap.get(p.dataId).id;vV(f,s?1:0,o?1:0,h,m,ut[a.dtype]);let g=p;if(c!==null){let y=T.getUndoAxesPermutation(c);g=Bo({inputs:{x:p},attrs:{perm:y},backend:n}),n.disposeData(u.dataId),n.disposeData(p.dataId)}return g}var F_e={kernelName:Pu,backendName:"wasm",setupFunc:R_e,kernelFunc:D_e},xV;function M_e(e){xV=e.wasm.cwrap("DenseBincount",null,["number","array","number","number","boolean","number","number","boolean","number"])}function O_e(e){let{backend:t,inputs:n,attrs:r}=e,{x:a,weights:i}=n,{size:s,binaryOutput:o}=r,l=i.shape.reduce((p,h)=>p*h,1)!==0,c=a.shape.length===1?[s]:[a.shape[0],s],u=t.makeOutput(c,i.dtype);function d(p){return t.dataIdMap.get(p.dataId).id}return xV(d(a),new Uint8Array(new Int32Array(a.shape).buffer),a.shape.length,s,l,d(i),ut[i.dtype],o,d(u)),u}var L_e={kernelName:sg,backendName:"wasm",setupFunc:M_e,kernelFunc:O_e},wV;function P_e(e){wV=e.wasm.cwrap(Gp,null,["number","number","number","array","number","array","array","number","number"])}function z_e(e){let{backend:t,inputs:n,attrs:r}=e,{x:a}=n,{blockSize:i,dataFormat:s}=r,o=a.shape[0],l=s==="NHWC"?a.shape[1]:a.shape[2],c=s==="NHWC"?a.shape[2]:a.shape[3],u=s==="NHWC"?a.shape[3]:a.shape[1],d=l*i,p=c*i,h=u/(i*i),f=s==="NHWC"?[o,d,p,h]:[o,h,d,p],m=t.makeOutput(f,"float32"),g=t.dataIdMap.get(a.dataId).id,y=new Uint8Array(new Int32Array(k.computeStrides(a.shape)).buffer),b=new Uint8Array(new Int32Array(f).buffer),v=new Uint8Array(new Int32Array(k.computeStrides(f)).buffer),x=t.dataIdMap.get(m.dataId).id;return wV(g,i,s==="NHWC"?1:0,y,a.shape.length-1,b,v,f.length,x),m}var B_e={kernelName:Gp,backendName:"wasm",setupFunc:P_e,kernelFunc:z_e},kV;function W_e(e){kV=e.wasm.cwrap(zu,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function U_e(e){let{inputs:t,attrs:n,backend:r}=e,{x:a,filter:i}=t,s=r.dataIdMap.get(a.dataId).id,o=r.dataIdMap.get(i.dataId).id,{strides:l,dilations:c,pad:u,dimRoundingMode:d}=n,p=c==null?[1,1]:c,h=T.computeConv2DInfo(a.shape,i.shape,l,p,u,d,!0),f=h.filterHeight,m=h.filterWidth,g=h.padInfo.top,y=h.padInfo.right,b=h.padInfo.bottom,v=h.padInfo.left,x=h.dilationHeight,w=h.dilationWidth,$=h.strideHeight,C=h.strideWidth,E=h.inChannels,_=h.outChannels,R=h.padInfo.type==="SAME"?1:0;if(h.dataFormat!=="channelsLast")throw new Error("wasm backend DepthwiseConv2dNative does not support dataFormat:'".concat(h.dataFormat,"'. Please use 'channelsLast'."));let N=r.makeOutput(h.outShape,"float32"),I=r.dataIdMap.get(N.dataId).id;return kV(s,a.shape[0],a.shape[1],a.shape[2],o,f,m,g,y,b,v,R,x,w,$,C,E,_,I),N}var V_e={kernelName:zu,backendName:"wasm",setupFunc:W_e,kernelFunc:U_e},SV;function H_e(e){SV=e.wasm.cwrap("Diag",null,["number","number","number","number"])}function j_e(e){let{inputs:t,backend:n}=e,{x:r}=t,a=k.sizeFromShape(r.shape),i=n.makeOutput([...r.shape,...r.shape],r.dtype);return SV(n.dataIdMap.get(r.dataId).id,ut[r.dtype],a,n.dataIdMap.get(i.dataId).id),i}var G_e={kernelName:og,backendName:"wasm",setupFunc:H_e,kernelFunc:j_e},IV;function q_e(e){IV=e.wasm.cwrap(Bu,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function K_e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:s,pad:o,dilations:l}=r;if(a.dtype!==i.dtype)throw new Error("Dilation2D error: x must have the same dtype as filter. Got ".concat(a.dtype," and ").concat(i.dtype));let c=T.computeDilation2DInfo(a.shape,i.shape,s,o,"NHWC",l),u=n.makeOutput(c.outShape,a.dtype);return IV(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(u.dataId).id,ut[a.dtype],c.batchSize,c.inChannels,c.inHeight,c.inWidth,c.outHeight,c.outWidth,c.strideHeight,c.strideWidth,c.dilationHeight,c.dilationWidth,c.filterHeight,c.filterWidth,c.padInfo.top,c.padInfo.left),u}var X_e={kernelName:Bu,backendName:"wasm",setupFunc:q_e,kernelFunc:K_e},$V;function Y_e(e){$V=e.wasm.cwrap(ap,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function Z_e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i,dy:s}=t,{strides:o,pad:l,dilations:c}=r;if(a.dtype!==i.dtype||a.dtype!==s.dtype)throw new Error("Dilation2DBackpropFilter error: x must have the same dtype as filter and dy. Got ".concat(a.dtype,", ").concat(i.dtype,", and ").concat(s.dtype));let u=T.computeDilation2DInfo(a.shape,i.shape,o,l,"NHWC",c),d=n.makeOutput(i.shape,i.dtype);return $V(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(d.dataId).id,ut[a.dtype],u.batchSize,u.inChannels,u.inHeight,u.inWidth,u.outHeight,u.outWidth,u.strideHeight,u.strideWidth,u.dilationHeight,u.dilationWidth,u.filterHeight,u.filterWidth,u.padInfo.top,u.padInfo.left),d}var Q_e={kernelName:ap,backendName:"wasm",setupFunc:Y_e,kernelFunc:Z_e},CV;function J_e(e){CV=e.wasm.cwrap(rp,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function eAe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i,dy:s}=t,{strides:o,pad:l,dilations:c}=r;if(a.dtype!==i.dtype||a.dtype!==s.dtype)throw new Error("Dilation2DBackpropInput error: x must have the same dtype as filter and dy. Got ".concat(a.dtype,", ").concat(i.dtype,", and ").concat(s.dtype));let u=T.computeDilation2DInfo(a.shape,i.shape,o,l,"NHWC",c),d=n.makeOutput(a.shape,a.dtype);return CV(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(d.dataId).id,ut[a.dtype],u.batchSize,u.inChannels,u.inHeight,u.inWidth,u.outHeight,u.outWidth,u.strideHeight,u.strideWidth,u.dilationHeight,u.dilationWidth,u.filterHeight,u.filterWidth,u.padInfo.top,u.padInfo.left),d}var tAe={kernelName:rp,backendName:"wasm",setupFunc:J_e,kernelFunc:eAe},nAe=at(Uu),EV;function rAe(e){EV=e.wasm.cwrap(qp,null,["number","number","number"])}function aAe(e){let{inputs:t,backend:n}=e,{dy:r,y:a}=t,i=n.makeOutput(a.shape,"float32"),s=o=>n.dataIdMap.get(o.dataId).id;return EV(s(a),s(r),s(i)),i}var iAe={kernelName:qp,backendName:"wasm",setupFunc:rAe,kernelFunc:aAe},sAe=!1,oAe=gn(Kp,sAe,"bool"),lAe=at(Vu),uAe=at(Hu,"float32");function WS(e){let{inputs:t,attrs:n,backend:r}=e,{input:a}=t,{dim:i}=n,s=a.shape.length,o=a.shape.slice(),l=i;return i<0&&(k.assert(-(s+1)<=i,()=>"Axis must be in the interval [".concat(-(s+1),", ").concat(s,"]")),l=s+i+1),o.splice(l,0,1),Vr({inputs:{x:a},backend:r,attrs:{shape:o}})}var cAe={kernelName:Xp,backendName:"wasm",kernelFunc:WS},dAe=at(ju,"float32");function TV(e){let{attrs:{shape:t,value:n,dtype:r},backend:a}=e,i=a.makeOutput(t,r);return a.typedArrayFromHeap(i).fill(n),i}var pAe={kernelName:lg,backendName:"wasm",kernelFunc:TV},NV;function hAe(e){NV=e.wasm.cwrap(Yp,null,["number","number","number","number","number","number"])}function fAe(e){let{inputs:t,backend:n}=e,{image:r}=t,a=n.makeOutput(r.shape,r.dtype),i=n.dataIdMap.get(r.dataId).id,s=n.dataIdMap.get(a.dataId).id,[o,l,c,u]=r.shape;return NV(i,o,l,c,u,s),a}var mAe={kernelName:Yp,backendName:"wasm",kernelFunc:fAe,setupFunc:hAe},gAe=at(Gu),yAe=gn(qu),_V;function bAe(e){_V=e.wasm.cwrap(Ku,null,["number","number","number","number","number","number","number"])}function vAe(e){let{backend:t,inputs:n,attrs:r}=e,{varianceEpsilon:a}=r,{x:i,mean:s,variance:o,offset:l,scale:c}=n,u=t.dataIdMap.get(i.dataId).id,d=t.dataIdMap.get(s.dataId).id,p=t.dataIdMap.get(o.dataId).id,h=l!=null?t.dataIdMap.get(l.dataId).id:0,f=c!=null?t.dataIdMap.get(c.dataId).id:0,m=t.makeOutput(i.shape,i.dtype);if(k.sizeFromShape(i.shape)===0)return m;let g=t.dataIdMap.get(m.dataId).id;return _V(u,d,p,h,f,a,g),m}var xAe={kernelName:Ku,backendName:"wasm",setupFunc:bAe,kernelFunc:vAe},AV;function wAe(e){AV=e.wasm.cwrap(Zl,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function kAe(e){let{inputs:t,attrs:n,backend:r}=e,{x:a,filter:i,bias:s,preluActivationWeights:o}=t,{strides:l,pad:c,dilations:u,dataFormat:d,dimRoundingMode:p,activation:h,leakyreluAlpha:f}=n,m=T.computeConv2DInfo(a.shape,i.shape,l,u,c,p),g=Pm[h];if(g==null)throw new Error("".concat(h," activation not yet supported for FusedConv2D in the wasm backend."));let y=r.dataIdMap.get(a.dataId).id,b=r.dataIdMap.get(i.dataId).id,v=m.outChannels,x=0;if(s!=null){let Q=r.dataIdMap.get(s.dataId);if(Q.shape.length!==1)throw new Error("FusedConv2D only supports rank-1 bias but got rank ".concat(Q.shape.length,"."));if(Q.shape[0]!==v)throw new Error("FusedConv2D bias shape (".concat(Q.shape,") does not match the number of output channels (").concat(v,")"));x=Q.id}let w=m.filterHeight,$=m.filterWidth,C=m.padInfo.top,E=m.padInfo.right,_=m.padInfo.bottom,R=m.padInfo.left,N=m.dilationHeight,I=m.dilationWidth,O=m.strideHeight,P=m.strideWidth,L=m.inChannels,U=m.padInfo.type==="SAME"?1:0,D=m.batchSize,F=m.inHeight,z=m.inWidth;if(d!=="NHWC")throw new Error("wasm backend FusedConv2D does not support dataFormat:'".concat(d,"'. Please use 'NHWC'."));let B=r.makeOutput(m.outShape,"float32"),j=r.dataIdMap.get(B.dataId).id,Y=o==null?0:r.dataIdMap.get(o.dataId).id;return AV(y,D,F,z,b,w,$,x,C,E,_,R,U,N,I,O,P,L,v,g,Y,f||0,j),B}var SAe={kernelName:Zl,backendName:"wasm",setupFunc:wAe,kernelFunc:kAe},RV;function IAe(e){RV=e.wasm.cwrap(Ql,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function $Ae(e){let{inputs:t,attrs:n,backend:r}=e,{x:a,filter:i,bias:s,preluActivationWeights:o}=t,{strides:l,pad:c,dilations:u,dataFormat:d,dimRoundingMode:p,activation:h,leakyreluAlpha:f}=n,m=T.computeConv2DInfo(a.shape,i.shape,l,u,c,p,!0),g=Pm[h];if(g==null)throw new Error("".concat(h," activation not yet supported for FusedDepthwiseConv2D in the wasm backend."));let y=r.dataIdMap.get(a.dataId).id,b=r.dataIdMap.get(i.dataId).id,v=m.outChannels,x=0;if(s!=null){let Q=r.dataIdMap.get(s.dataId);if(Q.shape.length!==1)throw new Error("FusedDepthwiseConv2D only supports rank-1 bias but got rank ".concat(Q.shape.length,"."));if(Q.shape[0]!==v)throw new Error("FusedDepthwiseConv2D bias shape (".concat(Q.shape,") does not match the number of output channels (").concat(v,")"));x=Q.id}let w=m.filterHeight,$=m.filterWidth,C=m.padInfo.top,E=m.padInfo.right,_=m.padInfo.bottom,R=m.padInfo.left,N=m.dilationHeight,I=m.dilationWidth,O=m.strideHeight,P=m.strideWidth,L=m.inChannels,U=m.padInfo.type==="SAME"?1:0,D=m.batchSize,F=m.inHeight,z=m.inWidth;if(d!=="NHWC")throw new Error("wasm backend FusedDepthwiseConv2D does not support dataFormat:'".concat(d,"'. Please use 'NHWC'."));let B=r.makeOutput(m.outShape,"float32"),j=r.dataIdMap.get(B.dataId).id,Y=o==null?0:r.dataIdMap.get(o.dataId).id;return RV(y,D,F,z,b,w,$,x,C,E,_,R,U,N,I,O,P,L,v,g,Y,f||0,j),B}var CAe={kernelName:Ql,backendName:"wasm",setupFunc:IAe,kernelFunc:$Ae},DV;function EAe(e){DV=e.wasm.cwrap(Qp,null,["number","number","number","number","number","number","array","number"])}function TAe(e){let{backend:t,inputs:n}=e,{params:r,indices:a}=n,[i,s,o,l]=iE.prepareAndValidate(r,a),c=t.makeOutput(i,r.dtype);if(s===0)return c;let u=a.shape,d=u[u.length-1],p=t.dataIdMap.get(r.dataId).id,h=t.dataIdMap.get(a.dataId).id,f=new Uint8Array(new Int32Array(l).buffer),m=t.dataIdMap.get(c.dataId).id;return DV(p,ut[r.dtype],h,s,d,o,f,m),c}var NAe={kernelName:Qp,backendName:"wasm",setupFunc:EAe,kernelFunc:TAe},FV;function _Ae(e){FV=e.wasm.cwrap("Gather",null,["number","number","array","number","number","number","array","number"])}function AAe(e){let{backend:t,inputs:n,attrs:r}=e,{x:a,indices:i}=n,{axis:s,batchDims:o}=r,l=k.parseAxisParam(s,a.shape)[0],c=t.readSync(i.dataId),u=a.shape[l];for(let C=0;C<c.length;++C){let E=c[C];k.assert(E<=u-1&&E>=0,()=>"GatherV2: the index value ".concat(E," is not in [0, ").concat(u-1,"]"))}let d=T.segment_util.collectGatherOpShapeInfo(a,i,l,o),p=Vr({inputs:{x:a},attrs:{shape:[d.batchSize,d.outerSize,d.dimSize,d.sliceSize]},backend:t}),h=k.sizeFromShape(i.shape),f=Vr({inputs:{x:i},attrs:{shape:[d.batchSize,h/d.batchSize]},backend:t}),m=[d.batchSize,d.outerSize,h/d.batchSize,d.sliceSize],g=t.makeOutput(m,a.dtype);if(k.sizeFromShape(a.shape)===0)return g;let y=p.shape.length-1,b=t.dataIdMap.get(p.dataId).id,v=t.dataIdMap.get(f.dataId).id,x=t.dataIdMap.get(g.dataId).id,w=new Uint8Array(new Int32Array(k.computeStrides(p.shape)).buffer),$=new Uint8Array(new Int32Array(k.computeStrides(m)).buffer);return FV(b,ut[a.dtype],w,y,v,d.batchSize,$,x),t.disposeData(p.dataId),t.disposeData(f.dataId),g.shape=d.outputShape,g}var RAe={kernelName:Zp,backendName:"wasm",setupFunc:_Ae,kernelFunc:AAe},DAe=!1,FAe=gn(Jp,DAe,"bool"),MAe=!1,OAe=gn(Xu,MAe,"bool"),LAe=at(Zu,"bool"),PAe=at(Qu,"bool"),zAe=at(Ju,"bool"),MV;function BAe(e){MV=e.wasm.cwrap(ec,null,["number","number","number","number"])}function WAe(e){let{inputs:{x:t},attrs:{alpha:n},backend:r}=e,a=r.dataIdMap.get(t.dataId).id,i=r.makeOutput(t.shape,"float32");if(k.sizeFromShape(t.shape)!==0){let s=r.dataIdMap.get(i.dataId).id;MV(a,ut[t.dtype],n,s)}return i}var UAe={kernelName:ec,backendName:"wasm",setupFunc:BAe,kernelFunc:WAe},VAe=!1,HAe=gn(eh,VAe,"bool"),jAe=!1,GAe=gn(th,jAe,"bool"),OV;function qAe(e){OV=e.wasm.cwrap(nh,null,["number","number","number","number"])}function KAe(e){let{attrs:t,backend:n}=e,{start:r,stop:a,num:i}=t,s=Math.floor(i),o=n.makeOutput([s],"float32");return OV(n.dataIdMap.get(o.dataId).id,r,a,s),o}var XAe={kernelName:nh,backendName:"wasm",setupFunc:qAe,kernelFunc:KAe},YAe=at(tc),ZAe=at(nc),QAe=!1,JAe=gn(rh,QAe,"bool"),eRe=at(ah),tRe=!1,nRe=gn(ih,tRe,"bool"),rRe=!1,aRe=gn(nP,rRe,"bool"),LV;function iRe(e){LV=e.wasm.cwrap(rc,null,["number","number","number","number","number","number","number"])}function sRe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{depthRadius:i,bias:s,alpha:o,beta:l}=r;if(a.dtype!=="float32")throw new Error("LRN error: x must have dtype float32");let c=n.makeOutput(a.shape,a.dtype);return LV(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(c.dataId).id,a.shape[3],i,s,o,l),c}var oRe={kernelName:rc,backendName:"wasm",setupFunc:iRe,kernelFunc:sRe},PV;function lRe(e){PV=e.wasm.cwrap(sh,null,["number","number","number","number","number","number","number","number","number"])}function uRe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,y:i,dy:s}=t,{depthRadius:o,bias:l,alpha:c,beta:u}=r;if(a.dtype!=="float32"||i.dtype!=="float32"||s.dtype!=="float32")throw new Error("LRNGrad error: x, y, and dy must have dtype float32");let d=n.makeOutput(a.shape,a.dtype);return PV(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(d.dataId).id,s.shape[3],o,l,c,u),d}var cRe={kernelName:sh,backendName:"wasm",setupFunc:lRe,kernelFunc:uRe},zV;function dRe(e){zV=e.wasm.cwrap(ac,null,["number","number","number","number"])}function pRe(e){let{backend:t,inputs:n,attrs:r}=e,{reductionIndices:a,keepDims:i}=r,{x:s}=n,o=t.dataIdMap.get(s.dataId).id,l=s,{transposed:c,axes:u,originalAxes:d,inputWasTransposed:p}=rl(s,a,t);if(p){let b=t.dataIdMap.get(c.dataId).id;l=c,o=b}let h=l.shape.length;T.assertAxesAreInnerMostDims("max",u,h);let[f,m]=T.computeOutAndReduceShapes(l.shape,u),g=k.sizeFromShape(m),y=t.makeOutput(f,s.dtype);if(k.sizeFromShape(l.shape)!==0){let b=t.dataIdMap.get(y.dataId).id;zV(o,ut[s.dtype],g,b)}if(p&&t.disposeData(c.dataId),i){let b=T.expandShapeToKeepDim(y.shape,d);y.shape=b}return y}var hRe={kernelName:ac,backendName:"wasm",setupFunc:dRe,kernelFunc:pRe},fRe=gn(ic),BV;function mRe(e){BV=e.wasm.cwrap(sc,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function gRe(e){let{inputs:t,attrs:n,backend:r}=e,a=t.x,i=r.dataIdMap.get(a.dataId).id;k.assert(a.dtype==="float32",()=>"Error in MaxPool: only float32 input is supported. Got ".concat(a.dtype,"."));let{filterSize:s,strides:o,pad:l,dimRoundingMode:c}=n,u=T.computePool2DInfo(a.shape,s,o,1,l,c),d=u.filterHeight,p=u.filterWidth,h=u.padInfo.top,f=u.padInfo.right,m=u.padInfo.bottom,g=u.padInfo.left,y=u.dilationHeight,b=u.dilationWidth,v=u.strideHeight,x=u.strideWidth,w=u.inChannels,$=u.outChannels;if(u.dataFormat!=="channelsLast")throw new Error("wasm backend does not support dataFormat:'".concat(u.dataFormat,"'. Please use 'channelsLast'."));let C=r.makeOutput(u.outShape,"float32"),E=r.dataIdMap.get(C.dataId).id;return BV(i,a.shape[0],a.shape[1],a.shape[2],d,p,h,f,m,g,y,b,v,x,w,$,E),C}var yRe={kernelName:sc,backendName:"wasm",setupFunc:mRe,kernelFunc:gRe},WV;function bRe(e){WV=e.wasm.cwrap("MaxPool3D",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function vRe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:i,strides:s,pad:o,dimRoundingMode:l,dataFormat:c}=r,u=T.computePool3DInfo(a.shape,i,s,1,o,l,c),d=n.makeOutput(u.outShape,a.dtype);return WV(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(d.dataId).id,u.batchSize,u.inChannels,u.inDepth,u.inHeight,u.inWidth,u.outDepth,u.outHeight,u.outWidth,u.strideDepth,u.strideHeight,u.strideWidth,u.dilationDepth,u.dilationHeight,u.dilationWidth,u.effectiveFilterDepth,u.effectiveFilterHeight,u.effectiveFilterWidth,u.padInfo.front,u.padInfo.top,u.padInfo.left),d}var xRe={kernelName:oh,backendName:"wasm",setupFunc:bRe,kernelFunc:vRe},UV;function wRe(e){UV=e.wasm.cwrap("MaxPool3DGrad",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function kRe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,{filterSize:s,strides:o,pad:l,dimRoundingMode:c}=r,u=T.computePool3DInfo(i.shape,s,o,1,l,c),d=n.makeOutput(i.shape,i.dtype);return UV(n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(d.dataId).id,u.batchSize,u.inChannels,u.inDepth,u.inHeight,u.inWidth,u.outDepth,u.outHeight,u.outWidth,u.strideDepth,u.strideHeight,u.strideWidth,u.dilationDepth,u.dilationHeight,u.dilationWidth,u.effectiveFilterDepth,u.effectiveFilterHeight,u.effectiveFilterWidth,u.padInfo.front,u.padInfo.top,u.padInfo.left),d}var SRe={kernelName:cg,backendName:"wasm",setupFunc:wRe,kernelFunc:kRe},VV;function IRe(e){VV=e.wasm.cwrap("MaxPoolGrad",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function $Re(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,{filterSize:s,strides:o,pad:l,dimRoundingMode:c}=r,u=T.computePool2DInfo(i.shape,s,o,1,l,c),d=n.makeOutput(i.shape,i.dtype);return VV(n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(d.dataId).id,u.batchSize,u.inChannels,u.inHeight,u.inWidth,u.outHeight,u.outWidth,u.strideHeight,u.strideWidth,u.dilationHeight,u.dilationWidth,u.effectiveFilterHeight,u.effectiveFilterWidth,u.padInfo.top,u.padInfo.left),d}var CRe={kernelName:ug,backendName:"wasm",setupFunc:IRe,kernelFunc:$Re},HV;function ERe(e){HV=e.wasm.cwrap("MaxPoolWithArgmax",null,["number","number","number","number","boolean","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function TRe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:i,strides:s,pad:o,includeBatchInIndex:l}=r;k.assert(a.shape.length===4,()=>"Error in maxPool: input must be rank 4 but got rank ".concat(a.shape.length,"."));let c=[1,1];k.assert(T.eitherStridesOrDilationsAreOne(s,c),()=>"Error in maxPool: Either strides or dilations must be 1. Got strides ".concat(s," and dilations '").concat(c,"'"));let u=T.computePool2DInfo(a.shape,i,s,[1,1],o),d=n.makeOutput(u.outShape,a.dtype),p=n.makeOutput(u.outShape,"int32");return HV(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(d.dataId).id,n.dataIdMap.get(p.dataId).id,ut[a.dtype],l,u.batchSize,u.inChannels,u.inHeight,u.inWidth,u.outHeight,u.outWidth,u.strideHeight,u.strideWidth,u.dilationHeight,u.dilationWidth,u.effectiveFilterHeight,u.effectiveFilterWidth,u.padInfo.top,u.padInfo.left),[d,p]}var NRe={kernelName:dg,backendName:"wasm",setupFunc:ERe,kernelFunc:TRe},jV;function _Re(e){jV=e.wasm.cwrap(oc,null,["number, number, number"])}function ARe(e){let{backend:t,inputs:n,attrs:r}=e,{axis:a,keepDims:i}=r,{x:s}=n,o=t.dataIdMap.get(s.dataId).id,l=o,c=s,{transposed:u,axes:d,originalAxes:p,inputWasTransposed:h}=rl(s,a,t),f=d;if(h){let x=t.dataIdMap.get(u.dataId).id;x!==o&&(c=u,l=x,f=T.getInnerMostAxes(f.length,c.shape.length))}T.assertAxesAreInnerMostDims("mean",f,c.shape.length);let[m,g]=T.computeOutAndReduceShapes(c.shape,f),y=k.sizeFromShape(g),b=c;c.dtype!=="float32"&&(b=al({backend:t,inputs:{x:c},attrs:{dtype:"float32"}}),l=t.dataIdMap.get(b.dataId).id);let v=t.makeOutput(m,"float32");if(k.sizeFromShape(c.shape)!==0){let x=t.dataIdMap.get(v.dataId).id;jV(l,y,x)}if(h&&t.disposeData(u.dataId),i){let x=T.expandShapeToKeepDim(v.shape,p);v.shape=x}return c.dtype!=="float32"&&t.disposeData(b.dataId),v}var RRe={kernelName:oc,backendName:"wasm",setupFunc:_Re,kernelFunc:ARe},GV;function DRe(e){GV=e.wasm.cwrap(lc,null,["number","number","number","number"])}function FRe(e){let{backend:t,inputs:n,attrs:r}=e,{axis:a,keepDims:i}=r,{x:s}=n,o=t.dataIdMap.get(s.dataId).id,l=o,c=s,{transposed:u,axes:d,originalAxes:p,inputWasTransposed:h}=rl(s,a,t);if(h){let v=t.dataIdMap.get(u.dataId).id;v!==o&&(c=u,l=v)}let f=c.shape.length;T.assertAxesAreInnerMostDims("min",d,f);let[m,g]=T.computeOutAndReduceShapes(c.shape,d),y=k.sizeFromShape(g),b=t.makeOutput(m,c.dtype);if(k.sizeFromShape(c.shape)!==0){let v=t.dataIdMap.get(b.dataId).id;GV(l,ut[s.dtype],y,v)}if(h&&t.disposeData(u.dataId),i){let v=T.expandShapeToKeepDim(b.shape,p);b.shape=v}return b}var MRe={kernelName:lc,backendName:"wasm",setupFunc:DRe,kernelFunc:FRe},ORe=gn(uc),US;(function(e){e[e.reflect=0]="reflect",e[e.symmetric=1]="symmetric"})(US||(US={}));var qV;function LRe(e){qV=e.wasm.cwrap(cc,null,["number","array","number","number","array","array","number","number"])}function PRe(e){let{inputs:{x:t},backend:n,attrs:{paddings:r,mode:a}}=e,i=r.map((f,m)=>f[0]+t.shape[m]+f[1]),s=n.dataIdMap.get(t.dataId).id,o=n.makeOutput(i,t.dtype),l=n.dataIdMap.get(o.dataId).id,c=new Uint8Array(new Int32Array(t.shape).buffer),u=r.map(f=>f[0]),d=r.map(f=>f[1]),p=new Uint8Array(new Int32Array(u).buffer),h=new Uint8Array(new Int32Array(d).buffer);return qV(s,c,t.shape.length,ut[t.dtype],p,h,US[a],l),o}var zRe={kernelName:cc,backendName:"wasm",kernelFunc:PRe,setupFunc:LRe},KV;function BRe(e){KV=e.wasm.cwrap(Fc,null,["number","number","number","number"])}function XV(e){let{backend:t,inputs:{logits:n},attrs:{dim:r}}=e,a=t.dataIdMap.get(n.dataId).id,i=t.makeOutput(n.shape,n.dtype),s=t.dataIdMap.get(i.dataId).id,o=n.shape[r],l=k.sizeFromShape(n.shape)/o;return k.sizeFromShape(i.shape)===0||KV(a,s,o,l),i}var WRe={kernelName:Fc,backendName:"wasm",setupFunc:BRe,kernelFunc:XV},YV;function URe(e){YV=e.wasm.cwrap(lh,null,["number","number","number","number","number","number"])}function VRe(e){let{inputs:t,backend:n,attrs:r}=e,{logits:a}=t,{numSamples:i,seed:s,normalized:o}=r;if(a.dtype!=="float32")throw new Error("Tensor logits must have dtype float32, got ".concat(a.dtype));let l=o?a:XV({inputs:{logits:a},backend:n,attrs:{dim:a.shape.length-1}}),[c,u]=l.shape,d=n.makeOutput([c,i],"int32");return YV(n.dataIdMap.get(l.dataId).id,c,u,i,s,n.dataIdMap.get(d.dataId).id),o||n.disposeData(l.dataId),d}var HRe={kernelName:lh,backendName:"wasm",setupFunc:URe,kernelFunc:VRe},jRe=gn(dc),GRe=gn(pc),qRe=at(uh);function xT(e,t){let n=new Int32Array(e.wasm.HEAPU8.buffer,t,4),r=n[0],a=n[1],i=n[2],s=n[3];return e.wasm._free(t),{pSelectedIndices:r,selectedSize:a,pSelectedScores:i,pValidOutputs:s}}var ZV;function KRe(e){ZV=e.wasm.cwrap(dh,"number",["number","number","number","number","number"])}function XRe(e){let{backend:t,inputs:n,attrs:r}=e,{iouThreshold:a,maxOutputSize:i,scoreThreshold:s}=r,{boxes:o,scores:l}=n,c=t.dataIdMap.get(o.dataId).id,u=t.dataIdMap.get(l.dataId).id,d=ZV(c,u,i,a,s),{pSelectedIndices:p,selectedSize:h,pSelectedScores:f,pValidOutputs:m}=xT(t,d);return t.wasm._free(f),t.wasm._free(m),t.makeOutput([h],"int32",p)}var YRe={kernelName:dh,backendName:"wasm",setupFunc:KRe,kernelFunc:XRe},QV;function ZRe(e){QV=e.wasm.cwrap(ph,"number",["number","number","number","number","number","bool"])}function QRe(e){let{backend:t,inputs:n,attrs:r}=e,{iouThreshold:a,maxOutputSize:i,scoreThreshold:s,padToMaxOutputSize:o}=r,{boxes:l,scores:c}=n,u=t.dataIdMap.get(l.dataId).id,d=t.dataIdMap.get(c.dataId).id,p=QV(u,d,i,a,s,o),{pSelectedIndices:h,selectedSize:f,pSelectedScores:m,pValidOutputs:g}=xT(t,p);t.wasm._free(m);let y=t.makeOutput([f],"int32",h),b=t.makeOutput([],"int32",g);return[y,b]}var JRe={kernelName:ph,backendName:"wasm",setupFunc:ZRe,kernelFunc:QRe},JV;function eDe(e){JV=e.wasm.cwrap(hh,"number",["number","number","number","number","number","number"])}function tDe(e){let{backend:t,inputs:n,attrs:r}=e,{iouThreshold:a,maxOutputSize:i,scoreThreshold:s,softNmsSigma:o}=r,{boxes:l,scores:c}=n,u=t.dataIdMap.get(l.dataId).id,d=t.dataIdMap.get(c.dataId).id,p=JV(u,d,i,a,s,o),{pSelectedIndices:h,selectedSize:f,pSelectedScores:m,pValidOutputs:g}=xT(t,p);t.wasm._free(g);let y=t.makeOutput([f],"int32",h),b=t.makeOutput([f],"float32",m);return[y,b]}var nDe={kernelName:hh,backendName:"wasm",setupFunc:eDe,kernelFunc:tDe},rDe=!1,aDe=gn(ch,rDe,"bool"),eH;function iDe(e){eH=e.wasm.cwrap(hc,null,["number","number","number","number","number"])}function sDe(e){let{inputs:t,backend:n,attrs:r}=e,{indices:a}=t,{dtype:i,depth:s,onValue:o,offValue:l}=r,c=n.makeOutput([...a.shape,s],i),u=n.dataIdMap.get(c.dataId).id,d=n.dataIdMap.get(a.dataId).id;return eH(d,s,o,l,u),c}var oDe={kernelName:hc,backendName:"wasm",setupFunc:iDe,kernelFunc:sDe};function lDe(e){let{inputs:{x:t},backend:n}=e,r=n.makeOutput(t.shape,t.dtype);return n.typedArrayFromHeap(r).fill(1),r}var uDe={kernelName:fh,backendName:"wasm",kernelFunc:lDe};function cDe(e){let{inputs:t,backend:n,attrs:r}=e,{axis:a}=r;if(t.length===1)return WS({inputs:{input:t[0]},backend:n,attrs:{dim:a}});let i=t[0].shape,s=t[0].dtype;t.forEach(u=>{k.assertShapesMatch(i,u.shape,"All tensors passed to stack must have matching shapes"),k.assert(s===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});let o=[],l=t.map(u=>{let d=WS({inputs:{input:u},backend:n,attrs:{dim:a}});return o.push(d),d}),c=dV({inputs:l,backend:n,attrs:{axis:a}});return o.forEach(u=>n.disposeData(u.dataId)),c}var dDe={kernelName:mh,backendName:"wasm",kernelFunc:cDe},tH;function pDe(e){tH=e.wasm.cwrap(fc,null,["number","array","number","number","array","array","number","number"])}function hDe(e){let{inputs:{x:t},backend:n,attrs:{paddings:r,constantValue:a}}=e,i=r.map((f,m)=>f[0]+t.shape[m]+f[1]);if(k.sizeFromShape(t.shape)===0)return TV({backend:n,attrs:{shape:i,value:a,dtype:t.dtype}});let s=n.dataIdMap.get(t.dataId).id,o=n.makeOutput(i,t.dtype),l=n.dataIdMap.get(o.dataId).id,c=new Uint8Array(new Int32Array(t.shape).buffer),u=r.map(f=>f[0]),d=r.map(f=>f[1]),p=new Uint8Array(new Int32Array(u).buffer),h=new Uint8Array(new Int32Array(d).buffer);return tH(s,c,t.shape.length,ut[t.dtype],p,h,a,l),o}var nH={kernelName:fc,backendName:"wasm",kernelFunc:hDe,setupFunc:pDe},fDe=gn(mc),rH;function mDe(e){rH=e.wasm.cwrap(gc,null,["number","number","number"])}function gDe(e){let{inputs:t,backend:n}=e,{x:r,alpha:a}=t,i=n.dataIdMap.get(r.dataId).id,s=n.dataIdMap.get(a.dataId).id,o=i,l=r,c=l;l.dtype!=="float32"&&(c=al({backend:n,inputs:{x:r},attrs:{dtype:"float32"}}),o=n.dataIdMap.get(c.dataId).id);let u=n.makeOutput(r.shape,"float32"),d=n.dataIdMap.get(u.dataId).id;return rH(o,s,d),l.dtype!=="float32"&&n.disposeData(c.dataId),u}var yDe={kernelName:gc,backendName:"wasm",setupFunc:mDe,kernelFunc:gDe},aH;function bDe(e){aH=e.wasm.cwrap(yc,null,["number","number","number","number"])}function vDe(e){let{backend:t,inputs:n,attrs:r}=e,{axis:a,keepDims:i}=r,{x:s}=n,o=t.dataIdMap.get(s.dataId).id,l=o,c=s,{transposed:u,axes:d,originalAxes:p,inputWasTransposed:h}=rl(s,a,t),f=d;if(h){let v=t.dataIdMap.get(u.dataId).id;v!==o&&(c=u,l=v,f=T.getInnerMostAxes(f.length,c.shape.length))}T.assertAxesAreInnerMostDims("prod",f,c.shape.length);let[m,g]=T.computeOutAndReduceShapes(c.shape,f),y=k.sizeFromShape(g),b=t.makeOutput(m,c.dtype);if(k.sizeFromShape(c.shape)!==0){let v=t.dataIdMap.get(b.dataId).id;aH(l,y,ut[b.dtype],v)}if(h&&t.disposeData(u.dataId),i){let v=T.expandShapeToKeepDim(b.shape,p);b.shape=v}return b}var xDe={kernelName:yc,backendName:"wasm",setupFunc:bDe,kernelFunc:vDe},wDe=e=>{let{backend:t,attrs:n}=e,{start:r,stop:a,step:i,dtype:s}=n,o=X2(r,a,i,s),l=t.makeOutput([o.length],s);return t.typedArrayFromHeap(l).set(o),l},kDe={kernelName:pg,backendName:"wasm",kernelFunc:wDe},SDe=gn(Wu),IDe=at(bc),$De=at(vc),CDe=at(kc),iH;function EDe(e){iH=e.wasm.cwrap(wc,null,["number","number","number","number","number","number","number","number","number","number"])}function TDe(e){let{backend:t,inputs:n,attrs:r}=e,{images:a}=n,{alignCorners:i,halfPixelCenters:s,size:o}=r,[l,c]=o,[u,d,p,h]=a.shape,f=[u,l,c,h],m=t.dataIdMap.get(a.dataId),g;m.dtype!=="float32"&&(g=al({backend:t,inputs:{x:a},attrs:{dtype:"float32"}}),m=t.dataIdMap.get(g.dataId));let y=m.id,b=t.makeOutput(f,"float32");if(k.sizeFromShape(a.shape)===0)return b;let v=t.dataIdMap.get(b.dataId).id;return iH(y,u,d,p,h,l,c,i?1:0,s?1:0,v),g!=null&&t.disposeData(g.dataId),b}var NDe={kernelName:wc,backendName:"wasm",setupFunc:EDe,kernelFunc:TDe},sH;function _De(e){sH=e.wasm.cwrap(bh,null,["number","number","number","array","array","boolean"])}function ADe(e){let{inputs:t,backend:n,attrs:r}=e,{images:a,dy:i}=t,{alignCorners:s}=r,o=n.makeOutput(a.shape,"float32"),l=n.dataIdMap.get(a.dataId),c;return l.dtype!=="float32"&&(c=al({backend:n,inputs:{x:a},attrs:{dtype:"float32"}}),l=n.dataIdMap.get(c.dataId)),sH(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(o.dataId).id,new Uint8Array(new Int32Array(a.shape).buffer),new Uint8Array(new Int32Array(i.shape).buffer),s),c!=null&&n.disposeData(c.dataId),o}var RDe={kernelName:bh,backendName:"wasm",setupFunc:_De,kernelFunc:ADe},oH;function DDe(e){oH=e.wasm.cwrap(xc,null,["number","number","number","number","number","number","number","number","number","number"])}function FDe(e){let{backend:t,inputs:n,attrs:r}=e,{images:a}=n,{alignCorners:i,halfPixelCenters:s,size:o}=r,[l,c]=o,[u,d,p,h]=a.shape,f=[u,l,c,h],m=t.makeOutput(f,"float32");if(k.sizeFromShape(a.shape)===0)return m;let g=t.dataIdMap.get(a.dataId),y;g.dtype!=="float32"&&(y=al({backend:t,inputs:{x:a},attrs:{dtype:"float32"}}),g=t.dataIdMap.get(y.dataId));let b=g.id,v=t.dataIdMap.get(m.dataId).id;return oH(b,u,d,p,h,l,c,i?1:0,s?1:0,v),y!=null&&t.disposeData(y.dataId),m}var MDe={kernelName:xc,backendName:"wasm",setupFunc:DDe,kernelFunc:FDe},lH;function ODe(e){lH=e.wasm.cwrap(yh,null,["number","number","number","array","array","boolean"])}function LDe(e){let{inputs:t,backend:n,attrs:r}=e,{images:a,dy:i}=t,{alignCorners:s}=r,o=n.makeOutput(a.shape,"float32"),l=n.dataIdMap.get(a.dataId),c;return l.dtype!=="float32"&&(c=al({backend:n,inputs:{x:a},attrs:{dtype:"float32"}}),l=n.dataIdMap.get(c.dataId)),lH(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(o.dataId).id,new Uint8Array(new Int32Array(a.shape).buffer),new Uint8Array(new Int32Array(i.shape).buffer),s),c!=null&&n.disposeData(c.dataId),o}var PDe={kernelName:yh,backendName:"wasm",setupFunc:ODe,kernelFunc:LDe},uH;function zDe(e){uH=e.wasm.cwrap(Sc,null,["number","array","number","array","number","number"])}function BDe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{dims:i}=r,s=k.parseAxisParam(i,a.shape);if(a.shape.length===0)return mw({inputs:{x:a},backend:n});let o=n.makeOutput(a.shape,a.dtype),l=n.dataIdMap.get(a.dataId).id,c=n.dataIdMap.get(o.dataId).id,u=new Uint8Array(new Int32Array(s).buffer),d=new Uint8Array(new Int32Array(a.shape).buffer);uH(l,u,s.length,d,a.shape.length,c);let p=Vr({inputs:{x:o},attrs:{shape:a.shape},backend:n});return n.disposeData(o.dataId),p}var WDe={kernelName:Sc,backendName:"wasm",kernelFunc:BDe,setupFunc:zDe},cH;function UDe(e){cH=e.wasm.cwrap(Dh,null,["number","number","number","number","number","number","number","number","array","number","number"])}function VDe(e){let{inputs:t,backend:n,attrs:r}=e,{image:a}=t,{radians:i,fillValue:s,center:o}=r,l=n.makeOutput(a.shape,a.dtype),c=n.dataIdMap.get(a.dataId).id,u=n.dataIdMap.get(l.dataId).id,[d,p,h,f]=a.shape,[m,g]=T.getImageCenter(o,p,h),y=s===0,b=255,v=typeof s=="number"?[s,s,s,y?0:b]:[...s,b],x=new Uint8Array(new Int32Array(v).buffer);return cH(c,d,p,h,f,i,m,g,x,v.length,u),l}var HDe={kernelName:Dh,backendName:"wasm",kernelFunc:VDe,setupFunc:UDe},jDe=at(Ic),GDe=at($c),dH;function qDe(e){dH=e.wasm.cwrap(vh,null,["number","number","number","number","number","number","array","number","number"])}function KDe(e){let{backend:t,inputs:n,attrs:r}=e,{indices:a,updates:i}=n,{shape:s}=r,o=t.makeOutput(s,i.dtype);if(k.sizeFromShape(s)===0)return o;let{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:p}=Dx.calculateShapes(i,a,s),h=t.dataIdMap.get(a.dataId).id,f=t.dataIdMap.get(i.dataId).id,m=new Uint8Array(new Int32Array(d).buffer),g=t.dataIdMap.get(o.dataId).id;return dH(h,f,ut[i.dtype],l,c,u,m,p,g),o}var XDe={kernelName:vh,backendName:"wasm",setupFunc:qDe,kernelFunc:KDe},pH;function YDe(e){pH=e.wasm.cwrap(wh,null,["number","number","number","number","number","number","bool","number"])}function ZDe(e){let{inputs:t,backend:n,attrs:r}=e,{sortedSequence:a,values:i}=t,{side:s}=r;if(a.dtype!==i.dtype)throw new Error("SearchSorted error: sorted_sequence must have the same dtype as values. Got ".concat(a.dtype," and ").concat(i.dtype));let o=n.makeOutput(i.shape,"int32");function l(c){return n.dataIdMap.get(c.dataId).id}return pH(l(a),l(i),a.shape[0],a.shape[1],i.shape[1],ut[a.dtype],s==="left",l(o)),o}var QDe={kernelName:wh,backendName:"wasm",setupFunc:YDe,kernelFunc:ZDe},hH;function JDe(e){hH=e.wasm.cwrap("SelectV2",null,["number","number","number","number","number"])}function eFe(e){let{inputs:t,backend:n}=e,{condition:r,t:a,e:i}=t,s=n.dataIdMap.get(r.dataId).id,o=n.dataIdMap.get(a.dataId).id,l=n.dataIdMap.get(i.dataId).id,c=n.makeOutput(a.shape,a.dtype),u=n.dataIdMap.get(c.dataId).id,d=r.shape.length,p=a.shape.length,h=d===0||d>1||p===1?1:k.sizeFromShape(a.shape.slice(1));return hH(s,o,l,h,u),c}var tFe={kernelName:kh,backendName:"wasm",kernelFunc:eFe,setupFunc:JDe},nFe=at(Cc),fH;function rFe(e){fH=e.wasm.cwrap(_c,null,["number","number"])}function aFe(e){let{backend:t,inputs:{x:n}}=e,r=t.dataIdMap.get(n.dataId).id,a=t.makeOutput(n.shape,n.dtype),i=t.dataIdMap.get(a.dataId).id;return k.sizeFromShape(a.shape)===0||fH(r,i),a}var iFe={kernelName:"Sigmoid",backendName:"wasm",setupFunc:rFe,kernelFunc:aFe},sFe=at(Nc),oFe=at(Ec),lFe=at(Tc),uFe=at(Ac);function cFe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:i,paddings:s}=r,o=k.sizeFromShape(i),l=[[0,0]];l.push(...s);for(let g=1+i.length;g<a.shape.length;++g)l.push([0,0]);let c=nH.kernelFunc({inputs:{x:a},backend:n,attrs:{paddings:l,constantValue:0}}),u=T.getReshaped(c.shape,i,o,!1),d=T.getPermuted(u.length,i.length,!1),p=T.getReshapedPermuted(c.shape,i,o,!1),h=Vr({inputs:{x:c},backend:n,attrs:{shape:u}}),f=Bo({inputs:{x:h},backend:n,attrs:{perm:d}}),m=Vr({inputs:{x:f},backend:n,attrs:{shape:p}});return n.disposeData(c.dataId),n.disposeData(h.dataId),n.disposeData(f.dataId),m}var dFe={kernelName:Ih,backendName:"wasm",kernelFunc:cFe},mH;function pFe(e){mH=e.wasm.cwrap("SparseFillEmptyRows","number",["number","number","number","number","number","number","number","number","number","number","number","number"])}function hFe(e){let{backend:t,inputs:n}=e,{indices:r,values:a,denseShape:i,defaultValue:s}=n,o=r.shape[0],l=r.shape[1],c=t.readSync(i.dataId)[0],u=[o+c,l],d=t.dataIdMap.get(r.dataId).id,p=t.dataIdMap.get(a.dataId).id,h=t.dataIdMap.get(s.dataId).id,f=t.makeOutput(u,r.dtype),m=t.dataIdMap.get(f.dataId).id,g=t.makeOutput(u.slice(0,1),a.dtype),y=t.dataIdMap.get(g.dataId).id,b=t.makeOutput([c],"bool"),v=t.dataIdMap.get(b.dataId).id,x=t.makeOutput([o],r.dtype),w=t.dataIdMap.get(x.dataId).id,$=t.makeOutput([4],"int32"),C=t.dataIdMap.get($.dataId).id,E=mH(d,p,ut[a.dtype],o,c,l,h,m,y,v,w,C),_=t.readSync($.dataId),R;switch(_[0]){case 1:{R=T.getSparseFillEmptyRowsIndicesDenseShapeMismatch(_[1]);break}case 2:{R=T.getSparseFillEmptyRowsNegativeIndexErrorMessage(_[1],_[2]);break}case 3:R=T.getSparseFillEmptyRowsOutOfRangeIndexErrorMessage(_[1],_[2],_[3]);break;default:R=""}if(t.disposeData($.dataId),R)throw t.disposeData(f.dataId),t.disposeData(g.dataId),t.disposeData(b.dataId),t.disposeData(x.dataId),new Error(R);let N=f,I=g;return E!==u[0]&&(N=fu({inputs:{x:f},attrs:{begin:0,size:[E,l]},backend:t}),I=fu({inputs:{x:g},attrs:{begin:0,size:E},backend:t}),t.disposeData(f.dataId),t.disposeData(g.dataId)),[N,I,b,x]}var fFe={kernelName:hg,backendName:"wasm",setupFunc:pFe,kernelFunc:hFe},gH;function mFe(e){gH=e.wasm.cwrap(Ch,null,["number","number","number","number","number","number","number"])}function gFe(e){let{backend:t,inputs:n}=e,{inputIndices:r,inputShape:a,newShape:i}=n;if(r.shape.length!==2)throw new Error("Input indices should be a matrix but received shape\n        ".concat(r.shape));if(a.shape.length!==1)throw new Error("Input shape should be a vector but received shape\n        ".concat(a.shape));if(i.shape.length!==1)throw new Error("Target shape should be a vector but received shape ".concat(i.shape));let s=t.dataIdMap.get(r.dataId).id,o=t.dataIdMap.get(a.dataId).id,l=t.dataIdMap.get(i.dataId).id,c=r.shape[0],u=k.sizeFromShape(i.shape),d=t.makeOutput([c,u],r.dtype),p=t.dataIdMap.get(d.dataId).id,h=t.makeOutput([u],i.dtype),f=t.dataIdMap.get(h.dataId).id,m=t.makeOutput([3],"int32"),g=t.dataIdMap.get(m.dataId).id;gH(s,o,l,c,p,f,g);let y=t.readSync(m.dataId),b;switch(y[0]){case 0:{b=T.getSparseReshapeMultipleNegativeOneOutputDimErrorMessage(y[1],y[2]);break}case 1:{b=T.getSparseReshapeNegativeOutputDimErrorMessage(y[1],y[2]);break}case 2:b=T.getSparseReshapeEmptyTensorZeroOutputDimErrorMessage();break;case 3:{let v=Array.from(t.readSync(a.dataId)),x=Array.from(t.readSync(h.dataId));b=T.getSparseReshapeInputOutputMultipleErrorMessage(v,x);break}case 4:{let v=Array.from(t.readSync(a.dataId)),x=Array.from(t.readSync(h.dataId));b=T.getSparseReshapeInputOutputMismatchErrorMessage(v,x);break}default:b=""}if(t.disposeData(m.dataId),b)throw t.disposeData(d.dataId),t.disposeData(h.dataId),new Error(b);return[d,h]}var yFe={kernelName:Ch,backendName:"wasm",setupFunc:mFe,kernelFunc:gFe},yH;function bH(e){yH=e.wasm.cwrap("SparseSegmentReduction",null,["number","number","number","number","number","number","number","number","number"])}function vH(e,t){let{backend:n,inputs:r}=e,{data:a,indices:i,segmentIds:s}=r,o=i.shape[0],l=n.readSync(s.dataId,o-1,o)[0],c=o>0?l+1:0;if(c<0)throw new Error(T.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let u=a.shape.slice();u[0]=c;let d=n.dataIdMap.get(a.dataId).id,p=n.dataIdMap.get(i.dataId).id,h=n.dataIdMap.get(s.dataId).id,f=n.makeOutput(u,a.dtype),m=n.dataIdMap.get(f.dataId).id,g=n.makeOutput([4],"int32"),y=n.dataIdMap.get(g.dataId).id;yH(d,ut[a.dtype],a.shape[0],p,h,m,y,t,0);let b=n.readSync(g.dataId),v;switch(b[0]){case 0:{v=T.getSparseSegmentReductionNegativeSegmentIdsErrorMessage();break}case 1:{v=T.getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage();break}case 2:v=T.getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage(b[1],b[2]);break;case 3:v=T.getSparseSegmentReductionIndicesOutOfRangeErrorMessage(b[1],b[2],b[3]);break;default:v=""}if(n.disposeData(g.dataId),v)throw n.disposeData(f.dataId),new Error(v);return f}function bFe(e){return vH(e,!0)}var vFe={kernelName:fg,backendName:"wasm",setupFunc:bH,kernelFunc:bFe};function xFe(e){return vH(e,!1)}var wFe={kernelName:mg,backendName:"wasm",setupFunc:bH,kernelFunc:xFe},xH;function kFe(e){xH=e.wasm.cwrap(Eh,null,["number","number","number","number","number","number","number","number","array","number","number"])}function SFe(e){let{backend:t,inputs:n,attrs:r}=e,{sparseIndices:a,sparseValues:i,defaultValue:s}=n,{outputShape:o}=r,l=t.makeOutput(o,s.dtype);if(k.sizeFromShape(o)===0)return l;let{sliceRank:c,numUpdates:u,sliceSize:d,strides:p,outputSize:h}=T.calculateShapes(i,a,o),f=t.dataIdMap.get(a.dataId).id,m=t.dataIdMap.get(i.dataId).id,g=t.dataIdMap.get(s.dataId).id,y=new Uint8Array(new Int32Array(p).buffer),b=t.dataIdMap.get(l.dataId).id;return xH(f,m,i.shape.length,g,ut[s.dtype],c,u,d,y,h,b),l}var IFe={kernelName:Eh,backendName:"wasm",setupFunc:kFe,kernelFunc:SFe};function $Fe(e){let{inputs:t,attrs:n,backend:r}=e,{x:a}=t,{numOrSizeSplits:i,axis:s}=n,o=k.parseAxisParam(s,a.shape)[0],l=T.prepareSplitSize(a,i,o),c=new Array(a.shape.length).fill(0),u=a.shape.slice();return l.map(d=>{let p=[...u];p[o]=d;let h=fu({inputs:{x:a},attrs:{begin:c,size:p},backend:r});return c[o]+=d,h})}var CFe={kernelName:$h,backendName:"wasm",kernelFunc:$Fe},EFe=at(Rc),TFe=at(gg),NFe=gn(Mc),wH;function _Fe(e){wH=e.wasm.cwrap(Xo,null,["number","number","number","number"])}function AFe(e){let{backend:t,inputs:n,attrs:r}=e,{alpha:a}=r,{x:i}=n,s=t.dataIdMap.get(i.dataId).id,o=t.makeOutput(i.shape,i.dtype),l=t.dataIdMap.get(o.dataId).id;return wH(s,a,ut[i.dtype],l),o}var RFe={kernelName:Xo,backendName:"wasm",setupFunc:_Fe,kernelFunc:AFe},kH;function DFe(e){kH=e.wasm.cwrap(Th,null,["number","array","number","array","array","array","array","array","number","number"])}function FFe(e){let{backend:t,inputs:n,attrs:r}=e,{x:a}=n,{begin:i,end:s,strides:o,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:p}=r,{finalShapeSparse:h,finalShape:f,isIdentity:m,sliceDim0:g,isSimpleSlice:y,begin:b,end:v,strides:x}=In.sliceInfo(a.shape,i,s,o,l,c,u,d,p),w;if(m)w=Vr({inputs:{x:a},backend:t,attrs:{shape:f}});else if(g||y){k.assert(a.shape.length>=1,()=>"Input must have rank at least 1, got: ".concat(a.shape.length));let $=In.computeOutShape(b,v,x),C=fu({inputs:{x:a},backend:t,attrs:{begin:b,size:$}});w=Vr({inputs:{x:C},backend:t,attrs:{shape:f}}),t.disposeData(C.dataId)}else{let $=t.makeOutput(h,"float32"),C=t.dataIdMap.get(a.dataId).id,E=new Uint8Array(new Int32Array(k.computeStrides(a.shape)).buffer),_=new Uint8Array(new Int32Array(b).buffer),R=new Uint8Array(new Int32Array(v).buffer),N=new Uint8Array(new Int32Array(x).buffer),I=new Uint8Array(new Int32Array(h).buffer),O=new Uint8Array(new Int32Array(k.computeStrides(h)).buffer),P=t.dataIdMap.get($.dataId).id;kH(C,E,a.shape.length,_,R,N,I,O,h.length,P),w=Vr({inputs:{x:$},backend:t,attrs:{shape:f}}),t.disposeData($.dataId)}return w}var MFe={kernelName:Th,backendName:"wasm",setupFunc:DFe,kernelFunc:FFe};function OFe(e){let{backend:t,inputs:n,attrs:r}=e,{data:a,dataSplits:i}=n,{separator:s,nGramWidths:o,leftPad:l,rightPad:c,padWidth:u,preserveShortSequences:d}=r,p=t.readSync(a.dataId),h=t.readSync(i.dataId),[f,m]=Z2(p,h,s,o,l,c,u,d),g=t.makeOutput([f.length],"string"),y=t.dataIdMap.get(g.dataId);y.stringBytes=f;let b=t.makeOutput(i.shape,"int32");return t.typedArrayFromHeap(b).set(m),[g,b]}var LFe={kernelName:bg,backendName:"wasm",kernelFunc:OFe};function PFe(e){let{backend:t,inputs:n,attrs:r}=e,{input:a,delimiter:i}=n,{skipEmpty:s}=r,o=t.readSync(a.dataId),l=t.readSync(i.dataId),[c,u,d]=Q2(o,l[0],s),p=u.length,h=t.makeOutput([p,2],"int32");t.typedArrayFromHeap(h).set(c);let f=t.makeOutput([p],"string"),m=t.dataIdMap.get(f.dataId);m.stringBytes=u;let g=t.makeOutput([2],"int32");return t.typedArrayFromHeap(g).set(d),[h,f,g]}var zFe={kernelName:vg,backendName:"wasm",kernelFunc:PFe};function BFe(e){let{backend:t,inputs:n,attrs:r}=e,{input:a}=n,{numBuckets:i}=r,s=t.readSync(a.dataId),o=J2(s,i),l=t.makeOutput(a.shape,"int32");return t.typedArrayFromHeap(l).set(o),l}var WFe={kernelName:xg,backendName:"wasm",kernelFunc:BFe},UFe=gn(Oc),SH;function VFe(e){SH=e.wasm.cwrap(Dc,null,["number","number","number","number"])}function HFe(e){let{backend:t,inputs:n,attrs:r}=e,{axis:a,keepDims:i}=r,{x:s}=n,o=t.dataIdMap.get(s.dataId).id,l=o,c=s,{transposed:u,axes:d,originalAxes:p,inputWasTransposed:h}=rl(s,a,t),f=d;if(h){let v=t.dataIdMap.get(u.dataId).id;v!==o&&(c=u,l=v,f=T.getInnerMostAxes(f.length,c.shape.length))}T.assertAxesAreInnerMostDims("sum",f,c.shape.length);let[m,g]=T.computeOutAndReduceShapes(c.shape,f),y=k.sizeFromShape(g),b=t.makeOutput(m,c.dtype);if(k.sizeFromShape(c.shape)!==0){let v=t.dataIdMap.get(b.dataId).id;SH(l,y,ut[b.dtype],v)}if(h&&t.disposeData(u.dataId),i){let v=T.expandShapeToKeepDim(b.shape,p);b.shape=v}return b}var jFe={kernelName:Dc,backendName:"wasm",setupFunc:VFe,kernelFunc:HFe},GFe=at(Lc),qFe=at(Pc),IH;function KFe(e){IH=e.wasm.cwrap(xh,null,["number","number","number","number","number","number","array","number","number","number"])}function XFe(e){let{backend:t,inputs:n,attrs:r}=e,{tensor:a,indices:i,updates:s}=n,o=t.makeOutput(a.shape,a.dtype);if(k.sizeFromShape(a.shape)===0)return o;let{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:p}=Dx.calculateShapes(s,i,a.shape),h=t.dataIdMap.get(i.dataId).id,f=t.dataIdMap.get(s.dataId).id,m=t.dataIdMap.get(a.dataId).id,g=new Uint8Array(new Int32Array(d).buffer),y=t.dataIdMap.get(o.dataId).id;return IH(h,f,ut[s.dtype],l,c,u,g,p,y,m),o}var YFe={kernelName:xh,backendName:"wasm",setupFunc:KFe,kernelFunc:XFe},$H;function ZFe(e){$H=e.wasm.cwrap(Ko,null,["number","array","number","array","number","number"])}function QFe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,i=n.dataIdMap.get(a.dataId).id,{reps:s}=r,o=new Array(a.shape.length);for(let p=0;p<o.length;p++)o[p]=a.shape[p]*s[p];let l=new Uint8Array(new Int32Array(a.shape).buffer),c=new Uint8Array(new Int32Array(o).buffer),u=n.makeOutput(o,a.dtype),d=n.dataIdMap.get(u.dataId).id;return $H(i,l,a.shape.length,c,o.length,ut[u.dtype],d),u}var JFe={kernelName:Ko,backendName:"wasm",setupFunc:ZFe,kernelFunc:QFe},CH;function eMe(e){CH=e.wasm.cwrap(Nh,null,["number","array","number","number","number","bool","number","number"])}var tMe=({inputs:e,backend:t,attrs:n})=>{let{x:r}=e,{k:a,sorted:i}=n,s=t.dataIdMap.get(r.dataId).id,o=new Uint8Array(new Int32Array(r.shape).buffer),l=r.shape.slice();l[l.length-1]=a;let c=t.makeOutput(l,r.dtype),u=t.dataIdMap.get(c.dataId).id,d=t.makeOutput(l,"int32"),p=t.dataIdMap.get(d.dataId).id;return CH(s,o,r.shape.length,ut[r.dtype],a,i,u,p),[c,d]},nMe={kernelName:Nh,backendName:"wasm",setupFunc:eMe,kernelFunc:tMe},EH;function rMe(e){EH=e.wasm.cwrap(_h,null,["number","number","bool","number","number","number","number","number","number","array","number","array","number","number","number","number","number"])}function aMe(e){let{backend:t,inputs:n,attrs:r}=e,{image:a,transforms:i}=n,{interpolation:s,fillMode:o,fillValue:l,outputShape:c}=r,[u,d,p,h]=a.shape,[f,m]=c!=null?c:[d,p],g=[u,f,m,h],y=new Uint8Array(new Int32Array(k.computeStrides(a.shape)).buffer),b=new Uint8Array(new Int32Array(k.computeStrides(g)).buffer),v=t.makeOutput(g,a.dtype),x=t.dataIdMap.get(v.dataId).id,w=t.dataIdMap.get(a.dataId).id,$=t.dataIdMap.get(i.dataId).id,C=s==="nearest"?1:2,E;switch(o){case"constant":E=1;break;case"reflect":E=2;break;case"wrap":E=3;break;case"nearest":E=4;break;default:E=1;break}return EH(w,$,i.shape[0]>1,u,f,m,h,p,d,y,a.shape.length-1,b,g.length-1,C,E,l,x),v}var iMe={kernelName:_h,backendName:"wasm",setupFunc:rMe,kernelFunc:aMe};function sMe(e){let{inputs:t,attrs:n,backend:r}=e,{axis:a}=n,{x:i}=t,{outputValues:s,outputShape:o,indices:l}=tT(r.readSync(i.dataId),a,i.shape,i.dtype);return[r.makeOutput(o,i.dtype,void 0,s),r.makeOutput([l.length],"int32",void 0,l)]}var oMe={kernelName:wg,backendName:"wasm",kernelFunc:sMe};function lMe(e){let{inputs:t,backend:n,attrs:r}=e,{value:a}=t,{axis:i}=r;i<0&&(i+=a.shape.length);let s=a.shape[i],o=a.shape.length,l=new Array(o-1),c=0;for(let h=0;h<o;h++)h!==i&&(l[c++]=a.shape[h]);let u=new Array(s),d=new Array(o).fill(0),p=a.shape.slice();p[i]=1;for(let h=0;h<u.length;h++)d[i]=h,u[h]=fu({inputs:{x:a},attrs:{begin:d,size:p},backend:n});return u.map(({dataId:h,dtype:f})=>({dataId:h,dtype:f,shape:l}))}var uMe={kernelName:Ah,backendName:"wasm",kernelFunc:lMe};function cMe(e){let{inputs:{x:t},backend:n}=e,r=n.makeOutput(t.shape,t.dtype);return n.typedArrayFromHeap(r).fill(0),r}var dMe={kernelName:Rh,backendName:"wasm",kernelFunc:cMe},pMe=[rNe,aNe,iNe,sNe,oNe,cNe,bNe,wNe,kNe,SNe,INe,$Ne,CNe,ENe,TNe,ANe,BNe,FNe,LNe,HNe,YNe,JNe,e_e,n_e,r_e,a_e,o_e,l_e,d_e,f_e,y_e,x_e,S_e,I_e,$_e,T_e,A_e,F_e,L_e,B_e,V_e,G_e,X_e,Q_e,tAe,nAe,iAe,oAe,lAe,uAe,cAe,dAe,pAe,mAe,gAe,yAe,xAe,SAe,CAe,NAe,RAe,FAe,OAe,dNe,LAe,PAe,zAe,UAe,HAe,GAe,XAe,ZAe,YAe,JAe,eRe,nRe,aRe,oRe,cRe,hRe,fRe,yRe,xRe,SRe,CRe,NRe,RRe,MRe,ORe,zRe,HRe,jRe,GRe,qRe,YRe,JRe,nDe,aDe,oDe,uDe,dDe,nH,fDe,yDe,xDe,kDe,SDe,IDe,$De,CDe,WNe,NDe,RDe,MDe,PDe,WDe,HDe,jDe,GDe,XDe,QDe,tFe,nFe,iFe,sFe,oFe,lFe,KNe,WRe,uFe,dFe,fFe,yFe,vFe,wFe,IFe,CFe,EFe,TFe,NFe,RFe,MFe,LFe,zFe,WFe,UFe,jFe,GFe,qFe,YFe,JFe,nMe,iMe,mNe,oMe,uMe,dMe];for(let e of pMe)Sg(e);var VS=Z();VS.registerFlag("WASM_HAS_SIMD_SUPPORT",async()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]))}catch(e){return!1}});VS.registerFlag("WASM_HAS_MULTITHREAD_SUPPORT",async()=>{if(VS.get("IS_NODE"))return!1;try{return new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch(e){return!1}});var SD=jo(uZ()),hMe=jo(cZ()),ID=jo(dZ()),$D=SD.default||SD,fMe=ID.default||ID,TH=class extends eg{constructor(e){super(),this.wasm=e,this.dataIdNextNumber=1,this.wasm.tfjs.initWithThreadsCount(NH),HS=this.wasm.tfjs.getThreadsCount(),this.dataIdMap=new G0(this,ja())}write(e,t,n){let r={id:this.dataIdNextNumber++};return this.move(r,e,t,n,1),r}numDataIds(){return this.dataIdMap.numDataIds()}async time(e){let t=k.now();return e(),{kernelMs:k.now()-t}}move(e,t,n,r,a){let i=this.dataIdNextNumber++;if(r==="string"){let c=t;this.dataIdMap.set(e,{id:i,stringBytes:c,shape:n,dtype:r,memoryOffset:null,refCount:a});return}let s=k.sizeFromShape(n),o=s*k.bytesPerElement(r),l=this.wasm._malloc(o)>>>0;this.dataIdMap.set(e,{id:i,memoryOffset:l,shape:n,dtype:r,refCount:a}),this.wasm.tfjs.registerTensor(i,s,l),t!=null&&this.wasm.HEAPU8.set(new Uint8Array(t.buffer,t.byteOffset,o),l)}async read(e){return this.readSync(e)}readSync(e,t,n){let{memoryOffset:r,dtype:a,shape:i,stringBytes:s}=this.dataIdMap.get(e);if(a==="string")return(t==null||t===0)&&(n==null||n>=s.length)?s:s.slice(t,n);t=t||0,n=n||k.sizeFromShape(i);let o=k.bytesPerElement(a),l=this.wasm.HEAPU8.slice(r+t*o,r+n*o);return yMe(l.buffer,a)}disposeData(e,t=!1){if(this.dataIdMap.has(e)){let n=this.dataIdMap.get(e);if(n.refCount--,!t&&n.refCount>0)return!1;this.wasm._free(n.memoryOffset),this.wasm.tfjs.disposeData(n.id),this.dataIdMap.delete(e)}return!0}refCount(e){return this.dataIdMap.has(e)?this.dataIdMap.get(e).refCount:0}incRef(e){let t=this.dataIdMap.get(e);t!=null&&t.refCount++}floatPrecision(){return 32}getMemoryOffset(e){return this.dataIdMap.get(e).memoryOffset}dispose(){this.wasm.tfjs.dispose(),"PThread"in this.wasm&&this.wasm.PThread.terminateAllThreads(),this.wasm=null}memory(){return{unreliable:!1}}makeOutput(e,t,n,r){let a;if(n==null)a=this.write(r!=null?r:null,e,t);else{let i=this.dataIdNextNumber++;a={id:i},this.dataIdMap.set(a,{id:i,memoryOffset:n,shape:e,dtype:t,refCount:1});let s=k.sizeFromShape(e);this.wasm.tfjs.registerTensor(i,s,n)}return{dataId:a,shape:e,dtype:t}}typedArrayFromHeap({shape:e,dtype:t,dataId:n}){let r=this.wasm.HEAPU8.buffer,{memoryOffset:a}=this.dataIdMap.get(n),i=k.sizeFromShape(e);switch(t){case"float32":return new Float32Array(r,a,i);case"int32":return new Int32Array(r,a,i);case"bool":return new Uint8Array(r,a,i);default:throw new Error("Unknown dtype ".concat(t))}}};function mMe(e){return(t,n)=>(k.fetch(e,{credentials:"same-origin"}).then(r=>{r.ok||t.env.a("failed to load wasm binary file at '".concat(e,"'")),r.arrayBuffer().then(a=>{WebAssembly.instantiate(a,t).then(i=>{n(i.instance,i.module)})})}),{})}function CD(e,t,n){if(Gv!=null)return Gv;let r="tfjs-backend-wasm.wasm";return e&&t?r="tfjs-backend-wasm-threaded-simd.wasm":e&&(r="tfjs-backend-wasm-simd.wasm"),Kf!=null&&Kf[r]!=null?Kf[r]:n+r}async function gMe(){let[e,t]=await Promise.all([Z().getAsync("WASM_HAS_SIMD_SUPPORT"),Z().getAsync("WASM_HAS_MULTITHREAD_SUPPORT")]);return new Promise((n,r)=>{let a={};a.locateFile=(o,l)=>{if(o.endsWith(".worker.js")){let c=hMe.wasmWorkerContents.replace(/\n/g,"\\n"),u=new Blob([c],{type:"application/javascript"});return URL.createObjectURL(u)}return o.endsWith(".wasm")?CD(e,t,Df!=null?Df:l):l+o},wT&&(a.instantiateWasm=mMe(CD(e,t,Df!=null?Df:"")));let i=!1;a.onAbort=()=>{i||Xf||(Xf=!0,r({message:"Make sure the server can serve the `.wasm` file relative to the bundled js file. For more details see https://github.com/tensorflow/tfjs/blob/master/tfjs-backend-wasm/README.md#using-bundlers"}))};let s;t&&e&&Gv==null?(a.mainScriptUrlOrBlob=new Blob(["var WasmBackendModuleThreadedSimd = "+$D.toString()],{type:"text/javascript"}),s=$D(a)):s=fMe(a),s.then(o=>{i=!0,Xf=!1;let l=null;o.tfjs={init:o.cwrap("init",null,[]),initWithThreadsCount:o.cwrap("init_with_threads_count",null,["number"]),getThreadsCount:o.cwrap("get_threads_count","number",[]),registerTensor:o.cwrap("register_tensor",null,["number","number","number"]),disposeData:o.cwrap("dispose_data",l,["number"]),dispose:o.cwrap("dispose",l,[])},n({wasm:o})}).catch(r)})}function yMe(e,t){switch(t){case"float32":return new Float32Array(e);case"int32":return new Int32Array(e);case"bool":return new Uint8Array(e);default:throw new Error("Unknown dtype ".concat(t))}}var bMe=["tfjs-backend-wasm.wasm","tfjs-backend-wasm-simd.wasm","tfjs-backend-wasm-threaded-simd.wasm"],Gv=null,Df=null,Kf={},Xf=!1,wT=!1;function vMe(e,t=!1){if(EP("setWasmPath has been deprecated in favor of setWasmPaths and will be removed in a future release."),Xf)throw new Error("The WASM backend was already initialized. Make sure you call `setWasmPath()` before you call `tf.setBackend()` or `tf.ready()`");Gv=e,wT=t}function xMe(e,t=!1){if(Xf)throw new Error("The WASM backend was already initialized. Make sure you call `setWasmPaths()` before you call `tf.setBackend()` or `tf.ready()`");if(typeof e=="string")Df=e;else{Kf=e;let n=bMe.filter(r=>Kf[r]==null);if(n.length>0)throw new Error("There were no entries found for the following binaries: ".concat(n.join(","),". Please either call setWasmPaths with a map providing a path for each binary, or with a string indicating the directory where all the binaries can be found."))}wT=t}var NH=-1,HS=-1;function wMe(e){NH=e}function kMe(){if(HS===-1)throw new Error("WASM backend not initialized.");return HS}var SMe="4.7.0",IMe=2;ux("wasm",async()=>{let{wasm:e}=await gMe();return new TH(e)},IMe);var ED="4.7.0",$Me="4.7.0",CMe="4.7.0",EMe="4.7.0",TMe="4.7.0",NMe={tfjs:ED,"tfjs-core":ED,"tfjs-converter":$Me,"tfjs-backend-cpu":CMe,"tfjs-backend-webgl":EMe,"tfjs-backend-wasm":TMe},_Me={};A$(_Me,{AnchorPosition:()=>BH,DrawBox:()=>UH,DrawBoxOptions:()=>WH,DrawFaceLandmarks:()=>ij,DrawFaceLandmarksOptions:()=>aj,DrawTextField:()=>yw,DrawTextFieldOptions:()=>ET,drawContour:()=>Qs,drawDetections:()=>VMe,drawFaceExpressions:()=>nOe,drawFaceLandmarks:()=>aOe});function Qs(e,t,n=!1){if(e.beginPath(),t.slice(1).forEach(({x:r,y:a},i)=>{let s=t[i];e.moveTo(s.x,s.y),e.lineTo(r,a)}),n){let r=t[t.length-1],a=t[0];if(!r||!a)return;e.moveTo(r.x,r.y),e.lineTo(a.x,a.y)}e.stroke()}var AMe={};A$(AMe,{computeReshapedDimensions:()=>RH,getCenterPoint:()=>kT,isDimensions:()=>GS,isEven:()=>jS,isFloat:()=>AH,isTensor:()=>ef,isTensor1D:()=>RMe,isTensor2D:()=>_H,isTensor3D:()=>ay,isTensor4D:()=>Ns,isValidNumber:()=>Pl,isValidProbablitiy:()=>DMe,range:()=>kp,round:()=>gw});var $o=class{constructor(e,t){if(!Pl(e)||!Pl(t))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have ".concat(JSON.stringify({width:e,height:t})));this._width=e,this._height=t}get width(){return this._width}get height(){return this._height}reverse(){return new $o(1/this.width,1/this.height)}};function ef(e,t){return e instanceof He&&e.shape.length===t}function RMe(e){return ef(e,1)}function _H(e){return ef(e,2)}function ay(e){return ef(e,3)}function Ns(e){return ef(e,4)}function AH(e){return e%1!==0}function jS(e){return e%2===0}function gw(e,t=2){let n=10**t;return Math.floor(e*n)/n}function GS(e){return e&&e.width&&e.height}function RH({width:e,height:t},n){let r=n/Math.max(t,e);return new $o(Math.round(e*r),Math.round(t*r))}function kT(e){return e.reduce((t,n)=>t.add(n),new ot(0,0)).div(new ot(e.length,e.length))}function kp(e,t,n){return Array(e).fill(0).map((r,a)=>t+a*n)}function Pl(e){return!!e&&e!==1/0&&e!==-1/0&&!Number.isNaN(e)||e===0}function DMe(e){return Pl(e)&&e>=0&&e<=1}var ot=class{constructor(e,t){this._x=e,this._y=t}get x(){return this._x}get y(){return this._y}add(e){return new ot(this.x+e.x,this.y+e.y)}sub(e){return new ot(this.x-e.x,this.y-e.y)}mul(e){return new ot(this.x*e.x,this.y*e.y)}div(e){return new ot(this.x/e.x,this.y/e.y)}abs(){return new ot(Math.abs(this.x),Math.abs(this.y))}magnitude(){return Math.sqrt(this.x**2+this.y**2)}floor(){return new ot(Math.floor(this.x),Math.floor(this.y))}},rr=class{static isRect(e){return!!e&&[e.x,e.y,e.width,e.height].every(Pl)}static assertIsValidBox(e,t,n=!1){if(!rr.isRect(e))throw new Error("".concat(t," - invalid box: ").concat(JSON.stringify(e),", expected object with properties x, y, width, height"));if(!n&&(e.width<0||e.height<0))throw new Error("".concat(t," - width (").concat(e.width,") and height (").concat(e.height,") must be positive numbers"))}constructor(e,t=!0){let n=e||{},r=[n.left,n.top,n.right,n.bottom].every(Pl),a=[n.x,n.y,n.width,n.height].every(Pl);if(!a&&!r)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have ".concat(JSON.stringify(n)));let[i,s,o,l]=a?[n.x,n.y,n.width,n.height]:[n.left,n.top,n.right-n.left,n.bottom-n.top];rr.assertIsValidBox({x:i,y:s,width:o,height:l},"Box.constructor",t),this._x=i,this._y=s,this._width=o,this._height=l}get x(){return this._x}get y(){return this._y}get width(){return this._width}get height(){return this._height}get left(){return this.x}get top(){return this.y}get right(){return this.x+this.width}get bottom(){return this.y+this.height}get area(){return this.width*this.height}get topLeft(){return new ot(this.left,this.top)}get topRight(){return new ot(this.right,this.top)}get bottomLeft(){return new ot(this.left,this.bottom)}get bottomRight(){return new ot(this.right,this.bottom)}round(){let[e,t,n,r]=[this.x,this.y,this.width,this.height].map(a=>Math.round(a));return new rr({x:e,y:t,width:n,height:r})}floor(){let[e,t,n,r]=[this.x,this.y,this.width,this.height].map(a=>Math.floor(a));return new rr({x:e,y:t,width:n,height:r})}toSquare(){let{x:e,y:t,width:n,height:r}=this,a=Math.abs(n-r);return n<r&&(e-=a/2,n+=a),r<n&&(t-=a/2,r+=a),new rr({x:e,y:t,width:n,height:r})}rescale(e){let t=GS(e)?e.width:e,n=GS(e)?e.height:e;return new rr({x:this.x*t,y:this.y*n,width:this.width*t,height:this.height*n})}pad(e,t){let[n,r,a,i]=[this.x-e/2,this.y-t/2,this.width+e,this.height+t];return new rr({x:n,y:r,width:a,height:i})}clipAtImageBorders(e,t){let{x:n,y:r,right:a,bottom:i}=this,s=Math.max(n,0),o=Math.max(r,0),l=a-s,c=i-o,u=Math.min(l,e-s),d=Math.min(c,t-o);return new rr({x:s,y:o,width:u,height:d}).floor()}shift(e,t){let{width:n,height:r}=this,a=this.x+e,i=this.y+t;return new rr({x:a,y:i,width:n,height:r})}padAtBorders(e,t){let n=this.width+1,r=this.height+1,a=1,i=1,s=n,o=r,l=this.left,c=this.top,u=this.right,d=this.bottom;return u>t&&(s=-u+t+n,u=t),d>e&&(o=-d+e+r,d=e),l<1&&(o=2-l,l=1),c<1&&(o=2-c,c=1),{dy:i,edy:o,dx:a,edx:s,y:c,ey:d,x:l,ex:u,w:n,h:r}}calibrate(e){return new rr({left:this.left+e.left*this.width,top:this.top+e.top*this.height,right:this.right+e.right*this.width,bottom:this.bottom+e.bottom*this.height}).toSquare().round()}},DH=class extends rr{constructor(e,t,n,r,a=!1){super({left:e,top:t,right:n,bottom:r},a)}},ST=class{constructor(e,t,n,r,a){this._imageDims=new $o(a.width,a.height),this._score=e,this._classScore=t,this._className=n,this._box=new rr(r).rescale(this._imageDims)}get score(){return this._score}get classScore(){return this._classScore}get className(){return this._className}get box(){return this._box}get imageDims(){return this._imageDims}get imageWidth(){return this.imageDims.width}get imageHeight(){return this.imageDims.height}get relativeBox(){return new rr(this._box).rescale(this.imageDims.reverse())}forSize(e,t){return new ST(this.score,this.classScore,this.className,this.relativeBox,{width:e,height:t})}},Fa=class extends ST{constructor(e,t,n){super(e,e,"",t,n)}forSize(e,t){let{score:n,relativeBox:r,imageDims:a}=super.forSize(e,t);return new Fa(n,r,a)}};function FMe(e,t,n=!0){let r=Math.max(0,Math.min(e.right,t.right)-Math.max(e.left,t.left)),a=Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top)),i=r*a;return n?i/(e.area+t.area-i):i/Math.min(e.area,t.area)}function MMe(e){let t=e.map(o=>o.x),n=e.map(o=>o.y),r=t.reduce((o,l)=>l<o?l:o,1/0),a=n.reduce((o,l)=>l<o?l:o,1/0),i=t.reduce((o,l)=>o<l?l:o,0),s=n.reduce((o,l)=>o<l?l:o,0);return new DH(r,a,i,s)}function OMe(e,t,n,r=!0){let a=t.map((s,o)=>({score:s,boxIndex:o})).sort((s,o)=>s.score-o.score).map(s=>s.boxIndex),i=[];for(;a.length>0;){let s=a.pop();i.push(s);let o=a,l=[];for(let c=0;c<o.length;c++){let u=o[c],d=e[s],p=e[u];l.push(FMe(d,p,r))}a=a.filter((c,u)=>l[u]<=n)}return i}function iy(e,t){return K(()=>{let[n,r,a]=t,i=da([...e.shape.slice(0,3),1],n,"float32"),s=da([...e.shape.slice(0,3),1],r,"float32"),o=da([...e.shape.slice(0,3),1],a,"float32"),l=wt([i,s,o],3);return xe(e,l)})}function LMe(e,t=!1){return K(()=>{let[n,r]=e.shape.slice(1);if(n===r)return e;let a=Math.abs(n-r),i=Math.round(a*(t?.5:1)),s=n>r?2:1,o=d=>{let p=e.shape.slice();return p[s]=d,da(p,0,"float32")},l=o(i),c=a-l.shape[s],u=[t&&c?o(c):null,e,l].filter(d=>!!d).map(d=>de(d,"float32"));return wt(u,s)})}function _1(e){return 1/(1+Math.exp(-e))}var FH=class extends rr{constructor(e,t,n,r,a=!1){super({x:e,y:t,width:n,height:r},a)}},PMe=.5,zMe=.43,BMe=.45,zm=class{constructor(e,t,n=new ot(0,0)){let{width:r,height:a}=t;this._imgDims=new $o(r,a),this._shift=n,this._positions=e.map(i=>i.mul(new ot(r,a)).add(n))}get shift(){return new ot(this._shift.x,this._shift.y)}get imageWidth(){return this._imgDims.width}get imageHeight(){return this._imgDims.height}get positions(){return this._positions}get relativePositions(){return this._positions.map(e=>e.sub(this._shift).div(new ot(this.imageWidth,this.imageHeight)))}forSize(e,t){return new this.constructor(this.relativePositions,{width:e,height:t})}shiftBy(e,t){return new this.constructor(this.relativePositions,this._imgDims,new ot(e,t))}shiftByPoint(e){return this.shiftBy(e.x,e.y)}align(e,t={}){if(e){let a=e instanceof Fa?e.box.floor():new rr(e);return this.shiftBy(a.x,a.y).align(null,t)}let{useDlibAlignment:n,minBoxPadding:r}={useDlibAlignment:!1,minBoxPadding:.2,...t};return n?this.alignDlib():this.alignMinBbox(r)}alignDlib(){let e=this.getRefPointsForAlignment(),[t,n,r]=e,a=u=>r.sub(u).magnitude(),i=(a(t)+a(n))/2,s=Math.floor(i/BMe),o=kT(e),l=Math.floor(Math.max(0,o.x-PMe*s)),c=Math.floor(Math.max(0,o.y-zMe*s));return new FH(l,c,Math.min(s,this.imageWidth+l),Math.min(s,this.imageHeight+c))}alignMinBbox(e){let t=MMe(this.positions);return t.pad(t.width*e,t.height*e)}getRefPointsForAlignment(){throw new Error("getRefPointsForAlignment not implemented by base class")}},MH=class extends zm{getJawOutline(){return this.positions.slice(0,17)}getLeftEyeBrow(){return this.positions.slice(17,22)}getRightEyeBrow(){return this.positions.slice(22,27)}getNose(){return this.positions.slice(27,36)}getLeftEye(){return this.positions.slice(36,42)}getRightEye(){return this.positions.slice(42,48)}getMouth(){return this.positions.slice(48,68)}getRefPointsForAlignment(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(kT)}},TD=class{constructor(e,t){this._label=e,this._distance=t}get label(){return this._label}get distance(){return this._distance}toString(e=!0){return"".concat(this.label).concat(e?" (".concat(gw(this.distance),")"):"")}},Rl=class{constructor(e,t){if(typeof e!="string")throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(t)||t.some(n=>!(n instanceof Float32Array)))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=e,this._descriptors=t}get label(){return this._label}get descriptors(){return this._descriptors}toJSON(){return{label:this.label,descriptors:this.descriptors.map(e=>Array.from(e))}}static fromJSON(e){let t=e.descriptors.map(n=>new Float32Array(n));return new Rl(e.label,t)}};function Bm(e){return e.detection instanceof Fa}function qv(e,t){return{...e,detection:t}}function OH(){let e=window.fetch;if(!e)throw new Error("fetch - missing fetch implementation for browser environment");return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D,Image:HTMLImageElement,ImageData,Video:HTMLVideoElement,createCanvasElement:()=>document.createElement("canvas"),createImageElement:()=>document.createElement("img"),createVideoElement:()=>document.createElement("video"),fetch:e,readFile:()=>{throw new Error("readFile - filesystem not available for browser environment")}}}function IT(){return typeof global=="object"&&typeof process<"u"&&process.versions!=null&&process.versions.node!=null}function LH(e){let t="";if(!e&&IT())try{e=WY("fs")}catch(n){t=n.toString()}return{readFile:e?n=>new Promise((r,a)=>{e.readFile(n,(i,s)=>i?a(i):r(s))}):()=>{throw new Error("readFile - failed to require fs in nodejs environment with error: ".concat(t))}}}function PH(){let e=global.Canvas||global.HTMLCanvasElement,t=global.Image||global.HTMLImageElement,n=global.Video||global.HTMLVideoElement,r=()=>{if(e)return new e;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},a=()=>{if(t)return new t;throw new Error("createImageElement - missing Image implementation for nodejs environment")},i=()=>{if(n)return new n;throw new Error("createVideoElement - missing Video implementation for nodejs environment")},s=global.fetch,o=LH();return{Canvas:e||class{},CanvasRenderingContext2D:global.CanvasRenderingContext2D||class{},Image:t||class{},ImageData:global.ImageData||class{},Video:global.HTMLVideoElement||class{},createCanvasElement:r,createImageElement:a,createVideoElement:i,fetch:s,...o}}function zH(){return typeof window=="object"&&typeof document<"u"&&typeof HTMLImageElement<"u"&&typeof HTMLCanvasElement<"u"&&typeof HTMLVideoElement<"u"&&typeof ImageData<"u"&&typeof CanvasRenderingContext2D<"u"}var An;function WMe(){if(!An)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return An}function qS(e){An=e}function $T(){return zH()?qS(OH()):IT()?qS(PH()):null}function UMe(e){if(An||$T(),!An)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");let{Canvas:t=An.Canvas,Image:n=An.Image}=e;An.Canvas=t,An.Image=n,An.createCanvasElement=e.createCanvasElement||(()=>new t),An.createImageElement=e.createImageElement||(()=>new n),An.ImageData=e.ImageData||An.ImageData,An.Video=e.Video||An.Video,An.fetch=e.fetch||An.fetch,An.readFile=e.readFile||An.readFile}var Tr={getEnv:WMe,setEnv:qS,initialize:$T,createBrowserEnv:OH,createFileSystem:LH,createNodejsEnv:PH,monkeyPatch:UMe,isBrowser:zH,isNodejs:IT};$T();function CT(e){return!Tr.isNodejs()&&typeof e=="string"?document.getElementById(e):e}function Wo(e){let{Canvas:t,CanvasRenderingContext2D:n}=Tr.getEnv();if(e instanceof n)return e;let r=CT(e);if(!(r instanceof t))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");let a=r.getContext("2d",{willReadFrequently:!0});if(!a)throw new Error("resolveContext2d - canvas 2d context is null");return a}var BH=(e=>(e.TOP_LEFT="TOP_LEFT",e.TOP_RIGHT="TOP_RIGHT",e.BOTTOM_LEFT="BOTTOM_LEFT",e.BOTTOM_RIGHT="BOTTOM_RIGHT",e))(BH||{}),ET=class{constructor(e={}){let{anchorPosition:t,backgroundColor:n,fontColor:r,fontSize:a,fontStyle:i,padding:s}=e;this.anchorPosition=t||"TOP_LEFT",this.backgroundColor=n||"rgba(0, 0, 0, 0.5)",this.fontColor=r||"rgba(255, 255, 255, 1)",this.fontSize=a||14,this.fontStyle=i||"Georgia",this.padding=s||4}},yw=class{constructor(e,t,n={}){this.text=typeof e=="string"?[e]:e instanceof yw?e.text:e,this.anchor=t,this.options=new ET(n)}measureWidth(e){let{padding:t}=this.options;return this.text.map(n=>e.measureText(n).width).reduce((n,r)=>n<r?r:n,0)+2*t}measureHeight(){let{fontSize:e,padding:t}=this.options;return this.text.length*e+2*t}getUpperLeft(e,t){let{anchorPosition:n}=this.options,r=n==="BOTTOM_RIGHT"||n==="TOP_RIGHT",a=n==="BOTTOM_LEFT"||n==="BOTTOM_RIGHT",i=this.measureWidth(e),s=this.measureHeight(),o=r?this.anchor.x-i:this.anchor.x,l=a?this.anchor.y-s:this.anchor.y;if(t){let{width:c,height:u}=t,d=Math.max(Math.min(o,c-i),0),p=Math.max(Math.min(l,u-s),0);return{x:d,y:p}}return{x:o,y:l}}draw(e){let t=CT(e),n=Wo(t),{backgroundColor:r,fontColor:a,fontSize:i,fontStyle:s,padding:o}=this.options;n.font="".concat(i,"px ").concat(s);let l=this.measureWidth(n),c=this.measureHeight();n.fillStyle=r;let u=this.getUpperLeft(n,t);n.fillRect(u.x,u.y,l,c),n.fillStyle=a,this.text.forEach((d,p)=>{let h=o+u.x,f=o+u.y+(p+1)*i;n.fillText(d,h,f)})}},WH=class{constructor(e={}){let{boxColor:t,lineWidth:n,label:r,drawLabelOptions:a}=e;this.boxColor=t||"rgba(0, 0, 255, 1)",this.lineWidth=n||2,this.label=r;let i={anchorPosition:"BOTTOM_LEFT",backgroundColor:this.boxColor};this.drawLabelOptions=new ET({...i,...a})}},UH=class{constructor(e,t={}){this.box=new rr(e),this.options=new WH(t)}draw(e){let t=Wo(e),{boxColor:n,lineWidth:r}=this.options,{x:a,y:i,width:s,height:o}=this.box;t.strokeStyle=n,t.lineWidth=r,t.strokeRect(a,i,s,o);let{label:l}=this.options;l&&new yw([l],{x:a-r/2,y:i},this.options.drawLabelOptions).draw(e)}};function VMe(e,t){(Array.isArray(t)?t:[t]).forEach(n=>{let r=n instanceof Fa?n.score:Bm(n)?n.detection.score:void 0,a=n instanceof Fa?n.box:Bm(n)?n.detection.box:new rr(n),i=r?"".concat(gw(r)):void 0;new UH(a,{label:i}).draw(e)})}function VH(e){let{Image:t,Video:n}=Tr.getEnv();return e instanceof t&&e.complete||e instanceof n&&e.readyState>=3}function HMe(e){return new Promise((t,n)=>{(e instanceof Tr.getEnv().Canvas||VH(e))&&t(null);function r(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",a),i.currentTarget.removeEventListener("error",r),n(i))}function a(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",a),i.currentTarget.removeEventListener("error",r),t(i))}e.addEventListener("load",a),e.addEventListener("error",r)})}function jMe(e){return new Promise((t,n)=>{e instanceof Blob||n(new Error("bufferToImage - expected buf to be of type: Blob"));let r=new FileReader;r.onload=()=>{typeof r.result!="string"&&n(new Error("bufferToImage - expected reader.result to be a string, in onload"));let a=Tr.getEnv().createImageElement();a.onload=()=>t(a),a.onerror=n,a.src=r.result},r.onerror=n,r.readAsDataURL(e)})}function TT(e){let{Image:t,Video:n}=Tr.getEnv();return e instanceof t?new $o(e.naturalWidth,e.naturalHeight):e instanceof n?new $o(e.videoWidth,e.videoHeight):new $o(e.width,e.height)}function Kv({width:e,height:t}){let{createCanvasElement:n}=Tr.getEnv(),r=n();return r.width=e,r.height=t,r}function HH(e,t){let{ImageData:n}=Tr.getEnv();if(!(e instanceof n)&&!VH(e))throw new Error("createCanvasFromMedia - media has not finished loading yet");let{width:r,height:a}=t||TT(e),i=Kv({width:r,height:a});return e instanceof n?Wo(i).putImageData(e,0,0):Wo(i).drawImage(e,0,0,r,a),i}async function GMe(e,t){let n=t||Tr.getEnv().createCanvasElement(),[r,a,i]=e.shape.slice(Ns(e)?1:0),s=K(()=>e.as3D(r,a,i).toInt());return await Wg.toPixels(s,n),s.dispose(),n}function ND(e){let{Image:t,Canvas:n,Video:r}=Tr.getEnv();return e instanceof t||e instanceof n||e instanceof r}function qMe(e,t,n=!1){let{Image:r,Canvas:a}=Tr.getEnv();if(!(e instanceof r||e instanceof a))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");if(t<=0)return Kv({width:1,height:1});let i=TT(e),s=t/Math.max(i.height,i.width),o=s*i.width,l=s*i.height,c=Kv({width:t,height:t}),u=e instanceof a?e:HH(e),d=Math.abs(o-l)/2,p=n&&o<l?d:0,h=n&&l<o?d:0;return u.width>0&&u.height>0&&Wo(c).drawImage(u,p,h,o,l),c}var Xv=class{constructor(e,t=!1){if(this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],this._inputSize=0,!Array.isArray(e))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have ".concat(e));this._treatAsBatchInput=t,this._batchSize=e.length,e.forEach((n,r)=>{if(ay(n)){this._imageTensors[r]=n,this._inputDimensions[r]=n.shape;return}if(Ns(n)){let i=n.shape[0];if(i!==1)throw new Error("NetInput - tf.Tensor4D with batchSize ".concat(i," passed, but not supported in input array"));this._imageTensors[r]=n,this._inputDimensions[r]=n.shape.slice(1);return}let a=n instanceof Tr.getEnv().Canvas?n:HH(n);this._canvases[r]=a,this._inputDimensions[r]=[a.height,a.width,3]})}get imageTensors(){return this._imageTensors}get canvases(){return this._canvases}get isBatchInput(){return this.batchSize>1||this._treatAsBatchInput}get batchSize(){return this._batchSize}get inputDimensions(){return this._inputDimensions}get inputSize(){return this._inputSize}get reshapedInputDimensions(){return kp(this.batchSize,0,1).map((e,t)=>this.getReshapedInputDimensions(t))}getInput(e){return this.canvases[e]||this.imageTensors[e]}getInputDimensions(e){return this._inputDimensions[e]}getInputHeight(e){return this._inputDimensions[e][0]}getInputWidth(e){return this._inputDimensions[e][1]}getReshapedInputDimensions(e){if(typeof this.inputSize!="number")throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");let t=this.getInputWidth(e),n=this.getInputHeight(e);return RH({width:t,height:n},this.inputSize)}toBatchTensor(e,t=!0){return this._inputSize=e,K(()=>{let n=kp(this.batchSize,0,1).map(r=>{let a=this.getInput(r);if(a instanceof He){let i=Ns(a)?a:Vn(a);return i=LMe(i,t),(i.shape[1]!==e||i.shape[2]!==e)&&(i=$a.resizeBilinear(i,[e,e],!1,!1)),i.as3D(e,e,3)}if(a instanceof Tr.getEnv().Canvas)return Wg.fromPixels(qMe(a,e,t));throw new Error("toBatchTensor - at batchIdx ".concat(r,", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have ").concat(a))});return Sn(n.map(r=>de(r,"float32"))).as4D(this.batchSize,e,e,3)})}};async function Nr(e){if(e instanceof Xv)return e;let t=Array.isArray(e)?e:[e];if(!t.length)throw new Error("toNetInput - empty array passed as input");let n=a=>Array.isArray(e)?" at input index ".concat(a,":"):"",r=t.map(CT);return r.forEach((a,i)=>{if(!ND(a)&&!ay(a)&&!Ns(a))throw typeof t[i]=="string"?new Error("toNetInput -".concat(n(i)," string passed, but could not resolve HTMLElement for element id ").concat(t[i])):new Error("toNetInput -".concat(n(i)," expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id"));if(Ns(a)){let s=a.shape[0];if(s!==1)throw new Error("toNetInput -".concat(n(i)," tf.Tensor4D with batchSize ").concat(s," passed, but not supported in input array"))}}),await Promise.all(r.map(a=>ND(a)&&HMe(a))),new Xv(r,Array.isArray(e))}async function NT(e,t){let{Canvas:n}=Tr.getEnv(),r=e;if(!(e instanceof n)){let i=await Nr(e);if(i.batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");let s=i.getInput(0);r=s instanceof n?s:await GMe(s)}let a=Wo(r);return t.map(i=>i instanceof Fa?i.forSize(r.width,r.height).box.floor():i).map(i=>i.clipAtImageBorders(r.width,r.height)).map(({x:i,y:s,width:o,height:l})=>{let c=Kv({width:o,height:l});return o>0&&l>0&&Wo(c).putImageData(a.getImageData(i,s,o,l),0,0),c})}async function _T(e,t){if(!ay(e)&&!Ns(e))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(Ns(e)&&e.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return K(()=>{let[n,r,a]=e.shape.slice(Ns(e)?1:0);return t.map(i=>i instanceof Fa?i.forSize(r,n).box:i).map(i=>i.clipAtImageBorders(r,n)).filter(i=>i.width>0&&i.height>0).map(({x:i,y:s,width:o,height:l})=>Bh(e.as3D(n,r,a),[s,i,0],[l,o,a]))})}async function jH(e,t){let{fetch:n}=Tr.getEnv(),r=await n(e,t);if(!(r.status<400))throw new Error("failed to fetch: (".concat(r.status,") ").concat(r.statusText,", from url: ").concat(r.url));return r}async function GH(e){let t=await jH(e),n=await t.blob();if(!n.type.startsWith("image/"))throw new Error("fetchImage - expected blob type to be of type image/*, instead have: ".concat(n.type,", for url: ").concat(t.url));return jMe(n)}async function KMe(e){return(await jH(e)).json()}function qH(e,t){let n="".concat(t,"-weights_manifest.json");if(!e)return{modelBaseUri:"",manifestUri:n};if(e==="/")return{modelBaseUri:"/",manifestUri:"/".concat(n)};let r=e.startsWith("http://")?"http://":e.startsWith("https://")?"https://":"";e=e.replace(r,"");let a=e.split("/").filter(o=>o),i=e.endsWith(".json")?a[a.length-1]:n,s=r+(e.endsWith(".json")?a.slice(0,a.length-1):a).join("/");return s=e.startsWith("/")?"/".concat(s):s,{modelBaseUri:s,manifestUri:s==="/"?"/".concat(i):"".concat(s,"/").concat(i)}}async function XMe(e,t){let{manifestUri:n,modelBaseUri:r}=qH(e,t),a=await KMe(n);return Gn.loadWeights(a,r)}function KH(e,t,n=!1){let{width:r,height:a}=n?TT(t):t;return e.width=r,e.height=a,{width:r,height:a}}var il=class{constructor(e){this._params=void 0,this._paramMappings=[],this._name=e}get params(){return this._params}get paramMappings(){return this._paramMappings}get isLoaded(){return!!this.params}getParamFromPath(e){let{obj:t,objProp:n}=this.traversePropertyPath(e);return t[n]}reassignParamFromPath(e,t){let{obj:n,objProp:r}=this.traversePropertyPath(e);n[r].dispose(),n[r]=t}getParamList(){return this._paramMappings.map(({paramPath:e})=>({path:e,tensor:this.getParamFromPath(e)}))}getTrainableParams(){return this.getParamList().filter(e=>e.tensor instanceof Jl)}getFrozenParams(){return this.getParamList().filter(e=>!(e.tensor instanceof Jl))}variable(){this.getFrozenParams().forEach(({path:e,tensor:t})=>{this.reassignParamFromPath(e,t.variable())})}freeze(){this.getTrainableParams().forEach(({path:e,tensor:t})=>{let n=wr(t.dataSync());t.dispose(),this.reassignParamFromPath(e,n)})}dispose(e=!0){this.getParamList().forEach(t=>{if(e&&t.tensor.isDisposed)throw new Error("param tensor has already been disposed for path ".concat(t.path));t.tensor.dispose()}),this._params=void 0}serializeParams(){return new Float32Array(this.getParamList().map(({tensor:e})=>Array.from(e.dataSync())).reduce((e,t)=>e.concat(t)))}async load(e){if(e instanceof Float32Array){this.extractWeights(e);return}await this.loadFromUri(e)}async loadFromUri(e){if(e&&typeof e!="string")throw new Error("".concat(this._name,".loadFromUri - expected model uri"));let t=await XMe(e,this.getDefaultModelName());this.loadFromWeightMap(t)}async loadFromDisk(e){if(e&&typeof e!="string")throw new Error("".concat(this._name,".loadFromDisk - expected model file path"));let{readFile:t}=Tr.getEnv(),{manifestUri:n,modelBaseUri:r}=qH(e,this.getDefaultModelName()),a=l=>Promise.all(l.map(c=>t(c).then(u=>u.buffer))),i=Gn.weightsLoaderFactory(a),s=JSON.parse((await t(n)).toString()),o=await i(s,r);this.loadFromWeightMap(o)}loadFromWeightMap(e){let{paramMappings:t,params:n}=this.extractParamsFromWeightMap(e);this._paramMappings=t,this._params=n}extractWeights(e){let{paramMappings:t,params:n}=this.extractParams(e);this._paramMappings=t,this._params=n}traversePropertyPath(e){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");let t=e.split("/").reduce((a,i)=>{if(!a.nextObj.hasOwnProperty(i))throw new Error("traversePropertyPath - object does not have property ".concat(i,", for path ").concat(e));return{obj:a.nextObj,objProp:i,nextObj:a.nextObj[i]}},{nextObj:this.params}),{obj:n,objProp:r}=t;if(!n||!r||!(n[r]instanceof He))throw new Error("traversePropertyPath - parameter is not a tensor, for path ".concat(e));return{obj:n,objProp:r}}};function Ta(e,t,n){return K(()=>{let r=zh(e,t.depthwise_filter,t.pointwise_filter,n,"same");return r=ne(r,t.bias),r})}function A1(e,t,n=!1){return K(()=>{let r=ft(n?ne($r(e,t.conv0.filters,[2,2],"same"),t.conv0.bias):Ta(e,t.conv0,[2,2])),a=Ta(r,t.conv1,[1,1]),i=ft(ne(r,a)),s=Ta(i,t.conv2,[1,1]);return ft(ne(r,ne(a,s)))})}function nb(e,t,n=!1,r=!0){return K(()=>{let a=ft(n?ne($r(e,t.conv0.filters,r?[2,2]:[1,1],"same"),t.conv0.bias):Ta(e,t.conv0,r?[2,2]:[1,1])),i=Ta(a,t.conv1,[1,1]),s=ft(ne(a,i)),o=Ta(s,t.conv2,[1,1]),l=ft(ne(a,ne(i,o))),c=Ta(l,t.conv3,[1,1]);return ft(ne(a,ne(i,ne(o,c))))})}function Yf(e,t,n="same",r=!1){return K(()=>{let a=ne($r(e,t.filters,[1,1],n),t.bias);return r?ft(a):a})}function sl(e,t){Object.keys(e).forEach(n=>{t.some(r=>r.originalPath===n)||e[n].dispose()})}function AT(e,t){return(n,r,a,i)=>{let s=Fo(e(n*r*a*a),[a,a,n,r]),o=ht(e(r));return t.push({paramPath:"".concat(i,"/filters")},{paramPath:"".concat(i,"/bias")}),{filters:s,bias:o}}}function XH(e,t){return(n,r,a)=>{let i=ts(e(n*r),[n,r]),s=ht(e(r));return t.push({paramPath:"".concat(a,"/weights")},{paramPath:"".concat(a,"/bias")}),{weights:i,bias:s}}}var YH=class{constructor(e,t,n){this.depthwise_filter=e,this.pointwise_filter=t,this.bias=n}};function RT(e,t){return(n,r,a)=>{let i=Fo(e(9*n),[3,3,n,1]),s=Fo(e(n*r),[1,1,n,r]),o=ht(e(r));return t.push({paramPath:"".concat(a,"/depthwise_filter")},{paramPath:"".concat(a,"/pointwise_filter")},{paramPath:"".concat(a,"/bias")}),new YH(i,s,o)}}function DT(e){return t=>{let n=e("".concat(t,"/depthwise_filter"),4),r=e("".concat(t,"/pointwise_filter"),4),a=e("".concat(t,"/bias"),1);return new YH(n,r,a)}}function Yc(e,t){return(n,r,a)=>{let i=e[n];if(!ef(i,r))throw new Error("expected weightMap[".concat(n,"] to be a Tensor").concat(r,"D, instead have ").concat(i));return t.push({originalPath:n,paramPath:a||n}),i}}function ol(e){let t=e;function n(a){let i=t.slice(0,a);return t=t.slice(a),i}function r(){return t}return{extractWeights:n,getRemainingWeights:r}}function ZH(e,t){let n=AT(e,t),r=RT(e,t);function a(s,o,l,c=!1){let u=c?n(s,o,3,"".concat(l,"/conv0")):r(s,o,"".concat(l,"/conv0")),d=r(o,o,"".concat(l,"/conv1")),p=r(o,o,"".concat(l,"/conv2"));return{conv0:u,conv1:d,conv2:p}}function i(s,o,l,c=!1){let{conv0:u,conv1:d,conv2:p}=a(s,o,l,c),h=r(o,o,"".concat(l,"/conv3"));return{conv0:u,conv1:d,conv2:p,conv3:h}}return{extractDenseBlock3Params:a,extractDenseBlock4Params:i}}function YMe(e){let t=[],{extractWeights:n,getRemainingWeights:r}=ol(e),{extractDenseBlock4Params:a}=ZH(n,t),i=a(3,32,"dense0",!0),s=a(32,64,"dense1"),o=a(64,128,"dense2"),l=a(128,256,"dense3");if(r().length!==0)throw new Error("weights remaing after extract: ".concat(r().length));return{paramMappings:t,params:{dense0:i,dense1:s,dense2:o,dense3:l}}}function QH(e){return t=>{let n=e("".concat(t,"/filters"),4),r=e("".concat(t,"/bias"),1);return{filters:n,bias:r}}}function JH(e,t){let n=Yc(e,t),r=QH(n),a=DT(n);function i(o,l=!1){let c=l?r("".concat(o,"/conv0")):a("".concat(o,"/conv0")),u=a("".concat(o,"/conv1")),d=a("".concat(o,"/conv2"));return{conv0:c,conv1:u,conv2:d}}function s(o,l=!1){let c=l?r("".concat(o,"/conv0")):a("".concat(o,"/conv0")),u=a("".concat(o,"/conv1")),d=a("".concat(o,"/conv2")),p=a("".concat(o,"/conv3"));return{conv0:c,conv1:u,conv2:d,conv3:p}}return{extractDenseBlock3Params:i,extractDenseBlock4Params:s}}function ZMe(e){let t=[],{extractDenseBlock4Params:n}=JH(e,t),r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2"),dense3:n("dense3")};return sl(e,t),{params:r,paramMappings:t}}var ej=class extends il{constructor(){super("FaceFeatureExtractor")}forwardInput(e){let{params:t}=this;if(!t)throw new Error("FaceFeatureExtractor - load model before inference");return K(()=>{let n=de(e.toBatchTensor(112,!0),"float32"),r=iy(n,[122.782,117.001,104.298]).div(255),a=nb(r,t.dense0,!0);return a=nb(a,t.dense1),a=nb(a,t.dense2),a=nb(a,t.dense3),a=Ws(a,[7,7],[2,2],"valid"),a})}async forward(e){return this.forwardInput(await Nr(e))}getDefaultModelName(){return"face_feature_extractor_model"}extractParamsFromWeightMap(e){return ZMe(e)}extractParams(e){return YMe(e)}};function KS(e,t){return K(()=>ne(Ke(e,t.weights),t.bias))}function QMe(e,t,n){let r=[],{extractWeights:a,getRemainingWeights:i}=ol(e),s=XH(a,r)(t,n,"fc");if(i().length!==0)throw new Error("weights remaing after extract: ".concat(i().length));return{paramMappings:r,params:{fc:s}}}function JMe(e){let t=[],n=Yc(e,t);function r(i){let s=n("".concat(i,"/weights"),2),o=n("".concat(i,"/bias"),1);return{weights:s,bias:o}}let a={fc:r("fc")};return sl(e,t),{params:a,paramMappings:t}}function tj(e){let t={},n={};return Object.keys(e).forEach(r=>{let a=r.startsWith("fc")?n:t;a[r]=e[r]}),{featureExtractorMap:t,classifierMap:n}}var nj=class extends il{constructor(e,t){super(e),this._faceFeatureExtractor=t}get faceFeatureExtractor(){return this._faceFeatureExtractor}runNet(e){let{params:t}=this;if(!t)throw new Error("".concat(this._name," - load model before inference"));return K(()=>{let n=e instanceof Xv?this.faceFeatureExtractor.forwardInput(e):e;return KS(n.as2D(n.shape[0],-1),t.fc)})}dispose(e=!0){this.faceFeatureExtractor.dispose(e),super.dispose(e)}loadClassifierParams(e){let{params:t,paramMappings:n}=this.extractClassifierParams(e);this._params=t,this._paramMappings=n}extractClassifierParams(e){return QMe(e,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())}extractParamsFromWeightMap(e){let{featureExtractorMap:t,classifierMap:n}=tj(e);return this.faceFeatureExtractor.loadFromWeightMap(t),JMe(n)}extractParams(e){let t=this.getClassifierChannelsIn(),n=this.getClassifierChannelsOut(),r=n*t+n,a=e.slice(0,e.length-r),i=e.slice(e.length-r);return this.faceFeatureExtractor.extractWeights(a),this.extractClassifierParams(i)}},_D=["neutral","happy","sad","angry","fearful","disgusted","surprised"],FT=class{constructor(e){if(this.neutral=0,this.happy=0,this.sad=0,this.angry=0,this.fearful=0,this.disgusted=0,this.surprised=0,e.length!==7)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: ".concat(e.length));_D.forEach((t,n)=>{this[t]=e[n]})}asSortedArray(){return _D.map(e=>({expression:e,probability:this[e]})).sort((e,t)=>t.probability-e.probability)}},eOe=class extends nj{constructor(e=new ej){super("FaceExpressionNet",e)}forwardInput(e){return K(()=>Jo(this.runNet(e)))}async forward(e){return this.forwardInput(await Nr(e))}async predictExpressions(e){let t=await Nr(e),n=await this.forwardInput(t),r=await Promise.all(en(n).map(async i=>{let s=i.dataSync();return i.dispose(),s}));n.dispose();let a=r.map(i=>new FT(i));return t.isBatchInput?a:a[0]}getDefaultModelName(){return"face_expression_model"}getClassifierChannelsIn(){return 256}getClassifierChannelsOut(){return 7}};function tOe(e){return e.expressions instanceof FT}function rj(e,t){return{...e,expressions:t}}function nOe(e,t,n=.1,r){(Array.isArray(t)?t:[t]).forEach(a=>{let i=a instanceof FT?a:tOe(a)?a.expressions:void 0;if(!i)throw new Error("drawFaceExpressions - expected faceExpressions to be FaceExpressions | WithFaceExpressions<{}> or array thereof");let s=i.asSortedArray().filter(l=>l.probability>n),o=Bm(a)?a.detection.box.bottomLeft:r||new ot(0,0);new yw(s.map(l=>"".concat(l.expression," (").concat(gw(l.probability),")")),o).draw(e)})}function MT(e){return Bm(e)&&e.landmarks instanceof zm&&e.unshiftedLandmarks instanceof zm&&e.alignedRect instanceof Fa}function rOe(e){let t=l=>l*180/Math.PI,n=(l,c)=>Math.sqrt((l._x-c._x)**2+(l._y-c._y)**2),r={roll:void 0,pitch:void 0,yaw:void 0},a=(l,c,u)=>{let d=Math.floor(l._x-c._x),p=Math.floor(c._x-u._x);return d-p},i=(l,c)=>{let u=Math.hypot(c._x-l._x,c._y-l._y),d=c._y-l._y,p=Math.asin(d/u),h=t(p),f=Math.floor(90-h),m=c._x-l._x<0?-1:1;return f*m},s=(l,c,u)=>{let d=n(l,u),p={_x:(l._x+u._x)/2,_y:(l._y+u._y)/2},h=n(c,p),f=Math.atan(h/d),m=Math.floor(t(f)),g=p._y-c._y<0?-1:1;return m*g};if(!e||!e._positions||e._positions.length!==68)return r;let o=e._positions;return r.roll=i(o[27],o[66]),r.pitch=s(o[14],o[30],o[2]),r.yaw=a(o[14],o[33],o[2]),r}function OT(e,t){let{box:n}=e.detection,r=t.shiftBy(n.x,n.y),a=r.align(),{imageDims:i}=e.detection,s=new Fa(e.detection.score,a.rescale(i.reverse()),i),o=rOe(t);return{...e,landmarks:r,unshiftedLandmarks:t,alignedRect:s,angle:o}}var aj=class{constructor(e={}){let{drawLines:t=!0,drawPoints:n=!0,lineWidth:r,lineColor:a,pointSize:i,pointColor:s}=e;this.drawLines=t,this.drawPoints=n,this.lineWidth=r||1,this.pointSize=i||2,this.lineColor=a||"rgba(0, 255, 255, 1)",this.pointColor=s||"rgba(255, 0, 255, 1)"}},ij=class{constructor(e,t={}){this.faceLandmarks=e,this.options=new aj(t)}draw(e){let t=Wo(e),{drawLines:n,drawPoints:r,lineWidth:a,lineColor:i,pointSize:s,pointColor:o}=this.options;if(n&&this.faceLandmarks instanceof MH&&(t.strokeStyle=i,t.lineWidth=a,Qs(t,this.faceLandmarks.getJawOutline()),Qs(t,this.faceLandmarks.getLeftEyeBrow()),Qs(t,this.faceLandmarks.getRightEyeBrow()),Qs(t,this.faceLandmarks.getNose()),Qs(t,this.faceLandmarks.getLeftEye(),!0),Qs(t,this.faceLandmarks.getRightEye(),!0),Qs(t,this.faceLandmarks.getMouth(),!0)),r){t.strokeStyle=o,t.fillStyle=o;let l=c=>{t.beginPath(),t.arc(c.x,c.y,s,0,2*Math.PI),t.fill()};this.faceLandmarks.positions.forEach(l)}}};function aOe(e,t){(Array.isArray(t)?t:[t]).forEach(n=>{let r=n instanceof zm?n:MT(n)?n.landmarks:void 0;if(!r)throw new Error("drawFaceLandmarks - expected faceExpressions to be FaceLandmarks | WithFaceLandmarks<WithFaceDetection<{}>> or array thereof");new ij(r).draw(e)})}function iOe(e,t){let n=AT(e,t),r=RT(e,t);function a(s,o,l){let c=r(s,o,"".concat(l,"/separable_conv0")),u=r(o,o,"".concat(l,"/separable_conv1")),d=n(s,o,1,"".concat(l,"/expansion_conv"));return{separable_conv0:c,separable_conv1:u,expansion_conv:d}}function i(s,o){let l=r(s,s,"".concat(o,"/separable_conv0")),c=r(s,s,"".concat(o,"/separable_conv1")),u=r(s,s,"".concat(o,"/separable_conv2"));return{separable_conv0:l,separable_conv1:c,separable_conv2:u}}return{extractConvParams:n,extractSeparableConvParams:r,extractReductionBlockParams:a,extractMainBlockParams:i}}function sOe(e,t){let n=[],{extractWeights:r,getRemainingWeights:a}=ol(e),{extractConvParams:i,extractSeparableConvParams:s,extractReductionBlockParams:o,extractMainBlockParams:l}=iOe(r,n),c=i(3,32,3,"entry_flow/conv_in"),u=o(32,64,"entry_flow/reduction_block_0"),d=o(64,128,"entry_flow/reduction_block_1"),p={conv_in:c,reduction_block_0:u,reduction_block_1:d},h={};kp(t,0,1).forEach(y=>{h["main_block_".concat(y)]=l(128,"middle_flow/main_block_".concat(y))});let f=o(128,256,"exit_flow/reduction_block"),m=s(256,512,"exit_flow/separable_conv"),g={reduction_block:f,separable_conv:m};if(a().length!==0)throw new Error("weights remaing after extract: ".concat(a().length));return{paramMappings:n,params:{entry_flow:p,middle_flow:h,exit_flow:g}}}function oOe(e,t){let n=Yc(e,t),r=QH(n),a=DT(n);function i(o){let l=a("".concat(o,"/separable_conv0")),c=a("".concat(o,"/separable_conv1")),u=r("".concat(o,"/expansion_conv"));return{separable_conv0:l,separable_conv1:c,expansion_conv:u}}function s(o){let l=a("".concat(o,"/separable_conv0")),c=a("".concat(o,"/separable_conv1")),u=a("".concat(o,"/separable_conv2"));return{separable_conv0:l,separable_conv1:c,separable_conv2:u}}return{extractConvParams:r,extractSeparableConvParams:a,extractReductionBlockParams:i,extractMainBlockParams:s}}function lOe(e,t){let n=[],{extractConvParams:r,extractSeparableConvParams:a,extractReductionBlockParams:i,extractMainBlockParams:s}=oOe(e,n),o=r("entry_flow/conv_in"),l=i("entry_flow/reduction_block_0"),c=i("entry_flow/reduction_block_1"),u={conv_in:o,reduction_block_0:l,reduction_block_1:c},d={};kp(t,0,1).forEach(m=>{d["main_block_".concat(m)]=s("middle_flow/main_block_".concat(m))});let p=i("exit_flow/reduction_block"),h=a("exit_flow/separable_conv"),f={reduction_block:p,separable_conv:h};return sl(e,n),{params:{entry_flow:u,middle_flow:d,exit_flow:f},paramMappings:n}}function sj(e,t,n){return ne($r(e,t.filters,n,"same"),t.bias)}function R1(e,t,n=!0){let r=n?ft(e):e;return r=Ta(r,t.separable_conv0,[1,1]),r=Ta(ft(r),t.separable_conv1,[1,1]),r=Rn(r,[3,3],[2,2],"same"),r=ne(r,sj(e,t.expansion_conv,[2,2])),r}function uOe(e,t){let n=Ta(ft(e),t.separable_conv0,[1,1]);return n=Ta(ft(n),t.separable_conv1,[1,1]),n=Ta(ft(n),t.separable_conv2,[1,1]),n=ne(n,e),n}var cOe=class extends il{constructor(e){super("TinyXception"),this._numMainBlocks=e}forwardInput(e){let{params:t}=this;if(!t)throw new Error("TinyXception - load model before inference");return K(()=>{let n=de(e.toBatchTensor(112,!0),"float32"),r=iy(n,[122.782,117.001,104.298]).div(255),a=ft(sj(r,t.entry_flow.conv_in,[2,2]));return a=R1(a,t.entry_flow.reduction_block_0,!1),a=R1(a,t.entry_flow.reduction_block_1),kp(this._numMainBlocks,0,1).forEach(i=>{a=uOe(a,t.middle_flow["main_block_".concat(i)])}),a=R1(a,t.exit_flow.reduction_block),a=ft(Ta(a,t.exit_flow.separable_conv,[1,1])),a})}async forward(e){return this.forwardInput(await Nr(e))}getDefaultModelName(){return"tiny_xception_model"}extractParamsFromWeightMap(e){return lOe(e,this._numMainBlocks)}extractParams(e){return sOe(e,this._numMainBlocks)}};function dOe(e){let t=[],{extractWeights:n,getRemainingWeights:r}=ol(e),a=XH(n,t),i=a(512,1,"fc/age"),s=a(512,2,"fc/gender");if(r().length!==0)throw new Error("weights remaing after extract: ".concat(r().length));return{paramMappings:t,params:{fc:{age:i,gender:s}}}}function pOe(e){let t=[],n=Yc(e,t);function r(i){let s=n("".concat(i,"/weights"),2),o=n("".concat(i,"/bias"),1);return{weights:s,bias:o}}let a={fc:{age:r("fc/age"),gender:r("fc/gender")}};return sl(e,t),{params:a,paramMappings:t}}var hOe=(e=>(e.FEMALE="female",e.MALE="male",e))(hOe||{}),fOe=class extends il{constructor(e=new cOe(2)){super("AgeGenderNet"),this._faceFeatureExtractor=e}get faceFeatureExtractor(){return this._faceFeatureExtractor}runNet(e){let{params:t}=this;if(!t)throw new Error("".concat(this._name," - load model before inference"));return K(()=>{let n=e instanceof Xv?this.faceFeatureExtractor.forwardInput(e):e,r=Ws(n,[7,7],[2,2],"valid").as2D(n.shape[0],-1),a=KS(r,t.fc.age).as1D(),i=KS(r,t.fc.gender);return{age:a,gender:i}})}forwardInput(e){return K(()=>{let{age:t,gender:n}=this.runNet(e);return{age:t,gender:Jo(n)}})}async forward(e){return this.forwardInput(await Nr(e))}async predictAgeAndGender(e){let t=await Nr(e),n=await this.forwardInput(t),r=en(n.age),a=en(n.gender),i=r.map((o,l)=>({ageTensor:o,genderTensor:a[l]})),s=await Promise.all(i.map(async({ageTensor:o,genderTensor:l})=>{let c=o.dataSync()[0],u=l.dataSync()[0],d=u>.5,p=d?"male":"female",h=d?u:1-u;return o.dispose(),l.dispose(),{age:c,gender:p,genderProbability:h}}));return n.age.dispose(),n.gender.dispose(),t.isBatchInput?s:s[0]}getDefaultModelName(){return"age_gender_model"}dispose(e=!0){this.faceFeatureExtractor.dispose(e),super.dispose(e)}loadClassifierParams(e){let{params:t,paramMappings:n}=this.extractClassifierParams(e);this._params=t,this._paramMappings=n}extractClassifierParams(e){return dOe(e)}extractParamsFromWeightMap(e){let{featureExtractorMap:t,classifierMap:n}=tj(e);return this.faceFeatureExtractor.loadFromWeightMap(t),pOe(n)}extractParams(e){let t=e.slice(0,e.length-1539),n=e.slice(e.length-1539);return this.faceFeatureExtractor.extractWeights(t),this.extractClassifierParams(n)}},oj=class extends nj{postProcess(e,t,n){let r=n.map(({width:i,height:s})=>{let o=t/Math.max(s,i);return{width:i*o,height:s*o}}),a=r.length;return K(()=>{let i=(c,u)=>Sn([da([68],c,"float32"),da([68],u,"float32")],1).as2D(1,136).as1D(),s=(c,u)=>{let{width:d,height:p}=r[c];return u(d,p)?Math.abs(d-p)/2:0},o=c=>s(c,(u,d)=>u<d),l=c=>s(c,(u,d)=>d<u);return e.mul(da([a,136],t,"float32")).sub(Sn(Array.from(Array(a),(c,u)=>i(o(u),l(u))))).div(Sn(Array.from(Array(a),(c,u)=>i(r[u].width,r[u].height))))})}forwardInput(e){return K(()=>{let t=this.runNet(e);return this.postProcess(t,e.inputSize,e.inputDimensions.map(([n,r])=>({height:n,width:r})))})}async forward(e){return this.forwardInput(await Nr(e))}async detectLandmarks(e){let t=await Nr(e),n=K(()=>en(this.forwardInput(t))),r=await Promise.all(n.map(async(a,i)=>{let s=Array.from(a.dataSync()),o=s.filter((c,u)=>jS(u)),l=s.filter((c,u)=>!jS(u));return new MH(Array(68).fill(0).map((c,u)=>new ot(o[u],l[u])),{height:t.getInputHeight(i),width:t.getInputWidth(i)})}));return n.forEach(a=>a.dispose()),t.isBatchInput?r:r[0]}getClassifierChannelsOut(){return 136}},mOe=class extends oj{constructor(e=new ej){super("FaceLandmark68Net",e)}getDefaultModelName(){return"face_landmark_68_model"}getClassifierChannelsIn(){return 256}};function gOe(e){let t=[],{extractDenseBlock3Params:n}=JH(e,t),r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2")};return sl(e,t),{params:r,paramMappings:t}}function yOe(e){let t=[],{extractWeights:n,getRemainingWeights:r}=ol(e),{extractDenseBlock3Params:a}=ZH(n,t),i=a(3,32,"dense0",!0),s=a(32,64,"dense1"),o=a(64,128,"dense2");if(r().length!==0)throw new Error("weights remaing after extract: ".concat(r().length));return{paramMappings:t,params:{dense0:i,dense1:s,dense2:o}}}var bOe=class extends il{constructor(){super("TinyFaceFeatureExtractor")}forwardInput(e){let{params:t}=this;if(!t)throw new Error("TinyFaceFeatureExtractor - load model before inference");return K(()=>{let n=de(e.toBatchTensor(112,!0),"float32"),r=iy(n,[122.782,117.001,104.298]).div(255),a=A1(r,t.dense0,!0);return a=A1(a,t.dense1),a=A1(a,t.dense2),a=Ws(a,[14,14],[2,2],"valid"),a})}async forward(e){return this.forwardInput(await Nr(e))}getDefaultModelName(){return"face_feature_extractor_tiny_model"}extractParamsFromWeightMap(e){return gOe(e)}extractParams(e){return yOe(e)}},vOe=class extends oj{constructor(e=new bOe){super("FaceLandmark68TinyNet",e)}getDefaultModelName(){return"face_landmark_68_tiny_model"}getClassifierChannelsIn(){return 128}};function xOe(e,t){return ne(G(e,t.weights),t.biases)}function LT(e,t,n,r,a="same"){let{filters:i,bias:s}=t.conv,o=$r(e,i,n,a);return o=ne(o,s),o=xOe(o,t.scale),r?ft(o):o}function wOe(e,t){return LT(e,t,[1,1],!0)}function lj(e,t){return LT(e,t,[1,1],!1)}function uj(e,t){return LT(e,t,[2,2],!0,"valid")}function kOe(e,t){function n(o,l,c){let u=e(o),d=u.length/(l*c*c);if(AH(d))throw new Error("depth has to be an integer: ".concat(d,", weights.length: ").concat(u.length,", numFilters: ").concat(l,", filterSize: ").concat(c));return K(()=>Ye(Fo(u,[l,d,c,c]),[2,3,1,0]))}function r(o,l,c,u){let d=n(o,l,c),p=ht(e(l));return t.push({paramPath:"".concat(u,"/filters")},{paramPath:"".concat(u,"/bias")}),{filters:d,bias:p}}function a(o,l){let c=ht(e(o)),u=ht(e(o));return t.push({paramPath:"".concat(l,"/weights")},{paramPath:"".concat(l,"/biases")}),{weights:c,biases:u}}function i(o,l,c,u){let d=r(o,l,c,"".concat(u,"/conv")),p=a(l,"".concat(u,"/scale"));return{conv:d,scale:p}}function s(o,l,c,u,d=!1){let p=i((d?.5:1)*o,l,c,"".concat(u,"/conv1")),h=i(o,l,c,"".concat(u,"/conv2"));return{conv1:p,conv2:h}}return{extractConvLayerParams:i,extractResidualLayerParams:s}}function SOe(e){let{extractWeights:t,getRemainingWeights:n}=ol(e),r=[],{extractConvLayerParams:a,extractResidualLayerParams:i}=kOe(t,r),s=a(4704,32,7,"conv32_down"),o=i(9216,32,3,"conv32_1"),l=i(9216,32,3,"conv32_2"),c=i(9216,32,3,"conv32_3"),u=i(36864,64,3,"conv64_down",!0),d=i(36864,64,3,"conv64_1"),p=i(36864,64,3,"conv64_2"),h=i(36864,64,3,"conv64_3"),f=i(147456,128,3,"conv128_down",!0),m=i(147456,128,3,"conv128_1"),g=i(147456,128,3,"conv128_2"),y=i(589824,256,3,"conv256_down",!0),b=i(589824,256,3,"conv256_1"),v=i(589824,256,3,"conv256_2"),x=i(589824,256,3,"conv256_down_out"),w=K(()=>Ye(ts(t(256*128),[128,256]),[1,0]));if(r.push({paramPath:"fc"}),n().length!==0)throw new Error("weights remaing after extract: ".concat(n().length));return{params:{conv32_down:s,conv32_1:o,conv32_2:l,conv32_3:c,conv64_down:u,conv64_1:d,conv64_2:p,conv64_3:h,conv128_down:f,conv128_1:m,conv128_2:g,conv256_down:y,conv256_1:b,conv256_2:v,conv256_down_out:x,fc:w},paramMappings:r}}function IOe(e,t){let n=Yc(e,t);function r(s){let o=n("".concat(s,"/scale/weights"),1),l=n("".concat(s,"/scale/biases"),1);return{weights:o,biases:l}}function a(s){let o=n("".concat(s,"/conv/filters"),4),l=n("".concat(s,"/conv/bias"),1),c=r(s);return{conv:{filters:o,bias:l},scale:c}}function i(s){return{conv1:a("".concat(s,"/conv1")),conv2:a("".concat(s,"/conv2"))}}return{extractConvLayerParams:a,extractResidualLayerParams:i}}function $Oe(e){let t=[],{extractConvLayerParams:n,extractResidualLayerParams:r}=IOe(e,t),a=n("conv32_down"),i=r("conv32_1"),s=r("conv32_2"),o=r("conv32_3"),l=r("conv64_down"),c=r("conv64_1"),u=r("conv64_2"),d=r("conv64_3"),p=r("conv128_down"),h=r("conv128_1"),f=r("conv128_2"),m=r("conv256_down"),g=r("conv256_1"),y=r("conv256_2"),b=r("conv256_down_out"),{fc:v}=e;if(t.push({originalPath:"fc",paramPath:"fc"}),!_H(v))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have ".concat(v));let x={conv32_down:a,conv32_1:i,conv32_2:s,conv32_3:o,conv64_down:l,conv64_1:c,conv64_2:u,conv64_3:d,conv128_down:p,conv128_1:h,conv128_2:f,conv256_down:m,conv256_1:g,conv256_2:y,conv256_down_out:b,fc:v};return sl(e,t),{params:x,paramMappings:t}}function Vi(e,t){let n=wOe(e,t.conv1);return n=lj(n,t.conv2),n=ne(n,e),n=ft(n),n}function rb(e,t){let n=uj(e,t.conv1);n=lj(n,t.conv2);let r=Ws(e,2,2,"valid"),a=qt(r.shape),i=r.shape[3]!==n.shape[3];if(r.shape[1]!==n.shape[1]||r.shape[2]!==n.shape[2]){let s=[...n.shape];s[1]=1;let o=qt(s);n=wt([n,o],1);let l=[...n.shape];l[2]=1;let c=qt(l);n=wt([n,c],2)}return r=i?wt([r,a],3):r,n=ne(r,n),n=ft(n),n}var COe=class extends il{constructor(){super("FaceRecognitionNet")}forwardInput(e){let{params:t}=this;if(!t)throw new Error("FaceRecognitionNet - load model before inference");return K(()=>{let n=de(e.toBatchTensor(150,!0),"float32"),r=iy(n,[122.782,117.001,104.298]).div(255),a=uj(r,t.conv32_down);a=Rn(a,3,2,"valid"),a=Vi(a,t.conv32_1),a=Vi(a,t.conv32_2),a=Vi(a,t.conv32_3),a=rb(a,t.conv64_down),a=Vi(a,t.conv64_1),a=Vi(a,t.conv64_2),a=Vi(a,t.conv64_3),a=rb(a,t.conv128_down),a=Vi(a,t.conv128_1),a=Vi(a,t.conv128_2),a=rb(a,t.conv256_down),a=Vi(a,t.conv256_1),a=Vi(a,t.conv256_2),a=rb(a,t.conv256_down_out);let i=a.mean([1,2]);return Ke(i,t.fc)})}async forward(e){return this.forwardInput(await Nr(e))}async computeFaceDescriptor(e){var t;if((t=e==null?void 0:e.shape)!=null&&t.some(i=>i<=0))return new Float32Array(128);let n=await Nr(e),r=K(()=>en(this.forwardInput(n))),a=await Promise.all(r.map(i=>i.data()));return r.forEach(i=>i.dispose()),n.isBatchInput?a:a[0]}getDefaultModelName(){return"face_recognition_model"}extractParamsFromWeightMap(e){return $Oe(e)}extractParams(e){return SOe(e)}};function cj(e,t){return{...e,descriptor:t}}function dj(e,t){return{...e,age:t}}function pj(e,t,n){return{...e,gender:t,genderProbability:n}}function EOe(e,t){function n(l,c){let u=Fo(e(9*l),[3,3,l,1]),d=ht(e(l)),p=ht(e(l)),h=ht(e(l)),f=ht(e(l));return t.push({paramPath:"".concat(c,"/filters")},{paramPath:"".concat(c,"/batch_norm_scale")},{paramPath:"".concat(c,"/batch_norm_offset")},{paramPath:"".concat(c,"/batch_norm_mean")},{paramPath:"".concat(c,"/batch_norm_variance")}),{filters:u,batch_norm_scale:d,batch_norm_offset:p,batch_norm_mean:h,batch_norm_variance:f}}function r(l,c,u,d,p){let h=Fo(e(l*c*u*u),[u,u,l,c]),f=ht(e(c));return t.push({paramPath:"".concat(d,"/filters")},{paramPath:"".concat(d,"/").concat(p?"batch_norm_offset":"bias")}),{filters:h,bias:f}}function a(l,c,u,d){let{filters:p,bias:h}=r(l,c,u,d,!0);return{filters:p,batch_norm_offset:h}}function i(l,c,u){let d=n(l,"".concat(u,"/depthwise_conv")),p=a(l,c,1,"".concat(u,"/pointwise_conv"));return{depthwise_conv:d,pointwise_conv:p}}function s(){let l=a(3,32,3,"mobilenetv1/conv_0"),c=i(32,64,"mobilenetv1/conv_1"),u=i(64,128,"mobilenetv1/conv_2"),d=i(128,128,"mobilenetv1/conv_3"),p=i(128,256,"mobilenetv1/conv_4"),h=i(256,256,"mobilenetv1/conv_5"),f=i(256,512,"mobilenetv1/conv_6"),m=i(512,512,"mobilenetv1/conv_7"),g=i(512,512,"mobilenetv1/conv_8"),y=i(512,512,"mobilenetv1/conv_9"),b=i(512,512,"mobilenetv1/conv_10"),v=i(512,512,"mobilenetv1/conv_11"),x=i(512,1024,"mobilenetv1/conv_12"),w=i(1024,1024,"mobilenetv1/conv_13");return{conv_0:l,conv_1:c,conv_2:u,conv_3:d,conv_4:p,conv_5:h,conv_6:f,conv_7:m,conv_8:g,conv_9:y,conv_10:b,conv_11:v,conv_12:x,conv_13:w}}function o(){let l=a(1024,256,1,"prediction_layer/conv_0"),c=a(256,512,3,"prediction_layer/conv_1"),u=a(512,128,1,"prediction_layer/conv_2"),d=a(128,256,3,"prediction_layer/conv_3"),p=a(256,128,1,"prediction_layer/conv_4"),h=a(128,256,3,"prediction_layer/conv_5"),f=a(256,64,1,"prediction_layer/conv_6"),m=a(64,128,3,"prediction_layer/conv_7"),g=r(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),y=r(512,9,1,"prediction_layer/box_predictor_0/class_predictor"),b=r(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),v=r(1024,18,1,"prediction_layer/box_predictor_1/class_predictor"),x=r(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),w=r(512,18,1,"prediction_layer/box_predictor_2/class_predictor"),$=r(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),C=r(256,18,1,"prediction_layer/box_predictor_3/class_predictor"),E=r(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),_=r(256,18,1,"prediction_layer/box_predictor_4/class_predictor"),R=r(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),N=r(128,18,1,"prediction_layer/box_predictor_5/class_predictor");return{conv_0:l,conv_1:c,conv_2:u,conv_3:d,conv_4:p,conv_5:h,conv_6:f,conv_7:m,box_predictor_0:{box_encoding_predictor:g,class_predictor:y},box_predictor_1:{box_encoding_predictor:b,class_predictor:v},box_predictor_2:{box_encoding_predictor:x,class_predictor:w},box_predictor_3:{box_encoding_predictor:$,class_predictor:C},box_predictor_4:{box_encoding_predictor:E,class_predictor:_},box_predictor_5:{box_encoding_predictor:R,class_predictor:N}}}return{extractMobilenetV1Params:s,extractPredictionLayerParams:o}}function TOe(e){let t=[],{extractWeights:n,getRemainingWeights:r}=ol(e),{extractMobilenetV1Params:a,extractPredictionLayerParams:i}=EOe(n,t),s=a(),o=i(),l={extra_dim:Rx(n(5118*4),[1,5118,4])};if(t.push({paramPath:"output_layer/extra_dim"}),r().length!==0)throw new Error("weights remaing after extract: ".concat(r().length));return{params:{mobilenetv1:s,prediction_layer:o,output_layer:l},paramMappings:t}}function NOe(e,t){let n=Yc(e,t);function r(c,u,d){let p=n("".concat(c,"/Conv2d_").concat(u,"_pointwise/weights"),4,"".concat(d,"/filters")),h=n("".concat(c,"/Conv2d_").concat(u,"_pointwise/convolution_bn_offset"),1,"".concat(d,"/batch_norm_offset"));return{filters:p,batch_norm_offset:h}}function a(c){let u="mobilenetv1/conv_".concat(c),d="MobilenetV1/Conv2d_".concat(c,"_depthwise"),p="".concat(u,"/depthwise_conv"),h="".concat(u,"/pointwise_conv"),f=n("".concat(d,"/depthwise_weights"),4,"".concat(p,"/filters")),m=n("".concat(d,"/BatchNorm/gamma"),1,"".concat(p,"/batch_norm_scale")),g=n("".concat(d,"/BatchNorm/beta"),1,"".concat(p,"/batch_norm_offset")),y=n("".concat(d,"/BatchNorm/moving_mean"),1,"".concat(p,"/batch_norm_mean")),b=n("".concat(d,"/BatchNorm/moving_variance"),1,"".concat(p,"/batch_norm_variance"));return{depthwise_conv:{filters:f,batch_norm_scale:m,batch_norm_offset:g,batch_norm_mean:y,batch_norm_variance:b},pointwise_conv:r("MobilenetV1",c,h)}}function i(){return{conv_0:r("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:a(1),conv_2:a(2),conv_3:a(3),conv_4:a(4),conv_5:a(5),conv_6:a(6),conv_7:a(7),conv_8:a(8),conv_9:a(9),conv_10:a(10),conv_11:a(11),conv_12:a(12),conv_13:a(13)}}function s(c,u){let d=n("".concat(c,"/weights"),4,"".concat(u,"/filters")),p=n("".concat(c,"/biases"),1,"".concat(u,"/bias"));return{filters:d,bias:p}}function o(c){let u=s("Prediction/BoxPredictor_".concat(c,"/BoxEncodingPredictor"),"prediction_layer/box_predictor_".concat(c,"/box_encoding_predictor")),d=s("Prediction/BoxPredictor_".concat(c,"/ClassPredictor"),"prediction_layer/box_predictor_".concat(c,"/class_predictor"));return{box_encoding_predictor:u,class_predictor:d}}function l(){return{conv_0:r("Prediction",0,"prediction_layer/conv_0"),conv_1:r("Prediction",1,"prediction_layer/conv_1"),conv_2:r("Prediction",2,"prediction_layer/conv_2"),conv_3:r("Prediction",3,"prediction_layer/conv_3"),conv_4:r("Prediction",4,"prediction_layer/conv_4"),conv_5:r("Prediction",5,"prediction_layer/conv_5"),conv_6:r("Prediction",6,"prediction_layer/conv_6"),conv_7:r("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:o(0),box_predictor_1:o(1),box_predictor_2:o(2),box_predictor_3:o(3),box_predictor_4:o(4),box_predictor_5:o(5)}}return{extractMobilenetV1Params:i,extractPredictionLayerParams:l}}function _Oe(e){let t=[],{extractMobilenetV1Params:n,extractPredictionLayerParams:r}=NOe(e,t),a=e["Output/extra_dim"];if(t.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!ay(a))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have ".concat(a));let i={mobilenetv1:n(),prediction_layer:r(),output_layer:{extra_dim:a}};return sl(e,t),{params:i,paramMappings:t}}function Gi(e,t,n){return K(()=>{let r=$r(e,t.filters,n,"same");return r=ne(r,t.batch_norm_offset),lr(r,0,6)})}var AOe=.0010000000474974513;function ROe(e,t,n){return K(()=>{let r=Bc(e,t.filters,n,"same");return r=zc(r,t.batch_norm_mean,t.batch_norm_variance,t.batch_norm_offset,t.batch_norm_scale,AOe),lr(r,0,6)})}function DOe(e){return[2,4,6,12].some(t=>t===e)?[2,2]:[1,1]}function FOe(e,t){return K(()=>{let n,r=Gi(e,t.conv_0,[2,2]);if([t.conv_1,t.conv_2,t.conv_3,t.conv_4,t.conv_5,t.conv_6,t.conv_7,t.conv_8,t.conv_9,t.conv_10,t.conv_11,t.conv_12,t.conv_13].forEach((a,i)=>{let s=i+1,o=DOe(s);r=ROe(r,a.depthwise_conv,o),r=Gi(r,a.pointwise_conv,[1,1]),s===11&&(n=r)}),n===null)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:r,conv11:n}})}function MOe(e,t,n){let r=e.arraySync(),a=Math.min(r[t][0],r[t][2]),i=Math.min(r[t][1],r[t][3]),s=Math.max(r[t][0],r[t][2]),o=Math.max(r[t][1],r[t][3]),l=Math.min(r[n][0],r[n][2]),c=Math.min(r[n][1],r[n][3]),u=Math.max(r[n][0],r[n][2]),d=Math.max(r[n][1],r[n][3]),p=(s-a)*(o-i),h=(u-l)*(d-c);if(p<=0||h<=0)return 0;let f=Math.max(a,l),m=Math.max(i,c),g=Math.min(s,u),y=Math.min(o,d),b=Math.max(g-f,0)*Math.max(y-m,0);return b/(p+h-b)}function OOe(e,t,n,r,a){let i=e.shape[0],s=Math.min(n,i),o=t.map((u,d)=>({score:u,boxIndex:d})).filter(u=>u.score>a).sort((u,d)=>d.score-u.score),l=u=>u<=r?1:0,c=[];return o.forEach(u=>{if(c.length>=s)return;let d=u.score;for(let p=c.length-1;p>=0;--p){let h=MOe(e,u.boxIndex,c[p]);if(h!==0&&(u.score*=l(h),u.score<=a))break}d===u.score&&c.push(u.boxIndex)}),c}function LOe(e){let t=en(Ye(e,[1,0])),n=[xe(t[2],t[0]),xe(t[3],t[1])],r=[ne(t[0],ke(n[0],2)),ne(t[1],ke(n[1],2))];return{sizes:n,centers:r}}function POe(e,t){let{sizes:n,centers:r}=LOe(e),a=en(Ye(t,[1,0])),i=ke(G(Cr(ke(a[2],5)),n[0]),2),s=ne(G(ke(a[0],10),n[0]),r[0]),o=ke(G(Cr(ke(a[3],5)),n[1]),2),l=ne(G(ke(a[1],10),n[1]),r[1]);return Ye(Sn([xe(s,i),xe(l,o),ne(s,i),ne(l,o)]),[1,0])}function zOe(e,t,n){return K(()=>{let r=e.shape[0],a=POe(q(sa(n.extra_dim,[r,1,1]),[-1,4]),q(e,[-1,4]));a=q(a,[r,a.shape[0]/r,4]);let i=Qa(et(t,[0,0,1],[-1,-1,-1])),s=et(i,[0,0,0],[-1,-1,1]);s=q(s,[r,s.shape[1]]);let o=en(a),l=en(s);return{boxes:o,scores:l}})}function ld(e,t){return K(()=>{let n=e.shape[0],r=q(Yf(e,t.box_encoding_predictor),[n,-1,1,4]),a=q(Yf(e,t.class_predictor),[n,-1,3]);return{boxPredictionEncoding:r,classPrediction:a}})}function BOe(e,t,n){return K(()=>{let r=Gi(e,n.conv_0,[1,1]),a=Gi(r,n.conv_1,[2,2]),i=Gi(a,n.conv_2,[1,1]),s=Gi(i,n.conv_3,[2,2]),o=Gi(s,n.conv_4,[1,1]),l=Gi(o,n.conv_5,[2,2]),c=Gi(l,n.conv_6,[1,1]),u=Gi(c,n.conv_7,[2,2]),d=ld(t,n.box_predictor_0),p=ld(e,n.box_predictor_1),h=ld(a,n.box_predictor_2),f=ld(s,n.box_predictor_3),m=ld(l,n.box_predictor_4),g=ld(u,n.box_predictor_5),y=wt([d.boxPredictionEncoding,p.boxPredictionEncoding,h.boxPredictionEncoding,f.boxPredictionEncoding,m.boxPredictionEncoding,g.boxPredictionEncoding],1),b=wt([d.classPrediction,p.classPrediction,h.classPrediction,f.classPrediction,m.classPrediction,g.classPrediction],1);return{boxPredictions:y,classPredictions:b}})}var sy=class{constructor({minConfidence:e,maxResults:t}={}){if(this._name="SsdMobilenetv1Options",this._minConfidence=e||.5,this._maxResults=t||100,typeof this._minConfidence!="number"||this._minConfidence<=0||this._minConfidence>=1)throw new Error("".concat(this._name," - expected minConfidence to be a number between 0 and 1"));if(typeof this._maxResults!="number")throw new Error("".concat(this._name," - expected maxResults to be a number"))}get minConfidence(){return this._minConfidence}get maxResults(){return this._maxResults}},WOe=class extends il{constructor(){super("SsdMobilenetv1")}forwardInput(e){let{params:t}=this;if(!t)throw new Error("SsdMobilenetv1 - load model before inference");return K(()=>{let n=de(e.toBatchTensor(512,!1),"float32"),r=xe(ke(n,127.5),1),a=FOe(r,t.mobilenetv1),{boxPredictions:i,classPredictions:s}=BOe(a.out,a.conv11,t.prediction_layer);return zOe(i,s,t.output_layer)})}async forward(e){return this.forwardInput(await Nr(e))}async locateFaces(e,t={}){let{maxResults:n,minConfidence:r}=new sy(t),a=await Nr(e),{boxes:i,scores:s}=this.forwardInput(a),o=i[0],l=s[0];for(let y=1;y<i.length;y++)i[y].dispose(),s[y].dispose();let c=Array.from(l.dataSync()),u=OOe(o,c,n,.5,r),d=a.getReshapedInputDimensions(0),p=a.inputSize,h=p/d.width,f=p/d.height,m=o.arraySync(),g=u.map(y=>{let[b,v]=[Math.max(0,m[y][0]),Math.min(1,m[y][2])].map($=>$*f),[x,w]=[Math.max(0,m[y][1]),Math.min(1,m[y][3])].map($=>$*h);return new Fa(c[y],new FH(x,b,w-x,v-b),{height:a.getInputHeight(0),width:a.getInputWidth(0)})});return o.dispose(),l.dispose(),g}getDefaultModelName(){return"ssd_mobilenetv1_model"}extractParamsFromWeightMap(e){return _Oe(e)}extractParams(e){return TOe(e)}},UOe=.4,VOe=[new ot(.738768,.874946),new ot(2.42204,2.65704),new ot(4.30971,7.04493),new ot(10.246,4.59428),new ot(12.6868,11.8741)],HOe=[new ot(1.603231,2.094468),new ot(6.041143,7.080126),new ot(2.882459,3.518061),new ot(4.266906,5.178857),new ot(9.041765,10.66308)],jOe=[117.001,114.697,97.404],GOe="tiny_yolov2_model",qOe="tiny_yolov2_separable_conv_model",ab=e=>typeof e=="number";function KOe(e){if(!e)throw new Error("invalid config: ".concat(e));if(typeof e.withSeparableConvs!="boolean")throw new Error("config.withSeparableConvs has to be a boolean, have: ".concat(e.withSeparableConvs));if(!ab(e.iouThreshold)||e.iouThreshold<0||e.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: ".concat(e.iouThreshold));if(!Array.isArray(e.classes)||!e.classes.length||!e.classes.every(t=>typeof t=="string"))throw new Error("config.classes has to be an array class names: string[], have: ".concat(JSON.stringify(e.classes)));if(!Array.isArray(e.anchors)||!e.anchors.length||!e.anchors.map(t=>t||{}).every(t=>ab(t.x)&&ab(t.y)))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: ".concat(JSON.stringify(e.anchors)));if(e.meanRgb&&(!Array.isArray(e.meanRgb)||e.meanRgb.length!==3||!e.meanRgb.every(ab)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: ".concat(JSON.stringify(e.meanRgb)))}function PT(e){return K(()=>{let t=G(e,Ae(.10000000149011612));return ne(ft(xe(e,t)),t)})}function Xs(e,t){return K(()=>{let n=Oi(e,[[0,0],[1,1],[1,1],[0,0]]);return n=$r(n,t.conv.filters,[1,1],"valid"),n=xe(n,t.bn.sub),n=G(n,t.bn.truediv),n=ne(n,t.conv.bias),PT(n)})}function Ys(e,t){return K(()=>{let n=Oi(e,[[0,0],[1,1],[1,1],[0,0]]);return n=zh(n,t.depthwise_filter,t.pointwise_filter,[1,1],"valid"),n=ne(n,t.bias),PT(n)})}function XOe(e,t){let n=AT(e,t);function r(s,o){let l=ht(e(s)),c=ht(e(s));return t.push({paramPath:"".concat(o,"/sub")},{paramPath:"".concat(o,"/truediv")}),{sub:l,truediv:c}}function a(s,o,l){let c=n(s,o,3,"".concat(l,"/conv")),u=r(o,"".concat(l,"/bn"));return{conv:c,bn:u}}let i=RT(e,t);return{extractConvParams:n,extractConvWithBatchNormParams:a,extractSeparableConvParams:i}}function YOe(e,t,n,r){let{extractWeights:a,getRemainingWeights:i}=ol(e),s=[],{extractConvParams:o,extractConvWithBatchNormParams:l,extractSeparableConvParams:c}=XOe(a,s),u;if(t.withSeparableConvs){let[d,p,h,f,m,g,y,b,v]=r,x=t.isFirstLayerConv2d?o(d,p,3,"conv0"):c(d,p,"conv0"),w=c(p,h,"conv1"),$=c(h,f,"conv2"),C=c(f,m,"conv3"),E=c(m,g,"conv4"),_=c(g,y,"conv5"),R=b?c(y,b,"conv6"):void 0,N=v?c(b,v,"conv7"):void 0,I=o(v||b||y,5*n,1,"conv8");u={conv0:x,conv1:w,conv2:$,conv3:C,conv4:E,conv5:_,conv6:R,conv7:N,conv8:I}}else{let[d,p,h,f,m,g,y,b,v]=r,x=l(d,p,"conv0"),w=l(p,h,"conv1"),$=l(h,f,"conv2"),C=l(f,m,"conv3"),E=l(m,g,"conv4"),_=l(g,y,"conv5"),R=l(y,b,"conv6"),N=l(b,v,"conv7"),I=o(v,5*n,1,"conv8");u={conv0:x,conv1:w,conv2:$,conv3:C,conv4:E,conv5:_,conv6:R,conv7:N,conv8:I}}if(i().length!==0)throw new Error("weights remaing after extract: ".concat(i().length));return{params:u,paramMappings:s}}function ZOe(e,t){let n=Yc(e,t);function r(o){let l=n("".concat(o,"/sub"),1),c=n("".concat(o,"/truediv"),1);return{sub:l,truediv:c}}function a(o){let l=n("".concat(o,"/filters"),4),c=n("".concat(o,"/bias"),1);return{filters:l,bias:c}}function i(o){let l=a("".concat(o,"/conv")),c=r("".concat(o,"/bn"));return{conv:l,bn:c}}let s=DT(n);return{extractConvParams:a,extractConvWithBatchNormParams:i,extractSeparableConvParams:s}}function QOe(e,t){let n=[],{extractConvParams:r,extractConvWithBatchNormParams:a,extractSeparableConvParams:i}=ZOe(e,n),s;if(t.withSeparableConvs){let o=t.filterSizes&&t.filterSizes.length||9;s={conv0:t.isFirstLayerConv2d?r("conv0"):i("conv0"),conv1:i("conv1"),conv2:i("conv2"),conv3:i("conv3"),conv4:i("conv4"),conv5:i("conv5"),conv6:o>7?i("conv6"):void 0,conv7:o>8?i("conv7"):void 0,conv8:r("conv8")}}else s={conv0:a("conv0"),conv1:a("conv1"),conv2:a("conv2"),conv3:a("conv3"),conv4:a("conv4"),conv5:a("conv5"),conv6:a("conv6"),conv7:a("conv7"),conv8:r("conv8")};return sl(e,n),{params:s,paramMappings:n}}var zT=class{constructor({inputSize:e,scoreThreshold:t}={}){if(this._name="TinyYolov2Options",this._inputSize=e||416,this._scoreThreshold=t||.5,typeof this._inputSize!="number"||this._inputSize%32!==0)throw new Error("".concat(this._name," - expected inputSize to be a number divisible by 32"));if(typeof this._scoreThreshold!="number"||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error("".concat(this._name," - expected scoreThreshold to be a number between 0 and 1"))}get inputSize(){return this._inputSize}get scoreThreshold(){return this._scoreThreshold}},hj=class extends il{constructor(e){super("TinyYolov2"),KOe(e),this._config=e}get config(){return this._config}get withClassScores(){return this.config.withClassScores||this.config.classes.length>1}get boxEncodingSize(){return 5+(this.withClassScores?this.config.classes.length:0)}runTinyYolov2(e,t){let n=Xs(e,t.conv0);return n=Rn(n,[2,2],[2,2],"same"),n=Xs(n,t.conv1),n=Rn(n,[2,2],[2,2],"same"),n=Xs(n,t.conv2),n=Rn(n,[2,2],[2,2],"same"),n=Xs(n,t.conv3),n=Rn(n,[2,2],[2,2],"same"),n=Xs(n,t.conv4),n=Rn(n,[2,2],[2,2],"same"),n=Xs(n,t.conv5),n=Rn(n,[2,2],[1,1],"same"),n=Xs(n,t.conv6),n=Xs(n,t.conv7),Yf(n,t.conv8,"valid",!1)}runMobilenet(e,t){let n=this.config.isFirstLayerConv2d?PT(Yf(e,t.conv0,"valid",!1)):Ys(e,t.conv0);return n=Rn(n,[2,2],[2,2],"same"),n=Ys(n,t.conv1),n=Rn(n,[2,2],[2,2],"same"),n=Ys(n,t.conv2),n=Rn(n,[2,2],[2,2],"same"),n=Ys(n,t.conv3),n=Rn(n,[2,2],[2,2],"same"),n=Ys(n,t.conv4),n=Rn(n,[2,2],[2,2],"same"),n=Ys(n,t.conv5),n=Rn(n,[2,2],[1,1],"same"),n=t.conv6?Ys(n,t.conv6):n,n=t.conv7?Ys(n,t.conv7):n,Yf(n,t.conv8,"valid",!1)}forwardInput(e,t){let{params:n}=this;if(!n)throw new Error("TinyYolov2 - load model before inference");return K(()=>{let r=de(e.toBatchTensor(t,!1),"float32");return r=this.config.meanRgb?iy(r,this.config.meanRgb):r,r=r.div(255),this.config.withSeparableConvs?this.runMobilenet(r,n):this.runTinyYolov2(r,n)})}async forward(e,t){return this.forwardInput(await Nr(e),t)}async detect(e,t={}){let{inputSize:n,scoreThreshold:r}=new zT(t),a=await Nr(e),i=await this.forwardInput(a,n),s=K(()=>en(i)[0].expandDims()),o={width:a.getInputWidth(0),height:a.getInputHeight(0)},l=await this.extractBoxes(s,a.getReshapedInputDimensions(0),r);i.dispose(),s.dispose();let c=l.map(h=>h.box),u=l.map(h=>h.score),d=l.map(h=>h.classScore),p=l.map(h=>this.config.classes[h.label]);return OMe(c.map(h=>h.rescale(n)),u,this.config.iouThreshold,!0).map(h=>new ST(u[h],d[h],p[h],c[h],o))}getDefaultModelName(){return""}extractParamsFromWeightMap(e){return QOe(e,this.config)}extractParams(e){let t=this.config.filterSizes||hj.DEFAULT_FILTER_SIZES,n=t?t.length:void 0;if(n!==7&&n!==8&&n!==9)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found ".concat(n," filterSizes in config"));return YOe(e,this.config,this.boxEncodingSize,t)}async extractBoxes(e,t,n){let{width:r,height:a}=t,i=Math.max(r,a),s=i/r,o=i/a,l=e.shape[1],c=this.config.anchors.length,[u,d,p]=K(()=>{let g=e.reshape([l,l,c,this.boxEncodingSize]),y=g.slice([0,0,0,0],[l,l,c,4]),b=g.slice([0,0,0,4],[l,l,c,1]),v=this.withClassScores?Jo(g.slice([0,0,0,5],[l,l,c,this.config.classes.length]),3):Ae(0);return[y,b,v]}),h=[],f=await d.array(),m=await u.array();for(let g=0;g<l;g++)for(let y=0;y<l;y++)for(let b=0;b<c;b++){let v=_1(f[g][y][b][0]);if(!n||v>n){let x=(y+_1(m[g][y][b][0]))/l*s,w=(g+_1(m[g][y][b][1]))/l*o,$=Math.exp(m[g][y][b][2])*this.config.anchors[b].x/l*s,C=Math.exp(m[g][y][b][3])*this.config.anchors[b].y/l*o,E=x-$/2,_=w-C/2,R={row:g,col:y,anchor:b},{classScore:N,label:I}=this.withClassScores?await this.extractPredictedClass(p,R):{classScore:1,label:0};h.push({box:new DH(E,_,E+$,_+C),score:v,classScore:v*N,label:I,...R})}}return u.dispose(),d.dispose(),p.dispose(),h}async extractPredictedClass(e,t){let{row:n,col:r,anchor:a}=t,i=await e.array();return Array(this.config.classes.length).fill(0).map((s,o)=>i[n][r][a][o]).map((s,o)=>({classScore:s,label:o})).reduce((s,o)=>s.classScore>o.classScore?s:o)}},BT=hj;BT.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024];var JOe=class extends BT{constructor(e=!0){let t={withSeparableConvs:e,iouThreshold:UOe,classes:["face"],...e?{anchors:HOe,meanRgb:jOe}:{anchors:VOe,withClassScores:!0}};super(t)}get withSeparableConvs(){return this.config.withSeparableConvs}get anchors(){return this.config.anchors}async locateFaces(e,t){return(await this.detect(e,t)).map(n=>new Fa(n.score,n.relativeBox,{width:n.imageWidth,height:n.imageHeight}))}getDefaultModelName(){return this.withSeparableConvs?qOe:GOe}extractParamsFromWeightMap(e){return super.extractParamsFromWeightMap(e)}},eLe=class extends zT{constructor(){super(...arguments),this._name="TinyFaceDetectorOptions"}},oy=class{async then(e){return e(await this.run())}async run(){throw new Error("ComposableTask - run is not implemented")}};async function bw(e,t,n,r,a=({alignedRect:i})=>i){let i=e.map(l=>MT(l)?a(l):l.detection),s=r||(t instanceof He?await _T(t,i):await NT(t,i)),o=await n(s);return s.forEach(l=>l instanceof He&&l.dispose()),o}async function WT(e,t,n,r,a){return bw([e],t,async i=>n(i[0]),r,a)}var tLe=.4,nLe=[new ot(1.603231,2.094468),new ot(6.041143,7.080126),new ot(2.882459,3.518061),new ot(4.266906,5.178857),new ot(9.041765,10.66308)],rLe=[117.001,114.697,97.404],aLe=class extends BT{constructor(){let e={withSeparableConvs:!0,iouThreshold:tLe,classes:["face"],anchors:nLe,meanRgb:rLe,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};super(e)}get anchors(){return this.config.anchors}async locateFaces(e,t){return(await this.detect(e,t)).map(n=>new Fa(n.score,n.relativeBox,{width:n.imageWidth,height:n.imageHeight}))}getDefaultModelName(){return"tiny_face_detector_model"}extractParamsFromWeightMap(e){return super.extractParamsFromWeightMap(e)}},ir={ssdMobilenetv1:new WOe,tinyFaceDetector:new aLe,tinyYolov2:new JOe,faceLandmark68Net:new mOe,faceLandmark68TinyNet:new vOe,faceRecognitionNet:new COe,faceExpressionNet:new eOe,ageGenderNet:new fOe},fj=class extends oy{constructor(e,t,n){super(),this.parentTask=e,this.input=t,this.extractedFaces=n}},UT=class extends fj{async run(){let e=await this.parentTask,t=await bw(e,this.input,async n=>Promise.all(n.map(r=>ir.faceExpressionNet.predictExpressions(r))),this.extractedFaces);return e.map((n,r)=>rj(n,t[r]))}withAgeAndGender(){return new GT(this,this.input)}},VT=class extends fj{async run(){let e=await this.parentTask;if(!e)return;let t=await WT(e,this.input,n=>ir.faceExpressionNet.predictExpressions(n),this.extractedFaces);return rj(e,t)}withAgeAndGender(){return new qT(this,this.input)}},HT=class extends UT{withAgeAndGender(){return new KT(this,this.input)}withFaceDescriptors(){return new YT(this,this.input)}},jT=class extends VT{withAgeAndGender(){return new XT(this,this.input)}withFaceDescriptor(){return new ZT(this,this.input)}},mj=class extends oy{constructor(e,t,n){super(),this.parentTask=e,this.input=t,this.extractedFaces=n}},GT=class extends mj{async run(){let e=await this.parentTask,t=await bw(e,this.input,async n=>Promise.all(n.map(r=>ir.ageGenderNet.predictAgeAndGender(r))),this.extractedFaces);return e.map((n,r)=>{let{age:a,gender:i,genderProbability:s}=t[r];return dj(pj(n,i,s),a)})}withFaceExpressions(){return new UT(this,this.input)}},qT=class extends mj{async run(){let e=await this.parentTask;if(!e)return;let{age:t,gender:n,genderProbability:r}=await WT(e,this.input,a=>ir.ageGenderNet.predictAgeAndGender(a),this.extractedFaces);return dj(pj(e,n,r),t)}withFaceExpressions(){return new VT(this,this.input)}},KT=class extends GT{withFaceExpressions(){return new HT(this,this.input)}withFaceDescriptors(){return new YT(this,this.input)}},XT=class extends qT{withFaceExpressions(){return new jT(this,this.input)}withFaceDescriptor(){return new ZT(this,this.input)}},gj=class extends oy{constructor(e,t){super(),this.parentTask=e,this.input=t}},YT=class extends gj{async run(){let e=await this.parentTask;return(await bw(e,this.input,t=>Promise.all(t.map(n=>ir.faceRecognitionNet.computeFaceDescriptor(n))),null,t=>t.landmarks.align(null,{useDlibAlignment:!0}))).map((t,n)=>cj(e[n],t))}withFaceExpressions(){return new HT(this,this.input)}withAgeAndGender(){return new KT(this,this.input)}},ZT=class extends gj{async run(){let e=await this.parentTask;if(!e)return;let t=await WT(e,this.input,n=>ir.faceRecognitionNet.computeFaceDescriptor(n),null,n=>n.landmarks.align(null,{useDlibAlignment:!0}));return cj(e,t)}withFaceExpressions(){return new jT(this,this.input)}withAgeAndGender(){return new XT(this,this.input)}},yj=class extends oy{constructor(e,t,n){super(),this.parentTask=e,this.input=t,this.useTinyLandmarkNet=n}get landmarkNet(){return this.useTinyLandmarkNet?ir.faceLandmark68TinyNet:ir.faceLandmark68Net}},iLe=class extends yj{async run(){let e=await this.parentTask,t=e.map(a=>a.detection),n=this.input instanceof He?await _T(this.input,t):await NT(this.input,t),r=await Promise.all(n.map(a=>this.landmarkNet.detectLandmarks(a)));return n.forEach(a=>a instanceof He&&a.dispose()),e.filter((a,i)=>r[i]).map((a,i)=>OT(a,r[i]))}withFaceExpressions(){return new HT(this,this.input)}withAgeAndGender(){return new KT(this,this.input)}withFaceDescriptors(){return new YT(this,this.input)}},sLe=class extends yj{async run(){let e=await this.parentTask;if(!e)return;let{detection:t}=e,n=this.input instanceof He?await _T(this.input,[t]):await NT(this.input,[t]),r=await this.landmarkNet.detectLandmarks(n[0]);return n.forEach(a=>a instanceof He&&a.dispose()),OT(e,r)}withFaceExpressions(){return new jT(this,this.input)}withAgeAndGender(){return new XT(this,this.input)}withFaceDescriptor(){return new ZT(this,this.input)}},bj=class extends oy{constructor(e,t=new sy){super(),this.input=e,this.options=t}},vj=class extends bj{async run(){let{input:e,options:t}=this,n;if(t instanceof eLe)n=ir.tinyFaceDetector.locateFaces(e,t);else if(t instanceof sy)n=ir.ssdMobilenetv1.locateFaces(e,t);else if(t instanceof zT)n=ir.tinyYolov2.locateFaces(e,t);else throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | TinyYolov2Options");return n}runAndExtendWithFaceDetections(){return new Promise((e,t)=>{this.run().then(n=>e(n.map(r=>qv({},r)))).catch(n=>t(n))})}withFaceLandmarks(e=!1){return new iLe(this.runAndExtendWithFaceDetections(),this.input,e)}withFaceExpressions(){return new UT(this.runAndExtendWithFaceDetections(),this.input)}withAgeAndGender(){return new GT(this.runAndExtendWithFaceDetections(),this.input)}},oLe=class extends bj{async run(){let e=await new vj(this.input,this.options),t=e[0];return e.forEach(n=>{n.score>t.score&&(t=n)}),t}runAndExtendWithFaceDetection(){return new Promise(async e=>{let t=await this.run();e(t?qv({},t):void 0)})}withFaceLandmarks(e=!1){return new sLe(this.runAndExtendWithFaceDetection(),this.input,e)}withFaceExpressions(){return new VT(this.runAndExtendWithFaceDetection(),this.input)}withAgeAndGender(){return new qT(this.runAndExtendWithFaceDetection(),this.input)}};function xj(e,t=new sy){return new oLe(e,t)}function wj(e,t=new sy){return new vj(e,t)}function lLe(e,t){if(e.length!==t.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");let n=Array.from(e),r=Array.from(t);return Math.sqrt(n.map((a,i)=>a-r[i]).reduce((a,i)=>a+i*i,0))}var QT=class{constructor(e,t=.6){this._distanceThreshold=t;let n=Array.isArray(e)?e:[e];if(!n.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");let r=1,a=()=>"person ".concat(r++);this._labeledDescriptors=n.map(i=>{if(i instanceof Rl)return i;if(i instanceof Float32Array)return new Rl(a(),[i]);if(i.descriptor&&i.descriptor instanceof Float32Array)return new Rl(a(),[i.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")})}get labeledDescriptors(){return this._labeledDescriptors}get distanceThreshold(){return this._distanceThreshold}computeMeanDistance(e,t){return t.map(n=>lLe(n,e)).reduce((n,r)=>n+r,0)/(t.length||1)}matchDescriptor(e){return this.labeledDescriptors.map(({descriptors:t,label:n})=>new TD(n,this.computeMeanDistance(e,t))).reduce((t,n)=>t.distance<n.distance?t:n)}findBestMatch(e){let t=this.matchDescriptor(e);return t.distance<this._distanceThreshold?t:new TD("unknown",t.distance)}toJSON(){return{distanceThreshold:this._distanceThreshold,labeledDescriptors:this._labeledDescriptors.map(e=>e.toJSON())}}static fromJSON(e){let t=e.labeledDescriptors.map(n=>Rl.fromJSON(n));return new QT(t,e.distanceThreshold)}};function JT(e,t){let{width:n,height:r}=new $o(t.width,t.height);if(n<=0||r<=0)throw new Error("resizeResults - invalid dimensions: ".concat(JSON.stringify({width:n,height:r})));if(Array.isArray(e))return e.map(a=>JT(a,{width:n,height:r}));if(MT(e)){let a=e.detection.forSize(n,r),i=e.unshiftedLandmarks.forSize(a.box.width,a.box.height);return OT(qv(e,a),i)}return Bm(e)?qv(e,e.detection.forSize(n,r)):e instanceof zm||e instanceof Fa?e.forSize(n,r):e}var XS={exports:{}},mu={},YS={exports:{}},Pi={},ZS={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=u;/*!
 * Adapted from jQuery UI core
 *
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/ui-core/
 */var n="none",r="contents",a=/input|select|textarea|button|object|iframe/;function i(d,p){return p.getPropertyValue("overflow")!=="visible"||d.scrollWidth<=0&&d.scrollHeight<=0}function s(d){var p=d.offsetWidth<=0&&d.offsetHeight<=0;if(p&&!d.innerHTML)return!0;try{var h=window.getComputedStyle(d),f=h.getPropertyValue("display");return p?f!==r&&i(d,h):f===n}catch(m){return console.warn("Failed to inspect element style"),!1}}function o(d){for(var p=d,h=d.getRootNode&&d.getRootNode();p&&p!==document.body;){if(h&&p===h&&(p=h.host.parentNode),s(p))return!1;p=p.parentNode}return!0}function l(d,p){var h=d.nodeName.toLowerCase(),f=a.test(h)&&!d.disabled||h==="a"&&d.href||p;return f&&o(d)}function c(d){var p=d.getAttribute("tabindex");p===null&&(p=void 0);var h=isNaN(p);return(h||p>=0)&&l(d,!h)}function u(d){var p=[].slice.call(d.querySelectorAll("*"),0).reduce(function(h,f){return h.concat(f.shadowRoot?u(f.shadowRoot):[f])},[]);return p.filter(c)}e.exports=t.default})(ZS,ZS.exports);var kj=ZS.exports;Object.defineProperty(Pi,"__esModule",{value:!0});Pi.resetState=pLe;Pi.log=hLe;Pi.handleBlur=Wm;Pi.handleFocus=Um;Pi.markForFocusLater=fLe;Pi.returnFocus=mLe;Pi.popWithoutFocus=gLe;Pi.setupScopedFocus=yLe;Pi.teardownScopedFocus=bLe;var uLe=kj,cLe=dLe(uLe);function dLe(e){return e&&e.__esModule?e:{default:e}}var Sp=[],_d=null,QS=!1;function pLe(){Sp=[]}function hLe(){}function Wm(){QS=!0}function Um(){if(QS){if(QS=!1,!_d)return;setTimeout(function(){if(!_d.contains(document.activeElement)){var e=(0,cLe.default)(_d)[0]||_d;e.focus()}},0)}}function fLe(){Sp.push(document.activeElement)}function mLe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=null;try{Sp.length!==0&&(t=Sp.pop(),t.focus({preventScroll:e}));return}catch(n){console.warn(["You tried to return focus to",t,"but it is not in the DOM anymore"].join(" "))}}function gLe(){Sp.length>0&&Sp.pop()}function yLe(e){_d=e,window.addEventListener?(window.addEventListener("blur",Wm,!1),document.addEventListener("focus",Um,!0)):(window.attachEvent("onBlur",Wm),document.attachEvent("onFocus",Um))}function bLe(){_d=null,window.addEventListener?(window.removeEventListener("blur",Wm),document.removeEventListener("focus",Um)):(window.detachEvent("onBlur",Wm),document.detachEvent("onFocus",Um))}var JS={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var n=kj,r=a(n);function a(o){return o&&o.__esModule?o:{default:o}}function i(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return o.activeElement.shadowRoot?i(o.activeElement.shadowRoot):o.activeElement}function s(o,l){var c=(0,r.default)(o);if(!c.length){l.preventDefault();return}var u=void 0,d=l.shiftKey,p=c[0],h=c[c.length-1],f=i();if(o===f){if(!d)return;u=h}if(h===f&&!d&&(u=p),p===f&&d&&(u=h),u){l.preventDefault(),u.focus();return}var m=/(\bChrome\b|\bSafari\b)\//.exec(navigator.userAgent),g=m!=null&&m[1]!="Chrome"&&/\biPod\b|\biPad\b/g.exec(navigator.userAgent)==null;if(g){var y=c.indexOf(f);if(y>-1&&(y+=d?-1:1),u=c[y],typeof u>"u"){l.preventDefault(),u=d?h:p,u.focus();return}l.preventDefault(),u.focus()}}e.exports=t.default})(JS,JS.exports);var vLe=JS.exports,zi={},xLe=function(){},wLe=xLe,_i={},Sj={exports:{}};/*!
  Copyright (c) 2015 Jed Watson.
  Based on code that is Copyright 2013-2015, Facebook, Inc.
  All rights reserved.
*/(function(e){(function(){var t=!!(typeof window<"u"&&window.document&&window.document.createElement),n={canUseDOM:t,canUseWorkers:typeof Worker<"u",canUseEventListeners:t&&!!(window.addEventListener||window.attachEvent),canUseViewport:t&&!!window.screen};e.exports?e.exports=n:window.ExecutionEnvironment=n})()})(Sj);var kLe=Sj.exports;Object.defineProperty(_i,"__esModule",{value:!0});_i.canUseDOM=_i.SafeNodeList=_i.SafeHTMLCollection=void 0;var SLe=kLe,ILe=$Le(SLe);function $Le(e){return e&&e.__esModule?e:{default:e}}var vw=ILe.default,CLe=vw.canUseDOM?window.HTMLElement:{};_i.SafeHTMLCollection=vw.canUseDOM?window.HTMLCollection:{};_i.SafeNodeList=vw.canUseDOM?window.NodeList:{};_i.canUseDOM=vw.canUseDOM;_i.default=CLe;Object.defineProperty(zi,"__esModule",{value:!0});zi.resetState=ALe;zi.log=RLe;zi.assertNodeList=Ij;zi.setElement=DLe;zi.validateElement=eN;zi.hide=FLe;zi.show=MLe;zi.documentNotReadyOrSSRTesting=OLe;var ELe=wLe,TLe=_Le(ELe),NLe=_i;function _Le(e){return e&&e.__esModule?e:{default:e}}var qa=null;function ALe(){qa&&(qa.removeAttribute?qa.removeAttribute("aria-hidden"):qa.length!=null?qa.forEach(function(e){return e.removeAttribute("aria-hidden")}):document.querySelectorAll(qa).forEach(function(e){return e.removeAttribute("aria-hidden")})),qa=null}function RLe(){}function Ij(e,t){if(!e||!e.length)throw new Error("react-modal: No elements were found for selector "+t+".")}function DLe(e){var t=e;if(typeof t=="string"&&NLe.canUseDOM){var n=document.querySelectorAll(t);Ij(n,t),t=n}return qa=t||qa,qa}function eN(e){var t=e||qa;return t?Array.isArray(t)||t instanceof HTMLCollection||t instanceof NodeList?t:[t]:((0,TLe.default)(!1,["react-modal: App element is not defined.","Please use `Modal.setAppElement(el)` or set `appElement={el}`.","This is needed so screen readers don't see main content","when modal is opened. It is not recommended, but you can opt-out","by setting `ariaHideApp={false}`."].join(" ")),[])}function FLe(e){var t=!0,n=!1,r=void 0;try{for(var a=eN(e)[Symbol.iterator](),i;!(t=(i=a.next()).done);t=!0){var s=i.value;s.setAttribute("aria-hidden","true")}}catch(o){n=!0,r=o}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}}function MLe(e){var t=!0,n=!1,r=void 0;try{for(var a=eN(e)[Symbol.iterator](),i;!(t=(i=a.next()).done);t=!0){var s=i.value;s.removeAttribute("aria-hidden")}}catch(o){n=!0,r=o}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}}function OLe(){qa=null}var tf={};Object.defineProperty(tf,"__esModule",{value:!0});tf.resetState=LLe;tf.log=PLe;var Zf={},Qf={};function AD(e,t){e.classList.remove(t)}function LLe(){var e=document.getElementsByTagName("html")[0];for(var t in Zf)AD(e,Zf[t]);var n=document.body;for(var r in Qf)AD(n,Qf[r]);Zf={},Qf={}}function PLe(){}var zLe=function(t,n){return t[n]||(t[n]=0),t[n]+=1,n},BLe=function(t,n){return t[n]&&(t[n]-=1),n},WLe=function(t,n,r){r.forEach(function(a){zLe(n,a),t.add(a)})},ULe=function(t,n,r){r.forEach(function(a){BLe(n,a),n[a]===0&&t.remove(a)})};tf.add=function(t,n){return WLe(t.classList,t.nodeName.toLowerCase()=="html"?Zf:Qf,n.split(" "))};tf.remove=function(t,n){return ULe(t.classList,t.nodeName.toLowerCase()=="html"?Zf:Qf,n.split(" "))};var nf={};Object.defineProperty(nf,"__esModule",{value:!0});nf.log=HLe;nf.resetState=jLe;function VLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var $j=function e(){var t=this;VLe(this,e),this.register=function(n){t.openInstances.indexOf(n)===-1&&(t.openInstances.push(n),t.emit("register"))},this.deregister=function(n){var r=t.openInstances.indexOf(n);r!==-1&&(t.openInstances.splice(r,1),t.emit("deregister"))},this.subscribe=function(n){t.subscribers.push(n)},this.emit=function(n){t.subscribers.forEach(function(r){return r(n,t.openInstances.slice())})},this.openInstances=[],this.subscribers=[]},Yv=new $j;function HLe(){console.log("portalOpenInstances ----------"),console.log(Yv.openInstances.length),Yv.openInstances.forEach(function(e){return console.log(e)}),console.log("end portalOpenInstances ----------")}function jLe(){Yv=new $j}nf.default=Yv;var tN={};Object.defineProperty(tN,"__esModule",{value:!0});tN.resetState=XLe;tN.log=YLe;var GLe=nf,qLe=KLe(GLe);function KLe(e){return e&&e.__esModule?e:{default:e}}var gr=void 0,hi=void 0,zl=[];function XLe(){for(var e=[gr,hi],t=0;t<e.length;t++){var n=e[t];n&&n.parentNode&&n.parentNode.removeChild(n)}gr=hi=null,zl=[]}function YLe(){console.log("bodyTrap ----------"),console.log(zl.length);for(var e=[gr,hi],t=0;t<e.length;t++){var n=e[t],r=n||{};console.log(r.nodeName,r.className,r.id)}console.log("edn bodyTrap ----------")}function RD(){zl.length!==0&&zl[zl.length-1].focusContent()}function ZLe(e,t){!gr&&!hi&&(gr=document.createElement("div"),gr.setAttribute("data-react-modal-body-trap",""),gr.style.position="absolute",gr.style.opacity="0",gr.setAttribute("tabindex","0"),gr.addEventListener("focus",RD),hi=gr.cloneNode(),hi.addEventListener("focus",RD)),zl=t,zl.length>0?(document.body.firstChild!==gr&&document.body.insertBefore(gr,document.body.firstChild),document.body.lastChild!==hi&&document.body.appendChild(hi)):(gr.parentElement&&gr.parentElement.removeChild(gr),hi.parentElement&&hi.parentElement.removeChild(hi))}qLe.default.subscribe(ZLe);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(P){for(var L=1;L<arguments.length;L++){var U=arguments[L];for(var D in U)Object.prototype.hasOwnProperty.call(U,D)&&(P[D]=U[D])}return P},r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(P){return typeof P}:function(P){return P&&typeof Symbol=="function"&&P.constructor===Symbol&&P!==Symbol.prototype?"symbol":typeof P},a=function(){function P(L,U){for(var D=0;D<U.length;D++){var F=U[D];F.enumerable=F.enumerable||!1,F.configurable=!0,"value"in F&&(F.writable=!0),Object.defineProperty(L,F.key,F)}}return function(L,U,D){return U&&P(L.prototype,U),D&&P(L,D),L}}(),i=_e,s=KI,o=w(s),l=Pi,c=x(l),u=vLe,d=w(u),p=zi,h=x(p),f=tf,m=x(f),g=_i,y=w(g),b=nf,v=w(b);function x(P){if(P&&P.__esModule)return P;var L={};if(P!=null)for(var U in P)Object.prototype.hasOwnProperty.call(P,U)&&(L[U]=P[U]);return L.default=P,L}function w(P){return P&&P.__esModule?P:{default:P}}function $(P,L){if(!(P instanceof L))throw new TypeError("Cannot call a class as a function")}function C(P,L){if(!P)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return L&&(typeof L=="object"||typeof L=="function")?L:P}function E(P,L){if(typeof L!="function"&&L!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof L);P.prototype=Object.create(L&&L.prototype,{constructor:{value:P,enumerable:!1,writable:!0,configurable:!0}}),L&&(Object.setPrototypeOf?Object.setPrototypeOf(P,L):P.__proto__=L)}var _={overlay:"ReactModal__Overlay",content:"ReactModal__Content"},R=function(L){return L.code==="Tab"||L.keyCode===9},N=function(L){return L.code==="Escape"||L.keyCode===27},I=0,O=function(P){E(L,P);function L(U){$(this,L);var D=C(this,(L.__proto__||Object.getPrototypeOf(L)).call(this,U));return D.setOverlayRef=function(F){D.overlay=F,D.props.overlayRef&&D.props.overlayRef(F)},D.setContentRef=function(F){D.content=F,D.props.contentRef&&D.props.contentRef(F)},D.afterClose=function(){var F=D.props,z=F.appElement,B=F.ariaHideApp,j=F.htmlOpenClassName,Y=F.bodyOpenClassName,Q=F.parentSelector,ae=Q&&Q().ownerDocument||document;Y&&m.remove(ae.body,Y),j&&m.remove(ae.getElementsByTagName("html")[0],j),B&&I>0&&(I-=1,I===0&&h.show(z)),D.props.shouldFocusAfterRender&&(D.props.shouldReturnFocusAfterClose?(c.returnFocus(D.props.preventScroll),c.teardownScopedFocus()):c.popWithoutFocus()),D.props.onAfterClose&&D.props.onAfterClose(),v.default.deregister(D)},D.open=function(){D.beforeOpen(),D.state.afterOpen&&D.state.beforeClose?(clearTimeout(D.closeTimer),D.setState({beforeClose:!1})):(D.props.shouldFocusAfterRender&&(c.setupScopedFocus(D.node),c.markForFocusLater()),D.setState({isOpen:!0},function(){D.openAnimationFrame=requestAnimationFrame(function(){D.setState({afterOpen:!0}),D.props.isOpen&&D.props.onAfterOpen&&D.props.onAfterOpen({overlayEl:D.overlay,contentEl:D.content})})}))},D.close=function(){D.props.closeTimeoutMS>0?D.closeWithTimeout():D.closeWithoutTimeout()},D.focusContent=function(){return D.content&&!D.contentHasFocus()&&D.content.focus({preventScroll:!0})},D.closeWithTimeout=function(){var F=Date.now()+D.props.closeTimeoutMS;D.setState({beforeClose:!0,closesAt:F},function(){D.closeTimer=setTimeout(D.closeWithoutTimeout,D.state.closesAt-Date.now())})},D.closeWithoutTimeout=function(){D.setState({beforeClose:!1,isOpen:!1,afterOpen:!1,closesAt:null},D.afterClose)},D.handleKeyDown=function(F){R(F)&&(0,d.default)(D.content,F),D.props.shouldCloseOnEsc&&N(F)&&(F.stopPropagation(),D.requestClose(F))},D.handleOverlayOnClick=function(F){D.shouldClose===null&&(D.shouldClose=!0),D.shouldClose&&D.props.shouldCloseOnOverlayClick&&(D.ownerHandlesClose()?D.requestClose(F):D.focusContent()),D.shouldClose=null},D.handleContentOnMouseUp=function(){D.shouldClose=!1},D.handleOverlayOnMouseDown=function(F){!D.props.shouldCloseOnOverlayClick&&F.target==D.overlay&&F.preventDefault()},D.handleContentOnClick=function(){D.shouldClose=!1},D.handleContentOnMouseDown=function(){D.shouldClose=!1},D.requestClose=function(F){return D.ownerHandlesClose()&&D.props.onRequestClose(F)},D.ownerHandlesClose=function(){return D.props.onRequestClose},D.shouldBeClosed=function(){return!D.state.isOpen&&!D.state.beforeClose},D.contentHasFocus=function(){return document.activeElement===D.content||D.content.contains(document.activeElement)},D.buildClassName=function(F,z){var B=(typeof z>"u"?"undefined":r(z))==="object"?z:{base:_[F],afterOpen:_[F]+"--after-open",beforeClose:_[F]+"--before-close"},j=B.base;return D.state.afterOpen&&(j=j+" "+B.afterOpen),D.state.beforeClose&&(j=j+" "+B.beforeClose),typeof z=="string"&&z?j+" "+z:j},D.attributesFromObject=function(F,z){return Object.keys(z).reduce(function(B,j){return B[F+"-"+j]=z[j],B},{})},D.state={afterOpen:!1,beforeClose:!1},D.shouldClose=null,D.moveFromContentToOverlay=null,D}return a(L,[{key:"componentDidMount",value:function(){this.props.isOpen&&this.open()}},{key:"componentDidUpdate",value:function(D,F){this.props.isOpen&&!D.isOpen?this.open():!this.props.isOpen&&D.isOpen&&this.close(),this.props.shouldFocusAfterRender&&this.state.isOpen&&!F.isOpen&&this.focusContent()}},{key:"componentWillUnmount",value:function(){this.state.isOpen&&this.afterClose(),clearTimeout(this.closeTimer),cancelAnimationFrame(this.openAnimationFrame)}},{key:"beforeOpen",value:function(){var D=this.props,F=D.appElement,z=D.ariaHideApp,B=D.htmlOpenClassName,j=D.bodyOpenClassName,Y=D.parentSelector,Q=Y&&Y().ownerDocument||document;j&&m.add(Q.body,j),B&&m.add(Q.getElementsByTagName("html")[0],B),z&&(I+=1,h.hide(F)),v.default.register(this)}},{key:"render",value:function(){var D=this.props,F=D.id,z=D.className,B=D.overlayClassName,j=D.defaultStyles,Y=D.children,Q=z?{}:j.content,ae=B?{}:j.overlay;if(this.shouldBeClosed())return null;var se={ref:this.setOverlayRef,className:this.buildClassName("overlay",B),style:n({},ae,this.props.style.overlay),onClick:this.handleOverlayOnClick,onMouseDown:this.handleOverlayOnMouseDown},fe=n({id:F,ref:this.setContentRef,style:n({},Q,this.props.style.content),className:this.buildClassName("content",z),tabIndex:"-1",onKeyDown:this.handleKeyDown,onMouseDown:this.handleContentOnMouseDown,onMouseUp:this.handleContentOnMouseUp,onClick:this.handleContentOnClick,role:this.props.role,"aria-label":this.props.contentLabel},this.attributesFromObject("aria",n({modal:!0},this.props.aria)),this.attributesFromObject("data",this.props.data||{}),{"data-testid":this.props.testId}),me=this.props.contentElement(fe,Y);return this.props.overlayElement(se,me)}}]),L}(i.Component);O.defaultProps={style:{overlay:{},content:{}},defaultStyles:{}},O.propTypes={isOpen:o.default.bool.isRequired,defaultStyles:o.default.shape({content:o.default.object,overlay:o.default.object}),style:o.default.shape({content:o.default.object,overlay:o.default.object}),className:o.default.oneOfType([o.default.string,o.default.object]),overlayClassName:o.default.oneOfType([o.default.string,o.default.object]),parentSelector:o.default.func,bodyOpenClassName:o.default.string,htmlOpenClassName:o.default.string,ariaHideApp:o.default.bool,appElement:o.default.oneOfType([o.default.instanceOf(y.default),o.default.instanceOf(g.SafeHTMLCollection),o.default.instanceOf(g.SafeNodeList),o.default.arrayOf(o.default.instanceOf(y.default))]),onAfterOpen:o.default.func,onAfterClose:o.default.func,onRequestClose:o.default.func,closeTimeoutMS:o.default.number,shouldFocusAfterRender:o.default.bool,shouldCloseOnOverlayClick:o.default.bool,shouldReturnFocusAfterClose:o.default.bool,preventScroll:o.default.bool,role:o.default.string,contentLabel:o.default.string,aria:o.default.object,data:o.default.object,children:o.default.node,shouldCloseOnEsc:o.default.bool,overlayRef:o.default.func,contentRef:o.default.func,id:o.default.string,overlayElement:o.default.func,contentElement:o.default.func,testId:o.default.string},t.default=O,e.exports=t.default})(YS,YS.exports);var QLe=YS.exports;function Cj(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);e!=null&&this.setState(e)}function Ej(e){function t(n){var r=this.constructor.getDerivedStateFromProps(e,n);return r!=null?r:null}this.setState(t.bind(this))}function Tj(e,t){try{var n=this.props,r=this.state;this.props=e,this.state=t,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(n,r)}finally{this.props=n,this.state=r}}Cj.__suppressDeprecationWarning=!0;Ej.__suppressDeprecationWarning=!0;Tj.__suppressDeprecationWarning=!0;function JLe(e){var t=e.prototype;if(!t||!t.isReactComponent)throw new Error("Can only polyfill class components");if(typeof e.getDerivedStateFromProps!="function"&&typeof t.getSnapshotBeforeUpdate!="function")return e;var n=null,r=null,a=null;if(typeof t.componentWillMount=="function"?n="componentWillMount":typeof t.UNSAFE_componentWillMount=="function"&&(n="UNSAFE_componentWillMount"),typeof t.componentWillReceiveProps=="function"?r="componentWillReceiveProps":typeof t.UNSAFE_componentWillReceiveProps=="function"&&(r="UNSAFE_componentWillReceiveProps"),typeof t.componentWillUpdate=="function"?a="componentWillUpdate":typeof t.UNSAFE_componentWillUpdate=="function"&&(a="UNSAFE_componentWillUpdate"),n!==null||r!==null||a!==null){var i=e.displayName||e.name,s=typeof e.getDerivedStateFromProps=="function"?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error("Unsafe legacy lifecycles will not be called for components using new component APIs.\n\n"+i+" uses "+s+" but also contains the following legacy lifecycles:"+(n!==null?"\n  "+n:"")+(r!==null?"\n  "+r:"")+(a!==null?"\n  "+a:"")+"\n\nThe above lifecycles should be removed. Learn more about this warning here:\nhttps://fb.me/react-async-component-lifecycle-hooks")}if(typeof e.getDerivedStateFromProps=="function"&&(t.componentWillMount=Cj,t.componentWillReceiveProps=Ej),typeof t.getSnapshotBeforeUpdate=="function"){if(typeof t.componentDidUpdate!="function")throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");t.componentWillUpdate=Tj;var o=t.componentDidUpdate;t.componentDidUpdate=function(c,u,d){var p=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:d;o.call(this,c,u,p)}}return e}const ePe=Object.freeze(Object.defineProperty({__proto__:null,polyfill:JLe},Symbol.toStringTag,{value:"Module"})),tPe=Gj(ePe);Object.defineProperty(mu,"__esModule",{value:!0});mu.bodyOpenClassName=mu.portalClassName=void 0;var DD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},nPe=function(){function e(t,n){for(var r=0;r<n.length;r++){var a=n[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Nj=_e,Zv=ly(Nj),rPe=m0,Qv=ly(rPe),aPe=KI,Ge=ly(aPe),iPe=QLe,FD=ly(iPe),sPe=zi,oPe=uPe(sPe),ho=_i,MD=ly(ho),lPe=tPe;function uPe(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function ly(e){return e&&e.__esModule?e:{default:e}}function cPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OD(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e}function dPe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var pPe=mu.portalClassName="ReactModalPortal",hPe=mu.bodyOpenClassName="ReactModal__Body--open",vl=ho.canUseDOM&&Qv.default.createPortal!==void 0,LD=function(t){return document.createElement(t)},PD=function(){return vl?Qv.default.createPortal:Qv.default.unstable_renderSubtreeIntoContainer};function ib(e){return e()}var uy=function(e){dPe(t,e);function t(){var n,r,a,i;cPe(this,t);for(var s=arguments.length,o=Array(s),l=0;l<s;l++)o[l]=arguments[l];return i=(r=(a=OD(this,(n=t.__proto__||Object.getPrototypeOf(t)).call.apply(n,[this].concat(o))),a),a.removePortal=function(){!vl&&Qv.default.unmountComponentAtNode(a.node);var c=ib(a.props.parentSelector);c&&c.contains(a.node)?c.removeChild(a.node):console.warn('React-Modal: "parentSelector" prop did not returned any DOM element. Make sure that the parent element is unmounted to avoid any memory leaks.')},a.portalRef=function(c){a.portal=c},a.renderPortal=function(c){var u=PD(),d=u(a,Zv.default.createElement(FD.default,DD({defaultStyles:t.defaultStyles},c)),a.node);a.portalRef(d)},r),OD(a,i)}return nPe(t,[{key:"componentDidMount",value:function(){if(ho.canUseDOM){vl||(this.node=LD("div")),this.node.className=this.props.portalClassName;var r=ib(this.props.parentSelector);r.appendChild(this.node),!vl&&this.renderPortal(this.props)}}},{key:"getSnapshotBeforeUpdate",value:function(r){var a=ib(r.parentSelector),i=ib(this.props.parentSelector);return{prevParent:a,nextParent:i}}},{key:"componentDidUpdate",value:function(r,a,i){if(ho.canUseDOM){var s=this.props,o=s.isOpen,l=s.portalClassName;r.portalClassName!==l&&(this.node.className=l);var c=i.prevParent,u=i.nextParent;u!==c&&(c.removeChild(this.node),u.appendChild(this.node)),!(!r.isOpen&&!o)&&!vl&&this.renderPortal(this.props)}}},{key:"componentWillUnmount",value:function(){if(!(!ho.canUseDOM||!this.node||!this.portal)){var r=this.portal.state,a=Date.now(),i=r.isOpen&&this.props.closeTimeoutMS&&(r.closesAt||a+this.props.closeTimeoutMS);i?(r.beforeClose||this.portal.closeWithTimeout(),setTimeout(this.removePortal,i-a)):this.removePortal()}}},{key:"render",value:function(){if(!ho.canUseDOM||!vl)return null;!this.node&&vl&&(this.node=LD("div"));var r=PD();return r(Zv.default.createElement(FD.default,DD({ref:this.portalRef,defaultStyles:t.defaultStyles},this.props)),this.node)}}],[{key:"setAppElement",value:function(r){oPe.setElement(r)}}]),t}(Nj.Component);uy.propTypes={isOpen:Ge.default.bool.isRequired,style:Ge.default.shape({content:Ge.default.object,overlay:Ge.default.object}),portalClassName:Ge.default.string,bodyOpenClassName:Ge.default.string,htmlOpenClassName:Ge.default.string,className:Ge.default.oneOfType([Ge.default.string,Ge.default.shape({base:Ge.default.string.isRequired,afterOpen:Ge.default.string.isRequired,beforeClose:Ge.default.string.isRequired})]),overlayClassName:Ge.default.oneOfType([Ge.default.string,Ge.default.shape({base:Ge.default.string.isRequired,afterOpen:Ge.default.string.isRequired,beforeClose:Ge.default.string.isRequired})]),appElement:Ge.default.oneOfType([Ge.default.instanceOf(MD.default),Ge.default.instanceOf(ho.SafeHTMLCollection),Ge.default.instanceOf(ho.SafeNodeList),Ge.default.arrayOf(Ge.default.instanceOf(MD.default))]),onAfterOpen:Ge.default.func,onRequestClose:Ge.default.func,closeTimeoutMS:Ge.default.number,ariaHideApp:Ge.default.bool,shouldFocusAfterRender:Ge.default.bool,shouldCloseOnOverlayClick:Ge.default.bool,shouldReturnFocusAfterClose:Ge.default.bool,preventScroll:Ge.default.bool,parentSelector:Ge.default.func,aria:Ge.default.object,data:Ge.default.object,role:Ge.default.string,contentLabel:Ge.default.string,shouldCloseOnEsc:Ge.default.bool,overlayRef:Ge.default.func,contentRef:Ge.default.func,id:Ge.default.string,overlayElement:Ge.default.func,contentElement:Ge.default.func};uy.defaultProps={isOpen:!1,portalClassName:pPe,bodyOpenClassName:hPe,role:"dialog",ariaHideApp:!0,closeTimeoutMS:0,shouldFocusAfterRender:!0,shouldCloseOnEsc:!0,shouldCloseOnOverlayClick:!0,shouldReturnFocusAfterClose:!0,preventScroll:!1,parentSelector:function(){return document.body},overlayElement:function(t,n){return Zv.default.createElement("div",t,n)},contentElement:function(t,n){return Zv.default.createElement("div",t,n)}};uy.defaultStyles={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.75)"},content:{position:"absolute",top:"40px",left:"40px",right:"40px",bottom:"40px",border:"1px solid #ccc",background:"#fff",overflow:"auto",WebkitOverflowScrolling:"touch",borderRadius:"4px",outline:"none",padding:"20px"}};(0,lPe.polyfill)(uy);mu.default=uy;(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=mu,r=a(n);function a(i){return i&&i.__esModule?i:{default:i}}t.default=r.default,e.exports=t.default})(XS,XS.exports);var fPe=XS.exports;const mPe=Ip(fPe),_j=({isOpen:e,detectedLabel:t,onClose:n})=>{const r={content:{width:"300px",height:"200px",margin:"auto"}};return ee.jsxs(mPe,{isOpen:e,onRequestClose:n,contentLabel:"Detected Label Modal",style:r,children:[ee.jsx("h2",{children:"환영합니다, ".concat(t,"님!")}),ee.jsx("button",{onClick:n,children:"Close Modal"})]})},gPe="Unknown",D1=.5,yPe=()=>{const e=_e.useRef(null),t=_e.useRef(null),n=_e.useRef(!1),[r,a]=_e.useState(!1),[i,s]=_e.useState(null),[o,l]=_e.useState(!1),c=async()=>{try{const f=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1});e.current&&(e.current.srcObject=f),n.current=!0}catch(f){console.error("Error accessing webcam:",f)}},u=()=>{var g;const f=(g=e.current)==null?void 0:g.srcObject,m=f==null?void 0:f.getTracks();m==null||m.forEach(y=>y.stop()),e.current.srcObject=null,n.current=!1};_e.useEffect(()=>{const f=async()=>{const g="gym",y=["Daegwon","IU","Jane","jo","Yeongseo"];return Promise.all(y.map(async b=>{const v=[],x="./labels/".concat(g,"/").concat(b,".jpg"),w=await GH(x),$=await xj(w).withFaceLandmarks().withFaceDescriptor();return v.push($.descriptor),new Rl(b,v)}))},m=async()=>{const g=await f(),y=new QT(g,D1),b=e.current,v=t.current,x={width:b.width,height:b.height};KH(v,x);const w=setInterval(async()=>{if(n.current&&!b.paused&&!b.ended){const $=await wj(b).withFaceLandmarks().withFaceDescriptors(),C=JT($,x);v.getContext("2d").clearRect(0,0,v.width,v.height),C.map(_=>y.findBestMatch(_.descriptor)).forEach((_,R)=>{const N=C[R].detection.box;let I=_.toString();_.distance>D1&&(I=gPe);const O=v.getContext("2d");O.lineWidth=2,O.strokeStyle="red",O.fillStyle="red",O.font="20px Arial";const P=C[R].landmarks,L=P.getLeftEye(),U=P.getRightEye(),D=(L[0].x+U[3].x)/2,F=(L[0].y+U[3].y)/2,z=O.measureText(I).width,B=parseInt(O.font),j=D-z/2,Y=F-N.height/2-B;O.fillText(I,j,Y+B),O.strokeRect(N.x,N.y,N.width,N.height),_.distance<=D1&&(s(I.split(" ")[0]),a(!0))})}},1e3);return()=>clearInterval(w)};return Promise.all([ir.ssdMobilenetv1.loadFromUri("/models"),ir.faceRecognitionNet.loadFromUri("/models"),ir.faceLandmark68Net.loadFromUri("/models")]).then(()=>c().then(m)),()=>{n.current&&u()}},[]);const d=()=>{c()},p=()=>{u()},h=()=>{a(!1),l(!0),localStorage.setItem("shownLabel",i!=null?i:""),c()};return _e.useEffect(()=>{i==null&&localStorage.setItem("shownLabel","null"),localStorage.getItem("shownLabel")===i?l(!0):(l(!1),u())},[i]),ee.jsxs(ee.Fragment,{children:[ee.jsx("video",{ref:e,id:"video",width:"720",height:"560",autoPlay:!0,muted:!0,style:{margin:"0 auto",position:"absolute"}}),ee.jsx("canvas",{ref:t,style:{margin:"0 auto",position:"absolute"}}),ee.jsx("button",{onClick:d,style:{position:"absolute",bottom:"20px",left:"30%",transform:"translateX(-50%)",padding:"10px"},children:"Start Webcam"}),ee.jsx("button",{onClick:p,style:{position:"absolute",bottom:"20px",left:"60%",transform:"translateX(-50%)",padding:"10px"},children:"Stop Webcam"}),ee.jsx(_j,{isOpen:r&&!o,detectedLabel:i,onClose:h})]})},bPe=()=>ee.jsxs("div",{children:[ee.jsx("h1",{children:"Face Recognition App"}),ee.jsx(yPe,{})]}),zD="/assets/test-03c7e081.svg";function Aj(){const[e,t]=_e.useState(window.innerWidth);_e.useState(window.innerHeight);const n=()=>{t(window.innerWidth)};return _e.useEffect(()=>(window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n)}),[]),ee.jsx(ee.Fragment,{children:window.innerWidth<=window.innerHeight?ee.jsxs(Fs,{style:{border:"0px"},children:[ee.jsx(nn,{style:{border:"0px"},children:ee.jsx(rn,{size:"12",style:{border:"0px"},children:ee.jsx("img",{style:{width:"13%"},src:zD,alt:"Logo"})})}),ee.jsx(nn,{children:ee.jsx(rn,{style:{border:"0px"},children:ee.jsx("div",{style:{textAlign:"center",fontSize:"180%",fontWeight:700,letterSpacing:"-3.12%",color:"white",marginTop:"3%",marginBottom:"5%"},children:"홀리데이 피트니스클럽(광주효천점)"})})})]}):ee.jsx(Fs,{style:{border:"0px"},children:ee.jsxs(nn,{style:{border:"0px"},children:[ee.jsx(rn,{size:"auto",style:{marginLeft:"3%",marginBottom:"18%",border:"0px"},children:ee.jsx("img",{style:{width:"100%",marginLeft:"5%"},src:zD,alt:"Logo"})}),ee.jsx(rn,{size:"auto",style:{marginLeft:"0.7%",marginBottom:"18%",border:"0px"},children:ee.jsx("div",{style:{textAlign:"center",color:"white",fontWeight:700,letterSpacing:"-3.12%",fontSize:"190%",marginTop:"3.3%"},children:"홀리데이 피트니스클럽(광주효천점)"})})]})})})}zL({mode:"md"});const Rj=e=>{const[t,n]=_e.useState(!1),[r,a]=_e.useState("회원번호 입력 (5자리)"),[i,s]=_e.useState(!1),o=f=>{f=="clubID"?(n(!1),a("회원번호 입력 (5자리)")):f=="Tel"&&(n(!0),a("010-")),s(!1)},l="만약 얼굴인식이 안되는 경우, \n본인의 회원번호(5자리) 혹은 휴대폰번호를 입력해주세요.",c=f=>{t==!1?(e.settypeid(!1),u(f)):t==!0&&(e.settypeid(!0),d(f))},u=f=>{i==!1&&r.length>=6&&(a(""+f.target.textContent),s(!0)),r.length==5||(r.length>5?a(f.target.textContent):a(r+f.target.textContent))},d=f=>{i==!1&&(a(""+f.target.textContent),s(!0)),r.length==3||r.length==8?a(r+"-"+f.target.textContent):r.length>=13?r.length>13&&a(f.target.textContent):a(r+f.target.textContent),e.AlertFunc(r)},p=()=>{t==!0&&(r.length==5||r.length==10)?a(r.slice(0,-2)):a(r.slice(0,-1))},h=()=>{a("")};return _e.useEffect(()=>{e.AlertFunc(r)}),ee.jsxs(ee.Fragment,{children:[ee.jsx(tY,{}),ee.jsx(OL,{children:ee.jsxs(Fs,{class:"input_box",children:[ee.jsx(nn,{class:"input_segment",children:ee.jsxs(nY,{class:"input_segment",onIonChange:f=>o(f.target.value),children:[ee.jsx(OA,{class:"input_segment",value:"clubID",children:ee.jsx(MA,{children:"회원번호"})}),ee.jsx(OA,{class:"input_segment",value:"Tel",children:ee.jsx(MA,{children:"휴대폰번호"})})]})}),ee.jsx(nn,{class:"input_div_row",children:ee.jsx(rn,{class:"input_box",children:ee.jsx("div",{className:"input_div ion-text-center",children:r})})}),ee.jsxs(nn,{class:"input_desc",children:[ee.jsx("div",{className:"hr"}),ee.jsx("div",{className:"input_desc",children:l})]}),ee.jsxs(nn,{class:"input_pad",children:[ee.jsx(nn,{class:"input_row",children:ee.jsxs(rn,{class:"input_box",children:[ee.jsx(Or,{class:"input_btn",onClick:c,children:"1"}),ee.jsx(Or,{class:"input_btn",onClick:c,children:"2"}),ee.jsx(Or,{class:"input_btn",onClick:c,children:"3"})]})}),ee.jsx(nn,{class:"input_row",children:ee.jsxs(rn,{class:"input_box",children:[ee.jsx(Or,{class:"input_btn",onClick:c,children:"4"}),ee.jsx(Or,{class:"input_btn",onClick:c,children:"5"}),ee.jsx(Or,{class:"input_btn",onClick:c,children:"6"})]})}),ee.jsx(nn,{class:"input_row",children:ee.jsxs(rn,{class:"input_box",children:[ee.jsx(Or,{class:"input_btn",onClick:c,children:"7"}),ee.jsx(Or,{class:"input_btn",onClick:c,children:"8"}),ee.jsx(Or,{class:"input_btn",onClick:c,children:"9"})]})}),ee.jsx(nn,{class:"input_row",children:ee.jsxs(rn,{class:"input_box",children:[ee.jsx(Or,{class:"input_btn",onClick:h,children:"취소"}),ee.jsx(Or,{class:"input_btn",onClick:c,children:"0"}),ee.jsx(Or,{class:"input_btn",onClick:p,children:"←"})]})})]})]})})]})};function Dj(){const[e,t]=_e.useState(window.innerWidth);_e.useState(window.innerHeight);const n=()=>{t(window.innerWidth)};return _e.useEffect(()=>(window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n)}),[]),ee.jsx(ee.Fragment,{children:window.innerWidth<=window.innerHeight?ee.jsx(Fs,{children:ee.jsx(nn,{style:{height:"280px"},children:ee.jsx(rn,{style:{border:"0px",margin:"0px auto",padding:"5px 5px"},children:ee.jsxs("div",{style:{width:"100%",height:"100%",backgroundColor:"white",borderRadius:"1.2%",color:"black",textAlign:"left",paddingLeft:"6%",paddingTop:"5%",fontSize:"125%",fontWeight:400,lineHeight:"190%"},children:["∙ 여름시즌 다이어트 프로그램 안내",ee.jsx("br",{}),"∙ 이번달 회원 등록시 운동복 무료 이용권 증정"]})})})}):ee.jsx(Fs,{})})}const vPe="Unknown",F1=.5,xPe=()=>{const e=_e.useRef(null),t=_e.useRef(null),n=_e.useRef(!1),[r,a]=_e.useState(!1),[i,s]=_e.useState(null),[o,l]=_e.useState(!1),[c,u]=_e.useState(!1),[d,p]=_e.useState(!1),h=async()=>{try{const b=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1});e.current&&(e.current.srcObject=b),u(!0),n.current=!0,p(!0)}catch(b){console.error("Error accessing webcam:",b)}},f=()=>{var x;const b=(x=e.current)==null?void 0:x.srcObject,v=b==null?void 0:b.getTracks();v==null||v.forEach(w=>w.stop()),e.current.srcObject=null,n.current=!1,p(!1)};_e.useEffect(()=>{const b=async()=>{const x="gym",w=["Daegwon","IU","Jane","jo","Yeongseo"];return Promise.all(w.map(async $=>{const C=[],E="./labels/".concat(x,"/").concat($,".jpg"),_=await GH(E),R=await xj(_).withFaceLandmarks().withFaceDescriptor();return C.push(R.descriptor),new Rl($,C)}))},v=async()=>{const x=await b(),w=new QT(x,F1),$=e.current,C=t.current,E={width:$.width,height:$.height};KH(C,E);const _=setInterval(async()=>{if(n.current&&!$.paused&&!$.ended){const R=await wj($).withFaceLandmarks().withFaceDescriptors(),N=JT(R,E);C.getContext("2d").clearRect(0,0,C.width,C.height),N.map(O=>w.findBestMatch(O.descriptor)).forEach((O,P)=>{const L=N[P].detection.box;let U=O.toString();O.distance>F1&&(U=vPe);const D=C.getContext("2d");D.lineWidth=2,D.strokeStyle="red",D.fillStyle="red",D.font="20px Arial";const F=N[P].landmarks,z=F.getLeftEye(),B=F.getRightEye(),j=(z[0].x+B[3].x)/2,Y=(z[0].y+B[3].y)/2,Q=D.measureText(U).width,ae=parseInt(D.font),se=j-Q/2,fe=Y-L.height/2-ae;D.fillText(U,se,fe+ae),D.strokeRect(L.x,L.y,L.width,L.height),O.distance<=F1&&(s(U.split(" ")[0]),a(!0))})}},1e3);return()=>clearInterval(_)};return Promise.all([ir.ssdMobilenetv1.loadFromUri("/models"),ir.faceRecognitionNet.loadFromUri("/models"),ir.faceLandmark68Net.loadFromUri("/models")]).then(()=>h().then(v)),()=>{n.current&&f()}},[]);const m=()=>{h()},g=()=>{f()},y=()=>{a(!1),l(!0),localStorage.setItem("shownLabel",i!=null?i:""),h()};return _e.useEffect(()=>{i==null&&localStorage.setItem("shownLabel","null"),localStorage.getItem("shownLabel")===i?l(!0):(l(!1),f())},[i]),ee.jsxs(ee.Fragment,{children:[ee.jsx("video",{ref:e,id:"video",width:"720",height:"560",autoPlay:!0,muted:!0,style:{margin:"0 auto",position:"absolute"}}),ee.jsx("canvas",{ref:t,style:{margin:"0 auto",position:"absolute"}}),ee.jsx("button",{onClick:m,style:{position:"absolute",bottom:"20px",left:"30%",transform:"translateX(-50%)",padding:"10px"},children:"Start Webcam"}),ee.jsx("button",{onClick:g,style:{position:"absolute",bottom:"20px",left:"60%",transform:"translateX(-50%)",padding:"10px"},children:"Stop Webcam"}),ee.jsx(_j,{isOpen:r&&!o,detectedLabel:i,onClose:y})]})};const wPe=e=>{function t(){e.typeid==!1?e.id.length!=5?console.log("id를 다시 확인해주세요."):(console.log(e.id+"님 입장 하셨습니다."),e.setisinOpen(!0)):e.id.length!=13?console.log("id를 다시 확인해주세요."):(console.log(e.id+"님 입장 하셨습니다."),e.setisinOpen(!0))}function n(){e.typeid==!1?e.id.length!=5?console.log("id를 다시 확인해주세요."):(console.log(e.id+"님 퇴장 하셨습니다."),e.setisoutOpen(!0)):e.id.length!=13?console.log("id를 다시 확인해주세요."):(console.log(e.id+"님 퇴장 하셨습니다."),e.setisoutOpen(!0))}function r(){console.log("직원 호출 중입니다.")}return ee.jsx(ee.Fragment,{children:ee.jsxs(Fs,{class:"btns",children:[ee.jsxs(nn,{children:[ee.jsx(rn,{class:"out_btn",children:ee.jsx(Or,{class:"out_btn",onClick:n,children:"퇴소하기"})}),ee.jsx(rn,{class:"call_btn",children:ee.jsx(Or,{class:"call_btn",onClick:r,trigger:e.trigger,children:"직원호출"})})]}),ee.jsx(nn,{children:ee.jsx(rn,{class:"in_btn",children:ee.jsx(Or,{class:"in_btn",onClick:t,trigger:e.trigger,children:"출석하기"})})})]})})};function kPe(e){const[t,n]=_e.useState(window.innerWidth),[r,a]=_e.useState("0000년 00월 00일() 00:00:00"),[i,s]=_e.useState("D-"),[o,l]=_e.useState(""),[c,u]=_e.useState(""),d=()=>{var f=new Date;const m=f.getFullYear(),g=f.getMonth()+1,y=f.getDate(),b=f.getHours(),v=f.getMinutes(),x=f.getSeconds();let $=["일","월","화","수","목","금","토"][f.getDay()];a("".concat(m,"년 ").concat(g,"월 ").concat(y,"일(").concat($,") ").concat(b,":").concat(v,":").concat(x));var C=new Date(2023,11,30);const E=String(C.getFullYear()),_=String(C.getMonth()+1).padStart(2,"0"),R=String(C.getDate()).padStart(2,"0");var N=C.getTime()-f.getTime(),I=Math.ceil(N/(1e3*60*60*24));u("".concat(E,"년 ").concat(_,"월 ").concat(R,"일")),s("D-".concat(I)),I>0&&l("사용중");const P=JSON.stringify({year:m,month:g,day:y,dayofweek:$,hour:b,minute:v,seconds:x});window.localStorage.setItem("times",P),console.log(P)};_e.useEffect(()=>(p(),window.addEventListener("resize",h),()=>{window.removeEventListener("resize",h)}),[]);const p=()=>{d()},h=()=>{n(window.innerWidth)};return ee.jsx(ee.Fragment,{children:ee.jsx("div",{id:"container",children:ee.jsxs(Fs,{children:[ee.jsx(nn,{children:ee.jsx(rn,{size:"12",children:ee.jsx("div",{style:{color:"black"},children:" 최민희 님 환영합니다."})})}),ee.jsx(nn,{children:ee.jsx(rn,{size:"12",children:ee.jsxs("div",{style:{color:"black"},children:["입장시간 :",r," "]})})}),ee.jsx(nn,{children:ee.jsx(rn,{size:"12",children:ee.jsxs("div",{style:{color:"black",display:"flex"},children:[ee.jsx("p",{style:{backgroundColor:"#DDEBF8",width:"53px",height:"19px",borderRadius:"3px",fontSize:"13px",color:"#232323",marginTop:"1.3rem"},children:o})," ",ee.jsx("p",{style:{fontSize:"18px",color:"#B1AEAF"},children:c})," ",ee.jsx("p",{style:{width:"70px",height:"25px",borderRadius:"3px",backgroundColor:"#FF6300",color:"white",fontSize:"18px",textAlign:"center"},children:i})]})})})]})})})}function SPe(){const e=_e.useRef(),t=_e.useRef();async function n(){var b,v;o(!1),c(!1),(b=e.current)==null||b.dismiss(),(v=t.current)==null||v.dismiss()}const[r,a]=_e.useState(window.innerWidth);_e.useState(window.innerHeight);const i=()=>{a(window.innerWidth)};_e.useEffect(()=>(window.addEventListener("resize",i),()=>{window.removeEventListener("resize",i)}),[]);const[s,o]=_e.useState(!1),[l,c]=_e.useState(!1),[u,d]=_e.useState("123"),[p,h]=_e.useState(!1),[f,m]=_e.useState("pw"),[g,y]=_e.useState(!1);return ee.jsx(ee.Fragment,{children:ee.jsxs(OL,{children:[ee.jsx(PA,{backdropDismiss:!1,isOpen:s,ref:e,children:ee.jsx(kPe,{dismiss:n})}),ee.jsx(PA,{backdropDismiss:!1,isOpen:l,ref:t}),ee.jsx("div",{className:"background-image-init"}),ee.jsx("div",{className:"background-image-img"}),ee.jsx("div",{className:"background-image-gradient"}),ee.jsx("div",{className:"content",children:ee.jsxs(Fs,{class:"window",children:[ee.jsx(nn,{class:"title",children:ee.jsx(rn,{children:ee.jsx(Aj,{})})}),window.innerWidth<=window.innerHeight?ee.jsx(nn,{class:"announcement",children:ee.jsx(rn,{class:"announcement",children:ee.jsx(Dj,{})})}):ee.jsx("div",{}),ee.jsxs(nn,{class:"bottom_side",children:[ee.jsx(rn,{size:"8",class:"main_input_box",children:ee.jsx("div",{className:"main_input_box",children:ee.jsx(Rj,{AlertFunc:d,settypeid:h})})}),ee.jsx(rn,{size:"4",class:"btn_and_face",children:ee.jsxs(Fs,{class:"btn_and_face",children:[ee.jsx(nn,{children:ee.jsx(rn,{class:"face",children:ee.jsx(xPe,{})})}),ee.jsx(nn,{children:ee.jsx(rn,{class:"btn",children:ee.jsx(wPe,{id:u,pw:f,face:g,setisinOpen:o,setisoutOpen:c,typeid:p})})})]})})]})]})})]})})}zL();const IPe=()=>ee.jsx(hY,{children:ee.jsx(zY,{children:ee.jsxs(kY,{children:[ee.jsxs(gl,{exact:!0,path:"/home",children:[ee.jsx(bY,{root:()=>ee.jsx(bPe,{})}),";"]}),ee.jsx(gl,{exact:!0,path:"/Main",children:ee.jsx(SPe,{})}),ee.jsx(gl,{exact:!0,path:"/",children:ee.jsx(k8,{to:"/Main"})}),ee.jsx(gl,{exact:!0,path:"/logo",children:ee.jsx(Aj,{})}),ee.jsx(gl,{exact:!0,path:"/announcement",children:ee.jsx(Dj,{})}),ee.jsx(gl,{exact:!0,path:"/numpad",children:ee.jsx(Rj,{})})]})})}),$Pe=document.getElementById("root"),CPe=JM($Pe);CPe.render(ee.jsx(oe.StrictMode,{children:ee.jsx(IPe,{})}));export{iL as K,EPe as __vite_legacy_guard,Jd as a,Qd as b,f$ as c,Ak as d,Rk as e,v7 as f,Bk as g,Pr as h,Lk as i,dA as j,PPe as k,pn as l,_Pe as m,TPe as n,NPe as p,ym as r,LPe as s,Ri as w};
