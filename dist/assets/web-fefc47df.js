import{W as c}from"./index-f816b9d3.js";class p extends c{constructor(){super({name:"CameraPreview",platforms:["web"]})}async start(e){return new Promise(async(r,o)=>{await navigator.mediaDevices.getUserMedia({audio:!e.disableAudio,video:!0}).then(t=>{t.getTracks().forEach(s=>s.stop())}).catch(t=>{o(t)});const a=document.getElementById("video"),i=document.getElementById(e.parent);if(a)o({message:"camera already started"});else{const t=document.createElement("video");t.id="video",t.setAttribute("class",e.className||""),e.position!=="rear"&&t.setAttribute("style","-webkit-transform: scaleX(-1); transform: scaleX(-1);");const s=navigator.userAgent.toLowerCase();if(s.includes("safari")&&!s.includes("chrome")&&(t.setAttribute("autoplay","true"),t.setAttribute("muted","true"),t.setAttribute("playsinline","true")),i.appendChild(t),navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){const d={video:{width:{ideal:e.width},height:{ideal:e.height}}};e.position==="rear"?(d.video.facingMode="environment",this.isBackCamera=!0):this.isBackCamera=!1,navigator.mediaDevices.getUserMedia(d).then(function(n){t.srcObject=n,t.play(),r({})},n=>{o(n)})}}})}async startRecordVideo(){throw this.unimplemented("Not implemented on web.")}async stopRecordVideo(){throw this.unimplemented("Not implemented on web.")}async stop(){const e=document.getElementById("video");if(e){e.pause();const o=e.srcObject.getTracks();for(let a=0;a<o.length;a++)o[a].stop();e.remove()}}async capture(e){return new Promise((r,o)=>{const a=document.getElementById("video"),i=document.createElement("canvas"),t=i.getContext("2d");i.width=a.videoWidth,i.height=a.videoHeight,this.isBackCamera||(t.translate(a.videoWidth,0),t.scale(-1,1)),t.drawImage(a,0,0,a.videoWidth,a.videoHeight);let s;e.quality!=null?s=i.toDataURL("image/jpeg",e.quality/100).replace("data:image/jpeg;base64,",""):s=i.toDataURL("image/png").replace("data:image/png;base64,",""),r({value:s})})}async captureSample(e){return this.capture(e)}async getSupportedFlashModes(){throw new Error("getSupportedFlashModes not supported under the web platform")}async setFlashMode(e){throw new Error("setFlashMode not supported under the web platform")}async flip(){throw new Error("flip not supported under the web platform")}async setOpacity(e){const r=document.getElementById("video");r&&e.opacity&&r.style.setProperty("opacity",e.opacity.toString())}}export{p as CameraPreviewWeb};
