System.register([],(function(e,t){"use strict";return{execute:function(){var n=document.createElement("style");function r(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}n.textContent='@media screen and (max-width: 768px){body{background-color:#90ee90}}ion-grid.input_box{background-color:#232323;width:100%;height:100%;margin:0 auto;padding:0}ion-row.input_box{background-color:#232323;border:0px}ion-col.input_box{padding:0 10px;border:0px;width:100%;height:100%}ion-row.input_segment{width:100%;height:60px;border:0px}.input_segment{--background: #232323}ion-segment-button::part(native){color:#fff}.segment-button-checked.md::part(native){color:#ff6300}ion-segment-button::part(indicator-background){background:#FF6300}ion-row.input_div_row{background-color:#232323;width:100%;height:84px;border:0px}div.input_div{background-color:#232323;color:#bababa;width:100%;height:84px;font-size:large;border:0px;display:flex;align-items:center;justify-content:center}ion-row.input_desc{background-color:#232323;width:100%;height:138px;border:0px}div.input_desc{background-color:#232323;color:#bababa;width:100%;height:100%;font-size:small;margin:0 28px;white-space:pre-line;line-height:30px;display:flex;align-items:center;text-align:left}.hr{border-bottom:1px solid #393A3A;border-radius:1px;margin:0;width:100%}ion-row.input_pad{background-color:#232323;height:298px;padding-top:9px;padding-bottom:9px;border:0px}ion-row.input_row{width:100%;height:70px;border:0px}ion-button.input_btn{--background: #313131;width:33.3%;height:60px;margin:5px 0;padding:0 1%;font-size:2rem}div.background-image-img{position:absolute;background-image:url(/assets/testimg-c9b9e420.jpg);background-repeat:no-repeat;background-size:contain;filter:blur(10px);width:100vw;height:100vh}@media (orientation: portrait){div.background-image-gradient{background:linear-gradient(rgba(255,255,255,0) 0%,rgb(0,0,0) 30%,rgba(0,0,0,1) 100%)}}@media (orientation: landscape){div.background-image-gradient{background:linear-gradient(rgba(255,255,255,0) 0%,rgb(0,0,0) 70%,rgba(0,0,0,1) 100%)}div.background-image-img{background-position:center}}div.background-image-gradient{position:absolute;width:100vw;height:100vh}div.background-image-init{position:absolute;background:linear-gradient(rgba(0,0,0,1),rgba(0,0,0,1));width:100vw;height:100vh}div.content{z-index:10}ion-grid.window{position:absolute;width:100%;height:100%;padding:40px}@media (orientation: portrait){ion-row.title{height:320px}}@media (orientation: landscape){ion-row.title{height:155px}}ion-row.title ion-col{border:0px}ion-row.announcement{height:300px;border:0px}ion-col.announcement{margin:0 auto;padding:5px;border:0px}ion-row.bottom_side{width:100%;height:590px;margin:0;padding:5px 0}ion-col.main_input_box{height:100%;border:0px;padding:0 5px;margin:5px 0}div.main_input_box{width:100%;height:100%;margin:0 auto;padding:0px auto}ion-col.btn_and_face{height:100%;margin:0;padding:0}ion-col.face{width:100%;height:420px;margin-bottom:20px;position:relative}ion-col.face video{width:100%;height:100%}ion-col.face .Selfie{width:100%;height:100%}ion-col.btn{width:100%;height:140px;border:0px;padding:0}ion-modal{--width: 640px;--height: 710px;--border-radius: 10px;--background: #232323}.Check_logo{margin:auto;display:block;width:47.05px;height:57.35px;left:12.93px;top:8.36px}.modal_text{text-align:center}.modal_h2{font-family:Noto Sans KR;font-style:normal;font-weight:700;color:#fff}.btn_block{width:100%;height:100%;left:calc(50% - 300px);background:#313131;border-radius:10px;z-index:1}.modal_button{display:flex;justify-content:center;gap:20px}.modal_button .btn_attandance{display:inline-block;width:50%;height:50px;margin-left:40px;margin-bottom:20px;background:#FF6300;border-radius:5px;color:#fff;font-weight:700;font-size:15px}.modal_button .btn_cancel{width:50%;height:50px;margin-right:40px;margin-bottom:20px;background:#A8B1CE;border-radius:5px;color:#fff;font-weight:700;font-size:15px}.Member_Number{display:flex;justify-content:center;gap:20px;margin-top:15px;margin-bottom:15px;font-weight:700}.num_text{color:#848484}.real_num{color:#fff}ion-button{--background: #FF6300}.head{display:flex;margin-left:"0.3%";margin-top:3%}.body2{background-color:#313131;width:360px;height:180px;border-radius:10px;padding-left:26px}.body2_name{font-size:20px;color:#fff;font-weight:700;display:flex}.body2_nim{margin-top:7.1%;margin-left:.3%}.body2_welcome{font-size:26px;margin-top:5.2%;margin-left:2.7%}.body2_time{margin-top:-6%;font-size:18px;color:#b1aeaf}.body2_p1{font-size:18px;font-weight:400;color:#b1aeaf;display:flex}.body2_p2{margin-top:-9%;font-size:18px;color:#b1aeaf;display:flex}.body2_mil{letter-spacing:-.3px}.body2_score{margin-left:5%;font-weight:700;letter-spacing:.8px}.body3{width:600px;height:100px;background-color:#313131;border-radius:10px;padding-left:20px;padding-top:17px;margin-left:.3%}.body3_circle{width:65px;height:65px;border-radius:100px;background-color:#fdefe5}.body3_p1{margin-left:14%;margin-top:-13.8%}.body3_p1_finish{font-weight:700;font-size:18px;color:#848484;letter-spacing:-.3px}.body3_p1_r{display:flex;margin-left:28%;margin-top:-12.2%}.body3_p1_r_date{font-size:18px;color:#b1aeaf;font-weight:400}.dday{width:70px;height:25px;border-radius:3px;background-color:#ff6300;color:#fff;font-size:18px;text-align:center;margin-left:2%}.body3_p2{margin-left:14%;margin-top:-4.5%}.body3_p2_product{font-weight:700;font-size:18px;color:#848484;letter-spacing:-.3px}.body3_p2_r{display:flex;margin-left:28%;margin-top:-12.2%}.use{background-color:#ddebf8;width:53px;height:19px;border-radius:3px;font-size:13px;color:#232323;text-align:center;margin-top:5.5%}.body4_date{font-size:18px;color:#b1aeaf;margin-left:2%;font-weight:400}.body5{width:600px;height:140px;background-color:#313131;border-radius:10px;padding-left:20px;padding-top:17px;margin-left:.3%}.body5_circle{width:65px;height:65px;border-radius:100px;background-color:#fdefe5;margin-top:4%}.body5_p1{margin-left:14%;margin-top:-16.8%}.body5_p2{margin-left:14%;margin-top:-4.8%}.body5_left{font-size:18px;color:#ff6300;font-weight:700}.body5_left2{font-size:18px;color:#b1aeaf;margin-left:.8%;font-weight:400}.btnn{margin-left:28%;margin-right:31%;margin-top:9%}.btns{margin:0;padding:0}ion-col.out_btn{color:#000;border:0px;width:48%;height:65px;margin:0 0 5px;padding:0 1% 0 0}ion-button.out_btn{--background: #A8B1CE;width:100%;height:100%;margin:0;padding:0}ion-col.call_btn{color:#000;width:48%;border:0px;height:65px;margin:0 0 5px;padding:0 0 0 1%}ion-button.call_btn{--background: #2C3D8F;width:100%;height:100%;margin:0;padding:0}ion-col.in_btn{color:#000;border:0px;height:65px;margin:5px 0 0;padding:0}ion-button.in_btn{--background: #FF6300;width:100%;height:100%;margin:0;padding:0;font-size:large}html.ios{--ion-default-font: -apple-system, BlinkMacSystemFont, "Helvetica Neue", "Roboto", sans-serif}html.md{--ion-default-font: "Roboto", "Helvetica Neue", sans-serif}html{--ion-font-family: var(--ion-default-font)}body{background:var(--ion-background-color)}body.backdrop-no-scroll{overflow:hidden}html.ios ion-modal.modal-card ion-header ion-toolbar:first-of-type,html.ios ion-modal.modal-sheet ion-header ion-toolbar:first-of-type,html.ios ion-modal ion-footer ion-toolbar:first-of-type{padding-top:6px}html.ios ion-modal.modal-card ion-header ion-toolbar:last-of-type,html.ios ion-modal.modal-sheet ion-header ion-toolbar:last-of-type{padding-bottom:6px}html.ios ion-modal ion-toolbar{padding-right:calc(var(--ion-safe-area-right) + 8px);padding-left:calc(var(--ion-safe-area-left) + 8px)}@media screen and (min-width: 768px){html.ios ion-modal.modal-card:first-of-type{--backdrop-opacity: .18}}ion-modal.modal-default.show-modal~ion-modal.modal-default{--backdrop-opacity: 0;--box-shadow: none}html.ios ion-modal.modal-card .ion-page{border-top-left-radius:var(--border-radius)}.ion-color-primary{--ion-color-base: var(--ion-color-primary, #3880ff) !important;--ion-color-base-rgb: var(--ion-color-primary-rgb, 56, 128, 255) !important;--ion-color-contrast: var(--ion-color-primary-contrast, #fff) !important;--ion-color-contrast-rgb: var(--ion-color-primary-contrast-rgb, 255, 255, 255) !important;--ion-color-shade: var(--ion-color-primary-shade, #3171e0) !important;--ion-color-tint: var(--ion-color-primary-tint, #4c8dff) !important}.ion-color-secondary{--ion-color-base: var(--ion-color-secondary, #3dc2ff) !important;--ion-color-base-rgb: var(--ion-color-secondary-rgb, 61, 194, 255) !important;--ion-color-contrast: var(--ion-color-secondary-contrast, #fff) !important;--ion-color-contrast-rgb: var(--ion-color-secondary-contrast-rgb, 255, 255, 255) !important;--ion-color-shade: var(--ion-color-secondary-shade, #36abe0) !important;--ion-color-tint: var(--ion-color-secondary-tint, #50c8ff) !important}.ion-color-tertiary{--ion-color-base: var(--ion-color-tertiary, #5260ff) !important;--ion-color-base-rgb: var(--ion-color-tertiary-rgb, 82, 96, 255) !important;--ion-color-contrast: var(--ion-color-tertiary-contrast, #fff) !important;--ion-color-contrast-rgb: var(--ion-color-tertiary-contrast-rgb, 255, 255, 255) !important;--ion-color-shade: var(--ion-color-tertiary-shade, #4854e0) !important;--ion-color-tint: var(--ion-color-tertiary-tint, #6370ff) !important}.ion-color-success{--ion-color-base: var(--ion-color-success, #2dd36f) !important;--ion-color-base-rgb: var(--ion-color-success-rgb, 45, 211, 111) !important;--ion-color-contrast: var(--ion-color-success-contrast, #fff) !important;--ion-color-contrast-rgb: var(--ion-color-success-contrast-rgb, 255, 255, 255) !important;--ion-color-shade: var(--ion-color-success-shade, #28ba62) !important;--ion-color-tint: var(--ion-color-success-tint, #42d77d) !important}.ion-color-warning{--ion-color-base: var(--ion-color-warning, #ffc409) !important;--ion-color-base-rgb: var(--ion-color-warning-rgb, 255, 196, 9) !important;--ion-color-contrast: var(--ion-color-warning-contrast, #000) !important;--ion-color-contrast-rgb: var(--ion-color-warning-contrast-rgb, 0, 0, 0) !important;--ion-color-shade: var(--ion-color-warning-shade, #e0ac08) !important;--ion-color-tint: var(--ion-color-warning-tint, #ffca22) !important}.ion-color-danger{--ion-color-base: var(--ion-color-danger, #eb445a) !important;--ion-color-base-rgb: var(--ion-color-danger-rgb, 235, 68, 90) !important;--ion-color-contrast: var(--ion-color-danger-contrast, #fff) !important;--ion-color-contrast-rgb: var(--ion-color-danger-contrast-rgb, 255, 255, 255) !important;--ion-color-shade: var(--ion-color-danger-shade, #cf3c4f) !important;--ion-color-tint: var(--ion-color-danger-tint, #ed576b) !important}.ion-color-light{--ion-color-base: var(--ion-color-light, #f4f5f8) !important;--ion-color-base-rgb: var(--ion-color-light-rgb, 244, 245, 248) !important;--ion-color-contrast: var(--ion-color-light-contrast, #000) !important;--ion-color-contrast-rgb: var(--ion-color-light-contrast-rgb, 0, 0, 0) !important;--ion-color-shade: var(--ion-color-light-shade, #d7d8da) !important;--ion-color-tint: var(--ion-color-light-tint, #f5f6f9) !important}.ion-color-medium{--ion-color-base: var(--ion-color-medium, #92949c) !important;--ion-color-base-rgb: var(--ion-color-medium-rgb, 146, 148, 156) !important;--ion-color-contrast: var(--ion-color-medium-contrast, #fff) !important;--ion-color-contrast-rgb: var(--ion-color-medium-contrast-rgb, 255, 255, 255) !important;--ion-color-shade: var(--ion-color-medium-shade, #808289) !important;--ion-color-tint: var(--ion-color-medium-tint, #9d9fa6) !important}.ion-color-dark{--ion-color-base: var(--ion-color-dark, #222428) !important;--ion-color-base-rgb: var(--ion-color-dark-rgb, 34, 36, 40) !important;--ion-color-contrast: var(--ion-color-dark-contrast, #fff) !important;--ion-color-contrast-rgb: var(--ion-color-dark-contrast-rgb, 255, 255, 255) !important;--ion-color-shade: var(--ion-color-dark-shade, #1e2023) !important;--ion-color-tint: var(--ion-color-dark-tint, #383a3e) !important}.ion-page{left:0;right:0;top:0;bottom:0;display:flex;position:absolute;flex-direction:column;justify-content:space-between;contain:layout size style;overflow:hidden;z-index:0}ion-modal>.ion-page{position:relative;contain:layout style;height:100%}.split-pane-visible>.ion-page.split-pane-main{position:relative}ion-route,ion-route-redirect,ion-router,ion-select-option,ion-nav-controller,ion-menu-controller,ion-action-sheet-controller,ion-alert-controller,ion-loading-controller,ion-modal-controller,ion-picker-controller,ion-popover-controller,ion-toast-controller,.ion-page-hidden{display:none!important}.ion-page-invisible{opacity:0}.can-go-back>ion-header ion-back-button{display:block}html.plt-ios.plt-hybrid,html.plt-ios.plt-pwa{--ion-statusbar-padding: 20px}@supports (padding-top: 20px){html{--ion-safe-area-top: var(--ion-statusbar-padding)}}@supports (padding-top: constant(safe-area-inset-top)){html{--ion-safe-area-top: constant(safe-area-inset-top);--ion-safe-area-bottom: constant(safe-area-inset-bottom);--ion-safe-area-left: constant(safe-area-inset-left);--ion-safe-area-right: constant(safe-area-inset-right)}}@supports (padding-top: env(safe-area-inset-top)){html{--ion-safe-area-top: env(safe-area-inset-top);--ion-safe-area-bottom: env(safe-area-inset-bottom);--ion-safe-area-left: env(safe-area-inset-left);--ion-safe-area-right: env(safe-area-inset-right)}}ion-card.ion-color .ion-inherit-color,ion-card-header.ion-color .ion-inherit-color{color:inherit}.menu-content{transform:translateZ(0)}.menu-content-open{cursor:pointer;touch-action:manipulation;pointer-events:none}.ios .menu-content-reveal{box-shadow:-8px 0 42px rgba(0,0,0,.08)}[dir=rtl].ios .menu-content-reveal{box-shadow:8px 0 42px rgba(0,0,0,.08)}.md .menu-content-reveal,.md .menu-content-push{box-shadow:4px 0 16px rgba(0,0,0,.18)}ion-accordion-group.accordion-group-expand-inset>ion-accordion:first-of-type{border-top-left-radius:8px;border-top-right-radius:8px}ion-accordion-group.accordion-group-expand-inset>ion-accordion:last-of-type{border-bottom-left-radius:8px;border-bottom-right-radius:8px}ion-accordion-group>ion-accordion:last-of-type ion-item[slot=header]{--border-width: 0px}ion-accordion.accordion-animated>[slot=header] .ion-accordion-toggle-icon{transition:.3s transform cubic-bezier(.25,.8,.5,1)}@media (prefers-reduced-motion: reduce){ion-accordion .ion-accordion-toggle-icon{transition:none!important}}ion-accordion.accordion-expanding>[slot=header] .ion-accordion-toggle-icon,ion-accordion.accordion-expanded>[slot=header] .ion-accordion-toggle-icon{transform:rotate(180deg)}ion-accordion-group.accordion-group-expand-inset.md>ion-accordion.accordion-previous ion-item[slot=header]{--border-width: 0px;--inner-border-width: 0px}ion-accordion-group.accordion-group-expand-inset.md>ion-accordion.accordion-expanding:first-of-type,ion-accordion-group.accordion-group-expand-inset.md>ion-accordion.accordion-expanded:first-of-type{margin-top:0}ion-input input::-webkit-date-and-time-value{text-align:start}.ion-datetime-button-overlay{--width: fit-content;--height: fit-content}.ion-datetime-button-overlay ion-datetime.datetime-grid{width:320px;min-height:320px}audio,canvas,progress,video{vertical-align:baseline}audio:not([controls]){display:none;height:0}b,strong{font-weight:700}img{max-width:100%}hr{height:1px;border-width:0;box-sizing:content-box}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}label,input,select,textarea{font-family:inherit;line-height:normal}textarea{overflow:auto;height:auto;font:inherit;color:inherit}textarea::placeholder{padding-left:2px}form,input,optgroup,select{margin:0;font:inherit;color:inherit}html input[type=button],input[type=reset],input[type=submit]{cursor:pointer;-webkit-appearance:button}a,a div,a span,a ion-icon,a ion-label,button,button div,button span,button ion-icon,button ion-label,.ion-tappable,[tappable],[tappable] div,[tappable] span,[tappable] ion-icon,[tappable] ion-label,input,textarea{touch-action:manipulation}a ion-label,button ion-label{pointer-events:none}button{padding:0;border:0;border-radius:0;font-family:inherit;font-style:inherit;font-variant:inherit;line-height:1;text-transform:none;cursor:pointer;-webkit-appearance:button}[tappable]{cursor:pointer}a[disabled],button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{padding:0;border:0}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{height:auto}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration{-webkit-appearance:none}table{border-collapse:collapse;border-spacing:0}td,th{padding:0}*{box-sizing:border-box;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none}html{width:100%;height:100%;text-size-adjust:100%}html:not(.hydrated) body{display:none}html.ion-ce body{display:block}html.plt-pwa{height:100vh}body{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:0;padding:0;position:fixed;width:100%;max-width:100%;height:100%;max-height:100%;transform:translateZ(0);text-rendering:optimizeLegibility;overflow:hidden;touch-action:manipulation;-webkit-user-drag:none;-ms-content-zooming:none;word-wrap:break-word;overscroll-behavior-y:none;text-size-adjust:none}html{font-family:var(--ion-font-family)}a{background-color:transparent;color:var(--ion-color-primary, #3880ff)}h1,h2,h3,h4,h5,h6{margin-top:16px;margin-bottom:10px;font-weight:500;line-height:1.2}h1{margin-top:20px;font-size:26px}h2{margin-top:18px;font-size:24px}h3{font-size:22px}h4{font-size:20px}h5{font-size:18px}h6{font-size:16px}small{font-size:75%}sub,sup{position:relative;font-size:75%;line-height:0;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}.ion-no-padding{--padding-start: 0;--padding-end: 0;--padding-top: 0;--padding-bottom: 0;padding:0}.ion-padding{--padding-start: var(--ion-padding, 16px);--padding-end: var(--ion-padding, 16px);--padding-top: var(--ion-padding, 16px);--padding-bottom: var(--ion-padding, 16px);-webkit-padding-start:var(--ion-padding, 16px);padding-inline-start:var(--ion-padding, 16px);-webkit-padding-end:var(--ion-padding, 16px);padding-inline-end:var(--ion-padding, 16px);padding-top:var(--ion-padding, 16px);padding-bottom:var(--ion-padding, 16px)}.ion-padding-top{--padding-top: var(--ion-padding, 16px);padding-top:var(--ion-padding, 16px)}.ion-padding-start{--padding-start: var(--ion-padding, 16px);-webkit-padding-start:var(--ion-padding, 16px);padding-inline-start:var(--ion-padding, 16px)}.ion-padding-end{--padding-end: var(--ion-padding, 16px);-webkit-padding-end:var(--ion-padding, 16px);padding-inline-end:var(--ion-padding, 16px)}.ion-padding-bottom{--padding-bottom: var(--ion-padding, 16px);padding-bottom:var(--ion-padding, 16px)}.ion-padding-vertical{--padding-top: var(--ion-padding, 16px);--padding-bottom: var(--ion-padding, 16px);padding-top:var(--ion-padding, 16px);padding-bottom:var(--ion-padding, 16px)}.ion-padding-horizontal{--padding-start: var(--ion-padding, 16px);--padding-end: var(--ion-padding, 16px);-webkit-padding-start:var(--ion-padding, 16px);padding-inline-start:var(--ion-padding, 16px);-webkit-padding-end:var(--ion-padding, 16px);padding-inline-end:var(--ion-padding, 16px)}.ion-no-margin{--margin-start: 0;--margin-end: 0;--margin-top: 0;--margin-bottom: 0;margin:0}.ion-margin{--margin-start: var(--ion-margin, 16px);--margin-end: var(--ion-margin, 16px);--margin-top: var(--ion-margin, 16px);--margin-bottom: var(--ion-margin, 16px);-webkit-margin-start:var(--ion-margin, 16px);margin-inline-start:var(--ion-margin, 16px);-webkit-margin-end:var(--ion-margin, 16px);margin-inline-end:var(--ion-margin, 16px);margin-top:var(--ion-margin, 16px);margin-bottom:var(--ion-margin, 16px)}.ion-margin-top{--margin-top: var(--ion-margin, 16px);margin-top:var(--ion-margin, 16px)}.ion-margin-start{--margin-start: var(--ion-margin, 16px);-webkit-margin-start:var(--ion-margin, 16px);margin-inline-start:var(--ion-margin, 16px)}.ion-margin-end{--margin-end: var(--ion-margin, 16px);-webkit-margin-end:var(--ion-margin, 16px);margin-inline-end:var(--ion-margin, 16px)}.ion-margin-bottom{--margin-bottom: var(--ion-margin, 16px);margin-bottom:var(--ion-margin, 16px)}.ion-margin-vertical{--margin-top: var(--ion-margin, 16px);--margin-bottom: var(--ion-margin, 16px);margin-top:var(--ion-margin, 16px);margin-bottom:var(--ion-margin, 16px)}.ion-margin-horizontal{--margin-start: var(--ion-margin, 16px);--margin-end: var(--ion-margin, 16px);-webkit-margin-start:var(--ion-margin, 16px);margin-inline-start:var(--ion-margin, 16px);-webkit-margin-end:var(--ion-margin, 16px);margin-inline-end:var(--ion-margin, 16px)}.ion-float-left{float:left!important}.ion-float-right{float:right!important}.ion-float-start{float:left!important}:host-context([dir=rtl]) .ion-float-start{float:right!important}[dir=rtl] .ion-float-start{float:right!important}@supports selector(:dir(rtl)){.ion-float-start:dir(rtl){float:right!important}}.ion-float-end{float:right!important}:host-context([dir=rtl]) .ion-float-end{float:left!important}[dir=rtl] .ion-float-end{float:left!important}@supports selector(:dir(rtl)){.ion-float-end:dir(rtl){float:left!important}}@media (min-width: 576px){.ion-float-sm-left{float:left!important}.ion-float-sm-right{float:right!important}.ion-float-sm-start{float:left!important}:host-context([dir=rtl]) .ion-float-sm-start{float:right!important}[dir=rtl] .ion-float-sm-start{float:right!important}@supports selector(:dir(rtl)){.ion-float-sm-start:dir(rtl){float:right!important}}.ion-float-sm-end{float:right!important}:host-context([dir=rtl]) .ion-float-sm-end{float:left!important}[dir=rtl] .ion-float-sm-end{float:left!important}@supports selector(:dir(rtl)){.ion-float-sm-end:dir(rtl){float:left!important}}}@media (min-width: 768px){.ion-float-md-left{float:left!important}.ion-float-md-right{float:right!important}.ion-float-md-start{float:left!important}:host-context([dir=rtl]) .ion-float-md-start{float:right!important}[dir=rtl] .ion-float-md-start{float:right!important}@supports selector(:dir(rtl)){.ion-float-md-start:dir(rtl){float:right!important}}.ion-float-md-end{float:right!important}:host-context([dir=rtl]) .ion-float-md-end{float:left!important}[dir=rtl] .ion-float-md-end{float:left!important}@supports selector(:dir(rtl)){.ion-float-md-end:dir(rtl){float:left!important}}}@media (min-width: 992px){.ion-float-lg-left{float:left!important}.ion-float-lg-right{float:right!important}.ion-float-lg-start{float:left!important}:host-context([dir=rtl]) .ion-float-lg-start{float:right!important}[dir=rtl] .ion-float-lg-start{float:right!important}@supports selector(:dir(rtl)){.ion-float-lg-start:dir(rtl){float:right!important}}.ion-float-lg-end{float:right!important}:host-context([dir=rtl]) .ion-float-lg-end{float:left!important}[dir=rtl] .ion-float-lg-end{float:left!important}@supports selector(:dir(rtl)){.ion-float-lg-end:dir(rtl){float:left!important}}}@media (min-width: 1200px){.ion-float-xl-left{float:left!important}.ion-float-xl-right{float:right!important}.ion-float-xl-start{float:left!important}:host-context([dir=rtl]) .ion-float-xl-start{float:right!important}[dir=rtl] .ion-float-xl-start{float:right!important}@supports selector(:dir(rtl)){.ion-float-xl-start:dir(rtl){float:right!important}}.ion-float-xl-end{float:right!important}:host-context([dir=rtl]) .ion-float-xl-end{float:left!important}[dir=rtl] .ion-float-xl-end{float:left!important}@supports selector(:dir(rtl)){.ion-float-xl-end:dir(rtl){float:left!important}}}.ion-text-center{text-align:center!important}.ion-text-justify{text-align:justify!important}.ion-text-start{text-align:start!important}.ion-text-end{text-align:end!important}.ion-text-left{text-align:left!important}.ion-text-right{text-align:right!important}.ion-text-nowrap{white-space:nowrap!important}.ion-text-wrap{white-space:normal!important}@media (min-width: 576px){.ion-text-sm-center{text-align:center!important}.ion-text-sm-justify{text-align:justify!important}.ion-text-sm-start{text-align:start!important}.ion-text-sm-end{text-align:end!important}.ion-text-sm-left{text-align:left!important}.ion-text-sm-right{text-align:right!important}.ion-text-sm-nowrap{white-space:nowrap!important}.ion-text-sm-wrap{white-space:normal!important}}@media (min-width: 768px){.ion-text-md-center{text-align:center!important}.ion-text-md-justify{text-align:justify!important}.ion-text-md-start{text-align:start!important}.ion-text-md-end{text-align:end!important}.ion-text-md-left{text-align:left!important}.ion-text-md-right{text-align:right!important}.ion-text-md-nowrap{white-space:nowrap!important}.ion-text-md-wrap{white-space:normal!important}}@media (min-width: 992px){.ion-text-lg-center{text-align:center!important}.ion-text-lg-justify{text-align:justify!important}.ion-text-lg-start{text-align:start!important}.ion-text-lg-end{text-align:end!important}.ion-text-lg-left{text-align:left!important}.ion-text-lg-right{text-align:right!important}.ion-text-lg-nowrap{white-space:nowrap!important}.ion-text-lg-wrap{white-space:normal!important}}@media (min-width: 1200px){.ion-text-xl-center{text-align:center!important}.ion-text-xl-justify{text-align:justify!important}.ion-text-xl-start{text-align:start!important}.ion-text-xl-end{text-align:end!important}.ion-text-xl-left{text-align:left!important}.ion-text-xl-right{text-align:right!important}.ion-text-xl-nowrap{white-space:nowrap!important}.ion-text-xl-wrap{white-space:normal!important}}.ion-text-uppercase{text-transform:uppercase!important}.ion-text-lowercase{text-transform:lowercase!important}.ion-text-capitalize{text-transform:capitalize!important}@media (min-width: 576px){.ion-text-sm-uppercase{text-transform:uppercase!important}.ion-text-sm-lowercase{text-transform:lowercase!important}.ion-text-sm-capitalize{text-transform:capitalize!important}}@media (min-width: 768px){.ion-text-md-uppercase{text-transform:uppercase!important}.ion-text-md-lowercase{text-transform:lowercase!important}.ion-text-md-capitalize{text-transform:capitalize!important}}@media (min-width: 992px){.ion-text-lg-uppercase{text-transform:uppercase!important}.ion-text-lg-lowercase{text-transform:lowercase!important}.ion-text-lg-capitalize{text-transform:capitalize!important}}@media (min-width: 1200px){.ion-text-xl-uppercase{text-transform:uppercase!important}.ion-text-xl-lowercase{text-transform:lowercase!important}.ion-text-xl-capitalize{text-transform:capitalize!important}}.ion-align-self-start{align-self:flex-start!important}.ion-align-self-end{align-self:flex-end!important}.ion-align-self-center{align-self:center!important}.ion-align-self-stretch{align-self:stretch!important}.ion-align-self-baseline{align-self:baseline!important}.ion-align-self-auto{align-self:auto!important}.ion-wrap{flex-wrap:wrap!important}.ion-nowrap{flex-wrap:nowrap!important}.ion-wrap-reverse{flex-wrap:wrap-reverse!important}.ion-justify-content-start{justify-content:flex-start!important}.ion-justify-content-center{justify-content:center!important}.ion-justify-content-end{justify-content:flex-end!important}.ion-justify-content-around{justify-content:space-around!important}.ion-justify-content-between{justify-content:space-between!important}.ion-justify-content-evenly{justify-content:space-evenly!important}.ion-align-items-start{align-items:flex-start!important}.ion-align-items-center{align-items:center!important}.ion-align-items-end{align-items:flex-end!important}.ion-align-items-stretch{align-items:stretch!important}.ion-align-items-baseline{align-items:baseline!important}.ion-hide,.ion-hide-up,.ion-hide-down{display:none!important}@media (min-width: 576px){.ion-hide-sm-up{display:none!important}}@media (max-width: 575.98px){.ion-hide-sm-down{display:none!important}}@media (min-width: 768px){.ion-hide-md-up{display:none!important}}@media (max-width: 767.98px){.ion-hide-md-down{display:none!important}}@media (min-width: 992px){.ion-hide-lg-up{display:none!important}}@media (max-width: 991.98px){.ion-hide-lg-down{display:none!important}}@media (min-width: 1200px){.ion-hide-xl-up{display:none!important}}@media (max-width: 1199.98px){.ion-hide-xl-down{display:none!important}}:root{--ion-color-primary: #3880ff;--ion-color-primary-rgb: 56, 128, 255;--ion-color-primary-contrast: #ffffff;--ion-color-primary-contrast-rgb: 255, 255, 255;--ion-color-primary-shade: #3171e0;--ion-color-primary-tint: #4c8dff;--ion-color-secondary: #3dc2ff;--ion-color-secondary-rgb: 61, 194, 255;--ion-color-secondary-contrast: #ffffff;--ion-color-secondary-contrast-rgb: 255, 255, 255;--ion-color-secondary-shade: #36abe0;--ion-color-secondary-tint: #50c8ff;--ion-color-tertiary: #5260ff;--ion-color-tertiary-rgb: 82, 96, 255;--ion-color-tertiary-contrast: #ffffff;--ion-color-tertiary-contrast-rgb: 255, 255, 255;--ion-color-tertiary-shade: #4854e0;--ion-color-tertiary-tint: #6370ff;--ion-color-success: #2dd36f;--ion-color-success-rgb: 45, 211, 111;--ion-color-success-contrast: #ffffff;--ion-color-success-contrast-rgb: 255, 255, 255;--ion-color-success-shade: #28ba62;--ion-color-success-tint: #42d77d;--ion-color-warning: #ffc409;--ion-color-warning-rgb: 255, 196, 9;--ion-color-warning-contrast: #000000;--ion-color-warning-contrast-rgb: 0, 0, 0;--ion-color-warning-shade: #e0ac08;--ion-color-warning-tint: #ffca22;--ion-color-danger: #eb445a;--ion-color-danger-rgb: 235, 68, 90;--ion-color-danger-contrast: #ffffff;--ion-color-danger-contrast-rgb: 255, 255, 255;--ion-color-danger-shade: #cf3c4f;--ion-color-danger-tint: #ed576b;--ion-color-dark: #222428;--ion-color-dark-rgb: 34, 36, 40;--ion-color-dark-contrast: #ffffff;--ion-color-dark-contrast-rgb: 255, 255, 255;--ion-color-dark-shade: #1e2023;--ion-color-dark-tint: #383a3e;--ion-color-medium: #92949c;--ion-color-medium-rgb: 146, 148, 156;--ion-color-medium-contrast: #ffffff;--ion-color-medium-contrast-rgb: 255, 255, 255;--ion-color-medium-shade: #808289;--ion-color-medium-tint: #9d9fa6;--ion-color-light: #f4f5f8;--ion-color-light-rgb: 244, 245, 248;--ion-color-light-contrast: #000000;--ion-color-light-contrast-rgb: 0, 0, 0;--ion-color-light-shade: #d7d8da;--ion-color-light-tint: #f5f6f9}@media (prefers-color-scheme: dark){body{--ion-color-primary: #428cff;--ion-color-primary-rgb: 66,140,255;--ion-color-primary-contrast: #ffffff;--ion-color-primary-contrast-rgb: 255,255,255;--ion-color-primary-shade: #3a7be0;--ion-color-primary-tint: #5598ff;--ion-color-secondary: #50c8ff;--ion-color-secondary-rgb: 80,200,255;--ion-color-secondary-contrast: #ffffff;--ion-color-secondary-contrast-rgb: 255,255,255;--ion-color-secondary-shade: #46b0e0;--ion-color-secondary-tint: #62ceff;--ion-color-tertiary: #6a64ff;--ion-color-tertiary-rgb: 106,100,255;--ion-color-tertiary-contrast: #ffffff;--ion-color-tertiary-contrast-rgb: 255,255,255;--ion-color-tertiary-shade: #5d58e0;--ion-color-tertiary-tint: #7974ff;--ion-color-success: #2fdf75;--ion-color-success-rgb: 47,223,117;--ion-color-success-contrast: #000000;--ion-color-success-contrast-rgb: 0,0,0;--ion-color-success-shade: #29c467;--ion-color-success-tint: #44e283;--ion-color-warning: #ffd534;--ion-color-warning-rgb: 255,213,52;--ion-color-warning-contrast: #000000;--ion-color-warning-contrast-rgb: 0,0,0;--ion-color-warning-shade: #e0bb2e;--ion-color-warning-tint: #ffd948;--ion-color-danger: #ff4961;--ion-color-danger-rgb: 255,73,97;--ion-color-danger-contrast: #ffffff;--ion-color-danger-contrast-rgb: 255,255,255;--ion-color-danger-shade: #e04055;--ion-color-danger-tint: #ff5b71;--ion-color-dark: #f4f5f8;--ion-color-dark-rgb: 244,245,248;--ion-color-dark-contrast: #000000;--ion-color-dark-contrast-rgb: 0,0,0;--ion-color-dark-shade: #d7d8da;--ion-color-dark-tint: #f5f6f9;--ion-color-medium: #989aa2;--ion-color-medium-rgb: 152,154,162;--ion-color-medium-contrast: #000000;--ion-color-medium-contrast-rgb: 0,0,0;--ion-color-medium-shade: #86888f;--ion-color-medium-tint: #a2a4ab;--ion-color-light: #222428;--ion-color-light-rgb: 34,36,40;--ion-color-light-contrast: #ffffff;--ion-color-light-contrast-rgb: 255,255,255;--ion-color-light-shade: #1e2023;--ion-color-light-tint: #383a3e}.ios body{--ion-background-color: #000000;--ion-background-color-rgb: 0,0,0;--ion-text-color: #ffffff;--ion-text-color-rgb: 255,255,255;--ion-color-step-50: #0d0d0d;--ion-color-step-100: #1a1a1a;--ion-color-step-150: #262626;--ion-color-step-200: #333333;--ion-color-step-250: #404040;--ion-color-step-300: #4d4d4d;--ion-color-step-350: #595959;--ion-color-step-400: #666666;--ion-color-step-450: #737373;--ion-color-step-500: #808080;--ion-color-step-550: #8c8c8c;--ion-color-step-600: #999999;--ion-color-step-650: #a6a6a6;--ion-color-step-700: #b3b3b3;--ion-color-step-750: #bfbfbf;--ion-color-step-800: #cccccc;--ion-color-step-850: #d9d9d9;--ion-color-step-900: #e6e6e6;--ion-color-step-950: #f2f2f2;--ion-item-background: #000000;--ion-card-background: #1c1c1d}.ios ion-modal{--ion-background-color: var(--ion-color-step-100);--ion-toolbar-background: var(--ion-color-step-150);--ion-toolbar-border-color: var(--ion-color-step-250)}.md body{--ion-background-color: #121212;--ion-background-color-rgb: 18,18,18;--ion-text-color: #ffffff;--ion-text-color-rgb: 255,255,255;--ion-border-color: #222222;--ion-color-step-50: #1e1e1e;--ion-color-step-100: #2a2a2a;--ion-color-step-150: #363636;--ion-color-step-200: #414141;--ion-color-step-250: #4d4d4d;--ion-color-step-300: #595959;--ion-color-step-350: #656565;--ion-color-step-400: #717171;--ion-color-step-450: #7d7d7d;--ion-color-step-500: #898989;--ion-color-step-550: #949494;--ion-color-step-600: #a0a0a0;--ion-color-step-650: #acacac;--ion-color-step-700: #b8b8b8;--ion-color-step-750: #c4c4c4;--ion-color-step-800: #d0d0d0;--ion-color-step-850: #dbdbdb;--ion-color-step-900: #e7e7e7;--ion-color-step-950: #f3f3f3;--ion-item-background: #1e1e1e;--ion-toolbar-background: #1f1f1f;--ion-tab-bar-background: #1f1f1f;--ion-card-background: #1e1e1e}}\n',document.head.appendChild(n);var a={exports:{}},i={},s={exports:{}},o={},l=Symbol.for("react.element"),u=Symbol.for("react.portal"),d=Symbol.for("react.fragment"),c=Symbol.for("react.strict_mode"),p=Symbol.for("react.profiler"),h=Symbol.for("react.provider"),f=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),b=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),v=Symbol.iterator,x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,k={};function S(e,t,n){this.props=e,this.context=t,this.refs=k,this.updater=n||x}function I(){}function N(e,t,n){this.props=e,this.context=t,this.refs=k,this.updater=n||x}S.prototype.isReactComponent={},S.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},S.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},I.prototype=S.prototype;var C=N.prototype=new I;C.constructor=N,w(C,S.prototype),C.isPureReactComponent=!0;var T=Array.isArray,E=Object.prototype.hasOwnProperty,_={current:null},$={key:!0,ref:!0,__self:!0,__source:!0};function A(e,t,n){var r,a={},i=null,s=null;if(null!=t)for(r in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(i=""+t.key),t)E.call(t,r)&&!$.hasOwnProperty(r)&&(a[r]=t[r]);var o=arguments.length-2;if(1===o)a.children=n;else if(1<o){for(var u=Array(o),d=0;d<o;d++)u[d]=arguments[d+2];a.children=u}if(e&&e.defaultProps)for(r in o=e.defaultProps)void 0===a[r]&&(a[r]=o[r]);return{$$typeof:l,type:e,key:i,ref:s,props:a,_owner:_.current}}function R(e){return"object"==typeof e&&null!==e&&e.$$typeof===l}var D=/\/+/g;function F(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function M(e,t,n,r,a){var i=typeof e;"undefined"!==i&&"boolean"!==i||(e=null);var s=!1;if(null===e)s=!0;else switch(i){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case l:case u:s=!0}}if(s)return a=a(s=e),e=""===r?"."+F(s,0):r,T(a)?(n="",null!=e&&(n=e.replace(D,"$&/")+"/"),M(a,t,n,"",(function(e){return e}))):null!=a&&(R(a)&&(a=function(e,t){return{$$typeof:l,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,n+(!a.key||s&&s.key===a.key?"":(""+a.key).replace(D,"$&/")+"/")+e)),t.push(a)),1;if(s=0,r=""===r?".":r+":",T(e))for(var o=0;o<e.length;o++){var d=r+F(i=e[o],o);s+=M(i,t,n,d,a)}else if(d=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=v&&e[v]||e["@@iterator"])?e:null}(e),"function"==typeof d)for(e=d.call(e),o=0;!(i=e.next()).done;)s+=M(i=i.value,t,n,d=r+F(i,o++),a);else if("object"===i)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function O(e,t,n){if(null==e)return e;var r=[],a=0;return M(e,r,"","",(function(e){return t.call(n,e,a++)})),r}function P(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var L={current:null},z={transition:null},B={ReactCurrentDispatcher:L,ReactCurrentBatchConfig:z,ReactCurrentOwner:_};o.Children={map:O,forEach:function(e,t,n){O(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return O(e,(function(){t++})),t},toArray:function(e){return O(e,(function(e){return e}))||[]},only:function(e){if(!R(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},o.Component=S,o.Fragment=d,o.Profiler=p,o.PureComponent=N,o.StrictMode=c,o.Suspense=g,o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=B,o.cloneElement=function(e,t,n){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=w({},e.props),a=e.key,i=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(i=t.ref,s=_.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(u in t)E.call(t,u)&&!$.hasOwnProperty(u)&&(r[u]=void 0===t[u]&&void 0!==o?o[u]:t[u])}var u=arguments.length-2;if(1===u)r.children=n;else if(1<u){o=Array(u);for(var d=0;d<u;d++)o[d]=arguments[d+2];r.children=o}return{$$typeof:l,type:e.type,key:a,ref:i,props:r,_owner:s}},o.createContext=function(e){return(e={$$typeof:f,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:h,_context:e},e.Consumer=e},o.createElement=A,o.createFactory=function(e){var t=A.bind(null,e);return t.type=e,t},o.createRef=function(){return{current:null}},o.forwardRef=function(e){return{$$typeof:m,render:e}},o.isValidElement=R,o.lazy=function(e){return{$$typeof:y,_payload:{_status:-1,_result:e},_init:P}},o.memo=function(e,t){return{$$typeof:b,type:e,compare:void 0===t?null:t}},o.startTransition=function(e){var t=z.transition;z.transition={};try{e()}finally{z.transition=t}},o.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},o.useCallback=function(e,t){return L.current.useCallback(e,t)},o.useContext=function(e){return L.current.useContext(e)},o.useDebugValue=function(){},o.useDeferredValue=function(e){return L.current.useDeferredValue(e)},o.useEffect=function(e,t){return L.current.useEffect(e,t)},o.useId=function(){return L.current.useId()},o.useImperativeHandle=function(e,t,n){return L.current.useImperativeHandle(e,t,n)},o.useInsertionEffect=function(e,t){return L.current.useInsertionEffect(e,t)},o.useLayoutEffect=function(e,t){return L.current.useLayoutEffect(e,t)},o.useMemo=function(e,t){return L.current.useMemo(e,t)},o.useReducer=function(e,t,n){return L.current.useReducer(e,t,n)},o.useRef=function(e){return L.current.useRef(e)},o.useState=function(e){return L.current.useState(e)},o.useSyncExternalStore=function(e,t,n){return L.current.useSyncExternalStore(e,t,n)},o.useTransition=function(){return L.current.useTransition()},o.version="18.2.0",s.exports=o;var W=s.exports;const V=r(W);
/**
             * @license React
             * react-jsx-runtime.production.min.js
             *
             * Copyright (c) Facebook, Inc. and its affiliates.
             *
             * This source code is licensed under the MIT license found in the
             * LICENSE file in the root directory of this source tree.
             */var U=W,j=Symbol.for("react.element"),H=Symbol.for("react.fragment"),G=Object.prototype.hasOwnProperty,q=U.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,K={key:!0,ref:!0,__self:!0,__source:!0};function X(e,t,n){var r,a={},i=null,s=null;for(r in void 0!==n&&(i=""+n),void 0!==t.key&&(i=""+t.key),void 0!==t.ref&&(s=t.ref),t)G.call(t,r)&&!K.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:j,type:e,key:i,ref:s,props:a,_owner:q.current}}i.Fragment=H,i.jsx=X,i.jsxs=X,a.exports=i;var Y=a.exports,J={exports:{}},Z={},Q={exports:{}},ee={};
/**
             * @license React
             * scheduler.production.min.js
             *
             * Copyright (c) Facebook, Inc. and its affiliates.
             *
             * This source code is licensed under the MIT license found in the
             * LICENSE file in the root directory of this source tree.
             */
!function(e){function t(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<a(i,t)))break e;e[r]=t,e[n]=i,n=r}}function n(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,s=i>>>1;r<s;){var o=2*(r+1)-1,l=e[o],u=o+1,d=e[u];if(0>a(l,n))u<i&&0>a(d,l)?(e[r]=d,e[u]=n,r=u):(e[r]=l,e[o]=n,r=o);else{if(!(u<i&&0>a(d,n)))break e;e[r]=d,e[u]=n,r=u}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var i=performance;e.unstable_now=function(){return i.now()}}else{var s=Date,o=s.now();e.unstable_now=function(){return s.now()-o}}var l=[],u=[],d=1,c=null,p=3,h=!1,f=!1,m=!1,g="function"==typeof setTimeout?setTimeout:null,b="function"==typeof clearTimeout?clearTimeout:null,y="undefined"!=typeof setImmediate?setImmediate:null;function v(e){for(var a=n(u);null!==a;){if(null===a.callback)r(u);else{if(!(a.startTime<=e))break;r(u),a.sortIndex=a.expirationTime,t(l,a)}a=n(u)}}function x(e){if(m=!1,v(e),!f)if(null!==n(l))f=!0,R(w);else{var t=n(u);null!==t&&D(x,t.startTime-e)}}function w(t,a){f=!1,m&&(m=!1,b(N),N=-1),h=!0;var i=p;try{for(v(a),c=n(l);null!==c&&(!(c.expirationTime>a)||t&&!E());){var s=c.callback;if("function"==typeof s){c.callback=null,p=c.priorityLevel;var o=s(c.expirationTime<=a);a=e.unstable_now(),"function"==typeof o?c.callback=o:c===n(l)&&r(l),v(a)}else r(l);c=n(l)}if(null!==c)var d=!0;else{var g=n(u);null!==g&&D(x,g.startTime-a),d=!1}return d}finally{c=null,p=i,h=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var k,S=!1,I=null,N=-1,C=5,T=-1;function E(){return!(e.unstable_now()-T<C)}function _(){if(null!==I){var t=e.unstable_now();T=t;var n=!0;try{n=I(!0,t)}finally{n?k():(S=!1,I=null)}}else S=!1}if("function"==typeof y)k=function(){y(_)};else if("undefined"!=typeof MessageChannel){var $=new MessageChannel,A=$.port2;$.port1.onmessage=_,k=function(){A.postMessage(null)}}else k=function(){g(_,0)};function R(e){I=e,S||(S=!0,k())}function D(t,n){N=g((function(){t(e.unstable_now())}),n)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(e){e.callback=null},e.unstable_continueExecution=function(){f||h||(f=!0,R(w))},e.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<e?Math.floor(1e3/e):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return n(l)},e.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},e.unstable_scheduleCallback=function(r,a,i){var s=e.unstable_now();switch(i="object"==typeof i&&null!==i&&"number"==typeof(i=i.delay)&&0<i?s+i:s,r){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return r={id:d++,callback:a,priorityLevel:r,startTime:i,expirationTime:o=i+o,sortIndex:-1},i>s?(r.sortIndex=i,t(u,r),null===n(l)&&r===n(u)&&(m?(b(N),N=-1):m=!0,D(x,i-s))):(r.sortIndex=o,t(l,r),f||h||(f=!0,R(w))),r},e.unstable_shouldYield=E,e.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}}(ee),Q.exports=ee;var te=Q.exports,ne=W,re=te;
/**
             * @license React
             * react-dom.production.min.js
             *
             * Copyright (c) Facebook, Inc. and its affiliates.
             *
             * This source code is licensed under the MIT license found in the
             * LICENSE file in the root directory of this source tree.
             */function ae(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ie=new Set,se={};function oe(e,t){le(e,t),le(e+"Capture",t)}function le(e,t){for(se[e]=t,e=0;e<t.length;e++)ie.add(t[e])}var ue=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),de=Object.prototype.hasOwnProperty,ce=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,pe={},he={};function fe(e,t,n,r,a,i,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=s}var me={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){me[e]=new fe(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];me[t]=new fe(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){me[e]=new fe(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){me[e]=new fe(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){me[e]=new fe(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){me[e]=new fe(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){me[e]=new fe(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){me[e]=new fe(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){me[e]=new fe(e,5,!1,e.toLowerCase(),null,!1,!1)}));var ge=/[\-:]([a-z])/g;function be(e){return e[1].toUpperCase()}function ye(e,t,n,r){var a=me.hasOwnProperty(t)?me[t]:null;(null!==a?0!==a.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null==t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,a,r)&&(n=null),r||null===a?function(e){return!!de.call(he,e)||!de.call(pe,e)&&(ce.test(e)?he[e]=!0:(pe[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=null===n?3!==a.type&&"":n:(t=a.attributeName,r=a.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(a=a.type)||4===a&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(ge,be);me[t]=new fe(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(ge,be);me[t]=new fe(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(ge,be);me[t]=new fe(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){me[e]=new fe(e,1,!1,e.toLowerCase(),null,!1,!1)})),me.xlinkHref=new fe("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){me[e]=new fe(e,1,!1,e.toLowerCase(),null,!0,!0)}));var ve=ne.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,xe=Symbol.for("react.element"),we=Symbol.for("react.portal"),ke=Symbol.for("react.fragment"),Se=Symbol.for("react.strict_mode"),Ie=Symbol.for("react.profiler"),Ne=Symbol.for("react.provider"),Ce=Symbol.for("react.context"),Te=Symbol.for("react.forward_ref"),Ee=Symbol.for("react.suspense"),_e=Symbol.for("react.suspense_list"),$e=Symbol.for("react.memo"),Ae=Symbol.for("react.lazy"),Re=Symbol.for("react.offscreen"),De=Symbol.iterator;function Fe(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=De&&e[De]||e["@@iterator"])?e:null}var Me,Oe=Object.assign;function Pe(e){if(void 0===Me)try{throw Error()}catch(xp){var t=xp.stack.trim().match(/\n( *(at )?)/);Me=t&&t[1]||""}return"\n"+Me+e}var Le=!1;function ze(e,t){if(!e||Le)return"";Le=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(Tp){var r=Tp}Reflect.construct(e,[],t)}else{try{t.call()}catch(Tp){r=Tp}e.call(t.prototype)}else{try{throw Error()}catch(Tp){r=Tp}e()}}catch(Tp){if(Tp&&r&&"string"==typeof Tp.stack){for(var a=Tp.stack.split("\n"),i=r.stack.split("\n"),s=a.length-1,o=i.length-1;1<=s&&0<=o&&a[s]!==i[o];)o--;for(;1<=s&&0<=o;s--,o--)if(a[s]!==i[o]){if(1!==s||1!==o)do{if(s--,0>--o||a[s]!==i[o]){var l="\n"+a[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=s&&0<=o);break}}}finally{Le=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Pe(e):""}function Be(e){switch(e.tag){case 5:return Pe(e.type);case 16:return Pe("Lazy");case 13:return Pe("Suspense");case 19:return Pe("SuspenseList");case 0:case 2:case 15:return e=ze(e.type,!1);case 11:return e=ze(e.type.render,!1);case 1:return e=ze(e.type,!0);default:return""}}function We(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case ke:return"Fragment";case we:return"Portal";case Ie:return"Profiler";case Se:return"StrictMode";case Ee:return"Suspense";case _e:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case Ce:return(e.displayName||"Context")+".Consumer";case Ne:return(e._context.displayName||"Context")+".Provider";case Te:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case $e:return null!==(t=e.displayName||null)?t:We(e.type)||"Memo";case Ae:t=e._payload,e=e._init;try{return We(e(t))}catch(xp){}}return null}function Ve(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return We(t);case 8:return t===Se?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t}return null}function Ue(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function je(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function He(e){e._valueTracker||(e._valueTracker=function(e){var t=je(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var a=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function Ge(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=je(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function qe(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(vp){return e.body}}function Ke(e,t){var n=t.checked;return Oe({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Xe(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=Ue(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Ye(e,t){null!=(t=t.checked)&&ye(e,"checked",t,!1)}function Je(e,t){Ye(e,t);var n=Ue(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?Qe(e,t.type,n):t.hasOwnProperty("defaultValue")&&Qe(e,t.type,Ue(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Ze(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function Qe(e,t,n){"number"===t&&qe(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var et=Array.isArray;function tt(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Ue(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function nt(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(ae(91));return Oe({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function rt(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(ae(92));if(et(n)){if(1<n.length)throw Error(ae(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:Ue(n)}}function at(e,t){var n=Ue(t.value),r=Ue(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function it(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function st(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ot(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?st(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var lt,ut,dt=(ut=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((lt=lt||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=lt.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ut(e,t)}))}:ut);function ct(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ht=["Webkit","ms","Moz","O"];function ft(e,t,n){return null==t||"boolean"==typeof t||""===t?"":n||"number"!=typeof t||0===t||pt.hasOwnProperty(e)&&pt[e]?(""+t).trim():t+"px"}function mt(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),a=ft(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}Object.keys(pt).forEach((function(e){ht.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pt[t]=pt[e]}))}));var gt=Oe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function bt(e,t){if(t){if(gt[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(ae(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(ae(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(ae(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(ae(62))}}function yt(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var vt=null;function xt(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var wt=null,kt=null,St=null;function It(e){if(e=yi(e)){if("function"!=typeof wt)throw Error(ae(280));var t=e.stateNode;t&&(t=xi(t),wt(e.stateNode,e.type,t))}}function Nt(e){kt?St?St.push(e):St=[e]:kt=e}function Ct(){if(kt){var e=kt,t=St;if(St=kt=null,It(e),t)for(e=0;e<t.length;e++)It(t[e])}}function Tt(e,t){return e(t)}function Et(){}var _t=!1;function $t(e,t,n){if(_t)return e(t,n);_t=!0;try{return Tt(e,t,n)}finally{_t=!1,(null!==kt||null!==St)&&(Et(),Ct())}}function At(e,t){var n=e.stateNode;if(null===n)return null;var r=xi(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(ae(231,t,typeof n));return n}var Rt=!1;if(ue)try{var Dt={};Object.defineProperty(Dt,"passive",{get:function(){Rt=!0}}),window.addEventListener("test",Dt,Dt),window.removeEventListener("test",Dt,Dt)}catch(ut){Rt=!1}function Ft(e,t,n,r,a,i,s,o,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(Ep){this.onError(Ep)}}var Mt=!1,Ot=null,Pt=!1,Lt=null,zt={onError:function(e){Mt=!0,Ot=e}};function Bt(e,t,n,r,a,i,s,o,l){Mt=!1,Ot=null,Ft.apply(zt,arguments)}function Wt(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!=(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Vt(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&null!==(e=e.alternate)&&(t=e.memoizedState),null!==t)return t.dehydrated}return null}function Ut(e){if(Wt(e)!==e)throw Error(ae(188))}function jt(e){return e=function(e){var t=e.alternate;if(!t){if(null===(t=Wt(e)))throw Error(ae(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var i=a.alternate;if(null===i){if(null!==(r=a.return)){n=r;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===n)return Ut(a),e;if(i===r)return Ut(a),t;i=i.sibling}throw Error(ae(188))}if(n.return!==r.return)n=a,r=i;else{for(var s=!1,o=a.child;o;){if(o===n){s=!0,n=a,r=i;break}if(o===r){s=!0,r=a,n=i;break}o=o.sibling}if(!s){for(o=i.child;o;){if(o===n){s=!0,n=i,r=a;break}if(o===r){s=!0,r=i,n=a;break}o=o.sibling}if(!s)throw Error(ae(189))}}if(n.alternate!==r)throw Error(ae(190))}if(3!==n.tag)throw Error(ae(188));return n.stateNode.current===n?e:t}(e),null!==e?Ht(e):null}function Ht(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ht(e);if(null!==t)return t;e=e.sibling}return null}var Gt=re.unstable_scheduleCallback,qt=re.unstable_cancelCallback,Kt=re.unstable_shouldYield,Xt=re.unstable_requestPaint,Yt=re.unstable_now,Jt=re.unstable_getCurrentPriorityLevel,Zt=re.unstable_ImmediatePriority,Qt=re.unstable_UserBlockingPriority,en=re.unstable_NormalPriority,tn=re.unstable_LowPriority,nn=re.unstable_IdlePriority,rn=null,an=null,sn=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(on(e)/ln|0)|0},on=Math.log,ln=Math.LN2,un=64,dn=4194304;function cn(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function pn(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,a=e.suspendedLanes,i=e.pingedLanes,s=268435455&n;if(0!==s){var o=s&~a;0!==o?r=cn(o):0!=(i&=s)&&(r=cn(i))}else 0!=(s=n&~a)?r=cn(s):0!==i&&(r=cn(i));if(0===r)return 0;if(0!==t&&t!==r&&0==(t&a)&&((a=r&-r)>=(i=t&-t)||16===a&&0!=(4194240&i)))return t;if(0!=(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)a=1<<(n=31-sn(t)),r|=e[n],t&=~a;return r}function hn(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function fn(e){return 0!=(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mn(){var e=un;return 0==(4194240&(un<<=1))&&(un=64),e}function gn(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function bn(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-sn(t)]=n}function yn(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-sn(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var vn=0;function xn(e){return 1<(e&=-e)?4<e?0!=(268435455&e)?16:536870912:4:1}var wn,kn,Sn,In,Nn,Cn=!1,Tn=[],En=null,_n=null,$n=null,An=new Map,Rn=new Map,Dn=[],Fn="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Mn(e,t){switch(e){case"focusin":case"focusout":En=null;break;case"dragenter":case"dragleave":_n=null;break;case"mouseover":case"mouseout":$n=null;break;case"pointerover":case"pointerout":An.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rn.delete(t.pointerId)}}function On(e,t,n,r,a,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},null!==t&&null!==(t=yi(t))&&kn(t),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Pn(e){var t=bi(e.target);if(null!==t){var n=Wt(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Vt(n)))return e.blockedOn=t,void Nn(e.priority,(function(){Sn(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ln(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Xn(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=yi(n))&&kn(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);vt=r,n.target.dispatchEvent(r),vt=null,t.shift()}return!0}function zn(e,t,n){Ln(e)&&n.delete(t)}function Bn(){Cn=!1,null!==En&&Ln(En)&&(En=null),null!==_n&&Ln(_n)&&(_n=null),null!==$n&&Ln($n)&&($n=null),An.forEach(zn),Rn.forEach(zn)}function Wn(e,t){e.blockedOn===t&&(e.blockedOn=null,Cn||(Cn=!0,re.unstable_scheduleCallback(re.unstable_NormalPriority,Bn)))}function Vn(e){function t(t){return Wn(t,e)}if(0<Tn.length){Wn(Tn[0],e);for(var n=1;n<Tn.length;n++){var r=Tn[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==En&&Wn(En,e),null!==_n&&Wn(_n,e),null!==$n&&Wn($n,e),An.forEach(t),Rn.forEach(t),n=0;n<Dn.length;n++)(r=Dn[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Dn.length&&null===(n=Dn[0]).blockedOn;)Pn(n),null===n.blockedOn&&Dn.shift()}var Un=ve.ReactCurrentBatchConfig,jn=!0;function Hn(e,t,n,r){var a=vn,i=Un.transition;Un.transition=null;try{vn=1,qn(e,t,n,r)}finally{vn=a,Un.transition=i}}function Gn(e,t,n,r){var a=vn,i=Un.transition;Un.transition=null;try{vn=4,qn(e,t,n,r)}finally{vn=a,Un.transition=i}}function qn(e,t,n,r){if(jn){var a=Xn(e,t,n,r);if(null===a)Ua(e,t,r,Kn,n),Mn(e,r);else if(function(e,t,n,r,a){switch(t){case"focusin":return En=On(En,e,t,n,r,a),!0;case"dragenter":return _n=On(_n,e,t,n,r,a),!0;case"mouseover":return $n=On($n,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return An.set(i,On(An.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,Rn.set(i,On(Rn.get(i)||null,e,t,n,r,a)),!0}return!1}(a,e,t,n,r))r.stopPropagation();else if(Mn(e,r),4&t&&-1<Fn.indexOf(e)){for(;null!==a;){var i=yi(a);if(null!==i&&wn(i),null===(i=Xn(e,t,n,r))&&Ua(e,t,r,Kn,n),i===a)break;a=i}null!==a&&r.stopPropagation()}else Ua(e,t,r,null,n)}}var Kn=null;function Xn(e,t,n,r){if(Kn=null,null!==(e=bi(e=xt(r))))if(null===(t=Wt(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Vt(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Kn=e,null}function Yn(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Jt()){case Zt:return 1;case Qt:return 4;case en:case tn:return 16;case nn:return 536870912;default:return 16}default:return 16}}var Jn=null,Zn=null,Qn=null;function er(){if(Qn)return Qn;var e,t,n=Zn,r=n.length,a="value"in Jn?Jn.value:Jn.textContent,i=a.length;for(e=0;e<r&&n[e]===a[e];e++);var s=r-e;for(t=1;t<=s&&n[r-t]===a[i-t];t++);return Qn=a.slice(e,1<t?1-t:void 0)}function tr(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nr(){return!0}function rr(){return!1}function ar(e){function t(t,n,r,a,i){for(var s in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(a):a[s]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?nr:rr,this.isPropagationStopped=rr,this}return Oe(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nr)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nr)},persist:function(){},isPersistent:nr}),t}var ir,sr,or,lr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ur=ar(lr),dr=Oe({},lr,{view:0,detail:0}),cr=ar(dr),pr=Oe({},dr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ir,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==or&&(or&&"mousemove"===e.type?(ir=e.screenX-or.screenX,sr=e.screenY-or.screenY):sr=ir=0,or=e),ir)},movementY:function(e){return"movementY"in e?e.movementY:sr}}),hr=ar(pr),fr=ar(Oe({},pr,{dataTransfer:0})),mr=ar(Oe({},dr,{relatedTarget:0})),gr=ar(Oe({},lr,{animationName:0,elapsedTime:0,pseudoElement:0})),br=Oe({},lr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),yr=ar(br),vr=ar(Oe({},lr,{data:0})),xr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},kr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sr(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=kr[e])&&!!t[e]}function Ir(){return Sr}var Nr=Oe({},dr,{key:function(e){if(e.key){var t=xr[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tr(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?wr[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ir,charCode:function(e){return"keypress"===e.type?tr(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tr(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Cr=ar(Nr),Tr=ar(Oe({},pr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Er=ar(Oe({},dr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ir})),_r=ar(Oe({},lr,{propertyName:0,elapsedTime:0,pseudoElement:0})),$r=Oe({},pr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ar=ar($r),Rr=[9,13,27,32],Dr=ue&&"CompositionEvent"in window,Fr=null;ue&&"documentMode"in document&&(Fr=document.documentMode);var Mr=ue&&"TextEvent"in window&&!Fr,Or=ue&&(!Dr||Fr&&8<Fr&&11>=Fr),Pr=String.fromCharCode(32),Lr=!1;function zr(e,t){switch(e){case"keyup":return-1!==Rr.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Br(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var Wr=!1,Vr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ur(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Vr[e.type]:"textarea"===t}function jr(e,t,n,r){Nt(r),0<(t=Ha(t,"onChange")).length&&(n=new ur("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Hr=null,Gr=null;function qr(e){Pa(e,0)}function Kr(e){if(Ge(vi(e)))return e}function Xr(e,t){if("change"===e)return t}var Yr=!1;if(ue){var Jr;if(ue){var Zr="oninput"in document;if(!Zr){var Qr=document.createElement("div");Qr.setAttribute("oninput","return;"),Zr="function"==typeof Qr.oninput}Jr=Zr}else Jr=!1;Yr=Jr&&(!document.documentMode||9<document.documentMode)}function ea(){Hr&&(Hr.detachEvent("onpropertychange",ta),Gr=Hr=null)}function ta(e){if("value"===e.propertyName&&Kr(Gr)){var t=[];jr(t,Gr,e,xt(e)),$t(qr,t)}}function na(e,t,n){"focusin"===e?(ea(),Gr=n,(Hr=t).attachEvent("onpropertychange",ta)):"focusout"===e&&ea()}function ra(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Kr(Gr)}function aa(e,t){if("click"===e)return Kr(t)}function ia(e,t){if("input"===e||"change"===e)return Kr(t)}var sa="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function oa(e,t){if(sa(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!de.call(t,a)||!sa(e[a],t[a]))return!1}return!0}function la(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ua(e,t){var n,r=la(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=la(r)}}function da(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?da(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function ca(){for(var e=window,t=qe();t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(wp){n=!1}if(!n)break;t=qe((e=t.contentWindow).document)}return t}function pa(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function ha(e){var t=ca(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&da(n.ownerDocument.documentElement,n)){if(null!==r&&pa(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=n.textContent.length,i=Math.min(r.start,a);r=void 0===r.end?i:Math.min(r.end,a),!e.extend&&i>r&&(a=r,r=i,i=a),a=ua(n,i);var s=ua(n,r);a&&s&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"==typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var fa=ue&&"documentMode"in document&&11>=document.documentMode,ma=null,ga=null,ba=null,ya=!1;function va(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;ya||null==ma||ma!==qe(r)||(r="selectionStart"in(r=ma)&&pa(r)?{start:r.selectionStart,end:r.selectionEnd}:{anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},ba&&oa(ba,r)||(ba=r,0<(r=Ha(ga,"onSelect")).length&&(t=new ur("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=ma)))}function xa(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var wa={animationend:xa("Animation","AnimationEnd"),animationiteration:xa("Animation","AnimationIteration"),animationstart:xa("Animation","AnimationStart"),transitionend:xa("Transition","TransitionEnd")},ka={},Sa={};function Ia(e){if(ka[e])return ka[e];if(!wa[e])return e;var t,n=wa[e];for(t in n)if(n.hasOwnProperty(t)&&t in Sa)return ka[e]=n[t];return e}ue&&(Sa=document.createElement("div").style,"AnimationEvent"in window||(delete wa.animationend.animation,delete wa.animationiteration.animation,delete wa.animationstart.animation),"TransitionEvent"in window||delete wa.transitionend.transition);var Na=Ia("animationend"),Ca=Ia("animationiteration"),Ta=Ia("animationstart"),Ea=Ia("transitionend"),_a=new Map,$a="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Aa(e,t){_a.set(e,t),oe(t,[e])}for(var Ra=0;Ra<$a.length;Ra++){var Da=$a[Ra];Aa(Da.toLowerCase(),"on"+(Da[0].toUpperCase()+Da.slice(1)))}Aa(Na,"onAnimationEnd"),Aa(Ca,"onAnimationIteration"),Aa(Ta,"onAnimationStart"),Aa("dblclick","onDoubleClick"),Aa("focusin","onFocus"),Aa("focusout","onBlur"),Aa(Ea,"onTransitionEnd"),le("onMouseEnter",["mouseout","mouseover"]),le("onMouseLeave",["mouseout","mouseover"]),le("onPointerEnter",["pointerout","pointerover"]),le("onPointerLeave",["pointerout","pointerover"]),oe("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),oe("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),oe("onBeforeInput",["compositionend","keypress","textInput","paste"]),oe("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),oe("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),oe("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ma=new Set("cancel close invalid load scroll toggle".split(" ").concat(Fa));function Oa(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,a,i,s,o,l){if(Bt.apply(this,arguments),Mt){if(!Mt)throw Error(ae(198));var u=Ot;Mt=!1,Ot=null,Pt||(Pt=!0,Lt=u)}}(r,t,void 0,e),e.currentTarget=null}function Pa(e,t){t=0!=(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var s=r.length-1;0<=s;s--){var o=r[s],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==i&&a.isPropagationStopped())break e;Oa(a,o,u),i=l}else for(s=0;s<r.length;s++){if(l=(o=r[s]).instance,u=o.currentTarget,o=o.listener,l!==i&&a.isPropagationStopped())break e;Oa(a,o,u),i=l}}}if(Pt)throw e=Lt,Pt=!1,Lt=null,e}function La(e,t){var n=t[fi];void 0===n&&(n=t[fi]=new Set);var r=e+"__bubble";n.has(r)||(Va(t,e,2,!1),n.add(r))}function za(e,t,n){var r=0;t&&(r|=4),Va(n,e,r,t)}var Ba="_reactListening"+Math.random().toString(36).slice(2);function Wa(e){if(!e[Ba]){e[Ba]=!0,ie.forEach((function(t){"selectionchange"!==t&&(Ma.has(t)||za(t,!1,e),za(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Ba]||(t[Ba]=!0,za("selectionchange",!1,t))}}function Va(e,t,n,r){switch(Yn(t)){case 1:var a=Hn;break;case 4:a=Gn;break;default:a=qn}n=a.bind(null,t,n,e),a=void 0,!Rt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Ua(e,t,n,r,a){var i=r;if(0==(1&t)&&0==(2&t)&&null!==r)e:for(;;){if(null===r)return;var s=r.tag;if(3===s||4===s){var o=r.stateNode.containerInfo;if(o===a||8===o.nodeType&&o.parentNode===a)break;if(4===s)for(s=r.return;null!==s;){var l=s.tag;if((3===l||4===l)&&((l=s.stateNode.containerInfo)===a||8===l.nodeType&&l.parentNode===a))return;s=s.return}for(;null!==o;){if(null===(s=bi(o)))return;if(5===(l=s.tag)||6===l){r=i=s;continue e}o=o.parentNode}}r=r.return}$t((function(){var r=i,a=xt(n),s=[];e:{var o=_a.get(e);if(void 0!==o){var l=ur,u=e;switch(e){case"keypress":if(0===tr(n))break e;case"keydown":case"keyup":l=Cr;break;case"focusin":u="focus",l=mr;break;case"focusout":u="blur",l=mr;break;case"beforeblur":case"afterblur":l=mr;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=hr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=fr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Er;break;case Na:case Ca:case Ta:l=gr;break;case Ea:l=_r;break;case"scroll":l=cr;break;case"wheel":l=Ar;break;case"copy":case"cut":case"paste":l=yr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Tr}var d=0!=(4&t),c=!d&&"scroll"===e,p=d?null!==o?o+"Capture":null:o;d=[];for(var h,f=r;null!==f;){var m=(h=f).stateNode;if(5===h.tag&&null!==m&&(h=m,null!==p&&null!=(m=At(f,p))&&d.push(ja(f,m,h))),c)break;f=f.return}0<d.length&&(o=new l(o,u,null,n,a),s.push({event:o,listeners:d}))}}if(0==(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===vt||!(u=n.relatedTarget||n.fromElement)||!bi(u)&&!u[hi])&&(l||o)&&(o=a.window===a?a:(o=a.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=r,null!==(u=(u=n.relatedTarget||n.toElement)?bi(u):null)&&(u!==(c=Wt(u))||5!==u.tag&&6!==u.tag)&&(u=null)):(l=null,u=r),l!==u)){if(d=hr,m="onMouseLeave",p="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(d=Tr,m="onPointerLeave",p="onPointerEnter",f="pointer"),c=null==l?o:vi(l),h=null==u?o:vi(u),(o=new d(m,f+"leave",l,n,a)).target=c,o.relatedTarget=h,m=null,bi(a)===r&&((d=new d(p,f+"enter",u,n,a)).target=h,d.relatedTarget=c,m=d),c=m,l&&u)e:{for(p=u,f=0,h=d=l;h;h=Ga(h))f++;for(h=0,m=p;m;m=Ga(m))h++;for(;0<f-h;)d=Ga(d),f--;for(;0<h-f;)p=Ga(p),h--;for(;f--;){if(d===p||null!==p&&d===p.alternate)break e;d=Ga(d),p=Ga(p)}d=null}else d=null;null!==l&&qa(s,o,l,d,!1),null!==u&&null!==c&&qa(s,c,u,d,!0)}if("select"===(l=(o=r?vi(r):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var g=Xr;else if(Ur(o))if(Yr)g=ia;else{g=ra;var b=na}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=aa);switch(g&&(g=g(e,r))?jr(s,g,n,a):(b&&b(e,o,r),"focusout"===e&&(b=o._wrapperState)&&b.controlled&&"number"===o.type&&Qe(o,"number",o.value)),b=r?vi(r):window,e){case"focusin":(Ur(b)||"true"===b.contentEditable)&&(ma=b,ga=r,ba=null);break;case"focusout":ba=ga=ma=null;break;case"mousedown":ya=!0;break;case"contextmenu":case"mouseup":case"dragend":ya=!1,va(s,n,a);break;case"selectionchange":if(fa)break;case"keydown":case"keyup":va(s,n,a)}var y;if(Dr)e:{switch(e){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else Wr?zr(e,n)&&(v="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(v="onCompositionStart");v&&(Or&&"ko"!==n.locale&&(Wr||"onCompositionStart"!==v?"onCompositionEnd"===v&&Wr&&(y=er()):(Zn="value"in(Jn=a)?Jn.value:Jn.textContent,Wr=!0)),0<(b=Ha(r,v)).length&&(v=new vr(v,e,null,n,a),s.push({event:v,listeners:b}),(y||null!==(y=Br(n)))&&(v.data=y))),(y=Mr?function(e,t){switch(e){case"compositionend":return Br(t);case"keypress":return 32!==t.which?null:(Lr=!0,Pr);case"textInput":return(e=t.data)===Pr&&Lr?null:e;default:return null}}(e,n):function(e,t){if(Wr)return"compositionend"===e||!Dr&&zr(e,t)?(e=er(),Qn=Zn=Jn=null,Wr=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Or&&"ko"!==t.locale?null:t.data}}(e,n))&&0<(r=Ha(r,"onBeforeInput")).length&&(a=new vr("onBeforeInput","beforeinput",null,n,a),s.push({event:a,listeners:r}),a.data=y)}Pa(s,t)}))}function ja(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Ha(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,i=a.stateNode;5===a.tag&&null!==i&&(a=i,null!=(i=At(e,n))&&r.unshift(ja(e,i,a)),null!=(i=At(e,t))&&r.push(ja(e,i,a))),e=e.return}return r}function Ga(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function qa(e,t,n,r,a){for(var i=t._reactName,s=[];null!==n&&n!==r;){var o=n,l=o.alternate,u=o.stateNode;if(null!==l&&l===r)break;5===o.tag&&null!==u&&(o=u,a?null!=(l=At(n,i))&&s.unshift(ja(n,l,o)):a||null!=(l=At(n,i))&&s.push(ja(n,l,o))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var Ka=/\r\n?/g,Xa=/\u0000|\uFFFD/g;function Ya(e){return("string"==typeof e?e:""+e).replace(Ka,"\n").replace(Xa,"")}function Ja(e,t,n){if(t=Ya(t),Ya(e)!==t&&n)throw Error(ae(425))}function Za(){}var Qa=null,ei=null;function ti(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ni="function"==typeof setTimeout?setTimeout:void 0,ri="function"==typeof clearTimeout?clearTimeout:void 0,ai="function"==typeof Promise?Promise:void 0,ii="function"==typeof queueMicrotask?queueMicrotask:void 0!==ai?function(e){return ai.resolve(null).then(e).catch(si)}:ni;function si(e){setTimeout((function(){throw e}))}function oi(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)){if(0===r)return e.removeChild(a),void Vn(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=a}while(n);Vn(t)}function li(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ui(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var di=Math.random().toString(36).slice(2),ci="__reactFiber$"+di,pi="__reactProps$"+di,hi="__reactContainer$"+di,fi="__reactEvents$"+di,mi="__reactListeners$"+di,gi="__reactHandles$"+di;function bi(e){var t=e[ci];if(t)return t;for(var n=e.parentNode;n;){if(t=n[hi]||n[ci]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ui(e);null!==e;){if(n=e[ci])return n;e=ui(e)}return t}n=(e=n).parentNode}return null}function yi(e){return!(e=e[ci]||e[hi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function vi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(ae(33))}function xi(e){return e[pi]||null}var wi=[],ki=-1;function Si(e){return{current:e}}function Ii(e){0>ki||(e.current=wi[ki],wi[ki]=null,ki--)}function Ni(e,t){ki++,wi[ki]=e.current,e.current=t}var Ci={},Ti=Si(Ci),Ei=Si(!1),_i=Ci;function $i(e,t){var n=e.type.contextTypes;if(!n)return Ci;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a,i={};for(a in n)i[a]=t[a];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Ai(e){return null!=(e=e.childContextTypes)}function Ri(){Ii(Ei),Ii(Ti)}function Di(e,t,n){if(Ti.current!==Ci)throw Error(ae(168));Ni(Ti,t),Ni(Ei,n)}function Fi(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!=typeof r.getChildContext)return n;for(var a in r=r.getChildContext())if(!(a in t))throw Error(ae(108,Ve(e)||"Unknown",a));return Oe({},n,r)}function Mi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ci,_i=Ti.current,Ni(Ti,e),Ni(Ei,Ei.current),!0}function Oi(e,t,n){var r=e.stateNode;if(!r)throw Error(ae(169));n?(e=Fi(e,t,_i),r.__reactInternalMemoizedMergedChildContext=e,Ii(Ei),Ii(Ti),Ni(Ti,e)):Ii(Ei),Ni(Ei,n)}var Pi=null,Li=!1,zi=!1;function Bi(e){null===Pi?Pi=[e]:Pi.push(e)}function Wi(){if(!zi&&null!==Pi){zi=!0;var e=0,t=vn;try{var n=Pi;for(vn=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Pi=null,Li=!1}catch(kp){throw null!==Pi&&(Pi=Pi.slice(e+1)),Gt(Zt,Wi),kp}finally{vn=t,zi=!1}}return null}var Vi=[],Ui=0,ji=null,Hi=0,Gi=[],qi=0,Ki=null,Xi=1,Yi="";function Ji(e,t){Vi[Ui++]=Hi,Vi[Ui++]=ji,ji=e,Hi=t}function Zi(e,t,n){Gi[qi++]=Xi,Gi[qi++]=Yi,Gi[qi++]=Ki,Ki=e;var r=Xi;e=Yi;var a=32-sn(r)-1;r&=~(1<<a),n+=1;var i=32-sn(t)+a;if(30<i){var s=a-a%5;i=(r&(1<<s)-1).toString(32),r>>=s,a-=s,Xi=1<<32-sn(t)+a|n<<a|r,Yi=i+e}else Xi=1<<i|n<<a|r,Yi=e}function Qi(e){null!==e.return&&(Ji(e,1),Zi(e,1,0))}function es(e){for(;e===ji;)ji=Vi[--Ui],Vi[Ui]=null,Hi=Vi[--Ui],Vi[Ui]=null;for(;e===Ki;)Ki=Gi[--qi],Gi[qi]=null,Yi=Gi[--qi],Gi[qi]=null,Xi=Gi[--qi],Gi[qi]=null}var ts=null,ns=null,rs=!1,as=null;function is(e,t){var n=Ad(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function ss(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ts=e,ns=li(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ts=e,ns=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Ki?{id:Xi,overflow:Yi}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Ad(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ts=e,ns=null,!0);default:return!1}}function os(e){return 0!=(1&e.mode)&&0==(128&e.flags)}function ls(e){if(rs){var t=ns;if(t){var n=t;if(!ss(e,t)){if(os(e))throw Error(ae(418));t=li(n.nextSibling);var r=ts;t&&ss(e,t)?is(r,n):(e.flags=-4097&e.flags|2,rs=!1,ts=e)}}else{if(os(e))throw Error(ae(418));e.flags=-4097&e.flags|2,rs=!1,ts=e}}}function us(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ts=e}function ds(e){if(e!==ts)return!1;if(!rs)return us(e),rs=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ti(e.type,e.memoizedProps)),t&&(t=ns)){if(os(e))throw cs(),Error(ae(418));for(;t;)is(e,t),t=li(t.nextSibling)}if(us(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(ae(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ns=li(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ns=null}}else ns=ts?li(e.stateNode.nextSibling):null;return!0}function cs(){for(var e=ns;e;)e=li(e.nextSibling)}function ps(){ns=ts=null,rs=!1}function hs(e){null===as?as=[e]:as.push(e)}var fs=ve.ReactCurrentBatchConfig;function ms(e,t){if(e&&e.defaultProps){for(var n in t=Oe({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var gs=Si(null),bs=null,ys=null,vs=null;function xs(){vs=ys=bs=null}function ws(e){var t=gs.current;Ii(gs),e._currentValue=t}function ks(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ss(e,t){bs=e,vs=ys=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!=(e.lanes&t)&&(vl=!0),e.firstContext=null)}function Is(e){var t=e._currentValue;if(vs!==e)if(e={context:e,memoizedValue:t,next:null},null===ys){if(null===bs)throw Error(ae(308));ys=e,bs.dependencies={lanes:0,firstContext:e}}else ys=ys.next=e;return t}var Ns=null;function Cs(e){null===Ns?Ns=[e]:Ns.push(e)}function Ts(e,t,n,r){var a=t.interleaved;return null===a?(n.next=n,Cs(t)):(n.next=a.next,a.next=n),t.interleaved=n,Es(e,r)}function Es(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var _s=!1;function $s(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function As(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Rs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ds(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!=(2&Eu)){var a=r.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),r.pending=t,Es(e,n)}return null===(a=r.interleaved)?(t.next=t,Cs(r)):(t.next=a.next,a.next=t),r.interleaved=t,Es(e,n)}function Fs(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!=(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yn(e,n)}}function Ms(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?a=i=s:i=i.next=s,n=n.next}while(null!==n);null===i?a=i=t:i=i.next=t}else a=i=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Os(e,t,n,r){var a=e.updateQueue;_s=!1;var i=a.firstBaseUpdate,s=a.lastBaseUpdate,o=a.shared.pending;if(null!==o){a.shared.pending=null;var l=o,u=l.next;l.next=null,null===s?i=u:s.next=u,s=l;var d=e.alternate;null!==d&&(o=(d=d.updateQueue).lastBaseUpdate)!==s&&(null===o?d.firstBaseUpdate=u:o.next=u,d.lastBaseUpdate=l)}if(null!==i){var c=a.baseState;for(s=0,d=u=l=null,o=i;;){var p=o.lane,h=o.eventTime;if((r&p)===p){null!==d&&(d=d.next={eventTime:h,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var f=e,m=o;switch(p=t,h=n,m.tag){case 1:if("function"==typeof(f=m.payload)){c=f.call(h,c,p);break e}c=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null==(p="function"==typeof(f=m.payload)?f.call(h,c,p):f))break e;c=Oe({},c,p);break e;case 2:_s=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(p=a.effects)?a.effects=[o]:p.push(o))}else h={eventTime:h,lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===d?(u=d=h,l=c):d=d.next=h,s|=p;if(null===(o=o.next)){if(null===(o=a.shared.pending))break;o=(p=o).next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}if(null===d&&(l=c),a.baseState=l,a.firstBaseUpdate=u,a.lastBaseUpdate=d,null!==(t=a.shared.interleaved)){a=t;do{s|=a.lane,a=a.next}while(a!==t)}else null===i&&(a.shared.lanes=0);Ou|=s,e.lanes=s,e.memoizedState=c}}function Ps(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(null!==a){if(r.callback=null,r=n,"function"!=typeof a)throw Error(ae(191,a));a.call(r)}}}var Ls=(new ne.Component).refs;function zs(e,t,n,r){n=null==(n=n(r,t=e.memoizedState))?t:Oe({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var Bs={isMounted:function(e){return!!(e=e._reactInternals)&&Wt(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ed(),a=td(e),i=Rs(r,a);i.payload=t,null!=n&&(i.callback=n),null!==(t=Ds(e,i,a))&&(nd(t,e,a,r),Fs(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ed(),a=td(e),i=Rs(r,a);i.tag=1,i.payload=t,null!=n&&(i.callback=n),null!==(t=Ds(e,i,a))&&(nd(t,e,a,r),Fs(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ed(),r=td(e),a=Rs(n,r);a.tag=2,null!=t&&(a.callback=t),null!==(t=Ds(e,a,r))&&(nd(t,e,r,n),Fs(t,e,r))}};function Ws(e,t,n,r,a,i,s){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,s):!(t.prototype&&t.prototype.isPureReactComponent&&oa(n,r)&&oa(a,i))}function Vs(e,t,n){var r=!1,a=Ci,i=t.contextType;return"object"==typeof i&&null!==i?i=Is(i):(a=Ai(t)?_i:Ti.current,i=(r=null!=(r=t.contextTypes))?$i(e,a):Ci),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Bs,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function Us(e,t,n,r){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Bs.enqueueReplaceState(t,t.state,null)}function js(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs=Ls,$s(e);var i=t.contextType;"object"==typeof i&&null!==i?a.context=Is(i):(i=Ai(t)?_i:Ti.current,a.context=$i(e,i)),a.state=e.memoizedState,"function"==typeof(i=t.getDerivedStateFromProps)&&(zs(e,t,i,n),a.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof a.getSnapshotBeforeUpdate||"function"!=typeof a.UNSAFE_componentWillMount&&"function"!=typeof a.componentWillMount||(t=a.state,"function"==typeof a.componentWillMount&&a.componentWillMount(),"function"==typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&Bs.enqueueReplaceState(a,a.state,null),Os(e,n,a,r),a.state=e.memoizedState),"function"==typeof a.componentDidMount&&(e.flags|=4194308)}function Hs(e,t,n){if(null!==(e=n.ref)&&"function"!=typeof e&&"object"!=typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(ae(309));var r=n.stateNode}if(!r)throw Error(ae(147,e));var a=r,i=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===i?t.ref:(t=function(e){var t=a.refs;t===Ls&&(t=a.refs={}),null===e?delete t[i]:t[i]=e},t._stringRef=i,t)}if("string"!=typeof e)throw Error(ae(284));if(!n._owner)throw Error(ae(290,e))}return e}function Gs(e,t){throw e=Object.prototype.toString.call(t),Error(ae(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function qs(e){return(0,e._init)(e._payload)}function Ks(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Dd(e,t)).index=0,e.sibling=null,e}function i(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function o(e,t,n,r){return null===t||6!==t.tag?((t=Pd(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function l(e,t,n,r){var i=n.type;return i===ke?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"==typeof i&&null!==i&&i.$$typeof===Ae&&qs(i)===t.type)?((r=a(t,n.props)).ref=Hs(e,t,n),r.return=e,r):((r=Fd(n.type,n.key,n.props,null,e.mode,r)).ref=Hs(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Ld(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function d(e,t,n,r,i){return null===t||7!==t.tag?((t=Md(n,e.mode,r,i)).return=e,t):((t=a(t,n)).return=e,t)}function c(e,t,n){if("string"==typeof t&&""!==t||"number"==typeof t)return(t=Pd(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case xe:return(n=Fd(t.type,t.key,t.props,null,e.mode,n)).ref=Hs(e,null,t),n.return=e,n;case we:return(t=Ld(t,e.mode,n)).return=e,t;case Ae:return c(e,(0,t._init)(t._payload),n)}if(et(t)||Fe(t))return(t=Md(t,e.mode,n,null)).return=e,t;Gs(e,t)}return null}function p(e,t,n,r){var a=null!==t?t.key:null;if("string"==typeof n&&""!==n||"number"==typeof n)return null!==a?null:o(e,t,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case xe:return n.key===a?l(e,t,n,r):null;case we:return n.key===a?u(e,t,n,r):null;case Ae:return p(e,t,(a=n._init)(n._payload),r)}if(et(n)||Fe(n))return null!==a?null:d(e,t,n,r,null);Gs(e,n)}return null}function h(e,t,n,r,a){if("string"==typeof r&&""!==r||"number"==typeof r)return o(t,e=e.get(n)||null,""+r,a);if("object"==typeof r&&null!==r){switch(r.$$typeof){case xe:return l(t,e=e.get(null===r.key?n:r.key)||null,r,a);case we:return u(t,e=e.get(null===r.key?n:r.key)||null,r,a);case Ae:return h(e,t,n,(0,r._init)(r._payload),a)}if(et(r)||Fe(r))return d(t,e=e.get(n)||null,r,a,null);Gs(t,r)}return null}function f(a,s,o,l){for(var u=null,d=null,f=s,m=s=0,g=null;null!==f&&m<o.length;m++){f.index>m?(g=f,f=null):g=f.sibling;var b=p(a,f,o[m],l);if(null===b){null===f&&(f=g);break}e&&f&&null===b.alternate&&t(a,f),s=i(b,s,m),null===d?u=b:d.sibling=b,d=b,f=g}if(m===o.length)return n(a,f),rs&&Ji(a,m),u;if(null===f){for(;m<o.length;m++)null!==(f=c(a,o[m],l))&&(s=i(f,s,m),null===d?u=f:d.sibling=f,d=f);return rs&&Ji(a,m),u}for(f=r(a,f);m<o.length;m++)null!==(g=h(f,a,m,o[m],l))&&(e&&null!==g.alternate&&f.delete(null===g.key?m:g.key),s=i(g,s,m),null===d?u=g:d.sibling=g,d=g);return e&&f.forEach((function(e){return t(a,e)})),rs&&Ji(a,m),u}function m(a,s,o,l){var u=Fe(o);if("function"!=typeof u)throw Error(ae(150));if(null==(o=u.call(o)))throw Error(ae(151));for(var d=u=null,f=s,m=s=0,g=null,b=o.next();null!==f&&!b.done;m++,b=o.next()){f.index>m?(g=f,f=null):g=f.sibling;var y=p(a,f,b.value,l);if(null===y){null===f&&(f=g);break}e&&f&&null===y.alternate&&t(a,f),s=i(y,s,m),null===d?u=y:d.sibling=y,d=y,f=g}if(b.done)return n(a,f),rs&&Ji(a,m),u;if(null===f){for(;!b.done;m++,b=o.next())null!==(b=c(a,b.value,l))&&(s=i(b,s,m),null===d?u=b:d.sibling=b,d=b);return rs&&Ji(a,m),u}for(f=r(a,f);!b.done;m++,b=o.next())null!==(b=h(f,a,m,b.value,l))&&(e&&null!==b.alternate&&f.delete(null===b.key?m:b.key),s=i(b,s,m),null===d?u=b:d.sibling=b,d=b);return e&&f.forEach((function(e){return t(a,e)})),rs&&Ji(a,m),u}return function e(r,i,o,l){if("object"==typeof o&&null!==o&&o.type===ke&&null===o.key&&(o=o.props.children),"object"==typeof o&&null!==o){switch(o.$$typeof){case xe:e:{for(var u=o.key,d=i;null!==d;){if(d.key===u){if((u=o.type)===ke){if(7===d.tag){n(r,d.sibling),(i=a(d,o.props.children)).return=r,r=i;break e}}else if(d.elementType===u||"object"==typeof u&&null!==u&&u.$$typeof===Ae&&qs(u)===d.type){n(r,d.sibling),(i=a(d,o.props)).ref=Hs(r,d,o),i.return=r,r=i;break e}n(r,d);break}t(r,d),d=d.sibling}o.type===ke?((i=Md(o.props.children,r.mode,l,o.key)).return=r,r=i):((l=Fd(o.type,o.key,o.props,null,r.mode,l)).ref=Hs(r,i,o),l.return=r,r=l)}return s(r);case we:e:{for(d=o.key;null!==i;){if(i.key===d){if(4===i.tag&&i.stateNode.containerInfo===o.containerInfo&&i.stateNode.implementation===o.implementation){n(r,i.sibling),(i=a(i,o.children||[])).return=r,r=i;break e}n(r,i);break}t(r,i),i=i.sibling}(i=Ld(o,r.mode,l)).return=r,r=i}return s(r);case Ae:return e(r,i,(d=o._init)(o._payload),l)}if(et(o))return f(r,i,o,l);if(Fe(o))return m(r,i,o,l);Gs(r,o)}return"string"==typeof o&&""!==o||"number"==typeof o?(o=""+o,null!==i&&6===i.tag?(n(r,i.sibling),(i=a(i,o)).return=r,r=i):(n(r,i),(i=Pd(o,r.mode,l)).return=r,r=i),s(r)):n(r,i)}}var Xs=Ks(!0),Ys=Ks(!1),Js={},Zs=Si(Js),Qs=Si(Js),eo=Si(Js);function to(e){if(e===Js)throw Error(ae(174));return e}function no(e,t){switch(Ni(eo,t),Ni(Qs,e),Ni(Zs,Js),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ot(null,"");break;default:t=ot(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ii(Zs),Ni(Zs,t)}function ro(){Ii(Zs),Ii(Qs),Ii(eo)}function ao(e){to(eo.current);var t=to(Zs.current),n=ot(t,e.type);t!==n&&(Ni(Qs,e),Ni(Zs,n))}function io(e){Qs.current===e&&(Ii(Zs),Ii(Qs))}var so=Si(0);function oo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!=(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var lo=[];function uo(){for(var e=0;e<lo.length;e++)lo[e]._workInProgressVersionPrimary=null;lo.length=0}var co=ve.ReactCurrentDispatcher,po=ve.ReactCurrentBatchConfig,ho=0,fo=null,mo=null,go=null,bo=!1,yo=!1,vo=0,xo=0;function wo(){throw Error(ae(321))}function ko(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!sa(e[n],t[n]))return!1;return!0}function So(e,t,n,r,a,i){if(ho=i,fo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,co.current=null===e||null===e.memoizedState?sl:ol,e=n(r,a),yo){i=0;do{if(yo=!1,vo=0,25<=i)throw Error(ae(301));i+=1,go=mo=null,t.updateQueue=null,co.current=ll,e=n(r,a)}while(yo)}if(co.current=il,t=null!==mo&&null!==mo.next,ho=0,go=mo=fo=null,bo=!1,t)throw Error(ae(300));return e}function Io(){var e=0!==vo;return vo=0,e}function No(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===go?fo.memoizedState=go=e:go=go.next=e,go}function Co(){if(null===mo){var e=fo.alternate;e=null!==e?e.memoizedState:null}else e=mo.next;var t=null===go?fo.memoizedState:go.next;if(null!==t)go=t,mo=e;else{if(null===e)throw Error(ae(310));e={memoizedState:(mo=e).memoizedState,baseState:mo.baseState,baseQueue:mo.baseQueue,queue:mo.queue,next:null},null===go?fo.memoizedState=go=e:go=go.next=e}return go}function To(e,t){return"function"==typeof t?t(e):t}function Eo(e){var t=Co(),n=t.queue;if(null===n)throw Error(ae(311));n.lastRenderedReducer=e;var r=mo,a=r.baseQueue,i=n.pending;if(null!==i){if(null!==a){var s=a.next;a.next=i.next,i.next=s}r.baseQueue=a=i,n.pending=null}if(null!==a){i=a.next,r=r.baseState;var o=s=null,l=null,u=i;do{var d=u.lane;if((ho&d)===d)null!==l&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var c={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===l?(o=l=c,s=r):l=l.next=c,fo.lanes|=d,Ou|=d}u=u.next}while(null!==u&&u!==i);null===l?s=r:l.next=o,sa(r,t.memoizedState)||(vl=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=l,n.lastRenderedState=r}if(null!==(e=n.interleaved)){a=e;do{i=a.lane,fo.lanes|=i,Ou|=i,a=a.next}while(a!==e)}else null===a&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function _o(e){var t=Co(),n=t.queue;if(null===n)throw Error(ae(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,i=t.memoizedState;if(null!==a){n.pending=null;var s=a=a.next;do{i=e(i,s.action),s=s.next}while(s!==a);sa(i,t.memoizedState)||(vl=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function $o(){}function Ao(e,t){var n=fo,r=Co(),a=t(),i=!sa(r.memoizedState,a);if(i&&(r.memoizedState=a,vl=!0),r=r.queue,Uo(Fo.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||null!==go&&1&go.memoizedState.tag){if(n.flags|=2048,Lo(9,Do.bind(null,n,r,a,t),void 0,null),null===_u)throw Error(ae(349));0!=(30&ho)||Ro(n,t,a)}return a}function Ro(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=fo.updateQueue)?(t={lastEffect:null,stores:null},fo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Do(e,t,n,r){t.value=n,t.getSnapshot=r,Mo(t)&&Oo(e)}function Fo(e,t,n){return n((function(){Mo(t)&&Oo(e)}))}function Mo(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!sa(e,n)}catch(wp){return!0}}function Oo(e){var t=Es(e,1);null!==t&&nd(t,e,1,-1)}function Po(e){var t=No();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:To,lastRenderedState:e},t.queue=e,e=e.dispatch=tl.bind(null,fo,e),[t.memoizedState,e]}function Lo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=fo.updateQueue)?(t={lastEffect:null,stores:null},fo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function zo(){return Co().memoizedState}function Bo(e,t,n,r){var a=No();fo.flags|=e,a.memoizedState=Lo(1|t,n,void 0,void 0===r?null:r)}function Wo(e,t,n,r){var a=Co();r=void 0===r?null:r;var i=void 0;if(null!==mo){var s=mo.memoizedState;if(i=s.destroy,null!==r&&ko(r,s.deps))return void(a.memoizedState=Lo(t,n,i,r))}fo.flags|=e,a.memoizedState=Lo(1|t,n,i,r)}function Vo(e,t){return Bo(8390656,8,e,t)}function Uo(e,t){return Wo(2048,8,e,t)}function jo(e,t){return Wo(4,2,e,t)}function Ho(e,t){return Wo(4,4,e,t)}function Go(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function qo(e,t,n){return n=null!=n?n.concat([e]):null,Wo(4,4,Go.bind(null,t,e),n)}function Ko(){}function Xo(e,t){var n=Co();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ko(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Yo(e,t){var n=Co();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ko(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Jo(e,t,n){return 0==(21&ho)?(e.baseState&&(e.baseState=!1,vl=!0),e.memoizedState=n):(sa(n,t)||(n=mn(),fo.lanes|=n,Ou|=n,e.baseState=!0),t)}function Zo(e,t){var n=vn;vn=0!==n&&4>n?n:4,e(!0);var r=po.transition;po.transition={};try{e(!1),t()}finally{vn=n,po.transition=r}}function Qo(){return Co().memoizedState}function el(e,t,n){var r=td(e);n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},nl(e)?rl(t,n):null!==(n=Ts(e,t,n,r))&&(nd(n,e,r,ed()),al(n,t,r))}function tl(e,t,n){var r=td(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(nl(e))rl(t,a);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var s=t.lastRenderedState,o=i(s,n);if(a.hasEagerState=!0,a.eagerState=o,sa(o,s)){var l=t.interleaved;return null===l?(a.next=a,Cs(t)):(a.next=l.next,l.next=a),void(t.interleaved=a)}}catch(Tp){}null!==(n=Ts(e,t,a,r))&&(nd(n,e,r,a=ed()),al(n,t,r))}}function nl(e){var t=e.alternate;return e===fo||null!==t&&t===fo}function rl(e,t){yo=bo=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function al(e,t,n){if(0!=(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yn(e,n)}}var il={readContext:Is,useCallback:wo,useContext:wo,useEffect:wo,useImperativeHandle:wo,useInsertionEffect:wo,useLayoutEffect:wo,useMemo:wo,useReducer:wo,useRef:wo,useState:wo,useDebugValue:wo,useDeferredValue:wo,useTransition:wo,useMutableSource:wo,useSyncExternalStore:wo,useId:wo,unstable_isNewReconciler:!1},sl={readContext:Is,useCallback:function(e,t){return No().memoizedState=[e,void 0===t?null:t],e},useContext:Is,useEffect:Vo,useImperativeHandle:function(e,t,n){return n=null!=n?n.concat([e]):null,Bo(4194308,4,Go.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Bo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Bo(4,2,e,t)},useMemo:function(e,t){var n=No();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=No();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=el.bind(null,fo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},No().memoizedState=e},useState:Po,useDebugValue:Ko,useDeferredValue:function(e){return No().memoizedState=e},useTransition:function(){var e=Po(!1),t=e[0];return e=Zo.bind(null,e[1]),No().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=fo,a=No();if(rs){if(void 0===n)throw Error(ae(407));n=n()}else{if(n=t(),null===_u)throw Error(ae(349));0!=(30&ho)||Ro(r,t,n)}a.memoizedState=n;var i={value:n,getSnapshot:t};return a.queue=i,Vo(Fo.bind(null,r,i,e),[e]),r.flags|=2048,Lo(9,Do.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=No(),t=_u.identifierPrefix;if(rs){var n=Yi;t=":"+t+"R"+(n=(Xi&~(1<<32-sn(Xi)-1)).toString(32)+n),0<(n=vo++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=xo++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ol={readContext:Is,useCallback:Xo,useContext:Is,useEffect:Uo,useImperativeHandle:qo,useInsertionEffect:jo,useLayoutEffect:Ho,useMemo:Yo,useReducer:Eo,useRef:zo,useState:function(){return Eo(To)},useDebugValue:Ko,useDeferredValue:function(e){return Jo(Co(),mo.memoizedState,e)},useTransition:function(){return[Eo(To)[0],Co().memoizedState]},useMutableSource:$o,useSyncExternalStore:Ao,useId:Qo,unstable_isNewReconciler:!1},ll={readContext:Is,useCallback:Xo,useContext:Is,useEffect:Uo,useImperativeHandle:qo,useInsertionEffect:jo,useLayoutEffect:Ho,useMemo:Yo,useReducer:_o,useRef:zo,useState:function(){return _o(To)},useDebugValue:Ko,useDeferredValue:function(e){var t=Co();return null===mo?t.memoizedState=e:Jo(t,mo.memoizedState,e)},useTransition:function(){return[_o(To)[0],Co().memoizedState]},useMutableSource:$o,useSyncExternalStore:Ao,useId:Qo,unstable_isNewReconciler:!1};function ul(e,t){try{var n="",r=t;do{n+=Be(r),r=r.return}while(r);var a=n}catch(Sp){a="\nError generating stack: "+Sp.message+"\n"+Sp.stack}return{value:e,source:t,stack:a,digest:null}}function dl(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function cl(e,t){try{console.error(t.value)}catch(xp){setTimeout((function(){throw xp}))}}var pl="function"==typeof WeakMap?WeakMap:Map;function hl(e,t,n){(n=Rs(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){ju||(ju=!0,Hu=r),cl(0,t)},n}function fl(e,t,n){(n=Rs(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"==typeof r){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){cl(0,t)}}var i=e.stateNode;return null!==i&&"function"==typeof i.componentDidCatch&&(n.callback=function(){cl(0,t),"function"!=typeof r&&(null===Gu?Gu=new Set([this]):Gu.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ml(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new pl;var a=new Set;r.set(t,a)}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=Nd.bind(null,e,t,n),t.then(e,e))}function gl(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function bl(e,t,n,r,a){return 0==(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Rs(-1,1)).tag=2,Ds(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}var yl=ve.ReactCurrentOwner,vl=!1;function xl(e,t,n,r){t.child=null===e?Ys(t,null,n,r):Xs(t,e.child,n,r)}function wl(e,t,n,r,a){n=n.render;var i=t.ref;return Ss(t,a),r=So(e,t,n,r,i,a),n=Io(),null===e||vl?(rs&&n&&Qi(t),t.flags|=1,xl(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,jl(e,t,a))}function kl(e,t,n,r,a){if(null===e){var i=n.type;return"function"!=typeof i||Rd(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Fd(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Sl(e,t,i,r,a))}if(i=e.child,0==(e.lanes&a)){var s=i.memoizedProps;if((n=null!==(n=n.compare)?n:oa)(s,r)&&e.ref===t.ref)return jl(e,t,a)}return t.flags|=1,(e=Dd(i,r)).ref=t.ref,e.return=t,t.child=e}function Sl(e,t,n,r,a){if(null!==e){var i=e.memoizedProps;if(oa(i,r)&&e.ref===t.ref){if(vl=!1,t.pendingProps=r=i,0==(e.lanes&a))return t.lanes=e.lanes,jl(e,t,a);0!=(131072&e.flags)&&(vl=!0)}}return Cl(e,t,n,r,a)}function Il(e,t,n){var r=t.pendingProps,a=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0==(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ni(Du,Ru),Ru|=n;else{if(0==(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ni(Du,Ru),Ru|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==i?i.baseLanes:n,Ni(Du,Ru),Ru|=r}else null!==i?(r=i.baseLanes|n,t.memoizedState=null):r=n,Ni(Du,Ru),Ru|=r;return xl(e,t,a,n),t.child}function Nl(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Cl(e,t,n,r,a){var i=Ai(n)?_i:Ti.current;return i=$i(t,i),Ss(t,a),n=So(e,t,n,r,i,a),r=Io(),null===e||vl?(rs&&r&&Qi(t),t.flags|=1,xl(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,jl(e,t,a))}function Tl(e,t,n,r,a){if(Ai(n)){var i=!0;Mi(t)}else i=!1;if(Ss(t,a),null===t.stateNode)Ul(e,t),Vs(t,n,r),js(t,n,r,a),r=!0;else if(null===e){var s=t.stateNode,o=t.memoizedProps;s.props=o;var l=s.context,u=n.contextType;u="object"==typeof u&&null!==u?Is(u):$i(t,u=Ai(n)?_i:Ti.current);var d=n.getDerivedStateFromProps,c="function"==typeof d||"function"==typeof s.getSnapshotBeforeUpdate;c||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(o!==r||l!==u)&&Us(t,s,r,u),_s=!1;var p=t.memoizedState;s.state=p,Os(t,r,s,a),l=t.memoizedState,o!==r||p!==l||Ei.current||_s?("function"==typeof d&&(zs(t,n,d,r),l=t.memoizedState),(o=_s||Ws(t,n,o,r,p,l,u))?(c||"function"!=typeof s.UNSAFE_componentWillMount&&"function"!=typeof s.componentWillMount||("function"==typeof s.componentWillMount&&s.componentWillMount(),"function"==typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"==typeof s.componentDidMount&&(t.flags|=4194308)):("function"==typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),s.props=r,s.state=l,s.context=u,r=o):("function"==typeof s.componentDidMount&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,As(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:ms(t.type,o),s.props=u,c=t.pendingProps,p=s.context,l="object"==typeof(l=n.contextType)&&null!==l?Is(l):$i(t,l=Ai(n)?_i:Ti.current);var h=n.getDerivedStateFromProps;(d="function"==typeof h||"function"==typeof s.getSnapshotBeforeUpdate)||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(o!==c||p!==l)&&Us(t,s,r,l),_s=!1,p=t.memoizedState,s.state=p,Os(t,r,s,a);var f=t.memoizedState;o!==c||p!==f||Ei.current||_s?("function"==typeof h&&(zs(t,n,h,r),f=t.memoizedState),(u=_s||Ws(t,n,u,r,p,f,l)||!1)?(d||"function"!=typeof s.UNSAFE_componentWillUpdate&&"function"!=typeof s.componentWillUpdate||("function"==typeof s.componentWillUpdate&&s.componentWillUpdate(r,f,l),"function"==typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,f,l)),"function"==typeof s.componentDidUpdate&&(t.flags|=4),"function"==typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof s.componentDidUpdate||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),s.props=r,s.state=f,s.context=l,r=u):("function"!=typeof s.componentDidUpdate||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),r=!1)}return El(e,t,n,r,i,a)}function El(e,t,n,r,a,i){Nl(e,t);var s=0!=(128&t.flags);if(!r&&!s)return a&&Oi(t,n,!1),jl(e,t,i);r=t.stateNode,yl.current=t;var o=s&&"function"!=typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&s?(t.child=Xs(t,e.child,null,i),t.child=Xs(t,null,o,i)):xl(e,t,o,i),t.memoizedState=r.state,a&&Oi(t,n,!0),t.child}function _l(e){var t=e.stateNode;t.pendingContext?Di(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Di(0,t.context,!1),no(e,t.containerInfo)}function $l(e,t,n,r,a){return ps(),hs(a),t.flags|=256,xl(e,t,n,r),t.child}var Al,Rl,Dl,Fl,Ml={dehydrated:null,treeContext:null,retryLane:0};function Ol(e){return{baseLanes:e,cachePool:null,transitions:null}}function Pl(e,t,n){var r,a=t.pendingProps,i=so.current,s=!1,o=0!=(128&t.flags);if((r=o)||(r=(null===e||null!==e.memoizedState)&&0!=(2&i)),r?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(i|=1),Ni(so,1&i),null===e)return ls(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0==(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(o=a.children,e=a.fallback,s?(a=t.mode,s=t.child,o={mode:"hidden",children:o},0==(1&a)&&null!==s?(s.childLanes=0,s.pendingProps=o):s=Od(o,a,0,null),e=Md(e,a,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Ol(n),t.memoizedState=Ml,e):Ll(t,o));if(null!==(i=e.memoizedState)&&null!==(r=i.dehydrated))return function(e,t,n,r,a,i,s){if(n)return 256&t.flags?(t.flags&=-257,zl(e,t,s,r=dl(Error(ae(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(i=r.fallback,a=t.mode,r=Od({mode:"visible",children:r.children},a,0,null),(i=Md(i,a,s,null)).flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,0!=(1&t.mode)&&Xs(t,e.child,null,s),t.child.memoizedState=Ol(s),t.memoizedState=Ml,i);if(0==(1&t.mode))return zl(e,t,s,null);if("$!"===a.data){if(r=a.nextSibling&&a.nextSibling.dataset)var o=r.dgst;return r=o,zl(e,t,s,r=dl(i=Error(ae(419)),r,void 0))}if(o=0!=(s&e.childLanes),vl||o){if(null!==(r=_u)){switch(s&-s){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=0!=(a&(r.suspendedLanes|s))?0:a)&&a!==i.retryLane&&(i.retryLane=a,Es(e,a),nd(r,e,a,-1))}return md(),zl(e,t,s,r=dl(Error(ae(421))))}return"$?"===a.data?(t.flags|=128,t.child=e.child,t=Td.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,ns=li(a.nextSibling),ts=t,rs=!0,as=null,null!==e&&(Gi[qi++]=Xi,Gi[qi++]=Yi,Gi[qi++]=Ki,Xi=e.id,Yi=e.overflow,Ki=t),(t=Ll(t,r.children)).flags|=4096,t)}(e,t,o,a,r,i,n);if(s){s=a.fallback,o=t.mode,r=(i=e.child).sibling;var l={mode:"hidden",children:a.children};return 0==(1&o)&&t.child!==i?((a=t.child).childLanes=0,a.pendingProps=l,t.deletions=null):(a=Dd(i,l)).subtreeFlags=14680064&i.subtreeFlags,null!==r?s=Dd(r,s):(s=Md(s,o,n,null)).flags|=2,s.return=t,a.return=t,a.sibling=s,t.child=a,a=s,s=t.child,o=null===(o=e.child.memoizedState)?Ol(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=e.childLanes&~n,t.memoizedState=Ml,a}return e=(s=e.child).sibling,a=Dd(s,{mode:"visible",children:a.children}),0==(1&t.mode)&&(a.lanes=n),a.return=t,a.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=a,t.memoizedState=null,a}function Ll(e,t){return(t=Od({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function zl(e,t,n,r){return null!==r&&hs(r),Xs(t,e.child,null,n),(e=Ll(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Bl(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),ks(e.return,t,n)}function Wl(e,t,n,r,a){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function Vl(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;if(xl(e,t,r.children,n),0!=(2&(r=so.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!=(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Bl(e,n,t);else if(19===e.tag)Bl(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ni(so,r),0==(1&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===oo(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),Wl(t,!1,a,n,i);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===oo(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}Wl(t,!0,n,null,i);break;case"together":Wl(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ul(e,t){0==(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function jl(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ou|=t.lanes,0==(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(ae(153));if(null!==t.child){for(n=Dd(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Dd(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Hl(e,t){if(!rs)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Gl(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=14680064&a.subtreeFlags,r|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function ql(e,t,n){var r=t.pendingProps;switch(es(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Gl(t),null;case 1:case 17:return Ai(t.type)&&Ri(),Gl(t),null;case 3:return r=t.stateNode,ro(),Ii(Ei),Ii(Ti),uo(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ds(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0==(256&t.flags)||(t.flags|=1024,null!==as&&(sd(as),as=null))),Rl(e,t),Gl(t),null;case 5:io(t);var a=to(eo.current);if(n=t.type,null!==e&&null!=t.stateNode)Dl(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(ae(166));return Gl(t),null}if(e=to(Zs.current),ds(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[ci]=t,r[pi]=i,e=0!=(1&t.mode),n){case"dialog":La("cancel",r),La("close",r);break;case"iframe":case"object":case"embed":La("load",r);break;case"video":case"audio":for(a=0;a<Fa.length;a++)La(Fa[a],r);break;case"source":La("error",r);break;case"img":case"image":case"link":La("error",r),La("load",r);break;case"details":La("toggle",r);break;case"input":Xe(r,i),La("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},La("invalid",r);break;case"textarea":rt(r,i),La("invalid",r)}for(var s in bt(n,i),a=null,i)if(i.hasOwnProperty(s)){var o=i[s];"children"===s?"string"==typeof o?r.textContent!==o&&(!0!==i.suppressHydrationWarning&&Ja(r.textContent,o,e),a=["children",o]):"number"==typeof o&&r.textContent!==""+o&&(!0!==i.suppressHydrationWarning&&Ja(r.textContent,o,e),a=["children",""+o]):se.hasOwnProperty(s)&&null!=o&&"onScroll"===s&&La("scroll",r)}switch(n){case"input":He(r),Ze(r,i,!0);break;case"textarea":He(r),it(r);break;case"select":case"option":break;default:"function"==typeof i.onClick&&(r.onclick=Za)}r=a,t.updateQueue=r,null!==r&&(t.flags|=4)}else{s=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=st(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=s.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof r.is?e=s.createElement(n,{is:r.is}):(e=s.createElement(n),"select"===n&&(s=e,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):e=s.createElementNS(e,n),e[ci]=t,e[pi]=r,Al(e,t,!1,!1),t.stateNode=e;e:{switch(s=yt(n,r),n){case"dialog":La("cancel",e),La("close",e),a=r;break;case"iframe":case"object":case"embed":La("load",e),a=r;break;case"video":case"audio":for(a=0;a<Fa.length;a++)La(Fa[a],e);a=r;break;case"source":La("error",e),a=r;break;case"img":case"image":case"link":La("error",e),La("load",e),a=r;break;case"details":La("toggle",e),a=r;break;case"input":Xe(e,r),a=Ke(e,r),La("invalid",e);break;case"option":default:a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=Oe({},r,{value:void 0}),La("invalid",e);break;case"textarea":rt(e,r),a=nt(e,r),La("invalid",e)}for(i in bt(n,a),o=a)if(o.hasOwnProperty(i)){var l=o[i];"style"===i?mt(e,l):"dangerouslySetInnerHTML"===i?null!=(l=l?l.__html:void 0)&&dt(e,l):"children"===i?"string"==typeof l?("textarea"!==n||""!==l)&&ct(e,l):"number"==typeof l&&ct(e,""+l):"suppressContentEditableWarning"!==i&&"suppressHydrationWarning"!==i&&"autoFocus"!==i&&(se.hasOwnProperty(i)?null!=l&&"onScroll"===i&&La("scroll",e):null!=l&&ye(e,i,l,s))}switch(n){case"input":He(e),Ze(e,r,!1);break;case"textarea":He(e),it(e);break;case"option":null!=r.value&&e.setAttribute("value",""+Ue(r.value));break;case"select":e.multiple=!!r.multiple,null!=(i=r.value)?tt(e,!!r.multiple,i,!1):null!=r.defaultValue&&tt(e,!!r.multiple,r.defaultValue,!0);break;default:"function"==typeof a.onClick&&(e.onclick=Za)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Gl(t),null;case 6:if(e&&null!=t.stateNode)Fl(e,t,e.memoizedProps,r);else{if("string"!=typeof r&&null===t.stateNode)throw Error(ae(166));if(n=to(eo.current),to(Zs.current),ds(t)){if(r=t.stateNode,n=t.memoizedProps,r[ci]=t,(i=r.nodeValue!==n)&&null!==(e=ts))switch(e.tag){case 3:Ja(r.nodeValue,n,0!=(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Ja(r.nodeValue,n,0!=(1&e.mode))}i&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[ci]=t,t.stateNode=r}return Gl(t),null;case 13:if(Ii(so),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(rs&&null!==ns&&0!=(1&t.mode)&&0==(128&t.flags))cs(),ps(),t.flags|=98560,i=!1;else if(i=ds(t),null!==r&&null!==r.dehydrated){if(null===e){if(!i)throw Error(ae(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(ae(317));i[ci]=t}else ps(),0==(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Gl(t),i=!1}else null!==as&&(sd(as),as=null),i=!0;if(!i)return 65536&t.flags?t:null}return 0!=(128&t.flags)?(t.lanes=n,t):((r=null!==r)!=(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!=(1&t.mode)&&(null===e||0!=(1&so.current)?0===Fu&&(Fu=3):md())),null!==t.updateQueue&&(t.flags|=4),Gl(t),null);case 4:return ro(),Rl(e,t),null===e&&Wa(t.stateNode.containerInfo),Gl(t),null;case 10:return ws(t.type._context),Gl(t),null;case 19:if(Ii(so),null===(i=t.memoizedState))return Gl(t),null;if(r=0!=(128&t.flags),null===(s=i.rendering))if(r)Hl(i,!1);else{if(0!==Fu||null!==e&&0!=(128&e.flags))for(e=t.child;null!==e;){if(null!==(s=oo(e))){for(t.flags|=128,Hl(i,!1),null!==(r=s.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(i=n).flags&=14680066,null===(s=i.alternate)?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=s.childLanes,i.lanes=s.lanes,i.child=s.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=s.memoizedProps,i.memoizedState=s.memoizedState,i.updateQueue=s.updateQueue,i.type=s.type,e=s.dependencies,i.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ni(so,1&so.current|2),t.child}e=e.sibling}null!==i.tail&&Yt()>Vu&&(t.flags|=128,r=!0,Hl(i,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=oo(s))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Hl(i,!0),null===i.tail&&"hidden"===i.tailMode&&!s.alternate&&!rs)return Gl(t),null}else 2*Yt()-i.renderingStartTime>Vu&&1073741824!==n&&(t.flags|=128,r=!0,Hl(i,!1),t.lanes=4194304);i.isBackwards?(s.sibling=t.child,t.child=s):(null!==(n=i.last)?n.sibling=s:t.child=s,i.last=s)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Yt(),t.sibling=null,n=so.current,Ni(so,r?1&n|2:1&n),t):(Gl(t),null);case 22:case 23:return cd(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!=(1&t.mode)?0!=(1073741824&Ru)&&(Gl(t),6&t.subtreeFlags&&(t.flags|=8192)):Gl(t),null;case 24:case 25:return null}throw Error(ae(156,t.tag))}function Kl(e,t){switch(es(t),t.tag){case 1:return Ai(t.type)&&Ri(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return ro(),Ii(Ei),Ii(Ti),uo(),0!=(65536&(e=t.flags))&&0==(128&e)?(t.flags=-65537&e|128,t):null;case 5:return io(t),null;case 13:if(Ii(so),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(ae(340));ps()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ii(so),null;case 4:return ro(),null;case 10:return ws(t.type._context),null;case 22:case 23:return cd(),null;default:return null}}Al=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Rl=function(){},Dl=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,to(Zs.current);var i,s=null;switch(n){case"input":a=Ke(e,a),r=Ke(e,r),s=[];break;case"select":a=Oe({},a,{value:void 0}),r=Oe({},r,{value:void 0}),s=[];break;case"textarea":a=nt(e,a),r=nt(e,r),s=[];break;default:"function"!=typeof a.onClick&&"function"==typeof r.onClick&&(e.onclick=Za)}for(u in bt(n,r),n=null,a)if(!r.hasOwnProperty(u)&&a.hasOwnProperty(u)&&null!=a[u])if("style"===u){var o=a[u];for(i in o)o.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(se.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(o=null!=a?a[u]:void 0,r.hasOwnProperty(u)&&l!==o&&(null!=l||null!=o))if("style"===u)if(o){for(i in o)!o.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in l)l.hasOwnProperty(i)&&o[i]!==l[i]&&(n||(n={}),n[i]=l[i])}else n||(s||(s=[]),s.push(u,n)),n=l;else"dangerouslySetInnerHTML"===u?(l=l?l.__html:void 0,o=o?o.__html:void 0,null!=l&&o!==l&&(s=s||[]).push(u,l)):"children"===u?"string"!=typeof l&&"number"!=typeof l||(s=s||[]).push(u,""+l):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(se.hasOwnProperty(u)?(null!=l&&"onScroll"===u&&La("scroll",e),s||o===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(t.updateQueue=u)&&(t.flags|=4)}},Fl=function(e,t,n,r){n!==r&&(t.flags|=4)};var Xl=!1,Yl=!1,Jl="function"==typeof WeakSet?WeakSet:Set,Zl=null;function Ql(e,t){var n=e.ref;if(null!==n)if("function"==typeof n)try{n(null)}catch(wp){Id(e,t,wp)}else n.current=null}function eu(e,t,n){try{n()}catch(wp){Id(e,t,wp)}}var tu=!1;function nu(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var a=r=r.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,void 0!==i&&eu(t,n,i)}a=a.next}while(a!==r)}}function ru(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function au(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"==typeof t?t(e):t.current=e}}function iu(e){var t=e.alternate;null!==t&&(e.alternate=null,iu(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&null!==(t=e.stateNode)&&(delete t[ci],delete t[pi],delete t[fi],delete t[mi],delete t[gi]),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function su(e){return 5===e.tag||3===e.tag||4===e.tag}function ou(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||su(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function lu(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=Za));else if(4!==r&&null!==(e=e.child))for(lu(e,t,n),e=e.sibling;null!==e;)lu(e,t,n),e=e.sibling}function uu(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(uu(e,t,n),e=e.sibling;null!==e;)uu(e,t,n),e=e.sibling}var du=null,cu=!1;function pu(e,t,n){for(n=n.child;null!==n;)hu(e,t,n),n=n.sibling}function hu(e,t,n){if(an&&"function"==typeof an.onCommitFiberUnmount)try{an.onCommitFiberUnmount(rn,n)}catch(pv){}switch(n.tag){case 5:Yl||Ql(n,t);case 6:var r=du,a=cu;du=null,pu(e,t,n),cu=a,null!==(du=r)&&(cu?(e=du,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):du.removeChild(n.stateNode));break;case 18:null!==du&&(cu?(e=du,n=n.stateNode,8===e.nodeType?oi(e.parentNode,n):1===e.nodeType&&oi(e,n),Vn(e)):oi(du,n.stateNode));break;case 4:r=du,a=cu,du=n.stateNode.containerInfo,cu=!0,pu(e,t,n),du=r,cu=a;break;case 0:case 11:case 14:case 15:if(!Yl&&null!==(r=n.updateQueue)&&null!==(r=r.lastEffect)){a=r=r.next;do{var i=a,s=i.destroy;i=i.tag,void 0!==s&&(0!=(2&i)||0!=(4&i))&&eu(n,t,s),a=a.next}while(a!==r)}pu(e,t,n);break;case 1:if(!Yl&&(Ql(n,t),"function"==typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(pv){Id(n,t,pv)}pu(e,t,n);break;case 21:pu(e,t,n);break;case 22:1&n.mode?(Yl=(r=Yl)||null!==n.memoizedState,pu(e,t,n),Yl=r):pu(e,t,n);break;default:pu(e,t,n)}}function fu(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Jl),t.forEach((function(t){var r=Ed.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function mu(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var a=n[r];try{var i=e,s=t,o=s;e:for(;null!==o;){switch(o.tag){case 5:du=o.stateNode,cu=!1;break e;case 3:case 4:du=o.stateNode.containerInfo,cu=!0;break e}o=o.return}if(null===du)throw Error(ae(160));hu(i,s,a),du=null,cu=!1;var l=a.alternate;null!==l&&(l.return=null),a.return=null}catch(Tp){Id(a,t,Tp)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gu(t,e),t=t.sibling}function gu(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(mu(t,e),bu(e),4&r){try{nu(3,e,e.return),ru(3,e)}catch(Dp){Id(e,e.return,Dp)}try{nu(5,e,e.return)}catch(Dp){Id(e,e.return,Dp)}}break;case 1:mu(t,e),bu(e),512&r&&null!==n&&Ql(n,n.return);break;case 5:if(mu(t,e),bu(e),512&r&&null!==n&&Ql(n,n.return),32&e.flags){var a=e.stateNode;try{ct(a,"")}catch(Dp){Id(e,e.return,Dp)}}if(4&r&&null!=(a=e.stateNode)){var i=e.memoizedProps,s=null!==n?n.memoizedProps:i,o=e.type,l=e.updateQueue;if(e.updateQueue=null,null!==l)try{"input"===o&&"radio"===i.type&&null!=i.name&&Ye(a,i),yt(o,s);var u=yt(o,i);for(s=0;s<l.length;s+=2){var d=l[s],c=l[s+1];"style"===d?mt(a,c):"dangerouslySetInnerHTML"===d?dt(a,c):"children"===d?ct(a,c):ye(a,d,c,u)}switch(o){case"input":Je(a,i);break;case"textarea":at(a,i);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var h=i.value;null!=h?tt(a,!!i.multiple,h,!1):p!==!!i.multiple&&(null!=i.defaultValue?tt(a,!!i.multiple,i.defaultValue,!0):tt(a,!!i.multiple,i.multiple?[]:"",!1))}a[pi]=i}catch(Dp){Id(e,e.return,Dp)}}break;case 6:if(mu(t,e),bu(e),4&r){if(null===e.stateNode)throw Error(ae(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(Dp){Id(e,e.return,Dp)}}break;case 3:if(mu(t,e),bu(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Vn(t.containerInfo)}catch(Dp){Id(e,e.return,Dp)}break;case 4:default:mu(t,e),bu(e);break;case 13:mu(t,e),bu(e),8192&(a=e.child).flags&&(i=null!==a.memoizedState,a.stateNode.isHidden=i,!i||null!==a.alternate&&null!==a.alternate.memoizedState||(Wu=Yt())),4&r&&fu(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Yl=(u=Yl)||d,mu(t,e),Yl=u):mu(t,e),bu(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&0!=(1&e.mode))for(Zl=e,d=e.child;null!==d;){for(c=Zl=d;null!==Zl;){switch(h=(p=Zl).child,p.tag){case 0:case 11:case 14:case 15:nu(4,p,p.return);break;case 1:Ql(p,p.return);var f=p.stateNode;if("function"==typeof f.componentWillUnmount){r=p,n=p.return;try{t=r,f.props=t.memoizedProps,f.state=t.memoizedState,f.componentWillUnmount()}catch(Dp){Id(r,n,Dp)}}break;case 5:Ql(p,p.return);break;case 22:if(null!==p.memoizedState){wu(c);continue}}null!==h?(h.return=p,Zl=h):wu(c)}d=d.sibling}e:for(d=null,c=e;;){if(5===c.tag){if(null===d){d=c;try{a=c.stateNode,u?"function"==typeof(i=a.style).setProperty?i.setProperty("display","none","important"):i.display="none":(o=c.stateNode,s=null!=(l=c.memoizedProps.style)&&l.hasOwnProperty("display")?l.display:null,o.style.display=ft("display",s))}catch(Dp){Id(e,e.return,Dp)}}}else if(6===c.tag){if(null===d)try{c.stateNode.nodeValue=u?"":c.memoizedProps}catch(Dp){Id(e,e.return,Dp)}}else if((22!==c.tag&&23!==c.tag||null===c.memoizedState||c===e)&&null!==c.child){c.child.return=c,c=c.child;continue}if(c===e)break e;for(;null===c.sibling;){if(null===c.return||c.return===e)break e;d===c&&(d=null),c=c.return}d===c&&(d=null),c.sibling.return=c.return,c=c.sibling}}break;case 19:mu(t,e),bu(e),4&r&&fu(e);case 21:}}function bu(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(su(n)){var r=n;break e}n=n.return}throw Error(ae(160))}switch(r.tag){case 5:var a=r.stateNode;32&r.flags&&(ct(a,""),r.flags&=-33),uu(e,ou(e),a);break;case 3:case 4:var i=r.stateNode.containerInfo;lu(e,ou(e),i);break;default:throw Error(ae(161))}}catch(nX){Id(e,e.return,nX)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yu(e,t,n){Zl=e,vu(e)}function vu(e,t,n){for(var r=0!=(1&e.mode);null!==Zl;){var a=Zl,i=a.child;if(22===a.tag&&r){var s=null!==a.memoizedState||Xl;if(!s){var o=a.alternate,l=null!==o&&null!==o.memoizedState||Yl;o=Xl;var u=Yl;if(Xl=s,(Yl=l)&&!u)for(Zl=a;null!==Zl;)l=(s=Zl).child,22===s.tag&&null!==s.memoizedState?ku(a):null!==l?(l.return=s,Zl=l):ku(a);for(;null!==i;)Zl=i,vu(i),i=i.sibling;Zl=a,Xl=o,Yl=u}xu(e)}else 0!=(8772&a.subtreeFlags)&&null!==i?(i.return=a,Zl=i):xu(e)}}function xu(e){for(;null!==Zl;){var t=Zl;if(0!=(8772&t.flags)){var n=t.alternate;try{if(0!=(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Yl||ru(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Yl)if(null===n)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:ms(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;null!==i&&Ps(t,i,r);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Ps(t,s,n)}break;case 5:var o=t.stateNode;if(null===n&&4&t.flags){n=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var c=d.dehydrated;null!==c&&Vn(c)}}}break;default:throw Error(ae(163))}Yl||512&t.flags&&au(t)}catch(Rp){Id(t,t.return,Rp)}}if(t===e){Zl=null;break}if(null!==(n=t.sibling)){n.return=t.return,Zl=n;break}Zl=t.return}}function wu(e){for(;null!==Zl;){var t=Zl;if(t===e){Zl=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Zl=n;break}Zl=t.return}}function ku(e){for(;null!==Zl;){var t=Zl;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{ru(4,t)}catch(nX){Id(t,n,nX)}break;case 1:var r=t.stateNode;if("function"==typeof r.componentDidMount){var a=t.return;try{r.componentDidMount()}catch(nX){Id(t,a,nX)}}var i=t.return;try{au(t)}catch(nX){Id(t,i,nX)}break;case 5:var s=t.return;try{au(t)}catch(nX){Id(t,s,nX)}}}catch(nX){Id(t,t.return,nX)}if(t===e){Zl=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Zl=o;break}Zl=t.return}}var Su,Iu=Math.ceil,Nu=ve.ReactCurrentDispatcher,Cu=ve.ReactCurrentOwner,Tu=ve.ReactCurrentBatchConfig,Eu=0,_u=null,$u=null,Au=0,Ru=0,Du=Si(0),Fu=0,Mu=null,Ou=0,Pu=0,Lu=0,zu=null,Bu=null,Wu=0,Vu=1/0,Uu=null,ju=!1,Hu=null,Gu=null,qu=!1,Ku=null,Xu=0,Yu=0,Ju=null,Zu=-1,Qu=0;function ed(){return 0!=(6&Eu)?Yt():-1!==Zu?Zu:Zu=Yt()}function td(e){return 0==(1&e.mode)?1:0!=(2&Eu)&&0!==Au?Au&-Au:null!==fs.transition?(0===Qu&&(Qu=mn()),Qu):0!==(e=vn)?e:e=void 0===(e=window.event)?16:Yn(e.type)}function nd(e,t,n,r){if(50<Yu)throw Yu=0,Ju=null,Error(ae(185));bn(e,n,r),0!=(2&Eu)&&e===_u||(e===_u&&(0==(2&Eu)&&(Pu|=n),4===Fu&&od(e,Au)),rd(e,r),1===n&&0===Eu&&0==(1&t.mode)&&(Vu=Yt()+500,Li&&Wi()))}function rd(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var s=31-sn(i),o=1<<s,l=a[s];-1===l?0!=(o&n)&&0==(o&r)||(a[s]=hn(o,t)):l<=t&&(e.expiredLanes|=o),i&=~o}}(e,t);var r=pn(e,e===_u?Au:0);if(0===r)null!==n&&qt(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&qt(n),1===t)0===e.tag?function(e){Li=!0,Bi(e)}(ld.bind(null,e)):Bi(ld.bind(null,e)),ii((function(){0==(6&Eu)&&Wi()})),n=null;else{switch(xn(r)){case 1:n=Zt;break;case 4:n=Qt;break;case 16:default:n=en;break;case 536870912:n=nn}n=_d(n,ad.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ad(e,t){if(Zu=-1,Qu=0,0!=(6&Eu))throw Error(ae(327));var n=e.callbackNode;if(kd()&&e.callbackNode!==n)return null;var r=pn(e,e===_u?Au:0);if(0===r)return null;if(0!=(30&r)||0!=(r&e.expiredLanes)||t)t=gd(e,r);else{t=r;var a=Eu;Eu|=2;var i=fd();for(_u===e&&Au===t||(Uu=null,Vu=Yt()+500,pd(e,t));;)try{yd();break}catch(pv){hd(e,pv)}xs(),Nu.current=i,Eu=a,null!==$u?t=0:(_u=null,Au=0,t=Fu)}if(0!==t){if(2===t&&0!==(a=fn(e))&&(r=a,t=id(e,a)),1===t)throw n=Mu,pd(e,0),od(e,r),rd(e,Yt()),n;if(6===t)od(e,r);else{if(a=e.current.alternate,0==(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!sa(i(),a))return!1}catch(s){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)&&(2===(t=gd(e,r))&&0!==(i=fn(e))&&(r=i,t=id(e,i)),1===t))throw n=Mu,pd(e,0),od(e,r),rd(e,Yt()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(ae(345));case 2:case 5:wd(e,Bu,Uu);break;case 3:if(od(e,r),(130023424&r)===r&&10<(t=Wu+500-Yt())){if(0!==pn(e,0))break;if(((a=e.suspendedLanes)&r)!==r){ed(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=ni(wd.bind(null,e,Bu,Uu),t);break}wd(e,Bu,Uu);break;case 4:if(od(e,r),(4194240&r)===r)break;for(t=e.eventTimes,a=-1;0<r;){var s=31-sn(r);i=1<<s,(s=t[s])>a&&(a=s),r&=~i}if(r=a,10<(r=(120>(r=Yt()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Iu(r/1960))-r)){e.timeoutHandle=ni(wd.bind(null,e,Bu,Uu),r);break}wd(e,Bu,Uu);break;default:throw Error(ae(329))}}}return rd(e,Yt()),e.callbackNode===n?ad.bind(null,e):null}function id(e,t){var n=zu;return e.current.memoizedState.isDehydrated&&(pd(e,t).flags|=256),2!==(e=gd(e,t))&&(t=Bu,Bu=n,null!==t&&sd(t)),e}function sd(e){null===Bu?Bu=e:Bu.push.apply(Bu,e)}function od(e,t){for(t&=~Lu,t&=~Pu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-sn(t),r=1<<n;e[n]=-1,t&=~r}}function ld(e){if(0!=(6&Eu))throw Error(ae(327));kd();var t=pn(e,0);if(0==(1&t))return rd(e,Yt()),null;var n=gd(e,t);if(0!==e.tag&&2===n){var r=fn(e);0!==r&&(t=r,n=id(e,r))}if(1===n)throw n=Mu,pd(e,0),od(e,t),rd(e,Yt()),n;if(6===n)throw Error(ae(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wd(e,Bu,Uu),rd(e,Yt()),null}function ud(e,t){var n=Eu;Eu|=1;try{return e(t)}finally{0===(Eu=n)&&(Vu=Yt()+500,Li&&Wi())}}function dd(e){null!==Ku&&0===Ku.tag&&0==(6&Eu)&&kd();var t=Eu;Eu|=1;var n=Tu.transition,r=vn;try{if(Tu.transition=null,vn=1,e)return e()}finally{vn=r,Tu.transition=n,0==(6&(Eu=t))&&Wi()}}function cd(){Ru=Du.current,Ii(Du)}function pd(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ri(n)),null!==$u)for(n=$u.return;null!==n;){var r=n;switch(es(r),r.tag){case 1:null!=(r=r.type.childContextTypes)&&Ri();break;case 3:ro(),Ii(Ei),Ii(Ti),uo();break;case 5:io(r);break;case 4:ro();break;case 13:case 19:Ii(so);break;case 10:ws(r.type._context);break;case 22:case 23:cd()}n=n.return}if(_u=e,$u=e=Dd(e.current,null),Au=Ru=t,Fu=0,Mu=null,Lu=Pu=Ou=0,Bu=zu=null,null!==Ns){for(t=0;t<Ns.length;t++)if(null!==(r=(n=Ns[t]).interleaved)){n.interleaved=null;var a=r.next,i=n.pending;if(null!==i){var s=i.next;i.next=a,r.next=s}n.pending=r}Ns=null}return e}function hd(e,t){for(;;){var n=$u;try{if(xs(),co.current=il,bo){for(var r=fo.memoizedState;null!==r;){var a=r.queue;null!==a&&(a.pending=null),r=r.next}bo=!1}if(ho=0,go=mo=fo=null,yo=!1,vo=0,Cu.current=null,null===n||null===n.return){Fu=1,Mu=t,$u=null;break}e:{var i=e,s=n.return,o=n,l=t;if(t=Au,o.flags|=32768,null!==l&&"object"==typeof l&&"function"==typeof l.then){var u=l,d=o,c=d.tag;if(0==(1&d.mode)&&(0===c||11===c||15===c)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var h=gl(s);if(null!==h){h.flags&=-257,bl(h,s,o,0,t),1&h.mode&&ml(i,u,t),l=u;var f=(t=h).updateQueue;if(null===f){var m=new Set;m.add(l),t.updateQueue=m}else f.add(l);break e}if(0==(1&t)){ml(i,u,t),md();break e}l=Error(ae(426))}else if(rs&&1&o.mode){var g=gl(s);if(null!==g){0==(65536&g.flags)&&(g.flags|=256),bl(g,s,o,0,t),hs(ul(l,o));break e}}i=l=ul(l,o),4!==Fu&&(Fu=2),null===zu?zu=[i]:zu.push(i),i=s;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t,Ms(i,hl(0,l,t));break e;case 1:o=l;var b=i.type,y=i.stateNode;if(0==(128&i.flags)&&("function"==typeof b.getDerivedStateFromError||null!==y&&"function"==typeof y.componentDidCatch&&(null===Gu||!Gu.has(y)))){i.flags|=65536,t&=-t,i.lanes|=t,Ms(i,fl(i,o,t));break e}}i=i.return}while(null!==i)}xd(n)}catch(nD){t=nD,$u===n&&null!==n&&($u=n=n.return);continue}break}}function fd(){var e=Nu.current;return Nu.current=il,null===e?il:e}function md(){0!==Fu&&3!==Fu&&2!==Fu||(Fu=4),null===_u||0==(268435455&Ou)&&0==(268435455&Pu)||od(_u,Au)}function gd(e,t){var n=Eu;Eu|=2;var r=fd();for(_u===e&&Au===t||(Uu=null,pd(e,t));;)try{bd();break}catch(kp){hd(e,kp)}if(xs(),Eu=n,Nu.current=r,null!==$u)throw Error(ae(261));return _u=null,Au=0,Fu}function bd(){for(;null!==$u;)vd($u)}function yd(){for(;null!==$u&&!Kt();)vd($u)}function vd(e){var t=Su(e.alternate,e,Ru);e.memoizedProps=e.pendingProps,null===t?xd(e):$u=t,Cu.current=null}function xd(e){var t=e;do{var n=t.alternate;if(e=t.return,0==(32768&t.flags)){if(null!==(n=ql(n,t,Ru)))return void($u=n)}else{if(null!==(n=Kl(n,t)))return n.flags&=32767,void($u=n);if(null===e)return Fu=6,void($u=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void($u=t);$u=t=e}while(null!==t);0===Fu&&(Fu=5)}function wd(e,t,n){var r=vn,a=Tu.transition;try{Tu.transition=null,vn=1,function(e,t,n,r){do{kd()}while(null!==Ku);if(0!=(6&Eu))throw Error(ae(327));n=e.finishedWork;var a=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(ae(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-sn(n),i=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~i}}(e,i),e===_u&&($u=_u=null,Au=0),0==(2064&n.subtreeFlags)&&0==(2064&n.flags)||qu||(qu=!0,_d(en,(function(){return kd(),null}))),i=0!=(15990&n.flags),0!=(15990&n.subtreeFlags)||i){i=Tu.transition,Tu.transition=null;var s=vn;vn=1;var o=Eu;Eu|=4,Cu.current=null,function(e,t){if(Qa=jn,pa(e=ca())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var a=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch(I){n=null;break e}var s=0,o=-1,l=-1,u=0,d=0,c=e,p=null;t:for(;;){for(var h;c!==n||0!==a&&3!==c.nodeType||(o=s+a),c!==i||0!==r&&3!==c.nodeType||(l=s+r),3===c.nodeType&&(s+=c.nodeValue.length),null!==(h=c.firstChild);)p=c,c=h;for(;;){if(c===e)break t;if(p===n&&++u===a&&(o=s),p===i&&++d===r&&(l=s),null!==(h=c.nextSibling))break;p=(c=p).parentNode}c=h}n=-1===o||-1===l?null:{start:o,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(ei={focusedElem:e,selectionRange:n},jn=!1,Zl=t;null!==Zl;)if(e=(t=Zl).child,0!=(1028&t.subtreeFlags)&&null!==e)e.return=t,Zl=e;else for(;null!==Zl;){t=Zl;try{var f=t.alternate;if(0!=(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==f){var m=f.memoizedProps,g=f.memoizedState,b=t.stateNode,y=b.getSnapshotBeforeUpdate(t.elementType===t.type?m:ms(t.type,m),g);b.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var v=t.stateNode.containerInfo;1===v.nodeType?v.textContent="":9===v.nodeType&&v.documentElement&&v.removeChild(v.documentElement);break;default:throw Error(ae(163))}}catch(I){Id(t,t.return,I)}if(null!==(e=t.sibling)){e.return=t.return,Zl=e;break}Zl=t.return}f=tu,tu=!1}(e,n),gu(n,e),ha(ei),jn=!!Qa,ei=Qa=null,e.current=n,yu(n),Xt(),Eu=o,vn=s,Tu.transition=i}else e.current=n;if(qu&&(qu=!1,Ku=e,Xu=a),0===(i=e.pendingLanes)&&(Gu=null),function(e){if(an&&"function"==typeof an.onCommitFiberRoot)try{an.onCommitFiberRoot(rn,e,void 0,128==(128&e.current.flags))}catch(t){}}(n.stateNode),rd(e,Yt()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(ju)throw ju=!1,e=Hu,Hu=null,e;0!=(1&Xu)&&0!==e.tag&&kd(),0!=(1&(i=e.pendingLanes))?e===Ju?Yu++:(Yu=0,Ju=e):Yu=0,Wi()}(e,t,n,r)}finally{Tu.transition=a,vn=r}return null}function kd(){if(null!==Ku){var e=xn(Xu),t=Tu.transition,n=vn;try{if(Tu.transition=null,vn=16>e?16:e,null===Ku)var r=!1;else{if(e=Ku,Ku=null,Xu=0,0!=(6&Eu))throw Error(ae(331));var a=Eu;for(Eu|=4,Zl=e.current;null!==Zl;){var i=Zl,s=i.child;if(0!=(16&Zl.flags)){var o=i.deletions;if(null!==o){for(var l=0;l<o.length;l++){var u=o[l];for(Zl=u;null!==Zl;){var d=Zl;switch(d.tag){case 0:case 11:case 15:nu(8,d,i)}var c=d.child;if(null!==c)c.return=d,Zl=c;else for(;null!==Zl;){var p=(d=Zl).sibling,h=d.return;if(iu(d),d===u){Zl=null;break}if(null!==p){p.return=h,Zl=p;break}Zl=h}}}var f=i.alternate;if(null!==f){var m=f.child;if(null!==m){f.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(null!==m)}}Zl=i}}if(0!=(2064&i.subtreeFlags)&&null!==s)s.return=i,Zl=s;else e:for(;null!==Zl;){if(0!=(2048&(i=Zl).flags))switch(i.tag){case 0:case 11:case 15:nu(9,i,i.return)}var b=i.sibling;if(null!==b){b.return=i.return,Zl=b;break e}Zl=i.return}}var y=e.current;for(Zl=y;null!==Zl;){var v=(s=Zl).child;if(0!=(2064&s.subtreeFlags)&&null!==v)v.return=s,Zl=v;else e:for(s=y;null!==Zl;){if(0!=(2048&(o=Zl).flags))try{switch(o.tag){case 0:case 11:case 15:ru(9,o)}}catch(nD){Id(o,o.return,nD)}if(o===s){Zl=null;break e}var x=o.sibling;if(null!==x){x.return=o.return,Zl=x;break e}Zl=o.return}}if(Eu=a,Wi(),an&&"function"==typeof an.onPostCommitFiberRoot)try{an.onPostCommitFiberRoot(rn,e)}catch(nD){}r=!0}return r}finally{vn=n,Tu.transition=t}}return!1}function Sd(e,t,n){e=Ds(e,t=hl(0,t=ul(n,t),1),1),t=ed(),null!==e&&(bn(e,1,t),rd(e,t))}function Id(e,t,n){if(3===e.tag)Sd(e,e,n);else for(;null!==t;){if(3===t.tag){Sd(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===Gu||!Gu.has(r))){t=Ds(t,e=fl(t,e=ul(n,e),1),1),e=ed(),null!==t&&(bn(t,1,e),rd(t,e));break}}t=t.return}}function Nd(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=ed(),e.pingedLanes|=e.suspendedLanes&n,_u===e&&(Au&n)===n&&(4===Fu||3===Fu&&(130023424&Au)===Au&&500>Yt()-Wu?pd(e,0):Lu|=n),rd(e,t)}function Cd(e,t){0===t&&(0==(1&e.mode)?t=1:(t=dn,0==(130023424&(dn<<=1))&&(dn=4194304)));var n=ed();null!==(e=Es(e,t))&&(bn(e,t,n),rd(e,n))}function Td(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Cd(e,n)}function Ed(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(ae(314))}null!==r&&r.delete(t),Cd(e,n)}function _d(e,t){return Gt(e,t)}function $d(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ad(e,t,n,r){return new $d(e,t,n,r)}function Rd(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Dd(e,t){var n=e.alternate;return null===n?((n=Ad(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Fd(e,t,n,r,a,i){var s=2;if(r=e,"function"==typeof e)Rd(e)&&(s=1);else if("string"==typeof e)s=5;else e:switch(e){case ke:return Md(n.children,a,i,t);case Se:s=8,a|=8;break;case Ie:return(e=Ad(12,n,t,2|a)).elementType=Ie,e.lanes=i,e;case Ee:return(e=Ad(13,n,t,a)).elementType=Ee,e.lanes=i,e;case _e:return(e=Ad(19,n,t,a)).elementType=_e,e.lanes=i,e;case Re:return Od(n,a,i,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case Ne:s=10;break e;case Ce:s=9;break e;case Te:s=11;break e;case $e:s=14;break e;case Ae:s=16,r=null;break e}throw Error(ae(130,null==e?e:typeof e,""))}return(t=Ad(s,n,t,a)).elementType=e,t.type=r,t.lanes=i,t}function Md(e,t,n,r){return(e=Ad(7,e,r,t)).lanes=n,e}function Od(e,t,n,r){return(e=Ad(22,e,r,t)).elementType=Re,e.lanes=n,e.stateNode={isHidden:!1},e}function Pd(e,t,n){return(e=Ad(6,e,null,t)).lanes=n,e}function Ld(e,t,n){return(t=Ad(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function zd(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gn(0),this.expirationTimes=gn(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gn(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Bd(e,t,n,r,a,i,s,o,l){return e=new zd(e,t,n,o,l),1===t?(t=1,!0===i&&(t|=8)):t=0,i=Ad(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},$s(i),e}function Wd(e){if(!e)return Ci;e:{if(Wt(e=e._reactInternals)!==e||1!==e.tag)throw Error(ae(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ai(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(ae(171))}if(1===e.tag){var n=e.type;if(Ai(n))return Fi(e,n,t)}return t}function Vd(e,t,n,r,a,i,s,o,l){return(e=Bd(n,r,!0,e,0,i,0,o,l)).context=Wd(null),n=e.current,(i=Rs(r=ed(),a=td(n))).callback=null!=t?t:null,Ds(n,i,a),e.current.lanes=a,bn(e,a,r),rd(e,r),e}function Ud(e,t,n,r){var a=t.current,i=ed(),s=td(a);return n=Wd(n),null===t.context?t.context=n:t.pendingContext=n,(t=Rs(i,s)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Ds(a,t,s))&&(nd(e,a,s,i),Fs(e,a,s)),s}function jd(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Hd(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Gd(e,t){Hd(e,t),(e=e.alternate)&&Hd(e,t)}Su=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ei.current)vl=!0;else{if(0==(e.lanes&n)&&0==(128&t.flags))return vl=!1,function(e,t,n){switch(t.tag){case 3:_l(t),ps();break;case 5:ao(t);break;case 1:Ai(t.type)&&Mi(t);break;case 4:no(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;Ni(gs,r._currentValue),r._currentValue=a;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ni(so,1&so.current),t.flags|=128,null):0!=(n&t.child.childLanes)?Pl(e,t,n):(Ni(so,1&so.current),null!==(e=jl(e,t,n))?e.sibling:null);Ni(so,1&so.current);break;case 19:if(r=0!=(n&t.childLanes),0!=(128&e.flags)){if(r)return Vl(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),Ni(so,so.current),r)break;return null;case 22:case 23:return t.lanes=0,Il(e,t,n)}return jl(e,t,n)}(e,t,n);vl=0!=(131072&e.flags)}else vl=!1,rs&&0!=(1048576&t.flags)&&Zi(t,Hi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ul(e,t),e=t.pendingProps;var a=$i(t,Ti.current);Ss(t,n),a=So(null,t,r,e,a,n);var i=Io();return t.flags|=1,"object"==typeof a&&null!==a&&"function"==typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ai(r)?(i=!0,Mi(t)):i=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,$s(t),a.updater=Bs,t.stateNode=a,a._reactInternals=t,js(t,r,e,n),t=El(null,t,r,!0,i,n)):(t.tag=0,rs&&i&&Qi(t),xl(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ul(e,t),e=t.pendingProps,r=(a=r._init)(r._payload),t.type=r,a=t.tag=function(e){if("function"==typeof e)return Rd(e)?1:0;if(null!=e){if((e=e.$$typeof)===Te)return 11;if(e===$e)return 14}return 2}(r),e=ms(r,e),a){case 0:t=Cl(null,t,r,e,n);break e;case 1:t=Tl(null,t,r,e,n);break e;case 11:t=wl(null,t,r,e,n);break e;case 14:t=kl(null,t,r,ms(r.type,e),n);break e}throw Error(ae(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,Cl(e,t,r,a=t.elementType===r?a:ms(r,a),n);case 1:return r=t.type,a=t.pendingProps,Tl(e,t,r,a=t.elementType===r?a:ms(r,a),n);case 3:e:{if(_l(t),null===e)throw Error(ae(387));r=t.pendingProps,a=(i=t.memoizedState).element,As(e,t),Os(t,r,null,n);var s=t.memoizedState;if(r=s.element,i.isDehydrated){if(i={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=$l(e,t,r,n,a=ul(Error(ae(423)),t));break e}if(r!==a){t=$l(e,t,r,n,a=ul(Error(ae(424)),t));break e}for(ns=li(t.stateNode.containerInfo.firstChild),ts=t,rs=!0,as=null,n=Ys(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(ps(),r===a){t=jl(e,t,n);break e}xl(e,t,r,n)}t=t.child}return t;case 5:return ao(t),null===e&&ls(t),r=t.type,a=t.pendingProps,i=null!==e?e.memoizedProps:null,s=a.children,ti(r,a)?s=null:null!==i&&ti(r,i)&&(t.flags|=32),Nl(e,t),xl(e,t,s,n),t.child;case 6:return null===e&&ls(t),null;case 13:return Pl(e,t,n);case 4:return no(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Xs(t,null,r,n):xl(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,wl(e,t,r,a=t.elementType===r?a:ms(r,a),n);case 7:return xl(e,t,t.pendingProps,n),t.child;case 8:case 12:return xl(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,i=t.memoizedProps,s=a.value,Ni(gs,r._currentValue),r._currentValue=s,null!==i)if(sa(i.value,s)){if(i.children===a.children&&!Ei.current){t=jl(e,t,n);break e}}else for(null!==(i=t.child)&&(i.return=t);null!==i;){var o=i.dependencies;if(null!==o){s=i.child;for(var l=o.firstContext;null!==l;){if(l.context===r){if(1===i.tag){(l=Rs(-1,n&-n)).tag=2;var u=i.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}i.lanes|=n,null!==(l=i.alternate)&&(l.lanes|=n),ks(i.return,n,t),o.lanes|=n;break}l=l.next}}else if(10===i.tag)s=i.type===t.type?null:i.child;else if(18===i.tag){if(null===(s=i.return))throw Error(ae(341));s.lanes|=n,null!==(o=s.alternate)&&(o.lanes|=n),ks(s,n,t),s=i.sibling}else s=i.child;if(null!==s)s.return=i;else for(s=i;null!==s;){if(s===t){s=null;break}if(null!==(i=s.sibling)){i.return=s.return,s=i;break}s=s.return}i=s}xl(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,Ss(t,n),r=r(a=Is(a)),t.flags|=1,xl(e,t,r,n),t.child;case 14:return a=ms(r=t.type,t.pendingProps),kl(e,t,r,a=ms(r.type,a),n);case 15:return Sl(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:ms(r,a),Ul(e,t),t.tag=1,Ai(r)?(e=!0,Mi(t)):e=!1,Ss(t,n),Vs(t,r,a),js(t,r,a,n),El(null,t,r,!0,e,n);case 19:return Vl(e,t,n);case 22:return Il(e,t,n)}throw Error(ae(156,t.tag))};var qd="function"==typeof reportError?reportError:function(e){console.error(e)};function Kd(e){this._internalRoot=e}function Xd(e){this._internalRoot=e}function Yd(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jd(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Zd(){}function Qd(e,t,n,r,a){var i=n._reactRootContainer;if(i){var s=i;if("function"==typeof a){var o=a;a=function(){var e=jd(s);o.call(e)}}Ud(t,s,e,a)}else s=function(e,t,n,r,a){if(a){if("function"==typeof r){var i=r;r=function(){var e=jd(s);i.call(e)}}var s=Vd(t,r,e,0,null,!1,0,"",Zd);return e._reactRootContainer=s,e[hi]=s.current,Wa(8===e.nodeType?e.parentNode:e),dd(),s}for(;a=e.lastChild;)e.removeChild(a);if("function"==typeof r){var o=r;r=function(){var e=jd(l);o.call(e)}}var l=Bd(e,0,!1,null,0,!1,0,"",Zd);return e._reactRootContainer=l,e[hi]=l.current,Wa(8===e.nodeType?e.parentNode:e),dd((function(){Ud(t,l,n,r)})),l}(n,t,e,a,r);return jd(s)}Xd.prototype.render=Kd.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(ae(409));Ud(e,t,null,null)},Xd.prototype.unmount=Kd.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dd((function(){Ud(null,e,null,null)})),t[hi]=null}},Xd.prototype.unstable_scheduleHydration=function(e){if(e){var t=In();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Dn.length&&0!==t&&t<Dn[n].priority;n++);Dn.splice(n,0,e),0===n&&Pn(e)}},wn=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=cn(t.pendingLanes);0!==n&&(yn(t,1|n),rd(t,Yt()),0==(6&Eu)&&(Vu=Yt()+500,Wi()))}break;case 13:dd((function(){var t=Es(e,1);if(null!==t){var n=ed();nd(t,e,1,n)}})),Gd(e,1)}},kn=function(e){if(13===e.tag){var t=Es(e,134217728);null!==t&&nd(t,e,134217728,ed()),Gd(e,134217728)}},Sn=function(e){if(13===e.tag){var t=td(e),n=Es(e,t);null!==n&&nd(n,e,t,ed()),Gd(e,t)}},In=function(){return vn},Nn=function(e,t){var n=vn;try{return vn=e,t()}finally{vn=n}},wt=function(e,t,n){switch(t){case"input":if(Je(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=xi(r);if(!a)throw Error(ae(90));Ge(r),Je(r,a)}}}break;case"textarea":at(e,n);break;case"select":null!=(t=n.value)&&tt(e,!!n.multiple,t,!1)}},Tt=ud,Et=dd;var ec={usingClientEntryPoint:!1,Events:[yi,vi,xi,Nt,Ct,ud]},tc={findFiberByHostInstance:bi,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},nc={bundleType:tc.bundleType,version:tc.version,rendererPackageName:tc.rendererPackageName,rendererConfig:tc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ve.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=jt(e))?null:e.stateNode},findFiberByHostInstance:tc.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var rc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rc.isDisabled&&rc.supportsFiber)try{rn=rc.inject(nc),an=rc}catch(ut){}}Z.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ec,Z.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Yd(t))throw Error(ae(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:we,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},Z.createRoot=function(e,t){if(!Yd(e))throw Error(ae(299));var n=!1,r="",a=qd;return null!=t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=Bd(e,1,!1,null,0,n,0,r,a),e[hi]=t.current,Wa(8===e.nodeType?e.parentNode:e),new Kd(t)},Z.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(ae(188));throw e=Object.keys(e).join(","),Error(ae(268,e))}return e=null===(e=jt(t))?null:e.stateNode},Z.flushSync=function(e){return dd(e)},Z.hydrate=function(e,t,n){if(!Jd(t))throw Error(ae(200));return Qd(null,e,t,!0,n)},Z.hydrateRoot=function(e,t,n){if(!Yd(e))throw Error(ae(405));var r=null!=n&&n.hydratedSources||null,a=!1,i="",s=qd;if(null!=n&&(!0===n.unstable_strictMode&&(a=!0),void 0!==n.identifierPrefix&&(i=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=Vd(t,null,e,1,null!=n?n:null,a,0,i,s),e[hi]=t.current,Wa(e),r)for(e=0;e<r.length;e++)a=(a=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new Xd(t)},Z.render=function(e,t,n){if(!Jd(t))throw Error(ae(200));return Qd(null,e,t,!1,n)},Z.unmountComponentAtNode=function(e){if(!Jd(e))throw Error(ae(40));return!!e._reactRootContainer&&(dd((function(){Qd(null,null,e,!1,(function(){e._reactRootContainer=null,e[hi]=null}))})),!0)},Z.unstable_batchedUpdates=ud,Z.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Jd(n))throw Error(ae(200));if(null==e||void 0===e._reactInternals)throw Error(ae(38));return Qd(e,t,n,!1,r)},Z.version="18.2.0-next-9e3b772b8-20220608",function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),J.exports=Z;var ac=J.exports;const ic=r(ac);var sc,oc=ac;function lc(e,t){return lc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},lc(e,t)}function uc(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,lc(e,t)}sc=oc.createRoot,oc.hydrateRoot;var dc={exports:{}};function cc(){}function pc(){}pc.resetWarningCache=cc,dc.exports=function(){function e(e,t,n,r,a,i){if("SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"!==i){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:pc,resetWarningCache:cc};return n.PropTypes=n,n}();const hc=r(dc.exports);function fc(){return fc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},fc.apply(this,arguments)}function mc(e){return"/"===e.charAt(0)}function gc(e,t){for(var n=t,r=n+1,a=e.length;r<a;n+=1,r+=1)e[n]=e[r];e.pop()}function bc(e){return e.valueOf?e.valueOf():Object.prototype.valueOf.call(e)}function yc(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(Array.isArray(e))return Array.isArray(t)&&e.length===t.length&&e.every((function(e,n){return yc(e,t[n])}));if("object"==typeof e||"object"==typeof t){var n=bc(e),r=bc(t);return n!==e||r!==t?yc(n,r):Object.keys(Object.assign({},e,t)).every((function(n){return yc(e[n],t[n])}))}return!1}var vc=!0,xc="Invariant failed";function wc(e,t){if(!e){if(vc)throw new Error(xc);var n="function"==typeof t?t():t,r=n?"".concat(xc,": ").concat(n):xc;throw new Error(r)}}function kc(e){return"/"===e.charAt(0)?e:"/"+e}function Sc(e,t){return function(e,t){return 0===e.toLowerCase().indexOf(t.toLowerCase())&&-1!=="/?#".indexOf(e.charAt(t.length))}(e,t)?e.substr(t.length):e}function Ic(e){return"/"===e.charAt(e.length-1)?e.slice(0,-1):e}function Nc(e){var t=e.pathname,n=e.search,r=e.hash,a=t||"/";return n&&"?"!==n&&(a+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(a+="#"===r.charAt(0)?r:"#"+r),a}function Cc(e,t,n,r){var a;"string"==typeof e?(a=function(e){var t=e||"/",n="",r="",a=t.indexOf("#");-1!==a&&(r=t.substr(a),t=t.substr(0,a));var i=t.indexOf("?");return-1!==i&&(n=t.substr(i),t=t.substr(0,i)),{pathname:t,search:"?"===n?"":n,hash:"#"===r?"":r}}(e),a.state=t):(void 0===(a=fc({},e)).pathname&&(a.pathname=""),a.search?"?"!==a.search.charAt(0)&&(a.search="?"+a.search):a.search="",a.hash?"#"!==a.hash.charAt(0)&&(a.hash="#"+a.hash):a.hash="",void 0!==t&&void 0===a.state&&(a.state=t));try{a.pathname=decodeURI(a.pathname)}catch(kp){throw kp instanceof URIError?new URIError('Pathname "'+a.pathname+'" could not be decoded. This is likely caused by an invalid percent-encoding.'):kp}return n&&(a.key=n),r?a.pathname?"/"!==a.pathname.charAt(0)&&(a.pathname=function(e,t){void 0===t&&(t="");var n,r=e&&e.split("/")||[],a=t&&t.split("/")||[],i=e&&mc(e),s=t&&mc(t),o=i||s;if(e&&mc(e)?a=r:r.length&&(a.pop(),a=a.concat(r)),!a.length)return"/";if(a.length){var l=a[a.length-1];n="."===l||".."===l||""===l}else n=!1;for(var u=0,d=a.length;d>=0;d--){var c=a[d];"."===c?gc(a,d):".."===c?(gc(a,d),u++):u&&(gc(a,d),u--)}if(!o)for(;u--;u)a.unshift("..");!o||""===a[0]||a[0]&&mc(a[0])||a.unshift("");var p=a.join("/");return n&&"/"!==p.substr(-1)&&(p+="/"),p}(a.pathname,r.pathname)):a.pathname=r.pathname:a.pathname||(a.pathname="/"),a}function Tc(e,t){return e.pathname===t.pathname&&e.search===t.search&&e.hash===t.hash&&e.key===t.key&&yc(e.state,t.state)}function Ec(){var e=null,t=[];return{setPrompt:function(t){return e=t,function(){e===t&&(e=null)}},confirmTransitionTo:function(t,n,r,a){if(null!=e){var i="function"==typeof e?e(t,n):e;"string"==typeof i?"function"==typeof r?r(i,a):a(!0):a(!1!==i)}else a(!0)},appendListener:function(e){var n=!0;function r(){n&&e.apply(void 0,arguments)}return t.push(r),function(){n=!1,t=t.filter((function(e){return e!==r}))}},notifyListeners:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.forEach((function(e){return e.apply(void 0,n)}))}}}var _c=!("undefined"==typeof window||!window.document||!window.document.createElement);function $c(e,t){t(window.confirm(e))}var Ac="popstate",Rc="hashchange";function Dc(){try{return window.history.state||{}}catch(kp){return{}}}function Fc(e){void 0===e&&(e={}),_c||wc(!1);var t=window.history,n=function(){var e=window.navigator.userAgent;return(-1===e.indexOf("Android 2.")&&-1===e.indexOf("Android 4.0")||-1===e.indexOf("Mobile Safari")||-1!==e.indexOf("Chrome")||-1!==e.indexOf("Windows Phone"))&&window.history&&"pushState"in window.history}(),r=!(-1===window.navigator.userAgent.indexOf("Trident")),a=e,i=a.forceRefresh,s=void 0!==i&&i,o=a.getUserConfirmation,l=void 0===o?$c:o,u=a.keyLength,d=void 0===u?6:u,c=e.basename?Ic(kc(e.basename)):"";function p(e){var t=e||{},n=t.key,r=t.state,a=window.location,i=a.pathname+a.search+a.hash;return c&&(i=Sc(i,c)),Cc(i,r,n)}function h(){return Math.random().toString(36).substr(2,d)}var f=Ec();function m(e){fc(T,e),T.length=t.length,f.notifyListeners(T.location,T.action)}function g(e){(function(e){return void 0===e.state&&-1===navigator.userAgent.indexOf("CriOS")})(e)||v(p(e.state))}function b(){v(p(Dc()))}var y=!1;function v(e){y?(y=!1,m()):f.confirmTransitionTo(e,"POP",l,(function(t){t?m({action:"POP",location:e}):function(e){var t=T.location,n=w.indexOf(t.key);-1===n&&(n=0);var r=w.indexOf(e.key);-1===r&&(r=0);var a=n-r;a&&(y=!0,S(a))}(e)}))}var x=p(Dc()),w=[x.key];function k(e){return c+Nc(e)}function S(e){t.go(e)}var I=0;function N(e){1===(I+=e)&&1===e?(window.addEventListener(Ac,g),r&&window.addEventListener(Rc,b)):0===I&&(window.removeEventListener(Ac,g),r&&window.removeEventListener(Rc,b))}var C=!1,T={length:t.length,action:"POP",location:x,createHref:k,push:function(e,r){var a="PUSH",i=Cc(e,r,h(),T.location);f.confirmTransitionTo(i,a,l,(function(e){if(e){var r=k(i),o=i.key,l=i.state;if(n)if(t.pushState({key:o,state:l},null,r),s)window.location.href=r;else{var u=w.indexOf(T.location.key),d=w.slice(0,u+1);d.push(i.key),w=d,m({action:a,location:i})}else window.location.href=r}}))},replace:function(e,r){var a="REPLACE",i=Cc(e,r,h(),T.location);f.confirmTransitionTo(i,a,l,(function(e){if(e){var r=k(i),o=i.key,l=i.state;if(n)if(t.replaceState({key:o,state:l},null,r),s)window.location.replace(r);else{var u=w.indexOf(T.location.key);-1!==u&&(w[u]=i.key),m({action:a,location:i})}else window.location.replace(r)}}))},go:S,goBack:function(){S(-1)},goForward:function(){S(1)},block:function(e){void 0===e&&(e=!1);var t=f.setPrompt(e);return C||(N(1),C=!0),function(){return C&&(C=!1,N(-1)),t()}},listen:function(e){var t=f.appendListener(e);return N(1),function(){N(-1),t()}}};return T}var Mc={exports:{}},Oc=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)};Mc.exports=Gc,Mc.exports.parse=Lc,Mc.exports.compile=function(e,t){return Bc(Lc(e,t),t)},Mc.exports.tokensToFunction=Bc,Mc.exports.tokensToRegExp=Hc;var Pc=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function Lc(e,t){for(var n,r=[],a=0,i=0,s="",o=t&&t.delimiter||"/";null!=(n=Pc.exec(e));){var l=n[0],u=n[1],d=n.index;if(s+=e.slice(i,d),i=d+l.length,u)s+=u[1];else{var c=e[i],p=n[2],h=n[3],f=n[4],m=n[5],g=n[6],b=n[7];s&&(r.push(s),s="");var y=null!=p&&null!=c&&c!==p,v="+"===g||"*"===g,x="?"===g||"*"===g,w=n[2]||o,k=f||m;r.push({name:h||a++,prefix:p||"",delimiter:w,optional:x,repeat:v,partial:y,asterisk:!!b,pattern:k?Vc(k):b?".*":"[^"+Wc(w)+"]+?"})}}return i<e.length&&(s+=e.substr(i)),s&&r.push(s),r}function zc(e){return encodeURI(e).replace(/[\/?#]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))}function Bc(e,t){for(var n=new Array(e.length),r=0;r<e.length;r++)"object"==typeof e[r]&&(n[r]=new RegExp("^(?:"+e[r].pattern+")$",jc(t)));return function(t,r){for(var a="",i=t||{},s=(r||{}).pretty?zc:encodeURIComponent,o=0;o<e.length;o++){var l=e[o];if("string"!=typeof l){var u,d=i[l.name];if(null==d){if(l.optional){l.partial&&(a+=l.prefix);continue}throw new TypeError('Expected "'+l.name+'" to be defined')}if(Oc(d)){if(!l.repeat)throw new TypeError('Expected "'+l.name+'" to not repeat, but received `'+JSON.stringify(d)+"`");if(0===d.length){if(l.optional)continue;throw new TypeError('Expected "'+l.name+'" to not be empty')}for(var c=0;c<d.length;c++){if(u=s(d[c]),!n[o].test(u))throw new TypeError('Expected all "'+l.name+'" to match "'+l.pattern+'", but received `'+JSON.stringify(u)+"`");a+=(0===c?l.prefix:l.delimiter)+u}}else{if(u=l.asterisk?encodeURI(d).replace(/[?#]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})):s(d),!n[o].test(u))throw new TypeError('Expected "'+l.name+'" to match "'+l.pattern+'", but received "'+u+'"');a+=l.prefix+u}}else a+=l}return a}}function Wc(e){return e.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function Vc(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function Uc(e,t){return e.keys=t,e}function jc(e){return e&&e.sensitive?"":"i"}function Hc(e,t,n){Oc(t)||(n=t||n,t=[]);for(var r=(n=n||{}).strict,a=!1!==n.end,i="",s=0;s<e.length;s++){var o=e[s];if("string"==typeof o)i+=Wc(o);else{var l=Wc(o.prefix),u="(?:"+o.pattern+")";t.push(o),o.repeat&&(u+="(?:"+l+u+")*"),i+=u=o.optional?o.partial?l+"("+u+")?":"(?:"+l+"("+u+"))?":l+"("+u+")"}}var d=Wc(n.delimiter||"/"),c=i.slice(-d.length)===d;return r||(i=(c?i.slice(0,-d.length):i)+"(?:"+d+"(?=$))?"),i+=a?"$":r&&c?"":"(?="+d+"|$)",Uc(new RegExp("^"+i,jc(n)),t)}function Gc(e,t,n){return Oc(t)||(n=t||n,t=[]),n=n||{},e instanceof RegExp?function(e,t){var n=e.source.match(/\((?!\?)/g);if(n)for(var r=0;r<n.length;r++)t.push({name:r,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return Uc(e,t)}(e,t):Oc(e)?function(e,t,n){for(var r=[],a=0;a<e.length;a++)r.push(Gc(e[a],t,n).source);return Uc(new RegExp("(?:"+r.join("|")+")",jc(n)),t)}(e,t,n):function(e,t,n){return Hc(Lc(e,n),t,n)}(e,t,n)}const qc=r(Mc.exports);var Kc={},Xc="function"==typeof Symbol&&Symbol.for,Yc=Xc?Symbol.for("react.element"):60103,Jc=Xc?Symbol.for("react.portal"):60106,Zc=Xc?Symbol.for("react.fragment"):60107,Qc=Xc?Symbol.for("react.strict_mode"):60108,ep=Xc?Symbol.for("react.profiler"):60114,tp=Xc?Symbol.for("react.provider"):60109,np=Xc?Symbol.for("react.context"):60110,rp=Xc?Symbol.for("react.async_mode"):60111,ap=Xc?Symbol.for("react.concurrent_mode"):60111,ip=Xc?Symbol.for("react.forward_ref"):60112,sp=Xc?Symbol.for("react.suspense"):60113,op=Xc?Symbol.for("react.suspense_list"):60120,lp=Xc?Symbol.for("react.memo"):60115,up=Xc?Symbol.for("react.lazy"):60116,dp=Xc?Symbol.for("react.block"):60121,cp=Xc?Symbol.for("react.fundamental"):60117,pp=Xc?Symbol.for("react.responder"):60118,hp=Xc?Symbol.for("react.scope"):60119;
/** @license React v16.13.1
             * react-is.production.min.js
             *
             * Copyright (c) Facebook, Inc. and its affiliates.
             *
             * This source code is licensed under the MIT license found in the
             * LICENSE file in the root directory of this source tree.
             */function fp(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case Yc:switch(e=e.type){case rp:case ap:case Zc:case ep:case Qc:case sp:return e;default:switch(e=e&&e.$$typeof){case np:case ip:case up:case lp:case tp:return e;default:return t}}case Jc:return t}}}function mp(e){return fp(e)===ap}function gp(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}Kc.AsyncMode=rp,Kc.ConcurrentMode=ap,Kc.ContextConsumer=np,Kc.ContextProvider=tp,Kc.Element=Yc,Kc.ForwardRef=ip,Kc.Fragment=Zc,Kc.Lazy=up,Kc.Memo=lp,Kc.Portal=Jc,Kc.Profiler=ep,Kc.StrictMode=Qc,Kc.Suspense=sp,Kc.isAsyncMode=function(e){return mp(e)||fp(e)===rp},Kc.isConcurrentMode=mp,Kc.isContextConsumer=function(e){return fp(e)===np},Kc.isContextProvider=function(e){return fp(e)===tp},Kc.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===Yc},Kc.isForwardRef=function(e){return fp(e)===ip},Kc.isFragment=function(e){return fp(e)===Zc},Kc.isLazy=function(e){return fp(e)===up},Kc.isMemo=function(e){return fp(e)===lp},Kc.isPortal=function(e){return fp(e)===Jc},Kc.isProfiler=function(e){return fp(e)===ep},Kc.isStrictMode=function(e){return fp(e)===Qc},Kc.isSuspense=function(e){return fp(e)===sp},Kc.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===Zc||e===ap||e===ep||e===Qc||e===sp||e===op||"object"==typeof e&&null!==e&&(e.$$typeof===up||e.$$typeof===lp||e.$$typeof===tp||e.$$typeof===np||e.$$typeof===ip||e.$$typeof===cp||e.$$typeof===pp||e.$$typeof===hp||e.$$typeof===dp)},Kc.typeOf=fp;var bp={exports:{}},yp={},vp="function"==typeof Symbol&&Symbol.for,xp=vp?Symbol.for("react.element"):60103,wp=vp?Symbol.for("react.portal"):60106,kp=vp?Symbol.for("react.fragment"):60107,Sp=vp?Symbol.for("react.strict_mode"):60108,Ip=vp?Symbol.for("react.profiler"):60114,Np=vp?Symbol.for("react.provider"):60109,Cp=vp?Symbol.for("react.context"):60110,Tp=vp?Symbol.for("react.async_mode"):60111,Ep=vp?Symbol.for("react.concurrent_mode"):60111,_p=vp?Symbol.for("react.forward_ref"):60112,$p=vp?Symbol.for("react.suspense"):60113,Ap=vp?Symbol.for("react.suspense_list"):60120,Rp=vp?Symbol.for("react.memo"):60115,Dp=vp?Symbol.for("react.lazy"):60116,Fp=vp?Symbol.for("react.block"):60121,Mp=vp?Symbol.for("react.fundamental"):60117,Op=vp?Symbol.for("react.responder"):60118,Pp=vp?Symbol.for("react.scope"):60119;function Lp(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case xp:switch(e=e.type){case Tp:case Ep:case kp:case Ip:case Sp:case $p:return e;default:switch(e=e&&e.$$typeof){case Cp:case _p:case Dp:case Rp:case Np:return e;default:return t}}case wp:return t}}}function zp(e){return Lp(e)===Ep}yp.AsyncMode=Tp,yp.ConcurrentMode=Ep,yp.ContextConsumer=Cp,yp.ContextProvider=Np,yp.Element=xp,yp.ForwardRef=_p,yp.Fragment=kp,yp.Lazy=Dp,yp.Memo=Rp,yp.Portal=wp,yp.Profiler=Ip,yp.StrictMode=Sp,yp.Suspense=$p,yp.isAsyncMode=function(e){return zp(e)||Lp(e)===Tp},yp.isConcurrentMode=zp,yp.isContextConsumer=function(e){return Lp(e)===Cp},yp.isContextProvider=function(e){return Lp(e)===Np},yp.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===xp},yp.isForwardRef=function(e){return Lp(e)===_p},yp.isFragment=function(e){return Lp(e)===kp},yp.isLazy=function(e){return Lp(e)===Dp},yp.isMemo=function(e){return Lp(e)===Rp},yp.isPortal=function(e){return Lp(e)===wp},yp.isProfiler=function(e){return Lp(e)===Ip},yp.isStrictMode=function(e){return Lp(e)===Sp},yp.isSuspense=function(e){return Lp(e)===$p},yp.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===kp||e===Ep||e===Ip||e===Sp||e===$p||e===Ap||"object"==typeof e&&null!==e&&(e.$$typeof===Dp||e.$$typeof===Rp||e.$$typeof===Np||e.$$typeof===Cp||e.$$typeof===_p||e.$$typeof===Mp||e.$$typeof===Op||e.$$typeof===Pp||e.$$typeof===Fp)},yp.typeOf=Lp,bp.exports=yp;var Bp=bp.exports,Wp={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},Vp={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},Up={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},jp={};function Hp(e){return Bp.isMemo(e)?Up:jp[e.$$typeof]||Wp}jp[Bp.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},jp[Bp.Memo]=Up;var Gp=Object.defineProperty,qp=Object.getOwnPropertyNames,Kp=Object.getOwnPropertySymbols,Xp=Object.getOwnPropertyDescriptor,Yp=Object.getPrototypeOf,Jp=Object.prototype,Zp=function e(t,n,r){if("string"!=typeof n){if(Jp){var a=Yp(n);a&&a!==Jp&&e(t,a,r)}var i=qp(n);Kp&&(i=i.concat(Kp(n)));for(var s=Hp(t),o=Hp(n),l=0;l<i.length;++l){var u=i[l];if(!(Vp[u]||r&&r[u]||o&&o[u]||s&&s[u])){var d=Xp(n,u);try{Gp(t,u,d)}catch(kp){}}}}return t};const Qp=r(Zp);var eh=1073741823,th="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},nh=V.createContext||function(e,t){var n,r,a,i="__create-react-context-"+(th[a="__global_unique_id__"]=(th[a]||0)+1)+"__",s=function(e){function n(){for(var t,n,r,a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(t=e.call.apply(e,[this].concat(i))||this).emitter=(n=t.props.value,r=[],{on:function(e){r.push(e)},off:function(e){r=r.filter((function(t){return t!==e}))},get:function(){return n},set:function(e,t){n=e,r.forEach((function(e){return e(n,t)}))}}),t}uc(n,e);var r=n.prototype;return r.getChildContext=function(){var e;return(e={})[i]=this.emitter,e},r.componentWillReceiveProps=function(e){if(this.props.value!==e.value){var n,r=this.props.value,a=e.value;!function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}(r,a)?(n="function"==typeof t?t(r,a):eh,0!=(n|=0)&&this.emitter.set(e.value,n)):n=0}},r.render=function(){return this.props.children},n}(V.Component);s.childContextTypes=((n={})[i]=hc.object.isRequired,n);var o=function(t){function n(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))||this).observedBits=void 0,e.state={value:e.getValue()},e.onUpdate=function(t,n){0!=((0|e.observedBits)&n)&&e.setState({value:e.getValue()})},e}uc(n,t);var r=n.prototype;return r.componentWillReceiveProps=function(e){var t=e.observedBits;this.observedBits=null==t?eh:t},r.componentDidMount=function(){this.context[i]&&this.context[i].on(this.onUpdate);var e=this.props.observedBits;this.observedBits=null==e?eh:e},r.componentWillUnmount=function(){this.context[i]&&this.context[i].off(this.onUpdate)},r.getValue=function(){return this.context[i]?this.context[i].get():e},r.render=function(){return(e=this.props.children,Array.isArray(e)?e[0]:e)(this.state.value);var e},n}(V.Component);return o.contextTypes=((r={})[i]=hc.object,r),{Provider:s,Consumer:o}},rh=function(e){var t=nh();return t.displayName=e,t},ah=rh("Router-History"),ih=rh("Router"),sh=function(e){function t(t){var n;return(n=e.call(this,t)||this).state={location:t.history.location},n._isMounted=!1,n._pendingLocation=null,t.staticContext||(n.unlisten=t.history.listen((function(e){n._pendingLocation=e}))),n}uc(t,e),t.computeRootMatch=function(e){return{path:"/",url:"/",params:{},isExact:"/"===e}};var n=t.prototype;return n.componentDidMount=function(){var e=this;this._isMounted=!0,this.unlisten&&this.unlisten(),this.props.staticContext||(this.unlisten=this.props.history.listen((function(t){e._isMounted&&e.setState({location:t})}))),this._pendingLocation&&this.setState({location:this._pendingLocation})},n.componentWillUnmount=function(){this.unlisten&&(this.unlisten(),this._isMounted=!1,this._pendingLocation=null)},n.render=function(){return V.createElement(ih.Provider,{value:{history:this.props.history,location:this.state.location,match:t.computeRootMatch(this.state.location.pathname),staticContext:this.props.staticContext}},V.createElement(ah.Provider,{children:this.props.children||null,value:this.props.history}))},t}(V.Component);V.Component;var oh=function(e){function t(){return e.apply(this,arguments)||this}uc(t,e);var n=t.prototype;return n.componentDidMount=function(){this.props.onMount&&this.props.onMount.call(this,this)},n.componentDidUpdate=function(e){this.props.onUpdate&&this.props.onUpdate.call(this,this,e)},n.componentWillUnmount=function(){this.props.onUnmount&&this.props.onUnmount.call(this,this)},n.render=function(){return null},t}(V.Component),lh={},uh=1e4,dh=0;function ch(e,t){return void 0===e&&(e="/"),void 0===t&&(t={}),"/"===e?e:function(e){if(lh[e])return lh[e];var t=qc.compile(e);return dh<uh&&(lh[e]=t,dh++),t}(e)(t,{pretty:!0})}function ph(e){var t=e.computedMatch,n=e.to,r=e.push,a=void 0!==r&&r;return V.createElement(ih.Consumer,null,(function(e){e||wc(!1);var r=e.history,i=e.staticContext,s=a?r.push:r.replace,o=Cc(t?"string"==typeof n?ch(n,t.params):fc({},n,{pathname:ch(n.pathname,t.params)}):n);return i?(s(o),null):V.createElement(oh,{onMount:function(){s(o)},onUpdate:function(e,t){var n=Cc(t.to);Tc(n,fc({},o,{key:n.key}))||s(o)},to:n})}))}var hh={},fh=1e4,mh=0;function gh(e,t){void 0===t&&(t={}),("string"==typeof t||Array.isArray(t))&&(t={path:t});var n=t,r=n.path,a=n.exact,i=void 0!==a&&a,s=n.strict,o=void 0!==s&&s,l=n.sensitive,u=void 0!==l&&l;return[].concat(r).reduce((function(t,n){if(!n&&""!==n)return null;if(t)return t;var r=function(e,t){var n=""+t.end+t.strict+t.sensitive,r=hh[n]||(hh[n]={});if(r[e])return r[e];var a=[],i={regexp:qc(e,a,t),keys:a};return mh<fh&&(r[e]=i,mh++),i}(n,{end:i,strict:o,sensitive:u}),a=r.regexp,s=r.keys,l=a.exec(e);if(!l)return null;var d=l[0],c=l.slice(1),p=e===d;return i&&!p?null:{path:n,url:"/"===n&&""===d?"/":d,isExact:p,params:s.reduce((function(e,t,n){return e[t.name]=c[n],e}),{})}}),null)}var bh=function(e){function t(){return e.apply(this,arguments)||this}return uc(t,e),t.prototype.render=function(){var e=this;return V.createElement(ih.Consumer,null,(function(t){t||wc(!1);var n=e.props.location||t.location,r=fc({},t,{location:n,match:e.props.computedMatch?e.props.computedMatch:e.props.path?gh(n.pathname,e.props):t.match}),a=e.props,i=a.children,s=a.component,o=a.render;return Array.isArray(i)&&function(e){return 0===V.Children.count(e)}(i)&&(i=null),V.createElement(ih.Provider,{value:r},r.match?i?"function"==typeof i?i(r):i:s?V.createElement(s,r):o?o(r):null:"function"==typeof i?i(r):null)}))},t}(V.Component);V.Component,V.Component,V.useContext;const yh=function(e,t,n){return e()},vh=!0,xh=!0,wh=!0,kh=!1,Sh=!1;let Ih,Nh,Ch,Th=!1,Eh=!1,_h=!1,$h=!1,Ah=null,Rh=!1;const Dh=!0,Fh="http://www.w3.org/1999/xlink",Mh={},Oh=e=>"object"==(e=typeof e)||"function"===e,Ph=(e,t,...n)=>{let r=null,a=null,i=null,s=!1,o=!1;const l=[],u=t=>{for(let n=0;n<t.length;n++)r=t[n],Array.isArray(r)?u(r):null!=r&&"boolean"!=typeof r&&((s="function"!=typeof e&&!Oh(r))&&(r=String(r)),s&&o?l[l.length-1].$text$+=r:l.push(s?Lh(null,r):r),o=s)};if(u(n),t){t.key&&(a=t.key),t.name&&(i=t.name);{const e=t.className||t.class;e&&(t.class="object"!=typeof e?e:Object.keys(e).filter((t=>e[t])).join(" "))}}if("function"==typeof e)return e(null===t?{}:t,l,Bh);const d=Lh(e,null);return d.$attrs$=t,l.length>0&&(d.$children$=l),d.$key$=a,d.$name$=i,d},Lh=(e,t)=>{const n={$flags$:0,$tag$:e,$text$:t,$elm$:null,$children$:null,$attrs$:null,$key$:null,$name$:null};return n},zh={},Bh={forEach:(e,t)=>e.map(Wh).forEach(t),map:(e,t)=>e.map(Wh).map(t).map(Vh)},Wh=e=>({vattrs:e.$attrs$,vchildren:e.$children$,vkey:e.$key$,vname:e.$name$,vtag:e.$tag$,vtext:e.$text$}),Vh=e=>{if("function"==typeof e.vtag){const t=Object.assign({},e.vattrs);return e.vkey&&(t.key=e.vkey),e.vname&&(t.name=e.vname),Ph(e.vtag,t,...e.vchildren||[])}const t=Lh(e.vtag,e.vtext);return t.$attrs$=e.vattrs,t.$children$=e.vchildren,t.$key$=e.vkey,t.$name$=e.vname,t},Uh=(e,t,n)=>{const r=e;return{emit:e=>jh(r,t,{bubbles:!!(4&n),composed:!!(2&n),cancelable:!!(1&n),detail:e})}},jh=(e,t,n)=>{const r=Wf.ce(t,n);return e.dispatchEvent(r),r},Hh=new WeakMap,Gh=e=>{const t=e.$cmpMeta$,n=e.$hostElement$,r=t.$flags$,a=(t.$tagName$,()=>{}),i=((e,t,n,r)=>{var a;let i=qh(t,n);const s=Of.get(i);if(e=11===e.nodeType?e:zf,s)if("string"==typeof s){e=e.head||e;let t,n=Hh.get(e);if(n||Hh.set(e,n=new Set),!n.has(i)){{t=zf.createElement("style"),t.innerHTML=s;const n=null!==(a=Wf.$nonce$)&&void 0!==a?a:function(e){var t,n,r;return null!==(r=null===(n=null===(t=e.head)||void 0===t?void 0:t.querySelector('meta[name="csp-nonce"]'))||void 0===n?void 0:n.getAttribute("content"))&&void 0!==r?r:void 0}(zf);null!=n&&t.setAttribute("nonce",n),e.insertBefore(t,e.querySelector("link"))}n&&n.add(i)}}else e.adoptedStyleSheets.includes(s)||(e.adoptedStyleSheets=[...e.adoptedStyleSheets,s]);return i})(n.shadowRoot?n.shadowRoot:n.getRootNode(),t,e.$modeName$);10&r&&(n["s-sc"]=i,n.classList.add(i+"-h"),2&r&&n.classList.add(i+"-s")),a()},qh=(e,t)=>"sc-"+(t&&32&e.$flags$?e.$tagName$+"-"+t:e.$tagName$),Kh=(e,t,n,r,a,i)=>{if(n!==r){let s=Ff(e,t),o=t.toLowerCase();if("class"===t){const t=e.classList,a=Yh(n),i=Yh(r);t.remove(...a.filter((e=>e&&!i.includes(e)))),t.add(...i.filter((e=>e&&!a.includes(e))))}else if("style"===t){for(const t in n)r&&null!=r[t]||(t.includes("-")?e.style.removeProperty(t):e.style[t]="");for(const t in r)n&&r[t]===n[t]||(t.includes("-")?e.style.setProperty(t,r[t]):e.style[t]=r[t])}else if("key"===t);else if("ref"===t)r&&r(e);else if(e.__lookupSetter__(t)||"o"!==t[0]||"n"!==t[1]){const l=Oh(r);if((s||l&&null!==r)&&!a)try{if(e.tagName.includes("-"))e[t]=r;else{const a=null==r?"":r;"list"===t?s=!1:null!=n&&e[t]==a||(e[t]=a)}}catch(kp){}let u=!1;o!==(o=o.replace(/^xlink\:?/,""))&&(t=o,u=!0),null==r||!1===r?!1===r&&""!==e.getAttribute(t)||(u?e.removeAttributeNS(Fh,t):e.removeAttribute(t)):(!s||4&i||a)&&!l&&(r=!0===r?"":r,u?e.setAttributeNS(Fh,t,r):e.setAttribute(t,r))}else t="-"===t[2]?t.slice(3):Ff(Lf,o)?o.slice(2):o[2]+t.slice(3),n&&Wf.rel(e,t,n,!1),r&&Wf.ael(e,t,r,!1)}},Xh=/\s/,Yh=e=>e?e.split(Xh):[],Jh=(e,t,n,r)=>{const a=11===t.$elm$.nodeType&&t.$elm$.host?t.$elm$.host:t.$elm$,i=e&&e.$attrs$||Mh,s=t.$attrs$||Mh;for(r in i)r in s||Kh(a,r,i[r],void 0,n,t.$flags$);for(r in s)Kh(a,r,i[r],s[r],n,t.$flags$)},Zh=(e,t,n,r)=>{const a=t.$children$[n];let i,s,o,l=0;if(Th||(_h=!0,"slot"===a.$tag$&&(Ih&&r.classList.add(Ih+"-s"),a.$flags$|=a.$children$?2:1)),null!==a.$text$)i=a.$elm$=zf.createTextNode(a.$text$);else if(1&a.$flags$)i=a.$elm$=zf.createTextNode("");else{if($h||($h="svg"===a.$tag$),i=a.$elm$=zf.createElementNS($h?"http://www.w3.org/2000/svg":"http://www.w3.org/1999/xhtml",2&a.$flags$?"slot-fb":a.$tag$),$h&&"foreignObject"===a.$tag$&&($h=!1),Jh(null,a,$h),(e=>null!=e)(Ih)&&i["s-si"]!==Ih&&i.classList.add(i["s-si"]=Ih),a.$children$)for(l=0;l<a.$children$.length;++l)s=Zh(e,a,l,i),s&&i.appendChild(s);"svg"===a.$tag$?$h=!1:"foreignObject"===i.tagName&&($h=!0)}return i["s-hn"]=Ch,3&a.$flags$&&(i["s-sr"]=!0,i["s-cr"]=Nh,i["s-sn"]=a.$name$||"",o=e&&e.$children$&&e.$children$[n],o&&o.$tag$===a.$tag$&&e.$elm$&&Qh(e.$elm$,!1)),i},Qh=(e,t)=>{Wf.$flags$|=1;const n=e.childNodes;for(let r=n.length-1;r>=0;r--){const e=n[r];e["s-hn"]!==Ch&&e["s-ol"]&&(af(e).insertBefore(e,rf(e)),e["s-ol"].remove(),e["s-ol"]=void 0,_h=!0),t&&Qh(e,t)}Wf.$flags$&=-2},ef=(e,t,n,r,a,i)=>{let s,o=e["s-cr"]&&e["s-cr"].parentNode||e;for(o.shadowRoot&&o.tagName===Ch&&(o=o.shadowRoot);a<=i;++a)r[a]&&(s=Zh(null,n,a,e),s&&(r[a].$elm$=s,o.insertBefore(s,rf(t))))},tf=(e,t,n)=>{for(let r=t;r<=n;++r){const t=e[r];if(t){const e=t.$elm$;cf(t),e&&(Eh=!0,e["s-ol"]?e["s-ol"].remove():Qh(e,!0),e.remove())}}},nf=(e,t)=>e.$tag$===t.$tag$&&("slot"===e.$tag$?e.$name$===t.$name$:e.$key$===t.$key$),rf=e=>e&&e["s-ol"]||e,af=e=>(e["s-ol"]?e["s-ol"]:e).parentNode,sf=(e,t)=>{const n=t.$elm$=e.$elm$,r=e.$children$,a=t.$children$,i=t.$tag$,s=t.$text$;let o;null===s?($h="svg"===i||"foreignObject"!==i&&$h,"slot"===i||Jh(e,t,$h),null!==r&&null!==a?((e,t,n,r)=>{let a,i,s=0,o=0,l=0,u=0,d=t.length-1,c=t[0],p=t[d],h=r.length-1,f=r[0],m=r[h];for(;s<=d&&o<=h;)if(null==c)c=t[++s];else if(null==p)p=t[--d];else if(null==f)f=r[++o];else if(null==m)m=r[--h];else if(nf(c,f))sf(c,f),c=t[++s],f=r[++o];else if(nf(p,m))sf(p,m),p=t[--d],m=r[--h];else if(nf(c,m))"slot"!==c.$tag$&&"slot"!==m.$tag$||Qh(c.$elm$.parentNode,!1),sf(c,m),e.insertBefore(c.$elm$,p.$elm$.nextSibling),c=t[++s],m=r[--h];else if(nf(p,f))"slot"!==c.$tag$&&"slot"!==m.$tag$||Qh(p.$elm$.parentNode,!1),sf(p,f),e.insertBefore(p.$elm$,c.$elm$),p=t[--d],f=r[++o];else{for(l=-1,u=s;u<=d;++u)if(t[u]&&null!==t[u].$key$&&t[u].$key$===f.$key$){l=u;break}l>=0?(i=t[l],i.$tag$!==f.$tag$?a=Zh(t&&t[o],n,l,e):(sf(i,f),t[l]=void 0,a=i.$elm$),f=r[++o]):(a=Zh(t&&t[o],n,o,e),f=r[++o]),a&&af(c.$elm$).insertBefore(a,rf(c.$elm$))}s>d?ef(e,null==r[h+1]?null:r[h+1].$elm$,n,r,o,h):o>h&&tf(t,s,d)})(n,r,t,a):null!==a?(null!==e.$text$&&(n.textContent=""),ef(n,null,t,a,0,a.length-1)):null!==r&&tf(r,0,r.length-1),$h&&"svg"===i&&($h=!1)):(o=n["s-cr"])?o.parentNode.textContent=s:e.$text$!==s&&(n.data=s)},of=e=>{const t=e.childNodes;let n,r,a,i,s,o;for(r=0,a=t.length;r<a;r++)if(n=t[r],1===n.nodeType){if(n["s-sr"])for(s=n["s-sn"],n.hidden=!1,i=0;i<a;i++)if(o=t[i].nodeType,t[i]["s-hn"]!==n["s-hn"]||""!==s){if(1===o&&s===t[i].getAttribute("slot")){n.hidden=!0;break}}else if(1===o||3===o&&""!==t[i].textContent.trim()){n.hidden=!0;break}of(n)}},lf=[],uf=e=>{let t,n,r,a,i,s,o=0;const l=e.childNodes,u=l.length;for(;o<u;o++){if(t=l[o],t["s-sr"]&&(n=t["s-cr"])&&n.parentNode)for(r=n.parentNode.childNodes,a=t["s-sn"],s=r.length-1;s>=0;s--)n=r[s],n["s-cn"]||n["s-nr"]||n["s-hn"]===t["s-hn"]||(df(n,a)?(i=lf.find((e=>e.$nodeToRelocate$===n)),Eh=!0,n["s-sn"]=n["s-sn"]||a,i?i.$slotRefNode$=t:lf.push({$slotRefNode$:t,$nodeToRelocate$:n}),n["s-sr"]&&lf.map((e=>{df(e.$nodeToRelocate$,n["s-sn"])&&(i=lf.find((e=>e.$nodeToRelocate$===n)),i&&!e.$slotRefNode$&&(e.$slotRefNode$=i.$slotRefNode$))}))):lf.some((e=>e.$nodeToRelocate$===n))||lf.push({$nodeToRelocate$:n}));1===t.nodeType&&uf(t)}},df=(e,t)=>1===e.nodeType?null===e.getAttribute("slot")&&""===t||e.getAttribute("slot")===t:e["s-sn"]===t||""===t,cf=e=>{e.$attrs$&&e.$attrs$.ref&&e.$attrs$.ref(null),e.$children$&&e.$children$.map(cf)},pf=(e,t)=>{const n=e.$hostElement$,r=e.$cmpMeta$,a=e.$vnode$||Lh(null,null),i=(s=t)&&s.$tag$===zh?t:Ph(null,null,t);var s;if(Ch=n.tagName,r.$attrsToReflect$&&(i.$attrs$=i.$attrs$||{},r.$attrsToReflect$.map((([e,t])=>i.$attrs$[t]=n[e]))),i.$tag$=null,i.$flags$|=4,e.$vnode$=i,i.$elm$=a.$elm$=n.shadowRoot||n,Ih=n["s-sc"],Nh=n["s-cr"],Th=0!=(1&r.$flags$),Eh=!1,sf(a,i),Wf.$flags$|=1,_h){let e,t,n,r,a,s;uf(i.$elm$);let o=0;for(;o<lf.length;o++)e=lf[o],t=e.$nodeToRelocate$,t["s-ol"]||(n=zf.createTextNode(""),n["s-nr"]=t,t.parentNode.insertBefore(t["s-ol"]=n,t));for(o=0;o<lf.length;o++)if(e=lf[o],t=e.$nodeToRelocate$,e.$slotRefNode$){for(r=e.$slotRefNode$.parentNode,a=e.$slotRefNode$.nextSibling,n=t["s-ol"];n=n.previousSibling;)if(s=n["s-nr"],s&&s["s-sn"]===t["s-sn"]&&r===s.parentNode&&(s=s.nextSibling,!s||!s["s-nr"])){a=s;break}(!a&&r!==t.parentNode||t.nextSibling!==a)&&t!==a&&(!t["s-hn"]&&t["s-ol"]&&(t["s-hn"]=t["s-ol"].parentNode.nodeName),r.insertBefore(t,a))}else 1===t.nodeType&&(t.hidden=!0)}Eh&&of(i.$elm$),Wf.$flags$&=-2,lf.length=0},hf=(e,t)=>(e.$flags$|=16,e.$ancestorComponent$,Jf((()=>ff(e,t)))),ff=(e,t)=>{const n=e.$hostElement$,r=(e.$cmpMeta$.$tagName$,()=>{}),a=n;let i;return i=wf(a,t?"componentWillLoad":"componentWillUpdate"),i=mf(i,(()=>wf(a,"componentWillRender"))),r(),mf(i,(()=>bf(e,a,t)))},mf=(e,t)=>gf(e)?e.then(t):t(),gf=e=>e instanceof Promise||e&&e.then&&"function"==typeof e.then,bf=async(e,t,n)=>{const r=e.$hostElement$,a=(e.$cmpMeta$.$tagName$,()=>{});r["s-rc"],n&&Gh(e);const i=(e.$cmpMeta$.$tagName$,()=>{});yf(e,t,r),i(),a(),vf(e)},yf=(e,t,n)=>{try{Ah=t,t=t.render&&t.render(),e.$flags$&=-17,e.$flags$|=2,(vh||xh)&&(wh||xh)&&(kh||pf(e,t))}catch(kp){Mf(kp,e.$hostElement$)}return Ah=null,null},vf=e=>{e.$cmpMeta$.$tagName$;const t=()=>{},n=e.$hostElement$;e.$ancestorComponent$,wf(n,"componentDidRender"),64&e.$flags$?(wf(n,"componentDidUpdate"),t()):(e.$flags$|=64,wf(n,"componentDidLoad"),t())},xf=e=>{{const t=Rf(e),n=t.$hostElement$.isConnected;return n&&2==(18&t.$flags$)&&hf(t,!1),n}},wf=(e,t,n)=>{if(e&&e[t])try{return e[t](n)}catch(kp){Mf(kp)}},kf=(e,t,n,r)=>{const a=Rf(e),i=e,s=a.$instanceValues$.get(t),o=a.$flags$,l=i;var u,d;u=n,d=r.$members$[t][0],n=null==u||Oh(u)?u:4&d?"false"!==u&&(""===u||!!u):2&d?parseFloat(u):1&d?String(u):u;const c=Number.isNaN(s)&&Number.isNaN(n);if(n!==s&&!c){if(a.$instanceValues$.set(t,n),r.$watchers$&&128&o){const e=r.$watchers$[t];e&&e.map((e=>{try{l[e](n,s,t)}catch(kp){Mf(kp,i)}}))}if(2==(18&o)){if(l.componentShouldUpdate&&!1===l.componentShouldUpdate(n,s,t))return;hf(a,!1)}}},Sf=(e,t,n)=>{if(t.$members$){e.watchers&&(t.$watchers$=e.watchers);const n=Object.entries(t.$members$),r=e.prototype;n.map((([e,[n]])=>{(31&n||32&n)&&Object.defineProperty(r,e,{get(){return t=e,Rf(this).$instanceValues$.get(t);var t},set(n){kf(this,e,n,t)},configurable:!0,enumerable:!0})}));{const a=new Map;r.attributeChangedCallback=function(e,t,n){Wf.jmp((()=>{const t=a.get(e);if(this.hasOwnProperty(t))n=this[t],delete this[t];else if(r.hasOwnProperty(t)&&"number"==typeof this[t]&&this[t]==n)return;this[t]=(null!==n||"boolean"!=typeof this[t])&&n}))},e.observedAttributes=n.filter((([e,t])=>15&t[0])).map((([e,n])=>{const r=n[1]||e;return a.set(r,e),512&n[0]&&t.$attrsToReflect$.push([e,r]),r}))}}return e},If=async(e,t,n,r,a)=>{if(0==(32&t.$flags$)&&(t.$flags$|=32,a=e.constructor,customElements.whenDefined(n.$tagName$).then((()=>t.$flags$|=128)),a.style)){let r=a.style;"string"!=typeof r&&(r=r[t.$modeName$=(e=>Pf.map((t=>t(e))).find((e=>!!e)))(e)]);const i=qh(n,t.$modeName$);if(!Of.has(i)){const e=(n.$tagName$,()=>{});((e,t,n)=>{let r=Of.get(e);Uf&&n?(r=r||new CSSStyleSheet,"string"==typeof r?r=t:r.replaceSync(t)):r=t,Of.set(e,r)})(i,r,!!(1&n.$flags$)),e()}}t.$ancestorComponent$,hf(t,!0)},Nf=e=>{const t=e["s-cr"]=zf.createComment("");t["s-cn"]=!0,e.insertBefore(t,e.firstChild)},Cf=(e,t)=>{const n={$flags$:t[0],$tagName$:t[1]};n.$members$=t[2],n.$listeners$=t[3],n.$watchers$=e.$watchers$,n.$attrsToReflect$=[];const r=e.prototype.connectedCallback,a=e.prototype.disconnectedCallback;return Object.assign(e.prototype,{__registerHost(){Df(this,n)},connectedCallback(){(e=>{if(0==(1&Wf.$flags$)){const t=Rf(e),n=t.$cmpMeta$,r=(n.$tagName$,()=>{});1&t.$flags$?(Tf(e,t,n.$listeners$),t.$lazyInstance$):(t.$flags$|=1,12&n.$flags$&&Nf(e),n.$members$&&Object.entries(n.$members$).map((([t,[n]])=>{if(31&n&&e.hasOwnProperty(t)){const n=e[t];delete e[t],e[t]=n}})),If(e,t,n)),r()}})(this),r&&r.call(this)},disconnectedCallback(){(e=>{if(0==(1&Wf.$flags$)){const t=Rf(e);t.$rmListeners$&&(t.$rmListeners$.map((e=>e())),t.$rmListeners$=void 0)}})(this),a&&a.call(this)},__attachShadow(){this.attachShadow({mode:"open",delegatesFocus:!!(16&n.$flags$)})}}),e.is=n.$tagName$,Sf(e,n)},Tf=(e,t,n,r)=>{n&&n.map((([n,r,a])=>{const i=_f(e,n),s=Ef(t,a),o=$f(n);Wf.ael(i,r,s,o),(t.$rmListeners$=t.$rmListeners$||[]).push((()=>Wf.rel(i,r,s,o)))}))},Ef=(e,t)=>n=>{try{Sh||e.$hostElement$[t](n)}catch(kp){Mf(kp)}},_f=(e,t)=>4&t?zf:8&t?Lf:16&t?zf.body:e,$f=e=>Vf?{passive:0!=(1&e),capture:0!=(2&e)}:0!=(2&e),Af=new WeakMap,Rf=e=>Af.get(e),Df=(e,t)=>{const n={$flags$:0,$hostElement$:e,$cmpMeta$:t,$instanceValues$:new Map};return Tf(e,n,t.$listeners$),Af.set(e,n)},Ff=(e,t)=>t in e,Mf=(e,t)=>(0,console.error)(e,t),Of=new Map,Pf=[],Lf="undefined"!=typeof window?window:{},zf=Lf.document||{head:{}},Bf=Lf.HTMLElement||class{},Wf={$flags$:0,$resourcesUrl$:"",jmp:e=>e(),raf:e=>requestAnimationFrame(e),ael:(e,t,n,r)=>e.addEventListener(t,n,r),rel:(e,t,n,r)=>e.removeEventListener(t,n,r),ce:(e,t)=>new CustomEvent(e,t)},Vf=(()=>{let e=!1;try{zf.addEventListener("e",null,Object.defineProperty({},"passive",{get(){e=!0}}))}catch(kp){}return e})(),Uf=(()=>{try{return new CSSStyleSheet,"function"==typeof(new CSSStyleSheet).replaceSync}catch(kp){}return!1})(),jf=[],Hf=[],Gf=(e,t)=>n=>{e.push(n),Rh||(Rh=!0,t&&4&Wf.$flags$?Xf(Kf):Wf.raf(Kf))},qf=e=>{for(let t=0;t<e.length;t++)try{e[t](performance.now())}catch(kp){Mf(kp)}e.length=0},Kf=()=>{qf(jf),qf(Hf),(Rh=jf.length>0)&&Wf.raf(Kf)},Xf=e=>(e=>Promise.resolve(e))().then(e),Yf=e("r",Gf(jf,!1)),Jf=e("w",Gf(Hf,!0)),Zf="undefined"!=typeof window?window:void 0,Qf="undefined"!=typeof document?document:void 0,em=e("b",((e,t)=>{e.componentOnReady?e.componentOnReady().then((e=>t(e))):lm((()=>t(e)))})),tm=e=>void 0!==e.componentOnReady,nm=(e,t=[])=>{const n={};return t.forEach((t=>{e.hasAttribute(t)&&(null!==e.getAttribute(t)&&(n[t]=e.getAttribute(t)),e.removeAttribute(t))})),n},rm=["role","aria-activedescendant","aria-atomic","aria-autocomplete","aria-braillelabel","aria-brailleroledescription","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colindextext","aria-colspan","aria-controls","aria-current","aria-describedby","aria-description","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowindextext","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext"],am=(e,t)=>{let n=rm;return t&&t.length>0&&(n=n.filter((e=>!t.includes(e)))),nm(e,n)},im=e("d",((e,t,n,r)=>{var a;if("undefined"!=typeof window){const i=window,s=null===(a=null==i?void 0:i.Ionic)||void 0===a?void 0:a.config;if(s){const a=s.get("_ael");if(a)return a(e,t,n,r);if(s._ael)return s._ael(e,t,n,r)}}return e.addEventListener(t,n,r)})),sm=e("e",((e,t,n,r)=>{var a;if("undefined"!=typeof window){const i=window,s=null===(a=null==i?void 0:i.Ionic)||void 0===a?void 0:a.config;if(s){const a=s.get("_rel");if(a)return a(e,t,n,r);if(s._rel)return s._rel(e,t,n,r)}}return e.removeEventListener(t,n,r)})),om=(e,t=e)=>e.shadowRoot||t,lm=e("h",(e=>"function"==typeof __zone_symbol__requestAnimationFrame?__zone_symbol__requestAnimationFrame(e):"function"==typeof requestAnimationFrame?requestAnimationFrame(e):setTimeout(e))),um=e("a",((e,t,n)=>Math.max(e,Math.min(t,n)))),dm=(e,t)=>{if(!e){const e="ASSERT: "+t;throw console.error(e),new Error(e)}},cm=(e("n",(e=>e.timeStamp||Date.now())),e("p",(e=>{if(e){const t=e.changedTouches;if(t&&t.length>0){const e=t[0];return{x:e.clientX,y:e.clientY}}if(void 0!==e.pageX)return{x:e.pageX,y:e.pageY}}return{x:0,y:0}})),(e,t)=>{if(null!=e||(e={}),null!=t||(t={}),e===t)return!0;const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n){if(!(r in t))return!1;if(e[r]!==t[r])return!1}return!0});
/*!
             * (C) Ionic http://ionicframework.com - MIT License
             */
let pm;const hm=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),fm=e=>{if(void 0===pm){const t=void 0!==e.style.animationName,n=void 0!==e.style.webkitAnimationName;pm=!t&&n?"-webkit-":""}return pm},mm=(e,t,n)=>{const r=t.startsWith("animation")?fm(e):"";e.style.setProperty(r+t,n)},gm=(e,t)=>{const n=t.startsWith("animation")?fm(e):"";e.style.removeProperty(n+t)},bm=[],ym=(e=[],t)=>{if(void 0!==t){const n=Array.isArray(t)?t:[t];return[...e,...n]}return e},vm=e("l",(e=>{let t,n,r,a,i,s,o,l,u,d,c,p,h,f=[],m=[],g=[],b=!1,y={},v=[],x=[],w={},k=0,S=!1,I=!1,N=!0,C=!1,T=!0,E=!1;const _=e,$=[],A=[],R=[],D=[],F=[],M=[],O=[],P=[],L=[],z=[],B="function"==typeof AnimationEffect||void 0!==Zf&&"function"==typeof Zf.AnimationEffect,W="function"==typeof Element&&"function"==typeof Element.prototype.animate&&B,V=()=>z,U=e=>{G(),e&&q()},j=(e,t)=>(((null==t?void 0:t.oneTimeCallback)?A:$).push({c:e,o:t}),h),H=()=>($.length=0,A.length=0,h),G=()=>{if(W)z.forEach((e=>{e.cancel()})),z.length=0;else{const e=R.slice();lm((()=>{e.forEach((e=>{gm(e,"animation-name"),gm(e,"animation-duration"),gm(e,"animation-timing-function"),gm(e,"animation-iteration-count"),gm(e,"animation-delay"),gm(e,"animation-play-state"),gm(e,"animation-fill-mode"),gm(e,"animation-direction")}))}))}},q=()=>{F.forEach((e=>{(null==e?void 0:e.parentNode)&&e.parentNode.removeChild(e)})),F.length=0},K=()=>void 0!==i?i:o?o.getFill():"both",X=()=>void 0!==u?u:void 0!==s?s:o?o.getDirection():"normal",Y=()=>S?"linear":void 0!==r?r:o?o.getEasing():"linear",J=()=>I?0:void 0!==d?d:void 0!==n?n:o?o.getDuration():0,Z=()=>void 0!==a?a:o?o.getIterations():1,Q=()=>void 0!==c?c:void 0!==t?t:o?o.getDelay():0,ee=e=>{W?V().forEach((t=>{if(t.effect.setKeyframes)t.effect.setKeyframes(e);else{const n=new KeyframeEffect(t.effect.target,e,t.effect.getTiming());t.effect=n}})):ne()},te=()=>{0!==k&&(k--,0===k&&((()=>{de(),P.forEach((e=>e())),L.forEach((e=>e()));const e=N?1:0,t=v,n=x,r=w;R.forEach((e=>{const a=e.classList;t.forEach((e=>a.add(e))),n.forEach((e=>a.remove(e)));for(const t in r)r.hasOwnProperty(t)&&mm(e,t,r[t])})),$.forEach((t=>t.c(e,h))),A.forEach((t=>t.c(e,h))),A.length=0,T=!0,N&&(C=!0),N=!0})(),o&&o.animationFinish()))},ne=(t=!0)=>{q();const n=(e=>(e.forEach((e=>{for(const t in e)if(e.hasOwnProperty(t)){const n=e[t];if("easing"===t)e["animation-timing-function"]=n,delete e[t];else{const r=hm(t);r!==t&&(e[r]=n,delete e[t])}}})),e))(f);R.forEach((r=>{if(n.length>0){const a=((e=[])=>e.map((e=>{const t=e.offset,n=[];for(const r in e)e.hasOwnProperty(r)&&"offset"!==r&&n.push(`${r}: ${e[r]};`);return`${100*t}% { ${n.join(" ")} }`})).join(" "))(n);p=void 0!==e?e:(e=>{let t=bm.indexOf(e);return t<0&&(t=bm.push(e)-1),`ion-animation-${t}`})(a);const i=((e,t,n)=>{var r;const a=(e=>{const t=void 0!==e.getRootNode?e.getRootNode():e;return t.head||t})(n),i=fm(n),s=a.querySelector("#"+e);if(s)return s;const o=(null!==(r=n.ownerDocument)&&void 0!==r?r:document).createElement("style");return o.id=e,o.textContent=`@${i}keyframes ${e} { ${t} } @${i}keyframes ${e}-alt { ${t} }`,a.appendChild(o),o})(p,a,r);F.push(i),mm(r,"animation-duration",`${J()}ms`),mm(r,"animation-timing-function",Y()),mm(r,"animation-delay",`${Q()}ms`),mm(r,"animation-fill-mode",K()),mm(r,"animation-direction",X());const s=Z()===1/0?"infinite":Z().toString();mm(r,"animation-iteration-count",s),mm(r,"animation-play-state","paused"),t&&mm(r,"animation-name",`${i.id}-alt`),lm((()=>{mm(r,"animation-name",i.id||null)}))}}))},re=(e=!0)=>{(()=>{M.forEach((e=>e())),O.forEach((e=>e()));const e=m,t=g,n=y;R.forEach((r=>{const a=r.classList;e.forEach((e=>a.add(e))),t.forEach((e=>a.remove(e)));for(const e in n)n.hasOwnProperty(e)&&mm(r,e,n[e])}))})(),f.length>0&&(W?(R.forEach((e=>{const t=e.animate(f,{id:_,delay:Q(),duration:J(),easing:Y(),iterations:Z(),fill:K(),direction:X()});t.pause(),z.push(t)})),z.length>0&&(z[0].onfinish=()=>{te()})):ne(e)),b=!0},ae=e=>{if(e=Math.min(Math.max(e,0),.9999),W)z.forEach((t=>{t.currentTime=t.effect.getComputedTiming().delay+J()*e,t.pause()}));else{const t=`-${J()*e}ms`;R.forEach((e=>{f.length>0&&(mm(e,"animation-delay",t),mm(e,"animation-play-state","paused"))}))}},ie=e=>{z.forEach((e=>{e.effect.updateTiming({delay:Q(),duration:J(),easing:Y(),iterations:Z(),fill:K(),direction:X()})})),void 0!==e&&ae(e)},se=(e=!0,t)=>{lm((()=>{R.forEach((n=>{mm(n,"animation-name",p||null),mm(n,"animation-duration",`${J()}ms`),mm(n,"animation-timing-function",Y()),mm(n,"animation-delay",void 0!==t?`-${t*J()}ms`:`${Q()}ms`),mm(n,"animation-fill-mode",K()||null),mm(n,"animation-direction",X()||null);const r=Z()===1/0?"infinite":Z().toString();mm(n,"animation-iteration-count",r),e&&mm(n,"animation-name",`${p}-alt`),lm((()=>{mm(n,"animation-name",p||null)}))}))}))},oe=(e=!1,t=!0,n)=>(e&&D.forEach((r=>{r.update(e,t,n)})),W?ie(n):se(t,n),h),le=()=>{b&&(W?z.forEach((e=>{e.pause()})):R.forEach((e=>{mm(e,"animation-play-state","paused")})),E=!0)},ue=()=>{l=void 0,te()},de=()=>{l&&clearTimeout(l)},ce=()=>{R.forEach((e=>{gm(e,"animation-duration"),gm(e,"animation-delay"),gm(e,"animation-play-state")}))},pe=e=>new Promise((t=>{(null==e?void 0:e.sync)&&(I=!0,j((()=>I=!1),{oneTimeCallback:!0})),b||re(),C&&(W?(ae(0),ie()):se(),C=!1),T&&(k=D.length+1,T=!1),j((()=>t()),{oneTimeCallback:!0}),D.forEach((e=>{e.play()})),W?(z.forEach((e=>{e.play()})),0!==f.length&&0!==R.length||te()):(()=>{if(de(),lm((()=>{R.forEach((e=>{f.length>0&&mm(e,"animation-play-state","running")}))})),0===f.length||0===R.length)te();else{const e=Q()||0,t=J()||0,n=Z()||1;isFinite(n)&&(l=setTimeout(ue,e+t*n+100)),((e,t)=>{let n;const r={passive:!0},a=()=>{n&&n()},i=n=>{e===n.target&&(a(),t(n))};e&&(e.addEventListener("webkitAnimationEnd",i,r),e.addEventListener("animationend",i,r),n=()=>{e.removeEventListener("webkitAnimationEnd",i,r),e.removeEventListener("animationend",i,r)})})(R[0],(()=>{de(),lm((()=>{ce(),lm(te)}))}))}})(),E=!1})),he=(e,t)=>{const n=f[0];return void 0===n||void 0!==n.offset&&0!==n.offset?f=[{offset:0,[e]:t},...f]:n[e]=t,h};return h={parentAnimation:o,elements:R,childAnimations:D,id:_,animationFinish:te,from:he,to:(e,t)=>{const n=f[f.length-1];return void 0===n||void 0!==n.offset&&1!==n.offset?f=[...f,{offset:1,[e]:t}]:n[e]=t,h},fromTo:(e,t,n)=>he(e,t).to(e,n),parent:e=>(o=e,h),play:pe,pause:()=>(D.forEach((e=>{e.pause()})),le(),h),stop:()=>{D.forEach((e=>{e.stop()})),b&&(G(),b=!1),S=!1,I=!1,T=!0,u=void 0,d=void 0,c=void 0,k=0,C=!1,N=!0,E=!1},destroy:e=>(D.forEach((t=>{t.destroy(e)})),U(e),R.length=0,D.length=0,f.length=0,H(),b=!1,T=!0,h),keyframes:e=>{const t=f!==e;return f=e,t&&ee(f),h},addAnimation:e=>{if(null!=e)if(Array.isArray(e))for(const t of e)t.parent(h),D.push(t);else e.parent(h),D.push(e);return h},addElement:e=>{if(null!=e)if(1===e.nodeType)R.push(e);else if(e.length>=0)for(let t=0;t<e.length;t++)R.push(e[t]);else console.error("Invalid addElement value");return h},update:oe,fill:e=>(i=e,oe(!0),h),direction:e=>(s=e,oe(!0),h),iterations:e=>(a=e,oe(!0),h),duration:e=>(W||0!==e||(e=1),n=e,oe(!0),h),easing:e=>(r=e,oe(!0),h),delay:e=>(t=e,oe(!0),h),getWebAnimations:V,getKeyframes:()=>f,getFill:K,getDirection:X,getDelay:Q,getIterations:Z,getEasing:Y,getDuration:J,afterAddRead:e=>(P.push(e),h),afterAddWrite:e=>(L.push(e),h),afterClearStyles:(e=[])=>{for(const t of e)w[t]="";return h},afterStyles:(e={})=>(w=e,h),afterRemoveClass:e=>(x=ym(x,e),h),afterAddClass:e=>(v=ym(v,e),h),beforeAddRead:e=>(M.push(e),h),beforeAddWrite:e=>(O.push(e),h),beforeClearStyles:(e=[])=>{for(const t of e)y[t]="";return h},beforeStyles:(e={})=>(y=e,h),beforeRemoveClass:e=>(g=ym(g,e),h),beforeAddClass:e=>(m=ym(m,e),h),onFinish:j,isRunning:()=>0!==k&&!E,progressStart:(e=!1,t)=>(D.forEach((n=>{n.progressStart(e,t)})),le(),S=e,b||re(),oe(!1,!0,t),h),progressStep:e=>(D.forEach((t=>{t.progressStep(e)})),ae(e),h),progressEnd:(e,t,n)=>(S=!1,D.forEach((r=>{r.progressEnd(e,t,n)})),void 0!==n&&(d=n),C=!1,N=!0,0===e?(u="reverse"===X()?"normal":"reverse","reverse"===u&&(N=!1),W?(oe(),ae(1-t)):(c=(1-t)*J()*-1,oe(!1,!1))):1===e&&(W?(oe(),ae(t)):(c=t*J()*-1,oe(!1,!1))),void 0!==e&&(j((()=>{d=void 0,u=void 0,c=void 0}),{oneTimeCallback:!0}),o||pe()),h)}})),xm="ionViewWillLeave",wm="ionViewDidLeave",km="ionViewWillUnload",Sm=e=>new Promise(((t,n)=>{Jf((()=>{Im(e),Nm(e).then((n=>{n.animation&&n.animation.destroy(),Cm(e),t(n)}),(t=>{Cm(e),n(t)}))}))})),Im=e=>{const t=e.enteringEl,n=e.leavingEl;Lm(t,n,e.direction),e.showGoBack?t.classList.add("can-go-back"):t.classList.remove("can-go-back"),Pm(t,!1),t.style.setProperty("pointer-events","none"),n&&(Pm(n,!1),n.style.setProperty("pointer-events","none"))},Nm=async e=>{const t=await Tm(e);return t&&Dh?Em(t,e):_m(e)},Cm=e=>{const t=e.enteringEl,n=e.leavingEl;t.classList.remove("ion-page-invisible"),t.style.removeProperty("pointer-events"),void 0!==n&&(n.classList.remove("ion-page-invisible"),n.style.removeProperty("pointer-events"))},Tm=async e=>{if(e.leavingEl&&e.animated&&0!==e.duration)return e.animationBuilder?e.animationBuilder:"ios"===e.mode?(await yh((()=>t.import("./ios.transition-legacy-e33a4611.js")))).iosTransitionAnimation:(await yh((()=>t.import("./md.transition-legacy-d6ce04f3.js")))).mdTransitionAnimation},Em=async(e,t)=>{await $m(t,!0);const n=e(t.baseEl,t);Dm(t.enteringEl,t.leavingEl);const r=await Rm(n,t);return t.progressCallback&&t.progressCallback(void 0),r&&Fm(t.enteringEl,t.leavingEl),{hasCompleted:r,animation:n}},_m=async e=>{const t=e.enteringEl,n=e.leavingEl;return await $m(e,!1),Dm(t,n),Fm(t,n),{hasCompleted:!0}},$m=async(e,t)=>{(void 0!==e.deepWait?e.deepWait:t)&&await Promise.all([Om(e.enteringEl),Om(e.leavingEl)]),await Am(e.viewIsReady,e.enteringEl)},Am=async(e,t)=>{e&&await e(t)},Rm=(e,t)=>{const n=t.progressCallback,r=new Promise((t=>{e.onFinish((e=>t(1===e)))}));return n?(e.progressStart(!0),n(e)):e.play(),r},Dm=(e,t)=>{Mm(t,xm),Mm(e,"ionViewWillEnter")},Fm=(e,t)=>{Mm(e,"ionViewDidEnter"),Mm(t,wm)},Mm=(e,t)=>{if(e){const n=new CustomEvent(t,{bubbles:!1,cancelable:!1});e.dispatchEvent(n)}},Om=async e=>{const t=e;if(t){if(null!=t.componentOnReady){if(null!=await t.componentOnReady())return}else if(null!=t.__registerHost){const e=new Promise((e=>lm(e)));return void(await e)}await Promise.all(Array.from(t.children).map(Om))}},Pm=(e,t)=>{t?(e.setAttribute("aria-hidden","true"),e.classList.add("ion-page-hidden")):(e.hidden=!1,e.removeAttribute("aria-hidden"),e.classList.remove("ion-page-hidden"))},Lm=(e,t,n)=>{void 0!==e&&(e.style.zIndex="back"===n?"99":"101"),void 0!==t&&(t.style.zIndex="100")},zm=(e("m",(e=>{if(e.classList.contains("ion-page"))return e;const t=e.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs");return t||e})),(e,t,n,r,a)=>Wm(e[1],t[1],n[1],r[1],a).map((a=>Bm(e[0],t[0],n[0],r[0],a)))),Bm=(e,t,n,r,a)=>a*(3*t*Math.pow(a-1,2)+a*(-3*n*a+3*n+r*a))-e*Math.pow(a-1,3),Wm=(e,t,n,r,a)=>Vm((r-=a)-3*(n-=a)+3*(t-=a)-(e-=a),3*n-6*t+3*e,3*t-3*e,e).filter((e=>e>=0&&e<=1)),Vm=(e,t,n,r)=>{if(0===e)return((e,t,n)=>{const r=t*t-4*e*n;return r<0?[]:[(-t+Math.sqrt(r))/(2*e),(-t-Math.sqrt(r))/(2*e)]})(t,n,r);const a=(3*(n/=e)-(t/=e)*t)/3,i=(2*t*t*t-9*t*n+27*(r/=e))/27;if(0===a)return[Math.pow(-i,1/3)];if(0===i)return[Math.sqrt(-a),-Math.sqrt(-a)];const s=Math.pow(i/2,2)+Math.pow(a/3,3);if(0===s)return[Math.pow(i/2,.5)-t/3];if(s>0)return[Math.pow(-i/2+Math.sqrt(s),1/3)-Math.pow(i/2+Math.sqrt(s),1/3)-t/3];const o=Math.sqrt(Math.pow(-a/3,3)),l=Math.acos(-i/(2*Math.sqrt(Math.pow(-a/3,3)))),u=2*Math.pow(o,1/3);return[u*Math.cos(l/3)-t/3,u*Math.cos((l+2*Math.PI)/3)-t/3,u*Math.cos((l+4*Math.PI)/3)-t/3]};class Um{constructor(e,t,n,r,a){this.id=t,this.name=n,this.disableScroll=a,this.priority=1e6*r+t,this.ctrl=e}canStart(){return!!this.ctrl&&this.ctrl.canStart(this.name)}start(){return!!this.ctrl&&this.ctrl.start(this.name,this.id,this.priority)}capture(){if(!this.ctrl)return!1;const e=this.ctrl.capture(this.name,this.id,this.priority);return e&&this.disableScroll&&this.ctrl.disableScroll(this.id),e}release(){this.ctrl&&(this.ctrl.release(this.id),this.disableScroll&&this.ctrl.enableScroll(this.id))}destroy(){this.release(),this.ctrl=void 0}}class jm{constructor(e,t,n,r){this.id=t,this.disable=n,this.disableScroll=r,this.ctrl=e}block(){if(this.ctrl){if(this.disable)for(const e of this.disable)this.ctrl.disableGesture(e,this.id);this.disableScroll&&this.ctrl.disableScroll(this.id)}}unblock(){if(this.ctrl){if(this.disable)for(const e of this.disable)this.ctrl.enableGesture(e,this.id);this.disableScroll&&this.ctrl.enableScroll(this.id)}}destroy(){this.unblock(),this.ctrl=void 0}}const Hm="backdrop-no-scroll",Gm=new
/*!
             * (C) Ionic http://ionicframework.com - MIT License
             */
class{constructor(){this.gestureId=0,this.requestedStart=new Map,this.disabledGestures=new Map,this.disabledScroll=new Set}createGesture(e){var t;return new Um(this,this.newID(),e.name,null!==(t=e.priority)&&void 0!==t?t:0,!!e.disableScroll)}createBlocker(e={}){return new jm(this,this.newID(),e.disable,!!e.disableScroll)}start(e,t,n){return this.canStart(e)?(this.requestedStart.set(t,n),!0):(this.requestedStart.delete(t),!1)}capture(e,t,n){if(!this.start(e,t,n))return!1;const r=this.requestedStart;let a=-1e4;if(r.forEach((e=>{a=Math.max(a,e)})),a===n){this.capturedId=t,r.clear();const n=new CustomEvent("ionGestureCaptured",{detail:{gestureName:e}});return document.dispatchEvent(n),!0}return r.delete(t),!1}release(e){this.requestedStart.delete(e),this.capturedId===e&&(this.capturedId=void 0)}disableGesture(e,t){let n=this.disabledGestures.get(e);void 0===n&&(n=new Set,this.disabledGestures.set(e,n)),n.add(t)}enableGesture(e,t){const n=this.disabledGestures.get(e);void 0!==n&&n.delete(t)}disableScroll(e){this.disabledScroll.add(e),1===this.disabledScroll.size&&document.body.classList.add(Hm)}enableScroll(e){this.disabledScroll.delete(e),0===this.disabledScroll.size&&document.body.classList.remove(Hm)}canStart(e){return void 0===this.capturedId&&!this.isDisabled(e)}isCaptured(){return void 0!==this.capturedId}isScrollDisabled(){return this.disabledScroll.size>0}isDisabled(e){const t=this.disabledGestures.get(e);return!!(t&&t.size>0)}newID(){return this.gestureId++,this.gestureId}},qm=(e,t,n,r)=>{const a=Km(e)?{capture:!!r.capture,passive:!!r.passive}:!!r.capture;let i,s;return e.__zone_symbol__addEventListener?(i="__zone_symbol__addEventListener",s="__zone_symbol__removeEventListener"):(i="addEventListener",s="removeEventListener"),e[i](t,n,a),()=>{e[s](t,n,a)}},Km=e=>{if(void 0===Xm)try{const t=Object.defineProperty({},"passive",{get:()=>{Xm=!0}});e.addEventListener("optsTest",(()=>{}),t)}catch(kp){Xm=!1}return!!Xm};let Xm;const Ym=e=>e instanceof Document?e:e.ownerDocument,Jm=e("c",(e=>{let t=!1,n=!1,r=!0,a=!1;const i=Object.assign({disableScroll:!1,direction:"x",gesturePriority:0,passive:!0,maxAngle:40,threshold:10},e),s=i.canStart,o=i.onWillStart,l=i.onStart,u=i.onEnd,d=i.notCaptured,c=i.onMove,p=i.threshold,h=i.passive,f=i.blurOnStart,m={type:"pan",startX:0,startY:0,startTime:0,currentX:0,currentY:0,velocityX:0,velocityY:0,deltaX:0,deltaY:0,currentTime:0,event:void 0,data:void 0},g=((e,t,n)=>{const r=n*(Math.PI/180),a="x"===e,i=Math.cos(r),s=t*t;let o=0,l=0,u=!1,d=0;return{start(e,t){o=e,l=t,d=0,u=!0},detect(e,t){if(!u)return!1;const n=e-o,r=t-l,c=n*n+r*r;if(c<s)return!1;const p=Math.sqrt(c),h=(a?n:r)/p;return d=h>i?1:h<-i?-1:0,u=!1,!0},isGesture:()=>0!==d,getDirection:()=>d}})(i.direction,i.threshold,i.maxAngle),b=Gm.createGesture({name:e.gestureName,priority:e.gesturePriority,disableScroll:e.disableScroll}),y=()=>{t&&(a=!1,c&&c(m))},v=()=>!!b.capture()&&(t=!0,r=!1,m.startX=m.currentX,m.startY=m.currentY,m.startTime=m.currentTime,o?o(m).then(x):x(),!0),x=()=>{f&&(()=>{if("undefined"!=typeof document){const e=document.activeElement;(null==e?void 0:e.blur)&&e.blur()}})(),l&&l(m),r=!0},w=()=>{t=!1,n=!1,a=!1,r=!0,b.release()},k=e=>{const n=t,a=r;w(),a&&(Zm(m,e),n?u&&u(m):d&&d(m))},S=((e,t,n,r,a)=>{let i,s,o,l,u,d,c,p=0;const h=r=>{p=Date.now()+2e3,t(r)&&(!s&&n&&(s=qm(e,"touchmove",n,a)),o||(o=qm(r.target,"touchend",m,a)),l||(l=qm(r.target,"touchcancel",m,a)))},f=r=>{p>Date.now()||t(r)&&(!d&&n&&(d=qm(Ym(e),"mousemove",n,a)),c||(c=qm(Ym(e),"mouseup",g,a)))},m=e=>{b(),r&&r(e)},g=e=>{y(),r&&r(e)},b=()=>{s&&s(),o&&o(),l&&l(),s=o=l=void 0},y=()=>{d&&d(),c&&c(),d=c=void 0},v=()=>{b(),y()},x=(t=!0)=>{t?(i||(i=qm(e,"touchstart",h,a)),u||(u=qm(e,"mousedown",f,a))):(i&&i(),u&&u(),i=u=void 0,v())};return{enable:x,stop:v,destroy:()=>{x(!1),r=n=t=void 0}}})(i.el,(e=>{const t=eg(e);return!(n||!r)&&(Qm(e,m),m.startX=m.currentX,m.startY=m.currentY,m.startTime=m.currentTime=t,m.velocityX=m.velocityY=m.deltaX=m.deltaY=0,m.event=e,(!s||!1!==s(m))&&(b.release(),!!b.start()&&(n=!0,0===p?v():(g.start(m.startX,m.startY),!0))))}),(e=>{t?!a&&r&&(a=!0,Zm(m,e),requestAnimationFrame(y)):(Zm(m,e),g.detect(m.currentX,m.currentY)&&(g.isGesture()&&v()||I()))}),k,{capture:!1,passive:h}),I=()=>{w(),S.stop(),d&&d(m)};return{enable(e=!0){e||(t&&k(void 0),w()),S.enable(e)},destroy(){b.destroy(),S.destroy()}}})),Zm=(e,t)=>{if(!t)return;const n=e.currentX,r=e.currentY,a=e.currentTime;Qm(t,e);const i=e.currentX,s=e.currentY,o=(e.currentTime=eg(t))-a;if(o>0&&o<100){const t=(i-n)/o,a=(s-r)/o;e.velocityX=.7*t+.3*e.velocityX,e.velocityY=.7*a+.3*e.velocityY}e.deltaX=i-e.startX,e.deltaY=s-e.startY,e.event=t},Qm=(e,t)=>{let n=0,r=0;if(e){const t=e.changedTouches;if(t&&t.length>0){const e=t[0];n=e.clientX,r=e.clientY}else void 0!==e.pageX&&(n=e.pageX,r=e.pageY)}t.currentX=n,t.currentY=r},eg=e=>e.timeStamp||Date.now(),tg=Object.freeze(Object.defineProperty({__proto__:null,GESTURE_CONTROLLER:Gm,createGesture:Jm},Symbol.toStringTag,{value:"Module"}));
/*!
             * (C) Ionic http://ionicframework.com - MIT License
             */
class ng{constructor(){this.m=new Map}reset(e){this.m=new Map(Object.entries(e))}get(e,t){const n=this.m.get(e);return void 0!==n?n:t}getBoolean(e,t=!1){const n=this.m.get(e);return void 0===n?t:"string"==typeof n?"true"===n:!!n}getNumber(e,t){const n=parseFloat(this.m.get(e));return isNaN(n)?void 0!==t?t:NaN:n}set(e,t){this.m.set(e,t)}}const rg=new ng,ag=(e,t)=>e.substr(0,t.length)===t,ig="ionic:",sg="ionic-persist-config",og=(e,t)=>("string"==typeof e&&(t=e,e=void 0),(e=>lg(e))(e).includes(t)),lg=(e=window)=>{if(void 0===e)return[];e.Ionic=e.Ionic||{};let t=e.Ionic.platforms;return null==t&&(t=e.Ionic.platforms=ug(e),t.forEach((t=>e.document.documentElement.classList.add(`plt-${t}`)))),t},ug=e=>{const t=rg.get("platform");return Object.keys(yg).filter((n=>{const r=null==t?void 0:t[n];return"function"==typeof r?r(e):yg[n](e)}))},dg=e=>!!gg(e,/iPad/i)||!(!gg(e,/Macintosh/i)||!pg(e)),cg=e=>gg(e,/android|sink/i),pg=e=>bg(e,"(any-pointer:coarse)"),hg=e=>fg(e)||mg(e),fg=e=>!!(e.cordova||e.phonegap||e.PhoneGap),mg=e=>{const t=e.Capacitor;return!!(null==t?void 0:t.isNative)},gg=(e,t)=>t.test(e.navigator.userAgent),bg=(e,t)=>{var n;return null===(n=e.matchMedia)||void 0===n?void 0:n.call(e,t).matches},yg={ipad:dg,iphone:e=>gg(e,/iPhone/i),ios:e=>gg(e,/iPhone|iPod/i)||dg(e),android:cg,phablet:e=>{const t=e.innerWidth,n=e.innerHeight,r=Math.min(t,n),a=Math.max(t,n);return r>390&&r<520&&a>620&&a<800},tablet:e=>{const t=e.innerWidth,n=e.innerHeight,r=Math.min(t,n),a=Math.max(t,n);return dg(e)||(e=>cg(e)&&!gg(e,/mobile/i))(e)||r>460&&r<820&&a>780&&a<1400},cordova:fg,capacitor:mg,electron:e=>gg(e,/electron/i),pwa:e=>{var t;return!(!(null===(t=e.matchMedia)||void 0===t?void 0:t.call(e,"(display-mode: standalone)").matches)&&!e.navigator.standalone)},mobile:pg,mobileweb:e=>pg(e)&&!hg(e),desktop:e=>!pg(e),hybrid:hg};let vg;const xg=e=>e&&(e=>Rf(e).$modeName$)(e)||vg,wg=(e={})=>{if("undefined"==typeof window)return;const t=window.document,n=window,r=n.Ionic=n.Ionic||{},a={};var i;e._ael&&(a.ael=e._ael),e._rel&&(a.rel=e._rel),e._ce&&(a.ce=e._ce),i=a,Object.assign(Wf,i);const s=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},(e=>{try{const t=e.sessionStorage.getItem(sg);return null!==t?JSON.parse(t):{}}catch(kp){return{}}})(n)),{persistConfig:!1}),r.config),(e=>{const t={};return e.location.search.slice(1).split("&").map((e=>e.split("="))).map((([e,t])=>[decodeURIComponent(e),decodeURIComponent(t)])).filter((([e])=>ag(e,ig))).map((([e,t])=>[e.slice(ig.length),t])).forEach((([e,n])=>{t[e]=n})),t})(n)),e);rg.reset(s),rg.getBoolean("persistConfig")&&((e,t)=>{try{e.sessionStorage.setItem(sg,JSON.stringify(t))}catch(kp){return}})(n,s),lg(n),r.config=rg,r.mode=vg=rg.get("mode",t.documentElement.getAttribute("mode")||(og(n,"ios")?"ios":"md")),rg.set("mode",vg),t.documentElement.setAttribute("mode",vg),t.documentElement.classList.add(vg),rg.getBoolean("_testing")&&rg.set("animated",!1);const o=e=>{var t;return null===(t=e.tagName)||void 0===t?void 0:t.startsWith("ION-")},l=e=>["ios","md"].includes(e);var u;u=e=>{for(;e;){const t=e.mode||e.getAttribute("mode");if(t){if(l(t))return t;o(e)&&console.warn('Invalid ionic mode: "'+t+'", expected: "ios" or "md"')}e=e.parentElement}return vg},Pf.push(u)},kg=Object.freeze(Object.defineProperty({__proto__:null,MENU_BACK_BUTTON_PRIORITY:99,OVERLAY_BACK_BUTTON_PRIORITY:100,blockHardwareBackButton:()=>{document.addEventListener("backbutton",(()=>{}))},startHardwareBackButton:()=>{const e=document;let t=!1;e.addEventListener("backbutton",(()=>{if(t)return;let n=0,r=[];const a=new CustomEvent("ionBackButton",{bubbles:!1,detail:{register(e,t){r.push({priority:e,handler:t,id:n++})}}});e.dispatchEvent(a);const i=()=>{if(r.length>0){let e={priority:Number.MIN_SAFE_INTEGER,handler:()=>{},id:-1};r.forEach((t=>{t.priority>=e.priority&&(e=t)})),t=!0,r=r.filter((t=>t.id!==e.id)),(async e=>{try{if(null==e?void 0:e.handler){const t=e.handler(i);null!=t&&await t}}catch(kp){console.error(kp)}})(e).then((()=>t=!1))}};i()}))}},Symbol.toStringTag,{value:"Module"})),Sg=async(e,t,n,r,a,i)=>{var s;if(e)return e.attachViewToDom(t,n,a,r);if(!(i||"string"==typeof n||n instanceof HTMLElement))throw new Error("framework delegate is missing");const o="string"==typeof n?null===(s=t.ownerDocument)||void 0===s?void 0:s.createElement(n):n;return r&&r.forEach((e=>o.classList.add(e))),a&&Object.assign(o,a),t.appendChild(o),await new Promise((e=>em(o,e))),o},Ig=(e,t)=>{if(t){if(e){const n=t.parentElement;return e.removeViewFromDom(n,t)}t.remove()}return Promise.resolve()},Ng=(e,...t)=>console.warn(`[Ionic Warning]: ${e}`,...t);
/*!
             * (C) Ionic http://ionicframework.com - MIT License
             */
let Cg=0,Tg=0;const Eg=new WeakMap,_g='[tabindex]:not([tabindex^="-"]):not([hidden]):not([disabled]), input:not([type=hidden]):not([tabindex^="-"]):not([hidden]):not([disabled]), textarea:not([tabindex^="-"]):not([hidden]):not([disabled]), button:not([tabindex^="-"]):not([hidden]):not([disabled]), select:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable[disabled="false"]:not([tabindex^="-"]):not([hidden])',$g=(e,t)=>{let n=e.querySelector(_g);const r=null==n?void 0:n.shadowRoot;r&&(n=r.querySelector(_g)||n),n?(e=>{if(e.focus(),e.classList.contains("ion-focusable")){const t=e.closest("ion-app");t&&t.setFocus([e])}})(n):t.focus()},Ag=(e,t)=>{const n=Array.from(e.querySelectorAll(_g));let r=n.length>0?n[n.length-1]:null;const a=null==r?void 0:r.shadowRoot;a&&(r=a.querySelector(_g)||r),r?r.focus():t.focus()},Rg=(e,t)=>{const n=Fg(t,"ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker,ion-popover"),r=e.target;n&&r&&(n.classList.contains("ion-disable-focus-trap")||(n.shadowRoot?(()=>{if(n.contains(r))n.lastFocus=r;else{const e=n.lastFocus;$g(n,n),e===t.activeElement&&Ag(n,n),n.lastFocus=t.activeElement}})():(()=>{if(n===r)n.lastFocus=void 0;else{const e=om(n);if(!e.contains(r))return;const a=e.querySelector(".ion-overlay-wrapper");if(!a)return;if(a.contains(r)||r===e.querySelector("ion-backdrop"))n.lastFocus=r;else{const e=n.lastFocus;$g(a,n),e===t.activeElement&&Ag(a,n),n.lastFocus=t.activeElement}}})()))},Dg=e=>{0===Cg&&(Cg=1,e.addEventListener("focus",(t=>{Rg(t,e)}),!0),e.addEventListener("ionBackButton",(t=>{const n=Fg(e);(null==n?void 0:n.backdropDismiss)&&t.detail.register(100,(()=>n.dismiss(void 0,Wg)))})),e.addEventListener("keydown",(t=>{if("Escape"===t.key){const t=Fg(e);(null==t?void 0:t.backdropDismiss)&&t.dismiss(void 0,Wg)}})))},Fg=(e,t,n)=>{const r=((e,t)=>(void 0===t&&(t="ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker,ion-popover,ion-toast"),Array.from(e.querySelectorAll(t)).filter((e=>e.overlayIndex>0))))(e,t).filter((e=>!e.classList.contains("overlay-hidden")));return void 0===n?r[r.length-1]:r.find((e=>e.id===n))},Mg=(e=!1)=>{const t=Pg(document).querySelector("ion-router-outlet, ion-nav, #ion-view-container-root");t&&(e?t.setAttribute("aria-hidden","true"):t.removeAttribute("aria-hidden"))},Og=async e=>{let t=document.activeElement;if(!t)return;const n=null==t?void 0:t.shadowRoot;n&&(t=n.querySelector(_g)||t),await e.onDidDismiss(),t.focus()},Pg=e=>e.querySelector("ion-app")||e.body,Lg=async(e,t,n,r)=>{n.classList.remove("overlay-hidden");const a=t(e.el,r);e.animated&&rg.getBoolean("animated",!0)||a.duration(0),e.keyboardClose&&a.beforeAddWrite((()=>{const e=n.ownerDocument.activeElement;(null==e?void 0:e.matches("input,ion-input, ion-textarea"))&&e.blur()}));const i=Eg.get(e)||[];return Eg.set(e,[...i,a]),await a.play(),!0},zg=(e,t)=>{let n;const r=new Promise((e=>n=e));return Bg(e,t,(e=>{n(e.detail)})),r},Bg=(e,t,n)=>{const r=a=>{sm(e,t,r),n(a)};im(e,t,r)},Wg="backdrop",Vg="gesture";function Ug(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}"function"==typeof SuppressedError&&SuppressedError;
/*!
             * (C) Ionic http://ionicframework.com - MIT License
             */
const jg=Cf(class extends Bf{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.ionBackdropTap=Uh(this,"ionBackdropTap",7),this.blocker=Gm.createBlocker({disableScroll:!0}),this.visible=!0,this.tappable=!0,this.stopPropagation=!0}connectedCallback(){this.stopPropagation&&this.blocker.block()}disconnectedCallback(){this.blocker.unblock()}onMouseDown(e){this.emitTap(e)}emitTap(e){this.stopPropagation&&(e.preventDefault(),e.stopPropagation()),this.tappable&&this.ionBackdropTap.emit()}render(){const e=xg(this);return Ph(zh,{tabindex:"-1","aria-hidden":"true",class:{[e]:!0,"backdrop-hide":!this.visible,"backdrop-no-tappable":!this.tappable}})}static get style(){return{ios:":host{left:0;right:0;top:0;bottom:0;display:block;position:absolute;-webkit-transform:translateZ(0);transform:translateZ(0);contain:strict;cursor:pointer;opacity:0.01;-ms-touch-action:none;touch-action:none;z-index:2}:host(.backdrop-hide){background:transparent}:host(.backdrop-no-tappable){cursor:auto}:host{background-color:var(--ion-backdrop-color, #000)}",md:":host{left:0;right:0;top:0;bottom:0;display:block;position:absolute;-webkit-transform:translateZ(0);transform:translateZ(0);contain:strict;cursor:pointer;opacity:0.01;-ms-touch-action:none;touch-action:none;z-index:2}:host(.backdrop-hide){background:transparent}:host(.backdrop-no-tappable){cursor:auto}:host{background-color:var(--ion-backdrop-color, #000)}"}}},[33,"ion-backdrop",{visible:[4],tappable:[4],stopPropagation:[4,"stop-propagation"]},[[2,"click","onMouseDown"]]]),Hg=(e,t)=>null!==t.closest(e),Gg=(e,t)=>"string"==typeof e&&e.length>0?Object.assign({"ion-color":!0,[`ion-color-${e}`]:!0},t):t,qg=e=>{const t={};return(e=>void 0!==e?(Array.isArray(e)?e:e.split(" ")).filter((e=>null!=e)).map((e=>e.trim())).filter((e=>""!==e)):[])(e).forEach((e=>t[e]=!0)),t},Kg=/^[a-z][a-z0-9+\-.]*:/,Xg=Cf(class extends Bf{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.type="bounded"}async addRipple(e,t){return new Promise((n=>{Yf((()=>{const r=this.el.getBoundingClientRect(),a=r.width,i=r.height,s=Math.sqrt(a*a+i*i),o=Math.max(i,a),l=this.unbounded?o:s+Jg,u=Math.floor(o*Zg),d=l/u;let c=e-r.left,p=t-r.top;this.unbounded&&(c=.5*a,p=.5*i);const h=c-.5*u,f=p-.5*u,m=.5*a-c,g=.5*i-p;Jf((()=>{const e=document.createElement("div");e.classList.add("ripple-effect");const t=e.style;t.top=f+"px",t.left=h+"px",t.width=t.height=u+"px",t.setProperty("--final-scale",`${d}`),t.setProperty("--translate-end",`${m}px, ${g}px`),(this.el.shadowRoot||this.el).appendChild(e),setTimeout((()=>{n((()=>{Yg(e)}))}),325)}))}))}))}get unbounded(){return"unbounded"===this.type}render(){const e=xg(this);return Ph(zh,{role:"presentation",class:{[e]:!0,unbounded:this.unbounded}})}get el(){return this}static get style(){return":host{left:0;right:0;top:0;bottom:0;position:absolute;contain:strict;pointer-events:none}:host(.unbounded){contain:layout size style}.ripple-effect{border-radius:50%;position:absolute;background-color:currentColor;color:inherit;contain:strict;opacity:0;-webkit-animation:225ms rippleAnimation forwards, 75ms fadeInAnimation forwards;animation:225ms rippleAnimation forwards, 75ms fadeInAnimation forwards;will-change:transform, opacity;pointer-events:none}.fade-out{-webkit-transform:translate(var(--translate-end)) scale(var(--final-scale, 1));transform:translate(var(--translate-end)) scale(var(--final-scale, 1));-webkit-animation:150ms fadeOutAnimation forwards;animation:150ms fadeOutAnimation forwards}@-webkit-keyframes rippleAnimation{from{-webkit-animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);-webkit-transform:scale(1);transform:scale(1)}to{-webkit-transform:translate(var(--translate-end)) scale(var(--final-scale, 1));transform:translate(var(--translate-end)) scale(var(--final-scale, 1))}}@keyframes rippleAnimation{from{-webkit-animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);-webkit-transform:scale(1);transform:scale(1)}to{-webkit-transform:translate(var(--translate-end)) scale(var(--final-scale, 1));transform:translate(var(--translate-end)) scale(var(--final-scale, 1))}}@-webkit-keyframes fadeInAnimation{from{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0}to{opacity:0.16}}@keyframes fadeInAnimation{from{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0}to{opacity:0.16}}@-webkit-keyframes fadeOutAnimation{from{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0.16}to{opacity:0}}@keyframes fadeOutAnimation{from{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0.16}to{opacity:0}}"}},[1,"ion-ripple-effect",{type:[1],addRipple:[64]}]),Yg=e=>{e.classList.add("fade-out"),setTimeout((()=>{e.remove()}),200)},Jg=10,Zg=.5;function Qg(){"undefined"!=typeof customElements&&["ion-ripple-effect"].forEach((e=>{"ion-ripple-effect"===e&&(customElements.get(e)||customElements.define(e,Xg))}))}
/*!
             * (C) Ionic http://ionicframework.com - MIT License
             */const eb={xs:"(min-width: 0px)",sm:"(min-width: 576px)",md:"(min-width: 768px)",lg:"(min-width: 992px)",xl:"(min-width: 1200px)"},tb=e=>{if(void 0===e||""===e)return!0;if(window.matchMedia){const t=eb[e];return window.matchMedia(t).matches}return!1},nb="undefined"!=typeof window?window:void 0,rb=nb&&!!(nb.CSS&&nb.CSS.supports&&nb.CSS.supports("--a: 0")),ab=["","xs","sm","md","lg","xl"],ib=Cf(class extends Bf{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.offset=void 0,this.offsetXs=void 0,this.offsetSm=void 0,this.offsetMd=void 0,this.offsetLg=void 0,this.offsetXl=void 0,this.pull=void 0,this.pullXs=void 0,this.pullSm=void 0,this.pullMd=void 0,this.pullLg=void 0,this.pullXl=void 0,this.push=void 0,this.pushXs=void 0,this.pushSm=void 0,this.pushMd=void 0,this.pushLg=void 0,this.pushXl=void 0,this.size=void 0,this.sizeXs=void 0,this.sizeSm=void 0,this.sizeMd=void 0,this.sizeLg=void 0,this.sizeXl=void 0}onResize(){xf(this)}getColumns(e){let t;for(const n of ab){const r=tb(n),a=this[e+n.charAt(0).toUpperCase()+n.slice(1)];r&&void 0!==a&&(t=a)}return t}calculateSize(){const e=this.getColumns("size");if(!e||""===e)return;const t="auto"===e?"auto":rb?`calc(calc(${e} / var(--ion-grid-columns, 12)) * 100%)`:e/12*100+"%";return{flex:`0 0 ${t}`,width:`${t}`,"max-width":`${t}`}}calculatePosition(e,t){const n=this.getColumns(e);if(n)return{[t]:rb?`calc(calc(${n} / var(--ion-grid-columns, 12)) * 100%)`:n>0&&n<12?n/12*100+"%":"auto"}}calculateOffset(e){return this.calculatePosition("offset",e?"margin-right":"margin-left")}calculatePull(e){return this.calculatePosition("pull",e?"left":"right")}calculatePush(e){return this.calculatePosition("push",e?"right":"left")}render(){const e="rtl"===document.dir,t=xg(this);return Ph(zh,{class:{[t]:!0},style:Object.assign(Object.assign(Object.assign(Object.assign({},this.calculateOffset(e)),this.calculatePull(e)),this.calculatePush(e)),this.calculateSize())},Ph("slot",null))}static get style(){return":host{-webkit-padding-start:var(--ion-grid-column-padding-xs, var(--ion-grid-column-padding, 5px));padding-inline-start:var(--ion-grid-column-padding-xs, var(--ion-grid-column-padding, 5px));-webkit-padding-end:var(--ion-grid-column-padding-xs, var(--ion-grid-column-padding, 5px));padding-inline-end:var(--ion-grid-column-padding-xs, var(--ion-grid-column-padding, 5px));padding-top:var(--ion-grid-column-padding-xs, var(--ion-grid-column-padding, 5px));padding-bottom:var(--ion-grid-column-padding-xs, var(--ion-grid-column-padding, 5px));margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-box-sizing:border-box;box-sizing:border-box;position:relative;-ms-flex-preferred-size:0;flex-basis:0;-ms-flex-positive:1;flex-grow:1;width:100%;max-width:100%;min-height:1px}@media (min-width: 576px){:host{-webkit-padding-start:var(--ion-grid-column-padding-sm, var(--ion-grid-column-padding, 5px));padding-inline-start:var(--ion-grid-column-padding-sm, var(--ion-grid-column-padding, 5px));-webkit-padding-end:var(--ion-grid-column-padding-sm, var(--ion-grid-column-padding, 5px));padding-inline-end:var(--ion-grid-column-padding-sm, var(--ion-grid-column-padding, 5px));padding-top:var(--ion-grid-column-padding-sm, var(--ion-grid-column-padding, 5px));padding-bottom:var(--ion-grid-column-padding-sm, var(--ion-grid-column-padding, 5px))}}@media (min-width: 768px){:host{-webkit-padding-start:var(--ion-grid-column-padding-md, var(--ion-grid-column-padding, 5px));padding-inline-start:var(--ion-grid-column-padding-md, var(--ion-grid-column-padding, 5px));-webkit-padding-end:var(--ion-grid-column-padding-md, var(--ion-grid-column-padding, 5px));padding-inline-end:var(--ion-grid-column-padding-md, var(--ion-grid-column-padding, 5px));padding-top:var(--ion-grid-column-padding-md, var(--ion-grid-column-padding, 5px));padding-bottom:var(--ion-grid-column-padding-md, var(--ion-grid-column-padding, 5px))}}@media (min-width: 992px){:host{-webkit-padding-start:var(--ion-grid-column-padding-lg, var(--ion-grid-column-padding, 5px));padding-inline-start:var(--ion-grid-column-padding-lg, var(--ion-grid-column-padding, 5px));-webkit-padding-end:var(--ion-grid-column-padding-lg, var(--ion-grid-column-padding, 5px));padding-inline-end:var(--ion-grid-column-padding-lg, var(--ion-grid-column-padding, 5px));padding-top:var(--ion-grid-column-padding-lg, var(--ion-grid-column-padding, 5px));padding-bottom:var(--ion-grid-column-padding-lg, var(--ion-grid-column-padding, 5px))}}@media (min-width: 1200px){:host{-webkit-padding-start:var(--ion-grid-column-padding-xl, var(--ion-grid-column-padding, 5px));padding-inline-start:var(--ion-grid-column-padding-xl, var(--ion-grid-column-padding, 5px));-webkit-padding-end:var(--ion-grid-column-padding-xl, var(--ion-grid-column-padding, 5px));padding-inline-end:var(--ion-grid-column-padding-xl, var(--ion-grid-column-padding, 5px));padding-top:var(--ion-grid-column-padding-xl, var(--ion-grid-column-padding, 5px));padding-bottom:var(--ion-grid-column-padding-xl, var(--ion-grid-column-padding, 5px))}}"}},[1,"ion-col",{offset:[1],offsetXs:[1,"offset-xs"],offsetSm:[1,"offset-sm"],offsetMd:[1,"offset-md"],offsetLg:[1,"offset-lg"],offsetXl:[1,"offset-xl"],pull:[1],pullXs:[1,"pull-xs"],pullSm:[1,"pull-sm"],pullMd:[1,"pull-md"],pullLg:[1,"pull-lg"],pullXl:[1,"pull-xl"],push:[1],pushXs:[1,"push-xs"],pushSm:[1,"push-sm"],pushMd:[1,"push-md"],pushLg:[1,"push-lg"],pushXl:[1,"push-xl"],size:[1],sizeXs:[1,"size-xs"],sizeSm:[1,"size-sm"],sizeMd:[1,"size-md"],sizeLg:[1,"size-lg"],sizeXl:[1,"size-xl"]},[[9,"resize","onResize"]]]),sb=function(){"undefined"!=typeof customElements&&["ion-col"].forEach((e=>{"ion-col"===e&&(customElements.get(e)||customElements.define(e,ib))}))},ob=e("i",(e=>e&&""!==e.dir?"rtl"===e.dir.toLowerCase():"rtl"===(null===document||void 0===document?void 0:document.dir.toLowerCase()))),lb=Cf(class extends Bf{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.ionScrollStart=Uh(this,"ionScrollStart",7),this.ionScroll=Uh(this,"ionScroll",7),this.ionScrollEnd=Uh(this,"ionScrollEnd",7),this.watchDog=null,this.isScrolling=!1,this.lastScroll=0,this.queued=!1,this.cTop=-1,this.cBottom=-1,this.isMainContent=!0,this.resizeTimeout=null,this.detail={scrollTop:0,scrollLeft:0,type:"scroll",event:void 0,startX:0,startY:0,startTime:0,currentX:0,currentY:0,velocityX:0,velocityY:0,deltaX:0,deltaY:0,currentTime:0,data:void 0,isScrolling:!0},this.color=void 0,this.fullscreen=!1,this.forceOverscroll=void 0,this.scrollX=!1,this.scrollY=!0,this.scrollEvents=!1}connectedCallback(){this.isMainContent=null===this.el.closest("ion-menu, ion-popover, ion-modal")}disconnectedCallback(){this.onScrollEnd()}onAppLoad(){this.resize()}onResize(){this.resizeTimeout&&(clearTimeout(this.resizeTimeout),this.resizeTimeout=null),this.resizeTimeout=setTimeout((()=>{null!==this.el.offsetParent&&this.resize()}),100)}shouldForceOverscroll(){const{forceOverscroll:e}=this,t=xg(this);return void 0===e?"ios"===t&&og("ios"):e}resize(){this.fullscreen?Yf((()=>this.readDimensions())):0===this.cTop&&0===this.cBottom||(this.cTop=this.cBottom=0,xf(this))}readDimensions(){const e=ub(this.el),t=Math.max(this.el.offsetTop,0),n=Math.max(e.offsetHeight-t-this.el.offsetHeight,0);(t!==this.cTop||n!==this.cBottom)&&(this.cTop=t,this.cBottom=n,xf(this))}onScroll(e){const t=Date.now(),n=!this.isScrolling;this.lastScroll=t,n&&this.onScrollStart(),!this.queued&&this.scrollEvents&&(this.queued=!0,Yf((t=>{this.queued=!1,this.detail.event=e,db(this.detail,this.scrollEl,t,n),this.ionScroll.emit(this.detail)})))}async getScrollElement(){return this.scrollEl||await new Promise((e=>em(this.el,e))),Promise.resolve(this.scrollEl)}async getBackgroundElement(){return this.backgroundContentEl||await new Promise((e=>em(this.el,e))),Promise.resolve(this.backgroundContentEl)}scrollToTop(e=0){return this.scrollToPoint(void 0,0,e)}async scrollToBottom(e=0){const t=await this.getScrollElement(),n=t.scrollHeight-t.clientHeight;return this.scrollToPoint(void 0,n,e)}async scrollByPoint(e,t,n){const r=await this.getScrollElement();return this.scrollToPoint(e+r.scrollLeft,t+r.scrollTop,n)}async scrollToPoint(e,t,n=0){const r=await this.getScrollElement();if(n<32)return null!=t&&(r.scrollTop=t),void(null!=e&&(r.scrollLeft=e));let a,i=0;const s=new Promise((e=>a=e)),o=r.scrollTop,l=r.scrollLeft,u=null!=t?t-o:0,d=null!=e?e-l:0,c=e=>{const t=Math.min(1,(e-i)/n)-1,s=Math.pow(t,3)+1;0!==u&&(r.scrollTop=Math.floor(s*u+o)),0!==d&&(r.scrollLeft=Math.floor(s*d+l)),s<1?requestAnimationFrame(c):a()};return requestAnimationFrame((e=>{i=e,c(e)})),s}onScrollStart(){this.isScrolling=!0,this.ionScrollStart.emit({isScrolling:!0}),this.watchDog&&clearInterval(this.watchDog),this.watchDog=setInterval((()=>{this.lastScroll<Date.now()-120&&this.onScrollEnd()}),100)}onScrollEnd(){this.watchDog&&clearInterval(this.watchDog),this.watchDog=null,this.isScrolling&&(this.isScrolling=!1,this.ionScrollEnd.emit({isScrolling:!1}))}render(){const{isMainContent:e,scrollX:t,scrollY:n,el:r}=this,a=ob(r)?"rtl":"ltr",i=xg(this),s=this.shouldForceOverscroll(),o="ios"===i,l=e?"main":"div";return this.resize(),Ph(zh,{class:Gg(this.color,{[i]:!0,"content-sizing":Hg("ion-popover",this.el),overscroll:s,[`content-${a}`]:!0}),style:{"--offset-top":`${this.cTop}px`,"--offset-bottom":`${this.cBottom}px`}},Ph("div",{ref:e=>this.backgroundContentEl=e,id:"background-content",part:"background"}),Ph(l,{class:{"inner-scroll":!0,"scroll-x":t,"scroll-y":n,overscroll:(t||n)&&s},ref:e=>this.scrollEl=e,onScroll:this.scrollEvents?e=>this.onScroll(e):void 0,part:"scroll"},Ph("slot",null)),o?Ph("div",{class:"transition-effect"},Ph("div",{class:"transition-cover"}),Ph("div",{class:"transition-shadow"})):null,Ph("slot",{name:"fixed"}))}get el(){return this}static get style(){return':host{--background:var(--ion-background-color, #fff);--color:var(--ion-text-color, #000);--padding-top:0px;--padding-bottom:0px;--padding-start:0px;--padding-end:0px;--keyboard-offset:0px;--offset-top:0px;--offset-bottom:0px;--overflow:auto;display:block;position:relative;-ms-flex:1;flex:1;width:100%;height:100%;margin:0 !important;padding:0 !important;font-family:var(--ion-font-family, inherit);contain:size style}:host(.ion-color) .inner-scroll{background:var(--ion-color-base);color:var(--ion-color-contrast)}:host(.outer-content){--background:var(--ion-color-step-50, #f2f2f2)}#background-content{left:0px;right:0px;top:calc(var(--offset-top) * -1);bottom:calc(var(--offset-bottom) * -1);position:absolute;background:var(--background)}.inner-scroll{left:0px;right:0px;top:calc(var(--offset-top) * -1);bottom:calc(var(--offset-bottom) * -1);-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:calc(var(--padding-top) + var(--offset-top));padding-bottom:calc(var(--padding-bottom) + var(--keyboard-offset) + var(--offset-bottom));position:absolute;color:var(--color);-webkit-box-sizing:border-box;box-sizing:border-box;overflow:hidden;-ms-touch-action:pan-x pan-y pinch-zoom;touch-action:pan-x pan-y pinch-zoom}.scroll-y,.scroll-x{-webkit-overflow-scrolling:touch;z-index:0;will-change:scroll-position}.scroll-y{overflow-y:var(--overflow);overscroll-behavior-y:contain}.scroll-x{overflow-x:var(--overflow);overscroll-behavior-x:contain}.overscroll::before,.overscroll::after{position:absolute;width:1px;height:1px;content:""}.overscroll::before{bottom:-1px}.overscroll::after{top:-1px}:host(.content-sizing){display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;min-height:0;contain:none}:host(.content-sizing) .inner-scroll{position:relative;top:0;bottom:0;margin-top:calc(var(--offset-top) * -1);margin-bottom:calc(var(--offset-bottom) * -1)}.transition-effect{display:none;position:absolute;width:100%;height:100vh;opacity:0;pointer-events:none}:host(.content-ltr) .transition-effect{left:-100%;}:host(.content-rtl) .transition-effect{right:-100%;}.transition-cover{position:absolute;right:0;width:100%;height:100%;background:black;opacity:0.1}.transition-shadow{display:block;position:absolute;width:100%;height:100%;-webkit-box-shadow:inset -9px 0 9px 0 rgba(0, 0, 100, 0.03);box-shadow:inset -9px 0 9px 0 rgba(0, 0, 100, 0.03)}:host(.content-ltr) .transition-shadow{right:0;}:host(.content-rtl) .transition-shadow{left:0;-webkit-transform:scaleX(-1);transform:scaleX(-1)}::slotted([slot=fixed]){position:absolute;-webkit-transform:translateZ(0);transform:translateZ(0)}'}},[1,"ion-content",{color:[513],fullscreen:[4],forceOverscroll:[1028,"force-overscroll"],scrollX:[4,"scroll-x"],scrollY:[4,"scroll-y"],scrollEvents:[4,"scroll-events"],getScrollElement:[64],getBackgroundElement:[64],scrollToTop:[64],scrollToBottom:[64],scrollByPoint:[64],scrollToPoint:[64]},[[8,"appload","onAppLoad"],[9,"resize","onResize"]]]),ub=e=>{const t=e.closest("ion-tabs");if(t)return t;const n=e.closest("ion-app, ion-page, .ion-page, page-inner, .popover-content");return n||(e=>{var t;return e.parentElement?e.parentElement:(null===(t=e.parentNode)||void 0===t?void 0:t.host)?e.parentNode.host:null})(e)},db=(e,t,n,r)=>{const a=e.currentX,i=e.currentY,s=e.currentTime,o=t.scrollLeft,l=t.scrollTop,u=n-s;if(r&&(e.startTime=n,e.startX=o,e.startY=l,e.velocityX=e.velocityY=0),e.currentTime=n,e.currentX=e.scrollLeft=o,e.currentY=e.scrollTop=l,e.deltaX=o-e.startX,e.deltaY=l-e.startY,u>0&&u<100){const t=(o-a)/u,n=(l-i)/u;e.velocityX=.7*t+.3*e.velocityX,e.velocityY=.7*n+.3*e.velocityY}},cb=function(){"undefined"!=typeof customElements&&["ion-content"].forEach((e=>{"ion-content"===e&&(customElements.get(e)||customElements.define(e,lb))}))},pb=Cf(class extends Bf{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.ionFocus=Uh(this,"ionFocus",7),this.ionBlur=Uh(this,"ionBlur",7),this.inItem=!1,this.inListHeader=!1,this.inToolbar=!1,this.inheritedAttributes={},this.handleClick=e=>{const{el:t}=this;if("button"===this.type)(async(e,t,n,r)=>{if(null!=e&&"#"!==e[0]&&!Kg.test(e)){const a=document.querySelector("ion-router");if(a)null!=t&&t.preventDefault(),a.push(e,n,r)}})(this.href,e,this.routerDirection,this.routerAnimation);else if((e=>!!e.shadowRoot&&!!e.attachShadow)(t)){let n=this.findForm();const{form:r}=this;if(!n&&void 0!==r)return void Ng("string"==typeof r?`Form with selector: "#${r}" could not be found. Verify that the id is correct and the form is rendered in the DOM.`:'The provided "form" element is invalid. Verify that the form is a HTMLFormElement and rendered in the DOM.',t);if(n||(n=t.closest("form")),n){e.preventDefault();const t=document.createElement("button");t.type=this.type,t.style.display="none",n.appendChild(t),t.click(),t.remove()}}},this.onFocus=()=>{this.ionFocus.emit()},this.onBlur=()=>{this.ionBlur.emit()},this.color=void 0,this.buttonType="button",this.disabled=!1,this.expand=void 0,this.fill=void 0,this.routerDirection="forward",this.routerAnimation=void 0,this.download=void 0,this.href=void 0,this.rel=void 0,this.shape=void 0,this.size=void 0,this.strong=!1,this.target=void 0,this.type="button",this.form=void 0}componentWillLoad(){this.inToolbar=!!this.el.closest("ion-buttons"),this.inListHeader=!!this.el.closest("ion-list-header"),this.inItem=!!this.el.closest("ion-item")||!!this.el.closest("ion-item-divider"),this.inheritedAttributes=am(this.el)}get hasIconOnly(){return!!this.el.querySelector('[slot="icon-only"]')}get rippleType(){return(void 0===this.fill||"clear"===this.fill)&&this.hasIconOnly&&this.inToolbar?"unbounded":"bounded"}findForm(){const{form:e}=this;if(e instanceof HTMLFormElement)return e;if("string"==typeof e){const t=document.getElementById(e);if(t instanceof HTMLFormElement)return t}return null}render(){const e=xg(this),{buttonType:t,type:n,disabled:r,rel:a,target:i,size:s,href:o,color:l,expand:u,hasIconOnly:d,shape:c,strong:p,inheritedAttributes:h}=this,f=void 0===s&&this.inItem?"small":s,m=void 0===o?"button":"a",g="button"===m?{type:n}:{download:this.download,href:o,rel:a,target:i};let b=this.fill;return null==b&&(b=this.inToolbar||this.inListHeader?"clear":"solid"),Ph(zh,{onClick:this.handleClick,"aria-disabled":r?"true":null,class:Gg(l,{[e]:!0,[t]:!0,[`${t}-${u}`]:void 0!==u,[`${t}-${f}`]:void 0!==f,[`${t}-${c}`]:void 0!==c,[`${t}-${b}`]:!0,[`${t}-strong`]:p,"in-toolbar":Hg("ion-toolbar",this.el),"in-toolbar-color":Hg("ion-toolbar[color]",this.el),"in-buttons":Hg("ion-buttons",this.el),"button-has-icon-only":d,"button-disabled":r,"ion-activatable":!0,"ion-focusable":!0})},Ph(m,Object.assign({},g,{class:"button-native",part:"native",disabled:r,onFocus:this.onFocus,onBlur:this.onBlur},h),Ph("span",{class:"button-inner"},Ph("slot",{name:"icon-only"}),Ph("slot",{name:"start"}),Ph("slot",null),Ph("slot",{name:"end"})),"md"===e&&Ph("ion-ripple-effect",{type:this.rippleType})))}get el(){return this}static get style(){return{ios:':host{--overflow:hidden;--ripple-color:currentColor;--border-width:initial;--border-color:initial;--border-style:initial;--color-activated:var(--color);--color-focused:var(--color);--color-hover:var(--color);--box-shadow:none;display:inline-block;width:auto;color:var(--color);font-family:var(--ion-font-family, inherit);text-align:center;text-decoration:none;text-overflow:ellipsis;white-space:nowrap;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:top;vertical-align:-webkit-baseline-middle;-webkit-font-kerning:none;font-kerning:none}:host(.button-disabled){cursor:default;opacity:0.5;pointer-events:none}:host(.button-solid){--background:var(--ion-color-primary, #3880ff);--color:var(--ion-color-primary-contrast, #fff)}:host(.button-outline){--border-color:var(--ion-color-primary, #3880ff);--background:transparent;--color:var(--ion-color-primary, #3880ff)}:host(.button-clear){--border-width:0;--background:transparent;--color:var(--ion-color-primary, #3880ff)}:host(.button-block){display:block}:host(.button-block) .button-native{margin-left:0;margin-right:0;display:block;width:100%;clear:both;contain:content}:host(.button-block) .button-native::after{clear:both}:host(.button-full){display:block}:host(.button-full) .button-native{margin-left:0;margin-right:0;display:block;width:100%;contain:content}:host(.button-full:not(.button-round)) .button-native{border-radius:0;border-right-width:0;border-left-width:0}.button-native{border-radius:var(--border-radius);-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:block;position:relative;width:100%;height:100%;-webkit-transition:var(--transition);transition:var(--transition);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);outline:none;background:var(--background);line-height:1;-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);contain:layout style;cursor:pointer;opacity:var(--opacity);overflow:var(--overflow);z-index:0;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-appearance:none;-moz-appearance:none;appearance:none}.button-native::-moz-focus-inner{border:0}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%;z-index:1}::slotted(ion-icon){font-size:1.4em;pointer-events:none}::slotted(ion-icon[slot=start]){-webkit-margin-start:-0.3em;margin-inline-start:-0.3em;-webkit-margin-end:0.3em;margin-inline-end:0.3em;margin-top:0;margin-bottom:0}::slotted(ion-icon[slot=end]){-webkit-margin-start:0.3em;margin-inline-start:0.3em;-webkit-margin-end:-0.2em;margin-inline-end:-0.2em;margin-top:0;margin-bottom:0}::slotted(ion-icon[slot=icon-only]){font-size:1.8em}ion-ripple-effect{color:var(--ripple-color)}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}:host(.ion-focused){color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}@media (any-hover: hover){:host(:hover){color:var(--color-hover)}:host(:hover) .button-native::after{background:var(--background-hover);opacity:var(--background-hover-opacity)}}:host(.ion-activated){color:var(--color-activated)}:host(.ion-activated) .button-native::after{background:var(--background-activated);opacity:var(--background-activated-opacity)}:host(.button-solid.ion-color) .button-native{background:var(--ion-color-base);color:var(--ion-color-contrast)}:host(.button-outline.ion-color) .button-native{border-color:var(--ion-color-base);background:transparent;color:var(--ion-color-base)}:host(.button-clear.ion-color) .button-native{background:transparent;color:var(--ion-color-base)}:host(.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native{color:var(--ion-toolbar-color, var(--color))}:host(.button-outline.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native{border-color:var(--ion-toolbar-color, var(--color, var(--border-color)))}:host(.button-solid.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native{background:var(--ion-toolbar-color, var(--background));color:var(--ion-toolbar-background, var(--color))}:host(.button-outline.ion-activated.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native{background:var(--ion-toolbar-color, var(--color));color:var(--ion-toolbar-background, var(--background), var(--ion-color-primary-contrast, #fff))}:host{--border-radius:14px;--padding-top:0;--padding-bottom:0;--padding-start:1em;--padding-end:1em;--transition:background-color, opacity 100ms linear;-webkit-margin-start:2px;margin-inline-start:2px;-webkit-margin-end:2px;margin-inline-end:2px;margin-top:4px;margin-bottom:4px;height:3.1em;font-size:16px;font-weight:500;letter-spacing:0}:host(.in-buttons){font-size:17px;font-weight:400}:host(.button-solid){--background-activated:var(--ion-color-primary-shade, #3171e0);--background-focused:var(--ion-color-primary-shade, #3171e0);--background-hover:var(--ion-color-primary-tint, #4c8dff);--background-activated-opacity:1;--background-focused-opacity:1;--background-hover-opacity:1}:host(.button-outline){--border-radius:14px;--border-width:1px;--border-style:solid;--background-activated:var(--ion-color-primary, #3880ff);--background-focused:var(--ion-color-primary, #3880ff);--background-hover:transparent;--background-focused-opacity:.1;--color-activated:var(--ion-color-primary-contrast, #fff)}:host(.button-clear){--background-activated:transparent;--background-activated-opacity:0;--background-focused:var(--ion-color-primary, #3880ff);--background-hover:transparent;--background-focused-opacity:.1;font-size:17px;font-weight:normal}:host(.button-large){--border-radius:16px;--padding-top:0;--padding-start:1em;--padding-end:1em;--padding-bottom:0;height:3.1em;font-size:20px}:host(.button-small){--border-radius:6px;--padding-top:0;--padding-start:0.9em;--padding-end:0.9em;--padding-bottom:0;height:2.1em;font-size:13px}:host(.button-round){--border-radius:64px;--padding-top:0;--padding-start:26px;--padding-end:26px;--padding-bottom:0}:host(.button-strong){font-weight:600}:host(.button-outline.ion-focused.ion-color) .button-native,:host(.button-clear.ion-focused.ion-color) .button-native{color:var(--ion-color-base)}:host(.button-outline.ion-focused.ion-color) .button-native::after,:host(.button-clear.ion-focused.ion-color) .button-native::after{background:var(--ion-color-base)}:host(.button-solid.ion-color.ion-focused) .button-native::after{background:var(--ion-color-shade)}@media (any-hover: hover){:host(.button-clear:not(.ion-activated):hover),:host(.button-outline:not(.ion-activated):hover){opacity:0.6}:host(.button-clear.ion-color:hover) .button-native,:host(.button-outline.ion-color:hover) .button-native{color:var(--ion-color-base)}:host(.button-clear.ion-color:hover) .button-native::after,:host(.button-outline.ion-color:hover) .button-native::after{background:transparent}:host(.button-solid.ion-color:hover) .button-native::after{background:var(--ion-color-tint)}:host(:hover.button-solid.in-toolbar:not(.ion-color):not(.in-toolbar-color):not(.ion-activated)) .button-native::after{background:#fff;opacity:0.1}}:host(.button-clear.ion-activated){opacity:0.4}:host(.button-outline.ion-activated.ion-color) .button-native{color:var(--ion-color-contrast)}:host(.button-outline.ion-activated.ion-color) .button-native::after{background:var(--ion-color-base)}:host(.button-solid.ion-color.ion-activated) .button-native::after{background:var(--ion-color-shade)}',md:':host{--overflow:hidden;--ripple-color:currentColor;--border-width:initial;--border-color:initial;--border-style:initial;--color-activated:var(--color);--color-focused:var(--color);--color-hover:var(--color);--box-shadow:none;display:inline-block;width:auto;color:var(--color);font-family:var(--ion-font-family, inherit);text-align:center;text-decoration:none;text-overflow:ellipsis;white-space:nowrap;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:top;vertical-align:-webkit-baseline-middle;-webkit-font-kerning:none;font-kerning:none}:host(.button-disabled){cursor:default;opacity:0.5;pointer-events:none}:host(.button-solid){--background:var(--ion-color-primary, #3880ff);--color:var(--ion-color-primary-contrast, #fff)}:host(.button-outline){--border-color:var(--ion-color-primary, #3880ff);--background:transparent;--color:var(--ion-color-primary, #3880ff)}:host(.button-clear){--border-width:0;--background:transparent;--color:var(--ion-color-primary, #3880ff)}:host(.button-block){display:block}:host(.button-block) .button-native{margin-left:0;margin-right:0;display:block;width:100%;clear:both;contain:content}:host(.button-block) .button-native::after{clear:both}:host(.button-full){display:block}:host(.button-full) .button-native{margin-left:0;margin-right:0;display:block;width:100%;contain:content}:host(.button-full:not(.button-round)) .button-native{border-radius:0;border-right-width:0;border-left-width:0}.button-native{border-radius:var(--border-radius);-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:block;position:relative;width:100%;height:100%;-webkit-transition:var(--transition);transition:var(--transition);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);outline:none;background:var(--background);line-height:1;-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);contain:layout style;cursor:pointer;opacity:var(--opacity);overflow:var(--overflow);z-index:0;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-appearance:none;-moz-appearance:none;appearance:none}.button-native::-moz-focus-inner{border:0}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%;z-index:1}::slotted(ion-icon){font-size:1.4em;pointer-events:none}::slotted(ion-icon[slot=start]){-webkit-margin-start:-0.3em;margin-inline-start:-0.3em;-webkit-margin-end:0.3em;margin-inline-end:0.3em;margin-top:0;margin-bottom:0}::slotted(ion-icon[slot=end]){-webkit-margin-start:0.3em;margin-inline-start:0.3em;-webkit-margin-end:-0.2em;margin-inline-end:-0.2em;margin-top:0;margin-bottom:0}::slotted(ion-icon[slot=icon-only]){font-size:1.8em}ion-ripple-effect{color:var(--ripple-color)}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}:host(.ion-focused){color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}@media (any-hover: hover){:host(:hover){color:var(--color-hover)}:host(:hover) .button-native::after{background:var(--background-hover);opacity:var(--background-hover-opacity)}}:host(.ion-activated){color:var(--color-activated)}:host(.ion-activated) .button-native::after{background:var(--background-activated);opacity:var(--background-activated-opacity)}:host(.button-solid.ion-color) .button-native{background:var(--ion-color-base);color:var(--ion-color-contrast)}:host(.button-outline.ion-color) .button-native{border-color:var(--ion-color-base);background:transparent;color:var(--ion-color-base)}:host(.button-clear.ion-color) .button-native{background:transparent;color:var(--ion-color-base)}:host(.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native{color:var(--ion-toolbar-color, var(--color))}:host(.button-outline.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native{border-color:var(--ion-toolbar-color, var(--color, var(--border-color)))}:host(.button-solid.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native{background:var(--ion-toolbar-color, var(--background));color:var(--ion-toolbar-background, var(--color))}:host(.button-outline.ion-activated.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native{background:var(--ion-toolbar-color, var(--color));color:var(--ion-toolbar-background, var(--background), var(--ion-color-primary-contrast, #fff))}:host{--border-radius:4px;--padding-top:0;--padding-bottom:0;--padding-start:1.1em;--padding-end:1.1em;--transition:box-shadow 280ms cubic-bezier(.4, 0, .2, 1),\n                background-color 15ms linear,\n                color 15ms linear;-webkit-margin-start:2px;margin-inline-start:2px;-webkit-margin-end:2px;margin-inline-end:2px;margin-top:4px;margin-bottom:4px;height:36px;font-size:14px;font-weight:500;letter-spacing:0.06em;text-transform:uppercase}:host(.button-solid){--background-activated:transparent;--background-hover:var(--ion-color-primary-contrast, #fff);--background-focused:var(--ion-color-primary-contrast, #fff);--background-activated-opacity:0;--background-focused-opacity:.24;--background-hover-opacity:.08;--box-shadow:0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12)}:host(.button-solid.ion-activated){--box-shadow:0 5px 5px -3px rgba(0, 0, 0, 0.2), 0 8px 10px 1px rgba(0, 0, 0, 0.14), 0 3px 14px 2px rgba(0, 0, 0, 0.12)}:host(.button-outline){--border-width:2px;--border-style:solid;--box-shadow:none;--background-activated:transparent;--background-focused:var(--ion-color-primary, #3880ff);--background-hover:var(--ion-color-primary, #3880ff);--background-activated-opacity:0;--background-focused-opacity:.12;--background-hover-opacity:.04}:host(.button-outline.ion-activated.ion-color) .button-native{background:transparent}:host(.button-clear){--background-activated:transparent;--background-focused:var(--ion-color-primary, #3880ff);--background-hover:var(--ion-color-primary, #3880ff);--background-activated-opacity:0;--background-focused-opacity:.12;--background-hover-opacity:.04}:host(.button-round){--border-radius:64px;--padding-top:0;--padding-start:26px;--padding-end:26px;--padding-bottom:0}:host(.button-large){--padding-top:0;--padding-start:1em;--padding-end:1em;--padding-bottom:0;height:2.8em;font-size:20px}:host(.button-small){--padding-top:0;--padding-start:0.9em;--padding-end:0.9em;--padding-bottom:0;height:2.1em;font-size:13px}:host(.button-strong){font-weight:bold}::slotted(ion-icon[slot=icon-only]){padding-left:0;padding-right:0;padding-top:0;padding-bottom:0}:host(.button-solid.ion-color.ion-focused) .button-native::after{background:var(--ion-color-contrast)}:host(.button-clear.ion-color.ion-focused) .button-native::after,:host(.button-outline.ion-color.ion-focused) .button-native::after{background:var(--ion-color-base)}@media (any-hover: hover){:host(.button-solid.ion-color:hover) .button-native::after{background:var(--ion-color-contrast)}:host(.button-clear.ion-color:hover) .button-native::after,:host(.button-outline.ion-color:hover) .button-native::after{background:var(--ion-color-base)}}'}}},[33,"ion-button",{color:[513],buttonType:[1025,"button-type"],disabled:[516],expand:[513],fill:[1537],routerDirection:[1,"router-direction"],routerAnimation:[16],download:[1],href:[1],rel:[1],shape:[513],size:[513],strong:[4],target:[1],type:[1],form:[1]}]),hb=Cf(class extends Bf{constructor(){super(),this.__registerHost(),this.ionColor=Uh(this,"ionColor",7),this.ionStyle=Uh(this,"ionStyle",7),this.inRange=!1,this.color=void 0,this.position=void 0,this.noAnimate=!1}componentWillLoad(){this.inRange=!!this.el.closest("ion-range"),this.noAnimate="floating"===this.position,this.emitStyle(),this.emitColor()}componentDidLoad(){this.noAnimate&&setTimeout((()=>{this.noAnimate=!1}),1e3)}colorChanged(){this.emitColor()}positionChanged(){this.emitStyle()}emitColor(){const{color:e}=this;this.ionColor.emit({"item-label-color":void 0!==e,[`ion-color-${e}`]:void 0!==e})}emitStyle(){const{inRange:e,position:t}=this;e||this.ionStyle.emit({label:!0,[`label-${t}`]:void 0!==t})}render(){const e=this.position,t=xg(this);return Ph(zh,{class:Gg(this.color,{[t]:!0,"in-item-color":Hg("ion-item.ion-color",this.el),[`label-${e}`]:void 0!==e,"label-no-animate":this.noAnimate,"label-rtl":"rtl"===document.dir})})}get el(){return this}static get watchers(){return{color:["colorChanged"],position:["positionChanged"]}}static get style(){return{ios:".item.sc-ion-label-ios-h,.item .sc-ion-label-ios-h{--color:initial;display:block;color:var(--color);font-family:var(--ion-font-family, inherit);font-size:inherit;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box}.ion-color.sc-ion-label-ios-h{color:var(--ion-color-base)}.ion-text-wrap.sc-ion-label-ios-h,[text-wrap].sc-ion-label-ios-h{white-space:normal}.item-interactive-disabled.sc-ion-label-ios-h:not(.item-multiple-inputs),.item-interactive-disabled:not(.item-multiple-inputs) .sc-ion-label-ios-h{cursor:default;opacity:0.3;pointer-events:none}.item-input.sc-ion-label-ios-h,.item-input .sc-ion-label-ios-h{-ms-flex:initial;flex:initial;max-width:200px;pointer-events:none}.item-textarea.sc-ion-label-ios-h,.item-textarea .sc-ion-label-ios-h{-ms-flex-item-align:baseline;align-self:baseline}.label-fixed.sc-ion-label-ios-h{-ms-flex:0 0 100px;flex:0 0 100px;width:100px;min-width:100px;max-width:200px}.label-stacked.sc-ion-label-ios-h,.label-floating.sc-ion-label-ios-h{margin-bottom:0;-ms-flex-item-align:stretch;align-self:stretch;width:auto;max-width:100%}.label-no-animate.label-floating.sc-ion-label-ios-h{-webkit-transition:none;transition:none}.sc-ion-label-ios-s h1,.sc-ion-label-ios-s h2,.sc-ion-label-ios-s h3,.sc-ion-label-ios-s h4,.sc-ion-label-ios-s h5,.sc-ion-label-ios-s h6{text-overflow:inherit;overflow:inherit}.ion-text-wrap.sc-ion-label-ios-h,[text-wrap].sc-ion-label-ios-h{font-size:14px;line-height:1.5}.label-stacked.sc-ion-label-ios-h{margin-bottom:4px;font-size:14px}.label-floating.sc-ion-label-ios-h{margin-bottom:0;-webkit-transform:translate(0, 29px);transform:translate(0, 29px);-webkit-transform-origin:left top;transform-origin:left top;-webkit-transition:-webkit-transform 150ms ease-in-out;transition:-webkit-transform 150ms ease-in-out;transition:transform 150ms ease-in-out;transition:transform 150ms ease-in-out, -webkit-transform 150ms ease-in-out}[dir=rtl].sc-ion-label-ios-h -no-combinator.label-floating.sc-ion-label-ios-h,[dir=rtl] .sc-ion-label-ios-h -no-combinator.label-floating.sc-ion-label-ios-h,[dir=rtl].label-floating.sc-ion-label-ios-h,[dir=rtl] .label-floating.sc-ion-label-ios-h{-webkit-transform-origin:right top;transform-origin:right top}@supports selector(:dir(rtl)){.label-floating.sc-ion-label-ios-h:dir(rtl){-webkit-transform-origin:right top;transform-origin:right top}}.item-textarea.label-floating.sc-ion-label-ios-h,.item-textarea .label-floating.sc-ion-label-ios-h{-webkit-transform:translate(0, 28px);transform:translate(0, 28px)}.item-has-focus.label-floating.sc-ion-label-ios-h,.item-has-focus .label-floating.sc-ion-label-ios-h,.item-has-placeholder.sc-ion-label-ios-h:not(.item-input).label-floating,.item-has-placeholder:not(.item-input) .label-floating.sc-ion-label-ios-h,.item-has-value.label-floating.sc-ion-label-ios-h,.item-has-value .label-floating.sc-ion-label-ios-h{-webkit-transform:scale(0.82);transform:scale(0.82)}.sc-ion-label-ios-s h1{margin-left:0;margin-right:0;margin-top:3px;margin-bottom:2px;font-size:22px;font-weight:normal}.sc-ion-label-ios-s h2{margin-left:0;margin-right:0;margin-top:0;margin-bottom:2px;font-size:17px;font-weight:normal}.sc-ion-label-ios-s h3,.sc-ion-label-ios-s h4,.sc-ion-label-ios-s h5,.sc-ion-label-ios-s h6{margin-left:0;margin-right:0;margin-top:0;margin-bottom:3px;font-size:14px;font-weight:normal;line-height:normal}.sc-ion-label-ios-s p{margin-left:0;margin-right:0;margin-top:0;margin-bottom:2px;font-size:14px;line-height:normal;text-overflow:inherit;overflow:inherit}.sc-ion-label-ios-s>p{color:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.4)}.sc-ion-label-ios-h.in-item-color.sc-ion-label-ios-s>p{color:inherit}.sc-ion-label-ios-s h2:last-child,.sc-ion-label-ios-s h3:last-child,.sc-ion-label-ios-s h4:last-child,.sc-ion-label-ios-s h5:last-child,.sc-ion-label-ios-s h6:last-child,.sc-ion-label-ios-s p:last-child{margin-bottom:0}",md:'.item.sc-ion-label-md-h,.item .sc-ion-label-md-h{--color:initial;display:block;color:var(--color);font-family:var(--ion-font-family, inherit);font-size:inherit;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box}.ion-color.sc-ion-label-md-h{color:var(--ion-color-base)}.ion-text-wrap.sc-ion-label-md-h,[text-wrap].sc-ion-label-md-h{white-space:normal}.item-interactive-disabled.sc-ion-label-md-h:not(.item-multiple-inputs),.item-interactive-disabled:not(.item-multiple-inputs) .sc-ion-label-md-h{cursor:default;opacity:0.3;pointer-events:none}.item-input.sc-ion-label-md-h,.item-input .sc-ion-label-md-h{-ms-flex:initial;flex:initial;max-width:200px;pointer-events:none}.item-textarea.sc-ion-label-md-h,.item-textarea .sc-ion-label-md-h{-ms-flex-item-align:baseline;align-self:baseline}.label-fixed.sc-ion-label-md-h{-ms-flex:0 0 100px;flex:0 0 100px;width:100px;min-width:100px;max-width:200px}.label-stacked.sc-ion-label-md-h,.label-floating.sc-ion-label-md-h{margin-bottom:0;-ms-flex-item-align:stretch;align-self:stretch;width:auto;max-width:100%}.label-no-animate.label-floating.sc-ion-label-md-h{-webkit-transition:none;transition:none}.sc-ion-label-md-s h1,.sc-ion-label-md-s h2,.sc-ion-label-md-s h3,.sc-ion-label-md-s h4,.sc-ion-label-md-s h5,.sc-ion-label-md-s h6{text-overflow:inherit;overflow:inherit}.ion-text-wrap.sc-ion-label-md-h,[text-wrap].sc-ion-label-md-h{line-height:1.5}.label-stacked.sc-ion-label-md-h,.label-floating.sc-ion-label-md-h{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-transform-origin:top left;transform-origin:top left}.label-stacked.label-rtl.sc-ion-label-md-h,.label-floating.label-rtl.sc-ion-label-md-h{-webkit-transform-origin:top right;transform-origin:top right}.label-stacked.sc-ion-label-md-h{-webkit-transform:translateY(50%) scale(0.75);transform:translateY(50%) scale(0.75);-webkit-transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1);transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1)}.label-floating.sc-ion-label-md-h{-webkit-transform:translateY(96%);transform:translateY(96%);-webkit-transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1), -webkit-transform 150ms cubic-bezier(0.4, 0, 0.2, 1);transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1), -webkit-transform 150ms cubic-bezier(0.4, 0, 0.2, 1);transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1), transform 150ms cubic-bezier(0.4, 0, 0.2, 1);transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1), transform 150ms cubic-bezier(0.4, 0, 0.2, 1), -webkit-transform 150ms cubic-bezier(0.4, 0, 0.2, 1)}.ion-focused.label-floating.sc-ion-label-md-h,.ion-focused .label-floating.sc-ion-label-md-h,.item-has-focus.label-floating.sc-ion-label-md-h,.item-has-focus .label-floating.sc-ion-label-md-h,.item-has-placeholder.sc-ion-label-md-h:not(.item-input).label-floating,.item-has-placeholder:not(.item-input) .label-floating.sc-ion-label-md-h,.item-has-value.label-floating.sc-ion-label-md-h,.item-has-value .label-floating.sc-ion-label-md-h{-webkit-transform:translateY(50%) scale(0.75);transform:translateY(50%) scale(0.75)}.item-fill-outline.ion-focused.label-floating.sc-ion-label-md-h,.item-fill-outline.ion-focused .label-floating.sc-ion-label-md-h,.item-fill-outline.item-has-focus.label-floating.sc-ion-label-md-h,.item-fill-outline.item-has-focus .label-floating.sc-ion-label-md-h,.item-fill-outline.item-has-placeholder.sc-ion-label-md-h:not(.item-input).label-floating,.item-fill-outline.item-has-placeholder:not(.item-input) .label-floating.sc-ion-label-md-h,.item-fill-outline.item-has-value.label-floating.sc-ion-label-md-h,.item-fill-outline.item-has-value .label-floating.sc-ion-label-md-h{-webkit-transform:translateY(-6px) scale(0.75);transform:translateY(-6px) scale(0.75);position:relative;max-width:-webkit-min-content;max-width:-moz-min-content;max-width:min-content;background-color:var(--ion-item-background, var(--ion-background-color, #fff));overflow:visible;z-index:3}.item-fill-outline.ion-focused.label-floating.sc-ion-label-md-h::before,.item-fill-outline.ion-focused .label-floating.sc-ion-label-md-h::before,.item-fill-outline.ion-focused.label-floating.sc-ion-label-md-h::after,.item-fill-outline.ion-focused .label-floating.sc-ion-label-md-h::after,.item-fill-outline.item-has-focus.label-floating.sc-ion-label-md-h::before,.item-fill-outline.item-has-focus .label-floating.sc-ion-label-md-h::before,.item-fill-outline.item-has-focus.label-floating.sc-ion-label-md-h::after,.item-fill-outline.item-has-focus .label-floating.sc-ion-label-md-h::after,.item-fill-outline.item-has-placeholder.sc-ion-label-md-h:not(.item-input).label-floating::before,.item-fill-outline.item-has-placeholder:not(.item-input) .label-floating.sc-ion-label-md-h::before,.item-fill-outline.item-has-placeholder.sc-ion-label-md-h:not(.item-input).label-floating::after,.item-fill-outline.item-has-placeholder:not(.item-input) .label-floating.sc-ion-label-md-h::after,.item-fill-outline.item-has-value.label-floating.sc-ion-label-md-h::before,.item-fill-outline.item-has-value .label-floating.sc-ion-label-md-h::before,.item-fill-outline.item-has-value.label-floating.sc-ion-label-md-h::after,.item-fill-outline.item-has-value .label-floating.sc-ion-label-md-h::after{position:absolute;width:4px;height:100%;background-color:var(--ion-item-background, var(--ion-background-color, #fff));content:""}.item-fill-outline.ion-focused.label-floating.sc-ion-label-md-h::before,.item-fill-outline.ion-focused .label-floating.sc-ion-label-md-h::before,.item-fill-outline.item-has-focus.label-floating.sc-ion-label-md-h::before,.item-fill-outline.item-has-focus .label-floating.sc-ion-label-md-h::before,.item-fill-outline.item-has-placeholder.sc-ion-label-md-h:not(.item-input).label-floating::before,.item-fill-outline.item-has-placeholder:not(.item-input) .label-floating.sc-ion-label-md-h::before,.item-fill-outline.item-has-value.label-floating.sc-ion-label-md-h::before,.item-fill-outline.item-has-value .label-floating.sc-ion-label-md-h::before{left:calc(-1 * 4px)}.item-fill-outline.ion-focused.label-floating.sc-ion-label-md-h::after,.item-fill-outline.ion-focused .label-floating.sc-ion-label-md-h::after,.item-fill-outline.item-has-focus.label-floating.sc-ion-label-md-h::after,.item-fill-outline.item-has-focus .label-floating.sc-ion-label-md-h::after,.item-fill-outline.item-has-placeholder.sc-ion-label-md-h:not(.item-input).label-floating::after,.item-fill-outline.item-has-placeholder:not(.item-input) .label-floating.sc-ion-label-md-h::after,.item-fill-outline.item-has-value.label-floating.sc-ion-label-md-h::after,.item-fill-outline.item-has-value .label-floating.sc-ion-label-md-h::after{right:calc(-1 * 4px)}.item-fill-outline.ion-focused.item-has-start-slot.label-floating.sc-ion-label-md-h,.item-fill-outline.ion-focused.item-has-start-slot .label-floating.sc-ion-label-md-h,.item-fill-outline.item-has-focus.item-has-start-slot.label-floating.sc-ion-label-md-h,.item-fill-outline.item-has-focus.item-has-start-slot .label-floating.sc-ion-label-md-h,.item-fill-outline.item-has-placeholder.sc-ion-label-md-h:not(.item-input).item-has-start-slot.label-floating,.item-fill-outline.item-has-placeholder:not(.item-input).item-has-start-slot .label-floating.sc-ion-label-md-h,.item-fill-outline.item-has-value.item-has-start-slot.label-floating.sc-ion-label-md-h,.item-fill-outline.item-has-value.item-has-start-slot .label-floating.sc-ion-label-md-h{-webkit-transform:translateX(-32px) translateY(-6px) scale(0.75);transform:translateX(-32px) translateY(-6px) scale(0.75)}.item-fill-outline.ion-focused.item-has-start-slot.label-floating.label-rtl.sc-ion-label-md-h,.item-fill-outline.ion-focused.item-has-start-slot .label-floating.label-rtl.sc-ion-label-md-h,.item-fill-outline.item-has-focus.item-has-start-slot.label-floating.label-rtl.sc-ion-label-md-h,.item-fill-outline.item-has-focus.item-has-start-slot .label-floating.label-rtl.sc-ion-label-md-h,.item-fill-outline.item-has-placeholder.sc-ion-label-md-h:not(.item-input).item-has-start-slot.label-floating.label-rtl,.item-fill-outline.item-has-placeholder:not(.item-input).item-has-start-slot .label-floating.label-rtl.sc-ion-label-md-h,.item-fill-outline.item-has-value.item-has-start-slot.label-floating.label-rtl.sc-ion-label-md-h,.item-fill-outline.item-has-value.item-has-start-slot .label-floating.label-rtl.sc-ion-label-md-h{-webkit-transform:translateX(calc(-1 * -32px)) translateY(-6px) scale(0.75);transform:translateX(calc(-1 * -32px)) translateY(-6px) scale(0.75)}.ion-focused.label-stacked.sc-ion-label-md-h:not(.ion-color),.ion-focused .label-stacked.sc-ion-label-md-h:not(.ion-color),.ion-focused.label-floating.sc-ion-label-md-h:not(.ion-color),.ion-focused .label-floating.sc-ion-label-md-h:not(.ion-color),.item-has-focus.label-stacked.sc-ion-label-md-h:not(.ion-color),.item-has-focus .label-stacked.sc-ion-label-md-h:not(.ion-color),.item-has-focus.label-floating.sc-ion-label-md-h:not(.ion-color),.item-has-focus .label-floating.sc-ion-label-md-h:not(.ion-color){color:var(--ion-color-primary, #3880ff)}.ion-focused.ion-color.label-stacked.sc-ion-label-md-h:not(.ion-color),.ion-focused.ion-color .label-stacked.sc-ion-label-md-h:not(.ion-color),.ion-focused.ion-color.label-floating.sc-ion-label-md-h:not(.ion-color),.ion-focused.ion-color .label-floating.sc-ion-label-md-h:not(.ion-color),.item-has-focus.ion-color.label-stacked.sc-ion-label-md-h:not(.ion-color),.item-has-focus.ion-color .label-stacked.sc-ion-label-md-h:not(.ion-color),.item-has-focus.ion-color.label-floating.sc-ion-label-md-h:not(.ion-color),.item-has-focus.ion-color .label-floating.sc-ion-label-md-h:not(.ion-color){color:var(--ion-color-contrast)}.item-fill-solid.ion-focused.ion-color.label-stacked.sc-ion-label-md-h:not(.ion-color),.item-fill-solid.ion-focused.ion-color .label-stacked.sc-ion-label-md-h:not(.ion-color),.item-fill-solid.ion-focused.ion-color.label-floating.sc-ion-label-md-h:not(.ion-color),.item-fill-solid.ion-focused.ion-color .label-floating.sc-ion-label-md-h:not(.ion-color),.item-fill-outline.ion-focused.ion-color.label-stacked.sc-ion-label-md-h:not(.ion-color),.item-fill-outline.ion-focused.ion-color .label-stacked.sc-ion-label-md-h:not(.ion-color),.item-fill-outline.ion-focused.ion-color.label-floating.sc-ion-label-md-h:not(.ion-color),.item-fill-outline.ion-focused.ion-color .label-floating.sc-ion-label-md-h:not(.ion-color),.item-fill-solid.item-has-focus.ion-color.label-stacked.sc-ion-label-md-h:not(.ion-color),.item-fill-solid.item-has-focus.ion-color .label-stacked.sc-ion-label-md-h:not(.ion-color),.item-fill-solid.item-has-focus.ion-color.label-floating.sc-ion-label-md-h:not(.ion-color),.item-fill-solid.item-has-focus.ion-color .label-floating.sc-ion-label-md-h:not(.ion-color),.item-fill-outline.item-has-focus.ion-color.label-stacked.sc-ion-label-md-h:not(.ion-color),.item-fill-outline.item-has-focus.ion-color .label-stacked.sc-ion-label-md-h:not(.ion-color),.item-fill-outline.item-has-focus.ion-color.label-floating.sc-ion-label-md-h:not(.ion-color),.item-fill-outline.item-has-focus.ion-color .label-floating.sc-ion-label-md-h:not(.ion-color){color:var(--ion-color-base)}.ion-invalid.ion-touched.label-stacked.sc-ion-label-md-h:not(.ion-color),.ion-invalid.ion-touched .label-stacked.sc-ion-label-md-h:not(.ion-color),.ion-invalid.ion-touched.label-floating.sc-ion-label-md-h:not(.ion-color),.ion-invalid.ion-touched .label-floating.sc-ion-label-md-h:not(.ion-color){color:var(--highlight-color-invalid)}.sc-ion-label-md-s h1{margin-left:0;margin-right:0;margin-top:0;margin-bottom:2px;font-size:24px;font-weight:normal}.sc-ion-label-md-s h2{margin-left:0;margin-right:0;margin-top:2px;margin-bottom:2px;font-size:16px;font-weight:normal}.sc-ion-label-md-s h3,.sc-ion-label-md-s h4,.sc-ion-label-md-s h5,.sc-ion-label-md-s h6{margin-left:0;margin-right:0;margin-top:2px;margin-bottom:2px;font-size:14px;font-weight:normal;line-height:normal}.sc-ion-label-md-s p{margin-left:0;margin-right:0;margin-top:0;margin-bottom:2px;font-size:14px;line-height:20px;text-overflow:inherit;overflow:inherit}.sc-ion-label-md-s>p{color:var(--ion-color-step-600, #666666)}.sc-ion-label-md-h.in-item-color.sc-ion-label-md-s>p{color:inherit}'}}},[34,"ion-label",{color:[513],position:[1],noAnimate:[32]}]),fb="ion-content",mb=".ion-content-scroll-host",gb=`${fb}, ${mb}`,bb=e=>"ION-CONTENT"===e.tagName,yb=e("j",(async e=>bb(e)?(await new Promise((t=>em(e,t))),e.getScrollElement()):e)),vb=e=>{const t=e.querySelector(mb);return t||e.querySelector(gb)},xb=e("f",(e=>e.closest(gb))),wb=(e("s",((e,t)=>bb(e)?e.scrollToTop(t):Promise.resolve(e.scrollTo({top:0,left:0,behavior:t>0?"smooth":"auto"})))),e("k",((e,t,n,r)=>bb(e)?e.scrollByPoint(t,n,r):Promise.resolve(e.scrollBy({top:n,left:t,behavior:r>0?"smooth":"auto"})))),e=>((e,...t)=>console.error(`<${e.tagName.toLowerCase()}> must be used inside ${t.join(" or ")}.`))(e,fb)),kb=e=>{if(bb(e)){const t=e,n=t.scrollY;return t.scrollY=!1,n}return e.style.setProperty("overflow","hidden"),!0};
/*!
             * (C) Ionic http://ionicframework.com - MIT License
             */
var Sb;e("g",Sb),function(e){e.Body="body",e.Ionic="ionic",e.Native="native",e.None="none"}(Sb||e("g",Sb={}));const Ib=e("K",{getEngine(){var e;return(null===(e=null==Zf?void 0:Zf.Capacitor)||void 0===e?void 0:e.isPluginAvailable("Keyboard"))&&(null==Zf?void 0:Zf.Capacitor.Plugins.Keyboard)},getResizeMode(){const e=this.getEngine();return(null==e?void 0:e.getResizeMode)?e.getResizeMode().catch((e=>{if("UNIMPLEMENTED"!==e.code)throw e})):Promise.resolve(void 0)}}),Nb=e=>{if(void 0===Qf||e===Sb.None||void 0===e)return null;const t=Qf.querySelector("ion-app");return null!=t?t:Qf.body},Cb=e=>{const t=Nb(e);return null===t?0:t.clientHeight},Tb=Cf(class extends Bf{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.fixed=!1}render(){const e=xg(this);return Ph(zh,{class:{[e]:!0,"grid-fixed":this.fixed}},Ph("slot",null))}static get style(){return":host{-webkit-padding-start:var(--ion-grid-padding-xs, var(--ion-grid-padding, 5px));padding-inline-start:var(--ion-grid-padding-xs, var(--ion-grid-padding, 5px));-webkit-padding-end:var(--ion-grid-padding-xs, var(--ion-grid-padding, 5px));padding-inline-end:var(--ion-grid-padding-xs, var(--ion-grid-padding, 5px));padding-top:var(--ion-grid-padding-xs, var(--ion-grid-padding, 5px));padding-bottom:var(--ion-grid-padding-xs, var(--ion-grid-padding, 5px));-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;display:block;-ms-flex:1;flex:1}@media (min-width: 576px){:host{-webkit-padding-start:var(--ion-grid-padding-sm, var(--ion-grid-padding, 5px));padding-inline-start:var(--ion-grid-padding-sm, var(--ion-grid-padding, 5px));-webkit-padding-end:var(--ion-grid-padding-sm, var(--ion-grid-padding, 5px));padding-inline-end:var(--ion-grid-padding-sm, var(--ion-grid-padding, 5px));padding-top:var(--ion-grid-padding-sm, var(--ion-grid-padding, 5px));padding-bottom:var(--ion-grid-padding-sm, var(--ion-grid-padding, 5px))}}@media (min-width: 768px){:host{-webkit-padding-start:var(--ion-grid-padding-md, var(--ion-grid-padding, 5px));padding-inline-start:var(--ion-grid-padding-md, var(--ion-grid-padding, 5px));-webkit-padding-end:var(--ion-grid-padding-md, var(--ion-grid-padding, 5px));padding-inline-end:var(--ion-grid-padding-md, var(--ion-grid-padding, 5px));padding-top:var(--ion-grid-padding-md, var(--ion-grid-padding, 5px));padding-bottom:var(--ion-grid-padding-md, var(--ion-grid-padding, 5px))}}@media (min-width: 992px){:host{-webkit-padding-start:var(--ion-grid-padding-lg, var(--ion-grid-padding, 5px));padding-inline-start:var(--ion-grid-padding-lg, var(--ion-grid-padding, 5px));-webkit-padding-end:var(--ion-grid-padding-lg, var(--ion-grid-padding, 5px));padding-inline-end:var(--ion-grid-padding-lg, var(--ion-grid-padding, 5px));padding-top:var(--ion-grid-padding-lg, var(--ion-grid-padding, 5px));padding-bottom:var(--ion-grid-padding-lg, var(--ion-grid-padding, 5px))}}@media (min-width: 1200px){:host{-webkit-padding-start:var(--ion-grid-padding-xl, var(--ion-grid-padding, 5px));padding-inline-start:var(--ion-grid-padding-xl, var(--ion-grid-padding, 5px));-webkit-padding-end:var(--ion-grid-padding-xl, var(--ion-grid-padding, 5px));padding-inline-end:var(--ion-grid-padding-xl, var(--ion-grid-padding, 5px));padding-top:var(--ion-grid-padding-xl, var(--ion-grid-padding, 5px));padding-bottom:var(--ion-grid-padding-xl, var(--ion-grid-padding, 5px))}}:host(.grid-fixed){width:var(--ion-grid-width-xs, var(--ion-grid-width, 100%));max-width:100%}@media (min-width: 576px){:host(.grid-fixed){width:var(--ion-grid-width-sm, var(--ion-grid-width, 540px))}}@media (min-width: 768px){:host(.grid-fixed){width:var(--ion-grid-width-md, var(--ion-grid-width, 720px))}}@media (min-width: 992px){:host(.grid-fixed){width:var(--ion-grid-width-lg, var(--ion-grid-width, 960px))}}@media (min-width: 1200px){:host(.grid-fixed){width:var(--ion-grid-width-xl, var(--ion-grid-width, 1140px))}}:host(.ion-no-padding){--ion-grid-column-padding:0;--ion-grid-column-padding-xs:0;--ion-grid-column-padding-sm:0;--ion-grid-column-padding-md:0;--ion-grid-column-padding-lg:0;--ion-grid-column-padding-xl:0}"}},[1,"ion-grid",{fixed:[4]}]),Eb=function(){"undefined"!=typeof customElements&&["ion-grid"].forEach((e=>{"ion-grid"===e&&(customElements.get(e)||customElements.define(e,Tb))}))},_b=e=>{const t=document.querySelector(`${e}.ion-cloned-element`);if(null!==t)return t;const n=document.createElement(e);return n.classList.add("ion-cloned-element"),n.style.setProperty("display","none"),document.body.appendChild(n),n},$b=e=>{if(!e)return;const t=e.querySelectorAll("ion-toolbar");return{el:e,toolbars:Array.from(t).map((e=>{const t=e.querySelector("ion-title");return{el:e,background:e.shadowRoot.querySelector(".toolbar-background"),ionTitleEl:t,innerTitleEl:t?t.shadowRoot.querySelector(".toolbar-title"):null,ionButtonsEl:Array.from(e.querySelectorAll("ion-buttons"))}}))}},Ab=(e,t)=>{"fade"!==e.collapse&&(void 0===t?e.style.removeProperty("--opacity-scale"):e.style.setProperty("--opacity-scale",t.toString()))},Rb=(e,t,n,r)=>{Jf((()=>{const a=r.scrollTop;((e,t,n)=>{if(!e[0].isIntersecting)return;const r=e[0].intersectionRatio>.9||n<=0?0:100*(1-e[0].intersectionRatio)/75;Ab(t.el,1===r?void 0:r)})(e,t,a);const i=e[0],s=i.intersectionRect,o=s.width*s.height,l=i.rootBounds.width*i.rootBounds.height,u=0===o&&0===l,d=Math.abs(s.left-i.boundingClientRect.left),c=Math.abs(s.right-i.boundingClientRect.right);u||o>0&&(d>=5||c>=5)||(i.isIntersecting?(Db(t,!1),Db(n)):(0===s.x&&0===s.y||0!==s.width&&0!==s.height)&&a>0&&(Db(t),Db(n,!1),Ab(t.el)))}))},Db=(e,t=!0)=>{const n=e.el;t?(n.classList.remove("header-collapse-condense-inactive"),n.removeAttribute("aria-hidden")):(n.classList.add("header-collapse-condense-inactive"),n.setAttribute("aria-hidden","true"))},Fb=(e=[],t=1,n=!1)=>{e.forEach((e=>{const r=e.ionTitleEl,a=e.innerTitleEl;r&&"large"===r.size&&(a.style.transition=n?"all 0.2s ease-in-out":"",a.style.transform=`scale3d(${t}, ${t}, 1)`)}))},Mb=(e,t,n)=>{Yf((()=>{const r=e.scrollTop,a=t.clientHeight,i=n?n.clientHeight:0;if(null!==n&&r<i)return t.style.setProperty("--opacity-scale","0"),void e.style.setProperty("clip-path",`inset(${a}px 0px 0px 0px)`);const s=um(0,(r-i)/10,1);Jf((()=>{e.style.removeProperty("clip-path"),t.style.setProperty("--opacity-scale",s.toString())}))}))},Ob=Cf(class extends Bf{constructor(){super(),this.__registerHost(),this.inheritedAttributes={},this.setupFadeHeader=async(e,t)=>{const n=this.scrollEl=await yb(e);this.contentScrollCallback=()=>{Mb(this.scrollEl,this.el,t)},n.addEventListener("scroll",this.contentScrollCallback),Mb(this.scrollEl,this.el,t)},this.collapse=void 0,this.translucent=!1}componentWillLoad(){this.inheritedAttributes=am(this.el)}componentDidLoad(){this.checkCollapsibleHeader()}componentDidUpdate(){this.checkCollapsibleHeader()}disconnectedCallback(){this.destroyCollapsibleHeader()}async checkCollapsibleHeader(){if("ios"!==xg(this))return;const{collapse:e}=this,t="condense"===e,n="fade"===e;if(this.destroyCollapsibleHeader(),t){const e=this.el.closest("ion-app,ion-page,.ion-page,page-inner"),t=e?vb(e):null;Jf((()=>{_b("ion-title").size="large",_b("ion-back-button")})),await this.setupCondenseHeader(t,e)}else if(n){const e=this.el.closest("ion-app,ion-page,.ion-page,page-inner"),t=e?vb(e):null;if(!t)return void wb(this.el);const n=t.querySelector('ion-header[collapse="condense"]');await this.setupFadeHeader(t,n)}}destroyCollapsibleHeader(){this.intersectionObserver&&(this.intersectionObserver.disconnect(),this.intersectionObserver=void 0),this.scrollEl&&this.contentScrollCallback&&(this.scrollEl.removeEventListener("scroll",this.contentScrollCallback),this.contentScrollCallback=void 0),this.collapsibleMainHeader&&(this.collapsibleMainHeader.classList.remove("header-collapse-main"),this.collapsibleMainHeader=void 0)}async setupCondenseHeader(e,t){if(!e||!t)return void wb(this.el);if("undefined"==typeof IntersectionObserver)return;this.scrollEl=await yb(e);const n=t.querySelectorAll("ion-header");if(this.collapsibleMainHeader=Array.from(n).find((e=>"condense"!==e.collapse)),!this.collapsibleMainHeader)return;const r=$b(this.collapsibleMainHeader),a=$b(this.el);r&&a&&(Db(r,!1),Ab(r.el,0),this.intersectionObserver=new IntersectionObserver((e=>{Rb(e,r,a,this.scrollEl)}),{root:e,threshold:[.25,.3,.4,.5,.6,.7,.8,.9,1]}),this.intersectionObserver.observe(a.toolbars[a.toolbars.length-1].el),this.contentScrollCallback=()=>{((e,t,n)=>{Yf((()=>{const r=e.scrollTop,a=um(1,1+-r/500,1.1);null===n.querySelector("ion-refresher.refresher-native")&&Jf((()=>{Fb(t.toolbars,a)}))}))})(this.scrollEl,a,e)},this.scrollEl.addEventListener("scroll",this.contentScrollCallback),Jf((()=>{void 0!==this.collapsibleMainHeader&&this.collapsibleMainHeader.classList.add("header-collapse-main")})))}render(){const{translucent:e,inheritedAttributes:t}=this,n=xg(this),r=this.collapse||"none",a=Hg("ion-menu",this.el)?"none":"banner";return Ph(zh,Object.assign({role:a,class:{[n]:!0,[`header-${n}`]:!0,"header-translucent":this.translucent,[`header-collapse-${r}`]:!0,[`header-translucent-${n}`]:this.translucent}},t),"ios"===n&&e&&Ph("div",{class:"header-background"}),Ph("slot",null))}get el(){return this}static get style(){return{ios:"ion-header{display:block;position:relative;-ms-flex-order:-1;order:-1;width:100%;z-index:10}ion-header ion-toolbar:first-of-type{padding-top:var(--ion-safe-area-top, 0)}.header-ios ion-toolbar:last-of-type{--border-width:0 0 0.55px}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){.header-background{left:0;right:0;top:0;bottom:0;position:absolute;-webkit-backdrop-filter:saturate(180%) blur(20px);backdrop-filter:saturate(180%) blur(20px)}.header-translucent-ios ion-toolbar{--opacity:.8}.header-collapse-condense-inactive .header-background{-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px)}}.header-ios.ion-no-border ion-toolbar:last-of-type{--border-width:0}.header-collapse-fade ion-toolbar{--opacity-scale:inherit}.header-collapse-condense{z-index:9}.header-collapse-condense ion-toolbar{position:-webkit-sticky;position:sticky;top:0}.header-collapse-condense ion-toolbar:first-of-type{padding-top:7px;z-index:1}.header-collapse-condense ion-toolbar{--background:var(--ion-background-color, #fff);z-index:0}.header-collapse-condense ion-toolbar:last-of-type{--border-width:0px}.header-collapse-condense ion-toolbar ion-searchbar{height:48px;padding-top:0px;padding-bottom:13px}.header-collapse-main{--opacity-scale:1}.header-collapse-main ion-toolbar{--opacity-scale:inherit}.header-collapse-main ion-toolbar.in-toolbar ion-title,.header-collapse-main ion-toolbar.in-toolbar ion-buttons{-webkit-transition:all 0.2s ease-in-out;transition:all 0.2s ease-in-out}.header-collapse-condense-inactive:not(.header-collapse-condense) ion-toolbar.in-toolbar ion-title,.header-collapse-condense-inactive:not(.header-collapse-condense) ion-toolbar.in-toolbar ion-buttons.buttons-collapse{opacity:0;pointer-events:none}.header-collapse-condense-inactive.header-collapse-condense ion-toolbar.in-toolbar ion-title,.header-collapse-condense-inactive.header-collapse-condense ion-toolbar.in-toolbar ion-buttons.buttons-collapse{visibility:hidden}",md:"ion-header{display:block;position:relative;-ms-flex-order:-1;order:-1;width:100%;z-index:10}ion-header ion-toolbar:first-of-type{padding-top:var(--ion-safe-area-top, 0)}.header-md{-webkit-box-shadow:0 2px 4px -1px rgba(0, 0, 0, 0.2), 0 4px 5px 0 rgba(0, 0, 0, 0.14), 0 1px 10px 0 rgba(0, 0, 0, 0.12);box-shadow:0 2px 4px -1px rgba(0, 0, 0, 0.2), 0 4px 5px 0 rgba(0, 0, 0, 0.14), 0 1px 10px 0 rgba(0, 0, 0, 0.12)}.header-collapse-condense{display:none}.header-md.ion-no-border{-webkit-box-shadow:none;box-shadow:none}"}}},[36,"ion-header",{collapse:[1],translucent:[4]}]),Pb=function(){"undefined"!=typeof customElements&&["ion-header"].forEach((e=>{"ion-header"===e&&(customElements.get(e)||customElements.define(e,Ob))}))},Lb={bubbles:{dur:1e3,circles:9,fn:(e,t,n)=>{const r=e*t/n-e+"ms",a=2*Math.PI*t/n;return{r:5,style:{top:32*Math.sin(a)+"%",left:32*Math.cos(a)+"%","animation-delay":r}}}},circles:{dur:1e3,circles:8,fn:(e,t,n)=>{const r=t/n,a=e*r-e+"ms",i=2*Math.PI*r;return{r:5,style:{top:32*Math.sin(i)+"%",left:32*Math.cos(i)+"%","animation-delay":a}}}},circular:{dur:1400,elmDuration:!0,circles:1,fn:()=>({r:20,cx:48,cy:48,fill:"none",viewBox:"24 24 48 48",transform:"translate(0,0)",style:{}})},crescent:{dur:750,circles:1,fn:()=>({r:26,style:{}})},dots:{dur:750,circles:3,fn:(e,t)=>({r:6,style:{left:32-32*t+"%","animation-delay":-110*t+"ms"}})},lines:{dur:1e3,lines:8,fn:(e,t,n)=>({y1:14,y2:26,style:{transform:`rotate(${360/n*t+(t<n/2?180:-180)}deg)`,"animation-delay":e*t/n-e+"ms"}})},"lines-small":{dur:1e3,lines:8,fn:(e,t,n)=>({y1:12,y2:20,style:{transform:`rotate(${360/n*t+(t<n/2?180:-180)}deg)`,"animation-delay":e*t/n-e+"ms"}})},"lines-sharp":{dur:1e3,lines:12,fn:(e,t,n)=>({y1:17,y2:29,style:{transform:`rotate(${30*t+(t<6?180:-180)}deg)`,"animation-delay":e*t/n-e+"ms"}})},"lines-sharp-small":{dur:1e3,lines:12,fn:(e,t,n)=>({y1:12,y2:20,style:{transform:`rotate(${30*t+(t<6?180:-180)}deg)`,"animation-delay":e*t/n-e+"ms"}})}},zb=Lb,Bb=Cf(class extends Bf{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.color=void 0,this.duration=void 0,this.name=void 0,this.paused=!1}getName(){const e=this.name||rg.get("spinner"),t=xg(this);return e||("ios"===t?"lines":"circular")}render(){var e;const t=this,n=xg(t),r=t.getName(),a=null!==(e=zb[r])&&void 0!==e?e:zb.lines,i="number"==typeof t.duration&&t.duration>10?t.duration:a.dur,s=[];if(void 0!==a.circles)for(let o=0;o<a.circles;o++)s.push(Wb(a,i,o,a.circles));else if(void 0!==a.lines)for(let o=0;o<a.lines;o++)s.push(Vb(a,i,o,a.lines));return Ph(zh,{class:Gg(t.color,{[n]:!0,[`spinner-${r}`]:!0,"spinner-paused":t.paused||rg.getBoolean("_testing")}),role:"progressbar",style:a.elmDuration?{animationDuration:i+"ms"}:{}},s)}static get style(){return":host{display:inline-block;position:relative;width:28px;height:28px;color:var(--color);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}:host(.ion-color){color:var(--ion-color-base)}svg{-webkit-transform-origin:center;transform-origin:center;position:absolute;top:0;left:0;width:100%;height:100%;-webkit-transform:translateZ(0);transform:translateZ(0)}:host-context([dir=rtl]) svg{-webkit-transform-origin:calc(100% - center);transform-origin:calc(100% - center)}[dir=rtl] svg{-webkit-transform-origin:calc(100% - center);transform-origin:calc(100% - center)}@supports selector(:dir(rtl)){svg:dir(rtl){-webkit-transform-origin:calc(100% - center);transform-origin:calc(100% - center)}}:host(.spinner-lines) line,:host(.spinner-lines-small) line{stroke-width:7px}:host(.spinner-lines-sharp) line,:host(.spinner-lines-sharp-small) line{stroke-width:4px}:host(.spinner-lines) line,:host(.spinner-lines-small) line,:host(.spinner-lines-sharp) line,:host(.spinner-lines-sharp-small) line{stroke-linecap:round;stroke:currentColor}:host(.spinner-lines) svg,:host(.spinner-lines-small) svg,:host(.spinner-lines-sharp) svg,:host(.spinner-lines-sharp-small) svg{-webkit-animation:spinner-fade-out 1s linear infinite;animation:spinner-fade-out 1s linear infinite}:host(.spinner-bubbles) svg{-webkit-animation:spinner-scale-out 1s linear infinite;animation:spinner-scale-out 1s linear infinite;fill:currentColor}:host(.spinner-circles) svg{-webkit-animation:spinner-fade-out 1s linear infinite;animation:spinner-fade-out 1s linear infinite;fill:currentColor}:host(.spinner-crescent) circle{fill:transparent;stroke-width:4px;stroke-dasharray:128px;stroke-dashoffset:82px;stroke:currentColor}:host(.spinner-crescent) svg{-webkit-animation:spinner-rotate 1s linear infinite;animation:spinner-rotate 1s linear infinite}:host(.spinner-dots) circle{stroke-width:0;fill:currentColor}:host(.spinner-dots) svg{-webkit-animation:spinner-dots 1s linear infinite;animation:spinner-dots 1s linear infinite}:host(.spinner-circular) svg{-webkit-animation:spinner-circular linear infinite;animation:spinner-circular linear infinite}:host(.spinner-circular) circle{-webkit-animation:spinner-circular-inner ease-in-out infinite;animation:spinner-circular-inner ease-in-out infinite;stroke:currentColor;stroke-dasharray:80px, 200px;stroke-dashoffset:0px;stroke-width:5.6;fill:none}:host(.spinner-paused),:host(.spinner-paused) svg,:host(.spinner-paused) circle{-webkit-animation-play-state:paused;animation-play-state:paused}@-webkit-keyframes spinner-fade-out{0%{opacity:1}100%{opacity:0}}@keyframes spinner-fade-out{0%{opacity:1}100%{opacity:0}}@-webkit-keyframes spinner-scale-out{0%{-webkit-transform:scale(1, 1);transform:scale(1, 1)}100%{-webkit-transform:scale(0, 0);transform:scale(0, 0)}}@keyframes spinner-scale-out{0%{-webkit-transform:scale(1, 1);transform:scale(1, 1)}100%{-webkit-transform:scale(0, 0);transform:scale(0, 0)}}@-webkit-keyframes spinner-rotate{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spinner-rotate{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes spinner-dots{0%{-webkit-transform:scale(1, 1);transform:scale(1, 1);opacity:0.9}50%{-webkit-transform:scale(0.4, 0.4);transform:scale(0.4, 0.4);opacity:0.3}100%{-webkit-transform:scale(1, 1);transform:scale(1, 1);opacity:0.9}}@keyframes spinner-dots{0%{-webkit-transform:scale(1, 1);transform:scale(1, 1);opacity:0.9}50%{-webkit-transform:scale(0.4, 0.4);transform:scale(0.4, 0.4);opacity:0.3}100%{-webkit-transform:scale(1, 1);transform:scale(1, 1);opacity:0.9}}@-webkit-keyframes spinner-circular{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spinner-circular{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes spinner-circular-inner{0%{stroke-dasharray:1px, 200px;stroke-dashoffset:0px}50%{stroke-dasharray:100px, 200px;stroke-dashoffset:-15px}100%{stroke-dasharray:100px, 200px;stroke-dashoffset:-125px}}@keyframes spinner-circular-inner{0%{stroke-dasharray:1px, 200px;stroke-dashoffset:0px}50%{stroke-dasharray:100px, 200px;stroke-dashoffset:-15px}100%{stroke-dasharray:100px, 200px;stroke-dashoffset:-125px}}"}},[1,"ion-spinner",{color:[513],duration:[2],name:[1],paused:[4]}]),Wb=(e,t,n,r)=>{const a=e.fn(t,n,r);return a.style["animation-duration"]=t+"ms",Ph("svg",{viewBox:a.viewBox||"0 0 64 64",style:a.style},Ph("circle",{transform:a.transform||"translate(32,32)",cx:a.cx,cy:a.cy,r:a.r,style:e.elmDuration?{animationDuration:t+"ms"}:{}}))},Vb=(e,t,n,r)=>{const a=e.fn(t,n,r);return a.style["animation-duration"]=t+"ms",Ph("svg",{viewBox:a.viewBox||"0 0 64 64",style:a.style},Ph("line",{transform:"translate(32,32)",y1:a.y1,y2:a.y2}))},Ub=function(){"undefined"!=typeof customElements&&["ion-label"].forEach((e=>{"ion-label"===e&&(customElements.get(e)||customElements.define(e,hb))}))}
/*!
             * (C) Ionic http://ionicframework.com - MIT License
             */;
/*!
             * (C) Ionic http://ionicframework.com - MIT License
             */class jb{constructor(e,t){this.component=e,this.params=t,this.state=1}async init(e){if(this.state=2,!this.element){const t=this.component;this.element=await Sg(this.delegate,e,t,["ion-page","ion-page-invisible"],this.params)}}_destroy(){dm(3!==this.state,"view state must be ATTACHED");const e=this.element;e&&(this.delegate?this.delegate.removeViewFromDom(e.parentElement,e):e.remove()),this.nav=void 0,this.state=3}}const Hb=(e,t,n)=>!!e&&e.component===t&&cm(e.params,n),Gb=(e,t)=>e?e instanceof jb?e:new jb(e,t):null,qb=Cf(class extends Bf{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.ionNavWillLoad=Uh(this,"ionNavWillLoad",7),this.ionNavWillChange=Uh(this,"ionNavWillChange",3),this.ionNavDidChange=Uh(this,"ionNavDidChange",3),this.transInstr=[],this.animationEnabled=!0,this.useRouter=!1,this.isTransitioning=!1,this.destroyed=!1,this.views=[],this.didLoad=!1,this.delegate=void 0,this.swipeGesture=void 0,this.animated=!0,this.animation=void 0,this.rootParams=void 0,this.root=void 0}swipeGestureChanged(){this.gesture&&this.gesture.enable(!0===this.swipeGesture)}rootChanged(){void 0!==this.root&&!1!==this.didLoad&&(this.useRouter||void 0!==this.root&&this.setRoot(this.root,this.rootParams))}componentWillLoad(){if(this.useRouter=null!==document.querySelector("ion-router")&&null===this.el.closest("[no-router]"),void 0===this.swipeGesture){const e=xg(this);this.swipeGesture=rg.getBoolean("swipeBackEnabled","ios"===e)}this.ionNavWillLoad.emit()}async componentDidLoad(){this.didLoad=!0,this.rootChanged(),this.gesture=(await yh((()=>t.import("./swipe-back-legacy-d992cfa5.js")))).createSwipeBackGesture(this.el,this.canStart.bind(this),this.onStart.bind(this),this.onMove.bind(this),this.onEnd.bind(this)),this.swipeGestureChanged()}connectedCallback(){this.destroyed=!1}disconnectedCallback(){for(const e of this.views)Mm(e.element,km),e._destroy();this.gesture&&(this.gesture.destroy(),this.gesture=void 0),this.transInstr.length=0,this.views.length=0,this.destroyed=!0}push(e,t,n,r){return this.insert(-1,e,t,n,r)}insert(e,t,n,r,a){return this.insertPages(e,[{component:t,componentProps:n}],r,a)}insertPages(e,t,n,r){return this.queueTrns({insertStart:e,insertViews:t,opts:n},r)}pop(e,t){return this.removeIndex(-1,1,e,t)}popTo(e,t,n){const r={removeStart:-1,removeCount:-1,opts:t};return"object"==typeof e&&e.component?(r.removeView=e,r.removeStart=1):"number"==typeof e&&(r.removeStart=e+1),this.queueTrns(r,n)}popToRoot(e,t){return this.removeIndex(1,-1,e,t)}removeIndex(e,t=1,n,r){return this.queueTrns({removeStart:e,removeCount:t,opts:n},r)}setRoot(e,t,n,r){return this.setPages([{component:e,componentProps:t}],n,r)}setPages(e,t,n){return null!=t||(t={}),!0!==t.animated&&(t.animated=!1),this.queueTrns({insertStart:0,insertViews:e,removeStart:0,removeCount:-1,opts:t},n)}setRouteId(e,t,n,r){const a=this.getActiveSync();if(Hb(a,e,t))return Promise.resolve({changed:!1,element:a.element});let i;const s=new Promise((e=>i=e));let o;const l={updateURL:!1,viewIsReady:e=>{let t;const n=new Promise((e=>t=e));return i({changed:!0,element:e,markVisible:async()=>{t(),await o}}),n}};if("root"===n)o=this.setRoot(e,t,l);else{const a=this.views.find((n=>Hb(n,e,t)));a?o=this.popTo(a,Object.assign(Object.assign({},l),{direction:"back",animationBuilder:r})):"forward"===n?o=this.push(e,t,Object.assign(Object.assign({},l),{animationBuilder:r})):"back"===n&&(o=this.setRoot(e,t,Object.assign(Object.assign({},l),{direction:"back",animated:!0,animationBuilder:r})))}return s}async getRouteId(){const e=this.getActiveSync();if(e)return{id:e.element.tagName,params:e.params,element:e.element}}async getActive(){return this.getActiveSync()}async getByIndex(e){return this.views[e]}async canGoBack(e){return this.canGoBackSync(e)}async getPrevious(e){return this.getPreviousSync(e)}getLength(){return this.views.length}getActiveSync(){return this.views[this.views.length-1]}canGoBackSync(e=this.getActiveSync()){return!(!e||!this.getPreviousSync(e))}getPreviousSync(e=this.getActiveSync()){if(!e)return;const t=this.views,n=t.indexOf(e);return n>0?t[n-1]:void 0}async queueTrns(e,t){var n,r;if(this.isTransitioning&&(null===(n=e.opts)||void 0===n?void 0:n.skipIfBusy))return!1;const a=new Promise(((t,n)=>{e.resolve=t,e.reject=n}));if(e.done=t,e.opts&&!1!==e.opts.updateURL&&this.useRouter){const t=document.querySelector("ion-router");if(t){const n=await t.canTransition();if(!1===n)return!1;if("string"==typeof n)return t.push(n,e.opts.direction||"back"),!1}}return 0===(null===(r=e.insertViews)||void 0===r?void 0:r.length)&&(e.insertViews=void 0),this.transInstr.push(e),this.nextTrns(),a}success(e,t){if(this.destroyed)this.fireError("nav controller was destroyed",t);else if(t.done&&t.done(e.hasCompleted,e.requiresTransition,e.enteringView,e.leavingView,e.direction),t.resolve(e.hasCompleted),!1!==t.opts.updateURL&&this.useRouter){const t=document.querySelector("ion-router");if(t){const n="back"===e.direction?"back":"forward";t.navChanged(n)}}}failed(e,t){this.destroyed?this.fireError("nav controller was destroyed",t):(this.transInstr.length=0,this.fireError(e,t))}fireError(e,t){t.done&&t.done(!1,!1,e),t.reject&&!this.destroyed?t.reject(e):t.resolve(!1)}nextTrns(){if(this.isTransitioning)return!1;const e=this.transInstr.shift();return!!e&&(this.runTransition(e),!0)}async runTransition(e){try{this.ionNavWillChange.emit(),this.isTransitioning=!0,this.prepareTI(e);const t=this.getActiveSync(),n=this.getEnteringView(e,t);if(!t&&!n)throw new Error("no views in the stack to be removed");n&&1===n.state&&await n.init(this.el),this.postViewInit(n,t,e);const r=(e.enteringRequiresTransition||e.leavingRequiresTransition)&&n!==t;let a;r&&e.opts&&t&&("back"===e.opts.direction&&(e.opts.animationBuilder=e.opts.animationBuilder||(null==n?void 0:n.animationBuilder)),t.animationBuilder=e.opts.animationBuilder),a=r?await this.transition(n,t,e):{hasCompleted:!0,requiresTransition:!1},this.success(a,e),this.ionNavDidChange.emit()}catch(t){this.failed(t,e)}this.isTransitioning=!1,this.nextTrns()}prepareTI(e){var t,n,r;const a=this.views.length;if(null!==(t=e.opts)&&void 0!==t||(e.opts={}),null!==(n=(r=e.opts).delegate)&&void 0!==n||(r.delegate=this.delegate),void 0!==e.removeView){dm(void 0!==e.removeStart,"removeView needs removeStart"),dm(void 0!==e.removeCount,"removeView needs removeCount");const t=this.views.indexOf(e.removeView);if(t<0)throw new Error("removeView was not found");e.removeStart+=t}void 0!==e.removeStart&&(e.removeStart<0&&(e.removeStart=a-1),e.removeCount<0&&(e.removeCount=a-e.removeStart),e.leavingRequiresTransition=e.removeCount>0&&e.removeStart+e.removeCount===a),e.insertViews&&((e.insertStart<0||e.insertStart>a)&&(e.insertStart=a),e.enteringRequiresTransition=e.insertStart===a);const i=e.insertViews;if(!i)return;dm(i.length>0,"length can not be zero");const s=i.map((e=>e instanceof jb?e:"component"in e?Gb(e.component,null===e.componentProps?void 0:e.componentProps):Gb(e,void 0))).filter((e=>null!==e));if(0===s.length)throw new Error("invalid views to insert");for(const o of s){o.delegate=e.opts.delegate;const t=o.nav;if(t&&t!==this)throw new Error("inserted view was already inserted");if(3===o.state)throw new Error("inserted view was already destroyed")}e.insertViews=s}getEnteringView(e,t){const n=e.insertViews;if(void 0!==n)return n[n.length-1];const r=e.removeStart;if(void 0!==r){const n=this.views,a=r+e.removeCount;for(let e=n.length-1;e>=0;e--){const i=n[e];if((e<r||e>=a)&&i!==t)return i}}}postViewInit(e,t,n){var r,a,i;dm(t||e,"Both leavingView and enteringView are null"),dm(n.resolve,"resolve must be valid"),dm(n.reject,"reject must be valid");const s=n.opts,{insertViews:o,removeStart:l,removeCount:u}=n;let d;if(void 0!==l&&void 0!==u){dm(l>=0,"removeStart can not be negative"),dm(u>=0,"removeCount can not be negative"),d=[];for(let n=l;n<l+u;n++){const r=this.views[n];void 0!==r&&r!==e&&r!==t&&d.push(r)}null!==(r=s.direction)&&void 0!==r||(s.direction="back")}const c=this.views.length+(null!==(a=null==o?void 0:o.length)&&void 0!==a?a:0)-(null!=u?u:0);if(dm(c>=0,"final balance can not be negative"),0===c)throw console.warn("You can't remove all the pages in the navigation stack. nav.pop() is probably called too many times.",this,this.el),new Error("navigation stack needs at least one root page");if(o){let e=n.insertStart;for(const t of o)this.insertViewAt(t,e),e++;n.enteringRequiresTransition&&(null!==(i=s.direction)&&void 0!==i||(s.direction="forward"))}if(d&&d.length>0){for(const e of d)Mm(e.element,xm),Mm(e.element,wm),Mm(e.element,km);for(const e of d)this.destroyView(e)}}async transition(e,t,n){const r=n.opts,a=r.progressAnimation?e=>this.sbAni=e:void 0,i=xg(this),s=e.element,o=t&&t.element,l=Object.assign(Object.assign({mode:i,showGoBack:this.canGoBackSync(e),baseEl:this.el,progressCallback:a,animated:this.animated&&rg.getBoolean("animated",!0),enteringEl:s,leavingEl:o},r),{animationBuilder:r.animationBuilder||this.animation||rg.get("navAnimation")}),{hasCompleted:u}=await Sm(l);return this.transitionFinish(u,e,t,r)}transitionFinish(e,t,n,r){const a=e?t:n;return a&&this.unmountInactiveViews(a),{hasCompleted:e,requiresTransition:!0,enteringView:t,leavingView:n,direction:r.direction}}insertViewAt(e,t){const n=this.views,r=n.indexOf(e);r>-1?(dm(e.nav===this,"view is not part of the nav"),n.splice(r,1),n.splice(t,0,e)):(dm(!e.nav,"nav is used"),e.nav=this,n.splice(t,0,e))}removeView(e){dm(2===e.state||3===e.state,"view state should be loaded or destroyed");const t=this.views,n=t.indexOf(e);dm(n>-1,"view must be part of the stack"),n>=0&&t.splice(n,1)}destroyView(e){e._destroy(),this.removeView(e)}unmountInactiveViews(e){if(this.destroyed)return;const t=this.views,n=t.indexOf(e);for(let r=t.length-1;r>=0;r--){const e=t[r],a=e.element;a&&(r>n?(Mm(a,km),this.destroyView(e)):r<n&&Pm(a,!0))}}canStart(){return!!this.swipeGesture&&!this.isTransitioning&&0===this.transInstr.length&&this.animationEnabled&&this.canGoBackSync()}onStart(){this.pop({direction:"back",progressAnimation:!0})}onMove(e){this.sbAni&&this.sbAni.progressStep(e)}onEnd(e,t,n){if(this.sbAni){this.animationEnabled=!1,this.sbAni.onFinish((()=>{this.animationEnabled=!0}),{oneTimeCallback:!0});let r=e?-.001:.001;e?r+=zm([0,0],[.32,.72],[0,1],[1,1],t)[0]:(this.sbAni.easing("cubic-bezier(1, 0, 0.68, 0.28)"),r+=zm([0,0],[1,0],[.68,.28],[1,1],t)[0]),this.sbAni.progressEnd(e?1:0,r,n)}}render(){return Ph("slot",null)}get el(){return this}static get watchers(){return{swipeGesture:["swipeGestureChanged"],root:["rootChanged"]}}static get style(){return":host{left:0;right:0;top:0;bottom:0;position:absolute;contain:layout size style;overflow:hidden;z-index:0}"}},[1,"ion-nav",{delegate:[16],swipeGesture:[1028,"swipe-gesture"],animated:[4],animation:[16],rootParams:[16],root:[1],push:[64],insert:[64],insertPages:[64],pop:[64],popTo:[64],popToRoot:[64],removeIndex:[64],setRoot:[64],setPages:[64],setRouteId:[64],getRouteId:[64],getActive:[64],getByIndex:[64],canGoBack:[64],getPrevious:[64]}]),Kb=function(){"undefined"!=typeof customElements&&["ion-nav"].forEach((e=>{"ion-nav"===e&&(customElements.get(e)||customElements.define(e,qb))}))},Xb=Cf(class extends Bf{constructor(){super(),this.__registerHost(),this.__attachShadow()}render(){return Ph(zh,{class:xg(this)},Ph("slot",null))}static get style(){return":host{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}"}},[1,"ion-row"]),Yb=function(){"undefined"!=typeof customElements&&["ion-row"].forEach((e=>{"ion-row"===e&&(customElements.get(e)||customElements.define(e,Xb))}))},Jb=Cf(class extends Bf{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.ionChange=Uh(this,"ionChange",7),this.ionSelect=Uh(this,"ionSelect",7),this.ionStyle=Uh(this,"ionStyle",7),this.onClick=e=>{const t=e.target,n=this.checked;"ION-SEGMENT"!==t.tagName&&(this.value=t.value,t!==n&&this.emitValueChange(),!this.scrollable&&this.swipeGesture||(n?this.checkButton(n,t):this.setCheckedClasses()))},this.getSegmentButton=e=>{var t,n;const r=this.getButtons().filter((e=>!e.disabled)),a=r.findIndex((e=>e===document.activeElement));switch(e){case"first":return r[0];case"last":return r[r.length-1];case"next":return null!==(t=r[a+1])&&void 0!==t?t:r[0];case"previous":return null!==(n=r[a-1])&&void 0!==n?n:r[r.length-1];default:return null}},this.activated=!1,this.color=void 0,this.disabled=!1,this.scrollable=!1,this.swipeGesture=!0,this.value=void 0,this.selectOnFocus=!1}colorChanged(e,t){(void 0===t&&void 0!==e||void 0!==t&&void 0===e)&&this.emitStyle()}swipeGestureChanged(){this.gestureChanged()}valueChanged(e){if(this.ionSelect.emit({value:e}),this.scrollable){const t=this.getButtons().find((t=>t.value===e));void 0!==t&&t.scrollIntoView({behavior:"smooth",inline:"center",block:"nearest"})}}disabledChanged(){this.gestureChanged();const e=this.getButtons();for(const t of e)t.disabled=this.disabled}gestureChanged(){this.gesture&&this.gesture.enable(!this.scrollable&&!this.disabled&&this.swipeGesture)}connectedCallback(){this.emitStyle()}componentWillLoad(){this.emitStyle()}async componentDidLoad(){this.setCheckedClasses(),this.gesture=(await yh((()=>Promise.resolve().then((()=>tg))))).createGesture({el:this.el,gestureName:"segment",gesturePriority:100,threshold:0,passive:!1,onStart:e=>this.onStart(e),onMove:e=>this.onMove(e),onEnd:e=>this.onEnd(e)}),this.gestureChanged(),this.disabled&&this.disabledChanged()}onStart(e){this.valueBeforeGesture=this.value,this.activate(e)}onMove(e){this.setNextIndex(e)}onEnd(e){this.setActivated(!1),this.setNextIndex(e,!0),e.event.stopImmediatePropagation();const t=this.value;void 0!==t&&this.valueBeforeGesture!==t&&this.emitValueChange(),this.valueBeforeGesture=void 0}emitValueChange(){const{value:e}=this;this.ionChange.emit({value:e})}getButtons(){return Array.from(this.el.querySelectorAll("ion-segment-button"))}get checked(){return this.getButtons().find((e=>e.value===this.value))}setActivated(e){this.getButtons().forEach((t=>{e?t.classList.add("segment-button-activated"):t.classList.remove("segment-button-activated")})),this.activated=e}activate(e){const t=e.event.target,n=this.getButtons().find((e=>e.value===this.value));"ION-SEGMENT-BUTTON"===t.tagName&&(n||(this.value=t.value,this.setCheckedClasses()),this.value===t.value&&this.setActivated(!0))}getIndicator(e){return(e.shadowRoot||e).querySelector(".segment-button-indicator")}checkButton(e,t){const n=this.getIndicator(e),r=this.getIndicator(t);if(null===n||null===r)return;const a=n.getBoundingClientRect(),i=r.getBoundingClientRect(),s=a.width/i.width,o=`translate3d(${a.left-i.left}px, 0, 0) scaleX(${s})`;Jf((()=>{r.classList.remove("segment-button-indicator-animated"),r.style.setProperty("transform",o),r.getBoundingClientRect(),r.classList.add("segment-button-indicator-animated"),r.style.setProperty("transform","")})),this.value=t.value,this.setCheckedClasses()}setCheckedClasses(){const e=this.getButtons(),t=e.findIndex((e=>e.value===this.value))+1;for(const n of e)n.classList.remove("segment-button-after-checked");t<e.length&&e[t].classList.add("segment-button-after-checked")}setNextIndex(e,t=!1){const n=ob(this.el),r=this.activated,a=this.getButtons(),i=a.findIndex((e=>e.value===this.value)),s=a[i];let o,l;if(-1===i)return;const u=s.getBoundingClientRect(),d=u.left,c=u.width,p=e.currentX,h=u.top+u.height/2,f=this.el.getRootNode().elementFromPoint(p,h);if(r&&!t){if(n?p>d+c:p<d){const e=i-1;e>=0&&(l=e)}else if((n?p<d:p>d+c)&&r&&!t){const e=i+1;e<a.length&&(l=e)}void 0===l||a[l].disabled||(o=a[l])}if(!r&&t&&(o=f),null!=o){if("ION-SEGMENT"===o.tagName)return!1;s!==o&&this.checkButton(s,o)}return!0}emitStyle(){this.ionStyle.emit({segment:!0})}onKeyDown(e){const t=ob(this.el);let n,r=this.selectOnFocus;switch(e.key){case"ArrowRight":e.preventDefault(),n=t?this.getSegmentButton("previous"):this.getSegmentButton("next");break;case"ArrowLeft":e.preventDefault(),n=t?this.getSegmentButton("next"):this.getSegmentButton("previous");break;case"Home":e.preventDefault(),n=this.getSegmentButton("first");break;case"End":e.preventDefault(),n=this.getSegmentButton("last");break;case" ":case"Enter":e.preventDefault(),n=document.activeElement,r=!0}if(n){if(r){const e=this.checked;this.checkButton(e||n,n),n!==e&&this.emitValueChange()}n.setFocus()}}render(){const e=xg(this);return Ph(zh,{role:"tablist",onClick:this.onClick,class:Gg(this.color,{[e]:!0,"in-toolbar":Hg("ion-toolbar",this.el),"in-toolbar-color":Hg("ion-toolbar[color]",this.el),"segment-activated":this.activated,"segment-disabled":this.disabled,"segment-scrollable":this.scrollable})},Ph("slot",null))}get el(){return this}static get watchers(){return{color:["colorChanged"],swipeGesture:["swipeGestureChanged"],value:["valueChanged"],disabled:["disabledChanged"]}}static get style(){return{ios:":host{--ripple-color:currentColor;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:grid;grid-auto-columns:1fr;position:relative;-ms-flex-align:stretch;align-items:stretch;-ms-flex-pack:center;justify-content:center;width:100%;background:var(--background);font-family:var(--ion-font-family, inherit);text-align:center;contain:paint;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}:host(.segment-scrollable){-ms-flex-pack:start;justify-content:start;width:auto;overflow-x:auto;grid-auto-columns:minmax(-webkit-min-content, 1fr);grid-auto-columns:minmax(min-content, 1fr)}:host(.segment-scrollable::-webkit-scrollbar){display:none}:host{--background:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.065);border-radius:8px;overflow:hidden;z-index:0}:host(.ion-color){background:rgba(var(--ion-color-base-rgb), 0.065)}:host(.in-toolbar){-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;margin-top:0;margin-bottom:0;width:auto}:host(.in-toolbar:not(.ion-color)){background:var(--ion-toolbar-segment-background, var(--background))}:host(.in-toolbar-color:not(.ion-color)){background:rgba(var(--ion-color-contrast-rgb), 0.11)}",md:":host{--ripple-color:currentColor;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:grid;grid-auto-columns:1fr;position:relative;-ms-flex-align:stretch;align-items:stretch;-ms-flex-pack:center;justify-content:center;width:100%;background:var(--background);font-family:var(--ion-font-family, inherit);text-align:center;contain:paint;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}:host(.segment-scrollable){-ms-flex-pack:start;justify-content:start;width:auto;overflow-x:auto;grid-auto-columns:minmax(-webkit-min-content, 1fr);grid-auto-columns:minmax(min-content, 1fr)}:host(.segment-scrollable::-webkit-scrollbar){display:none}:host{--background:transparent;grid-auto-columns:minmax(auto, 360px)}:host(.in-toolbar){min-height:var(--min-height)}:host(.segment-scrollable) ::slotted(ion-segment-button){min-width:auto}"}}},[33,"ion-segment",{color:[513],disabled:[4],scrollable:[4],swipeGesture:[4,"swipe-gesture"],value:[1032],selectOnFocus:[4,"select-on-focus"],activated:[32]},[[0,"keydown","onKeyDown"]]]),Zb=function(){"undefined"!=typeof customElements&&["ion-segment"].forEach((e=>{"ion-segment"===e&&(customElements.get(e)||customElements.define(e,Jb))}))};let Qb=0;const ey=Cf(class extends Bf{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.segmentEl=null,this.inheritedAttributes={},this.updateStyle=()=>{xf(this)},this.updateState=()=>{const{segmentEl:e}=this;e&&(this.checked=e.value===this.value,e.disabled&&(this.disabled=!0))},this.checked=!1,this.disabled=!1,this.layout="icon-top",this.type="button",this.value="ion-sb-"+Qb++}valueChanged(){this.updateState()}connectedCallback(){const e=this.segmentEl=this.el.closest("ion-segment");e&&(this.updateState(),im(e,"ionSelect",this.updateState),im(e,"ionStyle",this.updateStyle))}disconnectedCallback(){const e=this.segmentEl;e&&(sm(e,"ionSelect",this.updateState),sm(e,"ionStyle",this.updateStyle),this.segmentEl=null)}componentWillLoad(){this.inheritedAttributes=Object.assign({},nm(this.el,["aria-label"]))}get hasLabel(){return!!this.el.querySelector("ion-label")}get hasIcon(){return!!this.el.querySelector("ion-icon")}async setFocus(){const{nativeEl:e}=this;void 0!==e&&e.focus()}render(){const{checked:e,type:t,disabled:n,hasIcon:r,hasLabel:a,layout:i,segmentEl:s}=this,o=xg(this);return Ph(zh,{class:{[o]:!0,"in-toolbar":Hg("ion-toolbar",this.el),"in-toolbar-color":Hg("ion-toolbar[color]",this.el),"in-segment":Hg("ion-segment",this.el),"in-segment-color":void 0!==(null==s?void 0:s.color),"segment-button-has-label":a,"segment-button-has-icon":r,"segment-button-has-label-only":a&&!r,"segment-button-has-icon-only":r&&!a,"segment-button-disabled":n,"segment-button-checked":e,[`segment-button-layout-${i}`]:!0,"ion-activatable":!0,"ion-activatable-instant":!0,"ion-focusable":!0}},Ph("button",Object.assign({"aria-selected":e?"true":"false",role:"tab",ref:e=>this.nativeEl=e,type:t,class:"button-native",part:"native",disabled:n},this.inheritedAttributes),Ph("span",{class:"button-inner"},Ph("slot",null)),"md"===o&&Ph("ion-ripple-effect",null)),Ph("div",{part:"indicator",class:{"segment-button-indicator":!0,"segment-button-indicator-animated":!0}},Ph("div",{part:"indicator-background",class:"segment-button-indicator-background"})))}get el(){return this}static get watchers(){return{value:["valueChanged"]}}static get style(){return{ios:':host{--color:initial;--color-hover:var(--color);--color-checked:var(--color);--color-disabled:var(--color);--padding-start:0;--padding-end:0;--padding-top:0;--padding-bottom:0;border-radius:var(--border-radius);display:-ms-flexbox;display:flex;position:relative;-ms-flex-direction:column;flex-direction:column;height:auto;background:var(--background);color:var(--color);text-decoration:none;text-overflow:ellipsis;white-space:nowrap;cursor:pointer;grid-row:1;-webkit-font-kerning:none;font-kerning:none}.button-native{border-radius:0;font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;-webkit-margin-start:var(--margin-start);margin-inline-start:var(--margin-start);-webkit-margin-end:var(--margin-end);margin-inline-end:var(--margin-end);margin-top:var(--margin-top);margin-bottom:var(--margin-bottom);-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);-webkit-transform:translate3d(0,  0,  0);transform:translate3d(0,  0,  0);display:-ms-flexbox;display:flex;position:relative;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-positive:1;flex-grow:1;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;min-width:inherit;max-width:inherit;height:auto;min-height:inherit;max-height:inherit;-webkit-transition:var(--transition);transition:var(--transition);border:none;outline:none;background:transparent;contain:content;pointer-events:none;overflow:hidden;z-index:2}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:inherit;flex-flow:inherit;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%;z-index:1}:host(.segment-button-checked){background:var(--background-checked);color:var(--color-checked)}:host(.segment-button-disabled){cursor:default;pointer-events:none}:host(.ion-focused) .button-native{color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}:host(:focus){outline:none}@media (any-hover: hover){:host(:hover) .button-native{color:var(--color-hover)}:host(:hover) .button-native::after{background:var(--background-hover);opacity:var(--background-hover-opacity)}:host(.segment-button-checked:hover) .button-native{color:var(--color-checked)}}::slotted(ion-icon){-ms-flex-negative:0;flex-shrink:0;-ms-flex-order:-1;order:-1;pointer-events:none}::slotted(ion-label){display:block;-ms-flex-item-align:center;align-self:center;max-width:100%;line-height:22px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box;pointer-events:none}:host(.segment-button-layout-icon-top) .button-native{-ms-flex-direction:column;flex-direction:column}:host(.segment-button-layout-icon-start) .button-native{-ms-flex-direction:row;flex-direction:row}:host(.segment-button-layout-icon-end) .button-native{-ms-flex-direction:row-reverse;flex-direction:row-reverse}:host(.segment-button-layout-icon-bottom) .button-native{-ms-flex-direction:column-reverse;flex-direction:column-reverse}:host(.segment-button-layout-icon-hide) ::slotted(ion-icon){display:none}:host(.segment-button-layout-label-hide) ::slotted(ion-label){display:none}ion-ripple-effect{color:var(--ripple-color, var(--color-checked))}.segment-button-indicator{-webkit-transform-origin:left;transform-origin:left;position:absolute;opacity:0;-webkit-box-sizing:border-box;box-sizing:border-box;will-change:transform, opacity;pointer-events:none}.segment-button-indicator-background{width:100%;height:var(--indicator-height);-webkit-transform:var(--indicator-transform);transform:var(--indicator-transform);-webkit-box-shadow:var(--indicator-box-shadow);box-shadow:var(--indicator-box-shadow);pointer-events:none}.segment-button-indicator-animated{-webkit-transition:var(--indicator-transition);transition:var(--indicator-transition)}:host(.segment-button-checked) .segment-button-indicator{opacity:1}@media (prefers-reduced-motion: reduce){.segment-button-indicator-background{-webkit-transform:none;transform:none}.segment-button-indicator-animated{-webkit-transition:none;transition:none}}:host{--background:none;--background-checked:none;--background-hover:none;--background-hover-opacity:0;--background-focused:none;--background-focused-opacity:0;--border-radius:7px;--border-width:1px;--border-color:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.12);--border-style:solid;--indicator-box-shadow:0 0 5px rgba(0, 0, 0, 0.16);--indicator-color:var(--ion-color-step-350, var(--ion-background-color, #fff));--indicator-height:100%;--indicator-transition:transform 260ms cubic-bezier(0.4, 0, 0.2, 1);--indicator-transform:none;--transition:100ms all linear;--padding-top:0;--padding-end:13px;--padding-bottom:0;--padding-start:13px;margin-top:2px;margin-bottom:2px;position:relative;-ms-flex-direction:row;flex-direction:row;min-width:70px;min-height:28px;-webkit-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);font-size:13px;font-weight:450;line-height:37px}:host::before{margin-left:0;margin-right:0;margin-top:5px;margin-bottom:5px;-webkit-transition:160ms opacity ease-in-out;transition:160ms opacity ease-in-out;-webkit-transition-delay:100ms;transition-delay:100ms;border-left:var(--border-width) var(--border-style) var(--border-color);content:"";opacity:1;will-change:opacity}:host(:first-of-type)::before{border-left-color:transparent}:host(.segment-button-disabled){opacity:0.3}::slotted(ion-icon){font-size:24px}:host(.segment-button-layout-icon-start) ::slotted(ion-label){-webkit-margin-start:2px;margin-inline-start:2px;-webkit-margin-end:0;margin-inline-end:0}:host(.segment-button-layout-icon-end) ::slotted(ion-label){-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:2px;margin-inline-end:2px}.segment-button-indicator{-webkit-padding-start:2px;padding-inline-start:2px;-webkit-padding-end:2px;padding-inline-end:2px;left:0;right:0;top:0;bottom:0}.segment-button-indicator-background{border-radius:var(--border-radius);background:var(--indicator-color)}.segment-button-indicator-background{-webkit-transition:var(--indicator-transition);transition:var(--indicator-transition)}:host(.segment-button-checked)::before,:host(.segment-button-after-checked)::before{opacity:0}:host(.segment-button-checked){z-index:-1}:host(.segment-button-activated){--indicator-transform:scale(0.95)}:host(.ion-focused) .button-native{opacity:0.7}@media (any-hover: hover){:host(:hover) .button-native{opacity:0.5}:host(.segment-button-checked:hover) .button-native{opacity:1}}:host(.in-segment-color){background:none;color:var(--ion-text-color, #000)}:host(.in-segment-color) .segment-button-indicator-background{background:var(--ion-color-step-350, var(--ion-background-color, #fff))}@media (any-hover: hover){:host(.in-segment-color:hover) .button-native,:host(.in-segment-color.segment-button-checked:hover) .button-native{color:var(--ion-text-color, #000)}}:host(.in-toolbar:not(.in-segment-color)){--background-checked:var(--ion-toolbar-segment-background-checked, none);--color:var(--ion-toolbar-segment-color, var(--ion-toolbar-color), initial);--color-checked:var(--ion-toolbar-segment-color-checked, var(--ion-toolbar-color), initial);--indicator-color:var(--ion-toolbar-segment-indicator-color, var(--ion-color-step-350, var(--ion-background-color, #fff)))}:host(.in-toolbar-color) .segment-button-indicator-background{background:var(--ion-color-contrast)}:host(.in-toolbar-color:not(.in-segment-color)) .button-native{color:var(--ion-color-contrast)}:host(.in-toolbar-color.segment-button-checked:not(.in-segment-color)) .button-native{color:var(--ion-color-base)}@media (any-hover: hover){:host(.in-toolbar-color:not(.in-segment-color):hover) .button-native{color:var(--ion-color-contrast)}:host(.in-toolbar-color.segment-button-checked:not(.in-segment-color):hover) .button-native{color:var(--ion-color-base)}}',md:':host{--color:initial;--color-hover:var(--color);--color-checked:var(--color);--color-disabled:var(--color);--padding-start:0;--padding-end:0;--padding-top:0;--padding-bottom:0;border-radius:var(--border-radius);display:-ms-flexbox;display:flex;position:relative;-ms-flex-direction:column;flex-direction:column;height:auto;background:var(--background);color:var(--color);text-decoration:none;text-overflow:ellipsis;white-space:nowrap;cursor:pointer;grid-row:1;-webkit-font-kerning:none;font-kerning:none}.button-native{border-radius:0;font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;-webkit-margin-start:var(--margin-start);margin-inline-start:var(--margin-start);-webkit-margin-end:var(--margin-end);margin-inline-end:var(--margin-end);margin-top:var(--margin-top);margin-bottom:var(--margin-bottom);-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);-webkit-transform:translate3d(0,  0,  0);transform:translate3d(0,  0,  0);display:-ms-flexbox;display:flex;position:relative;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-positive:1;flex-grow:1;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;min-width:inherit;max-width:inherit;height:auto;min-height:inherit;max-height:inherit;-webkit-transition:var(--transition);transition:var(--transition);border:none;outline:none;background:transparent;contain:content;pointer-events:none;overflow:hidden;z-index:2}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:inherit;flex-flow:inherit;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%;z-index:1}:host(.segment-button-checked){background:var(--background-checked);color:var(--color-checked)}:host(.segment-button-disabled){cursor:default;pointer-events:none}:host(.ion-focused) .button-native{color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}:host(:focus){outline:none}@media (any-hover: hover){:host(:hover) .button-native{color:var(--color-hover)}:host(:hover) .button-native::after{background:var(--background-hover);opacity:var(--background-hover-opacity)}:host(.segment-button-checked:hover) .button-native{color:var(--color-checked)}}::slotted(ion-icon){-ms-flex-negative:0;flex-shrink:0;-ms-flex-order:-1;order:-1;pointer-events:none}::slotted(ion-label){display:block;-ms-flex-item-align:center;align-self:center;max-width:100%;line-height:22px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box;pointer-events:none}:host(.segment-button-layout-icon-top) .button-native{-ms-flex-direction:column;flex-direction:column}:host(.segment-button-layout-icon-start) .button-native{-ms-flex-direction:row;flex-direction:row}:host(.segment-button-layout-icon-end) .button-native{-ms-flex-direction:row-reverse;flex-direction:row-reverse}:host(.segment-button-layout-icon-bottom) .button-native{-ms-flex-direction:column-reverse;flex-direction:column-reverse}:host(.segment-button-layout-icon-hide) ::slotted(ion-icon){display:none}:host(.segment-button-layout-label-hide) ::slotted(ion-label){display:none}ion-ripple-effect{color:var(--ripple-color, var(--color-checked))}.segment-button-indicator{-webkit-transform-origin:left;transform-origin:left;position:absolute;opacity:0;-webkit-box-sizing:border-box;box-sizing:border-box;will-change:transform, opacity;pointer-events:none}.segment-button-indicator-background{width:100%;height:var(--indicator-height);-webkit-transform:var(--indicator-transform);transform:var(--indicator-transform);-webkit-box-shadow:var(--indicator-box-shadow);box-shadow:var(--indicator-box-shadow);pointer-events:none}.segment-button-indicator-animated{-webkit-transition:var(--indicator-transition);transition:var(--indicator-transition)}:host(.segment-button-checked) .segment-button-indicator{opacity:1}@media (prefers-reduced-motion: reduce){.segment-button-indicator-background{-webkit-transform:none;transform:none}.segment-button-indicator-animated{-webkit-transition:none;transition:none}}:host{--background:none;--background-checked:none;--background-hover:var(--color-checked);--background-focused:var(--color-checked);--background-activated-opacity:0;--background-focused-opacity:.12;--background-hover-opacity:.04;--color:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.6);--color-checked:var(--ion-color-primary, #3880ff);--indicator-box-shadow:none;--indicator-color:var(--color-checked);--indicator-height:2px;--indicator-transition:transform 250ms cubic-bezier(0.4, 0, 0.2, 1);--indicator-transform:none;--padding-top:0;--padding-end:16px;--padding-bottom:0;--padding-start:16px;--transition:color 0.15s linear 0s, opacity 0.15s linear 0s;min-width:90px;min-height:48px;border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);font-size:14px;font-weight:500;letter-spacing:0.06em;line-height:40px;text-transform:uppercase}:host(.segment-button-disabled){opacity:0.3}:host(.in-segment-color){background:none;color:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.6)}:host(.in-segment-color) ion-ripple-effect{color:var(--ion-color-base)}:host(.in-segment-color) .segment-button-indicator-background{background:var(--ion-color-base)}:host(.in-segment-color.segment-button-checked) .button-native{color:var(--ion-color-base)}:host(.in-segment-color.ion-focused) .button-native::after{background:var(--ion-color-base)}@media (any-hover: hover){:host(.in-segment-color:hover) .button-native{color:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.6)}:host(.in-segment-color:hover) .button-native::after{background:var(--ion-color-base)}:host(.in-segment-color.segment-button-checked:hover) .button-native{color:var(--ion-color-base)}}:host(.in-toolbar:not(.in-segment-color)){--background:var(--ion-toolbar-segment-background, none);--background-checked:var(--ion-toolbar-segment-background-checked, none);--color:var(--ion-toolbar-segment-color, rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.6));--color-checked:var(--ion-toolbar-segment-color-checked, var(--ion-color-primary, #3880ff));--indicator-color:var(--ion-toolbar-segment-color-checked, var(--color-checked))}:host(.in-toolbar-color:not(.in-segment-color)) .button-native{color:rgba(var(--ion-color-contrast-rgb), 0.6)}:host(.in-toolbar-color.segment-button-checked:not(.in-segment-color)) .button-native{color:var(--ion-color-contrast)}@media (any-hover: hover){:host(.in-toolbar-color:not(.in-segment-color)) .button-native::after{background:var(--ion-color-contrast)}}::slotted(ion-icon){margin-top:12px;margin-bottom:12px;font-size:24px}::slotted(ion-label){margin-top:12px;margin-bottom:12px}:host(.segment-button-layout-icon-top) ::slotted(ion-label),:host(.segment-button-layout-icon-bottom) ::slotted(ion-icon){margin-top:0}:host(.segment-button-layout-icon-top) ::slotted(ion-icon),:host(.segment-button-layout-icon-bottom) ::slotted(ion-label){margin-bottom:0}:host(.segment-button-layout-icon-start) ::slotted(ion-label){-webkit-margin-start:8px;margin-inline-start:8px;-webkit-margin-end:0;margin-inline-end:0}:host(.segment-button-layout-icon-end) ::slotted(ion-label){-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:8px;margin-inline-end:8px}:host(.segment-button-has-icon-only) ::slotted(ion-icon){margin-top:12px;margin-bottom:12px}:host(.segment-button-has-label-only) ::slotted(ion-label){margin-top:12px;margin-bottom:12px}.segment-button-indicator{left:0;right:0;bottom:0}.segment-button-indicator-background{background:var(--indicator-color)}:host(.in-toolbar:not(.in-segment-color)) .segment-button-indicator-background{background:var(--ion-toolbar-segment-indicator-color, var(--indicator-color))}:host(.in-toolbar-color:not(.in-segment-color)) .segment-button-indicator-background{background:var(--ion-color-contrast)}'}}},[33,"ion-segment-button",{disabled:[1028],layout:[1],type:[1],value:[8],checked:[32],setFocus:[64]}]),ty=function(){"undefined"!=typeof customElements&&["ion-segment-button","ion-ripple-effect"].forEach((e=>{switch(e){case"ion-segment-button":customElements.get(e)||customElements.define(e,ey);break;case"ion-ripple-effect":customElements.get(e)||Qg()}}))},ny=function(){"undefined"!=typeof customElements&&["ion-spinner"].forEach((e=>{"ion-spinner"===e&&(customElements.get(e)||customElements.define(e,Bb))}))}
/*!
             * (C) Ionic http://ionicframework.com - MIT License
             */,ry=pb,ay="ionKeyboardDidShow",iy="ionKeyboardDidHide";let sy={},oy={},ly=!1;const uy=e=>{e.addEventListener("keyboardDidShow",(t=>dy(e,t))),e.addEventListener("keyboardDidHide",(()=>cy(e)))},dy=(e,t)=>{my(e,t),ly=!0},cy=e=>{gy(e),ly=!1},py=()=>{const e=(sy.height-oy.height)*oy.scale;return!ly&&sy.width===oy.width&&e>150},hy=e=>ly&&!fy(e),fy=e=>ly&&oy.height===e.innerHeight,my=(e,t)=>{const n=t?t.keyboardHeight:e.innerHeight-oy.height,r=new CustomEvent(ay,{detail:{keyboardHeight:n}});e.dispatchEvent(r)},gy=e=>{const t=new CustomEvent(iy);e.dispatchEvent(t)},by=e=>{sy=Object.assign({},oy),oy=yy(e.visualViewport)},yy=e=>({width:Math.round(e.width),height:Math.round(e.height),offsetTop:e.offsetTop,offsetLeft:e.offsetLeft,pageTop:e.pageTop,pageLeft:e.pageLeft,scale:e.scale}),vy=Object.freeze(Object.defineProperty({__proto__:null,KEYBOARD_DID_CLOSE:iy,KEYBOARD_DID_OPEN:ay,copyVisualViewport:yy,keyboardDidClose:fy,keyboardDidOpen:py,keyboardDidResize:hy,resetKeyboardAssist:()=>{sy={},oy={},ly=!1},setKeyboardClose:cy,setKeyboardOpen:dy,startKeyboardAssist:e=>{if(Ib.getEngine())uy(e);else{if(!e.visualViewport)return;oy=yy(e.visualViewport),e.visualViewport.onresize=()=>{by(e),py()||hy(e)?dy(e):fy(e)&&cy(e)}}},trackViewportChanges:by},Symbol.toStringTag,{value:"Module"}));
/*!
             * (C) Ionic http://ionicframework.com - MIT License
             */
var xy;!function(e){e.Dark="DARK",e.Light="LIGHT",e.Default="DEFAULT"}(xy||(xy={}));const wy={getEngine(){var e;return(null===(e=null==Zf?void 0:Zf.Capacitor)||void 0===e?void 0:e.isPluginAvailable("StatusBar"))&&(null==Zf?void 0:Zf.Capacitor.Plugins.StatusBar)},supportsDefaultStatusBarStyle(){var e;return!!(null===(e=null==Zf?void 0:Zf.Capacitor)||void 0===e?void 0:e.PluginHeaders)},setStyle(e){const t=this.getEngine();t&&t.setStyle(e)},getStyle:async function(){const e=this.getEngine();if(!e)return xy.Default;const{style:t}=await e.getInfo();return t}},ky=(e,t)=>{if(1===t)return 0;const n=1/(1-t);return e*n+-t*n},Sy=()=>{!Zf||Zf.innerWidth>=768||!wy.supportsDefaultStatusBarStyle()||wy.setStyle({style:xy.Dark})},Iy=(e=xy.Default)=>{!Zf||Zf.innerWidth>=768||!wy.supportsDefaultStatusBarStyle()||wy.setStyle({style:e})},Ny=async(e,t)=>{"function"==typeof e.canDismiss&&await e.canDismiss(void 0,Vg)&&(t.isRunning()?t.onFinish((()=>{e.dismiss(void 0,"handler")}),{oneTimeCallback:!0}):e.dismiss(void 0,"handler"))},Cy=e=>.00255275*2.71828**(-14.9619*e)-1.00255*2.71828**(-.0380968*e)+1,Ty=.93,Ey=(e,t,n,r)=>{const a=.5,i=e.offsetHeight;let s=!1,o=!1,l=null,u=null,d=!0,c=0;const p=Jm({el:e,gestureName:"modalSwipeToClose",gesturePriority:39,direction:"y",threshold:10,canStart:e=>{const t=e.event.target;if(null===t||!t.closest)return!0;if(l=xb(t),l){if(bb(l)){const e=om(l);u=e.querySelector(".inner-scroll")}else u=l;return!l.querySelector("ion-refresher")&&0===u.scrollTop}return null===t.closest("ion-footer")},onStart:n=>{const{deltaY:r}=n;d=!l||!bb(l)||l.scrollY,o=void 0!==e.canDismiss&&!0!==e.canDismiss,r>0&&l&&kb(l),t.progressStart(!0,s?1:0)},onMove:e=>{const{deltaY:r}=e;r>0&&l&&kb(l);const s=e.deltaY/i,u=s>=0&&o,d=u?.2:.9999,p=u?Cy(s/d):s,h=um(1e-4,p,d);t.progressStep(h),h>=a&&c<a?Iy(n):h<a&&c>=a&&Sy(),c=h},onEnd:n=>{const u=n.velocityY,c=n.deltaY/i,h=c>=0&&o,f=h?.2:.9999,m=h?Cy(c/f):c,g=um(1e-4,m,f),b=(n.deltaY+1e3*u)/i,y=!h&&b>=a;let v=y?-.001:.001;y?(t.easing("cubic-bezier(0.32, 0.72, 0, 1)"),v+=zm([0,0],[.32,.72],[0,1],[1,1],g)[0]):(t.easing("cubic-bezier(1, 0, 0.68, 0.28)"),v+=zm([0,0],[1,0],[.68,.28],[1,1],g)[0]);const x=_y(y?c*i:(1-g)*i,u);s=y,p.enable(!1),l&&((e,t)=>{bb(e)?e.scrollY=t:e.style.removeProperty("overflow")})(l,d),t.onFinish((()=>{y||p.enable(!0)})).progressEnd(y?1:0,v,x),h&&g>f/4?Ny(e,t):y&&r()}});return p},_y=(e,t)=>um(400,e/Math.abs(1.1*t),500),$y=e=>{const{currentBreakpoint:t,backdropBreakpoint:n}=e,r=void 0===n||n<t,a=r?`calc(var(--backdrop-opacity) * ${t})`:"0",i=vm("backdropAnimation").fromTo("opacity",0,a);return r&&i.beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]),{wrapperAnimation:vm("wrapperAnimation").keyframes([{offset:0,opacity:1,transform:"translateY(100%)"},{offset:1,opacity:1,transform:`translateY(${100-100*t}%)`}]),backdropAnimation:i}},Ay=e=>{const{currentBreakpoint:t,backdropBreakpoint:n}=e,r=`calc(var(--backdrop-opacity) * ${ky(t,n)})`,a=[{offset:0,opacity:r},{offset:1,opacity:0}],i=[{offset:0,opacity:r},{offset:n,opacity:0},{offset:1,opacity:0}],s=vm("backdropAnimation").keyframes(0!==n?i:a);return{wrapperAnimation:vm("wrapperAnimation").keyframes([{offset:0,opacity:1,transform:`translateY(${100-100*t}%)`},{offset:1,opacity:1,transform:"translateY(100%)"}]),backdropAnimation:s}},Ry=(e,t)=>{const{presentingEl:n,currentBreakpoint:r}=t,a=om(e),{wrapperAnimation:i,backdropAnimation:s}=void 0!==r?$y(t):{backdropAnimation:vm().fromTo("opacity",.01,"var(--backdrop-opacity)").beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]),wrapperAnimation:vm().fromTo("transform","translateY(100vh)","translateY(0vh)")};s.addElement(a.querySelector("ion-backdrop")),i.addElement(a.querySelectorAll(".modal-wrapper, .modal-shadow")).beforeStyles({opacity:1});const o=vm("entering-base").addElement(e).easing("cubic-bezier(0.32,0.72,0,1)").duration(500).addAnimation(i);if(n){const e=window.innerWidth<768,t="ION-MODAL"===n.tagName&&void 0!==n.presentingElement,r=om(n),a=vm().beforeStyles({transform:"translateY(0)","transform-origin":"top center",overflow:"hidden"}),l=document.body;if(e){const e=CSS.supports("width","max(0px, 1px)")?"max(30px, var(--ion-safe-area-top))":"30px",r=`translateY(${t?"-10px":e}) scale(${Ty})`;a.afterStyles({transform:r}).beforeAddWrite((()=>l.style.setProperty("background-color","black"))).addElement(n).keyframes([{offset:0,filter:"contrast(1)",transform:"translateY(0px) scale(1)",borderRadius:"0px"},{offset:1,filter:"contrast(0.85)",transform:r,borderRadius:"10px 10px 0 0"}]),o.addAnimation(a)}else if(o.addAnimation(s),t){const e=`translateY(-10px) scale(${t?Ty:1})`;a.afterStyles({transform:e}).addElement(r.querySelector(".modal-wrapper")).keyframes([{offset:0,filter:"contrast(1)",transform:"translateY(0) scale(1)"},{offset:1,filter:"contrast(0.85)",transform:e}]);const n=vm().afterStyles({transform:e}).addElement(r.querySelector(".modal-shadow")).keyframes([{offset:0,opacity:"1",transform:"translateY(0) scale(1)"},{offset:1,opacity:"0",transform:e}]);o.addAnimation([a,n])}else i.fromTo("opacity","0","1")}else o.addAnimation(s);return o},Dy=(e,t,n=500)=>{const{presentingEl:r,currentBreakpoint:a}=t,i=om(e),{wrapperAnimation:s,backdropAnimation:o}=void 0!==a?Ay(t):{backdropAnimation:vm().fromTo("opacity","var(--backdrop-opacity)",0),wrapperAnimation:vm().fromTo("transform","translateY(0vh)","translateY(100vh)")};o.addElement(i.querySelector("ion-backdrop")),s.addElement(i.querySelectorAll(".modal-wrapper, .modal-shadow")).beforeStyles({opacity:1});const l=vm("leaving-base").addElement(e).easing("cubic-bezier(0.32,0.72,0,1)").duration(n).addAnimation(s);if(r){const e=window.innerWidth<768,t="ION-MODAL"===r.tagName&&void 0!==r.presentingElement,n=om(r),a=vm().beforeClearStyles(["transform"]).afterClearStyles(["transform"]).onFinish((e=>{if(1!==e)return;r.style.setProperty("overflow","");const t=Array.from(i.querySelectorAll("ion-modal")).filter((e=>void 0!==e.presentingElement)).length;t<=1&&i.style.setProperty("background-color","")})),i=document.body;if(e){const e=CSS.supports("width","max(0px, 1px)")?"max(30px, var(--ion-safe-area-top))":"30px",n=`translateY(${t?"-10px":e}) scale(${Ty})`;a.addElement(r).keyframes([{offset:0,filter:"contrast(0.85)",transform:n,borderRadius:"10px 10px 0 0"},{offset:1,filter:"contrast(1)",transform:"translateY(0px) scale(1)",borderRadius:"0px"}]),l.addAnimation(a)}else if(l.addAnimation(o),t){const e=`translateY(-10px) scale(${t?Ty:1})`;a.addElement(n.querySelector(".modal-wrapper")).afterStyles({transform:"translate3d(0, 0, 0)"}).keyframes([{offset:0,filter:"contrast(0.85)",transform:e},{offset:1,filter:"contrast(1)",transform:"translateY(0) scale(1)"}]);const r=vm().addElement(n.querySelector(".modal-shadow")).afterStyles({transform:"translateY(0) scale(1)"}).keyframes([{offset:0,opacity:"0",transform:e},{offset:1,opacity:"1",transform:"translateY(0) scale(1)"}]);l.addAnimation([a,r])}else s.fromTo("opacity","1","0")}else l.addAnimation(o);return l},Fy=(e,t)=>{const{currentBreakpoint:n}=t,r=om(e),{wrapperAnimation:a,backdropAnimation:i}=void 0!==n?$y(t):{backdropAnimation:vm().fromTo("opacity",.01,"var(--backdrop-opacity)").beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]),wrapperAnimation:vm().keyframes([{offset:0,opacity:.01,transform:"translateY(40px)"},{offset:1,opacity:1,transform:"translateY(0px)"}])};return i.addElement(r.querySelector("ion-backdrop")),a.addElement(r.querySelector(".modal-wrapper")),vm().addElement(e).easing("cubic-bezier(0.36,0.66,0.04,1)").duration(280).addAnimation([i,a])},My=(e,t)=>{const{currentBreakpoint:n}=t,r=om(e),{wrapperAnimation:a,backdropAnimation:i}=void 0!==n?Ay(t):{backdropAnimation:vm().fromTo("opacity","var(--backdrop-opacity)",0),wrapperAnimation:vm().keyframes([{offset:0,opacity:.99,transform:"translateY(0px)"},{offset:1,opacity:0,transform:"translateY(40px)"}])};return i.addElement(r.querySelector("ion-backdrop")),a.addElement(r.querySelector(".modal-wrapper")),vm().easing("cubic-bezier(0.47,0,0.745,0.715)").duration(200).addAnimation([i,a])},Oy=Cf(class extends Bf{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.didPresent=Uh(this,"ionModalDidPresent",7),this.willPresent=Uh(this,"ionModalWillPresent",7),this.willDismiss=Uh(this,"ionModalWillDismiss",7),this.didDismiss=Uh(this,"ionModalDidDismiss",7),this.ionBreakpointDidChange=Uh(this,"ionBreakpointDidChange",7),this.didPresentShorthand=Uh(this,"didPresent",7),this.willPresentShorthand=Uh(this,"willPresent",7),this.willDismissShorthand=Uh(this,"willDismiss",7),this.didDismissShorthand=Uh(this,"didDismiss",7),this.ionMount=Uh(this,"ionMount",7),this.triggerController=(()=>{let e;const t=()=>{e&&(e(),e=void 0)};return{addClickListener:(n,r)=>{t();const a=void 0!==r?document.getElementById(r):null;a?e=((e,t)=>{const n=()=>{t.present()};return e.addEventListener("click",n),()=>{e.removeEventListener("click",n)}})(a,n):Ng(`A trigger element with the ID "${r}" was not found in the DOM. The trigger element must be in the DOM when the "trigger" property is set on an overlay component.`,n)},removeClickListener:t}})(),this.coreDelegate=(()=>{let e,t;return{attachViewToDom:async(n,r,a={},i=[])=>{var s,o;if(e=n,r){const t="string"==typeof r?null===(s=e.ownerDocument)||void 0===s?void 0:s.createElement(r):r;i.forEach((e=>t.classList.add(e))),Object.assign(t,a),e.appendChild(t),await new Promise((e=>em(t,e)))}else if(e.children.length>0&&("ION-MODAL"===e.tagName||"ION-POPOVER"===e.tagName)&&!e.children[0].classList.contains("ion-delegate-host")){const t=null===(o=e.ownerDocument)||void 0===o?void 0:o.createElement("div");t.classList.add("ion-delegate-host"),i.forEach((e=>t.classList.add(e))),t.append(...e.children),e.appendChild(t)}const l=document.querySelector("ion-app")||document.body;return t=document.createComment("ionic teleport"),e.parentNode.insertBefore(t,e),l.appendChild(e),e},removeViewFromDom:()=>(e&&t&&(t.parentNode.insertBefore(e,t),t.remove()),Promise.resolve())}})(),this.isSheetModal=!1,this.inheritedAttributes={},this.inline=!1,this.gestureAnimationDismissing=!1,this.onHandleClick=()=>{const{sheetTransition:e,handleBehavior:t}=this;"cycle"===t&&void 0===e&&this.moveToNextBreakpoint()},this.onBackdropTap=()=>{const{sheetTransition:e}=this;void 0===e&&this.dismiss(void 0,Wg)},this.onLifecycle=e=>{const t=this.usersElement,n=Py[e.type];if(t&&n){const r=new CustomEvent(n,{bubbles:!1,cancelable:!1,detail:e.detail});t.dispatchEvent(r)}},this.presented=!1,this.hasController=!1,this.overlayIndex=void 0,this.delegate=void 0,this.keyboardClose=!0,this.enterAnimation=void 0,this.leaveAnimation=void 0,this.breakpoints=void 0,this.initialBreakpoint=void 0,this.backdropBreakpoint=0,this.handle=void 0,this.handleBehavior="none",this.component=void 0,this.componentProps=void 0,this.cssClass=void 0,this.backdropDismiss=!0,this.showBackdrop=!0,this.animated=!0,this.presentingElement=void 0,this.htmlAttributes=void 0,this.isOpen=!1,this.trigger=void 0,this.keepContentsMounted=!1,this.canDismiss=!0}onIsOpenChange(e,t){!0===e&&!1===t?this.present():!1===e&&!0===t&&this.dismiss()}triggerChanged(){const{trigger:e,el:t,triggerController:n}=this;e&&n.addClickListener(t,e)}breakpointsChanged(e){void 0!==e&&(this.sortedBreakpoints=e.sort(((e,t)=>e-t)))}connectedCallback(){const{el:e}=this;(e=>{"undefined"!=typeof document&&Dg(document);const t=Cg++;e.overlayIndex=t})(e),this.triggerChanged()}disconnectedCallback(){this.triggerController.removeClickListener()}componentWillLoad(){const{breakpoints:e,initialBreakpoint:t,el:n}=this,r=this.isSheetModal=void 0!==e&&void 0!==t;this.inheritedAttributes=nm(n,["aria-label","role"]),r&&(this.currentBreakpoint=this.initialBreakpoint),void 0===e||void 0===t||e.includes(t)||Ng("Your breakpoints array must include the initialBreakpoint value."),(e=>{e.hasAttribute("id")||(e.id="ion-overlay-"+ ++Tg),e.id})(n)}componentDidLoad(){!0===this.isOpen&&lm((()=>this.present())),this.breakpointsChanged(this.breakpoints)}getDelegate(e=!1){if(this.workingDelegate&&!e)return{delegate:this.workingDelegate,inline:this.inline};const t=this.el.parentNode,n=this.inline=null!==t&&!this.hasController;return{inline:n,delegate:this.workingDelegate=n?this.delegate||this.coreDelegate:this.delegate}}async checkCanDismiss(e,t){const{canDismiss:n}=this;return"function"==typeof n?n(e,t):n}async present(){if(this.presented)return;const{presentingElement:e,el:t}=this;void 0!==this.currentTransition&&await this.currentTransition,this.currentBreakpoint=this.initialBreakpoint;const{inline:n,delegate:r}=this.getDelegate(!0);this.usersElement=await Sg(r,t,this.component,["ion-page"],this.componentProps,n),this.ionMount.emit(),tm(t)?await Om(this.usersElement):this.keepContentsMounted||await new Promise((e=>lm((()=>lm((()=>e())))))),Jf((()=>this.el.classList.add("show-modal"))),this.currentTransition=(async(e,t,n,r,a)=>{var i,s;if(e.presented)return;Mg(!0),e.presented=!0,e.willPresent.emit(),null===(i=e.willPresentShorthand)||void 0===i||i.emit();const o=xg(e),l=e.enterAnimation?e.enterAnimation:rg.get(t,"ios"===o?n:r);await Lg(e,l,e.el,a)&&(e.didPresent.emit(),null===(s=e.didPresentShorthand)||void 0===s||s.emit()),"ION-TOAST"!==e.el.tagName&&Og(e.el),!e.keyboardClose||null!==document.activeElement&&e.el.contains(document.activeElement)||e.el.focus()})(this,"modalEnter",Ry,Fy,{presentingEl:e,currentBreakpoint:this.initialBreakpoint,backdropBreakpoint:this.backdropBreakpoint}),"undefined"!=typeof window&&(this.keyboardOpenCallback=()=>{this.gesture&&(this.gesture.enable(!1),lm((()=>{this.gesture&&this.gesture.enable(!0)})))},window.addEventListener(ay,this.keyboardOpenCallback));const a=void 0!==e;a&&"ios"===xg(this)&&(this.statusBarStyle=await wy.getStyle(),Sy()),await this.currentTransition,this.isSheetModal?this.initSheetGesture():a&&this.initSwipeToClose(),this.currentTransition=void 0}initSwipeToClose(){var e;if("ios"!==xg(this))return;const{el:t}=this,n=this.leaveAnimation||rg.get("modalLeave",Dy),r=this.animation=n(t,{presentingEl:this.presentingElement});if(!vb(t))return void wb(t);const a=null!==(e=this.statusBarStyle)&&void 0!==e?e:xy.Default;this.gesture=Ey(t,r,a,(()=>{this.gestureAnimationDismissing=!0,this.animation.onFinish((async()=>{await this.dismiss(void 0,Vg),this.gestureAnimationDismissing=!1}))})),this.gesture.enable(!0)}initSheetGesture(){const{wrapperEl:e,initialBreakpoint:t,backdropBreakpoint:n}=this;if(!e||void 0===t)return;const r=this.enterAnimation||rg.get("modalEnter",Ry),a=this.animation=r(this.el,{presentingEl:this.presentingElement,currentBreakpoint:t,backdropBreakpoint:n});a.progressStart(!0,1);const{gesture:i,moveSheetToBreakpoint:s}=((e,t,n,r,a,i,s=[],o,l,u)=>{const d={WRAPPER_KEYFRAMES:[{offset:0,transform:"translateY(0%)"},{offset:1,transform:"translateY(100%)"}],BACKDROP_KEYFRAMES:0!==a?[{offset:0,opacity:"var(--backdrop-opacity)"},{offset:1-a,opacity:0},{offset:1,opacity:0}]:[{offset:0,opacity:"var(--backdrop-opacity)"},{offset:1,opacity:.01}]},c=e.querySelector("ion-content"),p=n.clientHeight;let h=r,f=0,m=!1;const g=i.childAnimations.find((e=>"wrapperAnimation"===e.id)),b=i.childAnimations.find((e=>"backdropAnimation"===e.id)),y=s[s.length-1],v=s[0],x=()=>{e.style.setProperty("pointer-events","auto"),t.style.setProperty("pointer-events","auto"),e.classList.remove("ion-disable-focus-trap")},w=()=>{e.style.setProperty("pointer-events","none"),t.style.setProperty("pointer-events","none"),e.classList.add("ion-disable-focus-trap")};g&&b&&(g.keyframes([...d.WRAPPER_KEYFRAMES]),b.keyframes([...d.BACKDROP_KEYFRAMES]),i.progressStart(!0,1-h),h>a?x():w()),c&&h!==y&&(c.scrollY=!1);const k=t=>{const{breakpoint:n,canDismiss:r,breakpointOffset:o}=t,p=r&&0===n,f=p?h:n,m=0!==f;return h=0,g&&b&&(g.keyframes([{offset:0,transform:`translateY(${100*o}%)`},{offset:1,transform:`translateY(${100*(1-f)}%)`}]),b.keyframes([{offset:0,opacity:`calc(var(--backdrop-opacity) * ${ky(1-o,a)})`},{offset:1,opacity:`calc(var(--backdrop-opacity) * ${ky(f,a)})`}]),i.progressStep(0)),S.enable(!1),p?Ny(e,i):m||l(),new Promise((e=>{i.onFinish((()=>{m?g&&b?lm((()=>{g.keyframes([...d.WRAPPER_KEYFRAMES]),b.keyframes([...d.BACKDROP_KEYFRAMES]),i.progressStart(!0,1-f),h=f,u(h),c&&h===s[s.length-1]&&(c.scrollY=!0),h>a?x():w(),S.enable(!0),e()})):(S.enable(!0),e()):e()}),{oneTimeCallback:!0}).progressEnd(1,0,500)}))},S=Jm({el:n,gestureName:"modalSheet",gesturePriority:40,direction:"y",threshold:10,canStart:e=>{const t=e.event.target.closest("ion-content");return h=o(),1!==h||!t},onStart:()=>{m=void 0!==e.canDismiss&&!0!==e.canDismiss&&0===v,c&&(c.scrollY=!1),lm((()=>{e.focus()})),i.progressStart(!0,1-h)},onMove:e=>{const t=1-h,n=s.length>1?1-s[1]:void 0,r=t+e.deltaY/p,a=void 0!==n&&r>=n&&m,o=a?.95:.9999,l=a&&void 0!==n?n+Cy((r-n)/(o-n)):r;f=um(1e-4,l,o),i.progressStep(f)},onEnd:e=>{const t=e.velocityY,n=(e.deltaY+350*t)/p,r=h-n,a=s.reduce(((e,t)=>Math.abs(t-r)<Math.abs(e-r)?t:e));k({breakpoint:a,breakpointOffset:f,canDismiss:m})}});return{gesture:S,moveSheetToBreakpoint:k}})(this.el,this.backdropEl,e,t,n,a,this.sortedBreakpoints,(()=>{var e;return null!==(e=this.currentBreakpoint)&&void 0!==e?e:0}),(()=>this.sheetOnDismiss()),(e=>{this.currentBreakpoint!==e&&(this.currentBreakpoint=e,this.ionBreakpointDidChange.emit({breakpoint:e}))}));this.gesture=i,this.moveSheetToBreakpoint=s,this.gesture.enable(!0)}sheetOnDismiss(){this.gestureAnimationDismissing=!0,this.animation.onFinish((async()=>{this.currentBreakpoint=0,this.ionBreakpointDidChange.emit({breakpoint:this.currentBreakpoint}),await this.dismiss(void 0,Vg),this.gestureAnimationDismissing=!1}))}async dismiss(e,t){var n;if(this.gestureAnimationDismissing&&t!==Vg)return!1;if("handler"!==t&&!(await this.checkCanDismiss(e,t)))return!1;const{presentingElement:r}=this;void 0!==r&&"ios"===xg(this)&&Iy(this.statusBarStyle),"undefined"!=typeof window&&this.keyboardOpenCallback&&(window.removeEventListener(ay,this.keyboardOpenCallback),this.keyboardOpenCallback=void 0),void 0!==this.currentTransition&&await this.currentTransition;const a=Eg.get(this)||[];this.currentTransition=(async(e,t,n,r,a,i,s)=>{var o,l;if(!e.presented)return!1;Mg(!1),e.presented=!1;try{e.el.style.setProperty("pointer-events","none"),e.willDismiss.emit({data:t,role:n}),null===(o=e.willDismissShorthand)||void 0===o||o.emit({data:t,role:n});const u=xg(e),d=e.leaveAnimation?e.leaveAnimation:rg.get(r,"ios"===u?a:i);n!==Vg&&await Lg(e,d,e.el,s),e.didDismiss.emit({data:t,role:n}),null===(l=e.didDismissShorthand)||void 0===l||l.emit({data:t,role:n}),Eg.delete(e),e.el.classList.add("overlay-hidden"),e.el.style.removeProperty("pointer-events"),void 0!==e.el.lastFocus&&(e.el.lastFocus=void 0)}catch(u){console.error(u)}return e.el.remove(),!0})(this,e,t,"modalLeave",Dy,My,{presentingEl:r,currentBreakpoint:null!==(n=this.currentBreakpoint)&&void 0!==n?n:this.initialBreakpoint,backdropBreakpoint:this.backdropBreakpoint});const i=await this.currentTransition;if(i){const{delegate:e}=this.getDelegate();await Ig(e,this.usersElement),Jf((()=>this.el.classList.remove("show-modal"))),this.animation&&this.animation.destroy(),this.gesture&&this.gesture.destroy(),a.forEach((e=>e.destroy()))}return this.currentBreakpoint=void 0,this.currentTransition=void 0,this.animation=void 0,i}onDidDismiss(){return zg(this.el,"ionModalDidDismiss")}onWillDismiss(){return zg(this.el,"ionModalWillDismiss")}async setCurrentBreakpoint(e){if(!this.isSheetModal)return void Ng("setCurrentBreakpoint is only supported on sheet modals.");if(!this.breakpoints.includes(e))return void Ng(`Attempted to set invalid breakpoint value ${e}. Please double check that the breakpoint value is part of your defined breakpoints.`);const{currentBreakpoint:t,moveSheetToBreakpoint:n,canDismiss:r,breakpoints:a}=this;t!==e&&n&&(this.sheetTransition=n({breakpoint:e,breakpointOffset:1-t,canDismiss:void 0!==r&&!0!==r&&0===a[0]}),await this.sheetTransition,this.sheetTransition=void 0)}async getCurrentBreakpoint(){return this.currentBreakpoint}async moveToNextBreakpoint(){const{breakpoints:e,currentBreakpoint:t}=this;if(!e||null==t)return!1;const n=e.filter((e=>0!==e)),r=n.indexOf(t),a=n[(r+1)%n.length];return await this.setCurrentBreakpoint(a),!0}render(){const{handle:e,isSheetModal:t,presentingElement:n,htmlAttributes:r,handleBehavior:a,inheritedAttributes:i}=this,s=!1!==e&&t,o=xg(this),l=void 0!==n&&"ios"===o,u="cycle"===a;return Ph(zh,Object.assign({"no-router":!0,tabindex:"-1"},r,{style:{zIndex:`${2e4+this.overlayIndex}`},class:Object.assign({[o]:!0,"modal-default":!l&&!t,"modal-card":l,"modal-sheet":t,"overlay-hidden":!0},qg(this.cssClass)),onIonBackdropTap:this.onBackdropTap,onIonModalDidPresent:this.onLifecycle,onIonModalWillPresent:this.onLifecycle,onIonModalWillDismiss:this.onLifecycle,onIonModalDidDismiss:this.onLifecycle}),Ph("ion-backdrop",{ref:e=>this.backdropEl=e,visible:this.showBackdrop,tappable:this.backdropDismiss,part:"backdrop"}),"ios"===o&&Ph("div",{class:"modal-shadow"}),Ph("div",Object.assign({role:"dialog"},i,{"aria-modal":"true",class:"modal-wrapper ion-overlay-wrapper",part:"content",ref:e=>this.wrapperEl=e}),s&&Ph("button",{class:"modal-handle",tabIndex:u?0:-1,"aria-label":"Activate to adjust the size of the dialog overlaying the screen",onClick:u?this.onHandleClick:void 0,part:"handle"}),Ph("slot",null)))}get el(){return this}static get watchers(){return{isOpen:["onIsOpenChange"],trigger:["triggerChanged"]}}static get style(){return{ios:':host{--width:100%;--min-width:auto;--max-width:auto;--height:100%;--min-height:auto;--max-height:auto;--overflow:hidden;--border-radius:0;--border-width:0;--border-style:none;--border-color:transparent;--background:var(--ion-background-color, #fff);--box-shadow:none;--backdrop-opacity:0;left:0;right:0;top:0;bottom:0;display:-ms-flexbox;display:flex;position:absolute;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;outline:none;color:var(--ion-text-color, #000);contain:strict}.modal-wrapper,ion-backdrop{pointer-events:auto}:host(.overlay-hidden){display:none}.modal-wrapper,.modal-shadow{border-radius:var(--border-radius);width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);background:var(--background);-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);overflow:var(--overflow);z-index:10}.modal-shadow{position:absolute;background:transparent}@media only screen and (min-width: 768px) and (min-height: 600px){:host{--width:600px;--height:500px;--ion-safe-area-top:0px;--ion-safe-area-bottom:0px;--ion-safe-area-right:0px;--ion-safe-area-left:0px}}@media only screen and (min-width: 768px) and (min-height: 768px){:host{--width:600px;--height:600px}}.modal-handle{left:0px;right:0px;top:5px;border-radius:8px;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;position:absolute;width:36px;height:5px;-webkit-transform:translateZ(0);transform:translateZ(0);border:0;background:var(--ion-color-step-350, #c0c0be);cursor:pointer;z-index:11}.modal-handle::before{-webkit-padding-start:4px;padding-inline-start:4px;-webkit-padding-end:4px;padding-inline-end:4px;padding-top:4px;padding-bottom:4px;position:absolute;width:36px;height:5px;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);content:""}:host(.modal-sheet){--height:calc(100% - (var(--ion-safe-area-top) + 10px))}:host(.modal-sheet) .modal-wrapper,:host(.modal-sheet) .modal-shadow{position:absolute;bottom:0}:host{--backdrop-opacity:var(--ion-backdrop-opacity, 0.4)}:host(.modal-card),:host(.modal-sheet){--border-radius:10px}@media only screen and (min-width: 768px) and (min-height: 600px){:host{--border-radius:10px}}.modal-wrapper{-webkit-transform:translate3d(0,  100%,  0);transform:translate3d(0,  100%,  0)}@media screen and (max-width: 767px){@supports (width: max(0px, 1px)){:host(.modal-card){--height:calc(100% - max(30px, var(--ion-safe-area-top)) - 10px)}}@supports not (width: max(0px, 1px)){:host(.modal-card){--height:calc(100% - 40px)}}:host(.modal-card) .modal-wrapper{border-top-left-radius:var(--border-radius);border-top-right-radius:var(--border-radius);border-bottom-right-radius:0;border-bottom-left-radius:0}:host-context([dir=rtl]):host(.modal-card) .modal-wrapper,:host-context([dir=rtl]).modal-card .modal-wrapper{border-top-left-radius:var(--border-radius);border-top-right-radius:var(--border-radius);border-bottom-right-radius:0;border-bottom-left-radius:0}@supports selector(:dir(rtl)){:host(.modal-card) .modal-wrapper:dir(rtl){border-top-left-radius:var(--border-radius);border-top-right-radius:var(--border-radius);border-bottom-right-radius:0;border-bottom-left-radius:0}}:host(.modal-card){--backdrop-opacity:0;--width:100%;-ms-flex-align:end;align-items:flex-end}:host(.modal-card) .modal-shadow{display:none}:host(.modal-card) ion-backdrop{pointer-events:none}}@media screen and (min-width: 768px){:host(.modal-card){--width:calc(100% - 120px);--height:calc(100% - (120px + var(--ion-safe-area-top) + var(--ion-safe-area-bottom)));--max-width:720px;--max-height:1000px;--backdrop-opacity:0;--box-shadow:0px 0px 30px 10px rgba(0, 0, 0, 0.1);-webkit-transition:all 0.5s ease-in-out;transition:all 0.5s ease-in-out}:host(.modal-card) .modal-wrapper{-webkit-box-shadow:none;box-shadow:none}:host(.modal-card) .modal-shadow{-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow)}}:host(.modal-sheet) .modal-wrapper{border-top-left-radius:var(--border-radius);border-top-right-radius:var(--border-radius);border-bottom-right-radius:0;border-bottom-left-radius:0}:host-context([dir=rtl]):host(.modal-sheet) .modal-wrapper,:host-context([dir=rtl]).modal-sheet .modal-wrapper{border-top-left-radius:var(--border-radius);border-top-right-radius:var(--border-radius);border-bottom-right-radius:0;border-bottom-left-radius:0}@supports selector(:dir(rtl)){:host(.modal-sheet) .modal-wrapper:dir(rtl){border-top-left-radius:var(--border-radius);border-top-right-radius:var(--border-radius);border-bottom-right-radius:0;border-bottom-left-radius:0}}',md:':host{--width:100%;--min-width:auto;--max-width:auto;--height:100%;--min-height:auto;--max-height:auto;--overflow:hidden;--border-radius:0;--border-width:0;--border-style:none;--border-color:transparent;--background:var(--ion-background-color, #fff);--box-shadow:none;--backdrop-opacity:0;left:0;right:0;top:0;bottom:0;display:-ms-flexbox;display:flex;position:absolute;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;outline:none;color:var(--ion-text-color, #000);contain:strict}.modal-wrapper,ion-backdrop{pointer-events:auto}:host(.overlay-hidden){display:none}.modal-wrapper,.modal-shadow{border-radius:var(--border-radius);width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);background:var(--background);-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);overflow:var(--overflow);z-index:10}.modal-shadow{position:absolute;background:transparent}@media only screen and (min-width: 768px) and (min-height: 600px){:host{--width:600px;--height:500px;--ion-safe-area-top:0px;--ion-safe-area-bottom:0px;--ion-safe-area-right:0px;--ion-safe-area-left:0px}}@media only screen and (min-width: 768px) and (min-height: 768px){:host{--width:600px;--height:600px}}.modal-handle{left:0px;right:0px;top:5px;border-radius:8px;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;position:absolute;width:36px;height:5px;-webkit-transform:translateZ(0);transform:translateZ(0);border:0;background:var(--ion-color-step-350, #c0c0be);cursor:pointer;z-index:11}.modal-handle::before{-webkit-padding-start:4px;padding-inline-start:4px;-webkit-padding-end:4px;padding-inline-end:4px;padding-top:4px;padding-bottom:4px;position:absolute;width:36px;height:5px;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);content:""}:host(.modal-sheet){--height:calc(100% - (var(--ion-safe-area-top) + 10px))}:host(.modal-sheet) .modal-wrapper,:host(.modal-sheet) .modal-shadow{position:absolute;bottom:0}:host{--backdrop-opacity:var(--ion-backdrop-opacity, 0.32)}@media only screen and (min-width: 768px) and (min-height: 600px){:host{--border-radius:2px;--box-shadow:0 28px 48px rgba(0, 0, 0, 0.4)}}.modal-wrapper{-webkit-transform:translate3d(0,  40px,  0);transform:translate3d(0,  40px,  0);opacity:0.01}'}}},[33,"ion-modal",{hasController:[4,"has-controller"],overlayIndex:[2,"overlay-index"],delegate:[16],keyboardClose:[4,"keyboard-close"],enterAnimation:[16],leaveAnimation:[16],breakpoints:[16],initialBreakpoint:[2,"initial-breakpoint"],backdropBreakpoint:[2,"backdrop-breakpoint"],handle:[4],handleBehavior:[1,"handle-behavior"],component:[1],componentProps:[16],cssClass:[1,"css-class"],backdropDismiss:[4,"backdrop-dismiss"],showBackdrop:[4,"show-backdrop"],animated:[4],presentingElement:[16],htmlAttributes:[16],isOpen:[4,"is-open"],trigger:[1],keepContentsMounted:[4,"keep-contents-mounted"],canDismiss:[4,"can-dismiss"],presented:[32],present:[64],dismiss:[64],onDidDismiss:[64],onWillDismiss:[64],setCurrentBreakpoint:[64],getCurrentBreakpoint:[64]}]),Py={ionModalDidPresent:"ionViewDidEnter",ionModalWillPresent:"ionViewWillEnter",ionModalWillDismiss:"ionViewWillLeave",ionModalDidDismiss:"ionViewDidLeave"},Ly=function(){"undefined"!=typeof customElements&&["ion-modal","ion-backdrop"].forEach((e=>{switch(e){case"ion-modal":customElements.get(e)||customElements.define(e,Oy);break;case"ion-backdrop":customElements.get(e)||"undefined"!=typeof customElements&&["ion-backdrop"].forEach((e=>{"ion-backdrop"===e&&(customElements.get(e)||customElements.define(e,jg))}))}}))},zy=Cf(class extends Bf{constructor(){super(),this.__registerHost()}componentDidLoad(){Wy((async()=>{const e=og(window,"hybrid");if(rg.getBoolean("_testing")||yh((()=>t.import("./index9-legacy-34b8680a.js"))).then((e=>e.startTapClick(rg))),rg.getBoolean("statusTap",e)&&yh((()=>t.import("./status-tap-legacy-1172ff32.js"))).then((e=>e.startStatusTap())),rg.getBoolean("inputShims",By())){const e=og(window,"ios")?"ios":"android";yh((()=>t.import("./input-shims-legacy-9714b95a.js"))).then((t=>t.startInputShims(rg,e)))}const n=await yh((()=>Promise.resolve().then((()=>kg))));rg.getBoolean("hardwareBackButton",e)?n.startHardwareBackButton():n.blockHardwareBackButton(),"undefined"!=typeof window&&yh((()=>Promise.resolve().then((()=>vy)))).then((e=>e.startKeyboardAssist(window))),yh((()=>t.import("./focus-visible-legacy-b3e947fe.js"))).then((e=>this.focusVisible=e.startFocusVisible()))}))}async setFocus(e){this.focusVisible&&this.focusVisible.setFocus(e)}render(){const e=xg(this);return Ph(zh,{class:{[e]:!0,"ion-page":!0,"force-statusbar-padding":rg.getBoolean("_forceStatusbarPadding")}})}get el(){return this}static get style(){return"html.plt-mobile ion-app{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}html.plt-mobile ion-app [contenteditable]{-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}ion-app.force-statusbar-padding{--ion-safe-area-top:20px}"}},[0,"ion-app",{setFocus:[64]}]),By=()=>!(!og(window,"ios")||!og(window,"mobile"))||!(!og(window,"android")||!og(window,"mobileweb")),Wy=e=>{"requestIdleCallback"in window?window.requestIdleCallback(e):setTimeout(e,32)},Vy=function(){"undefined"!=typeof customElements&&["ion-app"].forEach((e=>{"ion-app"===e&&(customElements.get(e)||customElements.define(e,zy))}))},Uy=Cf(class extends Bf{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.ionNavWillLoad=Uh(this,"ionNavWillLoad",7),this.ionNavWillChange=Uh(this,"ionNavWillChange",3),this.ionNavDidChange=Uh(this,"ionNavDidChange",3),this.gestureOrAnimationInProgress=!1,this.mode=xg(this),this.delegate=void 0,this.animated=!0,this.animation=void 0,this.swipeHandler=void 0}swipeHandlerChanged(){this.gesture&&this.gesture.enable(void 0!==this.swipeHandler)}async connectedCallback(){const e=()=>{this.gestureOrAnimationInProgress=!0,this.swipeHandler&&this.swipeHandler.onStart()};this.gesture=(await yh((()=>t.import("./swipe-back-legacy-d992cfa5.js")))).createSwipeBackGesture(this.el,(()=>!this.gestureOrAnimationInProgress&&!!this.swipeHandler&&this.swipeHandler.canStart()),(()=>e()),(e=>{var t;return null===(t=this.ani)||void 0===t?void 0:t.progressStep(e)}),((e,t,n)=>{if(this.ani){this.ani.onFinish((()=>{this.gestureOrAnimationInProgress=!1,this.swipeHandler&&this.swipeHandler.onEnd(e)}),{oneTimeCallback:!0});let r=e?-.001:.001;e?r+=zm([0,0],[.32,.72],[0,1],[1,1],t)[0]:(this.ani.easing("cubic-bezier(1, 0, 0.68, 0.28)"),r+=zm([0,0],[1,0],[.68,.28],[1,1],t)[0]),this.ani.progressEnd(e?1:0,r,n)}else this.gestureOrAnimationInProgress=!1})),this.swipeHandlerChanged()}componentWillLoad(){this.ionNavWillLoad.emit()}disconnectedCallback(){this.gesture&&(this.gesture.destroy(),this.gesture=void 0)}async commit(e,t,n){const r=await this.lock();let a=!1;try{a=await this.transition(e,t,n)}catch(kp){console.error(kp)}return r(),a}async setRouteId(e,t,n,r){return{changed:await this.setRoot(e,t,{duration:"root"===n?0:void 0,direction:"back"===n?"back":"forward",animationBuilder:r}),element:this.activeEl}}async getRouteId(){const e=this.activeEl;return e?{id:e.tagName,element:e,params:this.activeParams}:void 0}async setRoot(e,t,n){if(this.activeComponent===e&&cm(t,this.activeParams))return!1;const r=this.activeEl,a=await Sg(this.delegate,this.el,e,["ion-page","ion-page-invisible"],t);return this.activeComponent=e,this.activeEl=a,this.activeParams=t,await this.commit(a,r,n),await Ig(this.delegate,r),!0}async transition(e,t,n={}){if(t===e)return!1;this.ionNavWillChange.emit();const{el:r,mode:a}=this,i=this.animated&&rg.getBoolean("animated",!0),s=n.animationBuilder||this.animation||rg.get("navAnimation");return await Sm(Object.assign(Object.assign({mode:a,animated:i,enteringEl:e,leavingEl:t,baseEl:r,deepWait:tm(r),progressCallback:n.progressAnimation?e=>{void 0===e||this.gestureOrAnimationInProgress?this.ani=e:(this.gestureOrAnimationInProgress=!0,e.onFinish((()=>{this.gestureOrAnimationInProgress=!1,this.swipeHandler&&this.swipeHandler.onEnd(!1)}),{oneTimeCallback:!0}),e.progressEnd(0,0,0))}:void 0},n),{animationBuilder:s})),this.ionNavDidChange.emit(),!0}async lock(){const e=this.waitPromise;let t;return this.waitPromise=new Promise((e=>t=e)),void 0!==e&&await e,t}render(){return Ph("slot",null)}get el(){return this}static get watchers(){return{swipeHandler:["swipeHandlerChanged"]}}static get style(){return":host{left:0;right:0;top:0;bottom:0;position:absolute;contain:layout size style;overflow:hidden;z-index:0}"}},[1,"ion-router-outlet",{mode:[1025],delegate:[16],animated:[4],animation:[16],swipeHandler:[16],commit:[64],setRouteId:[64],getRouteId:[64]}]),jy=function(){"undefined"!=typeof customElements&&["ion-router-outlet"].forEach((e=>{"ion-router-outlet"===e&&(customElements.get(e)||customElements.define(e,Uy))}))},Hy=Cf(class extends Bf{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.ionTabBarChanged=Uh(this,"ionTabBarChanged",7),this.keyboardCtrl=null,this.keyboardVisible=!1,this.color=void 0,this.selectedTab=void 0,this.translucent=!1}selectedTabChanged(){void 0!==this.selectedTab&&this.ionTabBarChanged.emit({tab:this.selectedTab})}componentWillLoad(){this.selectedTabChanged()}async connectedCallback(){this.keyboardCtrl=await(async e=>{let t,n,r,a;const i=async()=>{const e=await Ib.getResizeMode(),i=void 0===e?void 0:e.mode;t=()=>{void 0===a&&(a=Cb(i)),r=!0,s(r,i)},n=()=>{r=!1,s(r,i)},null==Zf||Zf.addEventListener("keyboardWillShow",t),null==Zf||Zf.addEventListener("keyboardWillHide",n)},s=(t,n)=>{e&&e(t,o(n))},o=e=>{if(0===a||a===Cb(e))return;const t=Nb(e);return null!==t?new Promise((e=>{const n=new ResizeObserver((()=>{t.clientHeight===a&&(n.disconnect(),e())}));n.observe(t)})):void 0};return await i(),{init:i,destroy:()=>{null==Zf||Zf.removeEventListener("keyboardWillShow",t),null==Zf||Zf.removeEventListener("keyboardWillHide",n),t=n=void 0},isKeyboardVisible:()=>r}})((async(e,t)=>{!1===e&&void 0!==t&&await t,this.keyboardVisible=e}))}disconnectedCallback(){this.keyboardCtrl&&this.keyboardCtrl.destroy()}render(){const{color:e,translucent:t,keyboardVisible:n}=this,r=xg(this),a=n&&"top"!==this.el.getAttribute("slot");return Ph(zh,{role:"tablist","aria-hidden":a?"true":null,class:Gg(e,{[r]:!0,"tab-bar-translucent":t,"tab-bar-hidden":a})},Ph("slot",null))}get el(){return this}static get watchers(){return{selectedTab:["selectedTabChanged"]}}static get style(){return{ios:":host{-webkit-padding-start:var(--ion-safe-area-left);padding-inline-start:var(--ion-safe-area-left);-webkit-padding-end:var(--ion-safe-area-right);padding-inline-end:var(--ion-safe-area-right);display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:auto;padding-bottom:var(--ion-safe-area-bottom, 0);border-top:var(--border);background:var(--background);color:var(--color);text-align:center;contain:strict;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:10;-webkit-box-sizing:content-box !important;box-sizing:content-box !important}:host(.ion-color) ::slotted(ion-tab-button){--background-focused:var(--ion-color-shade);--color-selected:var(--ion-color-contrast)}:host(.ion-color) ::slotted(.tab-selected){color:var(--ion-color-contrast)}:host(.ion-color),:host(.ion-color) ::slotted(ion-tab-button){color:rgba(var(--ion-color-contrast-rgb), 0.7)}:host(.ion-color),:host(.ion-color) ::slotted(ion-tab-button){background:var(--ion-color-base)}:host(.ion-color) ::slotted(ion-tab-button.ion-focused),:host(.tab-bar-translucent) ::slotted(ion-tab-button.ion-focused){background:var(--background-focused)}:host(.tab-bar-translucent) ::slotted(ion-tab-button){background:transparent}:host([slot=top]){padding-top:var(--ion-safe-area-top, 0);padding-bottom:0;border-top:0;border-bottom:var(--border)}:host(.tab-bar-hidden){display:none !important}:host{--background:var(--ion-tab-bar-background, var(--ion-color-step-50, #f7f7f7));--background-focused:var(--ion-tab-bar-background-focused, #e0e0e0);--border:0.55px solid var(--ion-tab-bar-border-color, var(--ion-border-color, var(--ion-color-step-150, rgba(0, 0, 0, 0.2))));--color:var(--ion-tab-bar-color, var(--ion-color-step-600, #666666));--color-selected:var(--ion-tab-bar-color-selected, var(--ion-color-primary, #3880ff));height:50px}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){:host(.tab-bar-translucent){--background:rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.8);-webkit-backdrop-filter:saturate(210%) blur(20px);backdrop-filter:saturate(210%) blur(20px)}:host(.ion-color.tab-bar-translucent){background:rgba(var(--ion-color-base-rgb), 0.8)}:host(.tab-bar-translucent) ::slotted(ion-tab-button.ion-focused){background:rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.6)}}",md:":host{-webkit-padding-start:var(--ion-safe-area-left);padding-inline-start:var(--ion-safe-area-left);-webkit-padding-end:var(--ion-safe-area-right);padding-inline-end:var(--ion-safe-area-right);display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:auto;padding-bottom:var(--ion-safe-area-bottom, 0);border-top:var(--border);background:var(--background);color:var(--color);text-align:center;contain:strict;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:10;-webkit-box-sizing:content-box !important;box-sizing:content-box !important}:host(.ion-color) ::slotted(ion-tab-button){--background-focused:var(--ion-color-shade);--color-selected:var(--ion-color-contrast)}:host(.ion-color) ::slotted(.tab-selected){color:var(--ion-color-contrast)}:host(.ion-color),:host(.ion-color) ::slotted(ion-tab-button){color:rgba(var(--ion-color-contrast-rgb), 0.7)}:host(.ion-color),:host(.ion-color) ::slotted(ion-tab-button){background:var(--ion-color-base)}:host(.ion-color) ::slotted(ion-tab-button.ion-focused),:host(.tab-bar-translucent) ::slotted(ion-tab-button.ion-focused){background:var(--background-focused)}:host(.tab-bar-translucent) ::slotted(ion-tab-button){background:transparent}:host([slot=top]){padding-top:var(--ion-safe-area-top, 0);padding-bottom:0;border-top:0;border-bottom:var(--border)}:host(.tab-bar-hidden){display:none !important}:host{--background:var(--ion-tab-bar-background, var(--ion-background-color, #fff));--background-focused:var(--ion-tab-bar-background-focused, #e0e0e0);--border:1px solid var(--ion-tab-bar-border-color, var(--ion-border-color, var(--ion-color-step-150, rgba(0, 0, 0, 0.07))));--color:var(--ion-tab-bar-color, var(--ion-color-step-650, #595959));--color-selected:var(--ion-tab-bar-color-selected, var(--ion-color-primary, #3880ff));height:56px}"}}},[33,"ion-tab-bar",{color:[513],selectedTab:[1,"selected-tab"],translucent:[4],keyboardVisible:[32]}]),Gy=function(){"undefined"!=typeof customElements&&["ion-tab-bar"].forEach((e=>{"ion-tab-bar"===e&&(customElements.get(e)||customElements.define(e,Hy))}))},qy=Cf(class extends Bf{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.ionTabButtonClick=Uh(this,"ionTabButtonClick",7),this.inheritedAttributes={},this.onKeyUp=e=>{"Enter"!==e.key&&" "!==e.key||this.selectTab(e)},this.onClick=e=>{this.selectTab(e)},this.disabled=!1,this.download=void 0,this.href=void 0,this.rel=void 0,this.layout=void 0,this.selected=!1,this.tab=void 0,this.target=void 0}onTabBarChanged(e){const t=e.target,n=this.el.parentElement;(e.composedPath().includes(n)||(null==t?void 0:t.contains(this.el)))&&(this.selected=this.tab===e.detail.tab)}componentWillLoad(){this.inheritedAttributes=Object.assign({},nm(this.el,["aria-label"])),void 0===this.layout&&(this.layout=rg.get("tabButtonLayout","icon-top"))}selectTab(e){void 0!==this.tab&&(this.disabled||this.ionTabButtonClick.emit({tab:this.tab,href:this.href,selected:this.selected}),e.preventDefault())}get hasLabel(){return!!this.el.querySelector("ion-label")}get hasIcon(){return!!this.el.querySelector("ion-icon")}render(){const{disabled:e,hasIcon:t,hasLabel:n,href:r,rel:a,target:i,layout:s,selected:o,tab:l,inheritedAttributes:u}=this,d=xg(this),c={download:this.download,href:r,rel:a,target:i};return Ph(zh,{onClick:this.onClick,onKeyup:this.onKeyUp,id:void 0!==l?`tab-button-${l}`:null,class:{[d]:!0,"tab-selected":o,"tab-disabled":e,"tab-has-label":n,"tab-has-icon":t,"tab-has-label-only":n&&!t,"tab-has-icon-only":t&&!n,[`tab-layout-${s}`]:!0,"ion-activatable":!0,"ion-selectable":!0,"ion-focusable":!0}},Ph("a",Object.assign({},c,{class:"button-native",part:"native",role:"tab","aria-selected":o?"true":null,"aria-disabled":e?"true":null,tabindex:e?"-1":void 0},u),Ph("span",{class:"button-inner"},Ph("slot",null)),"md"===d&&Ph("ion-ripple-effect",{type:"unbounded"})))}get el(){return this}static get style(){return{ios:':host{--ripple-color:var(--color-selected);--background-focused-opacity:1;-ms-flex:1;flex:1;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%;outline:none;background:var(--background);color:var(--color)}.button-native{border-radius:inherit;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:-ms-flexbox;display:flex;position:relative;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:100%;height:100%;border:0;outline:none;background:transparent;text-decoration:none;cursor:pointer;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-user-drag:none}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:inherit;flex-flow:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:100%;height:100%;z-index:1}:host(.ion-focused) .button-native{color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}@media (any-hover: hover){a:hover{color:var(--color-selected)}}:host(.tab-selected){color:var(--color-selected)}:host(.tab-hidden){display:none !important}:host(.tab-disabled){pointer-events:none;opacity:0.4}::slotted(ion-label),::slotted(ion-icon){display:block;-ms-flex-item-align:center;align-self:center;max-width:100%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box}::slotted(ion-label){-ms-flex-order:0;order:0}::slotted(ion-icon){-ms-flex-order:-1;order:-1;height:1em}:host(.tab-has-label-only) ::slotted(ion-label){white-space:normal}::slotted(ion-badge){-webkit-box-sizing:border-box;box-sizing:border-box;position:absolute;z-index:1}:host(.tab-layout-icon-start){-ms-flex-direction:row;flex-direction:row}:host(.tab-layout-icon-end){-ms-flex-direction:row-reverse;flex-direction:row-reverse}:host(.tab-layout-icon-bottom){-ms-flex-direction:column-reverse;flex-direction:column-reverse}:host(.tab-layout-icon-hide) ::slotted(ion-icon){display:none}:host(.tab-layout-label-hide) ::slotted(ion-label){display:none}ion-ripple-effect{color:var(--ripple-color)}:host{--padding-top:0;--padding-end:2px;--padding-bottom:0;--padding-start:2px;max-width:240px;font-size:10px}::slotted(ion-badge){-webkit-padding-start:6px;padding-inline-start:6px;-webkit-padding-end:6px;padding-inline-end:6px;padding-top:1px;padding-bottom:1px;top:4px;height:auto;font-size:12px;line-height:16px}@supports (inset-inline-start: 0){::slotted(ion-badge){inset-inline-start:calc(50% + 6px)}}@supports not (inset-inline-start: 0){::slotted(ion-badge){left:calc(50% + 6px)}:host-context([dir=rtl]) ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 6px)}[dir=rtl] ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 6px)}@supports selector(:dir(rtl)){::slotted(ion-badge):dir(rtl){left:unset;right:unset;right:calc(50% + 6px)}}}::slotted(ion-icon){margin-top:2px;margin-bottom:2px;font-size:30px}::slotted(ion-icon::before){vertical-align:top}::slotted(ion-label){margin-top:0;margin-bottom:1px;min-height:11px;font-weight:500}:host(.tab-has-label-only) ::slotted(ion-label){margin-left:0;margin-right:0;margin-top:2px;margin-bottom:2px;font-size:12px;font-size:14px;line-height:1.1}:host(.tab-layout-icon-end) ::slotted(ion-label),:host(.tab-layout-icon-start) ::slotted(ion-label),:host(.tab-layout-icon-hide) ::slotted(ion-label){margin-top:2px;margin-bottom:2px;font-size:14px;line-height:1.1}:host(.tab-layout-icon-end) ::slotted(ion-icon),:host(.tab-layout-icon-start) ::slotted(ion-icon){min-width:24px;height:26px;margin-top:2px;margin-bottom:1px;font-size:24px}@supports (inset-inline-start: 0){:host(.tab-layout-icon-bottom) ::slotted(ion-badge){inset-inline-start:calc(50% + 12px)}}@supports not (inset-inline-start: 0){:host(.tab-layout-icon-bottom) ::slotted(ion-badge){left:calc(50% + 12px)}:host-context([dir=rtl]):host(.tab-layout-icon-bottom) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-bottom ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 12px)}@supports selector(:dir(rtl)){:host(.tab-layout-icon-bottom) ::slotted(ion-badge):dir(rtl){left:unset;right:unset;right:calc(50% + 12px)}}}:host(.tab-layout-icon-bottom) ::slotted(ion-icon){margin-top:0;margin-bottom:1px}:host(.tab-layout-icon-bottom) ::slotted(ion-label){margin-top:4px}:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){top:10px}@supports (inset-inline-start: 0){:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){inset-inline-start:calc(50% + 35px)}}@supports not (inset-inline-start: 0){:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){left:calc(50% + 35px)}:host-context([dir=rtl]):host(.tab-layout-icon-start) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-start ::slotted(ion-badge),:host-context([dir=rtl]):host(.tab-layout-icon-end) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-end ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 35px)}@supports selector(:dir(rtl)){:host(.tab-layout-icon-start) ::slotted(ion-badge):dir(rtl),:host(.tab-layout-icon-end) ::slotted(ion-badge):dir(rtl){left:unset;right:unset;right:calc(50% + 35px)}}}:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){top:10px}@supports (inset-inline-start: 0){:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){inset-inline-start:calc(50% + 30px)}}@supports not (inset-inline-start: 0){:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){left:calc(50% + 30px)}:host-context([dir=rtl]):host(.tab-layout-icon-hide) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-hide ::slotted(ion-badge),:host-context([dir=rtl]):host(.tab-has-label-only) ::slotted(ion-badge),:host-context([dir=rtl]).tab-has-label-only ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 30px)}@supports selector(:dir(rtl)){:host(.tab-layout-icon-hide) ::slotted(ion-badge):dir(rtl),:host(.tab-has-label-only) ::slotted(ion-badge):dir(rtl){left:unset;right:unset;right:calc(50% + 30px)}}}:host(.tab-layout-label-hide) ::slotted(ion-badge),:host(.tab-has-icon-only) ::slotted(ion-badge){top:10px}:host(.tab-layout-label-hide) ::slotted(ion-icon){margin-left:0;margin-right:0;margin-top:0;margin-bottom:0}',md:':host{--ripple-color:var(--color-selected);--background-focused-opacity:1;-ms-flex:1;flex:1;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%;outline:none;background:var(--background);color:var(--color)}.button-native{border-radius:inherit;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:-ms-flexbox;display:flex;position:relative;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:100%;height:100%;border:0;outline:none;background:transparent;text-decoration:none;cursor:pointer;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-user-drag:none}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:inherit;flex-flow:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:100%;height:100%;z-index:1}:host(.ion-focused) .button-native{color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}@media (any-hover: hover){a:hover{color:var(--color-selected)}}:host(.tab-selected){color:var(--color-selected)}:host(.tab-hidden){display:none !important}:host(.tab-disabled){pointer-events:none;opacity:0.4}::slotted(ion-label),::slotted(ion-icon){display:block;-ms-flex-item-align:center;align-self:center;max-width:100%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box}::slotted(ion-label){-ms-flex-order:0;order:0}::slotted(ion-icon){-ms-flex-order:-1;order:-1;height:1em}:host(.tab-has-label-only) ::slotted(ion-label){white-space:normal}::slotted(ion-badge){-webkit-box-sizing:border-box;box-sizing:border-box;position:absolute;z-index:1}:host(.tab-layout-icon-start){-ms-flex-direction:row;flex-direction:row}:host(.tab-layout-icon-end){-ms-flex-direction:row-reverse;flex-direction:row-reverse}:host(.tab-layout-icon-bottom){-ms-flex-direction:column-reverse;flex-direction:column-reverse}:host(.tab-layout-icon-hide) ::slotted(ion-icon){display:none}:host(.tab-layout-label-hide) ::slotted(ion-label){display:none}ion-ripple-effect{color:var(--ripple-color)}:host{--padding-top:0;--padding-end:12px;--padding-bottom:0;--padding-start:12px;max-width:168px;font-size:12px;font-weight:normal;letter-spacing:0.03em}::slotted(ion-label){margin-left:0;margin-right:0;margin-top:2px;margin-bottom:2px;text-transform:none}::slotted(ion-icon){margin-left:0;margin-right:0;margin-top:16px;margin-bottom:16px;-webkit-transform-origin:center center;transform-origin:center center;font-size:22px}:host-context([dir=rtl]) ::slotted(ion-icon){-webkit-transform-origin:calc(100% - center) center;transform-origin:calc(100% - center) center}[dir=rtl] ::slotted(ion-icon){-webkit-transform-origin:calc(100% - center) center;transform-origin:calc(100% - center) center}@supports selector(:dir(rtl)){::slotted(ion-icon):dir(rtl){-webkit-transform-origin:calc(100% - center) center;transform-origin:calc(100% - center) center}}::slotted(ion-badge){border-radius:8px;-webkit-padding-start:2px;padding-inline-start:2px;-webkit-padding-end:2px;padding-inline-end:2px;padding-top:3px;padding-bottom:2px;top:8px;min-width:12px;font-size:8px;font-weight:normal}@supports (inset-inline-start: 0){::slotted(ion-badge){inset-inline-start:calc(50% + 6px)}}@supports not (inset-inline-start: 0){::slotted(ion-badge){left:calc(50% + 6px)}:host-context([dir=rtl]) ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 6px)}[dir=rtl] ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 6px)}@supports selector(:dir(rtl)){::slotted(ion-badge):dir(rtl){left:unset;right:unset;right:calc(50% + 6px)}}}::slotted(ion-badge:empty){display:block;min-width:8px;height:8px}:host(.tab-layout-icon-top) ::slotted(ion-icon){margin-top:6px;margin-bottom:2px}:host(.tab-layout-icon-top) ::slotted(ion-label){margin-top:0;margin-bottom:6px}:host(.tab-layout-icon-bottom) ::slotted(ion-badge){top:8px}@supports (inset-inline-start: 0){:host(.tab-layout-icon-bottom) ::slotted(ion-badge){inset-inline-start:70%}}@supports not (inset-inline-start: 0){:host(.tab-layout-icon-bottom) ::slotted(ion-badge){left:70%}:host-context([dir=rtl]):host(.tab-layout-icon-bottom) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-bottom ::slotted(ion-badge){left:unset;right:unset;right:70%}@supports selector(:dir(rtl)){:host(.tab-layout-icon-bottom) ::slotted(ion-badge):dir(rtl){left:unset;right:unset;right:70%}}}:host(.tab-layout-icon-bottom) ::slotted(ion-icon){margin-top:0;margin-bottom:6px}:host(.tab-layout-icon-bottom) ::slotted(ion-label){margin-top:6px;margin-bottom:0}:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){top:16px}@supports (inset-inline-start: 0){:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){inset-inline-start:80%}}@supports not (inset-inline-start: 0){:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){left:80%}:host-context([dir=rtl]):host(.tab-layout-icon-start) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-start ::slotted(ion-badge),:host-context([dir=rtl]):host(.tab-layout-icon-end) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-end ::slotted(ion-badge){left:unset;right:unset;right:80%}@supports selector(:dir(rtl)){:host(.tab-layout-icon-start) ::slotted(ion-badge):dir(rtl),:host(.tab-layout-icon-end) ::slotted(ion-badge):dir(rtl){left:unset;right:unset;right:80%}}}:host(.tab-layout-icon-start) ::slotted(ion-icon){-webkit-margin-end:6px;margin-inline-end:6px}:host(.tab-layout-icon-end) ::slotted(ion-icon){-webkit-margin-start:6px;margin-inline-start:6px}:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){top:16px}@supports (inset-inline-start: 0){:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){inset-inline-start:70%}}@supports not (inset-inline-start: 0){:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){left:70%}:host-context([dir=rtl]):host(.tab-layout-icon-hide) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-hide ::slotted(ion-badge),:host-context([dir=rtl]):host(.tab-has-label-only) ::slotted(ion-badge),:host-context([dir=rtl]).tab-has-label-only ::slotted(ion-badge){left:unset;right:unset;right:70%}@supports selector(:dir(rtl)){:host(.tab-layout-icon-hide) ::slotted(ion-badge):dir(rtl),:host(.tab-has-label-only) ::slotted(ion-badge):dir(rtl){left:unset;right:unset;right:70%}}}:host(.tab-layout-icon-hide) ::slotted(ion-label),:host(.tab-has-label-only) ::slotted(ion-label){margin-top:0;margin-bottom:0}:host(.tab-layout-label-hide) ::slotted(ion-badge),:host(.tab-has-icon-only) ::slotted(ion-badge){top:16px}:host(.tab-layout-label-hide) ::slotted(ion-icon),:host(.tab-has-icon-only) ::slotted(ion-icon){margin-top:0;margin-bottom:0;font-size:24px}'}}},[33,"ion-tab-button",{disabled:[4],download:[1],href:[1],rel:[1],layout:[1025],selected:[1028],tab:[1],target:[1]},[[8,"ionTabBarChanged","onTabBarChanged"]]]),Ky=function(){"undefined"!=typeof customElements&&["ion-tab-button","ion-ripple-effect"].forEach((e=>{switch(e){case"ion-tab-button":customElements.get(e)||customElements.define(e,qy);break;case"ion-ripple-effect":customElements.get(e)||Qg()}}))},Xy=!0,Yy=!0,Jy=!0,Zy=!1,Qy=!1;let ev,tv,nv,rv=!1,av=!1,iv=!1,sv=!1,ov=null,lv=!1;const uv="http://www.w3.org/1999/xlink",dv={},cv=e=>"object"==(e=typeof e)||"function"===e,pv=(e,t,...n)=>{let r=null,a=null,i=null,s=!1,o=!1;const l=[],u=t=>{for(let n=0;n<t.length;n++)r=t[n],Array.isArray(r)?u(r):null!=r&&"boolean"!=typeof r&&((s="function"!=typeof e&&!cv(r))&&(r=String(r)),s&&o?l[l.length-1].$text$+=r:l.push(s?hv(null,r):r),o=s)};if(u(n),t){t.key&&(a=t.key),t.name&&(i=t.name);{const e=t.className||t.class;e&&(t.class="object"!=typeof e?e:Object.keys(e).filter((t=>e[t])).join(" "))}}if("function"==typeof e)return e(null===t?{}:t,l,mv);const d=hv(e,null);return d.$attrs$=t,l.length>0&&(d.$children$=l),d.$key$=a,d.$name$=i,d},hv=(e,t)=>{const n={$flags$:0,$tag$:e,$text$:t,$elm$:null,$children$:null,$attrs$:null,$key$:null,$name$:null};return n},fv={},mv={forEach:(e,t)=>e.map(gv).forEach(t),map:(e,t)=>e.map(gv).map(t).map(bv)},gv=e=>({vattrs:e.$attrs$,vchildren:e.$children$,vkey:e.$key$,vname:e.$name$,vtag:e.$tag$,vtext:e.$text$}),bv=e=>{if("function"==typeof e.vtag){const t=Object.assign({},e.vattrs);return e.vkey&&(t.key=e.vkey),e.vname&&(t.name=e.vname),pv(e.vtag,t,...e.vchildren||[])}const t=hv(e.vtag,e.vtext);return t.$attrs$=e.vattrs,t.$children$=e.vchildren,t.$key$=e.vkey,t.$name$=e.vname,t},yv=new WeakMap,vv=e=>{const t=e.$cmpMeta$,n=e.$hostElement$,r=t.$flags$,a=(t.$tagName$,()=>{}),i=((e,t,n,r)=>{var a;let i=xv(t,n);const s=sx.get(i);if(e=11===e.nodeType?e:ux,s)if("string"==typeof s){e=e.head||e;let t,n=yv.get(e);if(n||yv.set(e,n=new Set),!n.has(i)){{t=ux.createElement("style"),t.innerHTML=s;const n=null!==(a=cx.$nonce$)&&void 0!==a?a:function(e){var t,n,r;return null!==(r=null===(n=null===(t=e.head)||void 0===t?void 0:t.querySelector('meta[name="csp-nonce"]'))||void 0===n?void 0:n.getAttribute("content"))&&void 0!==r?r:void 0}(ux);null!=n&&t.setAttribute("nonce",n),e.insertBefore(t,e.querySelector("link"))}n&&n.add(i)}}else e.adoptedStyleSheets.includes(s)||(e.adoptedStyleSheets=[...e.adoptedStyleSheets,s]);return i})(n.shadowRoot?n.shadowRoot:n.getRootNode(),t,e.$modeName$);10&r&&(n["s-sc"]=i,n.classList.add(i+"-h"),2&r&&n.classList.add(i+"-s")),a()},xv=(e,t)=>"sc-"+(t&&32&e.$flags$?e.$tagName$+"-"+t:e.$tagName$),wv=(e,t,n,r,a,i)=>{if(n!==r){let s=ax(e,t),o=t.toLowerCase();if("class"===t){const t=e.classList,a=Sv(n),i=Sv(r);t.remove(...a.filter((e=>e&&!i.includes(e)))),t.add(...i.filter((e=>e&&!a.includes(e))))}else if("style"===t){for(const t in n)r&&null!=r[t]||(t.includes("-")?e.style.removeProperty(t):e.style[t]="");for(const t in r)n&&r[t]===n[t]||(t.includes("-")?e.style.setProperty(t,r[t]):e.style[t]=r[t])}else if("key"===t);else if("ref"===t)r&&r(e);else if(e.__lookupSetter__(t)||"o"!==t[0]||"n"!==t[1]){const l=cv(r);if((s||l&&null!==r)&&!a)try{if(e.tagName.includes("-"))e[t]=r;else{const a=null==r?"":r;"list"===t?s=!1:null!=n&&e[t]==a||(e[t]=a)}}catch(kp){}let u=!1;o!==(o=o.replace(/^xlink\:?/,""))&&(t=o,u=!0),null==r||!1===r?!1===r&&""!==e.getAttribute(t)||(u?e.removeAttributeNS(uv,t):e.removeAttribute(t)):(!s||4&i||a)&&!l&&(r=!0===r?"":r,u?e.setAttributeNS(uv,t,r):e.setAttribute(t,r))}else t="-"===t[2]?t.slice(3):ax(lx,o)?o.slice(2):o[2]+t.slice(3),n&&cx.rel(e,t,n,!1),r&&cx.ael(e,t,r,!1)}},kv=/\s/,Sv=e=>e?e.split(kv):[],Iv=(e,t,n,r)=>{const a=11===t.$elm$.nodeType&&t.$elm$.host?t.$elm$.host:t.$elm$,i=e&&e.$attrs$||dv,s=t.$attrs$||dv;for(r in i)r in s||wv(a,r,i[r],void 0,n,t.$flags$);for(r in s)wv(a,r,i[r],s[r],n,t.$flags$)},Nv=(e,t,n,r)=>{const a=t.$children$[n];let i,s,o,l=0;if(rv||(iv=!0,"slot"===a.$tag$&&(ev&&r.classList.add(ev+"-s"),a.$flags$|=a.$children$?2:1)),null!==a.$text$)i=a.$elm$=ux.createTextNode(a.$text$);else if(1&a.$flags$)i=a.$elm$=ux.createTextNode("");else{if(sv||(sv="svg"===a.$tag$),i=a.$elm$=ux.createElementNS(sv?"http://www.w3.org/2000/svg":"http://www.w3.org/1999/xhtml",2&a.$flags$?"slot-fb":a.$tag$),sv&&"foreignObject"===a.$tag$&&(sv=!1),Iv(null,a,sv),(e=>null!=e)(ev)&&i["s-si"]!==ev&&i.classList.add(i["s-si"]=ev),a.$children$)for(l=0;l<a.$children$.length;++l)s=Nv(e,a,l,i),s&&i.appendChild(s);"svg"===a.$tag$?sv=!1:"foreignObject"===i.tagName&&(sv=!0)}return i["s-hn"]=nv,3&a.$flags$&&(i["s-sr"]=!0,i["s-cr"]=tv,i["s-sn"]=a.$name$||"",o=e&&e.$children$&&e.$children$[n],o&&o.$tag$===a.$tag$&&e.$elm$&&Cv(e.$elm$,!1)),i},Cv=(e,t)=>{cx.$flags$|=1;const n=e.childNodes;for(let r=n.length-1;r>=0;r--){const e=n[r];e["s-hn"]!==nv&&e["s-ol"]&&(Av(e).insertBefore(e,$v(e)),e["s-ol"].remove(),e["s-ol"]=void 0,iv=!0),t&&Cv(e,t)}cx.$flags$&=-2},Tv=(e,t,n,r,a,i)=>{let s,o=e["s-cr"]&&e["s-cr"].parentNode||e;for(o.shadowRoot&&o.tagName===nv&&(o=o.shadowRoot);a<=i;++a)r[a]&&(s=Nv(null,n,a,e),s&&(r[a].$elm$=s,o.insertBefore(s,$v(t))))},Ev=(e,t,n,r,a)=>{for(;t<=n;++t)(r=e[t])&&(a=r.$elm$,Pv(r),av=!0,a["s-ol"]?a["s-ol"].remove():Cv(a,!0),a.remove())},_v=(e,t)=>e.$tag$===t.$tag$&&("slot"===e.$tag$?e.$name$===t.$name$:e.$key$===t.$key$),$v=e=>e&&e["s-ol"]||e,Av=e=>(e["s-ol"]?e["s-ol"]:e).parentNode,Rv=(e,t)=>{const n=t.$elm$=e.$elm$,r=e.$children$,a=t.$children$,i=t.$tag$,s=t.$text$;let o;null===s?(sv="svg"===i||"foreignObject"!==i&&sv,"slot"===i||Iv(e,t,sv),null!==r&&null!==a?((e,t,n,r)=>{let a,i,s=0,o=0,l=0,u=0,d=t.length-1,c=t[0],p=t[d],h=r.length-1,f=r[0],m=r[h];for(;s<=d&&o<=h;)if(null==c)c=t[++s];else if(null==p)p=t[--d];else if(null==f)f=r[++o];else if(null==m)m=r[--h];else if(_v(c,f))Rv(c,f),c=t[++s],f=r[++o];else if(_v(p,m))Rv(p,m),p=t[--d],m=r[--h];else if(_v(c,m))"slot"!==c.$tag$&&"slot"!==m.$tag$||Cv(c.$elm$.parentNode,!1),Rv(c,m),e.insertBefore(c.$elm$,p.$elm$.nextSibling),c=t[++s],m=r[--h];else if(_v(p,f))"slot"!==c.$tag$&&"slot"!==m.$tag$||Cv(p.$elm$.parentNode,!1),Rv(p,f),e.insertBefore(p.$elm$,c.$elm$),p=t[--d],f=r[++o];else{for(l=-1,u=s;u<=d;++u)if(t[u]&&null!==t[u].$key$&&t[u].$key$===f.$key$){l=u;break}l>=0?(i=t[l],i.$tag$!==f.$tag$?a=Nv(t&&t[o],n,l,e):(Rv(i,f),t[l]=void 0,a=i.$elm$),f=r[++o]):(a=Nv(t&&t[o],n,o,e),f=r[++o]),a&&Av(c.$elm$).insertBefore(a,$v(c.$elm$))}s>d?Tv(e,null==r[h+1]?null:r[h+1].$elm$,n,r,o,h):o>h&&Ev(t,s,d)})(n,r,t,a):null!==a?(null!==e.$text$&&(n.textContent=""),Tv(n,null,t,a,0,a.length-1)):null!==r&&Ev(r,0,r.length-1),sv&&"svg"===i&&(sv=!1)):(o=n["s-cr"])?o.parentNode.textContent=s:e.$text$!==s&&(n.data=s)},Dv=e=>{const t=e.childNodes;let n,r,a,i,s,o;for(r=0,a=t.length;r<a;r++)if(n=t[r],1===n.nodeType){if(n["s-sr"])for(s=n["s-sn"],n.hidden=!1,i=0;i<a;i++)if(o=t[i].nodeType,t[i]["s-hn"]!==n["s-hn"]||""!==s){if(1===o&&s===t[i].getAttribute("slot")){n.hidden=!0;break}}else if(1===o||3===o&&""!==t[i].textContent.trim()){n.hidden=!0;break}Dv(n)}},Fv=[],Mv=e=>{let t,n,r,a,i,s,o=0;const l=e.childNodes,u=l.length;for(;o<u;o++){if(t=l[o],t["s-sr"]&&(n=t["s-cr"])&&n.parentNode)for(r=n.parentNode.childNodes,a=t["s-sn"],s=r.length-1;s>=0;s--)n=r[s],n["s-cn"]||n["s-nr"]||n["s-hn"]===t["s-hn"]||(Ov(n,a)?(i=Fv.find((e=>e.$nodeToRelocate$===n)),av=!0,n["s-sn"]=n["s-sn"]||a,i?i.$slotRefNode$=t:Fv.push({$slotRefNode$:t,$nodeToRelocate$:n}),n["s-sr"]&&Fv.map((e=>{Ov(e.$nodeToRelocate$,n["s-sn"])&&(i=Fv.find((e=>e.$nodeToRelocate$===n)),i&&!e.$slotRefNode$&&(e.$slotRefNode$=i.$slotRefNode$))}))):Fv.some((e=>e.$nodeToRelocate$===n))||Fv.push({$nodeToRelocate$:n}));1===t.nodeType&&Mv(t)}},Ov=(e,t)=>1===e.nodeType?null===e.getAttribute("slot")&&""===t||e.getAttribute("slot")===t:e["s-sn"]===t||""===t,Pv=e=>{e.$attrs$&&e.$attrs$.ref&&e.$attrs$.ref(null),e.$children$&&e.$children$.map(Pv)},Lv=(e,t)=>{const n=e.$hostElement$,r=e.$cmpMeta$,a=e.$vnode$||hv(null,null),i=(s=t)&&s.$tag$===fv?t:pv(null,null,t);var s;if(nv=n.tagName,r.$attrsToReflect$&&(i.$attrs$=i.$attrs$||{},r.$attrsToReflect$.map((([e,t])=>i.$attrs$[t]=n[e]))),i.$tag$=null,i.$flags$|=4,e.$vnode$=i,i.$elm$=a.$elm$=n.shadowRoot||n,ev=n["s-sc"],tv=n["s-cr"],rv=0!=(1&r.$flags$),av=!1,Rv(a,i),cx.$flags$|=1,iv){let e,t,n,r,a,s;Mv(i.$elm$);let o=0;for(;o<Fv.length;o++)e=Fv[o],t=e.$nodeToRelocate$,t["s-ol"]||(n=ux.createTextNode(""),n["s-nr"]=t,t.parentNode.insertBefore(t["s-ol"]=n,t));for(o=0;o<Fv.length;o++)if(e=Fv[o],t=e.$nodeToRelocate$,e.$slotRefNode$){for(r=e.$slotRefNode$.parentNode,a=e.$slotRefNode$.nextSibling,n=t["s-ol"];n=n.previousSibling;)if(s=n["s-nr"],s&&s["s-sn"]===t["s-sn"]&&r===s.parentNode&&(s=s.nextSibling,!s||!s["s-nr"])){a=s;break}(!a&&r!==t.parentNode||t.nextSibling!==a)&&t!==a&&(!t["s-hn"]&&t["s-ol"]&&(t["s-hn"]=t["s-ol"].parentNode.nodeName),r.insertBefore(t,a))}else 1===t.nodeType&&(t.hidden=!0)}av&&Dv(i.$elm$),cx.$flags$&=-2,Fv.length=0},zv=(e,t)=>(e.$flags$|=16,e.$ancestorComponent$,xx((()=>Bv(e,t)))),Bv=(e,t)=>{const n=e.$hostElement$,r=(e.$cmpMeta$.$tagName$,()=>{}),a=n;let i;return i=jv(a,t?"componentWillLoad":"componentWillUpdate"),i=Hv(i,(()=>jv(a,"componentWillRender"))),r(),Hv(i,(()=>Wv(e,a,t)))},Wv=async(e,t,n)=>{const r=e.$hostElement$,a=(e.$cmpMeta$.$tagName$,()=>{});r["s-rc"],n&&vv(e);const i=(e.$cmpMeta$.$tagName$,()=>{});Vv(e,t,r),i(),a(),Uv(e)},Vv=(e,t,n)=>{try{ov=t,t=t.render&&t.render(),e.$flags$&=-17,e.$flags$|=2,(Xy||Yy)&&(Jy||Yy)&&(Zy||Lv(e,t))}catch(kp){ix(kp,e.$hostElement$)}return ov=null,null},Uv=e=>{e.$cmpMeta$.$tagName$;const t=()=>{},n=e.$hostElement$;e.$ancestorComponent$,jv(n,"componentDidRender"),64&e.$flags$?(jv(n,"componentDidUpdate"),t()):(e.$flags$|=64,jv(n,"componentDidLoad"),t())},jv=(e,t,n)=>{if(e&&e[t])try{return e[t](n)}catch(kp){ix(kp)}},Hv=(e,t)=>e&&e.then?e.then(t):t(),Gv=(e,t,n,r)=>{const a=nx(e),i=e,s=a.$instanceValues$.get(t),o=a.$flags$,l=i;var u,d;u=n,d=r.$members$[t][0],n=null==u||cv(u)?u:4&d?"false"!==u&&(""===u||!!u):2&d?parseFloat(u):1&d?String(u):u;const c=Number.isNaN(s)&&Number.isNaN(n);if(n!==s&&!c){if(a.$instanceValues$.set(t,n),r.$watchers$&&128&o){const e=r.$watchers$[t];e&&e.map((e=>{try{l[e](n,s,t)}catch(kp){ix(kp,i)}}))}if(2==(18&o)){if(l.componentShouldUpdate&&!1===l.componentShouldUpdate(n,s,t))return;zv(a,!1)}}},qv=(e,t,n)=>{if(t.$members$){e.watchers&&(t.$watchers$=e.watchers);const n=Object.entries(t.$members$),r=e.prototype;n.map((([e,[n]])=>{(31&n||32&n)&&Object.defineProperty(r,e,{get(){return t=e,nx(this).$instanceValues$.get(t);var t},set(n){Gv(this,e,n,t)},configurable:!0,enumerable:!0})}));{const a=new Map;r.attributeChangedCallback=function(e,t,n){cx.jmp((()=>{const t=a.get(e);if(this.hasOwnProperty(t))n=this[t],delete this[t];else if(r.hasOwnProperty(t)&&"number"==typeof this[t]&&this[t]==n)return;this[t]=(null!==n||"boolean"!=typeof this[t])&&n}))},e.observedAttributes=n.filter((([e,t])=>15&t[0])).map((([e,n])=>{const r=n[1]||e;return a.set(r,e),512&n[0]&&t.$attrsToReflect$.push([e,r]),r}))}}return e},Kv=async(e,t,n,r,a)=>{if(0==(32&t.$flags$)&&(a=e.constructor,t.$flags$|=32,customElements.whenDefined(n.$tagName$).then((()=>t.$flags$|=128)),a.style)){let r=a.style;"string"!=typeof r&&(r=r[t.$modeName$=(e=>ox.map((t=>t(e))).find((e=>!!e)))(e)]);const i=xv(n,t.$modeName$);if(!sx.has(i)){const e=(n.$tagName$,()=>{});((e,t,n)=>{let r=sx.get(e);hx&&n?(r=r||new CSSStyleSheet,"string"==typeof r?r=t:r.replaceSync(t)):r=t,sx.set(e,r)})(i,r,!!(1&n.$flags$)),e()}}t.$ancestorComponent$,zv(t,!0)},Xv=e=>{const t=e["s-cr"]=ux.createComment("");t["s-cn"]=!0,e.insertBefore(t,e.firstChild)},Yv=(e,t)=>{const n={$flags$:t[0],$tagName$:t[1]};n.$members$=t[2],n.$listeners$=t[3],n.$watchers$=e.$watchers$,n.$attrsToReflect$=[];const r=e.prototype.connectedCallback,a=e.prototype.disconnectedCallback;return Object.assign(e.prototype,{__registerHost(){rx(this,n)},connectedCallback(){(e=>{if(0==(1&cx.$flags$)){const t=nx(e),n=t.$cmpMeta$,r=(n.$tagName$,()=>{});1&t.$flags$?(Jv(e,t,n.$listeners$),t.$lazyInstance$):(t.$flags$|=1,12&n.$flags$&&Xv(e),n.$members$&&Object.entries(n.$members$).map((([t,[n]])=>{if(31&n&&e.hasOwnProperty(t)){const n=e[t];delete e[t],e[t]=n}})),Kv(e,t,n)),r()}})(this),r&&r.call(this)},disconnectedCallback(){(e=>{if(0==(1&cx.$flags$)){const t=nx(e);t.$rmListeners$&&(t.$rmListeners$.map((e=>e())),t.$rmListeners$=void 0)}})(this),a&&a.call(this)},__attachShadow(){this.attachShadow({mode:"open",delegatesFocus:!!(16&n.$flags$)})}}),e.is=n.$tagName$,qv(e,n)},Jv=(e,t,n,r)=>{n&&n.map((([n,r,a])=>{const i=Qv(e,n),s=Zv(t,a),o=ex(n);cx.ael(i,r,s,o),(t.$rmListeners$=t.$rmListeners$||[]).push((()=>cx.rel(i,r,s,o)))}))},Zv=(e,t)=>n=>{try{Qy||e.$hostElement$[t](n)}catch(kp){ix(kp)}},Qv=(e,t)=>4&t?ux:8&t?lx:16&t?ux.body:e,ex=e=>px?{passive:0!=(1&e),capture:0!=(2&e)}:0!=(2&e),tx=new WeakMap,nx=e=>tx.get(e),rx=(e,t)=>{const n={$flags$:0,$hostElement$:e,$cmpMeta$:t,$instanceValues$:new Map};return Jv(e,n,t.$listeners$),tx.set(e,n)},ax=(e,t)=>t in e,ix=(e,t)=>(0,console.error)(e,t),sx=new Map,ox=[],lx="undefined"!=typeof window?window:{},ux=lx.document||{head:{}},dx=lx.HTMLElement||class{},cx={$flags$:0,$resourcesUrl$:"",jmp:e=>e(),raf:e=>requestAnimationFrame(e),ael:(e,t,n,r)=>e.addEventListener(t,n,r),rel:(e,t,n,r)=>e.removeEventListener(t,n,r),ce:(e,t)=>new CustomEvent(e,t)},px=(()=>{let e=!1;try{ux.addEventListener("e",null,Object.defineProperty({},"passive",{get(){e=!0}}))}catch(kp){}return e})(),hx=(()=>{try{return new CSSStyleSheet,"function"==typeof(new CSSStyleSheet).replaceSync}catch(kp){}return!1})(),fx=[],mx=[],gx=(e,t)=>n=>{e.push(n),lv||(lv=!0,t&&4&cx.$flags$?vx(yx):cx.raf(yx))},bx=e=>{for(let t=0;t<e.length;t++)try{e[t](performance.now())}catch(kp){ix(kp)}e.length=0},yx=()=>{bx(fx),bx(mx),(lv=fx.length>0)&&cx.raf(yx)},vx=e=>(e=>Promise.resolve(e))().then(e),xx=gx(mx,!0);let wx;const kx=e=>{const t=(()=>{if("undefined"==typeof window)return new Map;if(!wx){const e=window;e.Ionicons=e.Ionicons||{},wx=e.Ionicons.map=e.Ionicons.map||new Map}return wx})().get(e);return t||(e=>{const t=new URL(e,cx.$resourcesUrl$);return t.origin!==lx.location.origin?t.href:t.pathname})(`svg/${e}.svg`)},Sx=(e,t,n,r,a)=>(n="ios"===(n&&Tx(n))?"ios":"md",r&&"ios"===n?e=Tx(r):a&&"md"===n?e=Tx(a):(e||!t||Nx(t)||(e=t),Cx(e)&&(e=Tx(e))),Cx(e)&&""!==e.trim()?""!==e.replace(/[a-z]|-|\d/gi,"")?null:e:null),Ix=e=>Cx(e)&&(e=e.trim(),Nx(e))?e:null,Nx=e=>e.length>0&&/(\/|\.)/.test(e),Cx=e=>"string"==typeof e,Tx=e=>e.toLowerCase(),Ex=e=>{if(1===e.nodeType){if("script"===e.nodeName.toLowerCase())return!1;for(let t=0;t<e.attributes.length;t++){const n=e.attributes[t].name;if(Cx(n)&&0===n.toLowerCase().indexOf("on"))return!1}for(let t=0;t<e.childNodes.length;t++)if(!Ex(e.childNodes[t]))return!1}return!0},_x=new Map,$x=new Map;let Ax;const Rx=(e,t)=>{let n=$x.get(e);if(!n){if("undefined"==typeof fetch||"undefined"==typeof document)return _x.set(e,""),Promise.resolve();if((e=>e.startsWith("data:image/svg+xml"))(e)&&(e=>-1!==e.indexOf(";utf8,"))(e)){Ax||(Ax=new DOMParser);const t=Ax.parseFromString(e,"text/html").querySelector("svg");return t&&_x.set(e,t.outerHTML),Promise.resolve()}n=fetch(e).then((n=>{if(n.ok)return n.text().then((n=>{n&&!1!==t&&(n=(e=>{const t=document.createElement("div");t.innerHTML=e;for(let r=t.childNodes.length-1;r>=0;r--)"svg"!==t.childNodes[r].nodeName.toLowerCase()&&t.removeChild(t.childNodes[r]);const n=t.firstElementChild;if(n&&"svg"===n.nodeName.toLowerCase()){const e=n.getAttribute("class")||"";if(n.setAttribute("class",(e+" s-ion-icon").trim()),Ex(n))return t.innerHTML}return""})(n)),_x.set(e,n||"")}));_x.set(e,"")})),$x.set(e,n)}return n},Dx=Yv(class extends dx{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.iconName=null,this.inheritedAttributes={},this.isVisible=!1,this.mode=Fx(),this.lazy=!1,this.sanitize=!0}componentWillLoad(){this.inheritedAttributes=((e,t=[])=>{const n={};return t.forEach((t=>{e.hasAttribute(t)&&(null!==e.getAttribute(t)&&(n[t]=e.getAttribute(t)),e.removeAttribute(t))})),n})(this.el,["aria-label"])}connectedCallback(){this.waitUntilVisible(this.el,"50px",(()=>{this.isVisible=!0,this.loadIcon()}))}disconnectedCallback(){this.io&&(this.io.disconnect(),this.io=void 0)}waitUntilVisible(e,t,n){if(this.lazy&&"undefined"!=typeof window&&window.IntersectionObserver){const r=this.io=new window.IntersectionObserver((e=>{e[0].isIntersecting&&(r.disconnect(),this.io=void 0,n())}),{rootMargin:t});r.observe(e)}else n()}loadIcon(){if(this.isVisible){const e=(e=>{let t=Ix(e.src);if(t)return t;if(t=Sx(e.name,e.icon,e.mode,e.ios,e.md),t)return kx(t);if(e.icon){if(t=Ix(e.icon),t)return t;if(t=Ix(e.icon[e.mode]),t)return t}return null})(this);e&&(_x.has(e)?this.svgContent=_x.get(e):Rx(e,this.sanitize).then((()=>this.svgContent=_x.get(e))))}this.iconName=Sx(this.name,this.icon,this.mode,this.ios,this.md)}render(){const{flipRtl:e,iconName:t,inheritedAttributes:n,el:r}=this,a=this.mode||"md",i=!!t&&(t.includes("arrow")||t.includes("chevron"))&&!1!==e,s=e||i;return pv(fv,Object.assign({role:"img",class:Object.assign(Object.assign({[a]:!0},Mx(this.color)),{[`icon-${this.size}`]:!!this.size,"flip-rtl":s,"icon-rtl":s&&(o=r,o&&""!==o.dir?"rtl"===o.dir.toLowerCase():"rtl"===(null===document||void 0===document?void 0:document.dir.toLowerCase()))})},n),this.svgContent?pv("div",{class:"icon-inner",innerHTML:this.svgContent}):pv("div",{class:"icon-inner"}));var o}static get assetsDirs(){return["svg"]}get el(){return this}static get watchers(){return{name:["loadIcon"],src:["loadIcon"],icon:["loadIcon"],ios:["loadIcon"],md:["loadIcon"]}}static get style(){return":host{display:inline-block;width:1em;height:1em;contain:strict;fill:currentColor;-webkit-box-sizing:content-box !important;box-sizing:content-box !important}:host .ionicon{stroke:currentColor}.ionicon-fill-none{fill:none}.ionicon-stroke-width{stroke-width:32px;stroke-width:var(--ionicon-stroke-width, 32px)}.icon-inner,.ionicon,svg{display:block;height:100%;width:100%}@supports (background: -webkit-named-image(i)){:host(.icon-rtl) .icon-inner{-webkit-transform:scaleX(-1);transform:scaleX(-1)}}@supports not selector(:dir(rtl)) and selector(:host-context([dir='rtl'])){:host(.icon-rtl) .icon-inner{-webkit-transform:scaleX(-1);transform:scaleX(-1)}}:host(.flip-rtl):host-context([dir='rtl']) .icon-inner{-webkit-transform:scaleX(-1);transform:scaleX(-1)}@supports selector(:dir(rtl)){:host(.flip-rtl:dir(rtl)) .icon-inner{-webkit-transform:scaleX(-1);transform:scaleX(-1)}:host(.flip-rtl:dir(ltr)) .icon-inner{-webkit-transform:scaleX(1);transform:scaleX(1)}}:host(.icon-small){font-size:18px !important}:host(.icon-large){font-size:32px !important}:host(.ion-color){color:var(--ion-color-base) !important}:host(.ion-color-primary){--ion-color-base:var(--ion-color-primary, #3880ff)}:host(.ion-color-secondary){--ion-color-base:var(--ion-color-secondary, #0cd1e8)}:host(.ion-color-tertiary){--ion-color-base:var(--ion-color-tertiary, #f4a942)}:host(.ion-color-success){--ion-color-base:var(--ion-color-success, #10dc60)}:host(.ion-color-warning){--ion-color-base:var(--ion-color-warning, #ffce00)}:host(.ion-color-danger){--ion-color-base:var(--ion-color-danger, #f14141)}:host(.ion-color-light){--ion-color-base:var(--ion-color-light, #f4f5f8)}:host(.ion-color-medium){--ion-color-base:var(--ion-color-medium, #989aa2)}:host(.ion-color-dark){--ion-color-base:var(--ion-color-dark, #222428)}"}},[1,"ion-icon",{mode:[1025],color:[1],ios:[1],md:[1],flipRtl:[4,"flip-rtl"],name:[513],src:[1],icon:[8],size:[1],lazy:[4],sanitize:[4],svgContent:[32],isVisible:[32]}]),Fx=()=>"undefined"!=typeof document&&document.documentElement.getAttribute("mode")||"md",Mx=e=>e?{"ion-color":!0,[`ion-color-${e}`]:!0}:null,Ox=function(){"undefined"!=typeof customElements&&["ion-icon"].forEach((e=>{"ion-icon"===e&&(customElements.get(e)||customElements.define(e,Dx))}))},Px=V.createContext({onIonViewWillEnter:()=>{},ionViewWillEnter:()=>{},onIonViewDidEnter:()=>{},ionViewDidEnter:()=>{},onIonViewWillLeave:()=>{},ionViewWillLeave:()=>{},onIonViewDidLeave:()=>{},ionViewDidLeave:()=>{}}),Lx=V.createContext({getIonRedirect:()=>{},getIonRoute:()=>{},getPageManager:()=>{},getStackManager:()=>{},goBack:e=>{"undefined"!=typeof window&&("string"==typeof e?window.location.pathname=e:window.history.back())},navigate:e=>{"undefined"!=typeof window&&(window.location.pathname=e)},hasIonicRouter:()=>!1,routeInfo:void 0,setCurrentTab:()=>{},changeTab:(e,t)=>{"undefined"!=typeof window&&(window.location.pathname=t)},resetTab:(e,t)=>{"undefined"!=typeof window&&(window.location.pathname=t)}}),zx=e=>e.toLowerCase().split("-").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(""),Bx=e=>e.replace(/([A-Z])/g,(e=>`-${e[0].toLowerCase()}`)),Wx=(e,t,n={})=>{if(e instanceof Element){const r=Vx(e.classList,t,n);""!==r&&(e.className=r),Object.keys(t).forEach((n=>{if("children"!==n&&"style"!==n&&"ref"!==n&&"class"!==n&&"className"!==n&&"forwardedRef"!==n)if(0===n.indexOf("on")&&n[2]===n[2].toUpperCase()){const r=n.substring(2),a=r[0].toLowerCase()+r.substring(1);Ux(a)||jx(e,a,t[n])}else e[n]=t[n],"string"==typeof t[n]&&e.setAttribute(Bx(n),t[n])}))}},Vx=(e,t,n)=>{const r=t.className||t.class,a=n.className||n.class,i=Hx(e),s=Hx(r?r.split(" "):[]),o=Hx(a?a.split(" "):[]),l=[];return i.forEach((e=>{s.has(e)?(l.push(e),s.delete(e)):o.has(e)||l.push(e)})),s.forEach((e=>l.push(e))),l.join(" ")},Ux=e=>{if("undefined"==typeof document)return!0;{const t="on"+(e=>"doubleclick"===e?"dblclick":e)(e);let n=t in document;if(!n){const e=document.createElement("div");e.setAttribute(t,"return;"),n="function"==typeof e[t]}return n}},jx=(e,t,n)=>{const r=e.__events||(e.__events={}),a=r[t];a&&e.removeEventListener(t,a),e.addEventListener(t,r[t]=function(e){n&&n.call(this,e)})},Hx=e=>{const t=new Map;return e.forEach((e=>t.set(e,e))),t},Gx=(...e)=>t=>{e.forEach((e=>{((e,t)=>{"function"==typeof e?e(t):null!=e&&(e.current=t)})(e,t)}))},qx=(e,t,n,r)=>{void 0!==r&&r();const a=zx(e),i=class extends V.Component{constructor(e){super(e),this.setComponentElRef=e=>{this.componentEl=e}}componentDidMount(){this.componentDidUpdate(this.props)}componentDidUpdate(e){Wx(this.componentEl,this.props,e)}render(){const t=this.props,{children:r,forwardedRef:a,style:i,className:s,ref:o}=t,l=Ug(t,["children","forwardedRef","style","className","ref"]);let u=Object.keys(l).reduce(((e,t)=>{const n=l[t];if(0===t.indexOf("on")&&t[2]===t[2].toUpperCase()){const r=t.substring(2).toLowerCase();"undefined"!=typeof document&&Ux(r)&&(e[t]=n)}else{const r=typeof n;"string"!==r&&"boolean"!==r&&"number"!==r||(e[Bx(t)]=n)}return e}),{});n&&(u=n(this.props,u));const d=Object.assign(Object.assign({},u),{ref:Gx(a,this.setComponentElRef),style:i});return W.createElement(e,d,r)}static get displayName(){return a}};return t&&(i.contextType=t),((e,t)=>{const n=(t,n)=>V.createElement(e,Object.assign({},t,{forwardedRef:n}));return n.displayName=t,V.forwardRef(n)})(i,a)},Kx=qx("ion-col",void 0,void 0,sb),Xx=qx("ion-content",void 0,void 0,cb),Yx=qx("ion-grid",void 0,void 0,Eb),Jx=qx("ion-header",void 0,void 0,Pb),Zx=qx("ion-label",void 0,void 0,Ub),Qx=qx("ion-row",void 0,void 0,Yb),ew=qx("ion-segment",void 0,void 0,Zb),tw=qx("ion-segment-button",void 0,void 0,ty),nw=qx("ion-spinner",void 0,void 0,ny),rw=(e,t)=>{const n=(t,n)=>V.createElement(e,Object.assign({},t,{forwardedRef:n}));return n.displayName=t,V.forwardRef(n)},aw=()=>{if("undefined"!=typeof window){const e=window.Ionic;if(e&&e.config)return e.config}return null},iw=(e,t)=>{((e,t)=>{void 0===t||"undefined"==typeof customElements||customElements.get(e)||customElements.define(e,t)})(e,t);const n=zx(e),r=class extends V.Component{constructor(e){super(e),this.handleClick=e=>{const{routerLink:t,routerDirection:n,routerOptions:r,routerAnimation:a}=this.props;void 0!==t&&(e.preventDefault(),this.context.navigate(t,n,void 0,a,r))},this.ref=V.createRef(),this.stableMergedRefs=Gx(this.ref,this.props.forwardedRef)}componentDidMount(){this.componentDidUpdate(this.props)}componentDidUpdate(e){const t=this.ref.current;Wx(t,this.props,e)}render(){const t=this.props,{children:n,forwardedRef:r,style:a,className:i,ref:s}=t,o=Ug(t,["children","forwardedRef","style","className","ref"]),l=Object.keys(o).reduce(((e,t)=>{if(0===t.indexOf("on")&&t[2]===t[2].toUpperCase()){const n=t.substring(2).toLowerCase();Ux(n)&&(e[t]=o[t])}else["string","boolean","number"].includes(typeof o[t])&&(e[Bx(t)]=o[t]);return e}),{}),u=Object.assign(Object.assign({},l),{ref:this.stableMergedRefs,style:a});if(this.props.routerLink&&!this.props.href&&(u.href=this.props.routerLink),u.onClick){const e=u.onClick;u.onClick=t=>{e(t),t.defaultPrevented||this.handleClick(t)}}else u.onClick=this.handleClick;return W.createElement(e,u,n)}static get displayName(){return n}static get contextType(){return Lx}};return rw(r,n)},sw=iw("ion-button",ry),ow=(e,t)=>{const n=e.__events||(e.__events={}),r=n[t];r&&(e.removeEventListener(t,r),n[t]=void 0)},lw=(e,t,n)=>{t&&t();const r=zx(e),a=class extends V.Component{constructor(e){super(e),this.handleIonMount=()=>{this.setState({isOpen:!0})},this.handleWillPresent=e=>{this.setState({isOpen:!0}),this.props.onWillPresent&&this.props.onWillPresent(e)},this.handleDidDismiss=e=>{const t=this.wrapperRef.current,n=this.ref.current;t&&n&&(n.append(t),this.setState({isOpen:!1})),this.props.onDidDismiss&&this.props.onDidDismiss(e)},this.ref=V.createRef(),this.stableMergedRefs=Gx(this.ref,this.props.forwardedRef),this.state={isOpen:!1},this.wrapperRef=V.createRef()}componentDidMount(){var e,t,n;this.componentDidUpdate(this.props),null===(e=this.ref.current)||void 0===e||e.addEventListener("ionMount",this.handleIonMount),null===(t=this.ref.current)||void 0===t||t.addEventListener("willPresent",this.handleWillPresent),null===(n=this.ref.current)||void 0===n||n.addEventListener("didDismiss",this.handleDidDismiss)}componentDidUpdate(e){const t=this.ref.current;Wx(t,this.props,e)}componentWillUnmount(){const e=this.ref.current;e&&this.state.isOpen&&(e.removeEventListener("didDismiss",this.handleDidDismiss),e.remove(),((e,t)=>{e instanceof Element&&Object.keys(t).forEach((t=>{if(0===t.indexOf("on")&&t[2]===t[2].toUpperCase()){const n=t.substring(2),r=n[0].toLowerCase()+n.substring(1);Ux(r)||ow(e,r)}}))})(e,this.props))}render(){const t=this.props,{children:r,forwardedRef:a,style:i,className:s,ref:o}=t,l=Ug(t,["children","forwardedRef","style","className","ref"]),u=Object.keys(l).reduce(((e,t)=>{if(0===t.indexOf("on")&&t[2]===t[2].toUpperCase()){const n=t.substring(2).toLowerCase();Ux(n)&&(e[t]=l[t])}else["string","boolean","number"].includes(typeof l[t])&&(e[Bx(t)]=l[t]);return e}),{}),d=Object.assign(Object.assign({},u),{ref:this.stableMergedRefs,style:i});return W.createElement("template",{},W.createElement(e,d,this.state.isOpen||this.props.keepContentsMounted?W.createElement("div",{ref:this.wrapperRef,className:n?`${uw} ion-page`:uw},r):null))}static get displayName(){return r}};return rw(a,r)},uw="ion-delegate-host",dw=lw("ion-modal",Ly,!0),cw=V.createContext({addOverlay:()=>{},removeOverlay:()=>{}}),pw=({onAddOverlay:e,onRemoveOverlay:t})=>{const[n,r]=W.useState({}),a=W.useRef({});a.current=n,W.useEffect((()=>{e(i),t(s)}),[]);const i=(e,t,n)=>{const i=Object.assign({},a.current);i[e]={component:t,containerElement:n},r(i)},s=e=>{const t=Object.assign({},a.current);delete t[e],r(t)},o=Object.keys(n);return V.createElement(V.Fragment,null,o.map((e=>{const t=n[e];return ic.createPortal(t.component,t.containerElement,`overlay-${e}`)})))},hw=qx("ion-tab-button",void 0,void 0,Ky),fw=qx("ion-tab-bar",void 0,void 0,Gy),mw=qx("ion-router-outlet",void 0,void 0,jy),gw=qx("ion-app",void 0,void 0,Vy),bw=qx("ion-icon",void 0,void 0,Ox),yw=(()=>class extends V.Component{constructor(e){super(e),this.ionContext={addOverlay:(e,t,n)=>{this.addOverlayCallback&&this.addOverlayCallback(e,t,n)},removeOverlay:e=>{this.removeOverlayCallback&&this.removeOverlayCallback(e)}}}render(){return V.createElement(cw.Provider,{value:this.ionContext},V.createElement(gw,Object.assign({},this.props),this.props.children),V.createElement(pw,{onAddOverlay:e=>{this.addOverlayCallback=e},onRemoveOverlay:e=>{this.removeOverlayCallback=e}}))}static get displayName(){return"IonApp"}})(),vw=V.createContext({registerIonPage:()=>{},isInOutlet:()=>!1});class xw extends V.PureComponent{constructor(e){super(e),this.ionPageElementRef=V.createRef(),this.stableMergedRefs=Gx(this.ionPageElementRef,this.props.forwardedRef)}componentDidMount(){this.ionPageElementRef.current&&(this.context.isInOutlet()&&this.ionPageElementRef.current.classList.add("ion-page-invisible"),this.context.registerIonPage(this.ionPageElementRef.current,this.props.routeInfo),this.ionPageElementRef.current.addEventListener("ionViewWillEnter",this.ionViewWillEnterHandler.bind(this)),this.ionPageElementRef.current.addEventListener("ionViewDidEnter",this.ionViewDidEnterHandler.bind(this)),this.ionPageElementRef.current.addEventListener("ionViewWillLeave",this.ionViewWillLeaveHandler.bind(this)),this.ionPageElementRef.current.addEventListener("ionViewDidLeave",this.ionViewDidLeaveHandler.bind(this)))}componentWillUnmount(){this.ionPageElementRef.current&&(this.ionPageElementRef.current.removeEventListener("ionViewWillEnter",this.ionViewWillEnterHandler.bind(this)),this.ionPageElementRef.current.removeEventListener("ionViewDidEnter",this.ionViewDidEnterHandler.bind(this)),this.ionPageElementRef.current.removeEventListener("ionViewWillLeave",this.ionViewWillLeaveHandler.bind(this)),this.ionPageElementRef.current.removeEventListener("ionViewDidLeave",this.ionViewDidLeaveHandler.bind(this)))}ionViewWillEnterHandler(){this.ionLifeCycleContext.ionViewWillEnter()}ionViewDidEnterHandler(){this.ionLifeCycleContext.ionViewDidEnter()}ionViewWillLeaveHandler(){this.ionLifeCycleContext.ionViewWillLeave()}ionViewDidLeaveHandler(){this.ionLifeCycleContext.ionViewDidLeave()}render(){const e=this.props,{className:t,children:n,routeInfo:r,forwardedRef:a}=e,i=Ug(e,["className","children","routeInfo","forwardedRef"]);return V.createElement(Px.Consumer,null,(e=>(this.ionLifeCycleContext=e,V.createElement("div",Object.assign({className:t?`${t} ion-page`:"ion-page",ref:this.stableMergedRefs},i),n))))}static get contextType(){return vw}}class ww extends V.Component{constructor(e){super(e)}render(){const e=this.props,{className:t,children:n,forwardedRef:r}=e,a=Ug(e,["className","children","forwardedRef"]);return this.context.hasIonicRouter()?V.createElement(xw,Object.assign({className:t?`${t}`:"",routeInfo:this.context.routeInfo,forwardedRef:r},a),n):V.createElement("div",Object.assign({className:t?`ion-page ${t}`:"ion-page",ref:r},a),n)}static get displayName(){return"IonPage"}static get contextType(){return Lx}}rw(ww,"IonPage");const kw=qx("ion-nav",void 0,void 0,Kb),Sw=rw((e=>{var{children:t,forwardedRef:n}=e,r=Ug(e,["children","forwardedRef"]);const[a,i]=W.useState([]),s=e=>i((t=>[...t,e])),o=e=>i((t=>t.filter((t=>t!==e)))),l=W.useMemo((()=>((e,t)=>{const n=new WeakMap;return{attachViewToDom:async(t,r,a,i)=>{const s=document.createElement("div");i&&s.classList.add(...i),t.appendChild(s);const o=r(a),l=ac.createPortal(o,s);return n.set(s,l),e(l),Promise.resolve(s)},removeViewFromDom:(e,r)=>{const a=n.get(r);return a&&t(a),r.remove(),Promise.resolve()}}})(s,o)),[]);return V.createElement(kw,Object.assign({delegate:l,ref:n},r),a)}),"IonNav");V.createContext({activeTab:void 0,selectTab:()=>!1});const Iw="undefined"!=typeof HTMLElement?HTMLElement:class{};class Nw extends V.Component{constructor(e){super(e),this.outletIsReady=!1}componentDidMount(){this.ionRouterOutlet&&(this.outletIsReady||em(this.ionRouterOutlet,(()=>{this.outletIsReady=!0,this.context.registerIonPage(this.ionRouterOutlet,this.props.routeInfo)})),this.ionRouterOutlet.addEventListener("ionViewWillEnter",this.ionViewWillEnterHandler.bind(this)),this.ionRouterOutlet.addEventListener("ionViewDidEnter",this.ionViewDidEnterHandler.bind(this)),this.ionRouterOutlet.addEventListener("ionViewWillLeave",this.ionViewWillLeaveHandler.bind(this)),this.ionRouterOutlet.addEventListener("ionViewDidLeave",this.ionViewDidLeaveHandler.bind(this)))}componentWillUnmount(){this.ionRouterOutlet&&(this.ionRouterOutlet.removeEventListener("ionViewWillEnter",this.ionViewWillEnterHandler.bind(this)),this.ionRouterOutlet.removeEventListener("ionViewDidEnter",this.ionViewDidEnterHandler.bind(this)),this.ionRouterOutlet.removeEventListener("ionViewWillLeave",this.ionViewWillLeaveHandler.bind(this)),this.ionRouterOutlet.removeEventListener("ionViewDidLeave",this.ionViewDidLeaveHandler.bind(this)))}ionViewWillEnterHandler(){this.ionLifeCycleContext.ionViewWillEnter()}ionViewDidEnterHandler(){this.ionLifeCycleContext.ionViewDidEnter()}ionViewWillLeaveHandler(){this.ionLifeCycleContext.ionViewWillLeave()}ionViewDidLeaveHandler(){this.ionLifeCycleContext.ionViewDidLeave()}render(){const e=this.props,{StackManager:t,children:n,routeInfo:r}=e,a=Ug(e,["StackManager","children","routeInfo"]);return V.createElement(Px.Consumer,null,(e=>(this.ionLifeCycleContext=e,V.createElement(t,{routeInfo:r},V.createElement(mw,Object.assign({setRef:e=>this.ionRouterOutlet=e},a),n)))))}static get contextType(){return vw}}class Cw extends V.Component{constructor(e){super(e)}render(){const e=this.context.getStackManager(),t=this.props,{children:n,forwardedRef:r}=t,a=Ug(t,["children","forwardedRef"]);return this.context.hasIonicRouter()?a.ionPage?V.createElement(Nw,Object.assign({StackManager:e,routeInfo:this.context.routeInfo},a),n):V.createElement(e,{routeInfo:this.context.routeInfo},V.createElement(mw,Object.assign({},a,{forwardedRef:r}),n)):V.createElement(mw,Object.assign({ref:r},this.props),this.props.children)}static get contextType(){return Lx}}const Tw=rw(Cw,"IonRouterOutlet"),Ew=(()=>class extends V.Component{constructor(e){super(e),this.handleIonTabButtonClick=this.handleIonTabButtonClick.bind(this)}handleIonTabButtonClick(){this.props.onClick&&this.props.onClick(new CustomEvent("ionTabButtonClick",{detail:{tab:this.props.tab,href:this.props.href,routeOptions:this.props.routerOptions}}))}render(){const e=Ug(this.props,["onClick"]);return V.createElement(hw,Object.assign({onIonTabButtonClick:this.handleIonTabButtonClick},e))}static get displayName(){return"IonTabButton"}})();class _w extends V.PureComponent{constructor(e){super(e),this.setActiveTabOnContext=e=>{};const t={};V.Children.forEach(e.children,(n=>{var r,a,i,s;null!=n&&"object"==typeof n&&n.props&&(n.type===Ew||n.type.isTabButton)&&(t[n.props.tab]={originalHref:n.props.href,currentHref:n.props.href,originalRouteOptions:n.props.href===(null===(r=e.routeInfo)||void 0===r?void 0:r.pathname)?null===(a=e.routeInfo)||void 0===a?void 0:a.routeOptions:void 0,currentRouteOptions:n.props.href===(null===(i=e.routeInfo)||void 0===i?void 0:i.pathname)?null===(s=e.routeInfo)||void 0===s?void 0:s.routeOptions:void 0})})),this.state={tabs:t},this.onTabButtonClick=this.onTabButtonClick.bind(this),this.renderTabButton=this.renderTabButton.bind(this),this.setActiveTabOnContext=this.setActiveTabOnContext.bind(this),this.selectTab=this.selectTab.bind(this)}componentDidMount(){const e=this.state.tabs,t=Object.keys(e).find((t=>{const n=e[t].originalHref;return this.props.routeInfo.pathname.startsWith(n)}));t&&this.setState({activeTab:t})}componentDidUpdate(){this.state.activeTab&&this.setActiveTabOnContext(this.state.activeTab)}selectTab(e){const t=this.state.tabs[e];return!!t&&(this.onTabButtonClick(new CustomEvent("ionTabButtonClick",{detail:{href:t.currentHref,tab:e,selected:e===this.state.activeTab,routeOptions:void 0}})),!0)}static getDerivedStateFromProps(e,t){var n,r,a;const i=Object.assign({},t.tabs),s=Object.keys(t.tabs).find((n=>{const r=t.tabs[n].originalHref;return e.routeInfo.pathname.startsWith(r)}));V.Children.forEach(e.children,(e=>{if(null!=e&&"object"==typeof e&&e.props&&(e.type===Ew||e.type.isTabButton)){const t=i[e.props.tab];t&&t.originalHref===e.props.href||(i[e.props.tab]={originalHref:e.props.href,currentHref:e.props.href,originalRouteOptions:e.props.routeOptions,currentRouteOptions:e.props.routeOptions})}}));const{activeTab:o}=t;if(s&&o){const l=t.tabs[o].currentHref,u=t.tabs[o].currentRouteOptions;s===o&&l===(null===(n=e.routeInfo)||void 0===n?void 0:n.pathname)&&u===(null===(r=e.routeInfo)||void 0===r?void 0:r.routeOptions)||(i[s]={originalHref:i[s].originalHref,currentHref:e.routeInfo.pathname+(e.routeInfo.search||""),originalRouteOptions:i[s].originalRouteOptions,currentRouteOptions:null===(a=e.routeInfo)||void 0===a?void 0:a.routeOptions},"pop"===e.routeInfo.routeAction&&s!==o&&(i[o]={originalHref:i[o].originalHref,currentHref:i[o].originalHref,originalRouteOptions:i[o].originalRouteOptions,currentRouteOptions:i[o].currentRouteOptions}))}return s&&e.onSetCurrentTab(s,e.routeInfo),{activeTab:s,tabs:i}}onTabButtonClick(e,t){const n=this.state.tabs[e.detail.tab],r=n.originalHref,a=e.detail.href,{activeTab:i}=this.state;t&&t(e),i===e.detail.tab?r!==a&&this.context.resetTab(e.detail.tab,r,n.originalRouteOptions):(this.props.onIonTabsWillChange&&this.props.onIonTabsWillChange(new CustomEvent("ionTabWillChange",{detail:{tab:e.detail.tab}})),this.props.onIonTabsDidChange&&this.props.onIonTabsDidChange(new CustomEvent("ionTabDidChange",{detail:{tab:e.detail.tab}})),this.setActiveTabOnContext(e.detail.tab),this.context.changeTab(e.detail.tab,a,e.detail.routeOptions))}renderTabButton(e){return t=>{var n,r;if(null!=t&&t.props&&(t.type===Ew||t.type.isTabButton)){const a=t.props.tab===e?null===(n=this.props.routeInfo)||void 0===n?void 0:n.pathname:this.state.tabs[t.props.tab].currentHref,i=t.props.tab===e?null===(r=this.props.routeInfo)||void 0===r?void 0:r.routeOptions:this.state.tabs[t.props.tab].currentRouteOptions;return V.cloneElement(t,{href:a,routeOptions:i,onClick:e=>this.onTabButtonClick(e,t.props.onClick)})}return null}}render(){const{activeTab:e}=this.state;return V.createElement(fw,Object.assign({},this.props,{selectedTab:e}),V.Children.map(this.props.children,this.renderTabButton(e)))}static get contextType(){return Lx}}const $w=V.memo((e=>{var{forwardedRef:t}=e,n=Ug(e,["forwardedRef"]);const r=W.useContext(Lx);return V.createElement(_w,Object.assign({ref:t},n,{routeInfo:n.routeInfo||r.routeInfo||{pathname:window.location.pathname},onSetCurrentTab:r.setCurrentTab}),n.children)}));rw($w,"IonTabBar");class Aw extends Iw{constructor(){super()}}"undefined"!=typeof window&&window.customElements&&(window.customElements.get("ion-tabs")||window.customElements.define("ion-tabs",Aw));class Rw extends V.PureComponent{constructor(e){super(e),this.props.name&&console.warn('In Ionic React, you import icons from "ionicons/icons" and set the icon you imported to the "icon" property. Setting the "name" property has no effect.')}render(){var e,t;const n=this.props,{icon:r,ios:a,md:i,mode:s}=n,o=Ug(n,["icon","ios","md","mode"]);let l;const u=aw(),d=s||(null==u?void 0:u.get("mode"));return l=a||i?"ios"===d?null!==(e=null!=a?a:i)&&void 0!==e?e:r:null!==(t=null!=i?i:a)&&void 0!==t?t:r:r,V.createElement(bw,Object.assign({ref:this.props.forwardedRef,icon:l},o),this.props.children)}static get contextType(){return Lx}}rw(Rw,"IonIcon");class Dw extends V.PureComponent{render(){const e=this.context.getIonRoute();return this.context.hasIonicRouter()&&Dw?V.createElement(e,Object.assign({},this.props)):(console.error("You either do not have an Ionic Router package, or your router does not support using <IonRoute>"),null)}static get contextType(){return Lx}}V.PureComponent;const Fw=V.createContext({routeInfo:void 0,push:()=>{throw new Error("An Ionic Router is required for IonRouterContext")},back:()=>{throw new Error("An Ionic Router is required for IonRouterContext")},canGoBack:()=>{throw new Error("An Ionic Router is required for IonRouterContext")},nativeBack:()=>{throw new Error("An Ionic Router is required for IonRouterContext")}});V.PureComponent;const Mw={main:0},Ow=(e="main")=>{var t;const n=(null!==(t=Mw[e])&&void 0!==t?t:0)+1;return Mw[e]=n,n.toString()},Pw=(e={})=>{"undefined"!=typeof document&&document.documentElement.classList.add("ion-ce"),wg(Object.assign({},e))},Lw=V.createContext({addViewItem:()=>{},canGoBack:()=>{},clearOutlet:()=>{},createViewItem:()=>{},findViewItemByPathname:()=>{},findLeavingViewItemByRouteInfo:()=>{},findViewItemByRouteInfo:()=>{},getChildrenToRender:()=>{},goBack:()=>{},unMountViewItem:()=>{}});class zw extends V.Component{constructor(e){super(e),this.ionLifeCycleContext=new class{constructor(){this.ionViewWillEnterCallbacks=[],this.ionViewDidEnterCallbacks=[],this.ionViewWillLeaveCallbacks=[],this.ionViewDidLeaveCallbacks=[]}onIonViewWillEnter(e){if(e.id){const t=this.ionViewWillEnterCallbacks.findIndex((t=>t.id===e.id));t>-1?this.ionViewWillEnterCallbacks[t]=e:this.ionViewWillEnterCallbacks.push(e)}else this.ionViewWillEnterCallbacks.push(e)}ionViewWillEnter(){this.ionViewWillEnterCallbacks.forEach((e=>e()))}onIonViewDidEnter(e){if(e.id){const t=this.ionViewDidEnterCallbacks.findIndex((t=>t.id===e.id));t>-1?this.ionViewDidEnterCallbacks[t]=e:this.ionViewDidEnterCallbacks.push(e)}else this.ionViewDidEnterCallbacks.push(e)}ionViewDidEnter(){this.ionViewDidEnterCallbacks.forEach((e=>e()))}onIonViewWillLeave(e){if(e.id){const t=this.ionViewWillLeaveCallbacks.findIndex((t=>t.id===e.id));t>-1?this.ionViewWillLeaveCallbacks[t]=e:this.ionViewWillLeaveCallbacks.push(e)}else this.ionViewWillLeaveCallbacks.push(e)}ionViewWillLeave(){this.ionViewWillLeaveCallbacks.forEach((e=>e()))}onIonViewDidLeave(e){if(e.id){const t=this.ionViewDidLeaveCallbacks.findIndex((t=>t.id===e.id));t>-1?this.ionViewDidLeaveCallbacks[t]=e:this.ionViewDidLeaveCallbacks.push(e)}else this.ionViewDidLeaveCallbacks.push(e)}ionViewDidLeave(){this.ionViewDidLeaveCallbacks.forEach((e=>e())),this.componentCanBeDestroyed()}onComponentCanBeDestroyed(e){this.componentCanBeDestroyedCallback=e}componentCanBeDestroyed(){this.componentCanBeDestroyedCallback&&this.componentCanBeDestroyedCallback()}},this._isMounted=!1,this.ionLifeCycleContext.onComponentCanBeDestroyed((()=>{this.props.mount||this._isMounted&&this.setState({show:!1},(()=>this.props.removeView()))})),this.state={show:!0}}componentDidMount(){this._isMounted=!0}componentWillUnmount(){this._isMounted=!1}render(){const{show:e}=this.state;return V.createElement(Px.Provider,{value:this.ionLifeCycleContext},e&&this.props.children)}}class Bw{constructor(){this.locationHistory=[],this.tabHistory={}}add(e){"push"===e.routeAction||null==e.routeAction?this._add(e):"pop"===e.routeAction?this._pop(e):"replace"===e.routeAction&&this._replace(e),"root"===e.routeDirection&&(this._clear(),this._add(e))}clearTabStack(e){const t=this._getRouteInfosByKey(e);t&&(t.forEach((e=>{this.locationHistory=this.locationHistory.filter((t=>t.id!==e.id))})),this.tabHistory[e]=[])}update(e){const t=this.locationHistory.findIndex((t=>t.id===e.id));t>-1&&this.locationHistory.splice(t,1,e);const n=this.tabHistory[e.tab||""];if(n){const t=n.findIndex((t=>t.id===e.id));t>-1?n.splice(t,1,e):n.push(e)}else e.tab&&(this.tabHistory[e.tab]=[e])}_add(e){const t=this._getRouteInfosByKey(e.tab);t&&(this._areRoutesEqual(t[t.length-1],e)&&t.pop(),t.push(e)),this.locationHistory.push(e)}_areRoutesEqual(e,t){return!(!e||!t)&&e.pathname===t.pathname&&e.search===t.search}_pop(e){const t=this._getRouteInfosByKey(e.tab);t&&(t.pop(),t.pop(),t.push(e)),this.locationHistory.pop(),this.locationHistory.pop(),this.locationHistory.push(e)}_replace(e){const t=this._getRouteInfosByKey(e.tab);t&&t.pop(),this.locationHistory.pop(),this._add(e)}_clear(){Object.keys(this.tabHistory).forEach((e=>this.tabHistory[e]=[])),this.locationHistory=[]}_getRouteInfosByKey(e){let t;return e&&(t=this.tabHistory[e],t||(t=this.tabHistory[e]=[])),t}getFirstRouteInfoForTab(e){const t=this._getRouteInfosByKey(e);if(t)return t[0]}getCurrentRouteInfoForTab(e){const t=this._getRouteInfosByKey(e);if(t)return t[t.length-1]}findLastLocation(e){const t=this._getRouteInfosByKey(e.tab);if(t)for(let n=t.length-2;n>=0;n--){const r=t[n];if(r&&r.pathname===e.pushedByRoute)return r}for(let n=this.locationHistory.length-2;n>=0;n--){const t=this.locationHistory[n];if(t&&t.pathname===e.pushedByRoute)return t}}previous(){return this.locationHistory[this.locationHistory.length-2]||this.locationHistory[this.locationHistory.length-1]}current(){return this.locationHistory[this.locationHistory.length-1]}canGoBack(){return this.locationHistory.length>1}}class Ww extends V.PureComponent{constructor(e){super(e),this.ionRouterContextValue={push:(e,t,n,r,a)=>{this.navigate(e,t,n,a,r)},back:e=>{this.goBack(void 0,e)},canGoBack:()=>this.props.locationHistory.canGoBack(),nativeBack:()=>this.props.onNativeBack(),routeInfo:this.props.routeInfo},this.state={goBack:this.goBack.bind(this),hasIonicRouter:()=>!0,navigate:this.navigate.bind(this),getIonRedirect:this.getIonRedirect.bind(this),getIonRoute:this.getIonRoute.bind(this),getStackManager:this.getStackManager.bind(this),getPageManager:this.getPageManager.bind(this),routeInfo:this.props.routeInfo,setCurrentTab:this.props.onSetCurrentTab,changeTab:this.props.onChangeTab,resetTab:this.props.onResetTab}}componentDidMount(){"undefined"!=typeof document&&(this.handleHardwareBackButton=this.handleHardwareBackButton.bind(this),document.addEventListener("ionBackButton",this.handleHardwareBackButton))}componentWillUnmount(){"undefined"!=typeof document&&document.removeEventListener("ionBackButton",this.handleHardwareBackButton)}handleHardwareBackButton(e){e.detail.register(0,(e=>{this.nativeGoBack(),e()}))}goBack(e,t){this.props.onNavigateBack(e,t)}nativeGoBack(){this.props.onNativeBack()}navigate(e,t="forward",n="push",r,a,i){this.props.onNavigate(e,n,t,r,a,i)}getPageManager(){return xw}getIonRedirect(){return this.props.ionRedirect}getIonRoute(){return this.props.ionRoute}getStackManager(){return this.props.stackManager}render(){return V.createElement(Lx.Provider,{value:Object.assign(Object.assign({},this.state),{routeInfo:this.props.routeInfo})},V.createElement(Fw.Provider,{value:Object.assign(Object.assign({},this.ionRouterContextValue),{routeInfo:this.props.routeInfo})},this.props.children))}}class Vw{constructor(){this.viewStacks={},this.add=this.add.bind(this),this.clear=this.clear.bind(this),this.getViewItemsForOutlet=this.getViewItemsForOutlet.bind(this),this.remove=this.remove.bind(this)}add(e){const{outletId:t}=e;this.viewStacks[t]?this.viewStacks[t].push(e):this.viewStacks[t]=[e]}clear(e){return setTimeout((()=>{delete this.viewStacks[e]}),500)}getViewItemsForOutlet(e){return this.viewStacks[e]||[]}remove(e){const{outletId:t}=e,n=this.viewStacks[t];if(n){const r=n.find((t=>t.id===e.id));r&&(r.mount=!1,this.viewStacks[t]=n.filter((e=>e.id!==r.id)))}}getStackIds(){return Object.keys(this.viewStacks)}getAllViewItems(){const e=this.getStackIds(),t=[];return e.forEach((e=>{t.push(...this.viewStacks[e])})),t}}class Uw extends V.PureComponent{render(){return V.createElement(bh,Object.assign({path:this.props.path,exact:this.props.exact,render:this.props.render},void 0!==this.props.computedMatch?{computedMatch:this.props.computedMatch}:{}))}}class jw extends Vw{constructor(){super(),this.createViewItem=this.createViewItem.bind(this),this.findViewItemByRouteInfo=this.findViewItemByRouteInfo.bind(this),this.findLeavingViewItemByRouteInfo=this.findLeavingViewItemByRouteInfo.bind(this),this.getChildrenToRender=this.getChildrenToRender.bind(this),this.findViewItemByPathname=this.findViewItemByPathname.bind(this)}createViewItem(e,t,n,r){const a={id:Ow("viewItem"),outletId:e,ionPageElement:r,reactElement:t,mount:!0,ionRoute:!1},i={exact:t.props.exact,path:t.props.path||t.props.from,component:t.props.component},s=gh(n.pathname,i);return t.type===Dw&&(a.ionRoute=!0,a.disableIonPageManagement=t.props.disableIonPageManagement),a.routeData={match:s,childProps:t.props},a}getChildrenToRender(e,t,n){const r=this.getViewItemsForOutlet(e);return V.Children.forEach(t.props.children,(e=>{const t=r.find((t=>Hw(e,t.routeData.childProps.path||t.routeData.childProps.from)));t&&(t.reactElement=e)})),r.map((e=>{let t;if(e.ionRoute&&!e.disableIonPageManagement)t=V.createElement(zw,{key:`view-${e.id}`,mount:e.mount,removeView:()=>this.remove(e)},V.cloneElement(e.reactElement,{computedMatch:e.routeData.match}));else{const r=Hw(e.reactElement,n.pathname);t=V.createElement(zw,{key:`view-${e.id}`,mount:e.mount,removeView:()=>this.remove(e)},V.cloneElement(e.reactElement,{computedMatch:e.routeData.match})),!r&&e.routeData.match&&(e.routeData.match=void 0,e.mount=!1)}return t}))}findViewItemByRouteInfo(e,t,n){const{viewItem:r,match:a}=this.findViewItemByPath(e.pathname,t);return(void 0===n||!0===n)&&r&&a&&(r.routeData.match=a),r}findLeavingViewItemByRouteInfo(e,t,n=!0){const{viewItem:r}=this.findViewItemByPath(e.lastPathname,t,!1,n);return r}findViewItemByPathname(e,t){const{viewItem:n}=this.findViewItemByPath(e,t);return n}findViewItemByPath(e,t,n,r){let a,i,s;if(t)s=this.getViewItemsForOutlet(t),s.some(o),a||s.some(l);else{const e=this.getAllViewItems();e.some(o),a||e.some(l)}return{viewItem:a,match:i};function o(t){if(r&&!t.ionRoute)return!1;const s={exact:!!n||t.routeData.childProps.exact,path:t.routeData.childProps.path||t.routeData.childProps.from,component:t.routeData.childProps.component},o=gh(e,s);return!!o&&(a=t,i=o,!0)}function l(t){return!t.routeData.childProps.path&&!t.routeData.childProps.from&&(i={path:e,url:e,isExact:!0,params:{}},a=t,!0)}}}function Hw(e,t,n){return gh(t,{exact:!!n||e.props.exact,path:e.props.path||e.props.from,component:e.props.component})}const Gw=e=>!e.classList.contains("ion-page-invisible")&&!e.classList.contains("ion-page-hidden");class qw extends V.PureComponent{constructor(e){super(e),this.stackContextValue={registerIonPage:this.registerIonPage.bind(this),isInOutlet:()=>!0},this.pendingPageTransition=!1,this.registerIonPage=this.registerIonPage.bind(this),this.transitionPage=this.transitionPage.bind(this),this.handlePageTransition=this.handlePageTransition.bind(this),this.id=Ow("routerOutlet"),this.prevProps=void 0,this.skipTransition=!1}componentDidMount(){this.clearOutletTimeout&&clearTimeout(this.clearOutletTimeout),this.routerOutletElement&&(this.setupRouterOutlet(this.routerOutletElement),this.handlePageTransition(this.props.routeInfo))}componentDidUpdate(e){const{pathname:t}=this.props.routeInfo,{pathname:n}=e.routeInfo;t!==n?(this.prevProps=e,this.handlePageTransition(this.props.routeInfo)):this.pendingPageTransition&&(this.handlePageTransition(this.props.routeInfo),this.pendingPageTransition=!1)}componentWillUnmount(){this.clearOutletTimeout=this.context.clearOutlet(this.id)}async handlePageTransition(e){var t,n;if(this.routerOutletElement&&this.routerOutletElement.commit){let r=this.context.findViewItemByRouteInfo(e,this.id),a=this.context.findLeavingViewItemByRouteInfo(e,this.id);!a&&e.prevRouteLastPathname&&(a=this.context.findViewItemByPathname(e.prevRouteLastPathname,this.id)),a&&("replace"===e.routeAction?a.mount=!1:"push"!==e.routeAction||"forward"!==e.routeDirection?"none"!==e.routeDirection&&r!==a&&(a.mount=!1):(null===(t=e.routeOptions)||void 0===t?void 0:t.unmount)&&(a.mount=!1));const i=function(e,t){let n;return V.Children.forEach(e,(e=>{const r={exact:e.props.exact,path:e.props.path||e.props.from,component:e.props.component};gh(t.pathname,r)&&(n=e)})),n||(V.Children.forEach(e,(e=>{e.props.path||e.props.from||(n=e)})),n)}(null===(n=this.ionRouterOutlet)||void 0===n?void 0:n.props.children,e);if(r?r.reactElement=i:i&&(r=this.context.createViewItem(this.id,i,e),this.context.addViewItem(r)),r&&r.ionPageElement){if(r===a&&r.routeData.match.url!==e.pathname)return;if(!a&&this.props.routeInfo.prevRouteLastPathname&&(a=this.context.findViewItemByPathname(this.props.routeInfo.prevRouteLastPathname,this.id)),Gw(r.ionPageElement)&&void 0!==a&&!Gw(a.ionPageElement))return;this.transitionPage(e,r,a)}else!a||i||r||a.ionPageElement&&(a.ionPageElement.classList.add("ion-page-hidden"),a.ionPageElement.setAttribute("aria-hidden","true"));this.forceUpdate()}else this.pendingPageTransition=!0}registerIonPage(e,t){const n=this.context.findViewItemByRouteInfo(t,this.id);if(n){const t=n.ionPageElement;if(n.ionPageElement=e,n.ionRoute=!0,t===e)return}this.handlePageTransition(t)}async setupRouterOutlet(e){e.swipeHandler={canStart:()=>{const t=aw();if(!t||!t.get("swipeBackEnabled","ios"===e.mode))return!1;const{routeInfo:n}=this.props,r=this.prevProps&&this.prevProps.routeInfo.pathname===n.pushedByRoute?this.prevProps.routeInfo:{pathname:n.pushedByRoute||""},a=this.context.findViewItemByRouteInfo(r,this.id,!1);return!!a&&a.mount&&a.routeData.match.path!==n.pathname},onStart:async()=>{const{routeInfo:e}=this.props,t=this.prevProps&&this.prevProps.routeInfo.pathname===e.pushedByRoute?this.prevProps.routeInfo:{pathname:e.pushedByRoute||""},n=this.context.findViewItemByRouteInfo(t,this.id,!1),r=this.context.findViewItemByRouteInfo(e,this.id,!1);return n&&r&&await this.transitionPage(e,n,r,"back",!0),Promise.resolve()},onEnd:e=>{if(e)this.skipTransition=!0,this.context.goBack();else{const{routeInfo:e}=this.props,t=this.prevProps&&this.prevProps.routeInfo.pathname===e.pushedByRoute?this.prevProps.routeInfo:{pathname:e.pushedByRoute||""},n=this.context.findViewItemByRouteInfo(t,this.id,!1);if(n!==this.context.findViewItemByRouteInfo(e,this.id,!1)&&void 0!==(null==n?void 0:n.ionPageElement)){const{ionPageElement:e}=n;e.setAttribute("aria-hidden","true"),e.classList.add("ion-page-hidden")}}}}}async transitionPage(e,t,n,r,a=!1){const i=async(t,n)=>{const r=this.skipTransition;r?this.skipTransition=!1:(t.classList.add("ion-page"),t.classList.add("ion-page-invisible")),await s.commit(t,n,{duration:r||void 0===l?0:void 0,direction:l,showGoBack:!!e.pushedByRoute,progressAnimation:a,animationBuilder:e.routeAnimation})},s=this.routerOutletElement,o="none"===e.routeDirection||"root"===e.routeDirection?void 0:e.routeDirection,l=null!=r?r:o;if(t&&t.ionPageElement&&this.routerOutletElement)if(n&&n.ionPageElement&&t===n)if(function(e,t,n){const r={exact:!!n||e.props.exact,path:e.props.path||e.props.from,component:e.props.component},a=gh(t,r);return a}(n.reactElement,e.pathname,!0)){const e=function(e){let t;if(t="string"==typeof e?e:e.outerHTML,document){const e=document.createElement("div");e.innerHTML=t,e.style.zIndex="";const n=e.getElementsByTagName("ion-back-button");return n[0]&&n[0].remove(),e.firstChild}}(n.ionPageElement.outerHTML);e&&(this.routerOutletElement.appendChild(e),await i(t.ionPageElement,e),this.routerOutletElement.removeChild(e))}else await i(t.ionPageElement,void 0);else await i(t.ionPageElement,null==n?void 0:n.ionPageElement),n&&n.ionPageElement&&!a&&(n.ionPageElement.classList.add("ion-page-hidden"),n.ionPageElement.setAttribute("aria-hidden","true"))}render(){const{children:e}=this.props,t=V.Children.only(e);this.ionRouterOutlet=t;const n=this.context.getChildrenToRender(this.id,this.ionRouterOutlet,this.props.routeInfo,(()=>{this.forceUpdate()}));return V.createElement(vw.Provider,{value:this.stackContextValue},V.cloneElement(t,{ref:e=>{t.props.setRef&&t.props.setRef(e),t.props.forwardedRef&&(t.props.forwardedRef.current=e),this.routerOutletElement=e;const{ref:n}=t;"function"==typeof n&&n(e)}},n))}static get contextType(){return Lw}}class Kw extends V.PureComponent{constructor(e){super(e),this.exitViewFromOtherOutletHandlers=[],this.locationHistory=new Bw,this.viewStack=new jw,this.routeMangerContextState={canGoBack:()=>this.locationHistory.canGoBack(),clearOutlet:this.viewStack.clear,findViewItemByPathname:this.viewStack.findViewItemByPathname,getChildrenToRender:this.viewStack.getChildrenToRender,goBack:()=>this.handleNavigateBack(),createViewItem:this.viewStack.createViewItem,findViewItemByRouteInfo:this.viewStack.findViewItemByRouteInfo,findLeavingViewItemByRouteInfo:this.viewStack.findLeavingViewItemByRouteInfo,addViewItem:this.viewStack.add,unMountViewItem:this.viewStack.remove};const t={id:Ow("routeInfo"),pathname:this.props.location.pathname,search:this.props.location.search};this.locationHistory.add(t),this.handleChangeTab=this.handleChangeTab.bind(this),this.handleResetTab=this.handleResetTab.bind(this),this.handleNativeBack=this.handleNativeBack.bind(this),this.handleNavigate=this.handleNavigate.bind(this),this.handleNavigateBack=this.handleNavigateBack.bind(this),this.props.registerHistoryListener(this.handleHistoryChange.bind(this)),this.handleSetCurrentTab=this.handleSetCurrentTab.bind(this),this.state={routeInfo:t}}handleChangeTab(e,t,n){if(!t)return;const r=this.locationHistory.getCurrentRouteInfoForTab(e),[a,i]=t.split("?");r?(this.incomingRouteParams=Object.assign(Object.assign({},r),{routeAction:"push",routeDirection:"none"}),r.pathname===a?(this.incomingRouteParams.routeOptions=n,this.props.history.push(r.pathname+(r.search||""))):(this.incomingRouteParams.pathname=a,this.incomingRouteParams.search=i?"?"+i:void 0,this.incomingRouteParams.routeOptions=n,this.props.history.push(a+(i?"?"+i:"")))):this.handleNavigate(a,"push","none",void 0,n,e)}handleHistoryChange(e,t){var n,r,a;let i;if(i=this.incomingRouteParams&&"replace"===this.incomingRouteParams.routeAction?this.locationHistory.previous():this.locationHistory.current(),i.pathname+i.search!==e.pathname){if(!this.incomingRouteParams){if("REPLACE"===t&&(this.incomingRouteParams={routeAction:"replace",routeDirection:"none",tab:this.currentTab}),"POP"===t){const e=this.locationHistory.current();if(e&&e.pushedByRoute){const t=this.locationHistory.findLastLocation(e);this.incomingRouteParams=Object.assign(Object.assign({},t),{routeAction:"pop",routeDirection:"back"})}else this.incomingRouteParams={routeAction:"pop",routeDirection:"none",tab:this.currentTab}}this.incomingRouteParams||(this.incomingRouteParams={routeAction:"push",routeDirection:(null===(n=e.state)||void 0===n?void 0:n.direction)||"forward",routeOptions:null===(r=e.state)||void 0===r?void 0:r.routerOptions,tab:this.currentTab})}let s;if(null===(a=this.incomingRouteParams)||void 0===a?void 0:a.id)s=Object.assign(Object.assign({},this.incomingRouteParams),{lastPathname:i.pathname}),this.locationHistory.add(s);else{const t="push"===this.incomingRouteParams.routeAction&&"forward"===this.incomingRouteParams.routeDirection;if(s=Object.assign(Object.assign({id:Ow("routeInfo")},this.incomingRouteParams),{lastPathname:i.pathname,pathname:e.pathname,search:e.search,params:this.props.match.params,prevRouteLastPathname:i.lastPathname}),t)s.tab=i.tab,s.pushedByRoute=i.pathname;else if("pop"===s.routeAction){const e=this.locationHistory.findLastLocation(s);s.pushedByRoute=null==e?void 0:e.pushedByRoute}else if("push"===s.routeAction&&s.tab!==i.tab){const e=this.locationHistory.getCurrentRouteInfoForTab(s.tab);s.pushedByRoute=null==e?void 0:e.pushedByRoute}else if("replace"===s.routeAction){const e=this.locationHistory.current(),t=null==e?void 0:e.pushedByRoute,n=void 0!==t&&t!==s.pathname?t:s.pushedByRoute;s.lastPathname=(null==e?void 0:e.pathname)||s.lastPathname,s.prevRouteLastPathname=null==e?void 0:e.lastPathname,s.pushedByRoute=n,s.routeDirection=(null==e?void 0:e.routeDirection)||s.routeDirection,s.routeAnimation=(null==e?void 0:e.routeAnimation)||s.routeAnimation}this.locationHistory.add(s)}this.setState({routeInfo:s})}this.incomingRouteParams=void 0}handleNativeBack(){const e=this.props.history;(e.goBack||e.back)()}handleNavigate(e,t,n,r,a,i){this.incomingRouteParams=Object.assign(this.incomingRouteParams||{},{routeAction:t,routeDirection:n,routeOptions:a,routeAnimation:r,tab:i}),"push"===t?this.props.history.push(e):this.props.history.replace(e)}handleNavigateBack(e="/",t){const n=aw();e=e||n&&n.get("backButtonDefaultHref");const r=this.locationHistory.current();if(r&&r.pushedByRoute){const n=this.locationHistory.findLastLocation(r);if(n)if(this.incomingRouteParams=Object.assign(Object.assign({},n),{routeAction:"pop",routeDirection:"back",routeAnimation:t||r.routeAnimation}),r.lastPathname===r.pushedByRoute||n.pathname===r.pushedByRoute&&""===r.tab&&""===n.tab){const e=this.props.history;(e.goBack||e.back)()}else this.handleNavigate(n.pathname+(n.search||""),"pop","back");else this.handleNavigate(e,"pop","back")}else this.handleNavigate(e,"pop","back")}handleResetTab(e,t,n){const r=this.locationHistory.getFirstRouteInfoForTab(e);if(r){const e=Object.assign({},r);e.pathname=t,e.routeOptions=n,this.incomingRouteParams=Object.assign(Object.assign({},e),{routeAction:"pop",routeDirection:"back"}),this.props.history.push(e.pathname+(e.search||""))}}handleSetCurrentTab(e){this.currentTab=e;const t=Object.assign({},this.locationHistory.current());t.tab!==e&&(t.tab=e,this.locationHistory.update(t))}render(){return V.createElement(Lw.Provider,{value:this.routeMangerContextState},V.createElement(Ww,{ionRoute:Uw,ionRedirect:{},stackManager:qw,routeInfo:this.state.routeInfo,onNativeBack:this.handleNativeBack,onNavigateBack:this.handleNavigateBack,onNavigate:this.handleNavigate,onSetCurrentTab:this.handleSetCurrentTab,onChangeTab:this.handleChangeTab,onResetTab:this.handleResetTab,locationHistory:this.locationHistory},this.props.children))}}const Xw=function(e){var t="withRouter("+(e.displayName||e.name)+")",n=function(t){var n=t.wrappedComponentRef,r=gp(t,["wrappedComponentRef"]);return V.createElement(ih.Consumer,null,(function(t){return t||wc(!1),V.createElement(e,fc({},r,t,{ref:n}))}))};return n.displayName=t,n.WrappedComponent=e,Qp(n,e)}(Kw);Xw.displayName="IonRouter";class Yw extends V.Component{constructor(e){super(e);const{history:t}=e,n=Ug(e,["history"]);this.history=t||Fc(n),this.history.listen(this.handleHistoryChange.bind(this)),this.registerHistoryListener=this.registerHistoryListener.bind(this)}handleHistoryChange(e,t){const n=e.location||e,r=e.action||t;this.historyListenHandler&&this.historyListenHandler(n,r)}registerHistoryListener(e){this.historyListenHandler=e}render(){const e=this.props,{children:t}=e,n=Ug(e,["children"]);return V.createElement(sh,Object.assign({history:this.history},n),V.createElement(Xw,{registerHistoryListener:this.registerHistoryListener},t))}}V.Component,V.Component;var Jw=Object.defineProperty,Zw=(e=>"undefined"!=typeof require?require:"undefined"!=typeof Proxy?new Proxy(e,{get:(e,t)=>("undefined"!=typeof require?require:e)[t]}):e)((function(e){if("undefined"!=typeof require)return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')})),Qw=(e,t)=>{for(var n in t)Jw(e,n,{get:t[n],enumerable:!0})};Qw({},{Abs:()=>MS,Acos:()=>OS,Acosh:()=>PS,AdadeltaOptimizer:()=>fO,AdagradOptimizer:()=>mO,AdamOptimizer:()=>gO,AdamaxOptimizer:()=>bO,Add:()=>LS,AddN:()=>zS,All:()=>BS,Any:()=>WS,ArgMax:()=>VS,ArgMin:()=>US,Asin:()=>jS,Asinh:()=>HS,Atan:()=>GS,Atan2:()=>KS,Atanh:()=>qS,AvgPool:()=>XS,AvgPool3D:()=>JS,AvgPool3DGrad:()=>ZS,AvgPoolGrad:()=>YS,BackendWasm:()=>Kle,BatchMatMul:()=>QS,BatchToSpaceND:()=>eI,Bincount:()=>tI,BitwiseAnd:()=>nI,BroadcastArgs:()=>aI,BroadcastTo:()=>rI,Callback:()=>HK,CallbackList:()=>_U,Cast:()=>iI,Ceil:()=>sI,ClipByValue:()=>oI,Complex:()=>lI,ComplexAbs:()=>uI,Concat:()=>dI,Conv2D:()=>cI,Conv2DBackpropFilter:()=>pI,Conv2DBackpropInput:()=>hI,Conv3D:()=>fI,Conv3DBackpropFilterV2:()=>mI,Conv3DBackpropInputV2:()=>gI,Cos:()=>bI,Cosh:()=>yI,CropAndResize:()=>wI,Cumprod:()=>vI,Cumsum:()=>xI,CustomCallback:()=>RU,DataStorage:()=>$k,DenseBincount:()=>kI,DepthToSpace:()=>SI,DepthwiseConv2dNative:()=>II,DepthwiseConv2dNativeBackpropFilter:()=>NI,DepthwiseConv2dNativeBackpropInput:()=>CI,Diag:()=>TI,Dilation2D:()=>EI,Dilation2DBackpropFilter:()=>$I,Dilation2DBackpropInput:()=>_I,Draw:()=>AI,ENV:()=>RS,EarlyStopping:()=>YK,Einsum:()=>DI,Elu:()=>FI,EluGrad:()=>MI,Environment:()=>ES,Equal:()=>PI,Erf:()=>OI,Exp:()=>LI,ExpandDims:()=>zI,Expm1:()=>BI,FFT:()=>WI,Fill:()=>VI,FlipLeftRight:()=>UI,Floor:()=>jI,FloorDiv:()=>HI,FromPixels:()=>KC,FusedBatchNorm:()=>GI,FusedConv2D:()=>JC,FusedDepthwiseConv2D:()=>ZC,GPGPUContext:()=>L6,GatherNd:()=>KI,GatherV2:()=>qI,GraphModel:()=>DY,Greater:()=>XI,GreaterEqual:()=>YI,History:()=>AU,IFFT:()=>ZI,Identity:()=>JI,Imag:()=>QI,InputSpec:()=>AV,IsFinite:()=>eN,IsInf:()=>tN,IsNan:()=>nN,KernelBackend:()=>Ak,LRN:()=>mN,LRNGrad:()=>gN,LayerVariable:()=>EV,LayersModel:()=>Dj,LeakyRelu:()=>rN,Less:()=>aN,LessEqual:()=>iN,LinSpace:()=>sN,Log:()=>oN,Log1p:()=>lN,LogSoftmax:()=>hN,LogicalAnd:()=>uN,LogicalNot:()=>dN,LogicalOr:()=>cN,LogicalXor:()=>pN,LowerBound:()=>fN,MathBackendCPU:()=>ZJ,MathBackendWebGL:()=>a7,MatrixBandPart:()=>bN,Max:()=>yN,MaxPool:()=>xN,MaxPool3D:()=>kN,MaxPool3DGrad:()=>SN,MaxPoolGrad:()=>wN,MaxPoolWithArgmax:()=>IN,Maximum:()=>vN,Mean:()=>NN,Min:()=>CN,Minimum:()=>TN,MirrorPad:()=>EN,Mod:()=>_N,MomentumOptimizer:()=>vO,Multinomial:()=>$N,Multiply:()=>AN,Neg:()=>RN,NonMaxSuppressionV3:()=>FN,NonMaxSuppressionV4:()=>MN,NonMaxSuppressionV5:()=>ON,NotEqual:()=>DN,OP_SCOPE_SUFFIX:()=>AE,OneHot:()=>LN,OnesLike:()=>PN,Optimizer:()=>hO,OptimizerConstructors:()=>IP,Pack:()=>zN,PadV2:()=>BN,Pool:()=>WN,Pow:()=>VN,Prelu:()=>UN,Prod:()=>jN,RMSPropOptimizer:()=>xO,RNN:()=>zH,RaggedGather:()=>HN,RaggedRange:()=>GN,RaggedTensorToTensor:()=>qN,Range:()=>KN,Rank:()=>ZT,Real:()=>XN,RealDiv:()=>RI,Reciprocal:()=>YN,Reduction:()=>PM,Relu:()=>JN,Relu6:()=>rC,Reshape:()=>ZN,ResizeBilinear:()=>tC,ResizeBilinearGrad:()=>nC,ResizeNearestNeighbor:()=>QN,ResizeNearestNeighborGrad:()=>eC,Reverse:()=>aC,RotateWithOffset:()=>XC,Round:()=>iC,Rsqrt:()=>sC,SGDOptimizer:()=>yO,ScatterNd:()=>oC,SearchSorted:()=>uC,Select:()=>dC,Selu:()=>cC,Sequential:()=>Pj,Sigmoid:()=>gC,Sign:()=>mC,Sin:()=>hC,Sinh:()=>fC,Slice:()=>pC,Softmax:()=>kC,Softplus:()=>bC,SpaceToBatchND:()=>xC,SparseFillEmptyRows:()=>SC,SparseReshape:()=>IC,SparseSegmentMean:()=>NC,SparseSegmentSum:()=>CC,SparseToDense:()=>TC,SplitV:()=>wC,Sqrt:()=>yC,Square:()=>_C,SquaredDifference:()=>EC,StaticRegexReplace:()=>$C,Step:()=>qC,StridedSlice:()=>AC,StringNGrams:()=>RC,StringSplit:()=>DC,StringToHashBucketFast:()=>FC,Sub:()=>MC,Sum:()=>vC,SymbolicTensor:()=>RV,Tan:()=>OC,Tanh:()=>PC,Tensor:()=>XT,TensorBuffer:()=>GT,TensorScatterUpdate:()=>lC,Tile:()=>LC,TopK:()=>zC,Transform:()=>BC,Transpose:()=>WC,Unique:()=>VC,Unpack:()=>UC,UnsortedSegmentSum:()=>jC,UpperBound:()=>HC,Variable:()=>JT,ZerosLike:()=>GC,_FusedMatMul:()=>YC,abs:()=>o$,acos:()=>l$,acosh:()=>u$,add:()=>r$,addN:()=>d$,all:()=>c$,any:()=>p$,argMax:()=>h$,argMin:()=>f$,asin:()=>m$,asinh:()=>g$,atan:()=>b$,atan2:()=>y$,atanh:()=>v$,avgPool:()=>O$,avgPool3d:()=>P$,backend:()=>t$,backend_util:()=>_P,basicLSTMCell:()=>U$,batchNorm:()=>G$,batchNorm2d:()=>q$,batchNorm3d:()=>K$,batchNorm4d:()=>X$,batchToSpaceND:()=>j$,bincount:()=>Y$,bitwiseAnd:()=>J$,booleanMaskAsync:()=>zF,broadcastArgs:()=>Z$,broadcastTo:()=>Q$,broadcast_util:()=>SA,browser:()=>HO,buffer:()=>R_,callbacks:()=>JK,cast:()=>D_,ceil:()=>eA,clipByValue:()=>nA,clone:()=>F_,complex:()=>DE,concat:()=>L$,concat1d:()=>rA,concat2d:()=>aA,concat3d:()=>iA,concat4d:()=>sA,constraints:()=>qV,conv1d:()=>lA,conv2d:()=>oA,conv2dTranspose:()=>dA,conv3d:()=>cA,conv3dTranspose:()=>hA,copyRegisteredKernels:()=>dT,cos:()=>fA,cosh:()=>mA,cosineWindow:()=>qF,cumprod:()=>gA,cumsum:()=>bA,customGrad:()=>NR,data:()=>PY,denseBincount:()=>yA,deprecationWarn:()=>z_,depthToSpace:()=>vA,depthwiseConv2d:()=>xA,deregisterOp:()=>tX,device_util:()=>wE,diag:()=>wA,dilation2d:()=>kA,disableDeprecationWarnings:()=>L_,dispose:()=>H_,disposeVariables:()=>B_,div:()=>i$,divNoNan:()=>$A,dot:()=>AA,dropout:()=>HF,einsum:()=>RA,elu:()=>DA,enableDebugMode:()=>P_,enableProdMode:()=>O_,enclosingPowerOfTwo:()=>GF,engine:()=>W_,ensureShape:()=>FA,env:()=>$S,equal:()=>TA,erf:()=>MA,euclideanNorm:()=>QA,exp:()=>eR,expandDims:()=>tR,expm1:()=>nR,eye:()=>aR,fft:()=>lF,fill:()=>tA,findBackend:()=>Z_,findBackendFactory:()=>Q_,floor:()=>iR,floorDiv:()=>a$,forceHalfFloat:()=>s7,fused:()=>XF,gather:()=>sR,gatherND:()=>jF,gather_util:()=>tP,getBackend:()=>Y_,getGradient:()=>aT,getKernel:()=>rT,getKernelsForBackend:()=>iT,getThreadsCount:()=>lue,gpgpu_util:()=>m6,grad:()=>xR,grads:()=>wR,greater:()=>oR,greaterEqual:()=>lR,ifft:()=>uF,imag:()=>uR,image:()=>aO,inTopKAsync:()=>KF,initializers:()=>lU,input:()=>Bj,io:()=>kO,irfft:()=>dF,isFinite:()=>dR,isInf:()=>cR,isNaN:()=>pR,keep:()=>G_,kernel_impls:()=>ML,layers:()=>NU,leakyRelu:()=>hR,less:()=>fR,lessEqual:()=>mR,linalg:()=>iO,linspace:()=>gR,loadGraphModel:()=>FY,loadGraphModelSync:()=>MY,loadLayersModel:()=>Oj,localResponseNormalization:()=>bR,log:()=>yR,log1p:()=>vR,logSigmoid:()=>_R,logSoftmax:()=>AR,logSumExp:()=>RR,logicalAnd:()=>DR,logicalNot:()=>FR,logicalOr:()=>MR,logicalXor:()=>OR,losses:()=>sO,lowerBound:()=>zR,matMul:()=>z$,math:()=>UO,max:()=>jA,maxPool:()=>BR,maxPool3d:()=>WR,maxPoolWithArgmax:()=>VR,maximum:()=>UR,mean:()=>jR,memory:()=>V_,meshgrid:()=>qR,metrics:()=>IK,min:()=>HA,minimum:()=>KR,mirrorPad:()=>XR,mod:()=>YR,model:()=>Lj,models:()=>BK,moments:()=>JR,movingAverage:()=>WF,mul:()=>s$,multiRNNCell:()=>ZR,multinomial:()=>QR,neg:()=>TR,nextFrame:()=>TP,norm:()=>ZA,notEqual:()=>eD,oneHot:()=>tD,ones:()=>GR,onesLike:()=>nD,op:()=>RE,outerProduct:()=>rD,pad:()=>aD,pad1d:()=>iD,pad2d:()=>sD,pad3d:()=>oD,pad4d:()=>lD,pool:()=>dD,pow:()=>GA,prelu:()=>cD,print:()=>M_,prod:()=>pD,profile:()=>U_,raggedGather:()=>hD,raggedRange:()=>fD,raggedTensorToTensor:()=>mD,rand:()=>gD,randomGamma:()=>FD,randomNormal:()=>MD,randomStandardNormal:()=>OD,randomUniform:()=>PD,randomUniformInt:()=>LD,range:()=>zD,ready:()=>X_,real:()=>BD,reciprocal:()=>WD,registerBackend:()=>e$,registerCallbackConstructor:()=>Wj,registerGradient:()=>oT,registerKernel:()=>sT,registerOp:()=>QK,regularizers:()=>WK,relu:()=>VD,relu6:()=>UD,removeBackend:()=>J_,reshape:()=>M$,reverse:()=>jD,reverse1d:()=>HD,reverse2d:()=>GD,reverse3d:()=>qD,reverse4d:()=>KD,rfft:()=>pF,round:()=>XD,rsqrt:()=>YD,scalar:()=>qA,scatterND:()=>VF,scatter_util:()=>NF,searchSorted:()=>LR,selu:()=>JD,separableConv2d:()=>ZD,sequential:()=>zj,serialization:()=>uO,setBackend:()=>K_,setPlatform:()=>n$,setThreadsCount:()=>oue,setWasmPath:()=>rue,setWasmPaths:()=>aue,setWebGLContext:()=>z4,setdiff1dAsync:()=>QD,shared:()=>QJ,sigmoid:()=>B$,sign:()=>eF,signal:()=>rO,sin:()=>tF,sinh:()=>nF,slice:()=>W$,slice1d:()=>rF,slice2d:()=>aF,slice3d:()=>iF,slice4d:()=>sF,slice_util:()=>rP,softmax:()=>oF,softplus:()=>ER,spaceToBatchND:()=>uD,sparse:()=>oO,sparseToDense:()=>UF,spectral:()=>nO,split:()=>cF,sqrt:()=>KA,square:()=>XA,squaredDifference:()=>hF,squeeze:()=>fF,stack:()=>mF,step:()=>gF,stridedSlice:()=>bF,string:()=>lO,sub:()=>$R,sum:()=>YA,sumOutType:()=>sE,tan:()=>yF,tanh:()=>V$,tensor:()=>ME,tensor1d:()=>vF,tensor2d:()=>xF,tensor3d:()=>wF,tensor4d:()=>kF,tensor5d:()=>SF,tensor6d:()=>IF,tensorScatterUpdate:()=>_F,tensor_util:()=>rE,test_util:()=>yD,tidy:()=>j_,tile:()=>rR,time:()=>q_,topk:()=>$F,train:()=>NP,transpose:()=>BF,truncatedNormal:()=>AF,unique:()=>RF,unregisterGradient:()=>uT,unregisterKernel:()=>lT,unsortedSegmentSum:()=>DF,unstack:()=>FF,upcastType:()=>iE,upperBound:()=>MF,util:()=>pT,valueAndGrad:()=>kR,valueAndGrads:()=>SR,variable:()=>OF,variableGrads:()=>IR,version:()=>cue,version_converter:()=>OY,version_core:()=>SP,version_cpu:()=>C0,version_layers:()=>fj,version_wasm:()=>uue,version_webgl:()=>i7,webgl:()=>o7,webgl_util:()=>D4,where:()=>EA,whereAsync:()=>LF,zeros:()=>HR,zerosLike:()=>_A});var ek=Object.create,tk=Object.defineProperty,nk=Object.getOwnPropertyDescriptor,rk=Object.getOwnPropertyNames,ak=Object.getPrototypeOf,ik=Object.prototype.hasOwnProperty,sk=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),ok=(e,t)=>{for(var n in t)tk(e,n,{get:t[n],enumerable:!0})},lk=(e,t,n)=>(n=null!=e?ek(ak(e)):{},((e,t,n,r)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let a of rk(t))!ik.call(e,a)&&a!==n&&tk(e,a,{get:()=>t[a],enumerable:!(r=nk(t,a))||r.enumerable});return e})(!t&&e&&e.__esModule?n:tk(n,"default",{value:e,enumerable:!0}),e)),uk=sk(((e,t)=>{t.exports=r;var n=null;try{n=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(Gl){}function r(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function a(e){return!0===(e&&e.__isLong__)}r.prototype.__isLong__,Object.defineProperty(r.prototype,"__isLong__",{value:!0}),r.isLong=a;var i={},s={};function o(e,t){var n,r,a;return t?(a=0<=(e>>>=0)&&e<256)&&(r=s[e])?r:(n=u(e,(0|e)<0?-1:0,!0),a&&(s[e]=n),n):(a=-128<=(e|=0)&&e<128)&&(r=i[e])?r:(n=u(e,e<0?-1:0,!1),a&&(i[e]=n),n)}function l(e,t){if(isNaN(e))return t?y:b;if(t){if(e<0)return y;if(e>=f)return S}else{if(e<=-m)return I;if(e+1>=m)return k}return e<0?l(-e,t).neg():u(e%h|0,e/h|0,t)}function u(e,t,n){return new r(e,t,n)}r.fromInt=o,r.fromNumber=l,r.fromBits=u;var d=Math.pow;function c(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return b;if("number"==typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return c(e.substring(1),t,n).neg();for(var a=l(d(n,8)),i=b,s=0;s<e.length;s+=8){var o=Math.min(8,e.length-s),u=parseInt(e.substring(s,s+o),n);if(o<8){var p=l(d(n,o));i=i.mul(p).add(l(u))}else i=(i=i.mul(a)).add(l(u))}return i.unsigned=t,i}function p(e,t){return"number"==typeof e?l(e,t):"string"==typeof e?c(e,t):u(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}r.fromString=c,r.fromValue=p;var h=4294967296,f=h*h,m=f/2,g=o(1<<24),b=o(0);r.ZERO=b;var y=o(0,!0);r.UZERO=y;var v=o(1);r.ONE=v;var x=o(1,!0);r.UONE=x;var w=o(-1);r.NEG_ONE=w;var k=u(-1,2147483647,!1);r.MAX_VALUE=k;var S=u(-1,-1,!0);r.MAX_UNSIGNED_VALUE=S;var I=u(0,-2147483648,!1);r.MIN_VALUE=I;var N=r.prototype;N.toInt=function(){return this.unsigned?this.low>>>0:this.low},N.toNumber=function(){return this.unsigned?(this.high>>>0)*h+(this.low>>>0):this.high*h+(this.low>>>0)},N.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(I)){var t=l(e),n=this.div(t),r=n.mul(t).sub(this);return n.toString(e)+r.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var a=l(d(e,6),this.unsigned),i=this,s="";;){var o=i.div(a),u=(i.sub(o.mul(a)).toInt()>>>0).toString(e);if((i=o).isZero())return u+s;for(;u.length<6;)u="0"+u;s=""+u+s}},N.getHighBits=function(){return this.high},N.getHighBitsUnsigned=function(){return this.high>>>0},N.getLowBits=function(){return this.low},N.getLowBitsUnsigned=function(){return this.low>>>0},N.getNumBitsAbs=function(){if(this.isNegative())return this.eq(I)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&!(e&1<<t);t--);return 0!=this.high?t+33:t+1},N.isZero=function(){return 0===this.high&&0===this.low},N.eqz=N.isZero,N.isNegative=function(){return!this.unsigned&&this.high<0},N.isPositive=function(){return this.unsigned||this.high>=0},N.isOdd=function(){return 1==(1&this.low)},N.isEven=function(){return 0==(1&this.low)},N.equals=function(e){return a(e)||(e=p(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},N.eq=N.equals,N.notEquals=function(e){return!this.eq(e)},N.neq=N.notEquals,N.ne=N.notEquals,N.lessThan=function(e){return this.comp(e)<0},N.lt=N.lessThan,N.lessThanOrEqual=function(e){return this.comp(e)<=0},N.lte=N.lessThanOrEqual,N.le=N.lessThanOrEqual,N.greaterThan=function(e){return this.comp(e)>0},N.gt=N.greaterThan,N.greaterThanOrEqual=function(e){return this.comp(e)>=0},N.gte=N.greaterThanOrEqual,N.ge=N.greaterThanOrEqual,N.compare=function(e){if(a(e)||(e=p(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},N.comp=N.compare,N.negate=function(){return!this.unsigned&&this.eq(I)?I:this.not().add(v)},N.neg=N.negate,N.add=function(e){a(e)||(e=p(e));var t=this.high>>>16,n=65535&this.high,r=this.low>>>16,i=65535&this.low,s=e.high>>>16,o=65535&e.high,l=e.low>>>16,d=0,c=0,h=0,f=0;return h+=(f+=i+(65535&e.low))>>>16,c+=(h+=r+l)>>>16,d+=(c+=n+o)>>>16,d+=t+s,u((h&=65535)<<16|(f&=65535),(d&=65535)<<16|(c&=65535),this.unsigned)},N.subtract=function(e){return a(e)||(e=p(e)),this.add(e.neg())},N.sub=N.subtract,N.multiply=function(e){if(this.isZero())return b;if(a(e)||(e=p(e)),n)return u(n.mul(this.low,this.high,e.low,e.high),n.get_high(),this.unsigned);if(e.isZero())return b;if(this.eq(I))return e.isOdd()?I:b;if(e.eq(I))return this.isOdd()?I:b;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(g)&&e.lt(g))return l(this.toNumber()*e.toNumber(),this.unsigned);var t=this.high>>>16,r=65535&this.high,i=this.low>>>16,s=65535&this.low,o=e.high>>>16,d=65535&e.high,c=e.low>>>16,h=65535&e.low,f=0,m=0,y=0,v=0;return y+=(v+=s*h)>>>16,m+=(y+=i*h)>>>16,y&=65535,m+=(y+=s*c)>>>16,f+=(m+=r*h)>>>16,m&=65535,f+=(m+=i*c)>>>16,m&=65535,f+=(m+=s*d)>>>16,f+=t*h+r*c+i*d+s*o,u((y&=65535)<<16|(v&=65535),(f&=65535)<<16|(m&=65535),this.unsigned)},N.mul=N.multiply,N.divide=function(e){if(a(e)||(e=p(e)),e.isZero())throw Error("division by zero");var t,r,i;if(n)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?u((this.unsigned?n.div_u:n.div_s)(this.low,this.high,e.low,e.high),n.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?y:b;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return y;if(e.gt(this.shru(1)))return x;i=y}else{if(this.eq(I))return e.eq(v)||e.eq(w)?I:e.eq(I)?v:(t=this.shr(1).div(e).shl(1)).eq(b)?e.isNegative()?v:w:(r=this.sub(e.mul(t)),i=t.add(r.div(e)));if(e.eq(I))return this.unsigned?y:b;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=b}for(r=this;r.gte(e);){t=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var s=Math.ceil(Math.log(t)/Math.LN2),o=s<=48?1:d(2,s-48),c=l(t),h=c.mul(e);h.isNegative()||h.gt(r);)h=(c=l(t-=o,this.unsigned)).mul(e);c.isZero()&&(c=v),i=i.add(c),r=r.sub(h)}return i},N.div=N.divide,N.modulo=function(e){return a(e)||(e=p(e)),n?u((this.unsigned?n.rem_u:n.rem_s)(this.low,this.high,e.low,e.high),n.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},N.mod=N.modulo,N.rem=N.modulo,N.not=function(){return u(~this.low,~this.high,this.unsigned)},N.and=function(e){return a(e)||(e=p(e)),u(this.low&e.low,this.high&e.high,this.unsigned)},N.or=function(e){return a(e)||(e=p(e)),u(this.low|e.low,this.high|e.high,this.unsigned)},N.xor=function(e){return a(e)||(e=p(e)),u(this.low^e.low,this.high^e.high,this.unsigned)},N.shiftLeft=function(e){return a(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?u(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):u(0,this.low<<e-32,this.unsigned)},N.shl=N.shiftLeft,N.shiftRight=function(e){return a(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?u(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):u(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},N.shr=N.shiftRight,N.shiftRightUnsigned=function(e){if(a(e)&&(e=e.toInt()),0==(e&=63))return this;var t=this.high;return e<32?u(this.low>>>e|t<<32-e,t>>>e,this.unsigned):u(32===e?t:t>>>e-32,0,this.unsigned)},N.shru=N.shiftRightUnsigned,N.shr_u=N.shiftRightUnsigned,N.toSigned=function(){return this.unsigned?u(this.low,this.high,!1):this},N.toUnsigned=function(){return this.unsigned?this:u(this.low,this.high,!0)},N.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},N.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},N.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},r.fromBytes=function(e,t,n){return n?r.fromBytesLE(e,t):r.fromBytesBE(e,t)},r.fromBytesLE=function(e,t){return new r(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},r.fromBytesBE=function(e,t){return new r(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}})),dk=sk((()=>{})),ck=sk((()=>{})),pk=sk(((e,t)=>{!function(e,t,n){function r(e){var t=this,n=function(){var e=4022871197,t=function(t){t=String(t);for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)};return t}();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(e),t.s0<0&&(t.s0+=1),t.s1-=n(e),t.s1<0&&(t.s1+=1),t.s2-=n(e),t.s2<0&&(t.s2+=1),n=null}function a(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function i(e,t){var n=new r(e),i=t&&t.state,s=n.next;return s.int32=function(){return 4294967296*n.next()|0},s.double=function(){return s()+11102230246251565e-32*(2097152*s()|0)},s.quick=s,i&&("object"==typeof i&&a(i,n),s.state=function(){return a(n,{})}),s}t&&t.exports?t.exports=i:n&&n.amd?n((function(){return i})):this.alea=i}(0,"object"==typeof t&&t,"function"==typeof define&&define)})),hk=sk(((e,t)=>{!function(e,t,n){function r(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function a(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function i(e,t){var n=new r(e),i=t&&t.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},s.int32=n.next,s.quick=s,i&&("object"==typeof i&&a(i,n),s.state=function(){return a(n,{})}),s}t&&t.exports?t.exports=i:n&&n.amd?n((function(){return i})):this.xor128=i}(0,"object"==typeof t&&t,"function"==typeof define&&define)})),fk=sk(((e,t)=>{!function(e,t,n){function r(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function a(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function i(e,t){var n=new r(e),i=t&&t.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},s.int32=n.next,s.quick=s,i&&("object"==typeof i&&a(i,n),s.state=function(){return a(n,{})}),s}t&&t.exports?t.exports=i:n&&n.amd?n((function(){return i})):this.xorwow=i}(0,"object"==typeof t&&t,"function"==typeof define&&define)})),mk=sk(((e,t)=>{!function(e,t,n){function r(e){var t=this;t.next=function(){var e,n,r=t.x,a=t.i;return e=r[a],n=(e^=e>>>7)^e<<24,n^=(e=r[a+1&7])^e>>>10,n^=(e=r[a+3&7])^e>>>3,n^=(e=r[a+4&7])^e<<7,e=r[a+7&7],n^=(e^=e<<13)^e<<9,r[a]=n,t.i=a+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function a(e,t){return t.x=e.x.slice(),t.i=e.i,t}function i(e,t){null==e&&(e=+new Date);var n=new r(e),i=t&&t.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},s.int32=n.next,s.quick=s,i&&(i.x&&a(i,n),s.state=function(){return a(n,{})}),s}t&&t.exports?t.exports=i:n&&n.amd?n((function(){return i})):this.xorshift7=i}(0,"object"==typeof t&&t,"function"==typeof define&&define)})),gk=sk(((e,t)=>{!function(e,t,n){function r(e){var t=this;t.next=function(){var e,n,r=t.w,a=t.X,i=t.i;return t.w=r=r+1640531527|0,n=a[i+34&127],e=a[i=i+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=a[i]=n^e,t.i=i,n+(r^r>>>16)|0},function(e,t){var n,r,a,i,s,o=[],l=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,l=Math.max(l,t.length)),a=0,i=-32;i<l;++i)t&&(r^=t.charCodeAt((i+32)%t.length)),0===i&&(s=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(s=s+1640531527|0,a=0==(n=o[127&i]^=r+s)?a+1:0);for(a>=128&&(o[127&(t&&t.length||0)]=-1),a=127,i=512;i>0;--i)r=o[a+34&127],n=o[a=a+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,o[a]=r^n;e.w=s,e.X=o,e.i=a}(t,e)}function a(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function i(e,t){null==e&&(e=+new Date);var n=new r(e),i=t&&t.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},s.int32=n.next,s.quick=s,i&&(i.X&&a(i,n),s.state=function(){return a(n,{})}),s}t&&t.exports?t.exports=i:n&&n.amd?n((function(){return i})):this.xor4096=i}(0,"object"==typeof t&&t,"function"==typeof define&&define)})),bk=sk(((e,t)=>{!function(e,t,n){function r(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,a=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^a,a=a-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^a,t.a=a-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function a(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function i(e,t){var n=new r(e),i=t&&t.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},s.int32=n.next,s.quick=s,i&&("object"==typeof i&&a(i,n),s.state=function(){return a(n,{})}),s}t&&t.exports?t.exports=i:n&&n.amd?n((function(){return i})):this.tychei=i}(0,"object"==typeof t&&t,"function"==typeof define&&define)})),yk=sk((()=>{})),vk=sk(((e,t)=>{!function(e,n,r){var a,i=256,s="random",o=r.pow(i,6),l=r.pow(2,52),u=2*l,d=i-1;function c(t,d,c){var b=[],y=m(f((d=1==d?{entropy:!0}:d||{}).entropy?[t,g(n)]:null==t?function(){try{var t;return a&&(t=a.randomBytes)?t=t(i):(t=new Uint8Array(i),(e.crypto||e.msCrypto).getRandomValues(t)),g(t)}catch(b){var r=e.navigator,s=r&&r.plugins;return[+new Date,e,s,e.screen,g(n)]}}():t,3),b),v=new p(b),x=function(){for(var e=v.g(6),t=o,n=0;e<l;)e=(e+n)*i,t*=i,n=v.g(1);for(;e>=u;)e/=2,t/=2,n>>>=1;return(e+n)/t};return x.int32=function(){return 0|v.g(4)},x.quick=function(){return v.g(4)/4294967296},x.double=x,m(g(v.S),n),(d.pass||c||function(e,t,n,a){return a&&(a.S&&h(a,v),e.state=function(){return h(v,{})}),n?(r[s]=e,t):e})(x,y,"global"in d?d.global:this==r,d.state)}function p(e){var t,n=e.length,r=this,a=0,s=r.i=r.j=0,o=r.S=[];for(n||(e=[n++]);a<i;)o[a]=a++;for(a=0;a<i;a++)o[a]=o[s=d&s+e[a%n]+(t=o[a])],o[s]=t;(r.g=function(e){for(var t,n=0,a=r.i,s=r.j,o=r.S;e--;)t=o[a=d&a+1],n=n*i+o[d&(o[a]=o[s=d&s+t])+(o[s]=t)];return r.i=a,r.j=s,n})(i)}function h(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function f(e,t){var n,r=[],a=typeof e;if(t&&"object"==a)for(n in e)try{r.push(f(e[n],t-1))}catch(La){}return r.length?r:"string"==a?e:e+"\0"}function m(e,t){for(var n,r=e+"",a=0;a<r.length;)t[d&a]=d&(n^=19*t[d&a])+r.charCodeAt(a++);return g(t)}function g(e){return String.fromCharCode.apply(0,e)}if(m(r.random(),n),"object"==typeof t&&t.exports){t.exports=c;try{a=yk()}catch(rs){}}else"function"==typeof define&&define.amd?define((function(){return c})):r["seed"+s]=c}("undefined"!=typeof self?self:e,[],Math)})),xk=sk(((e,t)=>{var n=pk(),r=hk(),a=fk(),i=mk(),s=gk(),o=bk(),l=vk();l.alea=n,l.xor128=r,l.xorwow=a,l.xorshift7=i,l.xor4096=s,l.tychei=o,t.exports=l})),wk=sk((()=>{})),kk=sk((()=>{})),Sk=sk((()=>{})),Ik=sk((()=>{})),Nk=sk((()=>{})),Ck=sk((()=>{})),Tk=sk(((e,t)=>{var n=(()=>{var e="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0;return"undefined"!=typeof __filename&&(e=e||__filename),function(t){function n(){return _.buffer!=R&&W(_.buffer),F}function r(){return _.buffer!=R&&W(_.buffer),M}function a(){return _.buffer!=R&&W(_.buffer),O}function i(){return _.buffer!=R&&W(_.buffer),P}var s,o,l,u=void 0!==(t=t||{})?t:{};u.ready=new Promise((function(e,t){s=e,o=t})),"undefined"!=typeof process&&process.listeners&&(l={uncaughtException:process.listeners("uncaughtException"),unhandledRejection:process.listeners("unhandledRejection")});var d,c,p,h=Object.assign({},u),f=(e,t)=>{throw t},m="object"==typeof window,g="function"==typeof importScripts,b="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,y=u.ENVIRONMENT_IS_PTHREAD||!1,v="";function x(e){return u.locateFile?u.locateFile(e,v):v+e}if(b){var w=kk(),k=Sk();let e;v=g?k.dirname(v)+"/":__dirname+"/",d=(e,t)=>(e=re(e)?new URL(e):k.normalize(e),w.readFileSync(e,t?void 0:"utf8")),p=e=>{var t=d(e,!0);return t.buffer||(t=new Uint8Array(t)),t},c=(e,t,n)=>{e=re(e)?new URL(e):k.normalize(e),w.readFile(e,(function(e,r){e?n(e):t(r.buffer)}))},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",(function(e){if(!(e instanceof se))throw e})),process.on("unhandledRejection",(function(e){throw e})),f=(e,t)=>{if(q())throw process.exitCode=e,t;(function(e){e instanceof se||T("exiting due to exception: "+e)})(t),process.exit(e)},u.inspect=function(){return"[Emscripten Module object]"};try{e=Ik()}catch(Ap){throw console.error('The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?'),Ap}global.Worker=e.Worker}else(m||g)&&(g?v=self.location.href:"undefined"!=typeof document&&document.currentScript&&(v=document.currentScript.src),void 0!==e&&e&&(v=e),v=0!==v.indexOf("blob:")?v.substr(0,v.replace(/[?#].*/,"").lastIndexOf("/")+1):"",b||(d=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},g&&(p=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),c=(e,t,n)=>{var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.onload=()=>{200==r.status||0==r.status&&r.response?t(r.response):n()},r.onerror=n,r.send(null)}));b&&"undefined"==typeof performance&&(global.performance=Nk().performance);var S=console.log.bind(console),I=console.warn.bind(console);b&&(S=e=>w.writeSync(1,e+"\n"),I=e=>w.writeSync(2,e+"\n"));var N,C=u.print||S,T=u.printErr||I;Object.assign(u,h),h=null,u.arguments&&u.arguments,u.thisProgram&&u.thisProgram,u.quit&&(f=u.quit),u.wasmBinary&&(N=u.wasmBinary);var E=u.noExitRuntime||!0;"object"!=typeof WebAssembly&&Q("no native wasm support detected");var _,$,A,R,D,F,M,O,P,L=!1,z="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function B(e,t,n){for(var r=(t>>>=0)+n,a=t;e[a]&&!(a>=r);)++a;if(a-t>16&&e.buffer&&z)return z.decode(e.buffer instanceof SharedArrayBuffer?e.slice(t,a):e.subarray(t,a));for(var i="";t<a;){var s=e[t++];if(128&s){var o=63&e[t++];if(192!=(224&s)){var l=63&e[t++];if((s=224==(240&s)?(15&s)<<12|o<<6|l:(7&s)<<18|o<<12|l<<6|63&e[t++])<65536)i+=String.fromCharCode(s);else{var u=s-65536;i+=String.fromCharCode(55296|u>>10,56320|1023&u)}}else i+=String.fromCharCode((31&s)<<6|o)}else i+=String.fromCharCode(s)}return i}function W(e){R=e,u.HEAP8=D=new Int8Array(e),u.HEAP16=new Int16Array(e),u.HEAP32=M=new Int32Array(e),u.HEAPU8=F=new Uint8Array(e),u.HEAPU16=new Uint16Array(e),u.HEAPU32=O=new Uint32Array(e),u.HEAPF32=new Float32Array(e),u.HEAPF64=P=new Float64Array(e)}y&&(R=u.buffer);var V=u.INITIAL_MEMORY||16777216;if(y)_=u.wasmMemory,R=u.buffer;else if(u.wasmMemory)_=u.wasmMemory;else if(!((_=new WebAssembly.Memory({initial:V/65536,maximum:65536,shared:!0})).buffer instanceof SharedArrayBuffer))throw T("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),b&&T("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and/or recent version)"),Error("bad memory");_&&(R=_.buffer),V=R.byteLength,W(R);var U,j=[],H=[],G=[];function q(){return E}function K(){!y&&pe(H)}function X(e){j.unshift(e)}function Y(e){G.unshift(e)}var J=0,Z=null;function Q(e){u.onAbort&&u.onAbort(e),T(e="Aborted("+e+")"),L=!0,A=1,e+=". Build with -sASSERTIONS for more info.";var t=new WebAssembly.RuntimeError(e);throw o(t),t}var ee,te="data:application/octet-stream;base64,";function ne(e){return e.startsWith(te)}function re(e){return e.startsWith("file://")}function ae(e){try{if(e==ee&&N)return new Uint8Array(N);if(p)return p(e);throw"both async and sync fetching of the wasm failed"}catch(Ap){Q(Ap)}}ne(ee="tfjs-backend-wasm-threaded-simd.wasm")||(ee=x(ee));var ie={};function se(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function oe(e){var t=ce.pthreads[e];(function(e,t){e||Q(t)})(t),ce.returnWorkerToPool(t)}function le(e){var t=ce.getNewWorker();if(!t)return 6;ce.runningWorkers.push(t),ce.pthreads[e.pthread_ptr]=t,t.pthread_ptr=e.pthread_ptr;var n={cmd:"run",start_routine:e.startRoutine,arg:e.arg,pthread_ptr:e.pthread_ptr};return t.runPthread=()=>{b&&t.ref(),t.postMessage(n,e.transferList),delete t.runPthread},t.loaded&&t.runPthread(),0}function ue(e){if(y)return xe(1,1,e);A=e,q()||(ce.terminateAllThreads(),u.onExit&&u.onExit(e),L=!0),f(e,new se(e))}var de=function(e,t){if(A=e,!t&&y)throw he(e),"unwind";ue(e)},ce={unusedWorkers:[],runningWorkers:[],tlsInitFunctions:[],pthreads:{},init:function(){y?ce.initWorker():ce.initMainThread()},initMainThread:function(){for(var e=8;e--;)ce.allocateUnusedWorker()},initWorker:function(){E=!1},setExitStatus:function(e){A=e},terminateAllThreads:function(){for(var e of Object.values(ce.pthreads))ce.returnWorkerToPool(e);for(var e of ce.unusedWorkers)e.terminate();ce.unusedWorkers=[]},returnWorkerToPool:function(e){var t=e.pthread_ptr;delete ce.pthreads[t],ce.unusedWorkers.push(e),ce.runningWorkers.splice(ce.runningWorkers.indexOf(e),1),e.pthread_ptr=0,b&&e.unref(),Be(t)},receiveObjectTransfer:function(e){},threadInitTLS:function(){ce.tlsInitFunctions.forEach((e=>e()))},loadWasmModuleToWorker:function(t,n){t.onmessage=e=>{var r=e.data,a=r.cmd;if(t.pthread_ptr&&(ce.currentProxiedOperationCallerThread=t.pthread_ptr),r.targetThread&&r.targetThread!=De()){var i=ce.pthreads[r.targetThread];return i?i.postMessage(r,r.transferList):T('Internal error! Worker sent a message "'+a+'" to target pthread '+r.targetThread+", but that thread no longer exists!"),void(ce.currentProxiedOperationCallerThread=void 0)}"processProxyingQueue"===a?ye(r.queue):"spawnThread"===a?le(r):"cleanupThread"===a?oe(r.thread):"killThread"===a?function(e){var t=ce.pthreads[e];delete ce.pthreads[e],t.terminate(),Be(e),ce.runningWorkers.splice(ce.runningWorkers.indexOf(t),1),t.pthread_ptr=0}(r.thread):"cancelThread"===a?function(e){ce.pthreads[e].postMessage({cmd:"cancel"})}(r.thread):"loaded"===a?(t.loaded=!0,b&&t.unref(),n&&n(t),t.runPthread&&t.runPthread()):"print"===a?C("Thread "+r.threadId+": "+r.text):"printErr"===a?T("Thread "+r.threadId+": "+r.text):"alert"===a?alert("Thread "+r.threadId+": "+r.text):"setimmediate"===r.target?t.postMessage(r):"callHandler"===a?u[r.handler](...r.args):a&&T("worker sent an unknown command "+a),ce.currentProxiedOperationCallerThread=void 0},t.onerror=e=>{throw T("worker sent an error! "+e.filename+":"+e.lineno+": "+e.message),e},b&&(t.on("message",(function(e){t.onmessage({data:e})})),t.on("error",(function(e){t.onerror(e)})),t.on("detachedExit",(function(){})));var r=[];for(var a of["onExit","onAbort","print","printErr"])u.hasOwnProperty(a)&&r.push(a);t.postMessage({cmd:"load",handlers:r,urlOrBlob:u.mainScriptUrlOrBlob||e,wasmMemory:_,wasmModule:$})},allocateUnusedWorker:function(){var e,t=x("tfjs-backend-wasm-threaded-simd.worker.js");e=new Worker(t),ce.unusedWorkers.push(e)},getNewWorker:function(){return 0==ce.unusedWorkers.length&&(ce.allocateUnusedWorker(),ce.loadWasmModuleToWorker(ce.unusedWorkers[0])),ce.unusedWorkers.pop()}};function pe(e){for(;e.length>0;)e.shift()(u)}function he(e){if(y)return xe(2,0,e);try{de(e)}catch(Ap){!function(e){if(e instanceof se||"unwind"==e)return A;f(1,e)}(Ap)}}u.PThread=ce,u.establishStackSpace=function(){var e=De(),t=r()[e+52>>>2],n=r()[e+56>>>2];Ve(t,t-n),je(t)};var fe,me=[];function ge(e,t,n,r){return y?xe(3,1,e,t,n,r):be(e,t,n,r)}function be(e,t,n,r){if("undefined"==typeof SharedArrayBuffer)return T("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var a=[];if(y&&0===a.length)return ge(e,t,n,r);var i={startRoutine:n,pthread_ptr:e,arg:r,transferList:a};return y?(i.cmd="spawnThread",postMessage(i,a),0):le(i)}function ye(e){Atomics.store(r(),e>>2,1),De()&&ze(e),Atomics.compareExchange(r(),e>>2,1,0)}function ve(e){ve.shown||(ve.shown={}),ve.shown[e]||(ve.shown[e]=1,b&&(e="warning: "+e),T(e))}function xe(e,t){var n=arguments.length-2,r=arguments;return function(e){var t=Ue(),n=e();return je(t),n}((()=>{for(var a=n,s=He(8*a),o=s>>3,l=0;l<n;l++){var u=r[2+l];i()[o+l>>>0]=u}return Me(e,a,s,t)}))}u.invokeEntryPoint=function(e,t){var n=function(e){var t=me[e];return t||(e>=me.length&&(me.length=e+1),me[e]=t=U.get(e)),t}(e)(t);q()?ce.setExitStatus(n):We(n)},u.executeNotifiedProxyingQueue=ye,fe=b?()=>{var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:()=>performance.timeOrigin+performance.now();var we=[];function ke(e){try{return _.grow(e-R.byteLength+65535>>>16),W(_.buffer),1}catch(Ap){}}function Se(e){return y?xe(4,1,e):52}function Ie(e,t,n,r,a){return y?xe(5,1,e,t,n,r,a):70}var Ne=[null,[],[]];function Ce(e,t){var n=Ne[e];0===t||10===t?((1===e?C:T)(B(n,0)),n.length=0):n.push(t)}function Te(e,t,r,i){if(y)return xe(6,1,e,t,r,i);for(var s=0,o=0;o<r;o++){var l=a()[t>>>2],u=a()[t+4>>>2];t+=8;for(var d=0;d<u;d++)Ce(e,n()[l+d>>>0]);s+=u}return a()[i>>>2]=s,0}function Ee(e){return u["_"+e]}function _e(e,t){(_.buffer!=R&&W(_.buffer),D).set(e,t>>>0)}function $e(e,t,r,a,i){var s={string:e=>{var t=0;if(null!=e&&0!==e){var r=1+(e.length<<2);!function(e,t,r){!function(e,t,n,r){if(!(r>0))return 0;n>>>=0;for(var a=n+r-1,i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s>=55296&&s<=57343&&(s=65536+((1023&s)<<10)|1023&e.charCodeAt(++i)),s<=127){if(n>=a)break;t[n++>>>0]=s}else if(s<=2047){if(n+1>=a)break;t[n++>>>0]=192|s>>6,t[n++>>>0]=128|63&s}else if(s<=65535){if(n+2>=a)break;t[n++>>>0]=224|s>>12,t[n++>>>0]=128|s>>6&63,t[n++>>>0]=128|63&s}else{if(n+3>=a)break;t[n++>>>0]=240|s>>18,t[n++>>>0]=128|s>>12&63,t[n++>>>0]=128|s>>6&63,t[n++>>>0]=128|63&s}}t[n>>>0]=0}(e,n(),t,r)}(e,t=He(r),r)}return t},array:e=>{var t=He(e.length);return _e(e,t),t}};function o(e){return"string"===t?function(e,t){return(e>>>=0)?B(n(),e,t):""}(e):"boolean"===t?!!e:e}var l=Ee(e),u=[],d=0;if(a)for(var c=0;c<a.length;c++){var p=s[r[c]];p?(0===d&&(d=Ue()),u[c]=p(a[c])):u[c]=a[c]}var h=l.apply(null,u);return h=function(e){return 0!==d&&je(d),o(e)}(h),h}ce.init();var Ae=[null,ue,he,ge,Se,Ie,Te],Re={__emscripten_init_main_thread_js:function(e){Fe(e,!g,1,!m),ce.threadInitTLS()},__emscripten_thread_cleanup:function(e){y?postMessage({cmd:"cleanupThread",thread:e}):oe(e)},__pthread_create_js:be,_emscripten_default_pthread_stack_size:function(){return 65536},_emscripten_get_now_is_monotonic:function(){return!0},_emscripten_notify_task_queue:function(e,t,n,r){if(e==t)setTimeout((()=>ye(r)));else if(y)postMessage({targetThread:e,cmd:"processProxyingQueue",queue:r});else{var a=ce.pthreads[e];if(!a)return;a.postMessage({cmd:"processProxyingQueue",queue:r})}return 1},_emscripten_set_offscreencanvas_size:function(e,t,n){return-1},abort:function(){Q("")},emscripten_check_blocking_allowed:function(){b||g||ve("Blocking on the main thread is very dangerous, see https://emscripten.org/docs/porting/pthreads.html#blocking-on-the-main-browser-thread")},emscripten_date_now:function(){return Date.now()},emscripten_get_heap_max:function(){return 4294901760},emscripten_get_now:fe,emscripten_memcpy_big:function(e,t,r){n().copyWithin(e>>>0,t>>>0,t+r>>>0)},emscripten_num_logical_cores:function(){return b?Ck().cpus().length:navigator.hardwareConcurrency},emscripten_receive_on_main_thread_js:function(e,t,n){we.length=t;for(var r=n>>3,a=0;a<t;a++)we[a]=i()[r+a>>>0];return(e<0?ie[-e-1]:Ae[e]).apply(null,we)},emscripten_resize_heap:function(e){var t=n().length;if((e>>>=0)<=t)return!1;var r=4294901760;if(e>r)return!1;let a=(e,t)=>e+(t-e%t)%t;for(var i=1;i<=4;i*=2){var s=t*(1+.2/i);if(s=Math.min(s,e+100663296),ke(Math.min(r,a(Math.max(e,s),65536))))return!0}return!1},emscripten_unwind_to_js_event_loop:function(){throw"unwind"},exit:de,fd_close:Se,fd_seek:Ie,fd_write:Te,memory:_||u.wasmMemory};!function(){var e={env:Re,wasi_snapshot_preview1:Re};function t(e,t){var n=e.exports;if(u.asm=n,function(e){ce.tlsInitFunctions.push(e)}(u.asm._emscripten_tls_init),U=u.asm.__indirect_function_table,function(e){H.unshift(e)}(u.asm.__wasm_call_ctors),$=t,!y){var r=ce.unusedWorkers.length;ce.unusedWorkers.forEach((function(e){ce.loadWasmModuleToWorker(e,(function(){--r||function(e){if(J--,u.monitorRunDependencies&&u.monitorRunDependencies(J),0==J&&Z){var t=Z;Z=null,t()}}()}))}))}}function n(e){t(e.instance,e.module)}function r(t){return function(){if(!N&&(m||g)){if("function"==typeof fetch&&!re(ee))return fetch(ee,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+ee+"'";return e.arrayBuffer()})).catch((function(){return ae(ee)}));if(c)return new Promise((function(e,t){c(ee,(function(t){e(new Uint8Array(t))}),t)}))}return Promise.resolve().then((function(){return ae(ee)}))}().then((function(t){return WebAssembly.instantiate(t,e)})).then((function(e){return e})).then(t,(function(e){T("failed to asynchronously prepare wasm: "+e),Q(e)}))}if(y||(J++,u.monitorRunDependencies&&u.monitorRunDependencies(J)),u.instantiateWasm)try{return u.instantiateWasm(e,t)}catch(Ur){T("Module.instantiateWasm callback failed with error: "+Ur),o(Ur)}(N||"function"!=typeof WebAssembly.instantiateStreaming||ne(ee)||re(ee)||b||"function"!=typeof fetch?r(n):fetch(ee,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,e).then(n,(function(e){return T("wasm streaming compile failed: "+e),T("falling back to ArrayBuffer instantiation"),r(n)}))}))).catch(o)}(),u.___wasm_call_ctors=function(){return(u.___wasm_call_ctors=u.asm.__wasm_call_ctors).apply(null,arguments)},u._init=function(){return(u._init=u.asm.init).apply(null,arguments)},u._init_with_threads_count=function(){return(u._init_with_threads_count=u.asm.init_with_threads_count).apply(null,arguments)},u._get_threads_count=function(){return(u._get_threads_count=u.asm.get_threads_count).apply(null,arguments)},u._register_tensor=function(){return(u._register_tensor=u.asm.register_tensor).apply(null,arguments)},u._dispose_data=function(){return(u._dispose_data=u.asm.dispose_data).apply(null,arguments)},u._dispose=function(){return(u._dispose=u.asm.dispose).apply(null,arguments)},u._Abs=function(){return(u._Abs=u.asm.Abs).apply(null,arguments)},u._Acos=function(){return(u._Acos=u.asm.Acos).apply(null,arguments)},u._Acosh=function(){return(u._Acosh=u.asm.Acosh).apply(null,arguments)},u._Add=function(){return(u._Add=u.asm.Add).apply(null,arguments)},u._AddN=function(){return(u._AddN=u.asm.AddN).apply(null,arguments)},u._All=function(){return(u._All=u.asm.All).apply(null,arguments)},u._Any=function(){return(u._Any=u.asm.Any).apply(null,arguments)},u._ArgMax=function(){return(u._ArgMax=u.asm.ArgMax).apply(null,arguments)},u._ArgMin=function(){return(u._ArgMin=u.asm.ArgMin).apply(null,arguments)},u._Asin=function(){return(u._Asin=u.asm.Asin).apply(null,arguments)},u._Asinh=function(){return(u._Asinh=u.asm.Asinh).apply(null,arguments)},u._Atan=function(){return(u._Atan=u.asm.Atan).apply(null,arguments)},u._Atan2=function(){return(u._Atan2=u.asm.Atan2).apply(null,arguments)},u._Atanh=function(){return(u._Atanh=u.asm.Atanh).apply(null,arguments)},u._AvgPool=function(){return(u._AvgPool=u.asm.AvgPool).apply(null,arguments)},u._AvgPool3D=function(){return(u._AvgPool3D=u.asm.AvgPool3D).apply(null,arguments)},u._AvgPool3DGrad=function(){return(u._AvgPool3DGrad=u.asm.AvgPool3DGrad).apply(null,arguments)},u._AvgPoolGrad=function(){return(u._AvgPoolGrad=u.asm.AvgPoolGrad).apply(null,arguments)},u._BatchMatMul=function(){return(u._BatchMatMul=u.asm.BatchMatMul).apply(null,arguments)},u._Bincount=function(){return(u._Bincount=u.asm.Bincount).apply(null,arguments)},u._BitwiseAnd=function(){return(u._BitwiseAnd=u.asm.BitwiseAnd).apply(null,arguments)},u._Ceil=function(){return(u._Ceil=u.asm.Ceil).apply(null,arguments)},u._ClipByValue=function(){return(u._ClipByValue=u.asm.ClipByValue).apply(null,arguments)},u._Conv2D=function(){return(u._Conv2D=u.asm.Conv2D).apply(null,arguments)},u._Conv2DBackpropInput=function(){return(u._Conv2DBackpropInput=u.asm.Conv2DBackpropInput).apply(null,arguments)},u._Conv3D=function(){return(u._Conv3D=u.asm.Conv3D).apply(null,arguments)},u._Conv3DBackpropFilterV2=function(){return(u._Conv3DBackpropFilterV2=u.asm.Conv3DBackpropFilterV2).apply(null,arguments)},u._Conv3DBackpropInputV2=function(){return(u._Conv3DBackpropInputV2=u.asm.Conv3DBackpropInputV2).apply(null,arguments)},u._Cos=function(){return(u._Cos=u.asm.Cos).apply(null,arguments)},u._Cosh=function(){return(u._Cosh=u.asm.Cosh).apply(null,arguments)},u._CropAndResize=function(){return(u._CropAndResize=u.asm.CropAndResize).apply(null,arguments)},u._Cumprod=function(){return(u._Cumprod=u.asm.Cumprod).apply(null,arguments)},u._Cumsum=function(){return(u._Cumsum=u.asm.Cumsum).apply(null,arguments)},u._DenseBincount=function(){return(u._DenseBincount=u.asm.DenseBincount).apply(null,arguments)},u._DepthToSpace=function(){return(u._DepthToSpace=u.asm.DepthToSpace).apply(null,arguments)},u._DepthwiseConv2dNative=function(){return(u._DepthwiseConv2dNative=u.asm.DepthwiseConv2dNative).apply(null,arguments)},u._Diag=function(){return(u._Diag=u.asm.Diag).apply(null,arguments)},u._Dilation2D=function(){return(u._Dilation2D=u.asm.Dilation2D).apply(null,arguments)},u._Dilation2DBackpropFilter=function(){return(u._Dilation2DBackpropFilter=u.asm.Dilation2DBackpropFilter).apply(null,arguments)},u._Dilation2DBackpropInput=function(){return(u._Dilation2DBackpropInput=u.asm.Dilation2DBackpropInput).apply(null,arguments)},u._Elu=function(){return(u._Elu=u.asm.Elu).apply(null,arguments)},u._EluGrad=function(){return(u._EluGrad=u.asm.EluGrad).apply(null,arguments)},u._Equal=function(){return(u._Equal=u.asm.Equal).apply(null,arguments)},u._Erf=function(){return(u._Erf=u.asm.Erf).apply(null,arguments)},u._Exp=function(){return(u._Exp=u.asm.Exp).apply(null,arguments)},u._Expm1=function(){return(u._Expm1=u.asm.Expm1).apply(null,arguments)},u._FlipLeftRight=function(){return(u._FlipLeftRight=u.asm.FlipLeftRight).apply(null,arguments)},u._Floor=function(){return(u._Floor=u.asm.Floor).apply(null,arguments)},u._FloorDiv=function(){return(u._FloorDiv=u.asm.FloorDiv).apply(null,arguments)},u._FusedBatchNorm=function(){return(u._FusedBatchNorm=u.asm.FusedBatchNorm).apply(null,arguments)},u._FusedConv2D=function(){return(u._FusedConv2D=u.asm.FusedConv2D).apply(null,arguments)},u._FusedDepthwiseConv2D=function(){return(u._FusedDepthwiseConv2D=u.asm.FusedDepthwiseConv2D).apply(null,arguments)},u._Gather=function(){return(u._Gather=u.asm.Gather).apply(null,arguments)},u._GatherNd=function(){return(u._GatherNd=u.asm.GatherNd).apply(null,arguments)},u._Greater=function(){return(u._Greater=u.asm.Greater).apply(null,arguments)},u._GreaterEqual=function(){return(u._GreaterEqual=u.asm.GreaterEqual).apply(null,arguments)},u._IsFinite=function(){return(u._IsFinite=u.asm.IsFinite).apply(null,arguments)},u._IsInf=function(){return(u._IsInf=u.asm.IsInf).apply(null,arguments)},u._IsNan=function(){return(u._IsNan=u.asm.IsNan).apply(null,arguments)},u._LRN=function(){return(u._LRN=u.asm.LRN).apply(null,arguments)},u._LRNGrad=function(){return(u._LRNGrad=u.asm.LRNGrad).apply(null,arguments)},u._LeakyRelu=function(){return(u._LeakyRelu=u.asm.LeakyRelu).apply(null,arguments)},u._Less=function(){return(u._Less=u.asm.Less).apply(null,arguments)},u._LessEqual=function(){return(u._LessEqual=u.asm.LessEqual).apply(null,arguments)},u._LinSpace=function(){return(u._LinSpace=u.asm.LinSpace).apply(null,arguments)},u._Log=function(){return(u._Log=u.asm.Log).apply(null,arguments)},u._Log1p=function(){return(u._Log1p=u.asm.Log1p).apply(null,arguments)},u._LogicalAnd=function(){return(u._LogicalAnd=u.asm.LogicalAnd).apply(null,arguments)},u._LogicalNot=function(){return(u._LogicalNot=u.asm.LogicalNot).apply(null,arguments)},u._LogicalOr=function(){return(u._LogicalOr=u.asm.LogicalOr).apply(null,arguments)},u._LogicalXor=function(){return(u._LogicalXor=u.asm.LogicalXor).apply(null,arguments)},u._Max=function(){return(u._Max=u.asm.Max).apply(null,arguments)},u._MaxPool=function(){return(u._MaxPool=u.asm.MaxPool).apply(null,arguments)},u._MaxPool3D=function(){return(u._MaxPool3D=u.asm.MaxPool3D).apply(null,arguments)},u._MaxPool3DGrad=function(){return(u._MaxPool3DGrad=u.asm.MaxPool3DGrad).apply(null,arguments)},u._MaxPoolGrad=function(){return(u._MaxPoolGrad=u.asm.MaxPoolGrad).apply(null,arguments)},u._MaxPoolWithArgmax=function(){return(u._MaxPoolWithArgmax=u.asm.MaxPoolWithArgmax).apply(null,arguments)},u._Maximum=function(){return(u._Maximum=u.asm.Maximum).apply(null,arguments)},u._Mean=function(){return(u._Mean=u.asm.Mean).apply(null,arguments)},u._Min=function(){return(u._Min=u.asm.Min).apply(null,arguments)},u._Minimum=function(){return(u._Minimum=u.asm.Minimum).apply(null,arguments)},u._MirrorPad=function(){return(u._MirrorPad=u.asm.MirrorPad).apply(null,arguments)},u._Mod=function(){return(u._Mod=u.asm.Mod).apply(null,arguments)},u._Multinomial=function(){return(u._Multinomial=u.asm.Multinomial).apply(null,arguments)},u._Multiply=function(){return(u._Multiply=u.asm.Multiply).apply(null,arguments)},u._Neg=function(){return(u._Neg=u.asm.Neg).apply(null,arguments)},u._NonMaxSuppressionV3=function(){return(u._NonMaxSuppressionV3=u.asm.NonMaxSuppressionV3).apply(null,arguments)},u._NonMaxSuppressionV4=function(){return(u._NonMaxSuppressionV4=u.asm.NonMaxSuppressionV4).apply(null,arguments)},u._NonMaxSuppressionV5=function(){return(u._NonMaxSuppressionV5=u.asm.NonMaxSuppressionV5).apply(null,arguments)},u._NotEqual=function(){return(u._NotEqual=u.asm.NotEqual).apply(null,arguments)},u._OneHot=function(){return(u._OneHot=u.asm.OneHot).apply(null,arguments)},u._PadV2=function(){return(u._PadV2=u.asm.PadV2).apply(null,arguments)},u._Pow=function(){return(u._Pow=u.asm.Pow).apply(null,arguments)},u._Prelu=function(){return(u._Prelu=u.asm.Prelu).apply(null,arguments)},u._Prod=function(){return(u._Prod=u.asm.Prod).apply(null,arguments)},u._RealDiv=function(){return(u._RealDiv=u.asm.RealDiv).apply(null,arguments)},u._Reciprocal=function(){return(u._Reciprocal=u.asm.Reciprocal).apply(null,arguments)},u._Relu=function(){return(u._Relu=u.asm.Relu).apply(null,arguments)},u._Relu6=function(){return(u._Relu6=u.asm.Relu6).apply(null,arguments)},u._ResizeBilinear=function(){return(u._ResizeBilinear=u.asm.ResizeBilinear).apply(null,arguments)},u._ResizeBilinearGrad=function(){return(u._ResizeBilinearGrad=u.asm.ResizeBilinearGrad).apply(null,arguments)},u._ResizeNearestNeighbor=function(){return(u._ResizeNearestNeighbor=u.asm.ResizeNearestNeighbor).apply(null,arguments)},u._ResizeNearestNeighborGrad=function(){return(u._ResizeNearestNeighborGrad=u.asm.ResizeNearestNeighborGrad).apply(null,arguments)},u._Reverse=function(){return(u._Reverse=u.asm.Reverse).apply(null,arguments)},u._RotateWithOffset=function(){return(u._RotateWithOffset=u.asm.RotateWithOffset).apply(null,arguments)},u._Round=function(){return(u._Round=u.asm.Round).apply(null,arguments)},u._Rsqrt=function(){return(u._Rsqrt=u.asm.Rsqrt).apply(null,arguments)},u._ScatterNd=function(){return(u._ScatterNd=u.asm.ScatterNd).apply(null,arguments)},u._SearchSorted=function(){return(u._SearchSorted=u.asm.SearchSorted).apply(null,arguments)},u._SelectV2=function(){return(u._SelectV2=u.asm.SelectV2).apply(null,arguments)},u._Selu=function(){return(u._Selu=u.asm.Selu).apply(null,arguments)},u._Sigmoid=function(){return(u._Sigmoid=u.asm.Sigmoid).apply(null,arguments)},u._Sign=function(){return(u._Sign=u.asm.Sign).apply(null,arguments)},u._Sin=function(){return(u._Sin=u.asm.Sin).apply(null,arguments)},u._Sinh=function(){return(u._Sinh=u.asm.Sinh).apply(null,arguments)},u._Softmax=function(){return(u._Softmax=u.asm.Softmax).apply(null,arguments)},u._Softplus=function(){return(u._Softplus=u.asm.Softplus).apply(null,arguments)},u._SparseFillEmptyRows=function(){return(u._SparseFillEmptyRows=u.asm.SparseFillEmptyRows).apply(null,arguments)},u._SparseReshape=function(){return(u._SparseReshape=u.asm.SparseReshape).apply(null,arguments)},u._SparseSegmentReduction=function(){return(u._SparseSegmentReduction=u.asm.SparseSegmentReduction).apply(null,arguments)},u._SparseToDense=function(){return(u._SparseToDense=u.asm.SparseToDense).apply(null,arguments)},u._Sqrt=function(){return(u._Sqrt=u.asm.Sqrt).apply(null,arguments)},u._Square=function(){return(u._Square=u.asm.Square).apply(null,arguments)},u._SquaredDifference=function(){return(u._SquaredDifference=u.asm.SquaredDifference).apply(null,arguments)},u._Step=function(){return(u._Step=u.asm.Step).apply(null,arguments)},u._StridedSlice=function(){return(u._StridedSlice=u.asm.StridedSlice).apply(null,arguments)},u._Sub=function(){return(u._Sub=u.asm.Sub).apply(null,arguments)},u._Sum=function(){return(u._Sum=u.asm.Sum).apply(null,arguments)},u._Tan=function(){return(u._Tan=u.asm.Tan).apply(null,arguments)},u._Tanh=function(){return(u._Tanh=u.asm.Tanh).apply(null,arguments)},u._TensorScatterUpdate=function(){return(u._TensorScatterUpdate=u.asm.TensorScatterUpdate).apply(null,arguments)},u._Tile=function(){return(u._Tile=u.asm.Tile).apply(null,arguments)},u._TopK=function(){return(u._TopK=u.asm.TopK).apply(null,arguments)},u._Transform=function(){return(u._Transform=u.asm.Transform).apply(null,arguments)},u._Transpose=function(){return(u._Transpose=u.asm.Transpose).apply(null,arguments)},u.__FusedMatMul=function(){return(u.__FusedMatMul=u.asm._FusedMatMul).apply(null,arguments)},u._malloc=function(){return(u._malloc=u.asm.malloc).apply(null,arguments)},u._free=function(){return(u._free=u.asm.free).apply(null,arguments)},u.__emscripten_tls_init=function(){return(u.__emscripten_tls_init=u.asm._emscripten_tls_init).apply(null,arguments)};var De=u._pthread_self=function(){return(De=u._pthread_self=u.asm.pthread_self).apply(null,arguments)};u.___errno_location=function(){return(u.___errno_location=u.asm.__errno_location).apply(null,arguments)};var Fe=u.__emscripten_thread_init=function(){return(Fe=u.__emscripten_thread_init=u.asm._emscripten_thread_init).apply(null,arguments)};u.__emscripten_thread_crashed=function(){return(u.__emscripten_thread_crashed=u.asm._emscripten_thread_crashed).apply(null,arguments)},u._emscripten_main_thread_process_queued_calls=function(){return(u._emscripten_main_thread_process_queued_calls=u.asm.emscripten_main_thread_process_queued_calls).apply(null,arguments)},u._emscripten_main_browser_thread_id=function(){return(u._emscripten_main_browser_thread_id=u.asm.emscripten_main_browser_thread_id).apply(null,arguments)};var Me=u._emscripten_run_in_main_runtime_thread_js=function(){return(Me=u._emscripten_run_in_main_runtime_thread_js=u.asm.emscripten_run_in_main_runtime_thread_js).apply(null,arguments)};u._emscripten_dispatch_to_thread_=function(){return(u._emscripten_dispatch_to_thread_=u.asm.emscripten_dispatch_to_thread_).apply(null,arguments)};var Oe,Pe,Le,ze=u.__emscripten_proxy_execute_task_queue=function(){return(ze=u.__emscripten_proxy_execute_task_queue=u.asm._emscripten_proxy_execute_task_queue).apply(null,arguments)},Be=u.__emscripten_thread_free_data=function(){return(Be=u.__emscripten_thread_free_data=u.asm._emscripten_thread_free_data).apply(null,arguments)},We=u.__emscripten_thread_exit=function(){return(We=u.__emscripten_thread_exit=u.asm._emscripten_thread_exit).apply(null,arguments)},Ve=u._emscripten_stack_set_limits=function(){return(Ve=u._emscripten_stack_set_limits=u.asm.emscripten_stack_set_limits).apply(null,arguments)},Ue=u.stackSave=function(){return(Ue=u.stackSave=u.asm.stackSave).apply(null,arguments)},je=u.stackRestore=function(){return(je=u.stackRestore=u.asm.stackRestore).apply(null,arguments)},He=u.stackAlloc=function(){return(He=u.stackAlloc=u.asm.stackAlloc).apply(null,arguments)};function Ge(e){if(!(J>0)){if(y)return s(u),K(),void startWorker(u);(function(){if(u.preRun)for("function"==typeof u.preRun&&(u.preRun=[u.preRun]);u.preRun.length;)X(u.preRun.shift());pe(j)})(),J>0||(u.setStatus?(u.setStatus("Running..."),setTimeout((function(){setTimeout((function(){u.setStatus("")}),1),t()}),1)):t())}function t(){Oe||(Oe=!0,u.calledRun=!0,!L&&(K(),s(u),u.onRuntimeInitialized&&u.onRuntimeInitialized(),function(){if(!y){if(u.postRun)for("function"==typeof u.postRun&&(u.postRun=[u.postRun]);u.postRun.length;)Y(u.postRun.shift());pe(G)}}()))}}if(u.dynCall_iijjiiii=function(){return(u.dynCall_iijjiiii=u.asm.dynCall_iijjiiii).apply(null,arguments)},u.dynCall_jiji=function(){return(u.dynCall_jiji=u.asm.dynCall_jiji).apply(null,arguments)},u.keepRuntimeAlive=q,u.wasmMemory=_,u.cwrap=function(e,t,n,r){var a=(n=n||[]).every((e=>"number"===e||"boolean"===e));return"string"!==t&&a&&!r?Ee(e):function(){return $e(e,t,n,arguments)}},u.ExitStatus=se,u.PThread=ce,Z=function e(){Oe||Ge(),Oe||(Z=e)},u.preInit)for("function"==typeof u.preInit&&(u.preInit=[u.preInit]);u.preInit.length>0;)u.preInit.pop()();if(Ge(),l&&(Pe={uncaughtException:process.listeners("uncaughtException").filter((function(e){return!l.uncaughtException.indexOf(e)>-1})),unhandledRejection:process.listeners("unhandledRejection").filter((function(e){return!l.unhandledRejection.indexOf(e)>-1}))}),"undefined"!=typeof WasmBackendModule)Le=WasmBackendModule;else{if(void 0===t)throw new Error("Could not find wasm module in post.js");Le=t}if(Pe){var qe=Le._dispose;Le._dispose=function(){qe(),Pe.uncaughtException.forEach((function(e){process.removeListener("uncaughtException",e)})),Pe.unhandledRejection.forEach((function(e){process.removeListener("unhandledRejection",e)}))}}return t.ready}})();"object"==typeof e&&"object"==typeof t?t.exports=n:"function"==typeof define&&define.amd?define([],(function(){return n})):"object"==typeof e&&(e.WasmBackendModuleThreadedSimd=n)})),Ek=sk(((e,t)=>{t.exports.wasmWorkerContents='"use strict";var Module={};var ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string";if(ENVIRONMENT_IS_NODE){var nodeWorkerThreads=require("worker_threads");var parentPort=nodeWorkerThreads.parentPort;parentPort.on("message",data=>onmessage({data:data}));var fs=require("fs");Object.assign(global,{self:global,require:require,Module:Module,location:{href:__filename},Worker:nodeWorkerThreads.Worker,importScripts:function(f){(0,eval)(fs.readFileSync(f,"utf8")+"//# sourceURL="+f)},postMessage:function(msg){parentPort.postMessage(msg)},performance:global.performance||{now:function(){return Date.now()}}})}var initializedJS=false;var pendingNotifiedProxyingQueues=[];function threadPrintErr(){var text=Array.prototype.slice.call(arguments).join(" ");if(ENVIRONMENT_IS_NODE){fs.writeSync(2,text+"\n");return}console.error(text)}function threadAlert(){var text=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:text,threadId:Module["_pthread_self"]()})}var err=threadPrintErr;self.alert=threadAlert;Module["instantiateWasm"]=(info,receiveInstance)=>{var instance=new WebAssembly.Instance(Module["wasmModule"],info);receiveInstance(instance);Module["wasmModule"]=null;return instance.exports};self.onunhandledrejection=e=>{throw e.reason??e};self.startWorker=instance=>{Module=instance;postMessage({"cmd":"loaded"})};self.onmessage=e=>{try{if(e.data.cmd==="load"){Module["wasmModule"]=e.data.wasmModule;for(const handler of e.data.handlers){Module[handler]=function(){postMessage({cmd:"callHandler",handler:handler,args:[...arguments]})}}Module["wasmMemory"]=e.data.wasmMemory;Module["buffer"]=Module["wasmMemory"].buffer;Module["ENVIRONMENT_IS_PTHREAD"]=true;if(typeof e.data.urlOrBlob=="string"){importScripts(e.data.urlOrBlob)}else{var objectUrl=URL.createObjectURL(e.data.urlOrBlob);importScripts(objectUrl);URL.revokeObjectURL(objectUrl)}WasmBackendModuleThreadedSimd(Module)}else if(e.data.cmd==="run"){Module["__emscripten_thread_init"](e.data.pthread_ptr,0,0,1);Module["establishStackSpace"]();Module["PThread"].receiveObjectTransfer(e.data);Module["PThread"].threadInitTLS();if(!initializedJS){pendingNotifiedProxyingQueues.forEach(queue=>{Module["executeNotifiedProxyingQueue"](queue)});pendingNotifiedProxyingQueues=[];initializedJS=true}try{Module["invokeEntryPoint"](e.data.start_routine,e.data.arg)}catch(ex){if(ex!="unwind"){if(ex instanceof Module["ExitStatus"]){if(Module["keepRuntimeAlive"]()){}else{Module["__emscripten_thread_exit"](ex.status)}}else{throw ex}}}}else if(e.data.cmd==="cancel"){if(Module["_pthread_self"]()){Module["__emscripten_thread_exit"](-1)}}else if(e.data.target==="setimmediate"){}else if(e.data.cmd==="processProxyingQueue"){if(initializedJS){Module["executeNotifiedProxyingQueue"](e.data.queue)}else{pendingNotifiedProxyingQueues.push(e.data.queue)}}else if(e.data.cmd){err("worker.js received unknown command "+e.data.cmd);err(e.data)}}catch(ex){if(Module["__emscripten_thread_crashed"]){Module["__emscripten_thread_crashed"]()}throw ex}};'})),_k=sk(((e,t)=>{var n=(()=>{var e="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0;return"undefined"!=typeof __filename&&(e=e||__filename),function(t){var n,r,a,i=void 0!==(t=t||{})?t:{};i.ready=new Promise((function(e,t){n=e,r=t})),"undefined"!=typeof process&&process.listeners&&(a={uncaughtException:process.listeners("uncaughtException"),unhandledRejection:process.listeners("unhandledRejection")});var s,o,l,u=Object.assign({},i),d="object"==typeof window,c="function"==typeof importScripts,p="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,h="";if(p){var f=kk(),m=Sk();h=c?m.dirname(h)+"/":__dirname+"/",s=(e,t)=>(e=z(e)?new URL(e):m.normalize(e),f.readFileSync(e,t?void 0:"utf8")),l=e=>{var t=s(e,!0);return t.buffer||(t=new Uint8Array(t)),t},o=(e,t,n)=>{e=z(e)?new URL(e):m.normalize(e),f.readFile(e,(function(e,r){e?n(e):t(r.buffer)}))},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",(function(e){if(!(e instanceof W))throw e})),process.on("unhandledRejection",(function(e){throw e})),i.inspect=function(){return"[Emscripten Module object]"}}else(d||c)&&(c?h=self.location.href:"undefined"!=typeof document&&document.currentScript&&(h=document.currentScript.src),e&&(h=e),h=0!==h.indexOf("blob:")?h.substr(0,h.replace(/[?#].*/,"").lastIndexOf("/")+1):"",s=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},c&&(l=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),o=(e,t,n)=>{var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.onload=()=>{200==r.status||0==r.status&&r.response?t(r.response):n()},r.onerror=n,r.send(null)});var g,b=i.print||console.log.bind(console),y=i.printErr||console.warn.bind(console);Object.assign(i,u),u=null,i.arguments&&i.arguments,i.thisProgram&&i.thisProgram,i.quit&&i.quit,i.wasmBinary&&(g=i.wasmBinary),i.noExitRuntime,"object"!=typeof WebAssembly&&M("no native wasm support detected");var v,x,w,k,S,I=!1,N="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function C(e,t,n){for(var r=(t>>>=0)+n,a=t;e[a]&&!(a>=r);)++a;if(a-t>16&&e.buffer&&N)return N.decode(e.subarray(t,a));for(var i="";t<a;){var s=e[t++];if(128&s){var o=63&e[t++];if(192!=(224&s)){var l=63&e[t++];if((s=224==(240&s)?(15&s)<<12|o<<6|l:(7&s)<<18|o<<12|l<<6|63&e[t++])<65536)i+=String.fromCharCode(s);else{var u=s-65536;i+=String.fromCharCode(55296|u>>10,56320|1023&u)}}else i+=String.fromCharCode((31&s)<<6|o)}else i+=String.fromCharCode(s)}return i}function T(e){x=e,i.HEAP8=w=new Int8Array(e),i.HEAP16=new Int16Array(e),i.HEAP32=new Int32Array(e),i.HEAPU8=k=new Uint8Array(e),i.HEAPU16=new Uint16Array(e),i.HEAPU32=S=new Uint32Array(e),i.HEAPF32=new Float32Array(e),i.HEAPF64=new Float64Array(e)}i.INITIAL_MEMORY;var E=[],_=[],$=[];function A(e){E.unshift(e)}function R(e){$.unshift(e)}var D=0,F=null;function M(e){i.onAbort&&i.onAbort(e),y(e="Aborted("+e+")"),I=!0,e+=". Build with -sASSERTIONS for more info.";var t=new WebAssembly.RuntimeError(e);throw r(t),t}var O,P="data:application/octet-stream;base64,";function L(e){return e.startsWith(P)}function z(e){return e.startsWith("file://")}function B(e){try{if(e==O&&g)return new Uint8Array(g);if(l)return l(e);throw"both async and sync fetching of the wasm failed"}catch(Ha){M(Ha)}}function W(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function V(e){for(;e.length>0;)e.shift()(i)}function U(e){try{return v.grow(e-x.byteLength+65535>>>16),T(v.buffer),1}catch(Ha){}}L(O="tfjs-backend-wasm.wasm")||(O=function(e){return i.locateFile?i.locateFile(e,h):h+e}(O));var j=[null,[],[]];function H(e,t){var n=j[e];0===t||10===t?((1===e?b:y)(C(n,0)),n.length=0):n.push(t)}function G(e){return i["_"+e]}function q(e,t,n,r,a){var i={string:e=>{var t=0;if(null!=e&&0!==e){var n=1+(e.length<<2);!function(e,t,n){!function(e,t,n,r){if(!(r>0))return 0;n>>>=0;for(var a=n+r-1,i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s>=55296&&s<=57343&&(s=65536+((1023&s)<<10)|1023&e.charCodeAt(++i)),s<=127){if(n>=a)break;t[n++>>>0]=s}else if(s<=2047){if(n+1>=a)break;t[n++>>>0]=192|s>>6,t[n++>>>0]=128|63&s}else if(s<=65535){if(n+2>=a)break;t[n++>>>0]=224|s>>12,t[n++>>>0]=128|s>>6&63,t[n++>>>0]=128|63&s}else{if(n+3>=a)break;t[n++>>>0]=240|s>>18,t[n++>>>0]=128|s>>12&63,t[n++>>>0]=128|s>>6&63,t[n++>>>0]=128|63&s}}t[n>>>0]=0}(e,k,t,n)}(e,t=ee(n),n)}return t},array:e=>{var t=ee(e.length);return function(e,t){w.set(e,t>>>0)}(e,t),t}};function s(e){return"string"===t?function(e,t){return(e>>>=0)?C(k,e,t):""}(e):"boolean"===t?!!e:e}var o=G(e),l=[],u=0;if(r)for(var d=0;d<r.length;d++){var c=i[n[d]];c?(0===u&&(u=Z()),l[d]=c(r[d])):l[d]=r[d]}var p,h=o.apply(null,l);return p=h,0!==u&&Q(u),h=s(p)}var K={abort:function(){M("")},emscripten_get_heap_max:function(){return 4294901760},emscripten_memcpy_big:function(e,t,n){k.copyWithin(e>>>0,t>>>0,t+n>>>0)},emscripten_resize_heap:function(e){var t=k.length,n=4294901760;if((e>>>=0)>n)return!1;let r=(e,t)=>e+(t-e%t)%t;for(var a=1;a<=4;a*=2){var i=t*(1+.2/a);if(i=Math.min(i,e+100663296),U(Math.min(n,r(Math.max(e,i),65536))))return!0}return!1},fd_close:function(e){return 52},fd_seek:function(e,t,n,r,a){return 70},fd_write:function(e,t,n,r){for(var a=0,i=0;i<n;i++){var s=S[t>>>2],o=S[t+4>>>2];t+=8;for(var l=0;l<o;l++)H(e,k[s+l>>>0]);a+=o}return S[r>>>2]=a,0}};!function(){var e={env:K,wasi_snapshot_preview1:K};function t(e,t){var n=e.exports;i.asm=n,T((v=i.asm.memory).buffer),i.asm.__indirect_function_table,function(e){_.unshift(e)}(i.asm.__wasm_call_ctors),function(e){if(D--,i.monitorRunDependencies&&i.monitorRunDependencies(D),0==D&&F){var t=F;F=null,t()}}()}function n(e){t(e.instance)}function a(t){return function(){if(!g&&(d||c)){if("function"==typeof fetch&&!z(O))return fetch(O,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+O+"'";return e.arrayBuffer()})).catch((function(){return B(O)}));if(o)return new Promise((function(e,t){o(O,(function(t){e(new Uint8Array(t))}),t)}))}return Promise.resolve().then((function(){return B(O)}))}().then((function(t){return WebAssembly.instantiate(t,e)})).then((function(e){return e})).then(t,(function(e){y("failed to asynchronously prepare wasm: "+e),M(e)}))}if(D++,i.monitorRunDependencies&&i.monitorRunDependencies(D),i.instantiateWasm)try{return i.instantiateWasm(e,t)}catch(sa){y("Module.instantiateWasm callback failed with error: "+sa),r(sa)}(g||"function"!=typeof WebAssembly.instantiateStreaming||L(O)||z(O)||p||"function"!=typeof fetch?a(n):fetch(O,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,e).then(n,(function(e){return y("wasm streaming compile failed: "+e),y("falling back to ArrayBuffer instantiation"),a(n)}))}))).catch(r)}(),i.___wasm_call_ctors=function(){return(i.___wasm_call_ctors=i.asm.__wasm_call_ctors).apply(null,arguments)},i._init=function(){return(i._init=i.asm.init).apply(null,arguments)},i._init_with_threads_count=function(){return(i._init_with_threads_count=i.asm.init_with_threads_count).apply(null,arguments)},i._get_threads_count=function(){return(i._get_threads_count=i.asm.get_threads_count).apply(null,arguments)},i._register_tensor=function(){return(i._register_tensor=i.asm.register_tensor).apply(null,arguments)},i._dispose_data=function(){return(i._dispose_data=i.asm.dispose_data).apply(null,arguments)},i._dispose=function(){return(i._dispose=i.asm.dispose).apply(null,arguments)},i._Abs=function(){return(i._Abs=i.asm.Abs).apply(null,arguments)},i._Acos=function(){return(i._Acos=i.asm.Acos).apply(null,arguments)},i._Acosh=function(){return(i._Acosh=i.asm.Acosh).apply(null,arguments)},i._Add=function(){return(i._Add=i.asm.Add).apply(null,arguments)},i._AddN=function(){return(i._AddN=i.asm.AddN).apply(null,arguments)},i._All=function(){return(i._All=i.asm.All).apply(null,arguments)},i._Any=function(){return(i._Any=i.asm.Any).apply(null,arguments)},i._ArgMax=function(){return(i._ArgMax=i.asm.ArgMax).apply(null,arguments)},i._ArgMin=function(){return(i._ArgMin=i.asm.ArgMin).apply(null,arguments)},i._Asin=function(){return(i._Asin=i.asm.Asin).apply(null,arguments)},i._Asinh=function(){return(i._Asinh=i.asm.Asinh).apply(null,arguments)},i._Atan=function(){return(i._Atan=i.asm.Atan).apply(null,arguments)},i._Atan2=function(){return(i._Atan2=i.asm.Atan2).apply(null,arguments)},i._Atanh=function(){return(i._Atanh=i.asm.Atanh).apply(null,arguments)},i._AvgPool=function(){return(i._AvgPool=i.asm.AvgPool).apply(null,arguments)},i._AvgPool3D=function(){return(i._AvgPool3D=i.asm.AvgPool3D).apply(null,arguments)},i._AvgPool3DGrad=function(){return(i._AvgPool3DGrad=i.asm.AvgPool3DGrad).apply(null,arguments)},i._AvgPoolGrad=function(){return(i._AvgPoolGrad=i.asm.AvgPoolGrad).apply(null,arguments)},i._BatchMatMul=function(){return(i._BatchMatMul=i.asm.BatchMatMul).apply(null,arguments)},i._Bincount=function(){return(i._Bincount=i.asm.Bincount).apply(null,arguments)},i._BitwiseAnd=function(){return(i._BitwiseAnd=i.asm.BitwiseAnd).apply(null,arguments)},i._Ceil=function(){return(i._Ceil=i.asm.Ceil).apply(null,arguments)},i._ClipByValue=function(){return(i._ClipByValue=i.asm.ClipByValue).apply(null,arguments)},i._Conv2D=function(){return(i._Conv2D=i.asm.Conv2D).apply(null,arguments)},i._Conv2DBackpropInput=function(){return(i._Conv2DBackpropInput=i.asm.Conv2DBackpropInput).apply(null,arguments)},i._Conv3D=function(){return(i._Conv3D=i.asm.Conv3D).apply(null,arguments)},i._Conv3DBackpropFilterV2=function(){return(i._Conv3DBackpropFilterV2=i.asm.Conv3DBackpropFilterV2).apply(null,arguments)},i._Conv3DBackpropInputV2=function(){return(i._Conv3DBackpropInputV2=i.asm.Conv3DBackpropInputV2).apply(null,arguments)},i._Cos=function(){return(i._Cos=i.asm.Cos).apply(null,arguments)},i._Cosh=function(){return(i._Cosh=i.asm.Cosh).apply(null,arguments)},i._CropAndResize=function(){return(i._CropAndResize=i.asm.CropAndResize).apply(null,arguments)},i._Cumprod=function(){return(i._Cumprod=i.asm.Cumprod).apply(null,arguments)},i._Cumsum=function(){return(i._Cumsum=i.asm.Cumsum).apply(null,arguments)},i._DenseBincount=function(){return(i._DenseBincount=i.asm.DenseBincount).apply(null,arguments)},i._DepthToSpace=function(){return(i._DepthToSpace=i.asm.DepthToSpace).apply(null,arguments)},i._DepthwiseConv2dNative=function(){return(i._DepthwiseConv2dNative=i.asm.DepthwiseConv2dNative).apply(null,arguments)},i._Diag=function(){return(i._Diag=i.asm.Diag).apply(null,arguments)},i._Dilation2D=function(){return(i._Dilation2D=i.asm.Dilation2D).apply(null,arguments)},i._Dilation2DBackpropFilter=function(){return(i._Dilation2DBackpropFilter=i.asm.Dilation2DBackpropFilter).apply(null,arguments)},i._Dilation2DBackpropInput=function(){return(i._Dilation2DBackpropInput=i.asm.Dilation2DBackpropInput).apply(null,arguments)},i._Elu=function(){return(i._Elu=i.asm.Elu).apply(null,arguments)},i._EluGrad=function(){return(i._EluGrad=i.asm.EluGrad).apply(null,arguments)},i._Equal=function(){return(i._Equal=i.asm.Equal).apply(null,arguments)},i._Erf=function(){return(i._Erf=i.asm.Erf).apply(null,arguments)},i._Exp=function(){return(i._Exp=i.asm.Exp).apply(null,arguments)},i._Expm1=function(){return(i._Expm1=i.asm.Expm1).apply(null,arguments)},i._FlipLeftRight=function(){return(i._FlipLeftRight=i.asm.FlipLeftRight).apply(null,arguments)},i._Floor=function(){return(i._Floor=i.asm.Floor).apply(null,arguments)},i._FloorDiv=function(){return(i._FloorDiv=i.asm.FloorDiv).apply(null,arguments)},i._FusedBatchNorm=function(){return(i._FusedBatchNorm=i.asm.FusedBatchNorm).apply(null,arguments)},i._FusedConv2D=function(){return(i._FusedConv2D=i.asm.FusedConv2D).apply(null,arguments)},i._FusedDepthwiseConv2D=function(){return(i._FusedDepthwiseConv2D=i.asm.FusedDepthwiseConv2D).apply(null,arguments)},i._Gather=function(){return(i._Gather=i.asm.Gather).apply(null,arguments)},i._GatherNd=function(){return(i._GatherNd=i.asm.GatherNd).apply(null,arguments)},i._Greater=function(){return(i._Greater=i.asm.Greater).apply(null,arguments)},i._GreaterEqual=function(){return(i._GreaterEqual=i.asm.GreaterEqual).apply(null,arguments)},i._IsFinite=function(){return(i._IsFinite=i.asm.IsFinite).apply(null,arguments)},i._IsInf=function(){return(i._IsInf=i.asm.IsInf).apply(null,arguments)},i._IsNan=function(){return(i._IsNan=i.asm.IsNan).apply(null,arguments)},i._LRN=function(){return(i._LRN=i.asm.LRN).apply(null,arguments)},i._LRNGrad=function(){return(i._LRNGrad=i.asm.LRNGrad).apply(null,arguments)},i._LeakyRelu=function(){return(i._LeakyRelu=i.asm.LeakyRelu).apply(null,arguments)},i._Less=function(){return(i._Less=i.asm.Less).apply(null,arguments)},i._LessEqual=function(){return(i._LessEqual=i.asm.LessEqual).apply(null,arguments)},i._LinSpace=function(){return(i._LinSpace=i.asm.LinSpace).apply(null,arguments)},i._Log=function(){return(i._Log=i.asm.Log).apply(null,arguments)},i._Log1p=function(){return(i._Log1p=i.asm.Log1p).apply(null,arguments)},i._LogicalAnd=function(){return(i._LogicalAnd=i.asm.LogicalAnd).apply(null,arguments)},i._LogicalNot=function(){return(i._LogicalNot=i.asm.LogicalNot).apply(null,arguments)},i._LogicalOr=function(){return(i._LogicalOr=i.asm.LogicalOr).apply(null,arguments)},i._LogicalXor=function(){return(i._LogicalXor=i.asm.LogicalXor).apply(null,arguments)},i._Max=function(){return(i._Max=i.asm.Max).apply(null,arguments)},i._MaxPool=function(){return(i._MaxPool=i.asm.MaxPool).apply(null,arguments)},i._MaxPool3D=function(){return(i._MaxPool3D=i.asm.MaxPool3D).apply(null,arguments)},i._MaxPool3DGrad=function(){return(i._MaxPool3DGrad=i.asm.MaxPool3DGrad).apply(null,arguments)},i._MaxPoolGrad=function(){return(i._MaxPoolGrad=i.asm.MaxPoolGrad).apply(null,arguments)},i._MaxPoolWithArgmax=function(){return(i._MaxPoolWithArgmax=i.asm.MaxPoolWithArgmax).apply(null,arguments)},i._Maximum=function(){return(i._Maximum=i.asm.Maximum).apply(null,arguments)},i._Mean=function(){return(i._Mean=i.asm.Mean).apply(null,arguments)},i._Min=function(){return(i._Min=i.asm.Min).apply(null,arguments)},i._Minimum=function(){return(i._Minimum=i.asm.Minimum).apply(null,arguments)},i._MirrorPad=function(){return(i._MirrorPad=i.asm.MirrorPad).apply(null,arguments)},i._Mod=function(){return(i._Mod=i.asm.Mod).apply(null,arguments)},i._Multinomial=function(){return(i._Multinomial=i.asm.Multinomial).apply(null,arguments)},i._Multiply=function(){return(i._Multiply=i.asm.Multiply).apply(null,arguments)},i._Neg=function(){return(i._Neg=i.asm.Neg).apply(null,arguments)},i._NonMaxSuppressionV3=function(){return(i._NonMaxSuppressionV3=i.asm.NonMaxSuppressionV3).apply(null,arguments)},i._NonMaxSuppressionV4=function(){return(i._NonMaxSuppressionV4=i.asm.NonMaxSuppressionV4).apply(null,arguments)},i._NonMaxSuppressionV5=function(){return(i._NonMaxSuppressionV5=i.asm.NonMaxSuppressionV5).apply(null,arguments)},i._NotEqual=function(){return(i._NotEqual=i.asm.NotEqual).apply(null,arguments)},i._OneHot=function(){return(i._OneHot=i.asm.OneHot).apply(null,arguments)},i._PadV2=function(){return(i._PadV2=i.asm.PadV2).apply(null,arguments)},i._Pow=function(){return(i._Pow=i.asm.Pow).apply(null,arguments)},i._Prelu=function(){return(i._Prelu=i.asm.Prelu).apply(null,arguments)},i._Prod=function(){return(i._Prod=i.asm.Prod).apply(null,arguments)},i._RealDiv=function(){return(i._RealDiv=i.asm.RealDiv).apply(null,arguments)},i._Reciprocal=function(){return(i._Reciprocal=i.asm.Reciprocal).apply(null,arguments)},i._Relu=function(){return(i._Relu=i.asm.Relu).apply(null,arguments)},i._Relu6=function(){return(i._Relu6=i.asm.Relu6).apply(null,arguments)},i._ResizeBilinear=function(){return(i._ResizeBilinear=i.asm.ResizeBilinear).apply(null,arguments)},i._ResizeBilinearGrad=function(){return(i._ResizeBilinearGrad=i.asm.ResizeBilinearGrad).apply(null,arguments)},i._ResizeNearestNeighbor=function(){return(i._ResizeNearestNeighbor=i.asm.ResizeNearestNeighbor).apply(null,arguments)},i._ResizeNearestNeighborGrad=function(){return(i._ResizeNearestNeighborGrad=i.asm.ResizeNearestNeighborGrad).apply(null,arguments)},i._Reverse=function(){return(i._Reverse=i.asm.Reverse).apply(null,arguments)},i._RotateWithOffset=function(){return(i._RotateWithOffset=i.asm.RotateWithOffset).apply(null,arguments)},i._Round=function(){return(i._Round=i.asm.Round).apply(null,arguments)},i._Rsqrt=function(){return(i._Rsqrt=i.asm.Rsqrt).apply(null,arguments)},i._ScatterNd=function(){return(i._ScatterNd=i.asm.ScatterNd).apply(null,arguments)},i._SearchSorted=function(){return(i._SearchSorted=i.asm.SearchSorted).apply(null,arguments)},i._SelectV2=function(){return(i._SelectV2=i.asm.SelectV2).apply(null,arguments)},i._Selu=function(){return(i._Selu=i.asm.Selu).apply(null,arguments)},i._Sigmoid=function(){return(i._Sigmoid=i.asm.Sigmoid).apply(null,arguments)},i._Sign=function(){return(i._Sign=i.asm.Sign).apply(null,arguments)},i._Sin=function(){return(i._Sin=i.asm.Sin).apply(null,arguments)},i._Sinh=function(){return(i._Sinh=i.asm.Sinh).apply(null,arguments)},i._Softmax=function(){return(i._Softmax=i.asm.Softmax).apply(null,arguments)},i._Softplus=function(){return(i._Softplus=i.asm.Softplus).apply(null,arguments)},i._SparseFillEmptyRows=function(){return(i._SparseFillEmptyRows=i.asm.SparseFillEmptyRows).apply(null,arguments)},i._SparseReshape=function(){return(i._SparseReshape=i.asm.SparseReshape).apply(null,arguments)},i._SparseSegmentReduction=function(){return(i._SparseSegmentReduction=i.asm.SparseSegmentReduction).apply(null,arguments)},i._SparseToDense=function(){return(i._SparseToDense=i.asm.SparseToDense).apply(null,arguments)},i._Sqrt=function(){return(i._Sqrt=i.asm.Sqrt).apply(null,arguments)},i._Square=function(){return(i._Square=i.asm.Square).apply(null,arguments)},i._SquaredDifference=function(){return(i._SquaredDifference=i.asm.SquaredDifference).apply(null,arguments)},i._Step=function(){return(i._Step=i.asm.Step).apply(null,arguments)},i._StridedSlice=function(){return(i._StridedSlice=i.asm.StridedSlice).apply(null,arguments)},i._Sub=function(){return(i._Sub=i.asm.Sub).apply(null,arguments)},i._Sum=function(){return(i._Sum=i.asm.Sum).apply(null,arguments)},i._Tan=function(){return(i._Tan=i.asm.Tan).apply(null,arguments)},i._Tanh=function(){return(i._Tanh=i.asm.Tanh).apply(null,arguments)},i._TensorScatterUpdate=function(){return(i._TensorScatterUpdate=i.asm.TensorScatterUpdate).apply(null,arguments)},i._Tile=function(){return(i._Tile=i.asm.Tile).apply(null,arguments)},i._TopK=function(){return(i._TopK=i.asm.TopK).apply(null,arguments)},i._Transform=function(){return(i._Transform=i.asm.Transform).apply(null,arguments)},i._Transpose=function(){return(i._Transpose=i.asm.Transpose).apply(null,arguments)},i.__FusedMatMul=function(){return(i.__FusedMatMul=i.asm._FusedMatMul).apply(null,arguments)},i._malloc=function(){return(i._malloc=i.asm.malloc).apply(null,arguments)},i._free=function(){return(i._free=i.asm.free).apply(null,arguments)},i.___errno_location=function(){return(i.___errno_location=i.asm.__errno_location).apply(null,arguments)};var X,Y,J,Z=i.stackSave=function(){return(Z=i.stackSave=i.asm.stackSave).apply(null,arguments)},Q=i.stackRestore=function(){return(Q=i.stackRestore=i.asm.stackRestore).apply(null,arguments)},ee=i.stackAlloc=function(){return(ee=i.stackAlloc=i.asm.stackAlloc).apply(null,arguments)};function te(e){function t(){X||(X=!0,i.calledRun=!0,!I&&(V(_),n(i),i.onRuntimeInitialized&&i.onRuntimeInitialized(),function(){if(i.postRun)for("function"==typeof i.postRun&&(i.postRun=[i.postRun]);i.postRun.length;)R(i.postRun.shift());V($)}()))}D>0||(function(){if(i.preRun)for("function"==typeof i.preRun&&(i.preRun=[i.preRun]);i.preRun.length;)A(i.preRun.shift());V(E)}(),D>0)||(i.setStatus?(i.setStatus("Running..."),setTimeout((function(){setTimeout((function(){i.setStatus("")}),1),t()}),1)):t())}if(i.dynCall_iijjiiii=function(){return(i.dynCall_iijjiiii=i.asm.dynCall_iijjiiii).apply(null,arguments)},i.dynCall_jiji=function(){return(i.dynCall_jiji=i.asm.dynCall_jiji).apply(null,arguments)},i.cwrap=function(e,t,n,r){var a=(n=n||[]).every((e=>"number"===e||"boolean"===e));return"string"!==t&&a&&!r?G(e):function(){return q(e,t,n,arguments)}},F=function e(){X||te(),X||(F=e)},i.preInit)for("function"==typeof i.preInit&&(i.preInit=[i.preInit]);i.preInit.length>0;)i.preInit.pop()();if(te(),a&&(Y={uncaughtException:process.listeners("uncaughtException").filter((function(e){return!a.uncaughtException.indexOf(e)>-1})),unhandledRejection:process.listeners("unhandledRejection").filter((function(e){return!a.unhandledRejection.indexOf(e)>-1}))}),void 0!==t)J=t;else{if("undefined"==typeof WasmBackendModuleThreadedSimd)throw new Error("Could not find wasm module in post.js");J=WasmBackendModuleThreadedSimd}if(Y){var ne=J._dispose;J._dispose=function(){ne(),Y.uncaughtException.forEach((function(e){process.removeListener("uncaughtException",e)})),Y.unhandledRejection.forEach((function(e){process.removeListener("unhandledRejection",e)}))}}return t.ready}})();"object"==typeof e&&"object"==typeof t?t.exports=n:"function"==typeof define&&define.amd?define([],(function(){return n})):"object"==typeof e&&(e.WasmBackendModule=n)})),$k=class{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}},Ak=class{refCount(e){return Rk("refCount")}incRef(e){return Rk("incRef")}timerAvailable(){return!0}time(e){return Rk("time")}read(e){return Rk("read")}readSync(e){return Rk("readSync")}readToGPU(e,t){return Rk("readToGPU")}numDataIds(){return Rk("numDataIds")}disposeData(e,t){return Rk("disposeData")}write(e,t,n){return Rk("write")}move(e,t,n,r,a){return Rk("move")}createTensorFromGPUData(e,t,n){return Rk("createTensorFromGPUData")}memory(){return Rk("memory")}floatPrecision(){return Rk("floatPrecision")}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}dispose(){return Rk("dispose")}};function Rk(e){throw new Error(`'${e}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}function Dk(e){let t=e.length,n=0;for(;t>0;)n=Math.random()*t|0,t--,Pk(e,t,n)}function Fk(e,t){if(e.length!==t.length)throw new Error(`Array sizes must match to be shuffled together First array length was ${e.length}Second array length was ${t.length}`);let n=e.length,r=0;for(;n>0;)r=Math.random()*n|0,n--,Pk(e,n,r),Pk(t,n,r)}function Mk(e,t,n){return Math.max(e,Math.min(t,n))}function Ok(e){return e%2==0?e:e+1}function Pk(e,t,n){let r=e[t];e[t]=e[n],e[n]=r}function Lk(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n];return t}function zk(e,t){let n=Math.random();return t*n+(1-n)*e}function Bk(e,t){let n=0;for(let r=0;r<e.length;r++){let a=Number(e[r])-Number(t[r]);n+=a*a}return n}function Wk(e,t){if(!e)throw new Error("string"==typeof t?t:t())}function Vk(e,t,n=""){Wk(qk(e,t),(()=>n+` Shapes ${e} and ${t} must match`))}function Uk(e){Wk(null!=e,(()=>"The input to the tensor constructor must be a non-null value."))}function jk(e){if(0===e.length)return 1;let t=e[0];for(let n=1;n<e.length;n++)t*=e[n];return t}function Hk(e){return 0===e.length}function Gk(e,t){if(e===t)return!0;if(null==e||null==t||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(null!==e[n]&&null!==t[n]&&e[n]!==t[n])return!1;return!0}function qk(e,t){if(e===t)return!0;if(null==e||null==t||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Kk(e){return e%1==0}function Xk(e){if(null!=Math.tanh)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;{let t=Math.exp(2*e);return(t-1)/(t+1)}}function Yk(e){let t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function Jk(e){let t=new Uint32Array(e);for(let n=0;n<e;++n)t[n]=n;return Dk(t),t}function Zk(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function Qk(e,t=(e=>0),n,r){return new Promise(((a,i)=>{let s=0,o=()=>{if(e())return void a();s++;let l=t(s);null!=n&&s>=n?i():null!=r?r(o,l):setTimeout(o,l)};o()}))}function eS(e,t){let n=1,r=-1;for(let i=0;i<e.length;++i)if(e[i]>=0)n*=e[i];else if(-1===e[i]){if(-1!==r)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${i}`);r=i}else if(e[i]<0)throw Error(`Shapes can not be < 0. Found ${e[i]} at dim ${i}`);if(-1===r){if(t>0&&t!==n)throw Error(`Size(${t}) must match the product of shape ${e}`);return e}if(0===n)throw Error(`Cannot infer the missing size in [${e}] when there are 0 elements`);if(t%n!=0)throw Error(`The implicit shape can't be a fractional number. Got ${t} / ${n}`);let a=e.slice();return a[r]=t/n,a}function tS(e,t){let n=t.length;return e=null==e?t.map(((e,t)=>t)):[].concat(e),Wk(e.every((e=>e>=-n&&e<n)),(()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${e}`)),Wk(e.every((e=>Kk(e))),(()=>`All values in axis param must be integers but got axis ${e}`)),e.map((e=>e<0?n+e:e))}function nS(e,t){let n=[],r=[],a=null!=t&&Array.isArray(t)&&0===t.length,i=null==t||a?null:tS(t,e).sort(),s=0;for(let o=0;o<e.length;++o){if(null!=i){if(i[s]===o&&1!==e[o])throw new Error(`Can't squeeze axis ${o} since its dim '${e[o]}' is not 1`);(null==i[s]||i[s]>o)&&1===e[o]&&(n.push(e[o]),r.push(o)),i[s]<=o&&s++}1!==e[o]&&(n.push(e[o]),r.push(o))}return{newShape:n,keptDims:r}}function rS(e,t){return aS(e,t)}function aS(e,t){let n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else{if("string"!==e)throw new Error(`Unknown data type ${e}`);n=new Array(t)}return n}function iS(e,t){for(let n=0;n<e.length;n++){let r=e[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${t} being uploaded contains ${r}.`)}}function sS(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}function oS(e,t){return!("complex64"===t||"float32"===t&&"complex64"!==e||"int32"===t&&"float32"!==e&&"complex64"!==e||"bool"===t&&"bool"===e)}function lS(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error(`Unknown dtype ${e}`)}function uS(e){if(null==e)return 0;let t=0;return e.forEach((e=>t+=e.length)),t}function dS(e){return"string"==typeof e||e instanceof String}function cS(e){return"boolean"==typeof e}function pS(e){return"number"==typeof e}function hS(e){return Array.isArray(e)?hS(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray?"int32":pS(e)?"float32":dS(e)?"string":cS(e)?"bool":"float32"}function fS(e){return!!(e&&e.constructor&&e.call&&e.apply)}function mS(e,t){for(let n=t;n<e;++n)if(e%n==0)return n;return e}function gS(e){let t=e.length;if(t<2)return[];let n=new Array(t-1);n[t-2]=e[t-1];for(let r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function bS(e,t,n,r=!1){let a=new Array;if(1===t.length){let i=t[0]*(r?2:1);for(let t=0;t<i;t++)a[t]=n[e+t]}else{let i=t[0],s=t.slice(1),o=s.reduce(((e,t)=>e*t))*(r?2:1);for(let t=0;t<i;t++)a[t]=bS(e+t*o,s,n,r)}return a}function yS(e,t,n=!1){if(0===e.length)return t[0];let r=e.reduce(((e,t)=>e*t))*(n?2:1);if(0===r)return[];if(r!==t.length)throw new Error(`[${e}] does not match the input size ${t.length}${n?" for a complex tensor":""}.`);return bS(0,e,t,n)}function vS(e,t){if(Array.isArray(e))return e;if("float32"===t)return e instanceof Float32Array?e:new Float32Array(e);if("int32"===t)return e instanceof Int32Array?e:new Int32Array(e);if("bool"===t||"string"===t)return Uint8Array.from(new Int32Array(e));throw new Error(`Unknown dtype ${t}`)}function xS(e,t){let n=wS(e,t);for(let r=0;r<n.length;r++)n[r]=1;return n}function wS(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error(`Unknown data type ${t}`)}function kS(e,t){let n=e.reduce(((e,t)=>e*t),1);if(null==t||"float32"===t)return yS(e,new Float32Array(n));if("int32"===t)return yS(e,new Int32Array(n));if("bool"===t)return yS(e,new Uint8Array(n));throw new Error(`Unknown data type ${t}`)}function SS(e){e.forEach((t=>{Wk(Number.isInteger(t)&&t>=0,(()=>`Tensor must have a shape comprised of positive integers but got shape [${e}].`))}))}function IS(e,t,n){if(0===t)return 0;if(1===t)return e[0];let r=e[e.length-1];for(let a=0;a<e.length-1;++a)r+=n[a]*e[a];return r}function NS(e,t,n){if(0===t)return[];if(1===t)return[e];let r=new Array(t);for(let a=0;a<r.length-1;++a)r[a]=Math.floor(e/n[a]),e-=r[a]*n[a];return r[r.length-1]=e,r}function CS(e){return e&&e.then&&"function"==typeof e.then}var TS="tfjsflags",ES=class{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=_S,this.populateURLFlags()}setPlatform(e,t){null!=this.platform&&($S().getBool("IS_TEST")||$S().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=t}registerFlag(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},null!=this.urlFlags[e]){let t=this.urlFlags[e];$S().getBool("IS_TEST")||$S().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${t}.`),this.set(e,t)}}async getAsync(e){return e in this.flags||(this.flags[e]=await this.evaluateFlag(e)),this.flags[e]}get(e){if(e in this.flags)return this.flags[e];let t=this.evaluateFlag(e);if(CS(t))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(null==this.flagRegistry[e])throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(null==this.flagRegistry[e])throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(void 0===this.global||void 0===this.global.location||void 0===this.global.location.search)return;let e=this.getQueryParams(this.global.location.search);TS in e&&e[TS].split(",").forEach((e=>{let[t,n]=e.split(":");this.urlFlags[t]=function(e,t){let n=t.toLowerCase();return"true"===n||"false"===n?"true"===n:""+ +n===n?+n:t}(0,n)}))}};function _S(e){let t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,((e,...n)=>(function(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}(t,n[0],n[1]),n.join("=")))),t}function $S(){return RS}var AS,RS=null;function DS(){if(null==AS){let e;if("undefined"!=typeof window)e=window;else if("undefined"!=typeof global)e=global;else if("undefined"!=typeof process)e=process;else{if("undefined"==typeof self)throw new Error("Could not find a global object");e=self}AS=e}return AS}function FS(e,t){let n=function(){let e=DS();return null==e._tfGlobals&&(e._tfGlobals=new Map),e._tfGlobals}();if(n.has(e))return n.get(e);{let r=t();return n.set(e,r),n.get(e)}}var MS="Abs",OS="Acos",PS="Acosh",LS="Add",zS="AddN",BS="All",WS="Any",VS="ArgMax",US="ArgMin",jS="Asin",HS="Asinh",GS="Atan",qS="Atanh",KS="Atan2",XS="AvgPool",YS="AvgPoolGrad",JS="AvgPool3D",ZS="AvgPool3DGrad",QS="BatchMatMul",eI="BatchToSpaceND",tI="Bincount",nI="BitwiseAnd",rI="BroadcastTo",aI="BroadcastArgs",iI="Cast",sI="Ceil",oI="ClipByValue",lI="Complex",uI="ComplexAbs",dI="Concat",cI="Conv2D",pI="Conv2DBackpropFilter",hI="Conv2DBackpropInput",fI="Conv3D",mI="Conv3DBackpropFilterV2",gI="Conv3DBackpropInputV2",bI="Cos",yI="Cosh",vI="Cumprod",xI="Cumsum",wI="CropAndResize",kI="DenseBincount",SI="DepthToSpace",II="DepthwiseConv2dNative",NI="DepthwiseConv2dNativeBackpropFilter",CI="DepthwiseConv2dNativeBackpropInput",TI="Diag",EI="Dilation2D",_I="Dilation2DBackpropInput",$I="Dilation2DBackpropFilter",AI="Draw",RI="RealDiv",DI="Einsum",FI="Elu",MI="EluGrad",OI="Erf",PI="Equal",LI="Exp",zI="ExpandDims",BI="Expm1",WI="FFT",VI="Fill",UI="FlipLeftRight",jI="Floor",HI="FloorDiv",GI="FusedBatchNorm",qI="GatherV2",KI="GatherNd",XI="Greater",YI="GreaterEqual",JI="Identity",ZI="IFFT",QI="Imag",eN="IsFinite",tN="IsInf",nN="IsNan",rN="LeakyRelu",aN="Less",iN="LessEqual",sN="LinSpace",oN="Log",lN="Log1p",uN="LogicalAnd",dN="LogicalNot",cN="LogicalOr",pN="LogicalXor",hN="LogSoftmax",fN="LowerBound",mN="LRN",gN="LRNGrad",bN="MatrixBandPart",yN="Max",vN="Maximum",xN="MaxPool",wN="MaxPoolGrad",kN="MaxPool3D",SN="MaxPool3DGrad",IN="MaxPoolWithArgmax",NN="Mean",CN="Min",TN="Minimum",EN="MirrorPad",_N="Mod",$N="Multinomial",AN="Multiply",RN="Neg",DN="NotEqual",FN="NonMaxSuppressionV3",MN="NonMaxSuppressionV4",ON="NonMaxSuppressionV5",PN="OnesLike",LN="OneHot",zN="Pack",BN="PadV2",WN="Pool",VN="Pow",UN="Prelu",jN="Prod",HN="RaggedGather",GN="RaggedRange",qN="RaggedTensorToTensor",KN="Range",XN="Real",YN="Reciprocal",JN="Relu",ZN="Reshape",QN="ResizeNearestNeighbor",eC="ResizeNearestNeighborGrad",tC="ResizeBilinear",nC="ResizeBilinearGrad",rC="Relu6",aC="Reverse",iC="Round",sC="Rsqrt",oC="ScatterNd",lC="TensorScatterUpdate",uC="SearchSorted",dC="Select",cC="Selu",pC="Slice",hC="Sin",fC="Sinh",mC="Sign",gC="Sigmoid",bC="Softplus",yC="Sqrt",vC="Sum",xC="SpaceToBatchND",wC="SplitV",kC="Softmax",SC="SparseFillEmptyRows",IC="SparseReshape",NC="SparseSegmentMean",CC="SparseSegmentSum",TC="SparseToDense",EC="SquaredDifference",_C="Square",$C="StaticRegexReplace",AC="StridedSlice",RC="StringNGrams",DC="StringSplit",FC="StringToHashBucketFast",MC="Sub",OC="Tan",PC="Tanh",LC="Tile",zC="TopK",BC="Transform",WC="Transpose",VC="Unique",UC="Unpack",jC="UnsortedSegmentSum",HC="UpperBound",GC="ZerosLike",qC="Step",KC="FromPixels",XC="RotateWithOffset",YC="_FusedMatMul",JC="FusedConv2D",ZC="FusedDepthwiseConv2D";function QC(...e){$S().getBool("IS_TEST")||$S().getBool("PROD")||console.warn(...e)}function eT(...e){$S().getBool("IS_TEST")||$S().getBool("PROD")||console.log(...e)}var tT=FS("kernelRegistry",(()=>new Map)),nT=FS("gradRegistry",(()=>new Map));function rT(e,t){let n=cT(e,t);return tT.get(n)}function aT(e){return nT.get(e)}function iT(e){let t=tT.entries(),n=[];for(;;){let{done:r,value:a}=t.next();if(r)break;let[i,s]=a,[o]=i.split("_");o===e&&n.push(s)}return n}function sT(e){let{kernelName:t,backendName:n}=e,r=cT(t,n);tT.has(r)&&QC(`The kernel '${t}' for backend '${n}' is already registered`),tT.set(r,e)}function oT(e){let{kernelName:t}=e;nT.has(t)&&$S().getBool("DEBUG")&&QC(`Overriding the gradient for '${t}'`),nT.set(t,e)}function lT(e,t){let n=cT(e,t);if(!tT.has(n))throw new Error(`The kernel '${e}' for backend '${t}' is not registered`);tT.delete(n)}function uT(e){if(!nT.has(e))throw new Error(`The gradient '${e}' for backend is not registered`);nT.delete(e)}function dT(e,t){iT(e).forEach((e=>{sT(Object.assign({},e,{backendName:t}))}))}function cT(e,t){return`${t}_${e}`}var pT={};function hT(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray}ok(pT,{arraysEqual:()=>qk,arraysEqualWithNull:()=>Gk,assert:()=>Wk,assertNonNegativeIntegerDimensions:()=>SS,assertNonNull:()=>Uk,assertShapesMatch:()=>Vk,bytesFromStringArray:()=>uS,bytesPerElement:()=>lS,checkConversionForErrors:()=>iS,clamp:()=>Mk,computeStrides:()=>gS,convertBackendValuesAndArrayBuffer:()=>vS,createScalarValue:()=>ET,createShuffledIndices:()=>Jk,decodeString:()=>DT,distSquared:()=>Bk,encodeString:()=>RT,fetch:()=>AT,fingerPrint64:()=>TT,flatten:()=>MT,getArrayFromDType:()=>aS,getTypedArrayFromDType:()=>rS,hasEncodingLoss:()=>oS,hexToLong:()=>gT,indexToLoc:()=>NS,inferDtype:()=>hS,inferFromImplicitShape:()=>eS,isBoolean:()=>cS,isFunction:()=>fS,isInt:()=>Kk,isNumber:()=>pS,isPromise:()=>CS,isScalarShape:()=>Hk,isString:()=>dS,isTypedArray:()=>FT,isValidDtype:()=>sS,locToIndex:()=>IS,makeOnesTypedArray:()=>xS,makeZerosNestedTypedArray:()=>kS,makeZerosTypedArray:()=>wS,nearestDivisor:()=>mS,nearestLargerEven:()=>Ok,now:()=>$T,parseAxisParam:()=>tS,randUniform:()=>zk,repeatedTry:()=>Qk,rightPad:()=>Zk,shuffle:()=>Dk,shuffleCombo:()=>Fk,sizeFromShape:()=>jk,sizeToSquarishShape:()=>Yk,squeezeShape:()=>nS,sum:()=>Lk,swap:()=>Pk,tanh:()=>Xk,toNestedArray:()=>yS,toTypedArray:()=>_T});var fT=lk(uk()),mT=fT.default||fT;function gT(e){return mT.fromString(e,!0,16)}var bT=gT("c3a5c85c97cb3127"),yT=gT("b492b66fbe98f273"),vT=gT("9ae16a3b2f90404f");function xT(e){return e.xor(e.shru(47))}function wT(e,t,n){let r=e.slice(t,t+n);return mT.fromBytes(Array.from(r),!0,!0)}function kT(e,t){return wT(e,t,8)}function ST(e,t){return wT(e,t,4)}function IT(e,t){return 0===t?e:e.shru(t).or(e.shl(64-t))}function NT(e,t,n=gT("9ddfea08eb382d69")){let r=e.xor(t).mul(n);r=r.xor(r.shru(47));let a=t.xor(r).mul(n);return a=a.xor(a.shru(47)),a=a.mul(n),a}function CT(e,t,n,r){return function(e,t,n,r,a,i){a=a.add(e),i=IT(i.add(a).add(r),21);let s=a;return a=(a=a.add(t)).add(n),i=i.add(IT(a,44)),[a.add(r),i.add(s)]}(kT(e,t),kT(e,t+8),kT(e,t+16),kT(e,t+24),n,r)}function TT(e,t=e.length){let n=mT.fromNumber(81,!0);if(t<=32)return t<=16?function(e,t=e.length){if(t>=8){let n=vT.add(2*t),r=kT(e,0).add(vT),a=kT(e,t-8);return NT(IT(a,37).mul(n).add(r),IT(r,25).add(a).mul(n),n)}if(t>=4){let n=vT.add(2*t);return NT(ST(e,0).shl(3).add(t),ST(e,t-4),n)}if(t>0){let n=e[0]+(e[t>>1]<<8),r=t+(e[t-1]<<2);return xT(vT.mul(n).xor(bT.mul(r))).mul(vT)}return vT}(e,t):function(e,t=e.length){let n=vT.add(2*t),r=kT(e,0).mul(yT),a=kT(e,8),i=kT(e,t-8).mul(n),s=kT(e,t-16).mul(vT);return NT(IT(r.add(a),43).add(IT(i,30)).add(s),r.add(IT(a.add(vT),18)).add(i),n)}(e,t);if(t<=64)return function(e,t=e.length){let n=vT.add(2*t),r=kT(e,0).mul(vT),a=kT(e,8),i=kT(e,t-8).mul(n),s=kT(e,t-16).mul(vT),o=IT(r.add(a),43).add(IT(i,30)).add(s),l=NT(o,r.add(IT(a.add(vT),18)).add(i),n),u=kT(e,16).mul(n),d=kT(e,24),c=o.add(kT(e,t-32)).mul(n),p=l.add(kT(e,t-24)).mul(n);return NT(IT(u.add(d),43).add(IT(c,30)).add(p),u.add(IT(d.add(r),18)).add(c),n)}(e,t);let r=n,a=n.mul(yT).add(113),i=xT(a.mul(vT).add(113)).mul(vT),s=[mT.UZERO,mT.UZERO],o=[mT.UZERO,mT.UZERO];r=r.mul(vT).add(kT(e,0));let l=0,u=64*(t-1>>6),d=u+(t-1&63)-63;do{r=IT(r.add(a).add(s[0]).add(kT(e,l+8)),37).mul(yT),a=IT(a.add(s[1]).add(kT(e,l+48)),42).mul(yT),r=r.xor(o[1]),a=a.add(s[0]).add(kT(e,l+40)),i=IT(i.add(o[0]),33).mul(yT),s=CT(e,l,s[1].mul(yT),r.add(o[0])),o=CT(e,l+32,i.add(o[1]),a.add(kT(e,l+16))),[i,r]=[r,i],l+=64}while(l!==u);let c=yT.add(i.and(255).shl(1));return l=d,o[0]=o[0].add(t-1&63),s[0]=s[0].add(o[0]),o[0]=o[0].add(s[0]),r=IT(r.add(a).add(s[0]).add(kT(e,l+8)),37).mul(c),a=IT(a.add(s[1]).add(kT(e,l+48)),42).mul(c),r=r.xor(o[1].mul(9)),a=a.add(s[0].mul(9).add(kT(e,l+40))),i=IT(i.add(o[0]),33).mul(c),s=CT(e,l,s[1].mul(c),r.add(o[0])),o=CT(e,l+32,i.add(o[1]),a.add(kT(e,l+16))),[i,r]=[r,i],NT(NT(s[0],o[0],c).add(xT(a).mul(bT)).add(i),NT(s[1],o[1],c).add(r),c)}function ET(e,t){return"string"===t?RT(e):_T([e],t)}function _T(e,t){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=MT(e)),$S().getBool("DEBUG")&&iS(e,t),function(e,t){return e instanceof Float32Array&&"float32"===t||e instanceof Int32Array&&"int32"===t||e instanceof Uint8Array&&"bool"===t}(e,t))return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){let t=new Uint8Array(e.length);for(let n=0;n<t.length;++n)0!==Math.round(e[n])&&(t[n]=1);return t}throw new Error(`Unknown data type ${t}`)}function $T(){return $S().platform.now()}function AT(e,t){return $S().platform.fetch(e,t)}function RT(e,t="utf-8"){return t=t||"utf-8",$S().platform.encode(e,t)}function DT(e,t="utf-8"){return t=t||"utf-8",$S().platform.decode(e,t)}function FT(e){return null!=$S().platform.isTypedArray?$S().platform.isTypedArray(e):hT(e)}function MT(e,t=[],n=!1){if(null==t&&(t=[]),"boolean"==typeof e||"number"==typeof e||"string"==typeof e||CS(e)||null==e||FT(e)&&n)t.push(e);else if(Array.isArray(e)||FT(e))for(let r=0;r<e.length;++r)MT(e[r],t,n);else{let r=-1;for(let t of Object.keys(e))/^([1-9]+[0-9]*|0)$/.test(t)&&(r=Math.max(r,Number(t)));for(let a=0;a<=r;a++)MT(e[a],t,n)}return t}function OT(e,t,n){if("float32"!==t)return!1;for(let r=0;r<e.length;r++){let t=e[r];if(isNaN(t)||!isFinite(t))return console.warn(`Found ${t} in the result of '${n}'`),!0}return!1}var PT=class{logKernelProfile(e,t,n,r,a,i){let s="number"==typeof r?Zk(`${r}ms`,9):r.error,o=Zk(e,25),l=t.rank,u=t.size,d=Zk(t.shape.toString(),14),c="";for(let p in a){let e=a[p];if(null!=e){let n=e.shape||t.shape,r=n.length;c+=`${p}: ${r}D ${r>0?n:""} `}}console.log(`%c${o}\t%c${s}\t%c${l}D ${d}\t%c${u}\t%c${c}\t%c${i}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}},LT=20,zT=3,BT=7;function WT(e,t,n,r){let a=gS(t),i=function(e,t,n,r){let a=jk(t),i=r[r.length-1],s=new Array(i).fill(0),o=t.length,l="complex64"===n?HT(e):e;if(o>1)for(let u=0;u<a/i;u++){let e=u*i;for(let t=0;t<i;t++)s[t]=Math.max(s[t],VT(l[e+t],0,n).length)}return s}(e,t,n,a),s=t.length,o=jT(e,t,n,a,i),l=["Tensor"];return r&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${s}`),l.push(`  shape: [${t}]`),l.push("  values:")),l.push(o.map((e=>"    "+e)).join("\n")),l.join("\n")}function VT(e,t,n){let r;return r=Array.isArray(e)?`${parseFloat(e[0].toFixed(BT))} + ${parseFloat(e[1].toFixed(BT))}j`:dS(e)?`'${e}'`:"bool"===n?UT(e):parseFloat(e.toFixed(BT)).toString(),Zk(r,t)}function UT(e){return 0===e?"false":"true"}function jT(e,t,n,r,a,i=!0){let s="complex64"===n?2:1,o=t[0],l=t.length;if(0===l)return"complex64"===n?[VT(HT(e)[0],0,n)]:"bool"===n?[UT(e[0])]:[e[0].toString()];if(1===l){if(o>LT){let t=zT*s,r=Array.from(e.slice(0,t)),i=Array.from(e.slice((o-zT)*s,o*s));return"complex64"===n&&(r=HT(r),i=HT(i)),["["+r.map(((e,t)=>VT(e,a[t],n))).join(", ")+", ..., "+i.map(((e,t)=>VT(e,a[o-zT+t],n))).join(", ")+"]"]}return["["+("complex64"===n?HT(e):Array.from(e)).map(((e,t)=>VT(e,a[t],n))).join(", ")+"]"]}let u=t.slice(1),d=r.slice(1),c=r[0]*s,p=[];if(o>LT){for(let t=0;t<zT;t++){let r=t*c,i=r+c;p.push(...jT(e.slice(r,i),u,n,d,a,!1))}p.push("...");for(let t=o-zT;t<o;t++){let r=t*c,i=r+c;p.push(...jT(e.slice(r,i),u,n,d,a,t===o-1))}}else for(let m=0;m<o;m++){let t=m*c,r=t+c;p.push(...jT(e.slice(t,r),u,n,d,a,m===o-1))}let h=2===l?",":"";p[0]="["+(o>0?p[0]+h:"");for(let m=1;m<p.length-1;m++)p[m]=" "+p[m]+h;let f=",\n";for(let m=2;m<l;m++)f+="\n";return p[p.length-1]=" "+p[p.length-1]+"]"+(i?"":f),p}function HT(e){let t=[];for(let n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var GT=class{constructor(e,t,n){if(this.dtype=t,this.shape=e.slice(),this.size=jk(e),null!=n){let e=n.length;Wk(e===this.size,(()=>`Length of values '${e}' does not match the size inferred by the shape '${this.size}'.`))}if("complex64"===t)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||aS(t,this.size),this.strides=gS(e)}set(e,...t){0===t.length&&(t=[0]),Wk(t.length===this.rank,(()=>`The number of provided coordinates (${t.length}) must match the rank (${this.rank})`));let n=this.locToIndex(t);this.values[n]=e}get(...e){0===e.length&&(e=[0]);let t=0;for(let r of e){if(r<0||r>=this.shape[t]){let t=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(t)}t++}let n=e[e.length-1];for(let r=0;r<e.length-1;++r)n+=this.strides[r]*e[r];return this.values[n]}locToIndex(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];let t=e[e.length-1];for(let n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t}indexToLoc(e){if(0===this.rank)return[];if(1===this.rank)return[e];let t=new Array(this.shape.length);for(let n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return qT().makeTensor(this.values,this.shape,this.dtype)}},qT=null,KT=null,XT=class{constructor(e,t,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=jk(e),this.strides=gS(e),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){let e=await this.data();return KT.buffer(this.shape,this.dtype,e)}bufferSync(){return KT.buffer(this.shape,this.dtype,this.dataSync())}async array(){let e=await this.data();return yS(this.shape,e,"complex64"===this.dtype)}arraySync(){return yS(this.shape,this.dataSync(),"complex64"===this.dtype)}async data(){this.throwIfDisposed();let e=qT().read(this.dataId);if("string"===this.dtype){let t=await e;try{return t.map((e=>DT(e)))}catch(_p){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),qT().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();let e=qT().readSync(this.dataId);if("string"===this.dtype)try{return e.map((e=>DT(e)))}catch(Dp){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();let e=await qT().read(this.dataId);return"string"===this.dtype?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(qT().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return KT.print(this,e)}clone(){return this.throwIfDisposed(),KT.clone(this)}toString(e=!1){return WT(this.dataSync(),this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),KT.cast(this,e)}variable(e=!0,t,n){return this.throwIfDisposed(),qT().makeVariable(this,e,t,n)}};function YT(){return FS("Tensor",(()=>XT))}Object.defineProperty(XT,Symbol.hasInstance,{value:e=>!!e&&null!=e.data&&null!=e.dataSync&&null!=e.throwIfDisposed}),YT();var JT=class extends XT{constructor(e,t,n,r){super(e.shape,e.dtype,e.dataId,r),this.trainable=t,this.name=n}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!qk(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);qT().disposeTensor(this),this.dataId=e.dataId,qT().incRef(this,null)}dispose(){qT().disposeVariable(this),this.isDisposedInternal=!0}};Object.defineProperty(JT,Symbol.hasInstance,{value:e=>e instanceof XT&&null!=e.assign&&e.assign instanceof Function});var ZT,QT,eE,tE,nE,rE={};ok(rE,{assertTypesMatch:()=>dE,getTensorsInContainer:()=>pE,isTensorInList:()=>cE,makeTypesMatch:()=>uE}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(ZT||(ZT={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(QT||(QT={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(eE||(eE={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(tE||(tE={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(nE||(nE={}));var aE={float32:tE,int32:QT,bool:eE,complex64:nE};function iE(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw new Error(`Can not upcast ${e} with ${t}`)}return aE[e][t]}function sE(e){return iE(e,"int32")}function oE(e){return null!=e&&"object"==typeof e&&"texture"in e&&e.texture instanceof WebGLTexture}function lE(e){return"undefined"!=typeof GPUBuffer&&null!=e&&"object"==typeof e&&"buffer"in e&&e.buffer instanceof GPUBuffer}function uE(e,t){if(e.dtype===t.dtype)return[e,t];let n=iE(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function dE(e,t){Wk(e.dtype===t.dtype,(()=>`The dtypes of the first(${e.dtype}) and second(${t.dtype}) input must match`))}function cE(e,t){return t.some((t=>t.id===e.id))}function pE(e){let t=[];return hE(e,t,new Set),t}function hE(e,t,n){if(null==e)return;if(e instanceof XT)return void t.push(e);if(!function(e){return Array.isArray(e)||"object"==typeof e}(e))return;let r=e;for(let a in r){let e=r[a];n.has(e)||(n.add(e),hE(e,t,n))}}function fE(e){return null!=e.kernelName}var mE=class{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map((e=>e.name))))}}}dispose(){for(let e in this.registeredVariables)this.registeredVariables[e].dispose()}},gE=class{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new mE}async ready(){if(null!=this.pendingBackendInit)return this.pendingBackendInit.then((()=>{}));if(null!=this.backendInstance)return;let e=this.getSortedBackends();for(let t=0;t<e.length;t++){let n=e[t];if(await this.initializeBackend(n).success)return void(await this.setBackend(n))}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(null!=this.pendingBackendInit)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(null==this.backendInstance){let{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;{let{asyncInit:t}=this.initializeBackend(e);if(t)return null}}return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t,n=1){return e in this.registryFactory?(QC(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:t,priority:n},!0)}async setBackend(e){if(null==this.registryFactory[e])throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,null==this.registry[e]){this.backendInstance=null;let{success:t,asyncInit:n}=this.initializeBackend(e);if(!(n?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new class{constructor(e,t){this.backendTimer=e,this.logger=t,null==t&&(this.logger=new PT)}profileKernel(e,t,n){let r,a,i=()=>{r=n()},s=$T();if(this.backendTimer.timerAvailable())a=this.backendTimer.time(i);else{i();for(let e of r)e.dataSync();a=Promise.resolve({kernelMs:$T()-s})}if($S().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let o=0;o<r.length;o++){let t=r[o];t.data().then((n=>{OT(n,t.dtype,e)}))}return{kernelName:e,outputs:r,inputs:t,timeMs:a.then((e=>e.kernelMs)),extraInfo:a.then((e=>null!=e.getExtraProfileInfo?e.getExtraProfileInfo():""))}}logKernelProfile(e){let{kernelName:t,outputs:n,timeMs:r,inputs:a,extraInfo:i}=e;n.forEach((e=>{Promise.all([e.data(),r,i]).then((n=>{this.logger.logKernelProfile(t,e,n[0],n[1],a,n[2])}))}))}}(this.backendInstance),!0}setupRegisteredKernels(){iT(this.backendName).forEach((e=>{null!=e.setupFunc&&e.setupFunc(this.backendInstance)}))}disposeRegisteredKernels(e){iT(e).forEach((t=>{null!=t.disposeFunc&&t.disposeFunc(this.registry[e])}))}initializeBackend(e){let t=this.registryFactory[e];if(null==t)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{let n=t.factory();if(!n||n instanceof Ak||"function"!=typeof n.then)return this.registry[e]=n,{success:!0,asyncInit:!1};{let t=++this.pendingBackendInitId,r=n.then((n=>!(t<this.pendingBackendInitId||(this.registry[e]=n,this.pendingBackendInit=null,0)))).catch((n=>(t<this.pendingBackendInitId||(this.pendingBackendInit=null,QC(`Initialization of backend ${e} failed`),QC(n.stack||n.message)),!1)));return this.pendingBackendInit=r,{success:r,asyncInit:!0}}}catch(_p){return QC(`Initialization of backend ${e} failed`),QC(_p.stack||_p.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority))}initializeBackendsAndReturnBest(){let e=this.getSortedBackends();for(let t=0;t<e.length;t++){let n=e[t],{success:r,asyncInit:a}=this.initializeBackend(n);if(a||r)return{name:n,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){let n=this.state.tensorInfo.get(t),r=n.backend,a=this.readSync(t),i=r.refCount(t);r.disposeData(t,!0),n.backend=e,e.move(t,a,n.shape,n.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let n,r=null;if(null==t){if("function"!=typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!=typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}return this.scopedRun((()=>this.startScope(r)),(()=>this.endScope(n)),(()=>(n=t(),n instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n)))}scopedRun(e,t,n){e();try{let e=n();return t(),e}catch(ut){throw t(),ut}}nextTensorId(){return gE.nextTensorId++}nextVariableId(){return gE.nextVariableId++}clone(e){let t=yE.runKernel(JI,{x:e}),n={x:e};return this.addTapeNode(this.state.activeScope.name,n,[t],(e=>({x:()=>{let t={x:e},n={dtype:"float32"};return yE.runKernel(iI,t,n)}})),[],{}),t}runKernel(e,t,n){if(null==this.backendName&&this.backend,null==rT(e,this.backendName))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:t,attrs:n})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,n){let r=this.backend.numDataIds(),a=0;n.forEach((e=>{a+="complex64"===e.dtype?3:1}));let i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],s=r-t-a-i;if(s>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${s} data ids) after running '${e}'`)}runKernelFunc(e){let t,n,r=[],a=this.isTapeOn(),i=this.state.numBytes,s=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;let o,l=fE(e)?e.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(fE(e)){let{kernelName:t,inputs:i,attrs:s}=e;null==this.backendName&&this.backend;let l=rT(t,this.backendName);Wk(null!=l,(()=>`Cannot find registered kernel '${t}' for backend '${this.backendName}'`)),n=()=>{let e=this.backend.numDataIds();o=l.kernelFunc({inputs:i,attrs:s,backend:this.backend});let n=Array.isArray(o)?o:[o];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(t,e,n);let u=n.map((e=>null!=e.rank?e:this.makeTensorFromTensorInfo(e)));if(a){let e=this.getTensorsForGradient(t,i,u);r=this.saveTensorsForBackwardMode(e)}return u}}else{let{forwardFunc:t}=e,i=e=>{a&&(r=e.map((e=>this.keep(this.clone(e)))))};n=()=>{let e=this.backend.numDataIds();o=this.tidy((()=>t(this.backend,i)));let n=Array.isArray(o)?o:[o];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(l,e,n),n}}let u,{inputs:d,attrs:c}=e,p=fE(e)?null:e.backwardsFunc;return this.scopedRun((()=>this.state.kernelDepth++),(()=>this.state.kernelDepth--),(()=>{this.ENV.getBool("DEBUG")||this.state.profiling?(u=this.profiler.profileKernel(l,d,(()=>n())),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(u),t=u.outputs):t=n()})),a&&this.addTapeNode(l,d,t,p,r,c),this.state.profiling&&this.state.activeProfile.kernels.push({name:l,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-s,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(d).map((e=>null!=d[e]?d[e].shape:null)),outputShapes:t.map((e=>e.shape)),kernelTimeMs:u.timeMs,extraInfo:u.extraInfo}),Array.isArray(o)?t:t[0]}saveTensorsForBackwardMode(e){return e.map((e=>this.keep(this.clone(e))))}getTensorsForGradient(e,t,n){let r=aT(e);if(null!=r){let e,a=r.inputsToSave||[],i=r.outputsToSave||[];r.saveAllInputs?(Wk(Array.isArray(t),(()=>"saveAllInputs is true, expected inputs to be an array.")),e=Object.keys(t).map((e=>t[e]))):e=a.map((e=>t[e]));let s=n.filter(((e,t)=>i[t]));return e.concat(s)}return[]}makeTensor(e,t,n,r){if(null==e)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;let a=e;"string"===n&&dS(e[0])&&(a=e.map((e=>RT(e))));let i=r.write(a,t,n),s=new XT(t,n,i,this.nextTensorId());if(this.trackTensor(s,r),"string"===n){let e=this.state.tensorInfo.get(i),t=uS(a);this.state.numBytes+=t-e.bytes,e.bytes=t}return s}makeTensorFromDataId(e,t,n,r){let a={dataId:e,shape:t,dtype:n=n||"float32"};return this.makeTensorFromTensorInfo(a,r)}makeTensorFromTensorInfo(e,t){let{dataId:n,shape:r,dtype:a}=e,i=new XT(r,a,n,this.nextTensorId());return this.trackTensor(i,t),i}makeVariable(e,t=!0,n,r){n=n||this.nextVariableId().toString(),null!=r&&r!==e.dtype&&(e=e.cast(r));let a=new JT(e,t,n,this.nextTensorId());if(null!=this.state.registeredVariables[a.name])throw new Error(`Variable with name ${a.name} was already registered`);return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}trackTensor(e,t){this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++;let n=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(n=e.size*lS(e.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:n})),e instanceof JT||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;let t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,"string"===e.dtype&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),"complex64"!==e.dtype&&"string"!==e.dtype){let t=e.size*lS(e.dtype);this.state.numBytes-=t}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(let e in this.state.registeredVariables){let t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]}memory(){let e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;let t=this.state.numBytes,n=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map((e=>e.totalBytesSnapshot))),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-n;for(let r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}addTapeNode(e,t,n,r,a,i){let s={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:a},o=aT(e);null!=o&&(r=o.gradFunc),null!=r&&(s.gradient=e=>(e=e.map(((e,t)=>{if(null==e){let e=n[t],r=wS(e.size,e.dtype);return this.makeTensor(r,e.shape,e.dtype)}return e})),r(e.length>1?e:e[0],a,i))),this.state.activeTape.push(s)}keep(e){return e.kept=!0,e}startTape(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){let t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){let t=pE(e),n=new Set(t.map((e=>e.id)));for(let a=0;a<this.state.activeScope.track.length;a++){let e=this.state.activeScope.track[a];!e.kept&&!n.has(e.id)&&e.dispose()}let r=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach((e=>{!e.kept&&e.scopeId===r.id&&this.track(e)}))}gradients(e,t,n,r=!1){if(Wk(t.length>0,(()=>"gradients() received an empty list of xs.")),null!=n&&"float32"!==n.dtype)throw new Error(`dy must have 'float32' dtype, but has '${n.dtype}'`);let a=this.scopedRun((()=>this.startTape()),(()=>this.endTape()),(()=>this.tidy("forward",e)));Wk(a instanceof XT,(()=>"The result y returned by f() must be a tensor."));let i=function(e,t,n){let r={},a={};for(let l=0;l<t.length;l++)r[t[l].id]=!0;for(let l=0;l<e.length;l++){let n=e[l],i=n.inputs;for(let e in i){let s=i[e],o=!1;for(let e=0;e<t.length;e++)if(r[s.id]){n.outputs.forEach((e=>r[e.id]=!0)),o=!0,a[n.id]=!0;break}if(o)break}}let i={};i[n.id]=!0;let s={};for(let l=e.length-1;l>=0;l--){let t=e[l],n=t.inputs;for(let e=0;e<t.outputs.length;e++)if(i[t.outputs[e].id]){for(let e in n)i[n[e].id]=!0,s[t.id]=!0;break}}let o=[];for(let l=0;l<e.length;l++){let t=e[l];if(a[t.id]&&s[t.id]){let e={};for(let a in t.inputs){let n=t.inputs[a];r[n.id]&&(e[a]=n)}let n=Object.assign({},t);n.inputs=e,n.outputs=t.outputs,o.push(n)}}return o}(this.state.activeTape,t,a);if(!r&&0===i.length&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(()=>{let e={};e[a.id]=null==n?function(e){let t=xS(jk(e),"float32");return yE.makeTensor(t,e,"float32")}(a.shape):n,function(e,t,n,r){for(let a=t.length-1;a>=0;a--){let i=t[a],s=[];if(i.outputs.forEach((t=>{let n=e[t.id];null!=n?s.push(n):s.push(null)})),null==i.gradient)throw new Error(`Cannot compute gradient: gradient function not found for ${i.kernelName}.`);let o=i.gradient(s);for(let t in i.inputs){if(!(t in o))throw new Error(`Cannot backprop through input ${t}. Available gradients found: ${Object.keys(o)}.`);let a=n((()=>o[t]()));if("float32"!==a.dtype)throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input ${t} must have 'float32' dtype, but has '${a.dtype}'`);let s=i.inputs[t];if(!qk(a.shape,s.shape))throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input '${t}' has shape '${a.shape}', which does not match the shape of the input '${s.shape}'`);if(null==e[s.id])e[s.id]=a;else{let t=e[s.id];e[s.id]=r(t,a),t.dispose()}}}}(e,i,(e=>this.tidy(e)),vE);let r=t.map((t=>e[t.id]));return 0===this.state.gradientDepth&&(this.state.activeTape.forEach((e=>{for(let t of e.saved)t.dispose()})),this.state.activeTape=null),{value:a,grads:r}}))}customGrad(e){return Wk(fS(e),(()=>"The f passed in customGrad(f) must be a function.")),(...t)=>{Wk(t.every((e=>e instanceof XT)),(()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors"));let n,r={};return t.forEach(((e,t)=>{r[t]=e})),this.runKernelFunc({forwardFunc:(r,a)=>(n=e(...t,a),Wk(n.value instanceof XT,(()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor")),Wk(fS(n.gradFunc),(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function.")),n.value),backwardsFunc:(e,r)=>{let a=n.gradFunc(e,r),i=Array.isArray(a)?a:[a];Wk(i.length===t.length,(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...).")),Wk(i.every((e=>e instanceof XT)),(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."));let s={};return i.forEach(((e,t)=>{s[t]=()=>e})),s},inputs:r})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}async time(e){let t=$T(),n=await this.backend.time(e);return n.wallMs=$T()-t,n}track(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new mE;for(let e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}};function bE(){let e=DS();if(null==e._tfengine){let t=new ES(e);e._tfengine=new gE(t)}return function(e){RS=e}(e._tfengine.ENV),function(e){qT=e}((()=>e._tfengine)),e._tfengine}gE.nextTensorId=0,gE.nextVariableId=0;var yE=bE();function vE(e,t){let n={a:e,b:t};return yE.runKernel(LS,n)}var xE,wE={};function kE(e){xE=e}function SE(e){if(void 0!==xE)return xE;if(e||"undefined"!=typeof navigator&&null!=navigator){if(e||(e=navigator),"ReactNative"===e.product)return!0;let t=e.userAgent||e.vendor||("undefined"!=typeof window?window.opera:"");if(!t){let t=e;return t.userAgentData&&t.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function IE(){return"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope}ok(wE,{isBrowser:()=>IE,isMobile:()=>SE,mockIsMobile:()=>kE});var NE=$S();function CE(e,t){let n=e;if(FT(e))return"string"===t?[]:[e.length];if(oE(e)){let t=e.channels||"RGBA";return[e.height,e.width*t.length]}if(lE(e))return[e.buffer.size/(null==t?4:lS(t))];if(!Array.isArray(e))return[];let r=[];for(;Array.isArray(n)||FT(n)&&"string"!==t;)r.push(n.length),n=n[0];return Array.isArray(e)&&$S().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&TE(e,r,[]),r}function TE(e,t,n){if(n=n||[],!Array.isArray(e)&&!FT(e))return void Wk(0===t.length,(()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${t[0]} elements`));Wk(t.length>0,(()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${e.length} elements`)),Wk(e.length===t[0],(()=>`Element arr[${n.join("][")}] should have ${t[0]} elements, but has ${e.length} elements`));let r=t.slice(1);for(let a=0;a<e.length;++a)TE(e[a],r,n.concat(a))}function EE(e,t,n,r){if("string_or_numeric"!==e){if(null==e)throw new Error("Expected dtype cannot be null.");if("numeric"!==e&&e!==t||"numeric"===e&&"string"===t)throw new Error(`Argument '${n}' passed to '${r}' must be ${e} tensor, but got ${t} tensor`)}}function _E(e,t,n,r="numeric"){if(e instanceof XT)return EE(r,e.dtype,t,n),e;let a=hS(e);if("string"!==a&&["bool","int32","float32"].indexOf(r)>=0&&(a=r),EE(r,a,t,n),null==e||!FT(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e){let r=null==e?"null":e.constructor.name;throw new Error(`Argument '${t}' passed to '${n}' must be a Tensor or TensorLike, but got '${r}'`)}let i=CE(e,a);!FT(e)&&!Array.isArray(e)&&(e=[e]);let s="string"!==a?_T(e,a):MT(e,[],!0);return yE.makeTensor(s,i,a)}function $E(e,t,n,r="numeric"){if(!Array.isArray(e))throw new Error(`Argument ${t} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return e.map(((e,a)=>_E(e,`${t}[${a}]`,n,r)))}NE.registerFlag("DEBUG",(()=>!1),(e=>{e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),NE.registerFlag("IS_BROWSER",(()=>IE())),NE.registerFlag("IS_NODE",(()=>"undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node)),NE.registerFlag("IS_CHROME",(()=>"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor))),NE.registerFlag("IS_SAFARI",(()=>"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor))),NE.registerFlag("PROD",(()=>!1)),NE.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(()=>NE.getBool("DEBUG"))),NE.registerFlag("DEPRECATION_WARNINGS_ENABLED",(()=>!0)),NE.registerFlag("IS_TEST",(()=>!1)),NE.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",(()=>NE.getBool("DEBUG"))),NE.registerFlag("WRAP_TO_IMAGEBITMAP",(()=>!1)),NE.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",(()=>!1)),NE.registerFlag("USE_SETTIMEOUTCUSTOM",(()=>!1));var AE="__op";function RE(e){let t=Object.keys(e);if(1!==t.length)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${t.length} keys.`);let n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+=AE;let a=(...e)=>{yE.startScope(n);try{let t=r(...e);return CS(t)&&console.error("Cannot return a Promise inside of tidy."),yE.endScope(t),t}catch(t){throw yE.endScope(null),t}};return Object.defineProperty(a,"name",{value:n,configurable:!0}),a}var DE=RE({complex_:function(e,t){let n=_E(e,"real","complex"),r=_E(t,"imag","complex");Vk(n.shape,r.shape,`real and imag shapes, ${n.shape} and ${r.shape}, must match in call to tf.complex().`);let a={real:n,imag:r};return yE.runKernel(lI,a)}});function FE(e,t,n,r){if(null==r)r=hS(e);else if("complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(lE(e)||oE(e)){if("float32"!==r&&"int32"!==r)throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return yE.backend.createTensorFromGPUData(e,t||n,r)}if(!FT(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){SS(t);let e=jk(t),r=jk(n);Wk(e===r,(()=>`Based on the provided shape, [${t}], the tensor should have ${e} values but has ${r}`));for(let a=0;a<n.length;++a){let e=n[a],r=a!==n.length-1||e!==jk(t.slice(a));Wk(n[a]===t[a]||!r,(()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${t}). `))}}return!FT(e)&&!Array.isArray(e)&&(e=[e]),t=t||n,e="string"!==r?_T(e,r):MT(e,[],!0),yE.makeTensor(e,t,r)}function ME(e,t,n){return FE(e,t,CE(e,n),n)}var OE={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8},PE=class{static join(e){return new PE(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,null==e||(e instanceof Array||(e=[e]),e=e.map((e=>FT(e)?e.buffer:e)),0===e.length))return;this.bufferUniformSize=e[0].byteLength;let t=0;for(let n=0;n<e.length;n++){let r=e[n];n!==e.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);let a=t+r.byteLength;this.shards.push({buffer:r,start:t,end:a}),t=a}0===this.shards.length&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,t=this.byteLength){if(0===this.shards.length)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,t=isNaN(Number(t))?0:t,e=Math.max(0,e),(t=Math.min(this.byteLength,t))<=e)return new ArrayBuffer(0);let n=this.findShardForByte(e);if(-1===n)throw new Error(`Could not find start shard for byte ${e}`);let r=new ArrayBuffer(t-e),a=new Uint8Array(r),i=0;for(let s=n;s<this.shards.length;s++){let n=this.shards[s],r=e+i-n.start,o=i,l=Math.min(t,n.end)-n.start,u=new Uint8Array(n.buffer,r,l-r);if(a.set(u,o),i+=u.length,t<n.end)break}return r}findShardForByte(e){if(0===this.shards.length||e<0||e>=this.byteLength)return-1;if(null!=this.bufferUniformSize)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function t(t){return e<t.start?-1:e>=t.end?1:0}if(0===t(this.shards[this.previousShardIndex]))return this.previousShardIndex;let n=function(e,t){let n=0,r=e.length;for(;n<=r;){let a=Math.floor((r-n)/2)+n,i=t(e[a]);if(0===i)return a;i<0?r=a:n=a+1}return-1}(this.shards,t);return-1===n?-1:(this.previousShardIndex=n,this.previousShardIndex)}},LE=4;async function zE(e,t){let n=[],r=[],a=Array.isArray(e)?e.map((e=>e.name)):Object.keys(e);for(let i=0;i<a.length;++i){let s=a[i],o=Array.isArray(e)?e[i].tensor:e[s];if("float32"!==o.dtype&&"int32"!==o.dtype&&"bool"!==o.dtype&&"string"!==o.dtype&&"complex64"!==o.dtype)throw new Error(`Unsupported dtype in weight '${s}': ${o.dtype}`);let l={name:s,shape:o.shape,dtype:o.dtype};if("string"===o.dtype){let e=new Promise((async e=>{let t=await o.bytes(),n=t.reduce(((e,t)=>e+t.length),0)+LE*t.length,r=new Uint8Array(n),a=0;for(let i=0;i<t.length;i++){let e=t[i],n=new Uint8Array(new Uint32Array([e.length]).buffer);r.set(n,a),a+=LE,r.set(e,a),a+=e.length}e(r)}));r.push(e)}else r.push(o.data());null!=t&&(l.group=t),n.push(l)}return{data:WE(await Promise.all(r)),specs:n}}function BE(e,t){let n,r=new PE(e),a={},i=0;for(let s of t){let e,t=s.name,o=s.dtype,l=s.shape,u=jk(l);if("quantization"in s){let a=s.quantization;if("uint8"===a.dtype||"uint16"===a.dtype){if(!("min"in a)||!("scale"in a))throw new Error(`Weight ${s.name} with quantization ${a.dtype} doesn't have corresponding metadata min and scale.`)}else{if("float16"!==a.dtype)throw new Error(`Weight ${s.name} has unknown quantization dtype ${a.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);if("float32"!==o)throw new Error(`Weight ${s.name} is quantized with ${a.dtype} which only supports weights of type float32 not ${o}.`)}let l=OE[a.dtype],d=r.slice(i,i+u*l),c="uint8"===a.dtype?new Uint8Array(d):new Uint16Array(d);if("float32"===o)if("uint8"===a.dtype||"uint16"===a.dtype){e=new Float32Array(c.length);for(let t=0;t<c.length;t++){let n=c[t];e[t]=n*a.scale+a.min}}else{if("float16"!==a.dtype)throw new Error(`Unsupported quantization type ${a.dtype} for weight type float32.`);void 0===n&&(n=JE()),e=n(c)}else{if("int32"!==o)throw new Error(`Unsupported dtype in weight '${t}': ${o}`);if("uint8"!==a.dtype&&"uint16"!==a.dtype)throw new Error(`Unsupported quantization type ${a.dtype} for weight type int32.`);e=new Int32Array(c.length);for(let t=0;t<c.length;t++){let n=c[t];e[t]=Math.round(n*a.scale+a.min)}}i+=u*l}else if("string"===o){let t=jk(s.shape);e=[];for(let n=0;n<t;n++){let t=new Uint32Array(r.slice(i,i+LE))[0];i+=LE;let n=new Uint8Array(r.slice(i,i+t));e.push(n),i+=t}}else{let n=OE[o],s=r.slice(i,i+u*n);if("float32"===o)e=new Float32Array(s);else if("int32"===o)e=new Int32Array(s);else if("bool"===o)e=new Uint8Array(s);else{if("complex64"!==o)throw new Error(`Unsupported dtype in weight '${t}': ${o}`);{e=new Float32Array(s);let n=new Float32Array(e.length/2),r=new Float32Array(e.length/2);for(let t=0;t<n.length;t++)n[t]=e[2*t],r[t]=e[2*t+1];let i=ME(n,l,"float32"),o=ME(r,l,"float32");a[t]=DE(i,o),i.dispose(),o.dispose()}}i+=u*n}"complex64"!==o&&(a[t]=ME(e,l,o))}return a}function WE(e){if(null===e)throw new Error(`Invalid input value: ${JSON.stringify(e)}`);let t=0,n=[];e.forEach((e=>{if(t+=e.byteLength,n.push(e.byteLength===e.buffer.byteLength?e:new e.constructor(e)),!(e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${e.constructor.name}`)}));let r=new Uint8Array(t),a=0;return n.forEach((e=>{r.set(new Uint8Array(e.buffer),a),a+=e.byteLength})),r.buffer}var VE="undefined"!=typeof Buffer&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function UE(e){return VE?Buffer.byteLength(e,"utf8"):new Blob([e]).size}function jE(e){return PE.join(e)}function HE(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);let t=e.split("/");return t[t.length-1]}function GE(e,t){let n={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:t};return null!=e.signature&&(n.signature=e.signature),null!=e.userDefinedMetadata&&(n.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(n.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(n.initializerSignature=e.initializerSignature),null!=e.trainingConfig&&(n.trainingConfig=e.trainingConfig),n}function qE(e,t,n){let r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy};if(null!=e.trainingConfig&&(r.trainingConfig=e.trainingConfig),null!=e.weightsManifest){if(!t)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=t,r.weightData=n}return null!=e.signature&&(r.signature=e.signature),null!=e.userDefinedMetadata&&(r.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(r.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(r.initializerSignature=e.initializerSignature),r}async function KE(e,t){let n,r;return null!=e.weightsManifest&&([n,r]=await t(e.weightsManifest)),qE(e,n,r)}function XE(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:UE(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:UE(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:new PE(e.weightData).byteLength}}function YE(e){let t=[];for(let n of e)t.push(...n.weights);return t}function JE(){let e=function(){let e=e=>{let t=e<<13,n=0;for(;!(8388608&t);)n-=8388608,t<<=1;return t&=-8388609,n+=947912704,t|n},t=new Uint32Array(2048);t[0]=0;for(let n=1;n<1024;n++)t[n]=e(n);for(let n=1024;n<2048;n++)t[n]=939524096+(n-1024<<13);return t}(),t=function(){let e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(let t=1;t<31;t++)e[t]=t<<23;for(let t=33;t<63;t++)e[t]=2147483648+(t-32<<23);return e}(),n=function(){let e=new Uint32Array(64);for(let t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}();return r=>{let a=new ArrayBuffer(4*r.length),i=new Uint32Array(a);for(let s=0;s<r.length;s++){let a=r[s],o=e[n[a>>10]+(1023&a)]+t[a>>10];i[s]=o}return new Float32Array(a)}}var ZE=class{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return null==ZE.instance&&(ZE.instance=new ZE),ZE.instance}static registerSaveRouter(e){ZE.getInstance().saveRouters.push(e)}static registerLoadRouter(e){ZE.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return ZE.getHandlers(e,"save")}static getLoadHandlers(e,t){return ZE.getHandlers(e,"load",t)}static getHandlers(e,t,n){let r=[];return("load"===t?ZE.getInstance().loadRouters:ZE.getInstance().saveRouters).forEach((t=>{let a=t(e,n);null!==a&&r.push(a)})),r}},QE=e=>ZE.registerSaveRouter(e),e_=e=>ZE.registerLoadRouter(e),t_=e=>ZE.getSaveHandlers(e),n_=(e,t)=>ZE.getLoadHandlers(e,t),r_="tensorflowjs",a_="models_store",i_="model_info_store";function s_(){if(!$S().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");let e="undefined"==typeof window?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function o_(e){let t=e.result;t.createObjectStore(a_,{keyPath:"modelPath"}),t.createObjectStore(i_,{keyPath:"modelPath"})}var l_=class{constructor(e){if(this.indexedDB=s_(),null==e||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise(((e,n)=>{let r=this.indexedDB.open(r_,1);r.onupgradeneeded=()=>o_(r),r.onsuccess=()=>{let a=r.result;if(null==t){let t=a.transaction(a_,"readonly"),r=t.objectStore(a_).get(this.modelPath);r.onsuccess=()=>{if(null==r.result)return a.close(),n(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));e(r.result.modelArtifacts)},r.onerror=e=>(a.close(),n(r.error)),t.oncomplete=()=>a.close()}else{t.weightData=PE.join(t.weightData);let r,i,s=XE(t),o=a.transaction(i_,"readwrite"),l=o.objectStore(i_);try{r=l.put({modelPath:this.modelPath,modelArtifactsInfo:s})}catch(wp){return n(wp)}r.onsuccess=()=>{i=a.transaction(a_,"readwrite");let r,u=i.objectStore(a_);try{r=u.put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:s})}catch(pv){return n(pv)}r.onsuccess=()=>e({modelArtifactsInfo:s}),r.onerror=e=>{l=o.objectStore(i_);let t=l.delete(this.modelPath);t.onsuccess=()=>(a.close(),n(r.error)),t.onerror=e=>(a.close(),n(r.error))}},r.onerror=e=>(a.close(),n(r.error)),o.oncomplete=()=>{null==i?a.close():i.oncomplete=()=>a.close()}}},r.onerror=e=>n(r.error)}))}};l_.URL_SCHEME="indexeddb://";var u_=e=>$S().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(l_.URL_SCHEME)?function(e){return new l_(e)}(e.slice(l_.URL_SCHEME.length)):null;ZE.registerSaveRouter(u_),ZE.registerLoadRouter(u_);var d_="/",c_="tensorflowjs_models",p_="info",h_="model_topology",f_="weight_specs",m_="weight_data",g_="model_metadata";function b_(e){return{info:[c_,e,p_].join(d_),topology:[c_,e,h_].join(d_),weightSpecs:[c_,e,f_].join(d_),weightData:[c_,e,m_].join(d_),modelMetadata:[c_,e,g_].join(d_)}}function y_(e){for(let t of Object.values(e))window.localStorage.removeItem(t)}function v_(e){let t=e.split(d_);if(t.length<3)throw new Error(`Invalid key format: ${e}`);return t.slice(1,t.length-1).join(d_)}var x_=class{constructor(e){if(!$S().getBool("IS_BROWSER")||"undefined"==typeof window||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==e||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=b_(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{let n=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),a=XE(e),i=PE.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,function(e){if(VE)return Buffer.from(e).toString("base64");let t=new Uint8Array(e),n="";for(let r=0,a=t.length;r<a;r++)n+=String.fromCharCode(t[r]);return btoa(n)}(i));let t={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:null!=e.signature?e.signature:void 0,userDefinedMetadata:null!=e.userDefinedMetadata?e.userDefinedMetadata:void 0,modelInitializer:null!=e.modelInitializer?e.modelInitializer:void 0,initializerSignature:null!=e.initializerSignature?e.initializerSignature:void 0,trainingConfig:null!=e.trainingConfig?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(t)),{modelArtifactsInfo:a}}catch(t){throw y_(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${a.modelTopologyBytes}, weightSpecsBytes=${a.weightSpecsBytes}, weightDataBytes=${a.weightDataBytes}.`)}}}async load(){let e=JSON.parse(this.LS.getItem(this.keys.info));if(null==e)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if("JSON"!==e.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");let t={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(null==n)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);t.modelTopology=n;let r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(null==r)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);t.weightSpecs=r;let a=this.LS.getItem(this.keys.modelMetadata);if(null!=a){let e=JSON.parse(a);t.format=e.format,t.generatedBy=e.generatedBy,t.convertedBy=e.convertedBy,null!=e.signature&&(t.signature=e.signature),null!=e.userDefinedMetadata&&(t.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(t.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(t.initializerSignature=e.initializerSignature),null!=e.trainingConfig&&(t.trainingConfig=e.trainingConfig)}let i=this.LS.getItem(this.keys.weightData);if(null==i)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return t.weightData=function(e){if(VE){let t=Buffer.from(e,"base64");return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}let t=atob(e),n=new Uint8Array(t.length);for(let r=0;r<t.length;++r)n.set([t.charCodeAt(r)],r);return n.buffer}(i),t}};x_.URL_SCHEME="localstorage://";var w_=e=>$S().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(x_.URL_SCHEME)?function(e){return new x_(e)}(e.slice(x_.URL_SCHEME.length)):null;ZE.registerSaveRouter(w_),ZE.registerLoadRouter(w_);var k_="://",S_=class{constructor(){this.managers={}}static getInstance(){return null==S_.instance&&(S_.instance=new S_),S_.instance}static registerManager(e,t){Wk(null!=e,(()=>"scheme must not be undefined or null.")),e.endsWith(k_)&&(e=e.slice(0,e.indexOf(k_))),Wk(e.length>0,(()=>"scheme must not be an empty string."));let n=S_.getInstance();Wk(null==n.managers[e],(()=>`A model store manager is already registered for scheme '${e}'.`)),n.managers[e]=t}static getManager(e){let t=S_.getInstance().managers[e];if(null==t)throw new Error(`Cannot find model manager for scheme '${e}'`);return t}static getSchemes(){return Object.keys(S_.getInstance().managers)}};function I_(e){if(-1===e.indexOf(k_))throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${S_.getSchemes().join(",")}`);return{scheme:e.split(k_)[0],path:e.split(k_)[1]}}async function N_(e,t,n=!1){Wk(e!==t,(()=>`Old path and new path are the same: '${e}'`));let r=ZE.getLoadHandlers(e);Wk(r.length>0,(()=>`Copying failed because no load handler is found for source URL ${e}.`)),Wk(r.length<2,(()=>`Copying failed because more than one (${r.length}) load handlers for source URL ${e}.`));let a=r[0],i=ZE.getSaveHandlers(t);Wk(i.length>0,(()=>`Copying failed because no save handler is found for destination URL ${t}.`)),Wk(i.length<2,(()=>`Copying failed because more than one (${r.length}) save handlers for destination URL ${t}.`));let s=i[0],o=I_(e).scheme,l=I_(e).path,u=o===I_(e).scheme,d=await a.load();n&&u&&await S_.getManager(o).removeModel(l);let c=await s.save(d);return n&&!u&&await S_.getManager(o).removeModel(l),c.modelArtifactsInfo}async function C_(){let e=S_.getSchemes(),t={};for(let n of e){let e=await S_.getManager(n).listModels();for(let r in e)t[n+k_+r]=e[r]}return t}async function T_(e){let t=I_(e);return S_.getManager(t.scheme).removeModel(t.path)}async function E_(e,t){return N_(e,t,!1)}async function __(e,t){return N_(e,t,!0)}if($S().get("IS_BROWSER")){$S().setPlatform("browser",new class{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error(`Browser's encoder only supports utf-8, but got ${t}`);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){"undefined"!=typeof window&&$S().getBool("USE_SETTIMEOUTCUSTOM")?(this.functionRefs.push(e),setTimeout((()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")}),t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",(e=>{e.source===window&&e.data.name===this.messageName&&(e.stopPropagation(),(0,this.functionRefs[e.data.index])(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0))}),!0))):setTimeout(e,t)}isTypedArray(e){return hT(e)}});try{S_.registerManager(x_.URL_SCHEME,new class{constructor(){Wk($S().getBool("IS_BROWSER"),(()=>"Current environment is not a web browser")),Wk("undefined"==typeof window||void 0!==window.localStorage,(()=>"Current browser does not appear to support localStorage")),this.LS=window.localStorage}async listModels(){let e={},t=c_+d_,n=d_+p_;for(let r=0;r<this.LS.length;++r){let a=this.LS.key(r);a.startsWith(t)&&a.endsWith(n)&&(e[v_(a)]=JSON.parse(this.LS.getItem(a)))}return e}async removeModel(e){let t=b_(e=function(e){return e.startsWith(x_.URL_SCHEME)?e.slice(x_.URL_SCHEME.length):e}(e));if(null==this.LS.getItem(t.info))throw new Error(`Cannot find model at path '${e}'`);let n=JSON.parse(this.LS.getItem(t.info));return y_(t),n}})}catch(kp){}try{S_.registerManager(l_.URL_SCHEME,new class{constructor(){this.indexedDB=s_()}async listModels(){return new Promise(((e,t)=>{let n=this.indexedDB.open(r_,1);n.onupgradeneeded=()=>o_(n),n.onsuccess=()=>{let r=n.result,a=r.transaction(i_,"readonly"),i=a.objectStore(i_).getAll();i.onsuccess=()=>{let t={};for(let e of i.result)t[e.modelPath]=e.modelArtifactsInfo;e(t)},i.onerror=e=>(r.close(),t(i.error)),a.oncomplete=()=>r.close()},n.onerror=e=>t(n.error)}))}async removeModel(e){return e=function(e){return e.startsWith(l_.URL_SCHEME)?e.slice(l_.URL_SCHEME.length):e}(e),new Promise(((t,n)=>{let r=this.indexedDB.open(r_,1);r.onupgradeneeded=()=>o_(r),r.onsuccess=()=>{let a,i=r.result,s=i.transaction(i_,"readwrite"),o=s.objectStore(i_),l=o.get(e);l.onsuccess=()=>{if(null==l.result)return i.close(),n(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{let r=o.delete(e),s=()=>{a=i.transaction(a_,"readwrite");let r=a.objectStore(a_).delete(e);r.onsuccess=()=>t(l.result.modelArtifactsInfo),r.onerror=e=>n(l.error)};r.onsuccess=s,r.onerror=e=>(s(),i.close(),n(l.error))}},l.onerror=e=>(i.close(),n(l.error)),s.oncomplete=()=>{null==a?i.close():a.oncomplete=()=>i.close()}},r.onerror=e=>n(r.error)}))}})}catch(kp){}}var $_,A_=()=>dk();function R_(e,t="float32",n){return t=t||"float32",SS(e),new GT(e,t,n)}$S().get("IS_NODE")&&!$S().get("IS_BROWSER")&&$S().setPlatform("node",new class{constructor(){this.util=ck(),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return null!=$S().global.fetch?$S().global.fetch(e,t):(null==$_&&($_=A_()),$_(e,t))}now(){let e=process.hrtime();return 1e3*e[0]+e[1]/1e6}encode(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error(`Node built-in encoder only supports utf-8, but got ${t}`);return this.textEncoder.encode(e)}decode(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}});var D_=RE({cast_:function(e,t){let n=_E(e,"x","cast");if(!sS(t))throw new Error(`Failed to cast to unknown dtype ${t}`);if("string"===t&&"string"!==n.dtype||"string"!==t&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");let r={x:n},a={dtype:t};return yE.runKernel(iI,r,a)}}),F_=RE({clone_:function(e){let t={x:_E(e,"x","clone","string_or_numeric")};return yE.runKernel(JI,t)}});function M_(e,t=!1){console.log(e.toString(t))}function O_(){$S().set("PROD",!0)}function P_(){$S().set("DEBUG",!0)}function L_(){$S().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function z_(e){$S().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function B_(){yE.disposeVariables()}function W_(){return yE}function V_(){return yE.memory()}function U_(e){return yE.profile(e)}function j_(e,t){return yE.tidy(e,t)}function H_(e){pE(e).forEach((e=>e.dispose()))}function G_(e){return yE.keep(e)}function q_(e){return yE.time(e)}function K_(e){return yE.setBackend(e)}function X_(){return yE.ready()}function Y_(){return yE.backendName}function J_(e){yE.removeBackend(e)}function Z_(e){return yE.findBackend(e)}function Q_(e){return yE.findBackendFactory(e)}function e$(e,t,n=1){return yE.registerBackend(e,t,n)}function t$(){return yE.backend}function n$(e,t){$S().setPlatform(e,t)}bE(),function(e){KT=e}({buffer:R_,cast:D_,clone:F_,print:M_});var r$=RE({add_:function(e,t){let n=_E(e,"a","add"),r=_E(t,"b","add");[n,r]=uE(n,r);let a={a:n,b:r};return yE.runKernel(LS,a)}}),a$=RE({floorDiv_:function(e,t){let n=_E(e,"a","floorDiv"),r=_E(t,"b","floorDiv");[n,r]=uE(n,r);let a={a:n,b:r};return yE.runKernel(HI,a)}}),i$=RE({div_:function(e,t){let n=_E(e,"a","div"),r=_E(t,"b","div");if([n,r]=uE(n,r),"int32"===n.dtype&&"int32"===r.dtype)return a$(n,r);let a={a:n,b:r};return yE.runKernel(RI,a,{})}}),s$=RE({mul_:function(e,t){let n=_E(e,"a","mul"),r=_E(t,"b","mul");[n,r]=uE(n,r);let a={a:n,b:r};return yE.runKernel(AN,a)}}),o$=RE({abs_:function(e){let t=_E(e,"x","abs");if("complex64"===t.dtype){let e={x:t};return yE.runKernel(uI,e)}{let e={x:t};return yE.runKernel(MS,e)}}}),l$=RE({acos_:function(e){let t={x:_E(e,"x","acos")};return yE.runKernel(OS,t)}}),u$=RE({acosh_:function(e){let t={x:_E(e,"x","acosh")};return yE.runKernel(PS,t)}}),d$=RE({addN_:function(e){Wk(Array.isArray(e),(()=>"The argument passed to tf.addN() must be a list of tensors")),Wk(e.length>=1,(()=>`Must pass at least one tensor to tf.addN(), but got ${e.length}`));let t=e.map(((e,t)=>_E(e,`tensors${t}`,"addN"))),n=t[0];t.forEach((e=>{if(e.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),t.forEach((e=>{if(!qk(e.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));let r=t;return yE.runKernel(zS,r)}}),c$=RE({all_:function(e,t=null,n=!1){let r={x:_E(e,"x","all","bool")},a={axis:t,keepDims:n};return yE.runKernel(BS,r,a)}}),p$=RE({any_:function(e,t=null,n=!1){let r={x:_E(e,"x","any","bool")},a={axis:t,keepDims:n};return yE.runKernel(WS,r,a)}}),h$=RE({argMax_:function(e,t=0){let n={x:_E(e,"x","argMax")},r={axis:t};return yE.runKernel(VS,n,r)}}),f$=RE({argMin_:function(e,t=0){let n={x:_E(e,"x","argMin")},r={axis:t};return yE.runKernel(US,n,r)}}),m$=RE({asin_:function(e){let t={x:_E(e,"x","asin")};return yE.runKernel(jS,t)}}),g$=RE({asinh_:function(e){let t={x:_E(e,"x","asinh")};return yE.runKernel(HS,t)}}),b$=RE({atan_:function(e){let t={x:_E(e,"x","atan")};return yE.runKernel(GS,t)}}),y$=RE({atan2_:function(e,t){let n=_E(e,"a","atan2"),r=_E(t,"b","atan2");[n,r]=uE(n,r);let a={a:n,b:r};return yE.runKernel(KS,a)}}),v$=RE({atanh_:function(e){let t={x:_E(e,"x","atanh")};return yE.runKernel(qS,t)}});function x$(e,t,n,r,a="NHWC",i){return S$(e,[...t,e[3]],n,i,r,null,null,D$(a))}function w$(e,t,n,r,a,i,s="channelsLast"){let o,[l,u]=C$(t);if("channelsLast"===s)o=[l,u,e[3],e[3]];else{if("channelsFirst"!==s)throw new Error(`Unknown dataFormat ${s}`);o=[l,u,e[1],e[1]]}return S$(e,o,n,r,a,i,!1,s)}function k$(e,t,n,r,a,i,s="NDHWC"){let o,l,[u,d,c]=T$(t);if("NDHWC"===s)l="channelsLast",o=[u,d,c,e[4],e[4]];else{if("NCDHW"!==s)throw new Error(`Unknown dataFormat ${s}`);l="channelsFirst",o=[u,d,c,e[1],e[1]]}return I$(e,o,n,r,a,!1,l,i)}function S$(e,t,n,r,a,i,s=!1,o="channelsLast"){let[l,u,d,c]=[-1,-1,-1,-1];if("channelsLast"===o)[l,u,d,c]=e;else{if("channelsFirst"!==o)throw new Error(`Unknown dataFormat ${o}`);[l,c,u,d]=e}let p,[h,f,,m]=t,[g,b]=C$(n),[y,v]=C$(r),x=E$(h,y),w=E$(f,v),{padInfo:k,outHeight:S,outWidth:I}=function(e,t,n,r,a,i,s,o,l){let u,d,c;if("number"==typeof e){u={top:e,bottom:e,left:e,right:e,type:0===e?"VALID":"NUMBER"};let a=function(e,t,n,r,a){null==r&&(r=N$(e,t,n));let i=e[0],s=e[1],o=_$((i-t+2*r)/n+1,a),l=_$((s-t+2*r)/n+1,a);return[o,l]}([t,n],i,r,e,o);d=a[0],c=a[1]}else if("same"===e){d=Math.ceil(t/r),c=Math.ceil(n/a);let e=Math.max(0,(d-1)*r+i-t),o=Math.max(0,(c-1)*a+s-n),l=Math.floor(e/2),p=e-l,h=Math.floor(o/2);u={top:l,bottom:p,left:h,right:o-h,type:"SAME"}}else if("valid"===e)u={top:0,bottom:0,left:0,right:0,type:"VALID"},d=Math.ceil((t-i+1)/r),c=Math.ceil((n-s+1)/a);else{if("object"!=typeof e)throw Error(`Unknown padding parameter: ${e}`);{let p="channelsLast"===l?e[1][0]:e[2][0],h="channelsLast"===l?e[1][1]:e[2][1],f="channelsLast"===l?e[2][0]:e[3][0],m="channelsLast"===l?e[2][1]:e[3][1];u={top:p,bottom:h,left:f,right:m,type:0===p&&0===h&&0===f&&0===m?"VALID":"EXPLICIT"},d=_$((t-i+p+h)/r+1,o),c=_$((n-s+f+m)/a+1,o)}}return{padInfo:u,outHeight:d,outWidth:c}}(a,u,d,g,b,x,w,i,o),N=s?m*c:m;return"channelsFirst"===o?p=[l,N,S,I]:"channelsLast"===o&&(p=[l,S,I,N]),{batchSize:l,dataFormat:o,inHeight:u,inWidth:d,inChannels:c,outHeight:S,outWidth:I,outChannels:N,padInfo:k,strideHeight:g,strideWidth:b,filterHeight:h,filterWidth:f,effectiveFilterHeight:x,effectiveFilterWidth:w,dilationHeight:y,dilationWidth:v,inShape:e,outShape:p,filterShape:t}}function I$(e,t,n,r,a,i=!1,s="channelsLast",o){let[l,u,d,c,p]=[-1,-1,-1,-1,-1];if("channelsLast"===s)[l,u,d,c,p]=e;else{if("channelsFirst"!==s)throw new Error(`Unknown dataFormat ${s}`);[l,p,u,d,c]=e}let h,[f,m,g,,b]=t,[y,v,x]=T$(n),[w,k,S]=T$(r),I=E$(f,w),N=E$(m,k),C=E$(g,S),{padInfo:T,outDepth:E,outHeight:_,outWidth:$}=function(e,t,n,r,a,i,s,o,l,u,d){let c,p,h,f;if("valid"===e&&(e=0),"number"==typeof e){c={top:e,bottom:e,left:e,right:e,front:e,back:e,type:0===e?"VALID":"NUMBER"};let m=function(e,t,n,r,a,i){null==a&&(a=N$(e,t[0],r[0]));let s=[0,0,0,n];for(let o=0;o<3;o++)e[o]+2*a>=t[o]&&(s[o]=_$((e[o]-t[o]+2*a)/r[o]+1,i));return s}([t,n,r,1],[o,l,u],1,[a,i,s],e,d);p=m[0],h=m[1],f=m[2]}else{if("same"!==e)throw Error(`Unknown padding parameter: ${e}`);{p=Math.ceil(t/a),h=Math.ceil(n/i),f=Math.ceil(r/s);let e=(p-1)*a+o-t,d=(h-1)*i+l-n,m=(f-1)*s+u-r,g=Math.floor(e/2),b=e-g,y=Math.floor(d/2),v=d-y,x=Math.floor(m/2);c={top:y,bottom:v,left:x,right:m-x,front:g,back:b,type:"SAME"}}}return{padInfo:c,outDepth:p,outHeight:h,outWidth:f}}(a,u,d,c,y,v,x,I,N,C,o),A=i?b*p:b;return"channelsFirst"===s?h=[l,A,E,_,$]:"channelsLast"===s&&(h=[l,E,_,$,A]),{batchSize:l,dataFormat:s,inDepth:u,inHeight:d,inWidth:c,inChannels:p,outDepth:E,outHeight:_,outWidth:$,outChannels:A,padInfo:T,strideDepth:y,strideHeight:v,strideWidth:x,filterDepth:f,filterHeight:m,filterWidth:g,effectiveFilterDepth:I,effectiveFilterHeight:N,effectiveFilterWidth:C,dilationDepth:w,dilationHeight:k,dilationWidth:S,inShape:e,outShape:h,filterShape:t}}function N$(e,t,n,r=1){let a=E$(t,r);return Math.floor((e[0]*(n-1)-n+a)/2)}function C$(e){return"number"==typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function T$(e){return"number"==typeof e?[e,e,e]:e}function E$(e,t){return t<=1?e:e+(e-1)*(t-1)}function _$(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error(`Unknown roundingMode ${t}`)}}function $$(e){let[t,n,r]=C$(e);return 1===t&&1===n&&1===r}function A$(e,t){return $$(e)||$$(t)}function R$(e){return C$(e).every((e=>e>0))}function D$(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw new Error(`Unknown dataFormat ${e}`)}function F$(e,t,n){if(null!=n){if("string"==typeof t)throw Error(`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`);if("number"==typeof t)Wk(Kk(t),(()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`));else{if("object"!=typeof t)throw Error(`Error in ${e}: Unknown padding parameter: ${t}`);t.forEach((t=>{t.forEach((t=>{Wk(Kk(t),(()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`))}))}))}}}var M$=RE({reshape_:function(e,t){let n={x:_E(e,"x","reshape","string_or_numeric")},r={shape:t};return yE.runKernel(ZN,n,r)}}),O$=RE({avgPool_:function(e,t,n,r,a){let i=_E(e,"x","avgPool","float32");Wk(A$(n,1),(()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '1'`));let s=i,o=!1;3===i.rank&&(o=!0,s=M$(i,[1,i.shape[0],i.shape[1],i.shape[2]])),Wk(4===s.rank,(()=>`Error in avgPool: x must be rank 4 but got rank ${s.rank}.`)),F$("avgPool",r,a);let l={x:s},u={filterSize:t,strides:n,pad:r,dimRoundingMode:a},d=yE.runKernel(XS,l,u);return d=D_(d,i.dtype),o?M$(d,[d.shape[1],d.shape[2],d.shape[3]]):d}}),P$=RE({avgPool3d_:function(e,t,n,r,a,i="NDHWC"){let s=_E(e,"x","avgPool3d","float32"),o=s,l=!1;4===s.rank&&(l=!0,o=M$(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),Wk(5===o.rank,(()=>`Error in avgPool3d: x must be rank 5 but got rank ${o.rank}.`)),Wk("NDHWC"===i,(()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`)),Wk("number"==typeof n&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,(()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`)),F$("avgPool3d",r,a);let u={x:o},d={filterSize:t,strides:n,pad:r,dimRoundingMode:a,dataFormat:i},c=yE.runKernel(JS,u,d);return c=D_(c,o.dtype),l?M$(c,[c.shape[1],c.shape[2],c.shape[3],c.shape[4]]):c}}),L$=RE({concat_:function(e,t=0){Wk(e.length>=1,(()=>"Pass at least one tensor to concat"));let n=$E(e,"tensors","concat","string_or_numeric");if("complex64"===n[0].dtype&&n.forEach((e=>{if("complex64"!==e.dtype)throw new Error(`Cannot concatenate complex64 tensors with a tensor\n          with dtype ${e.dtype}. `)})),1===n.length)return F_(n[0]);let r=n,a={axis:t};return yE.runKernel(dI,r,a)}}),z$=RE({matMul_:function(e,t,n=!1,r=!1){let a=_E(e,"a","matMul"),i=_E(t,"b","matMul");[a,i]=uE(a,i);let s={a:a,b:i},o={transposeA:n,transposeB:r};return yE.runKernel(QS,s,o)}}),B$=RE({sigmoid_:function(e){let t={x:_E(e,"x","sigmoid","float32")};return yE.runKernel(gC,t)}}),W$=RE({slice_:function(e,t,n){let r=_E(e,"x","slice","string_or_numeric");if(0===r.rank)throw new Error("Slicing scalar is not possible");let a={x:r},i={begin:t,size:n};return yE.runKernel(pC,a,i)}}),V$=RE({tanh_:function(e){let t={x:_E(e,"x","tanh","float32")};return yE.runKernel(PC,t)}}),U$=RE({basicLSTMCell_:function(e,t,n,r,a,i){let s=_E(e,"forgetBias","basicLSTMCell"),o=_E(t,"lstmKernel","basicLSTMCell"),l=_E(n,"lstmBias","basicLSTMCell"),u=_E(r,"data","basicLSTMCell"),d=_E(a,"c","basicLSTMCell"),c=_E(i,"h","basicLSTMCell"),p=L$([u,c],1),h=z$(p,o),f=r$(h,l),m=f.shape[0],g=f.shape[1]/4,b=[m,g],y=W$(f,[0,0],b),v=W$(f,[0,g],b),x=W$(f,[0,2*g],b),w=W$(f,[0,3*g],b),k=r$(s$(B$(y),V$(v)),s$(d,B$(r$(s,x))));return[k,s$(V$(k),B$(w))]}}),j$=RE({batchToSpaceND_:function(e,t,n){let r=_E(e,"x","batchToSpaceND"),a=t.reduce(((e,t)=>e*t));Wk(r.rank>=1+t.length,(()=>`input rank is ${r.rank} but should be > than blockShape.length ${t.length}`)),Wk(n.length===t.length,(()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${t.length}`)),Wk(r.shape[0]%a==0,(()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${t.join(" * ")} === ${a}`));let i={x:r},s={blockShape:t,crops:n};return yE.runKernel(eI,i,s)}});function H$(e){let t;return t=0===e.rank||1===e.rank?M$(e,[1,1,1,e.size]):2===e.rank?M$(e,[1,1,e.shape[0],e.shape[1]]):3===e.rank?M$(e,[1,e.shape[0],e.shape[1],e.shape[2]]):e,t}var G$=RE({batchNorm_:function(e,t,n,r,a,i){null==i&&(i=.001);let s,o,l=_E(e,"x","batchNorm"),u=_E(t,"mean","batchNorm"),d=_E(n,"variance","batchNorm");null!=a&&(s=_E(a,"scale","batchNorm")),null!=r&&(o=_E(r,"offset","batchNorm")),Wk(u.rank===d.rank,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),Wk(null==o||u.rank===o.rank,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),Wk(null==s||u.rank===s.rank,(()=>"Batch normalization gradient requires mean and scale to have equal ranks."));let c={x:H$(l),scale:s,offset:o,mean:u,variance:d},p={varianceEpsilon:i},h=yE.runKernel(GI,c,p);return M$(h,l.shape)}}),q$=RE({batchNorm2d_:function(e,t,n,r,a,i){let s,o,l=_E(e,"x","batchNorm"),u=_E(t,"mean","batchNorm"),d=_E(n,"variance","batchNorm");return null!=a&&(s=_E(a,"scale","batchNorm")),null!=r&&(o=_E(r,"offset","batchNorm")),Wk(2===l.rank,(()=>`Error in batchNorm2D: x must be rank 2 but got rank ${l.rank}.`)),Wk(2===u.rank||1===u.rank,(()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${u.rank}.`)),Wk(2===d.rank||1===d.rank,(()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${d.rank}.`)),null!=s&&Wk(2===s.rank||1===s.rank,(()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${s.rank}.`)),null!=o&&Wk(2===o.rank||1===o.rank,(()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${o.rank}.`)),G$(l,u,d,o,s,i)}}),K$=RE({batchNorm3d_:function(e,t,n,r,a,i){let s,o,l=_E(e,"x","batchNorm"),u=_E(t,"mean","batchNorm"),d=_E(n,"variance","batchNorm");return null!=a&&(s=_E(a,"scale","batchNorm")),null!=r&&(o=_E(r,"offset","batchNorm")),Wk(3===l.rank,(()=>`Error in batchNorm3D: x must be rank 3 but got rank ${l.rank}.`)),Wk(3===u.rank||1===u.rank,(()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${u.rank}.`)),Wk(3===d.rank||1===d.rank,(()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${d.rank}.`)),null!=s&&Wk(3===s.rank||1===s.rank,(()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${s.rank}.`)),null!=o&&Wk(3===o.rank||1===o.rank,(()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${o.rank}.`)),G$(l,u,d,o,s,i)}}),X$=RE({batchNorm4d_:function(e,t,n,r,a,i){let s,o,l=_E(e,"x","batchNorm"),u=_E(t,"mean","batchNorm"),d=_E(n,"variance","batchNorm");return null!=a&&(s=_E(a,"scale","batchNorm")),null!=r&&(o=_E(r,"offset","batchNorm")),Wk(4===l.rank,(()=>`Error in batchNorm4D: x must be rank 4 but got rank ${l.rank}.`)),Wk(4===u.rank||1===u.rank,(()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${u.rank}.`)),Wk(4===d.rank||1===d.rank,(()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${d.rank}.`)),null!=s&&Wk(4===s.rank||1===s.rank,(()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${s.rank}.`)),null!=o&&Wk(4===o.rank||1===o.rank,(()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${o.rank}.`)),G$(l,u,d,o,s,i)}}),Y$=RE({bincount_:function(e,t,n){let r=_E(e,"x","bincount"),a=_E(t,"weights","bincount");Wk("int32"===r.dtype,(()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`)),Wk(n>=0,(()=>`size must be non-negative, but got ${n}.`)),Wk(a.size===r.size||0===a.size,(()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${a.shape}.`));let i={x:r,weights:a},s={size:n};return yE.runKernel(tI,i,s)}}),J$=RE({bitwiseAnd_:function(e,t){let n=_E(e,"x","bitwiseAnd"),r=_E(t,"y","bitwiseAnd");if(!qk(n.shape,r.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${n.shape}, y: ${r.shape}`);if("int32"!==n.dtype||"int32"!==r.dtype)throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${n.dtype} and type of y: ${r.dtype}`);let a={a:n,b:r};return yE.runKernel(nI,a)}}),Z$=RE({broadcastArgs_:function(e,t){let n=_E(e,"s0","broadcastArgs","int32"),r=_E(t,"s1","broadcastArgs","int32");if(1!==n.rank)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${n.rank}`);if(1!==r.rank)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${r.rank}`);let a={s0:n,s1:r};return yE.runKernel(aI,a)}}),Q$=RE({broadcastTo_:function(e,t){let n=_E(e,"broadcastTo","x"),r=n.shape;if(SS(t),t.length<n.rank)throw new Error(`broadcastTo(): shape.length=${t.length} < input.rank=${n.rank}.`);if(t.length>n.rank){let e=n.shape.slice();for(;e.length<t.length;)e.unshift(1);n=M$(n,e)}let a=n.shape,i=Array.from(t);for(let l=t.length-1;l>=0;l--)if(a[l]===t[l])i[l]=1;else if(1!==n.shape[l])throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${t}].`);if(0===i.map(((e,t)=>e>1?t:-1)).filter((e=>e>=0)).length)return F_(n);let s={x:n},o={reps:i};return yE.runKernel(LC,s,o)}}),eA=RE({ceil_:function(e){let t={x:_E(e,"x","ceil","float32")};return yE.runKernel(sI,t)}});function tA(e,t,n){SS(e);let r={shape:e,value:t,dtype:n=n||hS(t)};return yE.runKernel(VI,{},r)}var nA=RE({clipByValue_:function(e,t,n){let r=_E(e,"x","clipByValue");if(Wk(t<=n,(()=>`Error in clip: min (${t}) must be less than or equal to max (${n}).`)),t===n)return tA(r.shape,t,r.dtype);let a={x:r},i={clipValueMin:t,clipValueMax:n};return yE.runKernel(oI,a,i)}}),rA=RE({concat1d_:function(e){return L$(e,0)}}),aA=RE({concat2d_:function(e,t){return L$(e,t)}}),iA=RE({concat3d_:function(e,t){return L$(e,t)}}),sA=RE({concat4d_:function(e,t){return L$(e,t)}}),oA=RE({conv2d_:function(e,t,n,r,a="NHWC",i=[1,1],s){let o=_E(e,"x","conv2d","float32"),l=_E(t,"filter","conv2d","float32"),u=o,d=!1;3===o.rank&&(d=!0,u=M$(o,[1,o.shape[0],o.shape[1],o.shape[2]])),Wk(4===u.rank,(()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`)),Wk(4===l.rank,(()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`)),F$("conv2d",r,s);let c="NHWC"===a?u.shape[3]:u.shape[1];Wk(c===l.shape[2],(()=>`Error in conv2d: depth of input (${c}) must match input depth for filter ${l.shape[2]}.`)),Wk(A$(n,i),(()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`)),Wk(R$(i),(()=>"Error in conv2D: Dilated rates should be larger than 0.")),Wk(R$(n),(()=>"Error in conv2D: Strides should be larger than 0."));let p={x:u,filter:l},h={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:s},f=yE.runKernel(cI,p,h);return d?M$(f,[f.shape[1],f.shape[2],f.shape[3]]):f}}),lA=RE({conv1d_:function(e,t,n,r,a="NWC",i=1,s){let o=_E(e,"x","conv1d"),l=_E(t,"filter","conv1d"),u=o,d=!1;2===o.rank&&(d=!0,u=M$(o,[1,o.shape[0],o.shape[1]])),Wk(3===u.rank,(()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`)),Wk(3===l.rank,(()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`)),F$("conv1d",r,s),Wk(u.shape[2]===l.shape[1],(()=>`Error in conv1d: depth of input (${u.shape[2]}) must match input depth for filter ${l.shape[1]}.`)),Wk(A$(n,i),(()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${i}'`)),Wk(R$(i),(()=>"Error in conv1D: Dilated rates should be larger than 0.")),Wk(R$(n),(()=>"Error in conv1D: Stride should be larger than 0.")),Wk("NWC"===a,(()=>`Error in conv1d: got dataFormat of ${a} but only NWC is currently supported.`));let c=M$(l,[1,l.shape[0],l.shape[1],l.shape[2]]),p=M$(u,[u.shape[0],1,u.shape[1],u.shape[2]]),h=oA(p,c,[1,n],r,"NHWC",[1,i],s);return M$(h,d?[h.shape[2],h.shape[3]]:[h.shape[0],h.shape[2],h.shape[3]])}}),uA=RE({conv2DBackpropInput_:function(e,t,n,r,a,i="NHWC",s){Wk(e.length===t.rank,(()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`));let o=e,l=t,u=!1;3===t.rank&&(u=!0,l=M$(t,[1,t.shape[0],t.shape[1],t.shape[2]]),o=[1,e[0],e[1],e[2]]),Wk(4===o.length,(()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${o.length}.`)),Wk(4===l.rank,(()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`)),Wk(4===n.rank,(()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`));let d="NHWC"===i?o[3]:o[1],c="NHWC"===i?l.shape[3]:l.shape[1];Wk(d===n.shape[2],(()=>`Error in conv2dDerInput: depth of input (${d}) must match input depth for filter ${n.shape[2]}.`)),Wk(c===n.shape[3],(()=>`Error in conv2dDerInput: depth of output (${c}) must match output depth for filter ${n.shape[3]}.`)),F$("conv2dDerInput",a,s);let p={dy:l,filter:n},h={strides:r,pad:a,dataFormat:i,dimRoundingMode:s,inputShape:o},f=yE.runKernel(hI,p,h);return u?M$(f,[f.shape[1],f.shape[2],f.shape[3]]):f}}),dA=RE({conv2dTranspose_:function(e,t,n,r,a,i){let s=_E(e,"x","conv2dTranspose"),o=_E(t,"filter","conv2dTranspose");return uA(n,s,o,r,a,"NHWC",i)}}),cA=RE({conv3d_:function(e,t,n,r,a="NDHWC",i=[1,1,1]){let s=_E(e,"x","conv3d"),o=_E(t,"filter","conv3d"),l=s,u=!1;4===s.rank&&(u=!0,l=M$(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),Wk(5===l.rank,(()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`)),Wk(5===o.rank,(()=>`Error in conv3d: filter must be rank 5, but got rank ${o.rank}.`)),Wk(l.shape[4]===o.shape[3],(()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${o.shape[3]}.`)),Wk(A$(n,i),(()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`)),Wk("NDHWC"===a,(()=>`Error in conv3d: got dataFormat of ${a} but only NDHWC is currently supported.`)),Wk(R$(i),(()=>"Error in conv3D: Dilated rates should be larger than 0.")),Wk(R$(n),(()=>"Error in conv3D: Strides should be larger than 0."));let d={x:l,filter:o},c={strides:n,pad:r,dataFormat:a,dilations:i},p=yE.runKernel(fI,d,c);return u?M$(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}}),pA=RE({conv3DBackpropInput_:function(e,t,n,r,a){Wk(e.length===t.rank,(()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`));let i=e,s=t,o=!1;4===t.rank&&(o=!0,s=M$(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),i=[1,e[0],e[1],e[2],e[3]]);let l=i[4],u=s.shape[4];Wk(5===i.length,(()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${i.length}.`)),Wk(5===s.rank,(()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${s.rank}`)),Wk(5===n.rank,(()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`)),Wk(l===n.shape[3],(()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`)),Wk(u===n.shape[4],(()=>`Error in conv3dDerInput: depth of output (${u}) must match output depth for filter ${n.shape[4]}.`));let d={dy:s,filter:n},c={pad:a,strides:r,inputShape:i},p=yE.runKernel(gI,d,c);return o?M$(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}}),hA=RE({conv3dTranspose_:function(e,t,n,r,a){let i=_E(e,"x","conv3dTranspose"),s=_E(t,"filter","conv3dTranspose");return pA(n,i,s,r,a)}}),fA=RE({cos_:function(e){let t={x:_E(e,"x","cos","float32")};return yE.runKernel(bI,t)}}),mA=RE({cosh_:function(e){let t={x:_E(e,"x","cosh","float32")};return yE.runKernel(yI,t)}}),gA=RE({cumprod_:function(e,t=0,n=!1,r=!1){let a={x:_E(e,"x","cumprod")},i={axis:t,exclusive:n,reverse:r};return yE.runKernel(vI,a,i)}}),bA=RE({cumsum_:function(e,t=0,n=!1,r=!1){let a={x:_E(e,"x","cumsum")},i={axis:t,exclusive:n,reverse:r};return yE.runKernel(xI,a,i)}}),yA=RE({denseBincount_:function(e,t,n,r=!1){let a=_E(e,"x","denseBincount"),i=_E(t,"weights","denseBincount");Wk("int32"===a.dtype,(()=>`Error in denseBincount: input dtype must be int32, but got ${a.dtype}`)),Wk(a.rank<=2,(()=>`Error in denseBincount: input must be at most rank 2, but got rank ${a.rank}.`)),Wk(n>=0,(()=>`size must be non-negative, but got ${n}.`)),Wk(i.size===a.size||0===i.size,(()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${a.shape}, weights shape: ${i.shape}.`));let s={x:a,weights:i},o={size:n,binaryOutput:r};return yE.runKernel(kI,s,o)}}),vA=RE({depthToSpace_:function(e,t,n="NHWC"){let r=_E(e,"x","depthToSpace","float32"),a="NHWC"===n?r.shape[1]:r.shape[2],i="NHWC"===n?r.shape[2]:r.shape[3],s="NHWC"===n?r.shape[3]:r.shape[1];Wk(t>1,(()=>`blockSize should be > 1 for depthToSpace, but was: ${t}`)),Wk(a*t>=0,(()=>`Negative dimension size caused by overflow when multiplying\n    ${a} and ${t}  for depthToSpace with input shape\n    ${r.shape}`)),Wk(i*t>=0,(()=>`Negative dimension size caused by overflow when multiplying\n    ${i} and ${t} for depthToSpace with input shape\n        ${r.shape}`)),Wk(s%(t*t)==0,(()=>`Dimension size must be evenly divisible by ${t*t} but is ${s} for depthToSpace with input shape ${r.shape}`));let o={x:r},l={blockSize:t,dataFormat:n};return yE.runKernel(SI,o,l)}}),xA=RE({depthwiseConv2d_:function(e,t,n,r,a="NHWC",i=[1,1],s){let o=_E(e,"x","depthwiseConv2d","float32"),l=_E(t,"filter","depthwiseConv2d","float32"),u=o,d=!1;3===o.rank&&(d=!0,u=M$(o,[1,o.shape[0],o.shape[1],o.shape[2]])),Wk(4===u.rank,(()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${u.rank}.`)),Wk(4===l.rank,(()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`));let c="NHWC"===a?u.shape[3]:u.shape[1];Wk(c===l.shape[2],(()=>`Error in depthwiseConv2d: number of input channels (${c}) must match the inChannels dimension in filter ${l.shape[2]}.`)),F$("depthwiseConv2d",r,s);let p={x:u,filter:l},h={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:s},f=yE.runKernel(II,p,h);return d?M$(f,[f.shape[1],f.shape[2],f.shape[3]]):f}}),wA=RE({diag_:function(e){let t={x:_E(e,"x","diag")};return yE.runKernel(TI,t)}}),kA=RE({dilation2d_:function(e,t,n,r,a=[1,1],i="NHWC"){let s=_E(e,"x","dilation2d"),o=_E(t,"filter","dilation2d");Wk(3===s.rank||4===s.rank,(()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${s.rank}.`)),Wk(3===o.rank,(()=>`Error in dilation2d: filter must be rank 3, but got rank ${o.rank}.`)),Wk("NHWC"===i,(()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${i}`));let l=s,u=!1;3===s.rank&&(l=M$(s,[1,s.shape[0],s.shape[1],s.shape[2]]),u=!0),Wk(l.shape[3]===o.shape[2],(()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${o.shape[2]}`));let d={x:l,filter:o},c={strides:n,pad:r,dilations:a},p=yE.runKernel(EI,d,c);return u?M$(p,[p.shape[1],p.shape[2],p.shape[3]]):p}}),SA={};function IA(e,t){let n=e.length,r=[];for(let a=0;a<n;a++){let i=n-1-a,s=e[i]||1;(t[t.length-1-a]||1)>1&&1===s&&r.unshift(i)}return r}function NA(e,t){let n=[];for(let r=0;r<t.length;r++){let a=e[e.length-r-1],i=t.length-r-1,s=t[i];(null==a||1===a&&s>1)&&n.unshift(i)}return n}function CA(e,t){let n=Math.max(e.length,t.length),r=new Array(n);for(let a=0;a<n;a++){let i=e[e.length-a-1];null==i&&(i=1);let s=t[t.length-a-1];if(null==s&&(s=1),1===i)r[n-a-1]=s;else if(1===s)r[n-a-1]=i;else{if(i!==s)throw Error(`Operands could not be broadcast together with shapes ${e} and ${t}.`);r[n-a-1]=i}}return r}ok(SA,{assertAndGetBroadcastShape:()=>CA,getBroadcastDims:()=>IA,getReductionAxes:()=>NA});var TA=RE({equal_:function(e,t){let n=_E(e,"a","equal","string_or_numeric"),r=_E(t,"b","equal","string_or_numeric");[n,r]=uE(n,r),CA(n.shape,r.shape);let a={a:n,b:r};return yE.runKernel(PI,a)}}),EA=RE({where_:function(e,t,n){let r=_E(t,"a","where"),a=_E(n,"b","where"),i=_E(e,"condition","where","bool"),s=CA(CA(i.shape,r.shape),a.shape),o={condition:Q$(i,s),t:Q$(r,s),e:Q$(a,s)};return yE.runKernel(dC,o)}}),_A=RE({zerosLike_:function(e){let t={x:_E(e,"x","zerosLike")};return yE.runKernel(GC,t)}}),$A=RE({divNoNan_:function(e,t){let n=_E(e,"a","div"),r=_E(t,"b","div");[n,r]=uE(n,r);let a=i$(n,r),i=_A(a),s=TA(r,i);return EA(s,i,a)}}),AA=RE({dot_:function(e,t){let n=_E(e,"t1","dot"),r=_E(t,"t2","dot");Wk(!(1!==n.rank&&2!==n.rank||1!==r.rank&&2!==r.rank),(()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${r.rank}.`));let a=1===n.rank?n.size:n.shape[1],i=1===r.rank?r.size:r.shape[0];if(Wk(a===i,(()=>`Error in dot: inner dimensions of inputs must match, but got ${a} and ${i}.`)),1===n.rank&&1===r.rank){let e=M$(n,[1,-1]),t=M$(r,[-1,1]),a=z$(e,t);return M$(a,[])}if(1===n.rank&&2===r.rank){let e=M$(n,[1,-1]),t=M$(r,[r.shape[0],r.shape[1]]),a=z$(e,t);return M$(a,[a.size])}if(2===n.rank&&1===r.rank){let e=M$(r,[-1,1]),t=z$(n,e);return M$(t,[t.size])}{let e=M$(r,[r.shape[0],r.shape[1]]);return z$(n,e)}}}),RA=RE({einsum_:function(e,...t){let n=t.map(((e,t)=>_E(e,`tensors${t}`,"einsum"))),r={equation:e};return yE.runKernel(DI,n,r)}}),DA=RE({elu_:function(e){let t={x:_E(e,"x","elu","float32")};return yE.runKernel(FI,t)}}),FA=RE({ensureShape_:function(e,t){let n=_E(e,"x","ensureShape","string_or_numeric");if(!Gk(n.shape,t))throw new Error(`EnsureShape: Shape of tensor ${n.shape} is not compatible with expected shape ${t}`);return e}}),MA=RE({erf_:function(e){let t=_E(e,"x","erf");Wk("int32"===t.dtype||"float32"===t.dtype,(()=>"Input dtype must be `int32` or `float32`.")),"int32"===t.dtype&&(t=D_(t,"float32"));let n={x:t};return yE.runKernel(OI,n)}});function OA(e,t){for(let n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function PA(e,t,n){let r=e.length+t.length,a=[],i=0,s=0;for(let o=0;o<r;o++)-1===n.indexOf(o)?a.push(e[i++]):a.push(t[s++]);return a}function LA(e,t){let n=[],r=e.length;for(let a=0;a<r;a++)-1===t.indexOf(a)&&n.push(e[a]);return[n,t.map((t=>e[t]))]}function zA(e,t){return PA(e,t.map((e=>1)),t)}function BA(e,t,n){Wk(OA(t,n),(()=>`${e} supports only inner-most axes for now. Got axes ${t} and rank-${n} input.`))}function WA(e,t){if(OA(e,t))return null;let n=[];for(let r=0;r<t;++r)-1===e.indexOf(r)&&n.push(r);return e.forEach((e=>n.push(e))),n}function VA(e){return e.map(((e,t)=>[t,e])).sort(((e,t)=>e[1]-t[1])).map((e=>e[0]))}function UA(e,t){let n=[];for(let r=t-e;r<t;++r)n.push(r);return n}var jA=RE({max_:function(e,t=null,n=!1){let r={x:_E(e,"x","max")},a={reductionIndices:t,keepDims:n};return yE.runKernel(yN,r,a)}}),HA=RE({min_:function(e,t=null,n=!1){let r={x:_E(e,"x","min")},a={axis:t,keepDims:n};return yE.runKernel(CN,r,a)}}),GA=RE({pow_:function(e,t){let n=_E(e,"base","pow"),r=_E(t,"exp","pow");[n,r]=uE(n,r);let a={a:n,b:r};return yE.runKernel(VN,a)}});function qA(e,t){if((FT(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&FT(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return FE(e,[],[],t)}var KA=RE({sqrt_:function(e){let t={x:_E(e,"x","sqrt","float32")};return yE.runKernel(yC,t)}}),XA=RE({square_:function(e){let t=_E(e,"x","square");return yE.runKernel("Square",{x:t},{})}}),YA=RE({sum_:function(e,t=null,n=!1){let r=_E(e,"x","sum");"bool"===r.dtype&&(r=D_(r,"int32"));let a={x:r},i={axis:t,keepDims:n};return yE.runKernel(vC,a,i)}});function JA(e,t,n=null){if(0===e.rank)return o$(e);if(1!==e.rank&&null===n)return JA(M$(e,[-1]),t,n);if(1===e.rank||"number"==typeof n||Array.isArray(n)&&1===n.length){if(1===t)return YA(o$(e),n);if(t===1/0)return jA(o$(e),n);if(t===-1/0)return HA(o$(e),n);if("euclidean"===t||2===t)return KA(YA(GA(o$(e),qA(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}if(Array.isArray(n)&&2===n.length){if(1===t)return jA(YA(o$(e),n[0]),n[1]-1);if(t===1/0)return jA(YA(o$(e),n[1]),n[0]);if(t===-1/0)return HA(YA(o$(e),n[1]),n[0]);if("fro"===t||"euclidean"===t)return KA(YA(XA(e),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}var ZA=RE({norm_:function(e,t="euclidean",n=null,r=!1){let a=JA(e=_E(e,"x","norm"),t,n),i=a.shape;if(r){let t=tS(n,e.shape);i=zA(a.shape,t)}return M$(a,i)}}),QA=RE({euclideanNorm_:function(e,t=null,n=!1){return ZA(e,"euclidean",t,n)}}),eR=RE({exp_:function(e){let t={x:_E(e,"x","exp")};return yE.runKernel(LI,t)}}),tR=RE({expandDims_:function(e,t=0){let n=_E(e,"x","expandDims","string_or_numeric");Wk(t<=n.rank,(()=>"Axis must be <= rank of the tensor"));let r={input:n},a={dim:t};return yE.runKernel(zI,r,a)}}),nR=RE({expm1_:function(e){let t={x:_E(e,"x","expm1")};return yE.runKernel(BI,t)}}),rR=RE({tile_:function(e,t){let n=_E(e,"x","tile","string_or_numeric");Wk(n.rank===t.length,(()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${t}.`));let r={x:n},a={reps:t};return yE.runKernel(LC,r,a)}}),aR=RE({eye_:function(e,t,n,r="float32"){null==t&&(t=e);let a=R_([e,t],r),i=e<=t?e:t;for(let o=0;o<i;++o)a.set(1,o,o);let s=M$(a.toTensor(),[e,t]);if(null==n)return s;if(1===n.length)return rR(tR(s,0),[n[0],1,1]);if(2===n.length)return rR(tR(tR(s,0),0),[n[0],n[1],1,1]);if(3===n.length)return rR(tR(tR(tR(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}}),iR=RE({floor_:function(e){let t={x:_E(e,"x","floor","float32")};return yE.runKernel(jI,t)}}),sR=RE({gather_:function(e,t,n=0,r=0){let a={x:_E(e,"x","gather"),indices:_E(t,"indices","gather","int32")},i={axis:n,batchDims:r};return yE.runKernel(qI,a,i)}}),oR=RE({greater_:function(e,t){let n=_E(e,"a","greater","string_or_numeric"),r=_E(t,"b","greater","string_or_numeric");[n,r]=uE(n,r),CA(n.shape,r.shape);let a={a:n,b:r};return yE.runKernel(XI,a)}}),lR=RE({greaterEqual_:function(e,t){let n=_E(e,"a","greaterEqual","string_or_numeric"),r=_E(t,"b","greaterEqual","string_or_numeric");[n,r]=uE(n,r),CA(n.shape,r.shape);let a={a:n,b:r};return yE.runKernel(YI,a)}}),uR=RE({imag_:function(e){let t={input:_E(e,"input","imag")};return yE.runKernel(QI,t)}}),dR=RE({isFinite_:function(e){let t={x:_E(e,"x","isFinite")};return yE.runKernel(eN,t)}}),cR=RE({isInf_:function(e){let t={x:_E(e,"x","isInf")};return yE.runKernel(tN,t)}}),pR=RE({isNaN_:function(e){let t={x:_E(e,"x","isNaN")};return yE.runKernel(nN,t)}}),hR=RE({leakyRelu_:function(e,t=.2){let n={x:_E(e,"x","leakyRelu")},r={alpha:t};return yE.runKernel(rN,n,r)}}),fR=RE({less_:function(e,t){let n=_E(e,"a","less","string_or_numeric"),r=_E(t,"b","less","string_or_numeric");[n,r]=uE(n,r),CA(n.shape,r.shape);let a={a:n,b:r};return yE.runKernel(aN,a)}}),mR=RE({lessEqual_:function(e,t){let n=_E(e,"a","lessEqual","string_or_numeric"),r=_E(t,"b","lessEqual","string_or_numeric");[n,r]=uE(n,r),CA(n.shape,r.shape);let a={a:n,b:r};return yE.runKernel(iN,a)}});function gR(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");let r={start:e,stop:t,num:n};return yE.runKernel(sN,{},r)}var bR=RE({localResponseNormalization_:function(e,t=5,n=1,r=1,a=.5){let i=_E(e,"x","localResponseNormalization");Wk(4===i.rank||3===i.rank,(()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ${i.rank}.`)),Wk(Kk(t),(()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${t}.`));let s=i,o=!1;3===i.rank&&(o=!0,s=M$(i,[1,i.shape[0],i.shape[1],i.shape[2]]));let l={x:s},u={depthRadius:t,bias:n,alpha:r,beta:a},d=yE.runKernel(mN,l,u);return o?M$(d,[d.shape[1],d.shape[2],d.shape[3]]):d}}),yR=RE({log_:function(e){let t={x:_E(e,"x","log","float32")};return yE.runKernel(oN,t)}}),vR=RE({log1p_:function(e){let t={x:_E(e,"x","log1p")};return yE.runKernel(lN,t)}});function xR(e){return Wk(fS(e),(()=>"The f passed in grad(f) must be a function")),(t,n)=>{let r=_E(t,"x","tf.grad","string_or_numeric"),a=null!=n?_E(n,"dy","tf.grad"):null;return yE.tidy((()=>{let{value:t,grads:n}=yE.gradients((()=>e(r)),[r],a);return null!=a&&Vk(t.shape,a.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),CR(n),n[0]}))}}function wR(e){return Wk(fS(e),(()=>"The f passed in grads(f) must be a function")),(t,n)=>{Wk(Array.isArray(t),(()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s"));let r=$E(t,"args","tf.grads","string_or_numeric"),a=null!=n?_E(n,"dy","tf.grads"):null;return yE.tidy((()=>{let{value:t,grads:n}=yE.gradients((()=>e(...r)),r,a);return null!=a&&Vk(t.shape,a.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),CR(n),n}))}}function kR(e){return Wk(fS(e),(()=>"The f passed in valueAndGrad(f) must be a function")),(t,n)=>{Wk(t instanceof XT,(()=>"The x passed in valueAndGrad(f)(x) must be a tensor")),Wk(null==n||n instanceof XT,(()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor"));let{grads:r,value:a}=yE.gradients((()=>e(t)),[t],n);return CR(r),{grad:r[0],value:a}}}function SR(e){return Wk(fS(e),(()=>"The f passed in valueAndGrads(f) must be a function")),(t,n)=>{Wk(Array.isArray(t)&&t.every((e=>e instanceof XT)),(()=>"The args passed in valueAndGrads(f)(args) must be array of tensors")),Wk(null==n||n instanceof XT,(()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor"));let r=yE.gradients((()=>e(...t)),t,n);return null!=n&&Vk(r.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),CR(r.grads),r}}function IR(e,t){Wk(fS(e),(()=>"The f passed in variableGrads(f) must be a function")),Wk(null==t||Array.isArray(t)&&t.every((e=>e instanceof JT)),(()=>"The varList passed in variableGrads(f, varList) must be an array of variables"));let n=null!=t;if(!n){t=[];for(let e in yE.registeredVariables)t.push(yE.registeredVariables[e])}let r=n?t.filter((e=>!e.trainable)):null,a=t.length;t=t.filter((e=>e.trainable)),Wk(t.length>0,(()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${a} variables is trainable.`));let{value:i,grads:s}=yE.gradients(e,t,null,!0);Wk(s.some((e=>null!=e)),(()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize().")),Wk(0===i.rank,(()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${i.rank} tensor`));let o={};return t.forEach(((e,t)=>{null!=s[t]&&(o[e.name]=s[t])})),null!=r&&r.forEach((e=>o[e.name]=null)),{value:i,grads:o}}function NR(e){return yE.customGrad(e)}function CR(e){if(e.filter((e=>null==e)).length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that\n    the f you passed encloses all operations that lead from x to y.")}var TR=RE({neg_:function(e){let t={x:_E(e,"x","neg")};return yE.runKernel(RN,t)}}),ER=RE({softplus_:function(e){let t={x:_E(e,"x","softplus")};return yE.runKernel(bC,t)}}),_R=RE({logSigmoid_:function(e){let t=_E(e,"x","logSigmoid");return NR((e=>({value:TR(ER(TR(e))),gradFunc:t=>s$(t,B$(TR(e)))})))(t)}}),$R=RE({sub_:function(e,t){let n=_E(e,"a","sub"),r=_E(t,"b","sub");[n,r]=uE(n,r);let a={a:n,b:r};return yE.runKernel(MC,a)}}),AR=RE({logSoftmax_:function(e,t=-1){let n=_E(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${t}`);return NR(((e,n)=>{let r=jA(e,t,!0),a=$R(e,r),i=$R(D_(a,"float32"),yR(YA(eR(a),t,!0)));return n([i]),{value:i,gradFunc:(e,n)=>{let[r]=n,a=eR(r);return $R(e,s$(YA(e,t,!0),a))}}}))(n)}}),RR=RE({logSumExp_:function(e,t=null,n=!1){let r=_E(e,"x","logSumExp"),a=tS(t,r.shape),i=jA(r,a,!0),s=$R(r,i),o=eR(s),l=YA(o,a),u=yR(l),d=r$(M$(i,u.shape),u);if(n){let e=zA(d.shape,a);return M$(d,e)}return d}}),DR=RE({logicalAnd_:function(e,t){let n=_E(e,"a","logicalAnd","bool"),r=_E(t,"b","logicalAnd","bool");CA(n.shape,r.shape);let a={a:n,b:r};return yE.runKernel(uN,a)}}),FR=RE({logicalNot_:function(e){let t={x:_E(e,"x","logicalNot","bool")};return yE.runKernel(dN,t)}}),MR=RE({logicalOr_:function(e,t){let n=_E(e,"a","logicalOr","bool"),r=_E(t,"b","logicalOr","bool");CA(n.shape,r.shape);let a={a:n,b:r};return yE.runKernel(cN,a)}}),OR=RE({logicalXor_:function(e,t){let n=_E(e,"a","logicalXor","bool"),r=_E(t,"b","logicalXor","bool");return CA(n.shape,r.shape),DR(MR(e,t),FR(DR(e,t)))}}),PR=2147483648,LR=RE({searchSorted_:function(e,t,n="left"){let r=_E(e,"sortedSequence","searchSorted"),a=_E(t,"values","searchSorted"),i=r.shape[r.shape.length-1],s=a.shape[a.shape.length-1],o=M$(r,[-1,i]),l=M$(a,[-1,s]);if(o.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(o.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(jk(l.shape)>=PR)throw new Error(`values tensor size must less than ${PR}`);if(o.shape[1]>=PR)throw new Error(`trailing dim_size must less than ${PR} for int32 output type, was ${o.shape[1]}`);let u={sortedSequence:o,values:l},d={side:n};return yE.runKernel(uC,u,d)}});function zR(e,t){return LR(e,t,"left")}var BR=RE({maxPool_:function(e,t,n,r,a){let i=_E(e,"x","maxPool"),s=i,o=!1;3===i.rank&&(o=!0,s=M$(i,[1,i.shape[0],i.shape[1],i.shape[2]])),Wk(4===s.rank,(()=>`Error in maxPool: input must be rank 4 but got rank ${s.rank}.`)),Wk(A$(n,1),(()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '1'`)),F$("maxPool",r,a);let l={x:s},u={filterSize:t,strides:n,pad:r,dimRoundingMode:a},d=yE.runKernel(xN,l,u);return o?M$(d,[d.shape[1],d.shape[2],d.shape[3]]):d}}),WR=RE({maxPool3d_:function(e,t=[1,1,1],n,r,a,i="NDHWC"){let s=_E(e,"x","maxPool3d"),o=s,l=!1;4===s.rank&&(l=!0,o=M$(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),Wk(5===o.rank,(()=>`Error in maxPool3d: x must be rank 5 but got rank ${o.rank}.`)),Wk("NDHWC"===i,(()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`)),F$("maxPool3d",r,a);let u={x:o},d={filterSize:t,strides:n,pad:r,dimRoundingMode:a,dataFormat:i},c=yE.runKernel(kN,u,d);return l?M$(c,[c.shape[1],c.shape[2],c.shape[3],c.shape[4]]):c}}),VR=RE({maxPoolWithArgmax_:function(e,t,n,r,a=!1){let i={x:_E(e,"x","maxPoolWithArgmax")},s={filterSize:t,strides:n,pad:r,includeBatchInIndex:a},o=yE.runKernel(IN,i,s);return{result:o[0],indexes:o[1]}}}),UR=RE({maximum_:function(e,t){let n=_E(e,"a","maximum"),r=_E(t,"b","maximum");[n,r]=uE(n,r),"bool"===n.dtype&&(n=D_(n,"int32"),r=D_(r,"int32")),CA(n.shape,r.shape);let a={a:n,b:r};return yE.runKernel(vN,a)}}),jR=RE({mean_:function(e,t=null,n=!1){let r={x:_E(e,"x","mean")},a={axis:t,keepDims:n};return yE.runKernel(NN,r,a)}});function HR(e,t="float32"){if(SS(e),"complex64"===t){let t=HR(e,"float32"),n=HR(e,"float32");return DE(t,n)}let n=wS(jk(e),t);return yE.makeTensor(n,e,t)}function GR(e,t="float32"){if(SS(e),"complex64"===t){let t=GR(e,"float32"),n=HR(e,"float32");return DE(t,n)}let n=xS(jk(e),t);return yE.makeTensor(n,e,t)}function qR(e,t,{indexing:n="xy"}={}){if("xy"!==n&&"ij"!==n)throw new TypeError(`${n} is not a valid third argument to meshgrid`);if(void 0===e)return[];let r=_E(e,"x","meshgrid",e instanceof XT?e.dtype:"float32");if(void 0===t)return[r];let a=_E(t,"y","meshgrid",t instanceof XT?t.dtype:"float32"),i=jk(r.shape),s=jk(a.shape);return"xy"===n?(r=M$(r,[1,-1]),a=M$(a,[-1,1]),[z$(GR([s,1],r.dtype),r),z$(a,GR([1,i],a.dtype))]):(r=M$(r,[-1,1]),a=M$(a,[1,-1]),[z$(r,GR([1,s],r.dtype)),z$(GR([i,1],a.dtype),a)])}var KR=RE({minimum_:function(e,t){let n=_E(e,"a","minimum"),r=_E(t,"b","minimum");[n,r]=uE(n,r),"bool"===n.dtype&&(n=D_(n,"int32"),r=D_(r,"int32")),CA(n.shape,r.shape);let a={a:n,b:r};return yE.runKernel(TN,a)}}),XR=RE({mirrorPad_:function(e,t,n){Wk("reflect"===n||"symmetric"===n,(()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`));let r=_E(e,"x","mirrorPad");if(0===r.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");Wk(t.length===r.rank,(()=>`Padding doesn't match input. Must be ${r.rank}. Got ${t.length}.`));let a="reflect"===n?1:0;for(let o=0;o<r.rank;o++)Wk(2===t[o].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),Wk(t[o][0]>=0&&t[o][0]<=r.shape[o]-a&&t[o][1]>=0&&t[o][1]<=r.shape[o]-a,(()=>`Padding in dimension ${o} cannot be greater than or equal to ${r.shape[o]-a} or less than 0 for input of shape ${r.shape}`));let i={paddings:t,mode:n},s={x:r};return yE.runKernel(EN,s,i)}}),YR=RE({mod_:function(e,t){let n=_E(e,"a","mod"),r=_E(t,"b","mod");[n,r]=uE(n,r);let a={a:n,b:r};return yE.runKernel(_N,a)}}),JR=RE({moments_:function(e,t=null,n=!1){let r=tS(t,(e=_E(e,"x","moments")).shape),a=jR(e,r,n),i=a.shape;n||(i=zA(a.shape,r));let s=XA($R(D_(e,"float32"),M$(a,i)));return{mean:a,variance:jR(s,r,n)}}}),ZR=RE({multiRNNCell_:function(e,t,n,r){let a=_E(t,"data","multiRNNCell"),i=$E(n,"c","multiRNNCell"),s=$E(r,"h","multiRNNCell"),o=a,l=[];for(let c=0;c<e.length;c++){let t=e[c](o,i[c],s[c]);l.push(t[0]),l.push(t[1]),o=t[1]}let u=[],d=[];for(let c=0;c<l.length;c+=2)u.push(l[c]),d.push(l[c+1]);return[u,d]}}),QR=RE({multinomial_:function(e,t,n,r=!1){let a=_E(e,"logits","multinomial"),i=a.size,s=a.rank;if(i<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${i}.`);if(s>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${s}`);n=n||Math.random();let o={logits:1===s?M$(a,[1,-1]):a},l={numSamples:t,seed:n,normalized:r},u=yE.runKernel($N,o,l);return 1===s?M$(u,[u.size]):u}}),eD=RE({notEqual_:function(e,t){let n=_E(e,"a","notEqual","string_or_numeric"),r=_E(t,"b","notEqual","string_or_numeric");[n,r]=uE(n,r),CA(n.shape,r.shape);let a={a:n,b:r};return yE.runKernel(DN,a)}}),tD=RE({oneHot_:function(e,t,n=1,r=0,a="int32"){if(t<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${t}`);let i={indices:_E(e,"indices","oneHot","int32")},s={dtype:a,depth:t,onValue:n,offValue:r};return yE.runKernel(LN,i,s)}}),nD=RE({onesLike_:function(e){let t={x:_E(e,"x","onesLike")};return yE.runKernel(PN,t)}}),rD=RE({outerProduct_:function(e,t){let n=_E(e,"v1","outerProduct"),r=_E(t,"v2","outerProduct");Wk(1===n.rank&&1===r.rank,(()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${r.rank}.`));let a=M$(n,[-1,1]),i=M$(r,[1,-1]);return z$(a,i)}}),aD=RE({pad_:function(e,t,n=0){let r=_E(e,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");let a={paddings:t,constantValue:n},i={x:r};return yE.runKernel(BN,i,a)}}),iD=RE({pad1d_:function(e,t,n=0){return Wk(2===t.length,(()=>"Invalid number of paddings. Must be length of 2.")),aD(e,[t],n)}}),sD=RE({pad2d_:function(e,t,n=0){return Wk(2===t.length&&2===t[0].length&&2===t[1].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),aD(e,t,n)}}),oD=RE({pad3d_:function(e,t,n=0){return Wk(3===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),aD(e,t,n)}}),lD=RE({pad4d_:function(e,t,n=0){return Wk(4===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length&&2===t[3].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),aD(e,t,n)}}),uD=RE({spaceToBatchND_:function(e,t,n){let r=_E(e,"x","spaceToBatchND");Wk(r.rank>=1+t.length,(()=>`input rank ${r.rank} should be > than [blockShape] ${t.length}`)),Wk(n.length===t.length,(()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${t.length}`)),Wk(r.shape.reduce(((e,r,a)=>a>0&&a<=t.length?e&&(r+n[a-1][0]+n[a-1][1])%t[a-1]==0:e),!0),(()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${t.toString()}`));let a={x:r},i={blockShape:t,paddings:n};return yE.runKernel(xC,a,i)}}),dD=RE({pool_:function(e,t,n,r,a,i,s){null==a&&(a=[1,1]),null==i&&(i=1),0===r&&(r="valid");let o=_E(e,"x","maxPool"),l=o,u=!1;3===o.rank&&(u=!0,l=M$(o,[1,o.shape[0],o.shape[1],o.shape[2]])),Wk(A$(i,a),(()=>`Error in pool: Either strides or dilations must be 1. Got strides ${i} and dilations '${a}'`));let d,c=w$(l.shape,t,i,a,r),p=[c.dilationHeight,c.dilationWidth];d="same"===r?function(e,t){let n=e.map(((e,n)=>e+(e-1)*(t[n]-1))).map((e=>e-1)),r=n.map((e=>Math.floor(e/2))),a=n.map(((e,t)=>e-r[t]));return n.map(((e,t)=>[r[t],a[t]]))}([c.filterHeight,c.filterWidth],p):[[0,0],[0,0]];let h=1===p[0]&&1===p[1],[f,m]=function(e,t,n){let r=n.map((e=>e[0])),a=n.map((e=>e[1])),i=e.concat(r,a),s=t.map(((e,t)=>(e-i[t]%e)%e)),o=a.map(((e,t)=>e+s[t])),l=t.map(((e,t)=>[r[t],o[t]])),u=t.map(((e,t)=>[0,s[t]]));return[l,u]}([c.inHeight,c.inWidth],p,d),g=h?r:"valid",b=h?l:uD(l,p,f),y=("avg"===n?()=>O$(b,t,i,g,s):()=>BR(b,t,i,g,s))(),v=h?y:j$(y,p,m);return u?M$(v,[v.shape[1],v.shape[2],v.shape[3]]):v}}),cD=RE({prelu_:function(e,t){let n={x:_E(e,"x","prelu"),alpha:_E(t,"alpha","prelu")};return yE.runKernel(UN,n)}}),pD=RE({prod_:function(e,t=null,n=!1){let r=_E(e,"x","prod");"bool"===r.dtype&&(r=D_(r,"int32"));let a={x:r},i={axis:t,keepDims:n};return yE.runKernel(jN,a,i)}}),hD=RE({raggedGather_:function(e,t,n,r){let a=e.map(((e,t)=>_E(e,`tensors${t}`,"raggedGather","int32"))),i={paramsNestedSplits:a,paramsDenseValues:_E(t,"paramsDenseValues","raggedGather"),indices:_E(n,"indices","raggedGather","int32")},s={outputRaggedRank:r},o=yE.runKernel(HN,i,s);return{outputNestedSplits:o.slice(0,o.length-1),outputDenseValues:o[o.length-1]}}}),fD=RE({raggedRange_:function(e,t,n){let r=_E(e,"starts","raggedRange"),a={starts:r,limits:_E(t,"limits","raggedRange",r.dtype),deltas:_E(n,"deltas","raggedRange",r.dtype)},i=yE.runKernel(GN,a);return{rtNestedSplits:i[0],rtDenseValues:i[1]}}}),mD=RE({raggedTensorToTensor_:function(e,t,n,r,a){let i=_E(e,"shape","raggedTensorToTensor","int32"),s=_E(t,"values","raggedTensorToTensor"),o=_E(n,"defaultValue","raggedTensorToTensor",s.dtype),l=r.map(((e,t)=>_E(e,`tensors${t}`,"raggedTensorToTensor","int32"))),u={shape:i,values:s,defaultValue:o,rowPartitionTensors:l},d={rowPartitionTypes:a};return yE.runKernel(qN,u,d)}}),gD=RE({rand_:function(e,t,n){SS(e);let r=jk(e),a=null;if(null==n||"float32"===n)a=new Float32Array(r);else if("int32"===n)a=new Int32Array(r);else{if("bool"!==n)throw new Error(`Unknown data type ${n}`);a=new Uint8Array(r)}for(let i=0;i<r;i++)a[i]=t();return yE.makeTensor(a,e,n)}}),bD=lk(xk()),yD={};ok(yD,{TEST_EPSILON_FLOAT16:()=>xD,createVideoElement:()=>AD,encodeStrings:()=>$D,expectArrayBuffersEqual:()=>_D,expectArraysClose:()=>wD,expectArraysEqual:()=>ND,expectNumbersClose:()=>CD,expectPromiseToFail:()=>ID,expectValuesInRange:()=>ED,play:()=>RD,testEpsilon:()=>kD});var vD=.001,xD=.1;function wD(e,t,n){return null==n&&(n=kD()),SD(e,t,((e,t)=>TD(e,t,n)))}function kD(){return 32===yE.backend.floatPrecision()?vD:xD}function SD(e,t,n){let r=!0;if((FT(e)||FT(t))&&(r=!1),FT(e)&&FT(t)&&(r=!0),r){let n=e.constructor.name,r=t.constructor.name;if(n!==r)throw new Error(`Arrays are of different type. Actual: ${n}. Expected: ${r}`)}if(Array.isArray(e)&&Array.isArray(t)){let n=CE(e),r=CE(t);if(!qk(n,r))throw new Error(`Arrays have different shapes. Actual: [${n}]. Expected: [${r}]`)}let a=FT(e)?e:MT(e),i=FT(t)?t:MT(t);if(a.length!==i.length)throw new Error(`Arrays have different lengths actual: ${a.length} vs expected: ${i.length}.\nActual:   ${a}.\nExpected: ${i}.`);for(let s=0;s<i.length;++s){let e=a[s],t=i[s];if(!n(e,t))throw new Error(`Arrays differ: actual[${s}] = ${e}, expected[${s}] = ${t}.\nActual:   ${a}.\nExpected: ${i}.`)}"undefined"!=typeof expect&&expect().nothing()}function ID(e,t){e().then((()=>t.fail()),(()=>t())),"undefined"!=typeof expect&&expect().nothing()}function ND(e,t){let n="string"==typeof t||"number"==typeof t||"boolean"==typeof t?[t]:t;return dS(e)||dS(e[0])||dS(t)||dS(t[0])?SD(e,n,((e,t)=>e==t)):SD(e,t,((e,t)=>TD(e,t,0)))}function CD(e,t,n){if(null==n&&(n=kD()),!TD(e,t,n))throw new Error(`Numbers differ: actual === ${e}, expected === ${t}`);"undefined"!=typeof expect&&expect().nothing()}function TD(e,t,n){return!isFinite(e)&&!isFinite(t)||!(isNaN(e)||isNaN(t)||Math.abs(e-t)>n)}function ED(e,t,n){for(let r=0;r<e.length;r++)if(e[r]<t||e[r]>n)throw new Error(`Value out of range:${e[r]} low: ${t}, high: ${n}`)}function _D(e,t){let n=new Float32Array(e),r=new Float32Array(t);if(n.length!==r.length)throw new Error(`Expected ArrayBuffer to be of length ${r.length}, but it was ${n.length}`);for(let a=0;a<r.length;a++)if(n[a]!==r[a])throw new Error(`Expected ArrayBuffer value at ${a} to be ${r[a]} but got ${n[a]} instead`)}function $D(e){for(let t=0;t<e.length;t++){let n=e[t];Array.isArray(n)?$D(n):e[t]=RT(n)}return e}function AD(e){let t=document.createElement("video");return"playsInline"in t&&(t.playsInline=!0),t.muted=!0,t.loop=!0,t.style.position="fixed",t.style.left="0px",t.style.top="0px",t.preload="auto",t.appendChild(e),new Promise((e=>{t.addEventListener("loadeddata",(n=>e(t))),t.load()}))}async function RD(e){await e.play(),"requestVideoFrameCallback"in e&&await new Promise((t=>{e.requestVideoFrameCallback(t)}))}var DD=class{constructor(e,t,n,r,a){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);let i=a||Math.random();this.random=bD.alea(i.toString())}nextValue(){if(!isNaN(this.nextVal)){let e=this.nextVal;return this.nextVal=NaN,e}let e,t,n=!1;for(;!n;){let r,a,i;do{r=2*this.random()-1,a=2*this.random()-1,i=r*r+a*a}while(i>=1||0===i);let s=Math.sqrt(-2*Math.log(i)/i);e=this.mean+this.stdDev*r*s,t=this.mean+this.stdDev*a*s,(!this.truncated||this.isValidTruncated(e))&&(n=!0)}return(!this.truncated||this.isValidTruncated(t))&&(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}},FD=RE({randomGamma_:function(e,t,n=1,r="float32",a){if(SS(e),null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error(`Unsupported data type ${r}`);let i=new class{constructor(e,t,n,r){this.alpha=e,this.beta=1/t,this.dtype=n;let a=r||Math.random();this.randu=bD.alea(a.toString()),this.randn=new DD(0,1,n,!1,this.randu()),this.d=e<1?e+2/3:e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,t,n,r,a,i;for(;;){do{r=this.randn.nextValue(),i=1+this.c*r}while(i<=0);if(i*=i*i,e=r*r,t=1-.331*e*e,n=.5*e+this.d*(1-i+Math.log(i)),a=this.randu(),a<t||Math.log(a)<n)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)}convertValue(e){return"float32"===this.dtype?e:Math.round(e)}}(t,n,r,a),s=R_(e,r);for(let o=0;o<s.values.length;o++)s.values[o]=i.nextValue();return s.toTensor()}}),MD=RE({randomNormal_:function(e,t=0,n=1,r,a){if(SS(e),null!=r&&"bool"===r)throw new Error(`Unsupported data type ${r}`);let i=new DD(t,n,r,!1,a),s=R_(e,r);for(let o=0;o<s.values.length;o++)s.values[o]=i.nextValue();return s.toTensor()}}),OD=RE({randomStandardNormal_:function(e,t,n){if(null!=t&&"bool"===t)throw new Error(`Unsupported data type ${t}`);return MD(e,0,1,t,n)}}),PD=RE({randomUniform_:function(e,t=0,n=1,r="float32",a){SS(e);let i=R_(e,r),s=new class{constructor(e=0,t=1,n,r){if(this.canReturnFloat=()=>null==this.dtype||"float32"===this.dtype,this.min=e,this.range=t-e,this.dtype=n,null==r&&(r=Math.random()),"number"==typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${t} <= 1 and dtype is not float`);this.random=bD.alea(r)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}(t,n,null,a);for(let o=0;o<i.values.length;o++)i.values[o]=s.nextValue();return i.toTensor()}}),LD=RE({randomUniformInt_:function(e,t,n,r){return PD(e,t,n,"int32",r)}});function zD(e,t,n=1,r="float32"){if(0===n)throw new Error("Cannot have a step of zero");let a={start:e,stop:t,step:n,dtype:r};return yE.runKernel(KN,{},a)}var BD=RE({real_:function(e){let t={input:_E(e,"input","real")};return yE.runKernel(XN,t)}}),WD=RE({reciprocal_:function(e){let t={x:_E(e,"x","reciprocal")};return yE.runKernel(YN,t)}}),VD=RE({relu_:function(e){let t={x:_E(e,"x","relu")};return yE.runKernel(JN,t)}}),UD=RE({relu6_:function(e){let t={x:_E(e,"x","relu6")};return yE.runKernel(rC,t)}}),jD=RE({reverse_:function(e,t){let n={x:_E(e,"x","reverse")},r={dims:t};return yE.runKernel(aC,n,r)}}),HD=RE({reverse1d_:function(e){let t=_E(e,"x","reverse");return Wk(1===t.rank,(()=>`Error in reverse1D: x must be rank 1 but got rank ${t.rank}.`)),jD(t,0)}}),GD=RE({reverse2d_:function(e,t){let n=_E(e,"x","reverse");return Wk(2===n.rank,(()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`)),jD(n,t)}}),qD=RE({reverse3d_:function(e,t){let n=_E(e,"x","reverse");return Wk(3===n.rank,(()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`)),jD(n,t)}}),KD=RE({reverse4d_:function(e,t){let n=_E(e,"x","reverse");return Wk(4===n.rank,(()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`)),jD(n,t)}}),XD=RE({round_:function(e){let t={x:_E(e,"x","round")};return yE.runKernel(iC,t)}}),YD=RE({rsqrt_:function(e){let t={x:_E(e,"x","rsqrt","float32")};return yE.runKernel(sC,t)}}),JD=RE({selu_:function(e){let t={x:_E(e,"x","selu")};return yE.runKernel(cC,t)}}),ZD=RE({separableConv2d_:function(e,t,n,r,a,i=[1,1],s="NHWC"){let o=_E(e,"x","separableConv2d"),l=_E(t,"depthwiseFilter","separableConv2d"),u=_E(n,"pointwiseFilter","separableConv2d"),d=o,c=!1;if(3===o.rank&&(c=!0,d=M$(o,[1,o.shape[0],o.shape[1],o.shape[2]])),"NCHW"===s)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");Wk(4===d.rank,(()=>`Error in separableConv2d: input must be rank 4, but got rank ${d.rank}.`)),Wk(4===l.rank,(()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`)),Wk(4===u.rank,(()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`)),Wk(1===u.shape[0],(()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${u.shape[0]}.`)),Wk(1===u.shape[1],(()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${u.shape[1]}.`));let p=l.shape[2],h=l.shape[3];Wk(u.shape[2]===p*h,(()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${p*h}, but got ${u.shape[2]}.`));let f=xA(d,l,r,a,s,i),m=oA(f,u,1,"valid",s);return c?M$(m,[m.shape[1],m.shape[2],m.shape[3]]):m}}),QD=async function(e,t){let n=_E(e,"x","setdiff1d"),r=_E(t,"y","setdiff1d");Wk(n.dtype===r.dtype,(()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${r.dtype}).`)),Wk(1===n.rank,(()=>`x should be 1D tensor, but got x (${n.shape}).`)),Wk(1===r.rank,(()=>`y should be 1D tensor, but got y (${r.shape}).`));let a=await n.data(),i=await r.data(),s=new Set(i),o=0;for(let d=0;d<a.length;d++)s.has(a[d])||o++;let l=new GT([o],n.dtype),u=new GT([o],"int32");for(let d=0,c=0;d<a.length;d++)s.has(a[d])||(l.values[c]=a[d],u.values[c]=d,c++);return[l.toTensor(),u.toTensor()]},eF=RE({sign_:function(e){let t={x:_E(e,"x","sign")};return yE.runKernel(mC,t)}}),tF=RE({sin_:function(e){let t={x:_E(e,"x","sin","float32")};return yE.runKernel(hC,t)}}),nF=RE({sinh_:function(e){let t={x:_E(e,"x","sinh")};return yE.runKernel(fC,t)}}),rF=RE({slice1d_:function(e,t,n){let r=_E(e,"x","slice1d");return Wk(1===r.rank,(()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`)),W$(r,[t],[n])}}),aF=RE({slice2d_:function(e,t,n){let r=_E(e,"x","slice2d");return Wk(2===r.rank,(()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`)),W$(r,t,n)}}),iF=RE({slice3d_:function(e,t,n){let r=_E(e,"x","slice3d");return Wk(3===r.rank,(()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`)),W$(r,t,n)}}),sF=RE({slice4d_:function(e,t,n){let r=_E(e,"x","slice4d");return Wk(4===r.rank,(()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`)),W$(r,t,n)}}),oF=RE({softmax_:function(e,t=-1){let n=_E(e,"logits","softmax","float32");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${t}`);let r={logits:n},a={dim:t};return yE.runKernel(kC,r,a)}}),lF=RE({fft_:function(e){Wk("complex64"===e.dtype,(()=>`The dtype for tf.spectral.fft() must be complex64 but got ${e.dtype}.`));let t={input:e};return yE.runKernel(WI,t)}}),uF=RE({ifft_:function(e){Wk("complex64"===e.dtype,(()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${e.dtype}.`));let t={input:e};return yE.runKernel(ZI,t)}}),dF=RE({irfft_:function(e){let t,n=e.shape[e.shape.length-1],r=e.size/n;if(n<=2){let a=M$(e,[r,n]);t=uF(a)}else{let a=[r,2*(n-1)],i=M$(BD(e),[r,n]),s=M$(uR(e),[r,n]),o=jD(W$(i,[0,1],[r,n-2]),1),l=s$(jD(W$(s,[0,1],[r,n-2]),1),qA(-1)),u=L$([i,o],1),d=L$([s,l],1),c=M$(DE(u,d),[a[0],a[1]]);t=uF(c)}if(t=BD(t),3===e.rank&&0!==e.shape[0]){let n=t,r=e.shape[0];t=M$(t,[r,t.shape[0]/r,t.shape[1]]),n.dispose()}return t}}),cF=RE({split_:function(e,t,n=0){let r={x:_E(e,"x","split")},a={numOrSizeSplits:t,axis:n};return yE.runKernel(wC,r,a)}}),pF=RE({rfft_:function(e,t){Wk("float32"===e.dtype,(()=>`The dtype for rfft() must be real value but got ${e.dtype}`));let n,r=e.shape[e.shape.length-1],a=e.size/r;if(null!=t&&t<r){let a=e.shape.map((e=>0)),i=e.shape.map((e=>e));i[e.shape.length-1]=t,n=W$(e,a,i),r=t}else if(null!=t&&t>r){let a=e.shape.map((e=>e));a[e.shape.length-1]=t-r,n=L$([e,HR(a)],e.shape.length-1),r=t}else n=e;let i=_A(n),s=M$(DE(n,i),[a,r]),o=lF(s),l=Math.floor(r/2)+1,u=BD(o),d=uR(o),c=cF(u,[l,r-l],u.shape.length-1),p=cF(d,[l,r-l],d.shape.length-1),h=n.shape.slice();return h[n.shape.length-1]=l,M$(DE(c[0],p[0]),h)}}),hF=RE({squaredDifference_:function(e,t){let n=_E(e,"a","squaredDifference"),r=_E(t,"b","squaredDifference");[n,r]=uE(n,r),CA(n.shape,r.shape);let a={a:n,b:r};return yE.runKernel(EC,a,{})}}),fF=RE({squeeze_:function(e,t){let n=_E(e,"x","squeeze","string_or_numeric");return M$(n,nS(n.shape,t).newShape)}}),mF=RE({stack_:function(e,t=0){let n=$E(e,"tensors","stack","string_or_numeric");Wk(n.length>=1,(()=>"Pass at least one tensor to tf.stack")),n.length>0&&Wk(t<=n[0].rank,(()=>"Axis must be <= rank of the tensor"));let r=n,a={axis:t};return yE.runKernel(zN,r,a)}}),gF=RE({step_:function(e,t=0){let n={x:_E(e,"x","step")},r={alpha:t};return yE.runKernel(qC,n,r)}}),bF=RE({stridedSlice_:function(e,t,n,r,a=0,i=0,s=0,o=0,l=0){let u={x:_E(e,"x","stridedSlice","string_or_numeric")},d={begin:t,end:n,strides:r,beginMask:a,endMask:i,ellipsisMask:s,newAxisMask:o,shrinkAxisMask:l};return yE.runKernel(AC,u,d)}}),yF=RE({tan_:function(e){let t={x:_E(e,"x","tan","float32")};return yE.runKernel(OC,t)}});function vF(e,t){Uk(e);let n=CE(e,t);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return FE(e,null,n,t)}function xF(e,t,n){if(Uk(e),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");let r=CE(e,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return FE(e,t,r,n)}function wF(e,t,n){if(Uk(e),null!=t&&3!==t.length)throw new Error("tensor3d() requires shape to have three numbers");let r=CE(e,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return FE(e,t,r,n)}function kF(e,t,n){if(Uk(e),null!=t&&4!==t.length)throw new Error("tensor4d() requires shape to have four numbers");let r=CE(e,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return FE(e,t,r,n)}function SF(e,t,n){if(Uk(e),null!=t&&5!==t.length)throw new Error("tensor5d() requires shape to have five numbers");let r=CE(e,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return FE(e,t,r,n)}function IF(e,t,n){if(Uk(e),null!=t&&6!==t.length)throw new Error("tensor6d() requires shape to have six numbers");let r=CE(e,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return FE(e,t=t||r,r,n)}var NF={};function CF(e,t,n){let r=t.rank>1?t.shape[t.rank-1]:1,a=t.rank>1?t.rank-1:1,i=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${t.shape}, shape: ${e}, sliceDim: ${r}, and batchDim: ${a}.`;if(n.rank<a)throw new Error(i+` update.rank < ${a}. `);if(e.length<r+(n.rank-a))throw new Error(i+` Output shape length < ${r+(n.rank-a)}`);if(n.rank!==a+e.length-r)throw new Error(i+" update.rank != "+(a+e.length-r));for(let s=0;s<a;++s)if(n.shape[s]!==t.shape[s])throw new Error(i+` updates.shape[${s}] (${n.shape[s]}) != indices.shape[${s}] (${t.shape[s]}).`);for(let s=0;s<n.rank-a;++s)if(n.shape[s+a]!==e[s+r])throw new Error(i+` updates.shape[${s+a}] (${n.shape[s+a]}) != shape[${s+a}] (${e[s+a]})`)}function TF(e,t,n){if(t.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${e.rank}.`);if("int32"!==t.dtype)throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${t.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(0===n.length){if(0===t.size)throw new Error(`Indices specified for empty output. indices shape: ${t.shape}`);if(0===e.size)throw new Error(`Updates specified for empty output. updates shape: ${e.shape}`)}CF(n,t,e)}function EF(e,t,n){let r=t.shape.length,a=r>1?t.shape[r-1]:1,i=n.length,s=1;for(let l=a;l<i;++l)s*=n[l];let o=a<1?1:a;return{sliceRank:a,numUpdates:jk(t.shape)/o,sliceSize:s,strides:[...gS(n.slice(0,a)),1],outputSize:jk(n)}}ok(NF,{calculateShapes:()=>EF,validateInput:()=>TF,validateUpdateShape:()=>CF});var _F=RE({tensorScatterUpdate_:function(e,t,n){let r=_E(e,"tensor","tensorScatterupdate"),a=_E(t,"indices","tensorScatterupdate","int32"),i=_E(n,"updates","tensorScatterupdate");if(TF(i,a,r.shape),r.dtype!==i.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${r.dtype} and ${i.dtype}.`);let s={tensor:r,indices:a,updates:i};return yE.runKernel(lC,s,{})}}),$F=RE({topk_:function(e,t=1,n=!0){let r=_E(e,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");let a=r.shape[r.shape.length-1];if(t<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${t}`);if(t>a)throw new Error(`'k' passed to topk() must be <= the last dimension (${a}) but got ${t}`);let i={x:r},s={k:t,sorted:n},[o,l]=yE.runKernel(zC,i,s);return{values:o,indices:l}}}),AF=RE({truncatedNormal_:function(e,t=0,n=1,r,a){if(SS(e),null!=r&&"bool"===r)throw new Error("Unsupported data type $ { dtype }");let i=new DD(t,n,r,!0,a),s=R_(e,r);for(let o=0;o<s.values.length;o++)s.values[o]=i.nextValue();return s.toTensor()}}),RF=RE({unique_:function(e,t=0){let n=_E(e,"x","unique","string_or_numeric");Wk(n.rank>0,(()=>"The input tensor must be at least 1D"));let r={x:n},a={axis:t},[i,s]=yE.runKernel(VC,r,a);return{values:i,indices:s}}}),DF=RE({unsortedSegmentSum_:function(e,t,n){let r=_E(e,"x","unsortedSegmentSum"),a=_E(t,"segmentIds","unsortedSegmentSum","int32");Wk(Kk(n),(()=>"numSegments must be of dtype int"));let i={x:r,segmentIds:a},s={numSegments:n};return yE.runKernel(jC,i,s)}}),FF=RE({unstack_:function(e,t=0){let n=_E(e,"x","unstack","string_or_numeric");Wk(t>=-n.shape.length&&t<n.shape.length,(()=>`Axis = ${t} is not in [-${n.shape.length}, ${n.shape.length})`));let r={value:n},a={axis:t};return yE.runKernel(UC,r,a)}});function MF(e,t){return LR(e,t,"right")}function OF(e,t=!0,n,r){return yE.makeVariable(e,t,n,r)}function PF(e,t){let n=[];for(let i=0;i<t.length;i++)t[i]&&n.push(i);let r=R_(e,"int32"),a=R_([n.length,e.length],"int32");for(let i=0;i<n.length;i++){let t=r.indexToLoc(n[i]),s=i*e.length;a.values.set(t,s)}return a.toTensor()}var LF=async function(e){let t=_E(e,"condition","whereAsync","bool"),n=await t.data(),r=PF(t.shape,n);return e!==t&&t.dispose(),r},zF=async function(e,t,n){let r=_E(e,"tensor","boolMask"),a=_E(t,"mask","boolMask","bool"),i=null==n?0:n,s=a.rank,o=r.shape;Wk(s>0,(()=>"mask cannot be scalar")),Vk(o.slice(i,i+s),a.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let m=i;m<i+s;m++)l*=o[m];let u=o.slice(0,i).concat([l],o.slice(i+s)),d=M$(r,u),c=M$(a,[-1]),p=await LF(c),h=fF(p,[1]),f=sR(d,h,i);return e!==r&&r.dispose(),t!==a&&a.dispose(),h.dispose(),d.dispose(),c.dispose(),p.dispose(),f},BF=RE({transpose_:function(e,t,n){let r=_E(e,"x","transpose");if(null==t&&(t=r.shape.map(((e,t)=>t)).reverse()),Wk(r.rank===t.length,(()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${t}.`)),t.forEach((e=>{Wk(e>=0&&e<r.rank,(()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${t}`))})),r.rank<=1)return r.clone();let a={x:r},i={perm:t};return"complex64"===r.dtype?j_((()=>{let e=BD(r),t=uR(r);return e=yE.runKernel(WC,{x:e},i),t=yE.runKernel(WC,{x:t},i),n&&(t=TR(t)),DE(e,t)})):yE.runKernel(WC,a,i)}}),WF=RE({movingAverage_:function(e,t,n,r,a=!0){let i=_E(e,"v","movingAverage"),s=_E(t,"x","movingAverage"),o=_E(n,"decay","movingAverage");dE(i,s),Wk(qk(i.shape,s.shape),(()=>"Shape mismatch in v and x"));let l=qA(1),u=$R(l,o),d=s$($R(s,i),u);if(a){Wk(null!=r,(()=>"When using zeroDebias: true, step is required."));let e=_E(r,"step","movingAverage");d=i$(d,$R(l,GA(o,e)))}return r$(i,d)}}),VF=RE({scatterND_:function(e,t,n){SS(n);let r=_E(e,"indices","scatterND","int32"),a=_E(t,"updates","scatterND");TF(a,r,n);let i={indices:r,updates:a},s={shape:n};return yE.runKernel(oC,i,s)}}),UF=RE({sparseToDense_:function(e,t,n,r=0){SS(n);let a=_E(e,"sparseIndices","sparseToDense","int32"),i=_E(t,"sparseValues","sparseToDense","string_or_numeric"),s=_E(r,"defaultValue","sparseToDense",i.dtype);!function(e,t,n,r){if("int32"!==e.dtype)throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${e.shape}.`);let a=e.rank>0?e.shape[0]:1,i=e.rank>1?e.shape[1]:1;if(n.length!==i)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${i}.`);let s=t.size;if(0!==t.rank&&(1!==t.rank||s!==a))throw new Error(`sparseValues has incorrect shape ${t.shape}, should be [] or [${a}]`);if(t.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(a,i,n,s);let o={sparseIndices:a,sparseValues:i,defaultValue:s},l={outputShape:n};return yE.runKernel(TC,o,l)}}),jF=RE({gatherND_:function(e,t){let n=_E(t,"indices","gatherND","int32"),r={params:_E(e,"x","gatherND","string_or_numeric"),indices:n};return yE.runKernel(KI,r)}}),HF=RE({dropout_:function(e,t,n,r){let a=_E(e,"x","dropout");if(Wk("float32"===a.dtype,(()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${a.dtype} tensor instead.`)),Wk(t>=0&&t<1,(()=>`rate must be a float in the range [0, 1), but got ${t}.`)),0===t)return e instanceof XT?a.clone():a;let i=function(e,t){if(null==t)return e.shape.slice();if(qk(e.shape,t))return t;if(e.shape.length===t.length){let n=[];for(let r=0;r<e.shape.length;r++)null==t[r]&&null!=e.shape[r]?n.push(e.shape[r]):n.push(t[r]);return n}return t}(a,n),s=1-t,o=i$(iR(r$(PD(i,0,1,"float32",r),s)),s);return s$(a,o)}});function GF(e){return Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))))}function qF(e,t,n){let r=1-e%2,a=new Float32Array(e);for(let i=0;i<e;++i){let s=2*Math.PI*i/(e+r-1);a[i]=t-n*Math.cos(s)}return vF(a,"float32")}var KF=async function(e,t,n=1){let r=_E(e,"predictions","inTopK"),a=_E(t,"targets","inTopK");Wk(r.rank>1,(()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${r.rank}`)),Wk(r.rank-1===a.rank,(()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${r.rank} and targets rank ${a.rank}`)),Vk(r.shape.slice(0,r.shape.length-1),a.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");let i=r.shape[r.shape.length-1];Wk(n>0&&n<=i,(()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${i}), but got ${n}`));let s=await r.data(),o=await a.data(),[l,u]=[s.length/i,i],d=rS("bool",l);for(let c=0;c<l;c++){let e=c*u,t=s.subarray(e,e+u),r=[];for(let n=0;n<t.length;n++)r.push({value:t[n],index:n});r.sort(((e,t)=>t.value-e.value)),d[c]=0;for(let a=0;a<n;a++)if(r[a].index===o[c]){d[c]=1;break}}return e!==r&&r.dispose(),t!==a&&a.dispose(),ME(d,a.shape,"bool")},XF={};ok(XF,{conv2d:()=>tM,depthwiseConv2d:()=>aM,matMul:()=>iM});var YF=RE({conv2DBackpropFilter_:function(e,t,n,r,a,i="NHWC",s){let o=e;3===e.rank&&(o=M$(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let l=t;3===l.rank&&(l=M$(t,[1,t.shape[0],t.shape[1],t.shape[2]])),Wk(4===o.rank,(()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${o.shape}.`)),Wk(4===l.rank,(()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`)),Wk(4===n.length,(()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`));let u="NHWC"===i?o.shape[3]:o.shape[1],d="NHWC"===i?l.shape[3]:l.shape[1];Wk(u===n[2],(()=>`Error in conv2dDerFilter: depth of input ${u}) must match input depth in filter (${n[2]}.`)),Wk(d===n[3],(()=>`Error in conv2dDerFilter: depth of dy (${d}) must match output depth for filter (${n[3]}).`)),F$("conv2dDerFilter",a,s);let c={x:o,dy:l},p={strides:r,pad:a,dataFormat:i,dimRoundingMode:s,filterShape:n};return yE.runKernel(pI,c,p)}});function JF(e,t,n){if(null==n||"linear"===n)return e;if("relu"===n)return s$(e,gF(t));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function ZF(e,t){let n=t,r=NA(e.shape,t.shape);return r.length>0&&(n=YA(n,r)),M$(n,e.shape)}function QF(e,t,n,r){if("linear"===t)return e;if("relu"===t)return VD(e);if("elu"===t)return DA(e);if("relu6"===t)return UD(e);if("prelu"===t)return cD(e,n);if("leakyrelu"===t)return hR(e,r);if("sigmoid"===t)return B$(e);throw new Error(`Unknown fused activation ${t}.`)}var eM=(e,t)=>!(e>0)||"linear"===t,tM=RE({fusedConv2d_:function({x:e,filter:t,strides:n,pad:r,dataFormat:a="NHWC",dilations:i=[1,1],dimRoundingMode:s,bias:o,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:d}){if(l=l||"linear",!1===eM(yE.state.gradientDepth,l)){Wk("NHWC"===a,(()=>`Error in fused conv2d: got dataFormat of ${a} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`));let c=oA(e,t,n,r,a,i,s);return null!=o&&(c=r$(c,o)),QF(c,l,u,d)}let c=_E(e,"x","conv2d","float32"),p=_E(t,"filter","conv2d","float32"),h=c,f=!1;3===c.rank&&(f=!0,h=M$(c,[1,c.shape[0],c.shape[1],c.shape[2]])),Wk(4===h.rank,(()=>`Error in fused conv2d: input must be rank 4, but got rank ${h.rank}.`)),Wk(4===p.rank,(()=>`Error in fused conv2d: filter must be rank 4, but got rank ${p.rank}.`)),F$("fused conv2d",r,s);let m="NHWC"===a?h.shape[3]:h.shape[1];Wk(p.shape[2]===m,(()=>`Error in conv2d: depth of input (${m}) must match input depth for filter ${p.shape[2]}.`)),Wk(A$(n,i),(()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`));let g,b,y=S$(h.shape,p.shape,n,i,r,s);if(null!=o&&(g=_E(o,"bias","fused conv2d"),[g]=uE(g,c),"NHWC"===a?CA(y.outShape,g.shape):(Wk(g.shape.length<=1,(()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${g.shape.length}.`)),Wk(0===g.shape.length||g.shape[0]===y.outChannels||1===g.shape[0],(()=>`Error in fused conv2d: bias shape (${g.shape}) is not compatible with the number of output channels (${y.outChannels})`)))),null!=u){let e=u.shape;if(Wk(e.length<=1||3===e.length,(()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${e.length}.`)),1===e.length)Wk(1===e[0]||e[0]===y.outChannels,(()=>`Error in fused conv2d: PReLU activation weights (${e}) is not compatible with the number of output channels (${y.outChannels}).`));else if(3===e.length)try{CA(e,y.outShape)}catch(vn){let n=`Error in fused conv2d: PReLU activation weights (${e}) is not compatible with the output shape of the conv2d (${y.outShape}).`;throw Error(n)}b=_E(u,"prelu weights","fused conv2d")}let v=(e,t)=>{Wk("NHWC"===a,(()=>`Error in gradient of fused conv2D: got dataFormat of ${a} but only NHWC is currently supported.`));let[s,o,u,d]=t,c=JF(e,u,l);Wk($$(i),(()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`));let p=[uA(o.shape,c,s,n,r),YF(o,c,s.shape,n,r)];if(null!=d){let e=ZF(d,c);p.push(e)}return p},x={x:h,filter:p,bias:g,preluActivationWeights:b},w={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:s,activation:l,leakyreluAlpha:d};return null==o?NR(((e,t,n)=>{let r=yE.runKernel(JC,x,w);return n([t,e,r]),f&&(r=M$(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:v}}))(h,p):NR(((e,t,n,r)=>{let a=yE.runKernel(JC,x,w);return r([t,e,a,n]),f&&(a=M$(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:v}}))(h,p,g)}}),nM=RE({depthwiseConv2dNativeBackpropFilter_:function(e,t,n,r,a,i=[1,1],s){let o=e;3===e.rank&&(o=M$(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let l=t;3===l.rank&&(l=M$(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let u={x:o,dy:l},d={strides:r,pad:a,dimRoundingMode:s,dilations:i,filterShape:n};return yE.runKernel(NI,u,d)}}),rM=RE({depthwiseConv2dNativeBackpropInput_:function(e,t,n,r,a,i=[1,1],s){let o=t,l=!1;3===t.rank&&(l=!0,o=M$(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let u={dy:o,filter:n},d={strides:r,pad:a,dimRoundingMode:s,dilations:i,inputShape:e},c=yE.runKernel(CI,u,d);return l?M$(c,[c.shape[1],c.shape[2],c.shape[3]]):c}}),aM=RE({fusedDepthwiseConv2d_:function({x:e,filter:t,strides:n,pad:r,dataFormat:a="NHWC",dilations:i=[1,1],dimRoundingMode:s,bias:o,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:d}){if(!1===eM(yE.state.gradientDepth,l)){let c=xA(e,t,n,r,a,i,s);return null!=o&&(c=r$(c,o)),QF(c,l,u,d)}let c=_E(e,"x","depthwiseConv2d","float32"),p=_E(t,"filter","depthwiseConv2d","float32"),h=c,f=!1;3===c.rank&&(f=!0,h=M$(c,[1,c.shape[0],c.shape[1],c.shape[2]])),Wk(4===h.rank,(()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${h.rank}.`)),Wk(4===p.rank,(()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${p.rank}.`)),Wk(h.shape[3]===p.shape[2],(()=>`Error in fused depthwiseConv2d: number of input channels (${h.shape[3]}) must match the inChannels dimension in filter ${p.shape[2]}.`)),null==i&&(i=[1,1]),Wk(A$(n,i),(()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`)),F$("fused depthwiseConv2d",r,s);let m,g,b=S$(h.shape,p.shape,n,i,r,s,!0);null!=o&&(m=_E(o,"bias","fused conv2d"),[m]=uE(m,c),CA(b.outShape,m.shape)),null!=u&&(g=_E(u,"prelu weights","fused depthwiseConv2d"));let y=(e,t)=>{Wk($$(i),(()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${i}'`));let[a,o,u,d]=t,c=JF(e,u,l),p=rM(o.shape,c,a,n,r,i,s),h=nM(o,c,a.shape,n,r,i,s);return null!=d?[p,h,ZF(m,c)]:[p,h]},v={x:h,filter:p,bias:m,preluActivationWeights:g},x={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:s,activation:l,leakyreluAlpha:d};return null==o?NR(((e,t,n)=>{let r=yE.runKernel(ZC,v,x);return n([t,e,r]),f&&(r=M$(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:y}}))(h,p):NR(((e,t,n,r)=>{let a=yE.runKernel(ZC,v,x);return r([t,e,a,n]),f&&(a=M$(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:y}}))(h,p,m)}}),iM=RE({fusedMatMul_:function({a:e,b:t,transposeA:n=!1,transposeB:r=!1,bias:a,activation:i="linear",preluActivationWeights:s,leakyreluAlpha:o=.2}){if(!1===eM(yE.state.gradientDepth,i)){let l=z$(e,t,n,r);return null!=a&&(l=r$(l,a)),QF(l,i,s,o)}let l=_E(e,"a","fused matMul"),u=_E(t,"b","fused matMul");[l,u]=uE(l,u);let d=n?l.shape[l.rank-2]:l.shape[l.rank-1],c=r?u.shape[u.rank-1]:u.shape[u.rank-2],p=n?l.shape[l.rank-1]:l.shape[l.rank-2],h=r?u.shape[u.rank-2]:u.shape[u.rank-1],f=l.shape.slice(0,-2),m=u.shape.slice(0,-2),g=jk(f),b=jk(m);Wk(d===c,(()=>`Error in fused matMul: inner shapes (${d}) and (${c}) of Tensors with shapes ${l.shape} and ${u.shape} and transposeA=${n} and transposeB=${r} must match.`));let y,v,x=CA(l.shape.slice(0,-2),u.shape.slice(0,-2)).concat([p,h]),w=M$(l,n?[g,d,p]:[g,p,d]),k=M$(u,r?[b,h,c]:[b,c,h]);null!=a&&(y=_E(a,"bias","fused matMul"),[y]=uE(y,l),CA(x,y.shape)),null!=s&&(v=_E(s,"prelu weights","fused matMul"));let S=(e,t)=>{let s,o,[l,u,d,c]=t,p=JF(M$(e,d.shape),d,i);return n||r?!n&&r?(s=z$(p,u,!1,!1),o=z$(p,l,!0,!1)):n&&!r?(s=z$(u,p,!1,!0),o=z$(l,p,!1,!1)):(s=z$(u,p,!0,!0),o=z$(p,l,!0,!0)):(s=z$(p,u,!1,!0),o=z$(l,p,!0,!1)),null!=a?[s,o,ZF(c,p)]:[s,o]},I={a:w,b:k,bias:y,preluActivationWeights:v},N={transposeA:n,transposeB:r,activation:i,leakyreluAlpha:o};return null==a?NR(((e,t,n)=>{let r=yE.runKernel(YC,I,N);return n([e,t,r]),{value:M$(r,x),gradFunc:S}}))(w,k):NR(((e,t,n,r)=>{let a=yE.runKernel(YC,I,N);return r([e,t,a,n]),{value:M$(a,x),gradFunc:S}}))(w,k,y)}}),sM=RE({hammingWindow_:function(e){return qF(e,.54,.46)}}),oM=RE({hannWindow_:function(e){return qF(e,.5,.5)}}),lM=RE({frame_:function(e,t,n,r=!1,a=0){let i=0,s=[];for(;i+t<=e.size;)s.push(W$(e,i,t)),i+=n;if(r)for(;i<e.size;){let r=i+t-e.size,o=L$([W$(e,i,t-r),tA([r],a)]);s.push(o),i+=n}return 0===s.length?xF([],[0,t]):M$(L$(s),[s.length,t])}}),uM=RE({stft_:function(e,t,n,r,a=oM){null==r&&(r=GF(t));let i=lM(e,t,n),s=s$(i,a(t));return pF(s,r)}}),dM=RE({cropAndResize_:function(e,t,n,r,a="bilinear",i=0){let s=_E(e,"image","cropAndResize"),o=_E(t,"boxes","cropAndResize","float32"),l=_E(n,"boxInd","cropAndResize","int32"),u=o.shape[0];Wk(4===s.rank,(()=>`Error in cropAndResize: image must be rank 4,but got rank ${s.rank}.`)),Wk(2===o.rank&&4===o.shape[1],(()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${o.shape}.`)),Wk(1===l.rank&&l.shape[0]===u,(()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${o.shape}.`)),Wk(2===r.length,(()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`)),Wk(r[0]>=1&&r[1]>=1,(()=>`cropSize must be atleast [1,1], but was ${r}`)),Wk("bilinear"===a||"nearest"===a,(()=>`method must be bilinear or nearest, but was ${a}`));let d={image:s,boxes:o,boxInd:l},c={method:a,extrapolationValue:i,cropSize:r};return yE.runKernel(wI,d,c)}}),cM=RE({flipLeftRight_:function(e){let t=_E(e,"image","flipLeftRight","float32");Wk(4===t.rank,(()=>`Error in flipLeftRight: image must be rank 4,but got rank ${t.rank}.`));let n={image:t};return yE.runKernel(UI,n,{})}}),pM=RE({grayscaleToRGB_:function(e){let t=_E(e,"image","grayscaleToRGB"),n=t.rank-1,r=t.shape[n];Wk(t.rank>=2,(()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${t.rank}.`)),Wk(1===r,(()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`));let a=new Array(t.rank);return a.fill(1,0,n),a[n]=3,rR(t,a)}}),hM=RE({rotateWithOffset_:function(e,t,n=0,r=.5){let a=_E(e,"image","rotateWithOffset","float32");Wk(4===a.rank,(()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${a.rank}.`));let i={image:a},s={radians:t,fillValue:n,center:r};return yE.runKernel(XC,i,s)}});function fM(e,t,n,r,a,i){null==r&&(r=.5),null==a&&(a=Number.NEGATIVE_INFINITY),null==i&&(i=0);let s=e.shape[0];return n=Math.min(n,s),Wk(0<=r&&r<=1,(()=>`iouThreshold must be in [0, 1], but was '${r}'`)),Wk(2===e.rank,(()=>`boxes must be a 2D tensor, but was of rank '${e.rank}'`)),Wk(4===e.shape[1],(()=>`boxes must have 4 columns, but 2nd dimension was ${e.shape[1]}`)),Wk(1===t.rank,(()=>"scores must be a 1D tensor")),Wk(t.shape[0]===s,(()=>`scores has incompatible shape with boxes. Expected ${s}, but was ${t.shape[0]}`)),Wk(0<=i&&i<=1,(()=>`softNmsSigma must be in [0, 1], but was '${i}'`)),{maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:i}}var mM=RE({nonMaxSuppression_:function(e,t,n,r=.5,a=Number.NEGATIVE_INFINITY){let i=_E(e,"boxes","nonMaxSuppression","float32"),s=_E(t,"scores","nonMaxSuppression","float32"),o=fM(i,s,n,r,a),l={maxOutputSize:n=o.maxOutputSize,iouThreshold:r=o.iouThreshold,scoreThreshold:a=o.scoreThreshold};return yE.runKernel(FN,{boxes:i,scores:s},l)}});function gM(e,t,n){let r=function(e,t,n){return function(e,t,n){let r=0,a=e.length,i=0,s=!1;for(;r<a;){i=r+(a-r>>>1);let o=n(t,e[i]);o>0?r=i+1:(a=i,s=!o)}return s?r:-r-1}(e,t,n||bM)}(e,t,n),a=r<0?-(r+1):r;e.splice(a,0,t)}function bM(e,t){return e>t?1:e<t?-1:0}function yM(e,t,n,r,a){return wM(e,t,n,r,a,0)}function vM(e,t,n,r,a,i){return wM(e,t,n,r,a,0,!1,i,!0)}function xM(e,t,n,r,a,i){return wM(e,t,n,r,a,i,!0)}function wM(e,t,n,r,a,i,s=!1,o=!1,l=!1){let u=[];for(let g=0;g<t.length;g++)t[g]>a&&u.push({score:t[g],boxIndex:g,suppressBeginIndex:0});u.sort(IM);let d=i>0?-.5/i:0,c=[],p=[];for(;c.length<n&&u.length>0;){let t=u.pop(),{score:n,boxIndex:i,suppressBeginIndex:s}=t;if(n<a)break;let o=!1;for(let l=c.length-1;l>=s;--l){let n=kM(e,i,c[l]);if(n>=r){o=!0;break}if(t.score=t.score*SM(r,d,n),t.score<=a)break}t.suppressBeginIndex=c.length,o||(t.score===n?(c.push(i),p.push(t.score)):t.score>a&&gM(u,t,IM))}let h=c.length,f=n-h;o&&f>0&&(c.push(...new Array(f).fill(0)),p.push(...new Array(f).fill(0)));let m={selectedIndices:c};return s&&(m.selectedScores=p),l&&(m.validOutputs=h),m}function kM(e,t,n){let r=e.subarray(4*t,4*t+4),a=e.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),o=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),u=Math.min(a[0],a[2]),d=Math.min(a[1],a[3]),c=Math.max(a[0],a[2]),p=Math.max(a[1],a[3]),h=(o-i)*(l-s),f=(c-u)*(p-d);if(h<=0||f<=0)return 0;let m=Math.max(i,u),g=Math.max(s,d),b=Math.min(o,c),y=Math.min(l,p),v=Math.max(b-m,0)*Math.max(y-g,0);return v/(h+f-v)}function SM(e,t,n){let r=Math.exp(t*n*n);return n<=e?r:0}function IM(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}var NM=async function(e,t,n,r=.5,a=Number.NEGATIVE_INFINITY){let i=_E(e,"boxes","nonMaxSuppressionAsync"),s=_E(t,"scores","nonMaxSuppressionAsync"),o=fM(i,s,n,r,a);n=o.maxOutputSize,r=o.iouThreshold,a=o.scoreThreshold;let l=await Promise.all([i.data(),s.data()]),u=l[0],d=l[1],{selectedIndices:c}=yM(u,d,n,r,a);return i!==e&&i.dispose(),s!==t&&s.dispose(),vF(c,"int32")},CM=RE({nonMaxSuppressionWithScore_:function(e,t,n,r=.5,a=Number.NEGATIVE_INFINITY,i=0){let s=_E(e,"boxes","nonMaxSuppression"),o=_E(t,"scores","nonMaxSuppression"),l=fM(s,o,n,r,a,i),u={boxes:s,scores:o},d={maxOutputSize:n=l.maxOutputSize,iouThreshold:r=l.iouThreshold,scoreThreshold:a=l.scoreThreshold,softNmsSigma:i=l.softNmsSigma},c=yE.runKernel(ON,u,d);return{selectedIndices:c[0],selectedScores:c[1]}}}),TM=async function(e,t,n,r=.5,a=Number.NEGATIVE_INFINITY,i=0){let s=_E(e,"boxes","nonMaxSuppressionAsync"),o=_E(t,"scores","nonMaxSuppressionAsync"),l=fM(s,o,n,r,a,i);n=l.maxOutputSize,r=l.iouThreshold,a=l.scoreThreshold,i=l.softNmsSigma;let u=await Promise.all([s.data(),o.data()]),d=u[0],c=u[1],{selectedIndices:p,selectedScores:h}=xM(d,c,n,r,a,i);return s!==e&&s.dispose(),o!==t&&o.dispose(),{selectedIndices:vF(p,"int32"),selectedScores:vF(h)}},EM=RE({nonMaxSuppressionPadded_:function(e,t,n,r=.5,a=Number.NEGATIVE_INFINITY,i=!1){let s=_E(e,"boxes","nonMaxSuppression"),o=_E(t,"scores","nonMaxSuppression"),l=fM(s,o,n,r,a,null),u={boxes:s,scores:o},d={maxOutputSize:l.maxOutputSize,iouThreshold:l.iouThreshold,scoreThreshold:l.scoreThreshold,padToMaxOutputSize:i},c=yE.runKernel(MN,u,d);return{selectedIndices:c[0],validOutputs:c[1]}}}),_M=async function(e,t,n,r=.5,a=Number.NEGATIVE_INFINITY,i=!1){let s=_E(e,"boxes","nonMaxSuppressionAsync"),o=_E(t,"scores","nonMaxSuppressionAsync"),l=fM(s,o,n,r,a,null),u=l.maxOutputSize,d=l.iouThreshold,c=l.scoreThreshold,[p,h]=await Promise.all([s.data(),o.data()]),{selectedIndices:f,validOutputs:m}=vM(p,h,u,d,c,i);return s!==e&&s.dispose(),o!==t&&o.dispose(),{selectedIndices:vF(f,"int32"),validOutputs:qA(m,"int32")}},$M=RE({resizeBilinear_:function(e,t,n=!1,r=!1){let a=_E(e,"images","resizeBilinear");Wk(3===a.rank||4===a.rank,(()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${a.rank}.`)),Wk(2===t.length,(()=>`Error in resizeBilinear: new shape must 2D, but got shape ${t}.`)),Wk(!1===r||!1===n,(()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false."));let i=a,s=!1;3===a.rank&&(s=!0,i=M$(a,[1,a.shape[0],a.shape[1],a.shape[2]]));let o={images:i},l={alignCorners:n,halfPixelCenters:r,size:t},u=yE.runKernel(tC,o,l);return s?M$(u,[u.shape[1],u.shape[2],u.shape[3]]):u}}),AM=RE({resizeNearestNeighbor_:function(e,t,n=!1,r=!1){let a=_E(e,"images","resizeNearestNeighbor");Wk(3===a.rank||4===a.rank,(()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${a.rank}.`)),Wk(2===t.length,(()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${t}.`)),Wk("float32"===a.dtype||"int32"===a.dtype,(()=>"`images` must have `int32` or `float32` as dtype")),Wk(!1===r||!1===n,(()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false."));let i=a,s=!1;3===a.rank&&(s=!0,i=M$(a,[1,a.shape[0],a.shape[1],a.shape[2]]));let o={images:i},l={alignCorners:n,halfPixelCenters:r,size:t},u=yE.runKernel(QN,o,l);return s?M$(u,[u.shape[1],u.shape[2],u.shape[3]]):u}}),RM=RE({threshold_:function(e,t="binary",n=!1,r=.5){let a,i,s,o,l=_E(e,"image","threshold"),u=l.shape[0]*l.shape[1],d=s$(vF([r]),255);if(Wk(3===l.rank,(()=>`Error in threshold: image must be rank 3,but got rank ${l.rank}.`)),Wk(3===l.shape[2]||1===l.shape[2],(()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${l.shape[2]}.`)),Wk("int32"===l.dtype||"float32"===l.dtype,(()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${l.dtype}.`)),Wk("otsu"===t||"binary"===t,(()=>`Method must be binary or otsu, but was ${t}`)),3===l.shape[2]){[a,i,s]=cF(l,[1,1,1],-1);let e=s$(a,.2989),t=s$(i,.587),n=s$(s,.114);o=r$(r$(e,t),n)}else o=e;"otsu"===t&&(d=function(e,t){let n,r,a,i,s,o,l=vF([-1]),u=vF([0]),d=vF([0]);for(let c=0;c<e.size-1;c++){n=W$(e,0,c+1),r=W$(e,c+1),s=i$(YA(n),t),o=i$(YA(r),t);let p=YA(s$(n,zD(0,n.size)));a=i$(p,YA(n));let h=tA(r.shape,n.size),f=r$(zD(0,r.size),h),m=s$(r,f);i=i$(YA(m),YA(r));let g=$R(a,i),b=$R(a,i),y=s$(s,o);d=s$(s$(y,g),b);let v=oR(d,u);u=EA(v,d,u),l=EA(v,vF([c]),l)}return l}(Y$(D_(XD(o),"int32"),ME([]),256),u));let c=n?mR(o,d):oR(o,d);return D_(s$(c,255),"int32")}}),DM=RE({transform_:function(e,t,n="nearest",r="constant",a=0,i){let s=_E(e,"image","transform","float32"),o=_E(t,"transforms","transform","float32");Wk(4===s.rank,(()=>`Error in transform: image must be rank 4,but got rank ${s.rank}.`)),Wk(2===o.rank&&(o.shape[0]===s.shape[0]||1===o.shape[0])&&8===o.shape[1],(()=>"Error in transform: Input transform should be batch x 8 or 1 x 8")),Wk(null==i||2===i.length,(()=>`Error in transform: outputShape must be [height, width] or null, but got ${i}.`));let l={image:s,transforms:o},u={interpolation:n,fillMode:r,fillValue:a,outputShape:i};return yE.runKernel(BC,l,u)}}),FM=RE({bandPart_:function(e,t,n){let r=_E(e,"a","bandPart");Wk(r.rank>=2,(()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`));let a,i,s=r.shape,[o,l]=r.shape.slice(-2);"number"==typeof t?(Wk(t%1==0,(()=>`bandPart(): numLower must be an integer, got ${t}.`)),Wk(t<=o,(()=>`bandPart(): numLower (${t}) must not be greater than the number of rows (${o}).`)),a=_E(t<0?o:t,"numLower","bandPart")):(Wk("int32"===t.dtype,(()=>"bandPart(): numLower's dtype must be an int32.")),a=EA(fR(t,0),o,KR(t,o))),"number"==typeof n?(Wk(n%1==0,(()=>`bandPart(): numUpper must be an integer, got ${n}.`)),Wk(n<=l,(()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${l}).`)),i=_E(n<0?l:n,"numUpper","bandPart")):(Wk("int32"===n.dtype,(()=>"bandPart(): numUpper's dtype must be an int32.")),i=EA(fR(n,0),l,KR(n,l)));let u=M$(zD(0,o,1,"int32"),[-1,1]),d=zD(0,l,1,"int32"),c=$R(u,d),p=DR(mR(c,a),lR(c,TR(i))),h=HR([o,l],r.dtype);return M$(mF(FF(M$(r,[-1,o,l])).map((e=>EA(p,e,h)))),s)}}),MM=RE({gramSchmidt_:function(e){let t;if(Array.isArray(e)){t=!1,Wk(null!=e&&e.length>0,(()=>"Gram-Schmidt process: input must not be null, undefined, or empty"));let n=e[0].shape[0];for(let t=1;t<e.length;++t)Wk(e[t].shape[0]===n,(()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${e[t].shape[0]} vs. ${n})`))}else t=!0,e=cF(e,e.shape[0],0).map((e=>fF(e,[0])));Wk(e.length<=e[0].shape[0],(()=>`Gram-Schmidt: Number of vectors (${e.length}) exceeds number of dimensions (${e[0].shape[0]}).`));let n=[],r=e;for(let a=0;a<e.length;++a)n.push(yE.tidy((()=>{let e=r[a];if(a>0)for(let t=0;t<a;++t){let r=s$(YA(s$(n[t],e)),n[t]);e=$R(e,r)}return i$(e,ZA(e,"euclidean"))})));return t?mF(n,0):n}});function OM(e,t=!1){return yE.tidy((()=>{Wk(2===e.shape.length,(()=>`qr2d() requires a 2D Tensor, but got a ${e.shape.length}D Tensor.`));let n=e.shape[0],r=e.shape[1],a=aR(n),i=F_(e),s=xF([[1]],[1,1]),o=F_(s),l=n>=r?r:n;for(let e=0;e<l;++e){let t=i,l=o,u=a;[o,i,a]=yE.tidy((()=>{let t=W$(i,[e,e],[n-e,1]),l=ZA(t),u=W$(i,[e,e],[1,1]),d=EA(oR(u,0),xF([[-1]]),xF([[1]])),c=$R(u,s$(d,l)),p=i$(t,c);o=1===p.shape[0]?F_(s):L$([s,W$(p,[1,0],[p.shape[0]-1,p.shape[1]])],0);let h=TR(i$(z$(d,c),l)),f=W$(i,[e,0],[n-e,r]),m=s$(h,o),g=BF(o);if(0===e)i=$R(f,z$(m,z$(g,f)));else{let t=$R(f,z$(m,z$(g,f)));i=L$([W$(i,[0,0],[e,r]),t],0)}let b=BF(m),y=W$(a,[0,e],[n,a.shape[1]-e]);if(0===e)a=$R(y,z$(z$(y,o),b));else{let t=$R(y,z$(z$(y,o),b));a=L$([W$(a,[0,0],[n,e]),t],1)}return[o,i,a]})),H_([t,l,u])}return!t&&n>r&&(a=W$(a,[0,0],[n,r]),i=W$(i,[0,0],[r,r])),[a,i]}))}var PM,LM=RE({qr_:function(e,t=!1){if(Wk(e.rank>=2,(()=>`qr() requires input tensor to have a rank >= 2, but got rank ${e.rank}`)),2===e.rank)return OM(e,t);{let n=e.shape.slice(0,e.shape.length-2).reduce(((e,t)=>e*t)),r=FF(M$(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),a=[],i=[];return r.forEach((e=>{let[n,r]=OM(e,t);a.push(n),i.push(r)})),[M$(mF(a,0),e.shape),M$(mF(i,0),e.shape)]}}});!function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(PM||(PM={}));var zM=RE({computeWeightedLoss_:function(e,t,n=PM.SUM_BY_NONZERO_WEIGHTS){let r=_E(e,"losses","computeWeightedLoss"),a=null;null!=t&&(a=_E(t,"weights","computeWeightedLoss"));let i=null==a?r:s$(r,a);if(n===PM.NONE)return i;if(n===PM.SUM)return YA(i);if(n===PM.MEAN){if(null==a)return jR(i);{let e=r.size/a.size,t=i$(YA(i),YA(a));return e>1?i$(t,qA(e)):t}}if(n===PM.SUM_BY_NONZERO_WEIGHTS){if(null==a)return i$(YA(i),qA(r.size));{let e=s$(a,GR(r.shape)),t=D_(YA(eD(e,qA(0))),"float32");return i$(YA(i),t)}}throw Error(`Unknown reduction: ${n}`)}}),BM=RE({absoluteDifference_:function(e,t,n,r=PM.SUM_BY_NONZERO_WEIGHTS){let a=_E(e,"labels","absoluteDifference"),i=_E(t,"predictions","absoluteDifference"),s=null;null!=n&&(s=_E(n,"weights","absoluteDifference")),Vk(a.shape,i.shape,"Error in absoluteDifference: ");let o=o$($R(a,i));return zM(o,s,r)}}),WM=RE({cosineDistance_:function(e,t,n,r,a=PM.SUM_BY_NONZERO_WEIGHTS){let i=_E(e,"labels","cosineDistance"),s=_E(t,"predictions","cosineDistance"),o=null;null!=r&&(o=_E(r,"weights","cosineDistance")),Vk(i.shape,s.shape,"Error in cosineDistance: ");let l=qA(1),u=$R(l,YA(s$(i,s),n,!0));return zM(u,o,a)}}),VM=RE({hingeLoss_:function(e,t,n,r=PM.SUM_BY_NONZERO_WEIGHTS){let a=_E(e,"labels","hingeLoss"),i=_E(t,"predictions","hingeLoss"),s=null;null!=n&&(s=_E(n,"weights","hingeLoss")),Vk(a.shape,i.shape,"Error in hingeLoss: ");let o=qA(1);a=$R(s$(qA(2),a),o);let l=VD($R(o,s$(a,i)));return zM(l,s,r)}}),UM=RE({huberLoss_:function(e,t,n,r=1,a=PM.SUM_BY_NONZERO_WEIGHTS){let i=_E(e,"labels","huberLoss"),s=_E(t,"predictions","huberLoss"),o=null;null!=n&&(o=_E(n,"weights","huberLoss")),Vk(i.shape,s.shape,"Error in huberLoss: ");let l=qA(r),u=o$($R(s,i)),d=KR(u,l),c=$R(u,d),p=r$(s$(qA(.5),XA(d)),s$(l,c));return zM(p,o,a)}}),jM=RE({logLoss_:function(e,t,n,r=1e-7,a=PM.SUM_BY_NONZERO_WEIGHTS){let i=_E(e,"labels","logLoss"),s=_E(t,"predictions","logLoss"),o=null;null!=n&&(o=_E(n,"weights","logLoss")),Vk(i.shape,s.shape,"Error in logLoss: ");let l=qA(1),u=qA(r),d=TR(s$(i,yR(r$(s,u)))),c=s$($R(l,i),yR(r$($R(l,s),u))),p=$R(d,c);return zM(p,o,a)}}),HM=RE({meanSquaredError_:function(e,t,n,r=PM.SUM_BY_NONZERO_WEIGHTS){let a=_E(e,"labels","meanSquaredError"),i=_E(t,"predictions","meanSquaredError"),s=null;null!=n&&(s=_E(n,"weights","meanSquaredError")),Vk(a.shape,i.shape,"Error in meanSquaredError: ");let o=hF(a,i);return zM(o,s,r)}}),GM=RE({sigmoidCrossEntropy_:function(e,t,n,r=0,a=PM.SUM_BY_NONZERO_WEIGHTS){let i=_E(e,"multiClassLabels","sigmoidCrossEntropy"),s=_E(t,"logits","sigmoidCrossEntropy"),o=null;if(null!=n&&(o=_E(n,"weights","sigmoidCrossEntropy")),Vk(i.shape,s.shape,"Error in sigmoidCrossEntropy: "),r>0){let e=qA(r),t=qA(1),n=qA(.5);i=r$(s$(i,$R(t,e)),s$(n,e))}let l=function(e,t){let n=_E(e,"labels","sigmoidCrossEntropyWithLogits"),r=_E(t,"logits","sigmoidCrossEntropyWithLogits");Vk(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");let a=VD(r),i=s$(r,n),s=vR(eR(TR(o$(r))));return r$($R(a,i),s)}(i,s);return zM(l,o,a)}}),qM=RE({softmaxCrossEntropy_:function(e,t,n,r=0,a=PM.SUM_BY_NONZERO_WEIGHTS){let i=_E(e,"onehotLabels","softmaxCrossEntropy"),s=_E(t,"logits","softmaxCrossEntropy"),o=null;if(null!=n&&(o=_E(n,"weights","softmaxCrossEntropy")),Vk(i.shape,s.shape,"Error in softmaxCrossEntropy: "),r>0){let e=qA(r),t=qA(1),n=qA(i.shape[1]);i=r$(s$(i,$R(t,e)),i$(e,n))}let l=function(e,t,n=-1){if(-1===n&&(n=t.rank-1),n!==t.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${t.rank} and dim was ${n}`);return NR(((e,t,r)=>{let a=RR(t,[n],!0),i=$R(D_(t,"float32"),a);r([e,i]);let s=TR(s$(i,e));return{value:YA(s,[n]),gradFunc:(e,t)=>{let[r,a]=t,i=zA(e.shape,[n]);return[s$(M$(e,i),$R(D_(r,"float32"),eR(a))),s$(M$(e,i),$R(eR(a),D_(r,"float32")))]}}}))(e,t)}(i,s);return zM(l,o,a)}}),KM=RE({sparseFillEmptyRows_:function(e,t,n,r){let a=_E(e,"indices","sparseFillEmptyRows","int32"),i=_E(t,"values","sparseFillEmptyRows"),s=_E(n,"denseShape","sparseFillEmptyRows","int32"),o=_E(r,"defaultValue","sparseFillEmptyRows",i.dtype);if(2!==a.rank)throw new Error(`Indices should be Tensor2D but received shape\n        ${a.shape}`);if(1!==i.rank)throw new Error(`Values should be Tensor1D but received shape ${i.shape}`);if(1!==s.rank)throw new Error(`Dense shape should be Tensor1D but received shape ${s.shape}`);if(0!==o.rank)throw new Error(`Default value should be a scalar but received shape ${o.shape}`);let l={indices:a,values:i,denseShape:s,defaultValue:o},u=yE.runKernel(SC,l);return{outputIndices:u[0],outputValues:u[1],emptyRowIndicator:u[2],reverseIndexMap:u[3]}}}),XM=RE({sparseReshape_:function(e,t,n){let r=_E(e,"inputIndices","sparseReshape","int32"),a=_E(t,"inputShape","sparseReshape","int32"),i=_E(n,"newShape","sparseReshape","int32");if(2!==r.rank)throw new Error(`Input indices should be Tensor2D but received shape\n        ${r.shape}`);if(1!==a.rank)throw new Error(`Input shape should be Tensor1D but received shape ${a.shape}`);if(1!==i.rank)throw new Error(`New shape should be Tensor1D but received shape ${i.shape}`);let s={inputIndices:r,inputShape:a,newShape:i},o=yE.runKernel(IC,s);return{outputIndices:o[0],outputShape:o[1]}}}),YM=RE({sparseSegmentMean_:function(e,t,n){let r=_E(e,"data","sparseSegmentMean"),a=_E(t,"indices","sparseSegmentMean","int32"),i=_E(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.rank)throw new Error(`Indices should be Tensor1D but received shape\n          ${a.shape}`);if(1!==i.rank)throw new Error(`Segment ids should be Tensor1D but received shape\n          ${i.shape}`);let s={data:r,indices:a,segmentIds:i};return yE.runKernel(NC,s)}}),JM=RE({sparseSegmentSum_:function(e,t,n){let r=_E(e,"data","sparseSegmentSum"),a=_E(t,"indices","sparseSegmentSum","int32"),i=_E(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.rank)throw new Error(`Indices should be Tensor1D but received shape\n         ${a.shape}`);if(1!==i.rank)throw new Error(`Segment ids should be Tensor1D but received shape\n         ${i.shape}`);let s={data:r,indices:a,segmentIds:i};return yE.runKernel(CC,s)}}),ZM=RE({stringNGrams_:function(e,t,n,r,a,i,s,o){let l=_E(e,"data","stringNGrams","string");if("string"!==l.dtype)throw new Error("Data must be of datatype string");if(1!==l.shape.length)throw new Error(`Data must be a vector, saw: ${l.shape}`);let u=_E(t,"dataSplits","stringNGrams");if("int32"!==u.dtype)throw new Error("Data splits must be of datatype int32");let d={separator:n,nGramWidths:r,leftPad:a,rightPad:i,padWidth:s,preserveShortSequences:o},c={data:l,dataSplits:u},p=yE.runKernel(RC,c,d);return{nGrams:p[0],nGramsSplits:p[1]}}}),QM=RE({stringSplit_:function(e,t,n=!0){let r=_E(e,"input","stringSplit","string"),a=_E(t,"delimiter","stringSplit","string");if(1!==r.rank)throw new Error(`Input should be Tensor1D but received shape ${r.shape}`);if(0!==a.rank)throw new Error(`Delimiter should be a scalar but received shape ${a.shape}`);let i={skipEmpty:n},s={input:r,delimiter:a},o=yE.runKernel(DC,s,i);return{indices:o[0],values:o[1],shape:o[2]}}}),eO=RE({stringToHashBucketFast_:function(e,t){let n=_E(e,"input","stringToHashBucketFast","string"),r={numBuckets:t};if(t<=0)throw new Error("Number of buckets must be at least 1");let a={input:n};return yE.runKernel(FC,a,r)}}),tO=RE({staticRegexReplace_:function(e,t,n,r=!0){let a=_E(e,"input","staticRegexReplace","string"),i={pattern:t,rewrite:n,replaceGlobal:r};return yE.runKernel($C,{x:a},i)}}),nO={fft:lF,ifft:uF,rfft:pF,irfft:dF},rO={hammingWindow:sM,hannWindow:oM,frame:lM,stft:uM},aO={flipLeftRight:cM,grayscaleToRGB:pM,resizeNearestNeighbor:AM,resizeBilinear:$M,rotateWithOffset:hM,cropAndResize:dM,nonMaxSuppression:mM,nonMaxSuppressionAsync:NM,nonMaxSuppressionWithScore:CM,nonMaxSuppressionWithScoreAsync:TM,nonMaxSuppressionPadded:EM,nonMaxSuppressionPaddedAsync:_M,threshold:RM,transform:DM},iO={bandPart:FM,gramSchmidt:MM,qr:LM},sO={absoluteDifference:BM,computeWeightedLoss:zM,cosineDistance:WM,hingeLoss:VM,huberLoss:UM,logLoss:jM,meanSquaredError:HM,sigmoidCrossEntropy:GM,softmaxCrossEntropy:qM},oO={sparseFillEmptyRows:KM,sparseReshape:XM,sparseSegmentMean:YM,sparseSegmentSum:JM},lO={stringNGrams:ZM,stringSplit:QM,stringToHashBucketFast:eO,staticRegexReplace:tO},uO={};ok(uO,{Serializable:()=>dO,SerializationMap:()=>cO,registerClass:()=>pO});var dO=class{getClassName(){return this.constructor.className}static fromConfig(e,t){return new e(t)}},cO=class{constructor(){this.classNameMap={}}static getMap(){return null==cO.instance&&(cO.instance=new cO),cO.instance}static register(e){cO.getMap().classNameMap[e.className]=[e,e.fromConfig]}};function pO(e){Wk(null!=e.className,(()=>"Class being registered does not have the static className property defined.")),Wk("string"==typeof e.className,(()=>"className is required to be a string, but got type "+typeof e.className)),Wk(e.className.length>0,(()=>"Class being registered has an empty-string as its className, which is disallowed.")),cO.register(e)}var hO=class extends dO{minimize(e,t=!1,n){let{value:r,grads:a}=this.computeGradients(e,n);if(null!=n){let e=n.map((e=>({name:e.name,tensor:a[e.name]})));this.applyGradients(e)}else this.applyGradients(a);return H_(a),t?r:(r.dispose(),null)}get iterations(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,t){return IR(e,t)}dispose(){null!=this.iterations_&&H_(this.iterations_)}async saveIterations(){return null==this.iterations_&&(this.iterations_=0),{name:"iter",tensor:qA(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}};Object.defineProperty(hO,Symbol.hasInstance,{value:e=>null!=e.minimize&&null!=e.computeGradients&&null!=e.applyGradients});var fO=class extends hO{static get className(){return"Adadelta"}constructor(e,t,n=null){super(),this.learningRate=e,this.rho=t,this.epsilon=n,this.accumulatedGrads=[],this.accumulatedUpdates=[],null==n&&(this.epsilon=yE.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map((e=>e.name)):Object.keys(e)).forEach(((t,n)=>{let r=yE.registeredVariables[t];null==this.accumulatedGrads[n]&&(this.accumulatedGrads[n]={originalName:`${t}/accum_grad`,variable:j_((()=>_A(r).variable(!1)))}),null==this.accumulatedUpdates[n]&&(this.accumulatedUpdates[n]={originalName:`${t}/accum_var`,variable:j_((()=>_A(r).variable(!1)))});let a=Array.isArray(e)?e[n].tensor:e[t];if(null==a)return;let i=this.accumulatedGrads[n].variable,s=this.accumulatedUpdates[n].variable;j_((()=>{let e=r$(s$(i,this.rho),s$(XA(a),1-this.rho)),t=s$(i$(KA(r$(s,this.epsilon)),KA(r$(i,this.epsilon))),a),n=r$(s$(s,this.rho),s$(XA(t),1-this.rho));i.assign(e),s.assign(n);let o=r$(s$(t,-this.learningRate),r);r.assign(o)}))})),this.incrementIterations()}dispose(){null!=this.accumulatedUpdates&&(H_(this.accumulatedGrads.map((e=>e.variable))),H_(this.accumulatedUpdates.map((e=>e.variable))))}async getWeights(){let e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map((e=>({name:e.originalName,tensor:e.variable}))))}async setWeights(e){let t=(e=await this.extractIterations(e)).length/2;this.accumulatedGrads=e.slice(0,t).map((e=>({originalName:e.name,variable:e.tensor.variable(!1)}))),this.accumulatedUpdates=e.slice(t,2*t).map((e=>({originalName:e.name,variable:e.tensor.variable(!1)})))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.rho,t.epsilon)}},mO=class extends hO{static get className(){return"Adagrad"}constructor(e,t=.1){super(),this.learningRate=e,this.initialAccumulatorValue=t,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map((e=>e.name)):Object.keys(e)).forEach(((t,n)=>{let r=yE.registeredVariables[t];null==this.accumulatedGrads[n]&&(this.accumulatedGrads[n]={originalName:`${t}/accumulator`,variable:j_((()=>tA(r.shape,this.initialAccumulatorValue).variable(!1)))});let a=Array.isArray(e)?e[n].tensor:e[t];if(null==a)return;let i=this.accumulatedGrads[n].variable;j_((()=>{let e=r$(i,XA(a));i.assign(e);let t=r$(s$(i$(a,KA(r$(e,yE.backend.epsilon()))),-this.learningRate),r);r.assign(t)}))})),this.incrementIterations()}dispose(){null!=this.accumulatedGrads&&H_(this.accumulatedGrads.map((e=>e.variable)))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map((e=>({name:e.originalName,tensor:e.variable}))))}async setWeights(e){e=await this.extractIterations(e),this.accumulatedGrads=e.map((e=>({originalName:e.name,variable:e.tensor.variable(!1)})))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}},gO=class extends hO{static get className(){return"Adam"}constructor(e,t,n,r=null){super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],j_((()=>{this.accBeta1=qA(t).variable(),this.accBeta2=qA(n).variable()})),null==r&&(this.epsilon=yE.backend.epsilon())}applyGradients(e){let t=Array.isArray(e)?e.map((e=>e.name)):Object.keys(e);j_((()=>{let n=$R(1,this.accBeta1),r=$R(1,this.accBeta2);t.forEach(((t,a)=>{let i=yE.registeredVariables[t];null==this.accumulatedFirstMoment[a]&&(this.accumulatedFirstMoment[a]={originalName:`${t}/m`,variable:j_((()=>_A(i).variable(!1)))}),null==this.accumulatedSecondMoment[a]&&(this.accumulatedSecondMoment[a]={originalName:`${t}/v`,variable:j_((()=>_A(i).variable(!1)))});let s=Array.isArray(e)?e[a].tensor:e[t];if(null==s)return;let o=this.accumulatedFirstMoment[a].variable,l=this.accumulatedSecondMoment[a].variable,u=r$(s$(o,this.beta1),s$(s,1-this.beta1)),d=r$(s$(l,this.beta2),s$(XA(s),1-this.beta2)),c=i$(u,n),p=i$(d,r);o.assign(u),l.assign(d);let h=r$(s$(i$(c,r$(KA(p),this.epsilon)),-this.learningRate),i);i.assign(h)})),this.accBeta1.assign(s$(this.accBeta1,this.beta1)),this.accBeta2.assign(s$(this.accBeta2,this.beta2))})),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&H_(this.accumulatedFirstMoment.map((e=>e.variable))),null!=this.accumulatedSecondMoment&&H_(this.accumulatedSecondMoment.map((e=>e.variable)))}async getWeights(){let e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map((e=>({name:e.originalName,tensor:e.variable}))))}async setWeights(e){e=await this.extractIterations(e),j_((()=>{this.accBeta1.assign(GA(this.beta1,this.iterations_+1)),this.accBeta2.assign(GA(this.beta2,this.iterations_+1))}));let t=e.length/2;this.accumulatedFirstMoment=e.slice(0,t).map((e=>({originalName:e.name,variable:e.tensor.variable(!1)}))),this.accumulatedSecondMoment=e.slice(t,2*t).map((e=>({originalName:e.name,variable:e.tensor.variable(!1)})))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}},bO=class extends hO{static get className(){return"Adamax"}constructor(e,t,n,r=null,a=0){super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=r,this.decay=a,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],j_((()=>{this.iteration=qA(0).variable(),this.accBeta1=qA(t).variable()})),null==r&&(this.epsilon=yE.backend.epsilon())}applyGradients(e){let t=Array.isArray(e)?e.map((e=>e.name)):Object.keys(e);j_((()=>{let n=$R(1,this.accBeta1),r=i$(-this.learningRate,r$(s$(this.iteration,this.decay),1));t.forEach(((t,a)=>{let i=yE.registeredVariables[t];null==this.accumulatedFirstMoment[a]&&(this.accumulatedFirstMoment[a]={originalName:`${t}/m`,variable:_A(i).variable(!1)}),null==this.accumulatedWeightedInfNorm[a]&&(this.accumulatedWeightedInfNorm[a]={originalName:`${t}/v`,variable:_A(i).variable(!1)});let s=Array.isArray(e)?e[a].tensor:e[t];if(null==s)return;let o=this.accumulatedFirstMoment[a].variable,l=this.accumulatedWeightedInfNorm[a].variable,u=r$(s$(o,this.beta1),s$(s,1-this.beta1)),d=s$(l,this.beta2),c=o$(s),p=UR(d,c);o.assign(u),l.assign(p);let h=r$(s$(i$(r,n),i$(u,r$(p,this.epsilon))),i);i.assign(h)})),this.iteration.assign(r$(this.iteration,1)),this.accBeta1.assign(s$(this.accBeta1,this.beta1))})),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&H_(this.accumulatedFirstMoment.map((e=>e.variable))),null!=this.accumulatedWeightedInfNorm&&H_(this.accumulatedWeightedInfNorm.map((e=>e.variable)))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}},yO=class extends hO{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map((e=>e.name)):Object.keys(e)).forEach(((t,n)=>{let r=Array.isArray(e)?e[n].tensor:e[t];if(null==r)return;let a=yE.registeredVariables[t];j_((()=>{let e=r$(s$(this.c,r),a);a.assign(e)}))})),this.incrementIterations()}setLearningRate(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=G_(qA(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(0!==(e=await this.extractIterations(e)).length)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,t){return new e(t.learningRate)}},vO=class extends yO{static get className(){return"Momentum"}constructor(e,t,n=!1){super(e),this.learningRate=e,this.momentum=t,this.useNesterov=n,this.accumulations=[],this.m=qA(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map((e=>e.name)):Object.keys(e)).forEach(((t,n)=>{let r=yE.registeredVariables[t];null==this.accumulations[n]&&(this.accumulations[n]={originalName:`${t}/momentum`,variable:j_((()=>_A(r).variable(!1)))});let a=this.accumulations[n].variable,i=Array.isArray(e)?e[n].tensor:e[t];null!=i&&j_((()=>{let e,t=r$(s$(this.m,a),i);e=this.useNesterov?r$(s$(this.c,r$(i,s$(t,this.m))),r):r$(s$(this.c,t),r),a.assign(t),r.assign(e)}))})),this.incrementIterations()}dispose(){this.m.dispose(),null!=this.accumulations&&H_(this.accumulations.map((e=>e.variable)))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map((e=>({name:e.originalName,tensor:e.variable}))))}async setWeights(e){e=await this.extractIterations(e),this.accumulations=e.map((e=>({originalName:e.name,variable:e.tensor.variable(!1)})))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}},xO=class extends hO{static get className(){return"RMSProp"}constructor(e,t=.9,n=0,r=null,a=!1){if(super(),this.learningRate=e,this.decay=t,this.momentum=n,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=a,null==r&&(this.epsilon=yE.backend.epsilon()),null==e)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map((e=>e.name)):Object.keys(e)).forEach(((t,n)=>{let r=yE.registeredVariables[t],a=!1;null==this.accumulatedMeanSquares[n]&&(this.accumulatedMeanSquares[n]={originalName:`${t}/rms`,variable:j_((()=>_A(r).variable(a)))}),null==this.accumulatedMoments[n]&&(this.accumulatedMoments[n]={originalName:`${t}/momentum`,variable:j_((()=>_A(r).variable(a)))}),null==this.accumulatedMeanGrads[n]&&this.centered&&(this.accumulatedMeanGrads[n]={originalName:`${t}/mg`,variable:j_((()=>_A(r).variable(a)))});let i=Array.isArray(e)?e[n].tensor:e[t];if(null==i)return;let s=this.accumulatedMeanSquares[n].variable,o=this.accumulatedMoments[n].variable;j_((()=>{let e=r$(s$(s,this.decay),s$(XA(i),1-this.decay));if(this.centered){let t=this.accumulatedMeanGrads[n].variable,a=r$(s$(t,this.decay),s$(i,1-this.decay)),l=i$(s$(i,this.learningRate),KA($R(e,r$(XA(a),this.epsilon)))),u=r$(s$(o,this.momentum),l);s.assign(e),t.assign(a),o.assign(u);let d=$R(r,u);r.assign(d)}else{let e=r$(s$(s,this.decay),s$(XA(i),1-this.decay)),t=r$(s$(o,this.momentum),i$(s$(i,this.learningRate),KA(r$(e,this.epsilon))));s.assign(e),o.assign(t);let n=$R(r,t);r.assign(n)}}))})),this.incrementIterations()}dispose(){null!=this.accumulatedMeanSquares&&H_(this.accumulatedMeanSquares.map((e=>e.variable))),null!=this.accumulatedMeanGrads&&this.centered&&H_(this.accumulatedMeanGrads.map((e=>e.variable))),null!=this.accumulatedMoments&&H_(this.accumulatedMoments.map((e=>e.variable)))}async getWeights(){let e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map((e=>({name:e.originalName,tensor:e.variable}))))}async setWeights(e){e=await this.extractIterations(e);let t=this.centered?e.length/3:e.length/2,n=!1;this.accumulatedMeanSquares=e.slice(0,t).map((e=>({originalName:e.name,variable:e.tensor.variable(n)}))),this.accumulatedMoments=e.slice(t,2*t).map((e=>({originalName:e.name,variable:e.tensor.variable(n)}))),this.centered&&(this.accumulatedMeanGrads=e.slice(2*t,3*t).map((e=>({originalName:e.name,variable:e.tensor.variable(n)}))))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}},wO=[fO,mO,gO,bO,vO,xO,yO],kO={};function SO(e){return new Promise((e=>setTimeout(e))).then(e)}ok(kO,{CompositeArrayBuffer:()=>PE,browserFiles:()=>CO,browserHTTPRequest:()=>MO,concatenateArrayBuffers:()=>jE,copyModel:()=>E_,decodeWeights:()=>BE,encodeWeights:()=>zE,fromMemory:()=>zO,fromMemorySync:()=>BO,getLoadHandlers:()=>n_,getModelArtifactsForJSON:()=>KE,getModelArtifactsForJSONSync:()=>qE,getModelArtifactsInfoForJSON:()=>XE,getSaveHandlers:()=>t_,getWeightSpecs:()=>YE,http:()=>FO,isHTTPScheme:()=>RO,listModels:()=>C_,loadWeights:()=>_O,moveModel:()=>__,registerLoadRouter:()=>e_,registerSaveRouter:()=>QE,removeModel:()=>T_,weightsLoaderFactory:()=>$O,withSaveHandler:()=>WO,withSaveHandlerSync:()=>VO});var IO=class{constructor(e){if(!$S().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(IO.URL_SCHEME)&&(e=e.slice(IO.URL_SCHEME.length)),(null==e||0===e.length)&&(e="model"),this.modelJsonFileName=e+".json",this.weightDataFileName=e+".weights.bin"}async save(e){if("undefined"==typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");let t=PE.join(e.weightData),n=window.URL.createObjectURL(new Blob([t],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{let t=GE(e,[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}]),r=window.URL.createObjectURL(new Blob([JSON.stringify(t)],{type:"application/json"})),a=null==this.modelJsonAnchor?document.createElement("a"):this.modelJsonAnchor;if(a.download=this.modelJsonFileName,a.href=r,await SO((()=>a.dispatchEvent(new MouseEvent("click")))),null!=e.weightData){let e=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor;e.download=this.weightDataFileName,e.href=n,await SO((()=>e.dispatchEvent(new MouseEvent("click"))))}return{modelArtifactsInfo:XE(e)}}}};IO.URL_SCHEME="downloads://";var NO=class{constructor(e){if(null==e||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise(((e,t)=>{let n=new FileReader;n.onload=n=>{let r=JSON.parse(n.target.result),a=r.modelTopology;if(null==a)return void t(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));if(null==r.weightsManifest)return void t(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));if(0===this.weightsFiles.length)return void e({modelTopology:a});let i=KE(r,(e=>this.loadWeights(e)));e(i)},n.onerror=e=>t(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),n.readAsText(this.jsonFile)}))}loadWeights(e){let t=[],n=[];for(let i of e)t.push(...i.weights),n.push(...i.paths);let r=this.checkManifestAndWeightFiles(e),a=n.map((e=>this.loadWeightsFile(e,r[e])));return Promise.all(a).then((e=>[t,e]))}loadWeightsFile(e,t){return new Promise(((n,r)=>{let a=new FileReader;a.onload=e=>{let t=e.target.result;n(t)},a.onerror=t=>r(`Failed to weights data from file of path '${e}'.`),a.readAsArrayBuffer(t)}))}checkManifestAndWeightFiles(e){let t=[],n=this.weightsFiles.map((e=>HE(e.name))),r={};for(let a of e)a.paths.forEach((e=>{let a=HE(e);if(-1!==t.indexOf(a))throw new Error(`Duplicate file basename found in weights manifest: '${a}'`);if(t.push(a),-1===n.indexOf(a))throw new Error(`Weight file with basename '${a}' is not provided.`);r[e]=this.weightsFiles[n.indexOf(a)]}));if(t.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${t.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return r}};function CO(e){return new NO(e)}function TO(e,t,n,r){(function(e){Wk(null!=e&&Array.isArray(e)&&e.length>0,(()=>"promises must be a none empty array"))})(e),function(e,t){Wk(e>=0&&e<=1,(()=>`Progress fraction must be in range [0, 1], but got startFraction ${e}`)),Wk(t>=0&&t<=1,(()=>`Progress fraction must be in range [0, 1], but got endFraction ${t}`)),Wk(t>=e,(()=>`startFraction must be no more than endFraction, but got startFraction ${e} and endFraction ${t}`))}(n=null==n?0:n,r=null==r?1:r);let a=0;return Promise.all(e.map((i=>(i.then((i=>{let s=n+ ++a/e.length*(r-n);return t(s),i})),i))))}async function EO(e,t){null==t&&(t={});let n=null==t.fetchFunc?$S().platform.fetch:t.fetchFunc,r=e.map((e=>n(e,t.requestInit,{isBinary:!0}))),a=(null==t.onProgress?await Promise.all(r):await TO(r,t.onProgress,0,.5)).map((e=>e.arrayBuffer()));return null==t.onProgress?await Promise.all(a):await TO(a,t.onProgress,.5,1)}async function _O(e,t="",n,r){return $O((e=>EO(e,{requestInit:r})))(e,t,n)}function $O(e){return async(t,n="",r)=>{let a=t.map((()=>!1)),i={},s=null!=r?r.map((()=>!1)):[],o=[];if(t.forEach(((e,t)=>{let n=0;e.weights.forEach((e=>{let l="quantization"in e?e.quantization.dtype:e.dtype,u=OE[l]*jk(e.shape),d=()=>{a[t]=!0,null==i[t]&&(i[t]=[]),i[t].push({manifestEntry:e,groupOffset:n,sizeBytes:u})};null!=r?r.forEach(((t,n)=>{t===e.name&&(d(),s[n]=!0)})):d(),o.push(e.name),n+=u}))})),!s.every((e=>e))){let e=r.filter(((e,t)=>!s[t]));throw new Error(`Could not find weights in manifest with names: ${e.join(", ")}. \nManifest JSON has weights with names: ${o.join(", ")}.`)}let l=a.reduce(((e,t,n)=>(t&&e.push(n),e)),[]),u=[];l.forEach((e=>{t[e].paths.forEach((e=>{let t=n+(n.endsWith("/")?"":"/")+e;u.push(t)}))}));let d=await e(u),c={},p=0;return l.forEach((e=>{let n=t[e].paths.length,r=new PE(d.slice(p,p+n));i[e].forEach((e=>{let t=BE(r.slice(e.groupOffset,e.groupOffset+e.sizeBytes),[e.manifestEntry]);for(let n in t)c[n]=t[n]})),p+=n})),c}}ZE.registerSaveRouter((e=>$S().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(IO.URL_SCHEME)?function(e="model"){return new IO(e)}(e.slice(IO.URL_SCHEME.length)):null));var AO=class{constructor(e,t){if(this.DEFAULT_METHOD="POST",null==t&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.onProgress=t.onProgress,this.weightUrlConverter=t.weightUrlConverter,null!=t.fetchFunc?(Wk("function"==typeof t.fetchFunc,(()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)")),this.fetch=t.fetchFunc):this.fetch=$S().platform.fetch,Wk(null!=e&&e.length>0,(()=>"URL path for http must not be null, undefined or empty.")),Array.isArray(e)&&Wk(2===e.length,(()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`)),this.path=e,null!=t.requestInit&&null!=t.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{}}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");let t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;let n=GE(e,[{paths:["./model.weights.bin"],weights:e.weightSpecs}]);if(t.body.append("model.json",new Blob([JSON.stringify(n)],{type:"application/json"}),"model.json"),null!=e.weightData){let n=PE.join(e.weightData);t.body.append("model.weights.bin",new Blob([n],{type:"application/octet-stream"}),"model.weights.bin")}let r=await this.fetch(this.path,t);if(r.ok)return{modelArtifactsInfo:XE(e),responses:[r]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${r.status}.`)}async load(){let e,t=await this.fetch(this.path,this.requestInit);if(!t.ok)throw new Error(`Request to ${this.path} failed with status code ${t.status}. Please verify this URL points to the model JSON of the model to load.`);try{e=await t.json()}catch(Rp){let t=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?t+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":t+=" Please make sure the server is serving valid JSON for this request.",new Error(t)}let n=e.modelTopology,r=e.weightsManifest;if(null==n&&null==r)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return KE(e,(e=>this.loadWeights(e)))}async loadWeights(e){let t=Array.isArray(this.path)?this.path[1]:this.path,[n,r]=function(e){let t=e.lastIndexOf("/"),n=e.lastIndexOf("?"),r=e.substring(0,t),a=n>t?e.substring(n):"";return[r+"/",a]}(t),a=this.weightPathPrefix||n,i=YE(e),s=[],o=[];for(let l of e)for(let e of l.paths)null!=this.weightUrlConverter?o.push(this.weightUrlConverter(e)):s.push(a+e+r);return this.weightUrlConverter&&s.push(...await Promise.all(o)),[i,await EO(s,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})]}};function RO(e){return null!=e.match(AO.URL_SCHEME_REGEX)}AO.URL_SCHEME_REGEX=/^https?:\/\//;var DO=(e,t)=>{if("undefined"==typeof fetch&&(null==t||null==t.fetchFunc))return null;{let n=!0;if(n=Array.isArray(e)?e.every((e=>RO(e))):RO(e),n)return FO(e,t)}return null};function FO(e,t){return new AO(e,t)}function MO(e,t){return FO(e,t)}ZE.registerSaveRouter(DO),ZE.registerLoadRouter(DO);var OO=class{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}},PO=class{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}},LO=class{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=t=>Promise.resolve(e.save(t)))}};function zO(e,t,n,r){return new LO(BO(...arguments))}function BO(e,t,n,r){return 1===arguments.length?null!=e.modelTopology||null!=e.weightSpecs?new OO(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new OO({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new OO({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r}))}function WO(e){return new PO(e)}function VO(e){return new PO(e)}var UO={};ok(UO,{confusionMatrix:()=>jO});var jO=RE({confusionMatrix_:function(e,t,n){let r=_E(e,"labels","confusionMatrix"),a=_E(t,"predictions","confusionMatrix");Wk(null==n||n>0&&Number.isInteger(n),(()=>`If provided, numClasses must be a positive integer, but got ${n}`)),Wk(1===r.rank,(()=>`Expected the rank of labels to be 1, but got ${r.rank}`)),Wk(1===a.rank,(()=>`Expected the rank of predictions to be 1, but got ${a.rank}`)),Wk(r.shape[0]===a.shape[0],(()=>`Mismatch in the number of examples: ${r.shape[0]} vs. ${a.shape[0]}. Labels and predictions should have the same number of elements.`)),Wk(n>0&&Number.isInteger(n),(()=>`numClasses is required to be a positive integer, but got ${n}`));let i=tD(D_(r,"int32"),n),s=tD(D_(a,"int32"),n),o=BF(i),l=z$(o,s);return D_(l,"int32")}}),HO={};ok(HO,{draw:()=>QO,fromPixels:()=>eP,fromPixelsAsync:()=>YO,toPixels:()=>ZO});var GO,qO=!1;function KO(e,t=3){if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==e)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,r=!1,a=!1,i=!1,s=!1,o=!1;if(e.data instanceof Uint8Array)n=!0;else if("undefined"!=typeof ImageData&&e instanceof ImageData)r=!0;else if("undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement)a=!0;else if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement)i=!0;else if(null!=e.getContext)s=!0;else{if(!("undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap))throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${e.constructor.name}`);o=!0}if(null!=rT(KC,yE.backendName)){let n={pixels:e},r={numChannels:t};return yE.runKernel(KC,n,r)}let l,u,[d,c]=a?[e.videoWidth,e.videoHeight]:[e.width,e.height];if(s)l=e.getContext("2d").getImageData(0,0,d,c).data;else if(r||n)l=e.data;else if(i||a||o){if(null==GO)if("undefined"==typeof document){if("undefined"==typeof OffscreenCanvas||"undefined"==typeof OffscreenCanvasRenderingContext2D)throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");GO=new OffscreenCanvas(1,1).getContext("2d")}else GO=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});GO.canvas.width=d,GO.canvas.height=c,GO.drawImage(e,0,0,d,c),l=GO.getImageData(0,0,d,c).data}if(4===t)u=new Int32Array(l);else{let e=d*c;u=new Int32Array(e*t);for(let n=0;n<e;n++)for(let e=0;e<t;++e)u[n*t+e]=l[4*n+e]}return wF(u,[c,d,t],"int32")}function XO(e){return"undefined"!=typeof window&&"undefined"!=typeof ImageBitmap&&window.hasOwnProperty("createImageBitmap")&&!(e instanceof ImageBitmap)&&function(e){return null!=e&&0!==e.width&&0!==e.height}(e)&&!function(e){return null!=e&&e.data instanceof Uint8Array}(e)}async function YO(e,t=3){let n=null;if($S().getBool("WRAP_TO_IMAGEBITMAP")&&XO(e)){let t;try{t=await createImageBitmap(e,{premultiplyAlpha:"none"})}catch(Rp){t=null}n=null!=t&&t.width===e.width&&t.height===e.height?t:e}else n=e;return KO(n,t)}function JO(e){if(2!==e.rank&&3!==e.rank)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${e.rank}.`);let t=2===e.rank?1:e.shape[2];if(t>4||2===t)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${t}`);if("float32"!==e.dtype&&"int32"!==e.dtype)throw new Error(`Unsupported type for toPixels: ${e.dtype}. Please use float32 or int32 tensors.`)}async function ZO(e,t){let n=_E(e,"img","toPixels");if(!(e instanceof XT)){let e=n;n=D_(e,"int32"),e.dispose()}JO(n);let[r,a]=n.shape.slice(0,2),i=2===n.rank?1:n.shape[2],s=await n.data(),o="float32"===n.dtype?255:1,l=new Uint8ClampedArray(a*r*4);for(let u=0;u<r*a;++u){let e=[0,0,0,255];for(let r=0;r<i;r++){let t=s[u*i+r];if("float32"===n.dtype){if(t<0||t>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${t}.`)}else if("int32"===n.dtype&&(t<0||t>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${t}.`);1===i?(e[0]=t*o,e[1]=t*o,e[2]=t*o):e[r]=t*o}let t=4*u;l[t+0]=Math.round(e[0]),l[t+1]=Math.round(e[1]),l[t+2]=Math.round(e[2]),l[t+3]=Math.round(e[3])}if(null!=t){qO||(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),qO=!0),t.width=a,t.height=r;let e=t.getContext("2d"),n=new ImageData(l,a,r);e.putImageData(n,0,0)}return n!==e&&n.dispose(),l}function QO(e,t,n){let r=_E(e,"img","draw");if(!(e instanceof XT)){let e=r;r=D_(e,"int32"),e.dispose()}JO(r),function(e){let t=(null==e?void 0:e.alpha)||1;if(t>1||t<0)throw new Error(`Alpha value ${t} is suppoed to be in range [0 - 1].`)}(null==n?void 0:n.imageOptions);let a={image:r},i={canvas:t,options:n};yE.runKernel(AI,a,i)}var eP=RE({fromPixels_:KO}),tP={};function nP(e,t){let n=e.shape.length,r=t.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if("int32"!==t.dtype)throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.shape[r-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${t.shape[r-1]} vs. ${n}`);if(0===jk(e.shape))throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${e.shape}.`);let a=t.shape,i=a[a.length-1],s=1;for(let c=0;c<a.length-1;++c)s*=a[c];let o=e.shape,l=a.slice();l.pop();let u=1;for(let c=i;c<n;++c)u*=o[c],l.push(o[c]);let d=[...gS(e.shape).map((e=>e/u)),1].slice(0,i);return[l,s,u,d]}ok(tP,{prepareAndValidate:()=>nP});var rP={};ok(rP,{assertParamsValid:()=>sP,computeFlatOffset:()=>vP,computeOutShape:()=>lP,getNormalizedAxes:()=>pP,isSliceContinous:()=>yP,maskToAxes:()=>oP,parseSliceParams:()=>xP,sliceInfo:()=>wP,startForAxis:()=>gP,startIndicesWithElidedDims:()=>hP,stopForAxis:()=>bP,stopIndicesWithElidedDims:()=>fP,stridesForAxis:()=>mP,stridesWithElidedDims:()=>uP});var aP=-2,iP=-1;function sP(e,t,n){let r=e.shape.length;Wk(r===t.length,(()=>`Error in slice${r}D: Length of begin ${t} must match the rank of the array (${r}).`)),Wk(r===n.length,(()=>`Error in slice${r}D: Length of size ${n} must match the rank of the array (${r}).`));for(let a=0;a<r;++a)Wk(t[a]+n[a]<=e.shape[a],(()=>`Error in slice${r}D: begin[${a}] + size[${a}] (${t[a]+n[a]}) would overflow input.shape[${a}] (${e.shape[a]})`))}function oP(e){let t=[],n=0;for(;e>0;)1&e&&t.push(n),e/=2,n++;return t}function lP(e,t,n){let r=[];for(let a=0;a<e.length;a++)r[a]=Math.ceil((t[a]-e[a])/n[a]);return r}function uP(e,t,n,r){let a=[...e];for(let i=a.length;i<r.length;i++)a.push(1);for(let i=0;i<n;i++)0===i?a[t]=1:(a.splice(t,0,1),a.pop());return a}function dP(e,t,n){return n<=e?n:n-(t-1)}function cP(e,t){let n=[];for(let r=0;r<e;r++)n.push(t+r);return n}function pP(e,t,n,r,a,i,s,o,l){let u=e.length,d=new Array(u),c=new Array(u),p=new Array(u);if(t.length&&n>0){let l=t[0],u=n+1;d=hP(s,l,u,r,e),c=fP(o,l,u,a,e),p=uP(i,l,u,e)}else for(let h=0;h<u;h++)d[h]=gP(s,r,i,e,h,l),c[h]=bP(o,a,i,e,h,l),p[h]=mP(i,h,l);return{begin:d,end:c,strides:p}}function hP(e,t,n,r,a){let i=[...a],s=cP(n,t);for(let o=0;o<i.length;o++)if(s.indexOf(o)>-1)i[o]=0;else{let a=dP(t,n,o),s=r[a];e&1<<a&&(s=0),i[o]=s}return i}function fP(e,t,n,r,a){let i=[...a],s=cP(n,t);for(let o=0;o<i.length;o++)if(s.indexOf(o)>-1)i[o]=Number.MAX_SAFE_INTEGER;else{let a=dP(t,n,o),s=r[a];e&1<<a&&(s=Number.MAX_SAFE_INTEGER),i[o]=s}for(let o=0;o<i.length;o++){let e=a[o];i[o]<0&&(i[o]+=e),i[o]=Mk(0,i[o],a[o])}return i}function mP(e,t,n){let r=e[t];return(n&1<<t||null==r)&&(r=1),r}function gP(e,t,n,r,a,i){let s=t[a],o=n[a]||1;(e&1<<a||i&1<<a||null==s)&&(s=o>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);let l=r[a];return s<0&&(s+=l),s=Mk(0,s,l-1),s}function bP(e,t,n,r,a,i){let s=t[a],o=n[a]||1;(e&1<<a||i&1<<a||null==s)&&(s=o>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);let l=r[a];return s<0&&(s+=l),s=o>0?Mk(0,s,l):Mk(-1,s,l-1),s}function yP(e,t,n){let r=n.length;for(let a=0;a<n.length;a++)if(n[a]>1){r=a;break}for(let a=r+1;a<n.length;a++)if(t[a]>0||n[a]!==e[a])return!1;return!0}function vP(e,t){let n=e.length>0?e[e.length-1]:1;for(let r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function xP(e,t,n){let r,a,i=e.shape.length;return r="number"==typeof t?[t,...new Array(i-1).fill(0)]:t.length<i?t.concat(new Array(i-t.length).fill(0)):t.slice(),r.forEach((e=>{Wk(-1!==e,(()=>"slice() does not support negative begin indexing."))})),a=null==n?new Array(i).fill(-1):"number"==typeof n?[n,...new Array(i-1).fill(-1)]:n.length<i?n.concat(new Array(i-n.length).fill(-1)):n,a=a.map(((t,n)=>t>=0?t:(Wk(-1===t,(()=>`Negative size values should be exactly -1 but got ${t} for the slice() size at index ${n}.`)),e.shape[n]-r[n]))),[r,a]}function wP(e,t,n,r,a,i,s,o,l){let u;if(null==r?(u=new Array(t.length),u.fill(1)):u=r,null!=s&&s&s-1)throw new Error("Multiple ellipses in slice is not allowed.");let d=!1,c={dims:u.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:n.slice(),strides:u.slice(),beginMask:a,endMask:i,ellipsisMask:s,newAxisMask:o,shrinkAxisMask:l};for(let y=0;y<c.dims;y++)d&&1<<y&o&&c.numAddAxisAfterEllipsis++,1<<y&s&&(d=!0);d||(c.ellipsisMask|=1<<c.dims,c.dims++);let p={dims:e.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};!function(e,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;let n=0;t.beginValid=null!=e.begin,t.endValid=null!=e.end,t.begin=new Array(t.dims),t.end=new Array(t.dims),t.strides=new Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=new Array(t.dims);for(let r=0;r<e.dims;r++)if(1<<r&e.ellipsisMask){let a=Math.min(t.dims-(e.dims-r)+1+e.numAddAxisAfterEllipsis,t.dims);for(;n<a;n++)t.begin[n]=0,t.end[n]=0,t.strides[n]=1,t.beginMask|=1<<n,t.endMask|=1<<n,t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&e.newAxisMask)t.finalShapeGatherIndices.push(aP),t.finalShapeGatherIndicesSparse.push(-1);else{if(n===t.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${t.dims} dims, ${t.begin.length}.`);null!=e.begin&&(t.begin[n]=e.begin[r]),null!=e.end&&(t.end[n]=e.end[r]),t.strides[n]=e.strides[r],e.beginMask&1<<r&&(t.beginMask|=1<<n),e.endMask&1<<r&&(t.endMask|=1<<n),e.shrinkAxisMask&1<<r?(t.finalShapeGatherIndices.push(iP),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<n):(t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(r)),t.inputShapeGatherIndicesSparse[n]=r,n++}}(c,p);let h=!0,f=!0,m=!0,g=[],b=[];for(let y=0;y<e.length;++y){if(0===p.strides[y])throw Error(`strides[${y}] must be non-zero`);let t=!!(p.shrinkAxisMask&1<<y),n=e[y];if(-1===n){g.push(t?1:-1);continue}let r=[p.beginMask&1<<y,p.endMask&1<<y],a=[p.strides[y]>0?0:-1,p.strides[y]>0?n:n-1];if(t&&p.strides[y]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&1===p.strides[y];let i=!!(p.beginMask&1<<y&&p.endMask&1<<y);if(p.beginValid&&p.endValid){if(t){let e=p.begin[y]<0?n+p.begin[y]:p.begin[y];if(p.begin[y]=e,p.end[y]=p.begin[y]+1,e<0||e>=n)throw Error(`slice index ${p.begin[y]} of dimension ${y} out of bounds.`)}else p.begin[y]=kP(p.begin[y],0,p.strides[y],n,r,a),p.end[y]=kP(p.end[y],1,p.strides[y],n,r,a);let e=1===p.strides[y]&&0===p.begin[y]&&p.end[y]===n;h=h&&e,f=f&&(0===y&&1===p.strides[y]||e)}else h=h&&1===p.strides[y]&&i,f=f&&(0===y&&1===p.strides[y]||i);let s,o=!1;if(p.beginValid&&p.endValid?(s=p.end[y]-p.begin[y],o=!0):t?(s=1,o=!0):i&&n>=0&&(s=p.strides[y]<0?-n:n,o=!0),o){let e;e=0===s||s<0!=p.strides[y]<0?0:Math.trunc(s/p.strides[y])+(s%p.strides[y]!=0?1:0),g.push(e)}else g.push(-1)}for(let y=0;y<p.finalShapeGatherIndices.length;++y){let e=p.finalShapeGatherIndices[y];e>=0?b.push(g[e]):e===aP&&b.push(1)}return{finalShapeSparse:b.filter(((e,t)=>p.finalShapeGatherIndices[t]!==aP)),finalShape:b,isIdentity:h,sliceDim0:f,isSimpleSlice:m,begin:p.begin,end:p.end,strides:p.strides}}function kP(e,t,n,r,a,i){if(a[t])return n>0?i[t]:i[t+1&1];{let t=e<0?r+e:e;return t<i[0]?i[0]:t>i[1]?i[1]:t}}var SP="4.7.0",IP=class{static sgd(e){return new yO(e)}static momentum(e,t,n=!1){return new vO(e,t,n)}static rmsprop(e,t=.9,n=0,r=null,a=!1){return new xO(e,t,n,r,a)}static adam(e=.001,t=.9,n=.999,r=null){return new gO(e,t,n,r)}static adadelta(e=.001,t=.95,n=null){return new fO(e,t,n)}static adamax(e=.002,t=.9,n=.999,r=null,a=0){return new bO(e,t,n,r,a)}static adagrad(e,t=.1){return new mO(e,t)}},NP=IP,CP="undefined"!=typeof requestAnimationFrame?requestAnimationFrame:"undefined"!=typeof setImmediate?setImmediate:e=>e();function TP(){return new Promise((e=>CP((()=>e()))))}var EP,_P={};function $P(e,t){let n=e[0].length;e.forEach(((e,t)=>{Wk(e.length===n,(()=>`Error in concat${n}D: rank of tensors[${t}] must be the same as the rank of the rest (${n})`))})),Wk(t>=0&&t<n,(()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`));let r=e[0];e.forEach(((e,a)=>{for(let i=0;i<n;i++)Wk(i===t||e[i]===r[i],(()=>`Error in concat${n}D: Shape of tensors[${a}] (${e}) does not match the shape of the rest (${r}) along the non-concatenated axis ${a}.`))}))}function AP(e,t){let n=e[0].slice();for(let r=1;r<e.length;r++)n[t]+=e[r][t];return n}function RP(e,t,n){let r=new Array;if(null==n&&null==t)return r;if(null==t)for(;r.length<e+n.length;)r.push(-1);else r=t.slice();if(null==n)return r;if(e+n.length!==r.length)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.rank = ${e+n.length}, but shape.rank = ${r.length}`);for(let a=1;a<n.length;++a){let i=n[a],s=r[r.length-n.length+a],o=r[s];if(i>=0)if(o>=0){if(o!==i)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.shape[${a+e}] = ${i} but shape[${a+e}] = ${o}`)}else r[s]=i}return r}function DP(e){let t={FIRST_DIM_SIZE:EP.FIRST_DIM_SIZE,VALUE_ROWIDS:EP.VALUE_ROWIDS,ROW_LENGTHS:EP.ROW_LENGTHS,ROW_SPLITS:EP.ROW_SPLITS,ROW_LIMITS:EP.ROW_LIMITS,ROW_STARTS:EP.ROW_STARTS},n=[];for(let r of e){if(!(r in t))break;n.push(t[r])}return n}function FP(e){return 0===e.length?0:e[0]===EP.FIRST_DIM_SIZE?e.length-1:e.length}function MP(e,t){if(null==e||null==t)return;let n=e.length,r=t.length;if(n>=r)throw new Error(`defaultValue.shape=${e} and ragged tensor flatValues.shape=${t}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${r})`);for(let a=0;a<Math.min(n,r-1);++a){let n=e[a],r=t[a+1];if(n>=0&&r>=0&&1!==n&&n!==r)throw new Error(`defaultValue.shape=${e}, and ragged tensor input flatValues.shape=${t} are incompatible: defaultValue.shape[${a-e.length}] = ${n} but ragged tensor input.flatValues.shape[${a-e.length}] = ${r}`)}}ok(_P,{ERF_A1:()=>qP,ERF_A2:()=>KP,ERF_A3:()=>XP,ERF_A4:()=>YP,ERF_A5:()=>JP,ERF_P:()=>GP,PARALLELIZE_THRESHOLD:()=>OP,RowPartitionType:()=>EP,SELU_SCALE:()=>HP,SELU_SCALEALPHA:()=>jP,applyActivation:()=>QF,assertAndGetBroadcastShape:()=>CA,assertAxesAreInnerMostDims:()=>BA,assertParamsConsistent:()=>$P,assignToTypedArray:()=>rL,axesAreInnerMostDims:()=>OA,calculateShapes:()=>EF,checkEinsumDimSizes:()=>pL,checkPadOnDimRoundingMode:()=>F$,combineLocations:()=>PA,combineRaggedTensorToTensorShapes:()=>RP,complexWithEvenIndex:()=>eL,complexWithOddIndex:()=>tL,computeConv2DInfo:()=>S$,computeConv3DInfo:()=>I$,computeDefaultPad:()=>N$,computeDilation2DInfo:()=>x$,computeOptimalWindowSize:()=>PP,computeOutAndReduceShapes:()=>LA,computeOutShape:()=>AP,computePool2DInfo:()=>w$,computePool3DInfo:()=>k$,convertConv2DDataFormat:()=>D$,decodeEinsumEquation:()=>dL,eitherStridesOrDilationsAreOne:()=>A$,expandShapeToKeepDim:()=>zA,exponent:()=>iL,exponents:()=>aL,fromStringArrayToUint8:()=>FL,fromUint8ToStringArray:()=>DL,getAxesPermutation:()=>WA,getBroadcastDims:()=>IA,getComplexWithIndex:()=>nL,getEinsumComputePath:()=>hL,getEinsumPermutation:()=>cL,getFusedBiasGradient:()=>ZF,getFusedDyActivation:()=>JF,getImageCenter:()=>LP,getInnerMostAxes:()=>UA,getPermuted:()=>BP,getRaggedRank:()=>FP,getReductionAxes:()=>NA,getReshaped:()=>zP,getReshapedPermuted:()=>WP,getRowPartitionTypesHelper:()=>DP,getSliceBeginCoords:()=>VP,getSliceSize:()=>UP,getSparseFillEmptyRowsIndicesDenseShapeMismatch:()=>bL,getSparseFillEmptyRowsNegativeIndexErrorMessage:()=>yL,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:()=>vL,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:()=>kL,getSparseReshapeInputOutputMismatchErrorMessage:()=>IL,getSparseReshapeInputOutputMultipleErrorMessage:()=>SL,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:()=>xL,getSparseReshapeNegativeOutputDimErrorMessage:()=>wL,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:()=>EL,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:()=>NL,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:()=>CL,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:()=>TL,getUndoAxesPermutation:()=>VA,isIdentityPermutation:()=>fL,log:()=>eT,mergeRealAndImagArrays:()=>ZP,prepareAndValidate:()=>nP,prepareSplitSize:()=>gL,segment_util:()=>_L,shouldFuse:()=>eM,slice_util:()=>rP,splitRealAndImagArrays:()=>QP,stridesOrDilationsArePositive:()=>R$,tupleValuesAreOne:()=>$$,upcastType:()=>iE,validateDefaultValueShape:()=>MP,validateInput:()=>TF,validateUpdateShape:()=>CF,warn:()=>QC}),function(e){e[e.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",e[e.VALUE_ROWIDS=1]="VALUE_ROWIDS",e[e.ROW_LENGTHS=2]="ROW_LENGTHS",e[e.ROW_SPLITS=3]="ROW_SPLITS",e[e.ROW_LIMITS=4]="ROW_LIMITS",e[e.ROW_STARTS=5]="ROW_STARTS"}(EP||(EP={}));var OP=30;function PP(e){return e<=OP?e:mS(e,Math.floor(Math.sqrt(e)))}function LP(e,t,n){return[n*("number"==typeof e?e:e[0]),t*("number"==typeof e?e:e[1])]}function zP(e,t,n,r=!0){let a=[];if(r)a=a.concat(t.slice(0)),a.push(e[0]/n),a=a.concat(e.slice(1));else{a=a.concat(e[0]);let n=t.length;for(let r=0;r<n;++r)a=a.concat([e[r+1]/t[r],t[r]]);a=a.concat(e.slice(n+1))}return a}function BP(e,t,n=!0){let r=[];if(n){r.push(t);for(let n=t+1;n<e;++n)n<=2*t?(r.push(n),r.push(n-(t+1))):r.push(n)}else{let n=[],a=[];for(let r=1;r<e;++r)r>=2*t+1||r%2==1?a.push(r):n.push(r);r.push(...n),r.push(0),r.push(...a)}return r}function WP(e,t,n,r=!0){let a=[];r?a.push(e[0]/n):a.push(e[0]*n);for(let i=1;i<e.length;++i)i<=t.length?r?a.push(t[i-1]*e[i]):a.push(e[i]/t[i-1]):a.push(e[i]);return a}function VP(e,t){let n=[0];for(let r=0;r<t;++r)n.push(e[r][0]);return n}function UP(e,t,n){let r=e.slice(0,1);for(let a=0;a<n;++a)r.push(e[a+1]-t[a][0]-t[a][1]);return r}var jP=1.7580993408473768,HP=1.0507009873554805,GP=.3275911,qP=.254829592,KP=-.284496736,XP=1.421413741,YP=-1.453152027,JP=1.061405429;function ZP(e,t){if(e.length!==t.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${e.length}, imag: ${t.length}.`);let n=new Float32Array(2*e.length);for(let r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function QP(e){let t=new Float32Array(e.length/2),n=new Float32Array(e.length/2);for(let r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}function eL(e){let t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let a=0;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}function tL(e){let t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let a=2;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}function nL(e,t){return{real:e[2*t],imag:e[2*t+1]}}function rL(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function aL(e,t){let n=new Float32Array(e/2),r=new Float32Array(e/2);for(let a=0;a<Math.ceil(e/2);a++){let i=(t?2:-2)*Math.PI*(a/e);n[a]=Math.cos(i),r[a]=Math.sin(i)}return{real:n,imag:r}}function iL(e,t,n){let r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}var sL="->",oL=/->/g,lL=",",uL="...";function dL(e,t){let n=((e=e.replace(/\s/g,"")).length-e.replace(oL,"").length)/sL.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${sL}").`);let[r,a]=e.split(sL);Wk(-1===r.indexOf(uL),(()=>`The ellipsis notation ("${uL}") is not supported yet.`));let i=r.split(lL),s=i.length;if(t!==s)throw new Error(`Expected ${s} input tensors, received ${t}`);if(s>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");let o=[];for(let c=0;c<a.length;++c){let e=a[c];if(!i.some((t=>-1!==t.indexOf(e))))throw new Error(`Output subscripts contain the label ${e} not present in the input subscripts.`);-1===o.indexOf(e)&&o.push(e)}for(let c=0;c<r.length;++c){let e=r[c];-1===o.indexOf(e)&&e!==lL&&o.push(e)}let l=new Array(i.length);for(let c=0;c<s;++c){if(new Set(i[c].split("")).size!==i[c].length)throw new Error(`Found duplicate axes in input component ${i[c]}. Support for duplicate axes in input is not implemented yet.`);l[c]=[];for(let e=0;e<i[c].length;++e)l[c].push(o.indexOf(i[c][e]))}let u=o.length,d=[];for(let c=a.length;c<u;++c)d.push(c);return{allDims:o,summedDims:d,idDims:l}}function cL(e,t){let n=new Array(e);n.fill(-1);for(let a=0;a<t.length;++a)n[t[a]]=a;let r=[];for(let a=0;a<e;++a)-1===n[a]&&r.push(a);return n=n.filter((e=>-1!==e)),{permutationIndices:n,expandDims:r}}function pL(e,t,n){let r=new Array(e);for(let a=0;a<n.length;++a){let e=n[a].shape;for(let n=0;n<t[a].length;++n)void 0===r[t[a][n]]?r[t[a][n]]=e[n]:Wk(r[t[a][n]]===e[n],(()=>`Expected dimension ${r[t[a][n]]} at axis ${n} of input shaped ${JSON.stringify(e)}, but got dimension ${e[n]}`))}}function hL(e,t){let n=e,r=[],a=0;0===e.length&&n.push(-1),a=e.length+1;for(let s=0;s<a;++s)r.push([]);let i=[];for(let s=0;s<n.length;++s){let e=mL(t,n[s]);for(let t of e)-1===i.indexOf(t)&&(r[s].push(t),i.push(t))}return{path:n,steps:r}}function fL(e){return e.every(((e,t)=>e===t))}function mL(e,t){let n=[];for(let r=0;r<e.length;++r)(0===e[r].length||-1!==e[r].indexOf(t)||-1===t)&&n.push(r);return n}function gL(e,t,n=0){let r=[];if("number"==typeof t)Wk(e.shape[n]%t==0,(()=>"Number of splits must evenly divide the axis.")),r=new Array(t).fill(e.shape[n]/t);else{Wk(t.reduce(((e,t)=>(-1===t&&(e+=1),e)),0)<=1,(()=>"There should be only one negative value in split array."));let a=t.indexOf(-1);if(-1!==a){let r=t.reduce(((e,t)=>t>0?e+t:e));t[a]=e.shape[n]-r}Wk(e.shape[n]===t.reduce(((e,t)=>e+t)),(()=>"The sum of sizes must match the size of the axis dimension.")),r=t}return r}function bL(e){return`Received SparseTensor with denseShape[0] = 0 but\n  indices.shape[0] = ${e}`}function yL(e,t){return`indices(${e}, 0) is invalid: ${t} < 0`}function vL(e,t,n){return`indices(${e}, 0) is invalid: ${t} >= ${n}`}function xL(e,t){return`only one output dimension may be -1, not both ${e} and ${t}`}function wL(e,t){return`size ${e} must be non-negative, not ${t}`}function kL(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function SL(e,t){return`Input to reshape is a SparseTensor with ${jk(e)}\n  dense values, but the requested shape requires a multiple of ${jk(t)}. inputShape=${e} outputShape= ${t}`}function IL(e,t){return`Input to reshape is a tensor with ${jk(e)} dense values, but the requested shape has ${jk(t)}. inputShape=${e} outputShape=${t}`}function NL(){return"segment ids must be >= 0"}function CL(){return"segment ids are not increasing"}function TL(e,t){return`Segment id ${e} out of range [0, ${t}), possibly because segmentIds input is not sorted.`}function EL(e,t,n){return`Bad: indices[${e}] == ${t} out of range [0, ${n})`}var _L={};function $L(e,t){let n,r=!1;for(e<=OP?(n=e,r=!0):n=mS(e,Math.floor(Math.sqrt(e)));!r;)n>t||n===e?r=!0:n=mS(e,n+1);return n}function AL(e,t,n){let r=[],a=e.length;for(let i=0;i<a;i++)i!==t?r.push(e[i]):r.push(n);return r}function RL(e,t,n,r){let a=t.shape.length,i=e.shape.length;if(0!==r&&(r<-a||r>a))throw new Error(`Expect batchDims in the range of [-${a}, ${a}], but got ${r}`);if(r<0&&(r+=a),r>i)throw new Error(`batchDims (${r}) must be less than rank(x) (\n    ${i}).`);if(n<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let c=0;c<r;++c)if(e.shape[c]!==t.shape[c])throw new Error(`x.shape[${c}]: ${e.shape[c]} should be equal to indices.shape[${c}]: ${t.shape[c]}.`);let s=e.shape[n],o=[],l=1,u=1,d=1;for(let c=0;c<r;++c)o.push(e.shape[c]),l*=e.shape[c];for(let c=r;c<n;c++)o.push(e.shape[c]),u*=e.shape[c];for(let c=r;c<a;c++)o.push(t.shape[c]);for(let c=n+1;c<i;c++)o.push(e.shape[c]),d*=e.shape[c];return{batchSize:l,sliceSize:d,outerSize:u,dimSize:s,outputShape:o}}function DL(e){try{return e.map((e=>DT(e)))}catch(Dp){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${Dp}`)}}function FL(e){return e.map((e=>RT(e)))}ok(_L,{collectGatherOpShapeInfo:()=>RL,computeOutShape:()=>AL,segOpComputeOptimalWindowSize:()=>$L});var ML={};ok(ML,{nonMaxSuppressionV3Impl:()=>yM,nonMaxSuppressionV4Impl:()=>vM,nonMaxSuppressionV5Impl:()=>xM,whereImpl:()=>PF}),function(){for(let e of wO)pO(e)}();var OL={kernelName:MS,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>s$(e,gF(D_(n,"float32"),-1))}}},PL={kernelName:OS,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>{let t=XA(D_(n,"float32")),r=KA($R(qA(1),t));return TR(i$(e,r))}}}},LL={kernelName:PS,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>{let t=KA($R(XA(D_(n,"float32")),1));return i$(e,t)}}}},zL={kernelName:LS,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,a=CA(n.shape,r.shape);return{a:()=>{let t=e,r=NA(n.shape,a);return r.length>0&&(t=YA(t,r)),M$(t,n.shape)},b:()=>{let t=e,n=NA(r.shape,a);return n.length>0&&(t=YA(t,n)),M$(t,r.shape)}}}},BL={kernelName:zS,saveAllInputs:!0,gradFunc:(e,t)=>{let n={};return t.forEach(((t,r)=>{n[r]=()=>e.clone()})),n}},WL={kernelName:VS,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>_A(n)}}},VL={kernelName:US,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>_A(n)}}},UL={kernelName:jS,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>i$(e,KA($R(qA(1),XA(D_(n,"float32")))))}}},jL={kernelName:HS,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>{let t=KA(r$(qA(1),XA(D_(n,"float32"))));return i$(e,t)}}}},HL={kernelName:KS,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,a=CA(n.shape,r.shape);return{a:()=>{let t=r$(XA(n),XA(r)),i=s$(e,i$(r,t)),s=NA(n.shape,a);return s.length>0&&(i=YA(i,s)),M$(i,n.shape)},b:()=>{let t=r$(XA(n),XA(r)),i=TR(s$(e,i$(n,t))),s=NA(r.shape,a);return s.length>0&&(i=YA(i,s)),M$(i,r.shape)}}}},GL={kernelName:GS,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>i$(e,r$(XA(D_(n,"float32")),1))}}},qL={kernelName:qS,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>i$(e,$R(qA(1),XA(D_(n,"float32"))))}}},KL=RE({avgPool3dGrad_:function(e,t,n,r,a,i){let s=_E(e,"dy","avgPool3dGrad"),o=_E(t,"input","avgPool3dGrad"),l=s,u=o,d=!1;4===o.rank&&(d=!0,l=M$(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]]),u=M$(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),Wk(5===l.rank,(()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`)),Wk(5===u.rank,(()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${u.rank}.`)),F$("avgPool3dGrad",a,i);let c={dy:l,input:u},p={filterSize:n,strides:r,pad:a,dimRoundingMode:i},h=yE.runKernel(ZS,c,p);return d?M$(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}}),XL={kernelName:JS,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{filterSize:a,strides:i,pad:s,dimRoundingMode:o}=n;return{x:()=>KL(e,r,a,i,s,o)}}},YL=RE({avgPoolGrad_:function(e,t,n,r,a){let i=_E(e,"dy","avgPoolGrad"),s=_E(t,"input","avgPoolGrad");Wk(s.rank===i.rank,(()=>`Rank of input (${s.rank}) does not match rank of dy (${i.rank})`));let o=s,l=i,u=!1;3===s.rank&&(u=!0,o=M$(s,[1,s.shape[0],s.shape[1],s.shape[2]]),l=M$(i,[1,i.shape[0],i.shape[1],i.shape[2]])),Wk(4===l.rank,(()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`)),Wk(4===o.rank,(()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${o.rank}.`));let d={dy:l,input:o},c={filterSize:n,strides:r,pad:a},p=yE.runKernel(YS,d,c);return u?M$(p,[p.shape[1],p.shape[2],p.shape[3]]):p}}),JL={kernelName:XS,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{filterSize:a,strides:i,pad:s}=n;return{x:()=>YL(e,r,a,i,s)}}},ZL={kernelName:QS,inputsToSave:["a","b"],gradFunc:(e,t,n)=>{let[r,a]=t,{transposeA:i,transposeB:s}=n;return i||s?!i&&s?{a:()=>z$(e,a,!1,!1),b:()=>z$(e,r,!0,!1)}:i&&!s?{a:()=>z$(a,e,!1,!0),b:()=>z$(r,e,!1,!1)}:{a:()=>z$(a,e,!0,!0),b:()=>z$(e,r,!0,!0)}:{a:()=>z$(e,a,!1,!0),b:()=>z$(r,e,!0,!1)}}},QL={kernelName:eI,gradFunc:(e,t,n)=>{let{blockShape:r,crops:a}=n;return{x:()=>uD(e,r,a)}}},ez={kernelName:rI,gradFunc:(e,t,n)=>{let r=n,a=r.inputShape,i=r.shape,s=Array.from(i);for(let l=a.length-1;l>=0;l--)if(a[l]===i[l])s[l]=1;else if(1!==a[l])throw new Error(`broadcastTo(): [${a}] cannot be broadcast to [${i}].`);let o=[];for(let l=0;l<s.length;l++)s[l]>1&&o.push(l);return{x:()=>YA(e,o,!0)}}},tz={kernelName:iI,gradFunc:e=>({x:()=>e.clone()})},nz={kernelName:sI,gradFunc:e=>({x:()=>_A(e)})},rz={kernelName:oI,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{clipValueMin:a,clipValueMax:i}=n;return{x:()=>EA(DR(lR(r,a),mR(r,i)),e,_A(e))}}},az={kernelName:uI,inputsToSave:["x"],gradFunc:OL.gradFunc},iz={kernelName:dI,saveAllInputs:!0,gradFunc:(e,t,n)=>{let r=t.map((e=>e.shape)),{axis:a}=n,i=tS(a,t[0].shape)[0],s=r.map((e=>e[i]));return cF(e,s,i).map((e=>()=>e))}},sz={kernelName:cI,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{let[r,a]=t,{dilations:i,strides:s,pad:o,dataFormat:l}=n;return Wk($$(i),(()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`)),{x:()=>uA(r.shape,e,a,s,o,l),filter:()=>YF(r,e,a.shape,s,o,l)}}},oz={kernelName:hI,inputsToSave:["dy","filter"],gradFunc:(e,t,n)=>{let[r,a]=t,{strides:i,pad:s,dataFormat:o,dimRoundingMode:l}=n;return{dy:()=>oA(e,a,i,s,o,1,l),filter:()=>YF(e,r,a.shape,i,s,o,l)}}},lz=RE({conv3DBackpropFilter_:function(e,t,n,r,a){let i=e;4===e.rank&&(i=M$(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]));let s=t;4===s.rank&&(s=M$(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),Wk(5===i.rank,(()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${i.shape}.`)),Wk(5===s.rank,(()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${s.shape}.`)),Wk(5===n.length,(()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`)),Wk(i.shape[4]===n[3],(()=>`Error in conv3dDerFilter: depth of input ${i.shape[4]}) must match input depth in filter (${n[3]}.`)),Wk(s.shape[4]===n[4],(()=>`Error in conv3dDerFilter: depth of dy (${s.shape[4]}) must match output depth for filter (${n[4]}).`));let o={x:i,dy:s},l={strides:r,pad:a,filterShape:n};return yE.runKernel(mI,o,l)}}),uz={kernelName:fI,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{let{dilations:r,strides:a,pad:i}=n;Wk($$(r),(()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`));let[s,o]=t;return{x:()=>pA(s.shape,e,o,a,i),filter:()=>lz(s,e,o.shape,a,i)}}},dz={kernelName:bI,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>s$(TR(tF(D_(n,"float32"))),e)}}},cz={kernelName:yI,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>s$(nF(D_(n,"float32")),e)}}},pz={kernelName:xI,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{axis:a,exclusive:i,reverse:s}=n;return{x:()=>{let t=WA([a],r.rank),n=bA(e,a,i,!s);return null!=t&&(n=BF(n,t)),n}}}},hz={kernelName:II,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{let{dilations:r,strides:a,pad:i,dimRoundingMode:s}=n,o=null==r?[1,1]:r;Wk($$(o),(()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${o}'`));let[l,u]=t;return Wk(4===l.rank,(()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`)),Wk(4===u.rank,(()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${u.rank}.`)),Wk(l.shape[3]===u.shape[2],(()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${u.shape[2]}.`)),Wk(A$(a,o),(()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${a} and dilations '${o}'.`)),F$("depthwiseConv2d",i,s),{x:()=>rM(l.shape,e,u,a,i,o,s),filter:()=>nM(l,e,u.shape,a,i,o,s)}}},fz={kernelName:EI,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{let[r,a]=t,i={x:r,filter:a,dy:e},s={x:r,filter:a,dy:e};return{x:()=>yE.runKernel(_I,i,n),filter:()=>yE.runKernel($I,s,n)}}},mz={kernelName:FI,outputsToSave:[!0],gradFunc:(e,t)=>{let[n]=t,r={dy:e,y:n};return{x:()=>yE.runKernel(MI,r)}}},gz={kernelName:OI,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t,r=s$(eR(TR(XA(n))),2/Math.sqrt(Math.PI));return{x:()=>s$(e,r)}}},bz={kernelName:LI,outputsToSave:[!0],gradFunc:(e,t)=>{let[n]=t;return{x:()=>s$(e,n)}}},yz={kernelName:zI,inputsToSave:["input"],gradFunc:(e,t)=>{let[n]=t;return{input:()=>M$(e,n.shape)}}},vz={kernelName:BI,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>s$(e,eR(n))}}},xz={kernelName:jI,gradFunc:e=>({x:()=>_A(e)})},wz={kernelName:HI,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,a=CA(n.shape,r.shape);return{a:()=>{let t=i$(e,D_(r,"float32")),i=NA(n.shape,a);return i.length>0?M$(YA(t,i),n.shape):t},b:()=>{let t=s$(e,D_(n,"float32")),i=NA(r.shape,a);i.length>0&&(t=M$(YA(t,i),r.shape));let s=XA(r);return TR(i$(t,D_(s,"float32")))}}}},kz={kernelName:GI,inputsToSave:["x","mean","variance","scale"],gradFunc:(e,t,n)=>{let{varianceEpsilon:r}=n,[a,i,s,o]=t,l=null==o?qA(1):o,u=NA(i.shape,a.shape),d=[];if(1===i.rank){for(let e=0;e<a.shape.length-1;++e)d.push(a.shape[e]);d.push(1)}let c=$R(a,i),p=s$(e,l),h=YD(r$(s,qA(r))),f=s$(s$(s$(h,h),h),qA(-.5));return{x:()=>1===i.rank?M$(s$(s$(e,rR(M$(h,[1,1,1,i.shape[0]]),d)),l),a.shape):M$(s$(s$(e,h),l),a.shape),mean:()=>{let e=s$(s$(h,qA(-1)),p);return 1===i.rank&&(e=YA(e,u)),M$(e,i.shape)},variance:()=>{let e=s$(s$(f,c),p);return 1===i.rank&&(e=YA(e,u)),M$(e,i.shape)},scale:()=>{let t=s$(c,h),n=s$(e,t);return 1===i.rank&&(n=YA(n,u)),M$(n,i.shape)},offset:()=>{let t=e;return 1===i.rank&&(t=YA(t,u)),M$(t,i.shape)}}}},Sz={kernelName:qI,inputsToSave:["x","indices"],gradFunc:(e,t,n)=>{let[r,a]=t,{axis:i}=n,s=tS(i,r.shape)[0];return{x:()=>{let t=r.shape,n=a.size,o=t.slice(0,s),l=o.length,u=t.slice(i,t.length).slice(1),d=u.length,c=Iz(0,l),p=Iz(l+1,l+1+d),h=Nz([o,[n],u]),f=M$(e,h),m=M$(a,[n]),g=Nz([[l],c,p]),b=BF(f,g),y=DF(b,m,r.shape[s]),v=VA(g);return y=BF(y,v),y},indices:()=>a}}};function Iz(e,t){let n=[];for(let r=e;r<t;++r)n.push(r);return n}function Nz(e){let t=[];for(let n=0;n<e.length;++n)for(let r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var Cz={kernelName:YI,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t;return{a:()=>_A(n),b:()=>_A(r)}}},Tz={kernelName:JI,gradFunc:e=>({x:()=>D_(e,"float32")})},Ez={kernelName:eN,gradFunc:e=>({x:()=>_A(e)})},_z={kernelName:tN,gradFunc:e=>({x:()=>_A(e)})},$z={kernelName:nN,gradFunc:e=>({x:()=>_A(e)})},Az={kernelName:rN,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{alpha:a}=n,i=oR(r,0);return{x:()=>EA(i,e,s$(e,a))}}},Rz={kernelName:lN,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>i$(e,r$(n,1))}}},Dz={kernelName:oN,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>i$(e,D_(n,"float32"))}}},Fz={kernelName:hN,inputsToSave:[],outputsToSave:[!0],gradFunc:(e,t,n)=>{let[r]=t,{axis:a}=n;return{logits:()=>{let t=eR(r);return $R(e,s$(YA(e,a,!0),t))}}}},Mz=RE({localResponseNormalizationBackprop_:function(e,t,n,r=5,a=1,i=1,s=.5){let o={x:e,y:t,dy:n},l={depthRadius:r,bias:a,alpha:i,beta:s};return yE.runKernel(gN,o,l)}}),Oz={kernelName:mN,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let[r,a]=t,{depthRadius:i,bias:s,alpha:o,beta:l}=n;return{x:()=>Mz(r,a,e,i,s,o,l)}}};function Pz(e,t,n,r){return t.rank<n.rank&&(t=M$(t,zA(t.shape,r))),e.rank<n.rank&&(e=M$(e,zA(e.shape,r))),{x:()=>s$(e,D_(TA(n,t),e.dtype))}}var Lz={kernelName:yN,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let r=n,{reductionIndices:a}=r,i=t[0],s=Pz(e,t[1],i,tS(a,i.shape));return{x:()=>s.x()}}},zz={kernelName:vN,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t;return{a:()=>s$(e,D_(lR(n,r),"float32")),b:()=>s$(e,D_(fR(n,r),"float32"))}}},Bz=RE({maxPool3dGrad_:function(e,t,n,r,a,i,s){let o=_E(e,"dy","maxPool3dGrad"),l=_E(t,"input","maxPool3dGrad"),u=_E(n,"output","maxPool3dGrad"),d=o,c=l,p=u,h=!1;4===l.rank&&(h=!0,d=M$(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),c=M$(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),p=M$(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),Wk(5===d.rank,(()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${d.rank}.`)),Wk(5===c.rank,(()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${c.rank}.`)),Wk(5===p.rank,(()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${p.rank}.`)),F$("maxPool3dGrad",i,s);let f={dy:d,input:c,output:p},m={filterSize:r,strides:a,pad:i,dimRoundingMode:s},g=yE.runKernel(SN,f,m);return h?M$(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}}),Wz={kernelName:kN,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let[r,a]=t,{filterSize:i,strides:s,pad:o,dimRoundingMode:l}=n;return{x:()=>Bz(e,r,a,i,s,o,l)}}},Vz=RE({maxPoolGrad_:function(e,t,n,r,a,i,s){let o=_E(e,"dy","maxPoolGrad"),l=_E(t,"input","maxPoolGrad"),u=_E(n,"output","maxPoolGrad");Wk(l.rank===o.rank,(()=>`Rank of input (${l.rank}) does not match rank of dy (${o.rank})`)),Wk(4===o.rank,(()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${o.rank}.`)),Wk(4===l.rank,(()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`)),F$("maxPoolGrad",i,s);let d={dy:o,input:l,output:u},c={filterSize:r,strides:a,pad:i,dimRoundingMode:s};return yE.runKernel(wN,d,c)}}),Uz={kernelName:xN,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let[r,a]=t,{filterSize:i,strides:s,pad:o}=n;return{x:()=>Vz(e,r,a,i,s,o)}}},jz={kernelName:NN,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{axis:a}=n,i=tS(a,r.shape),s=jk(LA(r.shape,i)[1]);return{x:()=>{let t=r.shape.slice();i.forEach((e=>{t[e]=1}));let n=M$(e,t);return i$(s$(n,GR(r.shape,"float32")),s)}}}},Hz={kernelName:CN,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let r=n,{axis:a}=r,[i,s]=t,o=Pz(e,s,i,tS(a,i.shape));return{x:()=>o.x()}}},Gz={kernelName:TN,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t;return{a:()=>s$(e,D_(mR(n,r),"float32")),b:()=>s$(e,D_(oR(n,r),"float32"))}}},qz={kernelName:EN,inputsToSave:["x"],gradFunc:(e,t,n)=>{let r=t[0],{paddings:a}=n,i=a.map((e=>e[0]));return{x:()=>W$(e,i,r.shape)}}},Kz={kernelName:_N,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,a=CA(n.shape,r.shape);return{a:()=>{let t=NA(n.shape,a);return t.length>0?M$(YA(e,t),n.shape):e},b:()=>{let t=s$(e,TR(iR(i$(n,r)))),i=NA(r.shape,a);return i.length>0?M$(YA(t,i),r.shape):t}}}},Xz={kernelName:AN,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,a=CA(n.shape,r.shape);return{a:()=>{let t=s$(e,D_(r,"float32")),i=NA(n.shape,a);return i.length>0?M$(YA(t,i),n.shape):t},b:()=>{let t=s$(e,D_(n,"float32")),i=NA(r.shape,a);return i.length>0?M$(YA(t,i),r.shape):t}}}},Yz={kernelName:RN,gradFunc:e=>({x:()=>TR(e)})},Jz={kernelName:LN,inputsToSave:["indices"],gradFunc:(e,t)=>{let n=t[0];return{indices:()=>HR(n.shape,"float32")}}},Zz={kernelName:PN,gradFunc:e=>({x:()=>_A(e)})},Qz={kernelName:zN,saveAllInputs:!0,gradFunc:(e,t,n)=>{let{axis:r}=n;return FF(e,r).map((e=>()=>e))}},eB={kernelName:BN,inputsToSave:["x"],gradFunc:(e,t,n)=>{let r=t[0],{paddings:a}=n,i=a.map((e=>e[0]));return{x:()=>W$(e,i,r.shape)}}},tB={kernelName:VN,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(e,t)=>{let[n,r,a]=t,i=n,s=r,o=CA(i.shape,s.shape);return{a:()=>{let t=D_(s,"float32"),n=s$(e,s$(t,GA(i,$R(t,qA(1))))),r=NA(i.shape,o);return r.length>0&&(n=YA(n,r)),M$(n,i.shape)},b:()=>{let t=oR(i,0),n=EA(t,yR(i),_A(i)),r=s$(e,s$(a,n)),l=NA(s.shape,o);return l.length>0&&(r=YA(r,l)),M$(r,s.shape)}}}},nB={kernelName:UN,inputsToSave:["x","alpha"],gradFunc:(e,t)=>{let[n,r]=t,a=oR(n,0);return{x:()=>EA(a,e,s$(e,r)),alpha:()=>{let t=EA(a,_A(e),s$(e,n)),i=NA(r.shape,e.shape);return i.length>0&&(t=YA(t,i)),M$(t,r.shape)}}}};function rB(e,t,n){let r=e.shape.length,a=r-n.length,i=_P.getAxesPermutation(n,r),s=e;null!=i&&(s=BF(e,i));let o=s.shape.slice(),l=o.splice(r-n.length,n.length).reduce(((e,t)=>e*t),1);o.push(l);let u=function(e,t,n){let r=e.shape.slice();r[n]=1;let a=M$(t,r),i=gA(e,n,!0,!1),s=gA(e,n,!0,!0),o=s$(i,s);return s$(a,o)}(s.reshape(o),t,a);if(u=u.reshape(s.shape),null!=i){let e=_P.getUndoAxesPermutation(i);u=BF(u,e)}return u}var aB={kernelName:jN,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{axis:a}=n,i=[];return i=null==a?r.shape.map(((e,t)=>t)):"number"==typeof a?[a]:a,{x:()=>rB(r,e,i)}}},iB={kernelName:RI,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,a=CA(n.shape,r.shape);return{a:()=>{let t=i$(e,D_(r,"float32")),i=NA(n.shape,a);return i.length>0?M$(YA(t,i),n.shape):t},b:()=>{let t=s$(e,D_(n,"float32")),i=NA(r.shape,a);i.length>0&&(t=M$(YA(t,i),r.shape));let s=XA(r);return TR(i$(t,D_(s,"float32")))}}}},sB={kernelName:YN,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>i$(e,TR(XA(n)))}}},oB={kernelName:rC,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t,r=s$(mR(n,6),gF(n));return{x:()=>s$(e,D_(r,"float32"))}}},lB={kernelName:JN,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>s$(e,D_(gF(n),"float32"))}}},uB={kernelName:ZN,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>M$(e,n.shape)}}},dB={kernelName:tC,inputsToSave:["images"],gradFunc:(e,t,n)=>{let[r]=t,a={dy:e,images:r};return{images:()=>yE.runKernel(nC,a,n)}}},cB={kernelName:QN,inputsToSave:["images"],gradFunc:(e,t,n)=>{let[r]=t,a={dy:e,images:r};return{images:()=>yE.runKernel(eC,a,n)}}},pB={kernelName:aC,gradFunc:(e,t,n)=>{let{dims:r}=n,a=tS(r,e.shape);return{x:()=>jD(e,a)}}},hB={kernelName:iC,gradFunc:e=>({x:()=>_A(e)})},fB={kernelName:sC,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>TR(i$(e,s$(GA(n,1.5),2)))}}},mB={kernelName:dC,inputsToSave:["condition"],gradFunc:(e,t)=>{let[n]=t;return{condition:()=>D_(_A(n),"float32"),t:()=>s$(e,D_(n,e.dtype)),e:()=>s$(e,D_(FR(n),e.dtype))}}},gB={kernelName:cC,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>{let t=oR(n,qA(0)),r=qA(jP),a=qA(HP),i=s$(e,a),s=s$(s$(e,r),eR(D_(n,"float32")));return EA(t,i,s)}}}},bB={kernelName:gC,outputsToSave:[!0],gradFunc:(e,t)=>{let[n]=t;return{x:()=>s$(e,s$(n,$R(qA(1),n)))}}},yB={kernelName:mC,gradFunc:e=>({x:()=>_A(e)})},vB={kernelName:hC,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>s$(fA(D_(n,"float32")),e)}}},xB={kernelName:fC,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>s$(mA(D_(n,"float32")),e)}}},wB={kernelName:pC,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{begin:a,size:i}=n,s=r.shape,[o,l]=xP(r,a,i),u=[];for(let d=0;d<e.rank;d++)u.push([o[d],s[d]-o[d]-l[d]]);return{x:()=>aD(e,u)}}},kB={kernelName:kC,outputsToSave:[!0],gradFunc:(e,t,n)=>{let[r]=t,{dim:a}=n,i=s$(e,r);return{logits:()=>$R(i,s$(YA(i,[a],!0),r))}}},SB={kernelName:bC,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>s$(e,B$(n))}}},IB={kernelName:xC,gradFunc:(e,t,n)=>{let{blockShape:r,paddings:a}=n;return{x:()=>j$(e,r,a)}}},NB={kernelName:wC,gradFunc:(e,t,n)=>{let{axis:r}=n;return{x:()=>L$(e,r)}}},CB={kernelName:yC,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>i$(e,s$(KA(D_(n,"float32")),2))}}},TB={kernelName:_C,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>s$(e,s$(D_(n,"float32"),2))}}},EB={kernelName:EC,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,a=qA(2);return{a:()=>s$(e,s$(a,$R(n,r))),b:()=>s$(e,s$(a,$R(r,n)))}}},_B={kernelName:qC,gradFunc:e=>({x:()=>_A(e)})},$B={kernelName:MC,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,a=CA(n.shape,r.shape);return{a:()=>{let t=e,r=NA(n.shape,a);return r.length>0&&(t=YA(t,r)),M$(t,n.shape)},b:()=>{let t=e,n=NA(r.shape,a);return n.length>0&&(t=YA(t,n)),M$(TR(t),r.shape)}}}},AB={kernelName:vC,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,a=r.shape.slice(),{axis:i}=n;tS(i,r.shape).forEach((e=>{a[e]=1}));let s=M$(e,a),o=s$(s,GR(r.shape,"float32"));return{x:()=>o}}},RB={kernelName:OC,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>i$(e,XA(fA(n)))}}},DB={kernelName:PC,outputsToSave:[!0],gradFunc:(e,t)=>{let[n]=t;return{x:()=>s$($R(qA(1),XA(n)),e)}}},FB={kernelName:LC,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{reps:a}=n;return{x:()=>{let t=_A(r);if(1===r.rank)for(let n=0;n<a[0];++n)t=r$(t,W$(e,[n*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(let n=0;n<a[0];++n)for(let i=0;i<a[1];++i)t=r$(t,W$(e,[n*r.shape[0],i*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(let n=0;n<a[0];++n)for(let i=0;i<a[1];++i)for(let s=0;s<a[2];++s)t=r$(t,W$(e,[n*r.shape[0],i*r.shape[1],s*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error(`Gradient for tile operation is not implemented for rank-${r.rank} tensors yet.`);for(let n=0;n<a[0];++n)for(let i=0;i<a[1];++i)for(let s=0;s<a[2];++s)for(let o=0;o<a[3];++o)t=r$(t,W$(e,[n*r.shape[0],i*r.shape[1],s*r.shape[2],o*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return t}}}},MB={kernelName:WC,gradFunc:(e,t,n)=>{let r=n,{perm:a}=r,i=VA(a);return{x:()=>BF(e,i)}}},OB={kernelName:UC,gradFunc:(e,t,n)=>{let r=n,{axis:a}=r;return{value:()=>mF(e,a)}}},PB={kernelName:jC,inputsToSave:["segmentIds"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>function(e,t){let n=UR(t,_A(t)),r=sR(e,n),a=lR(t,qA(0,"int32")),i=r.rank-a.rank;for(let o=0;o<i;++o)a=tR(a,o+1);a=DR(a,GR(r.shape,"bool"));let s=_A(r);return EA(a,r,s)}(e,n)}}},LB={kernelName:GC,gradFunc:e=>({x:()=>_A(e)})},zB=[OL,PL,LL,zL,BL,WL,VL,UL,jL,HL,GL,qL,XL,JL,ZL,QL,ez,tz,nz,rz,az,iz,oz,sz,uz,dz,cz,pz,hz,fz,iB,mz,gz,bz,yz,vz,wz,xz,kz,Sz,Cz,Tz,Ez,_z,$z,Az,Rz,Dz,Fz,Oz,Lz,Lz,zz,Wz,Uz,jz,Hz,Gz,qz,Kz,Xz,Yz,Jz,Zz,Qz,eB,eB,tB,nB,aB,sB,oB,lB,uB,dB,cB,pB,hB,fB,mB,gB,bB,yB,vB,xB,wB,kB,SB,IB,IB,NB,NB,CB,EB,TB,_B,$B,AB,RB,DB,FB,MB,OB,PB,LB];for(let e of zB)oT(e);YT().prototype.abs=function(){return this.throwIfDisposed(),o$(this)},YT().prototype.acos=function(){return this.throwIfDisposed(),l$(this)},YT().prototype.acosh=function(){return this.throwIfDisposed(),u$(this)},YT().prototype.add=function(e){return this.throwIfDisposed(),r$(this,e)},YT().prototype.all=function(e,t){return this.throwIfDisposed(),c$(this,e,t)},YT().prototype.any=function(e,t){return this.throwIfDisposed(),p$(this,e,t)},YT().prototype.argMax=function(e){return this.throwIfDisposed(),h$(this,e)},YT().prototype.argMin=function(e){return this.throwIfDisposed(),f$(this,e)},YT().prototype.asScalar=function(){return this.throwIfDisposed(),Wk(1===this.size,(()=>"The array must have only 1 element.")),M$(this,[])},YT().prototype.asType=function(e){return this.throwIfDisposed(),D_(this,e)},YT().prototype.as1D=function(){return this.throwIfDisposed(),M$(this,[this.size])},YT().prototype.as2D=function(e,t){return this.throwIfDisposed(),M$(this,[e,t])},YT().prototype.as3D=function(e,t,n){return this.throwIfDisposed(),M$(this,[e,t,n])},YT().prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),M$(this,[e,t,n,r])},YT().prototype.as5D=function(e,t,n,r,a){return this.throwIfDisposed(),M$(this,[e,t,n,r,a])},YT().prototype.asin=function(){return this.throwIfDisposed(),m$(this)},YT().prototype.asinh=function(){return this.throwIfDisposed(),g$(this)},YT().prototype.atan=function(){return this.throwIfDisposed(),b$(this)},YT().prototype.atan2=function(e){return this.throwIfDisposed(),y$(this,e)},YT().prototype.atanh=function(){return this.throwIfDisposed(),v$(this)},YT().prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),O$(this,e,t,n,r)},YT().prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),j$(this,e,t)},YT().prototype.batchNorm=function(e,t,n,r,a){return this.throwIfDisposed(),G$(this,e,t,n,r,a)},YT().prototype.broadcastTo=function(e){return this.throwIfDisposed(),Q$(this,e)},YT().prototype.cast=function(e){return this.throwIfDisposed(),D_(this,e)},YT().prototype.ceil=function(){return this.throwIfDisposed(),eA(this)},YT().prototype.clipByValue=function(e,t){return this.throwIfDisposed(),nA(this,e,t)},YT().prototype.concat=function(e,t){return this.throwIfDisposed(),e instanceof XT&&(e=[e]),L$([this,...e],t)},YT().prototype.conv1d=function(e,t,n,r,a,i){return this.throwIfDisposed(),lA(this,e,t,n,r,a,i)},YT().prototype.conv2dTranspose=function(e,t,n,r,a){return this.throwIfDisposed(),dA(this,e,t,n,r,a)},YT().prototype.conv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),oA(this,e,t,n,r,a,i)},YT().prototype.cos=function(){return this.throwIfDisposed(),fA(this)},YT().prototype.cosh=function(){return this.throwIfDisposed(),mA(this)},YT().prototype.cumprod=function(e,t,n){return this.throwIfDisposed(),gA(this,e,t,n)},YT().prototype.cumsum=function(e,t,n){return this.throwIfDisposed(),bA(this,e,t,n)},YT().prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),vA(this,e,t)},YT().prototype.depthwiseConv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),xA(this,e,t,n,r,a,i)},YT().prototype.dilation2d=function(e,t,n,r,a){return this.throwIfDisposed(),kA(this,e,t,n,r,a)},YT().prototype.divNoNan=function(e){return this.throwIfDisposed(),$A(this,e)},YT().prototype.div=function(e){return this.throwIfDisposed(),i$(this,e)},YT().prototype.dot=function(e){return this.throwIfDisposed(),AA(this,e)},YT().prototype.elu=function(){return this.throwIfDisposed(),DA(this)},YT().prototype.equal=function(e){return this.throwIfDisposed(),TA(this,e)},YT().prototype.erf=function(){return this.throwIfDisposed(),MA(this)},YT().prototype.euclideanNorm=function(e,t){return this.throwIfDisposed(),QA(this,e,t)},YT().prototype.exp=function(){return this.throwIfDisposed(),eR(this)},YT().prototype.expandDims=function(e){return this.throwIfDisposed(),tR(this,e)},YT().prototype.expm1=function(){return this.throwIfDisposed(),nR(this)},YT().prototype.fft=function(){return this.throwIfDisposed(),lF(this)},YT().prototype.flatten=function(){return this.throwIfDisposed(),M$(this,[this.size])},YT().prototype.floor=function(){return this.throwIfDisposed(),iR(this)},YT().prototype.floorDiv=function(e){return this.throwIfDisposed(),a$(this,e)},YT().prototype.gather=function(e,t,n){return this.throwIfDisposed(),sR(this,e,t,n)},YT().prototype.greaterEqual=function(e){return this.throwIfDisposed(),lR(this,e)},YT().prototype.greater=function(e){return this.throwIfDisposed(),oR(this,e)},YT().prototype.ifft=function(){return this.throwIfDisposed(),uF(this)},YT().prototype.irfft=function(){return this.throwIfDisposed(),dF(this)},YT().prototype.isFinite=function(){return this.throwIfDisposed(),dR(this)},YT().prototype.isInf=function(){return this.throwIfDisposed(),cR(this)},YT().prototype.isNaN=function(){return this.throwIfDisposed(),pR(this)},YT().prototype.leakyRelu=function(e){return this.throwIfDisposed(),hR(this,e)},YT().prototype.lessEqual=function(e){return this.throwIfDisposed(),mR(this,e)},YT().prototype.less=function(e){return this.throwIfDisposed(),fR(this,e)},YT().prototype.localResponseNormalization=function(e,t,n,r){return this.throwIfDisposed(),bR(this,e,t,n,r)},YT().prototype.logSigmoid=function(){return this.throwIfDisposed(),_R(this)},YT().prototype.logSoftmax=function(e){return this.throwIfDisposed(),AR(this,e)},YT().prototype.logSumExp=function(e,t){return this.throwIfDisposed(),RR(this,e,t)},YT().prototype.log=function(){return this.throwIfDisposed(),yR(this)},YT().prototype.log1p=function(){return this.throwIfDisposed(),vR(this)},YT().prototype.logicalAnd=function(e){return this.throwIfDisposed(),DR(this,e)},YT().prototype.logicalNot=function(){return this.throwIfDisposed(),FR(this)},YT().prototype.logicalOr=function(e){return this.throwIfDisposed(),MR(this,e)},YT().prototype.logicalXor=function(e){return this.throwIfDisposed(),OR(this,e)},YT().prototype.matMul=function(e,t,n){return this.throwIfDisposed(),z$(this,e,t,n)},YT().prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),BR(this,e,t,n,r)},YT().prototype.max=function(e,t){return this.throwIfDisposed(),jA(this,e,t)},YT().prototype.maximum=function(e){return this.throwIfDisposed(),UR(this,e)},YT().prototype.mean=function(e,t){return this.throwIfDisposed(),jR(this,e,t)},YT().prototype.min=function(e,t){return this.throwIfDisposed(),HA(this,e,t)},YT().prototype.minimum=function(e){return this.throwIfDisposed(),KR(this,e)},YT().prototype.mirrorPad=function(e,t){return this.throwIfDisposed(),XR(this,e,t)},YT().prototype.mod=function(e){return this.throwIfDisposed(),YR(this,e)},YT().prototype.mul=function(e){return this.throwIfDisposed(),s$(this,e)},YT().prototype.neg=function(){return this.throwIfDisposed(),TR(this)},YT().prototype.norm=function(e,t,n){return this.throwIfDisposed(),ZA(this,e,t,n)},YT().prototype.notEqual=function(e){return this.throwIfDisposed(),eD(this,e)},YT().prototype.oneHot=function(e,t=1,n=0){return this.throwIfDisposed(),tD(this,e,t,n)},YT().prototype.onesLike=function(){return this.throwIfDisposed(),nD(this)},YT().prototype.pad=function(e,t){return this.throwIfDisposed(),aD(this,e,t)},YT().prototype.pool=function(e,t,n,r,a,i){return this.throwIfDisposed(),dD(this,e,t,n,r,a,i)},YT().prototype.pow=function(e){return this.throwIfDisposed(),GA(this,e)},YT().prototype.prelu=function(e){return this.throwIfDisposed(),cD(this,e)},YT().prototype.prod=function(e,t){return this.throwIfDisposed(),pD(this,e,t)},YT().prototype.reciprocal=function(){return this.throwIfDisposed(),WD(this)},YT().prototype.relu=function(){return this.throwIfDisposed(),VD(this)},YT().prototype.relu6=function(){return this.throwIfDisposed(),UD(this)},YT().prototype.reshapeAs=function(e){return this.throwIfDisposed(),M$(this,e.shape)},YT().prototype.reshape=function(e){return this.throwIfDisposed(),M$(this,e)},YT().prototype.resizeBilinear=function(e,t,n){return this.throwIfDisposed(),$M(this,e,t,n)},YT().prototype.resizeNearestNeighbor=function(e,t,n){return this.throwIfDisposed(),AM(this,e,t,n)},YT().prototype.reverse=function(e){return this.throwIfDisposed(),jD(this,e)},YT().prototype.rfft=function(){return this.throwIfDisposed(),pF(this)},YT().prototype.round=function(){return this.throwIfDisposed(),XD(this)},YT().prototype.rsqrt=function(){return this.throwIfDisposed(),YD(this)},YT().prototype.selu=function(){return this.throwIfDisposed(),JD(this)},YT().prototype.separableConv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),ZD(this,e,t,n,r,a,i)},YT().prototype.sigmoid=function(){return this.throwIfDisposed(),B$(this)},YT().prototype.sign=function(){return this.throwIfDisposed(),eF(this)},YT().prototype.sin=function(){return this.throwIfDisposed(),tF(this)},YT().prototype.sinh=function(){return this.throwIfDisposed(),nF(this)},YT().prototype.slice=function(e,t){return this.throwIfDisposed(),W$(this,e,t)},YT().prototype.softmax=function(e){return this.throwIfDisposed(),oF(this,e)},YT().prototype.softplus=function(){return this.throwIfDisposed(),ER(this)},YT().prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),uD(this,e,t)},YT().prototype.split=function(e,t){return this.throwIfDisposed(),cF(this,e,t)},YT().prototype.sqrt=function(){return this.throwIfDisposed(),KA(this)},YT().prototype.square=function(){return this.throwIfDisposed(),XA(this)},YT().prototype.squaredDifference=function(e){return this.throwIfDisposed(),hF(this,e)},YT().prototype.squeeze=function(e){return this.throwIfDisposed(),fF(this,e)},YT().prototype.stack=function(e,t){this.throwIfDisposed();let n=e instanceof XT?[this,e]:[this,...e];return mF(n,t)},YT().prototype.step=function(e){return this.throwIfDisposed(),gF(this,e)},YT().prototype.stridedSlice=function(e,t,n,r,a,i,s,o){return this.throwIfDisposed(),bF(this,e,t,n,r,a,i,s,o)},YT().prototype.sub=function(e){return this.throwIfDisposed(),$R(this,e)},YT().prototype.sum=function(e,t){return this.throwIfDisposed(),YA(this,e,t)},YT().prototype.tan=function(){return this.throwIfDisposed(),yF(this)},YT().prototype.tanh=function(){return this.throwIfDisposed(),V$(this)},YT().prototype.tile=function(e){return this.throwIfDisposed(),rR(this,e)},YT().prototype.toBool=function(){return this.throwIfDisposed(),D_(this,"bool")},YT().prototype.toFloat=function(){return this.throwIfDisposed(),D_(this,"float32")},YT().prototype.toInt=function(){return this.throwIfDisposed(),D_(this,"int32")},YT().prototype.topk=function(e,t){return this.throwIfDisposed(),$F(this,e,t)},YT().prototype.transpose=function(e){return this.throwIfDisposed(),BF(this,e)},YT().prototype.unique=function(e){return this.throwIfDisposed(),RF(this,e)},YT().prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),DF(this,e,t)},YT().prototype.unstack=function(e){return this.throwIfDisposed(),FF(this,e)},YT().prototype.where=function(e,t){return this.throwIfDisposed(),EA(e,this,t)},YT().prototype.zerosLike=function(){return this.throwIfDisposed(),_A(this)};var BB=class extends Error{constructor(e){super(e),Object.setPrototypeOf(this,BB.prototype)}},WB=class extends Error{constructor(e){super(e),Object.setPrototypeOf(this,WB.prototype)}},VB=class extends Error{constructor(e){super(e),Object.setPrototypeOf(this,VB.prototype)}},UB=class extends Error{constructor(e){super(e),Object.setPrototypeOf(this,UB.prototype)}},jB=class extends Error{constructor(e){super(e),Object.setPrototypeOf(this,jB.prototype)}},HB=class{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let t;return this.cache.has(e)&&(t=this.cache.get(e),this.cache.delete(e),this.cache.set(e,t)),t}put(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){let e=this.cache.keys().next().value;this.cache.delete(e)}this.cache.set(e,t)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let t=0;t<this.maxEntries-e;t++){let e=this.cache.keys().next().value;this.cache.delete(e)}this.maxEntries=e}};function GB(e,t){if(Array.isArray(e)){let n=[];for(let r=0;r<t;r++)n=n.concat(e);return n}{let n=new Array(t);return n.fill(e),n}}function qB(e,t){if(!e)throw new jB(t)}function KB(e,t){let n=0;for(let r of e)r===t&&n++;return n}function XB(e){return 1===e.length?e[0]:e}function YB(e){return Array.isArray(e)?e:[e]}function JB(e){let t=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==t[0]?t:"private"+t}function ZB(e){return e.length<=1||-1===e.indexOf("_")?e:e.replace(/[_]+(\w|$)/g,((e,t)=>t.toUpperCase()))}var QB={};function eW(e){if(null==e)return null;let t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function tW(e){if(null!=e&&"object"==typeof e)if(Array.isArray(e))e.forEach((e=>tW(e)));else{let t=Object.keys(e);for(let n of t){let t=e[n];null!=t&&"object"==typeof t&&(Array.isArray(t)||"ndarray"!==t.type||"number"!=typeof t.value?tW(t):e[n]=t.value)}}}function nW(e,t={},n={},r="object",a=!1){if("string"==typeof e){let a,i=e;if(i in n)a=n[i];else if(i in QB)a=QB[i];else if(a=t[i],null==a)throw new VB(`Unknown ${r}: ${e}. This may be due to one of the following reasons:\n1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return a}{let i=e;if(null==i.className||null==i.config)throw new VB(`${r}: Improper config format: ${JSON.stringify(i)}.\n'className' and 'config' must set.`);let s,o,l=i.className;if(l in n?[s,o]=n[l]:l in QB?[s,o]=QB.className:l in t&&([s,o]=t[l]),null==s)throw new VB(`Unknown ${r}: ${l}. This may be due to one of the following reasons:\n1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(null!=o){let e={};for(let n of Object.keys(QB))e[n]=QB[n];for(let a of Object.keys(n))e[a]=n[a];i.config.customObjects=e;let t=Object.assign({},QB);for(let a of Object.keys(n))QB[a]=n[a];tW(i.config);let r=o(s,i.config,n,a);return QB=Object.assign({},t),r}{let e=Object.assign({},QB);for(let r of Object.keys(n))QB[r]=n[r];let t=new s(i.config);return QB=Object.assign({},e),t}}}function rW(e,t){return-1*function(e,t){return e<t?-1:e>t?1:0}(e,t)}function aW(e){if(null==e)return e;let t=[];for(let n of e)-1===t.indexOf(n)&&t.push(n);return t}function iW(e){if(null==e)throw new VB(`Invalid value in obj: ${JSON.stringify(e)}`);for(let t in e)if(e.hasOwnProperty(t))return!1;return!0}function sW(e,t,n){if(null!=n&&e.indexOf(n)<0)throw new VB(`${n} is not a valid ${t}.  Valid values are ${e} or null/undefined.`)}function oW(e,t,n=0,r=1/0){return qB(n>=0),qB(r>=n),Array.isArray(e)&&e.length>=n&&e.length<=r&&e.every((e=>typeof e===t))}function lW(e,t){Array.isArray(e)?(pT.assert(e.length>0,(()=>`${t} is unexpectedly an empty array.`)),e.forEach(((e,n)=>lW(e,`element ${n+1} of ${t}`)))):pT.assert(Number.isInteger(e)&&e>0,(()=>`Expected ${t} to be a positive integer, but got ${uW(e)}.`))}function uW(e){return null===e?"null":Array.isArray(e)?"["+e.map((e=>uW(e))).join(",")+"]":"string"==typeof e?`"${e}"`:`${e}`}function dW(e){return"relu"===e?"relu":"linear"===e?"linear":"elu"===e?"elu":null}var cW=0;function pW(){return cW++}var hW={};function fW(e=""){return e in hW||(hW[e]=0),hW[e]+=1,e+hW[e].toString()}var mW=["channelsFirst","channelsLast"],gW=["nearest","bilinear"],bW=["valid","same","causal"],yW=["max","avg"],vW=["sum","mul","concat","ave"],xW=new Map;function wW(e){sW(mW,"DataFormat",e)}function kW(e){sW(bW,"PaddingMode",e)}function SW(e){sW(yW,"PoolMode",e)}var IW=[],NW="/";function CW(e,t){IW.push(e);try{let e=t();return IW.pop(),e}catch(_p){throw IW.pop(),_p}}function TW(e){if(!AW(e))throw new Error("Not a valid tensor name: '"+e+"'");return(0===IW.length?"":IW.join(NW)+NW)+e}function EW(e){if(!AW(e))throw new Error("Not a valid tensor name: '"+e+"'");xW.has(e)||xW.set(e,0);let t=xW.get(e);if(xW.set(e,xW.get(e)+1),t>0){let n=`${e}_${t}`;return xW.set(n,1),n}return e}var _W,$W=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function AW(e){return!!e.match($W)}function RW(e){return e===parseInt(e.toString(),10)}function DW(e,t,n){null==t&&(t=0),null==n&&(n=e.length);let r=1;for(let a=t;a<n;++a)r*=e[a];return r}function FW(e){if(0===e.length)return Number.NaN;let t=Number.POSITIVE_INFINITY;for(let n=0;n<e.length;n++){let r=e[n];r<t&&(t=r)}return t}function MW(e){if(0===e.length)return Number.NaN;let t=Number.NEGATIVE_INFINITY;for(let n=0;n<e.length;n++){let r=e[n];r>t&&(t=r)}return t}function OW(e,t){if(t<e)throw new VB(`end (${t}) < begin (${e}) is forbidden.`);let n=[];for(let r=e;r<t;++r)n.push(r);return n}function PW(){return null==_W&&(_W=t$().epsilon()),_W}function LW(e,t){return D_(e,t)}function zW(e,t=-1){let n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),M$(e,n)}function BW(e,t,n){return j_((()=>{switch(e.rank){case 1:return rF(e,t,n);case 2:return aF(e,[t,0],[n,e.shape[1]]);case 3:return iF(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return sF(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return W$(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return W$(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new VB(`sliceAlongFirstAxis() received an unsupported tensor rank: ${e.rank}`)}}))}function WW(e,t,n){return j_((()=>{switch(e.rank){case 1:return rF(e,t,n);case 2:return aF(e,[0,t],[e.shape[0],n]);case 3:return iF(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return sF(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new VB(`sliceAlongLastAxis() received an unsupported tensor rank: ${e.rank}`)}}))}function VW(e,t,n,r){return j_((()=>{switch(e.rank){case 1:return rF(e,t,n);case 2:switch(r){case 1:return BW(e,t,n);case 2:return WW(e,t,n);default:throw new VB(`The axis is not within the rank of the tensor ${r}`)}case 3:switch(r){case 1:return BW(e,t,n);case 2:return iF(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return WW(e,t,n);default:throw new VB(`The axis is not within the rank of the tensor ${r}`)}case 4:switch(r){case 1:return BW(e,t,n);case 2:return sF(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return sF(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return WW(e,t,n);default:throw new VB(`The axis is not within the rank of the tensor ${r}`)}default:throw new VB(`sliceAlongLastAxis() received an unsupported tensor rank: ${e.rank}`)}}))}function UW(e,t=-1){let n;return t<0&&(n=e[0].rank,t=0!==n?n:0),t===e[0].rank&&(t=-1),L$(e,t)}function jW(e,t){switch(e.rank){case 1:return rA([e,t]);case 2:return aA([e,t],0);case 3:return iA([e,t],0);case 4:return sA([e,t],0);default:throw new VB(`concatAlongFirstAxis() received an unsupported tensor rank: ${e.rank}`)}}function HW(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new VB(`The length of input n (${t.length}) does not match the number of dimensions in input x (${e.rank})`);return rR(e,t)}function GW(e,t=0,n=1,r,a){return MD(e,t,n,r,a)}function qW(e,t,n,r){if(e.rank<2||t.rank<2)throw new UB(`dot requires both inputs to be rank >= 2 but got x shape = ${e.shape} and y shape = ${t.shape}`);if(t.rank>=3&&e.shape.slice(-1)[0]!==t.shape.slice(-2)[0])throw new UB(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${e.shape} and  y shape = ${t.shape}`);if(2===e.rank&&2===t.rank)return XF.matMul({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?YW(e.rank,r,"channelsLast"):null,activation:n});{let a=e.shape.slice(),i=a.pop();e=M$(e,[-1,i]);let s=t.shape.slice(),o=s.pop(),l=s.pop(),u=[...s,o],d=Array.from({length:t.rank},((e,n)=>0===n?t.rank-2:n<=t.rank-2?n-1:n));t=M$(BF(t,d),[l,-1]);let c=[...a,...u],p=!1,h=!1;return M$(XF.matMul({a:e,b:t,transposeA:p,transposeB:h,bias:r?YW(e.rank,r,"channelsLast"):null,activation:n}),c)}}function KW(e,t,n){return j_((()=>(t=Array.isArray(t)?vF(t,"int32"):D_(t,"int32"),sR(e,t,n))))}function XW(e){return s$(e,e)}function YW(e,t,n){let r=t.shape;if(1!==t.rank&&t.rank!==e)throw new VB(`Unexpected bias dimensions: ${t.rank}; expected it to be 1 or ${e}`);if(5===e){if("channelsFirst"===n)return 1===r.length?M$(t,[1,r[0],1,1,1]):M$(t,[1,r[3],r[0],r[1],r[2]]);if("channelsLast"===n)return 1===r.length?M$(t,[1,1,1,1,r[0]]):M$(t,[1].concat(r))}else if(4===e){if("channelsFirst"===n)return 1===r.length?M$(t,[1,r[0],1,1]):M$(t,[1,r[2],r[0],r[1]]);if("channelsLast"===n)return 1===r.length?M$(t,[1,1,1,r[0]]):M$(t,[1].concat(r))}else if(3===e){if("channelsFirst"===n)return 1===r.length?M$(t,[1,r[0],1]):M$(t,[1,r[1],r[0]]);if("channelsLast"===n)return 1===r.length?M$(t,[1,1,r[0]]):M$(t,[1].concat(r))}else if(e<3)return t;throw new VB(`Unsupported input rank by biasAdd: ${t.rank}`)}function JW(e,t,n){return j_((()=>(null==n&&(n="channelsLast"),wW(n),r$(e,YW(e.rank,t,n)))))}function ZW(e,t,n,r){return j_((()=>HF(e,t,n,r)))}function QW(e,t,n=!1){return n?e():t()}var eV=["fanIn","fanOut","fanAvg"],tV=["normal","uniform","truncatedNormal"],nV=class extends uO.Serializable{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}},rV=class extends nV{apply(e,t){return HR(e,t)}};rV.className="Zeros",uO.registerClass(rV);var aV=class extends nV{apply(e,t){return GR(e,t)}};aV.className="Ones",uO.registerClass(aV);var iV=class extends nV{constructor(e){if(super(),"object"!=typeof e)throw new VB(`Expected argument of type ConstantConfig but got ${e}`);if(void 0===e.value)throw new VB(`config must have value set but got ${e}`);this.value=e.value}apply(e,t){return j_((()=>s$(qA(this.value),GR(e,t))))}getConfig(){return{value:this.value}}};iV.className="Constant",uO.registerClass(iV);var sV=class extends nV{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,t){return PD(e,this.minval,this.maxval,t,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}};sV.className="RandomUniform",uO.registerClass(sV);var oV=class extends nV{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new UB(`randomNormal does not support dType ${t}.`);return GW(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}};oV.className="RandomNormal",uO.registerClass(oV);var lV=class extends nV{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new UB(`truncatedNormal does not support dType ${t}.`);return AF(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}};lV.className="TruncatedNormal",uO.registerClass(lV);var uV=class extends nV{constructor(e){super(),this.gain=null!=e.gain?e.gain:1}apply(e,t){return j_((()=>{if(2!==e.length||e[0]!==e[1])throw new VB("Identity matrix initializer can only be used for 2D square matrices.");return s$(this.gain,aR(e[0]))}))}getConfig(){return{gain:this.gain}}};uV.className="Identity",uO.registerClass(uV);var dV=class extends nV{constructor(e){if(super(),e.scale<0)throw new VB(`scale must be a positive float. Got: ${e.scale}`);this.scale=null==e.scale?1:e.scale,this.mode=null==e.mode?"fanIn":e.mode,function(e){sW(eV,"FanMode",e)}(this.mode),this.distribution=null==e.distribution?"normal":e.distribution,function(e){sW(tV,"Distribution",e)}(this.distribution),this.seed=e.seed}apply(e,t){let n=function(e,t="channelsLast"){let n,r;if(wW(t),2===e.length)n=e[0],r=e[1];else if(-1!==[3,4,5].indexOf(e.length)){if("channelsFirst"===t){let t=DW(e,2);n=e[1]*t,r=e[0]*t}else if("channelsLast"===t){let t=DW(e,0,e.length-2);n=e[e.length-2]*t,r=e[e.length-1]*t}}else{let t=DW(e);n=Math.sqrt(t),r=Math.sqrt(t)}return[n,r]}(e),r=n[0],a=n[1],i=this.scale;if("fanIn"===this.mode?i/=Math.max(1,r):"fanOut"===this.mode?i/=Math.max(1,a):i/=Math.max(1,(r+a)/2),"normal"===this.distribution){let n=Math.sqrt(i);if("float32"!==(t=t||"float32")&&"int32"!==t)throw new UB(`${this.getClassName()} does not support dType ${t}.`);return AF(e,0,n,t,this.seed)}{let n=Math.sqrt(3*i);return PD(e,-n,n,t,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}};dV.className="VarianceScaling",uO.registerClass(dV);var cV=class extends dV{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return dV.className}};cV.className="GlorotUniform",uO.registerClass(cV);var pV=class extends dV{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return dV.className}};pV.className="GlorotNormal",uO.registerClass(pV);var hV=class extends dV{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return dV.className}};hV.className="HeNormal",uO.registerClass(hV);var fV=class extends dV{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return dV.className}};fV.className="HeUniform",uO.registerClass(fV);var mV=class extends dV{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return dV.className}};mV.className="LeCunNormal",uO.registerClass(mV);var gV=class extends dV{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return dV.className}};gV.className="LeCunUniform",uO.registerClass(gV);var bV=class extends nV{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=null==e.gain?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,t){return j_((()=>{if(e.length<2)throw new UB("Shape must be at least 2D.");if("int32"!==t&&"float32"!==t&&void 0!==t)throw new TypeError(`Unsupported data type ${t}.`);let n=pT.sizeFromShape(e.slice(0,-1)),r=e[e.length-1],a=n*r;a>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${a}) elements: Slowness may result.`);let i=GW([Math.max(r,n),Math.min(r,n)],0,1,t,this.seed),s=iO.qr(i,!1),o=s[0],l=s[1].flatten().stridedSlice([0],[Math.min(r,n)*Math.min(r,n)],[Math.min(r,n)+1]);return o=s$(o,l.sign()),n<r&&(o=o.transpose()),s$(qA(this.gain),o.reshape(e))}))}getConfig(){return{gain:this.gain,seed:this.seed}}};bV.className="Orthogonal",uO.registerClass(bV);var yV={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function vV(e,t={}){return nW(e,uO.SerializationMap.getMap().classNameMap,t,"initializer")}function xV(e){return eW(e)}function wV(e){if("string"==typeof e){let t=e in yV?yV[e]:e;if("GlorotNormal"===t)return new pV;if("GlorotUniform"===t)return new cV;if("HeNormal"===t)return new hV;if("HeUniform"===t)return new fV;if("LeCunNormal"===t)return new mV;if("LeCunUniform"===t)return new gV;{let e={};return e.className=t,e.config={},vV(e)}}return e instanceof nV?e:vV(e)}function kV(e){return Array.isArray(e)&&Array.isArray(e[0])}function SV(e){return 0===e.length?[]:Array.isArray(e[0])?e:[e]}function IV(e){let t;if(Array.isArray(e)){if(1!==e.length)throw new VB(`Expected Tensor length to be 1; got ${e.length}`);t=e[0]}else t=e;return t}function NV(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(1===e.length)return e[0];throw new VB(`Expected exactly 1 Shape; got ${e.length}`)}return e}function CV(e){let t=0;for(let n of e)0===n.shape.length?t+=1:t+=n.shape.reduce(((e,t)=>e*t));return t}var TV="Variable",EV=class{constructor(e,t="float32",n=TV,r=!0,a=null){this.dtype=null==t?"float32":t,this.shape=e.shape,this.id=pW(),n=null==n?TV:n,this.originalName=TW(n),this.name=EW(this.originalName),this.trainable_=r,this.constraint=a,this.val=OF(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),function(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}(this.val,e),this.val.id!==e.id&&(this.val.assign(e),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}};function _V(e){return e.map((e=>e.read()))}function $V(e){e.forEach((e=>{e[0].write(e[1])}))}var AV=class{constructor(e){this.dtype=e.dtype,this.shape=e.shape,null!=e.shape?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}},RV=class{constructor(e,t,n,r,a,i,s){this.dtype=e,this.shape=t,this.sourceLayer=n,this.inputs=r,this.callArgs=a,this.outputTensorIndex=s,this.id=pW(),null!=i&&(this.originalName=TW(i),this.name=EW(this.originalName)),this.rank=t.length}},DV=0,FV=class{constructor(e,t){this.callArgs=t,this.id=DV++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(let n of e.inboundLayers)null!=n&&n.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){let e=[];for(let t of this.inboundLayers)null!=t?e.push(t.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}},MV=0,OV=class extends uO.Serializable{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=MV++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let t=e.name;if(!t){let e=this.getClassName();t=JB(e)+"_"+fW(e)}if(this.name=t,this.trainable_=null==e.trainable||e.trainable,null!=e.inputShape||null!=e.batchInputShape){let t;if(null!=e.batchInputShape)t=e.batchInputShape;else if(null!=e.inputShape){let n=null;null!=e.batchSize&&(n=e.batchSize),t=[n].concat(e.inputShape)}this.batchInputShape=t;let n=e.dtype;null==n&&(n=e.inputDType),null==n&&(n="float32"),this.dtype=n}null!=e.weights?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,t){return e.name+"_ib-"+t.toString()}getNodeAtIndex(e,t){if(0===this.inboundNodes.length)throw new WB(`The layer has never been called and thus has no defined ${t}.`);if(this.inboundNodes.length<=e)throw new VB(`Asked to get ${t} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return XB(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return XB(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new BB(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(0===this.inboundNodes.length)throw new BB(`Layer ${this.name} is not connected, no input to return.`);return XB(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(0===this.inboundNodes.length)throw new BB(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new BB(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return XB(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map((e=>e()))}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach((t=>t.trainable=e)),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter((e=>e.trainable)):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter((e=>!e.trainable)).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){if(e=YB(e),null==this.inputSpec||0===this.inputSpec.length)return;let t=YB(this.inputSpec);if(e.length!==t.length)throw new VB(`Layer ${this.name} expects ${t.length} inputs, but it received ${e.length} input tensors. Input received: ${e}`);for(let n=0;n<e.length;n++){let r=e[n],a=t[n];if(null==a)continue;let i=r.rank;if(null!=a.ndim&&i!==a.ndim)throw new VB(`Input ${n} is incompatible with layer ${this.name}: expected ndim=${a.ndim}, found ndim=${i}`);if(null!=a.maxNDim&&i>a.maxNDim)throw new VB(`Input ${n} is incompatible with layer ${this.name}: expected max_ndim=${a.maxNDim}, found ndim=${i}`);if(null!=a.minNDim&&i<a.minNDim)throw new VB(`Input ${n} is incompatible with layer ${this.name}: expected min_ndim=${a.minNDim}, found ndim=${i}.`);if(null!=a.dtype&&r.dtype!==a.dtype)throw new VB(`Input ${n} is incompatible with layer ${this.name} : expected dtype=${a.dtype}, found dtype=${r.dtype}.`);if(a.axes){let e=r.shape;for(let t in a.axes){let r=Number(t),i=a.axes[t],s=r>=0?e[r]:e[e.length+r];if(null!=i&&-1===[i,null].indexOf(s))throw new VB(`Input ${n} is incompatible with layer ${this.name}: expected axis ${r} of input shape to have value ${i} but got shape ${e}.`)}}if(null!=a.shape)for(let e=0;e<a.shape.length;++e){let t=a.shape[e],i=r.shape[e];if(null!=t&&null!=i&&t!==i)throw new VB(`Input ${n} is incompatible with layer ${this.name}: expected shape=${a.shape}, found shape=${r.shape}.`)}}}call(e,t){return e}invokeCallHook(e,t){null!=this._callHook&&this._callHook(e,t)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,t){t=t||{},this.assertNotDisposed();let n=YB(e),r=!0;for(let i of n)if(!(i instanceof RV)){r=!1;break}let a=!0;for(let i of n)if(i instanceof RV){a=!1;break}if(r===a)throw new VB("Arguments to apply() must be all SymbolicTensors or all Tensors");return CW(this.name,(()=>{if(!this.built){this.assertInputCompatibility(e);let t=[];for(let n of YB(e))t.push(n.shape);this.build(XB(t)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),null===this._refCount&&a&&(this._refCount=1)}if(this.assertInputCompatibility(e),a){let r=this.call(e,t),a=YB(r),i=[];for(let e of a)-1!==n.indexOf(e)&&(e=e.clone()),i.push(e);if(r=XB(i),null!=this.activityRegularizer)throw new UB("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return r}{let n,r=function(e){e=YB(e);let t=[];for(let n of e)t.push(n.shape);return XB(t)}(e),a=this.computeOutputShape(r),i="float32";if(this.warnOnIncompatibleInputShape(Array.isArray(e)?r[0]:r),n=null!=a&&a.length>0&&Array.isArray(a[0])?a.map(((n,r)=>new RV(i,n,this,YB(e),t,this.name,r))):new RV(i,a,this,YB(e),t,this.name),this.addInboundNode(e,n,null,null,r,a,t),this._refCount++,null!=this.activityRegularizer)throw new UB("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return n}}))}warnOnIncompatibleInputShape(e){if(null!=this.batchInputShape)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let t=!1;this.batchInputShape.forEach(((n,r)=>{null!=n&&null!=e[r]&&e[r]!==n&&(t=!0)})),t&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new BB(`The layer ${this.name} has never been called and thus has no defined output shape.`);let e=[];for(let t of this.inboundNodes){let n=JSON.stringify(t.outputShapes);-1===e.indexOf(n)&&e.push(n)}if(1===e.length){let e=this.inboundNodes[0].outputShapes;return Array.isArray(e)&&Array.isArray(e[0])&&1===e.length?e[0]:e}throw new BB(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new WB(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return CV(this.weights)}build(e){this.built=!0}getWeights(e=!1){return _V(e?this.trainableWeights:this.weights)}setWeights(e){j_((()=>{let t=this.weights;if(t.length!==e.length)throw new VB(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${t.length} weights. Provided weights: ${e}...`);if(0===t.length)return;let n=[],r=_V(t);for(let a=0;a<r.length;++a){let i=r[a],s=t[a],o=e[a];if(!pT.arraysEqual(i.shape,o.shape))throw new VB(`Layer weight shape ${i.shape} not compatible with provided weight shape ${o.shape}`);n.push([s,o])}$V(n)}))}addWeight(e,t,n,r,a,i,s,o){if(-1!==this._addedWeightNames.indexOf(e))throw new VB(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),null==n&&(n="float32"),this.fastWeightInitDuringBuild&&(r=null!=o?o():wV("zeros"));let l=r.apply(t,n),u=new EV(l,n,e,i,s);return l.dispose(),null!=a&&this.addLoss((()=>a.apply(u.read()))),null==i&&(i=!0),i?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){null==e||Array.isArray(e)&&0===e.length||(e=YB(e),void 0!==this._losses&&null!==this._losses&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,t){if(!this.supportsMasking){if(null!=t){if(!Array.isArray(t))throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);t.forEach((e=>{if(null!=e)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)}))}return null}return t}addInboundNode(e,t,n,r,a,i,s=null){let o=YB(e);t=YB(t),n=YB(n),r=YB(r),a=SV(a),i=SV(i);let l=[],u=[],d=[];for(let c of o)l.push(c.sourceLayer),u.push(c.nodeIndex),d.push(c.tensorIndex);new FV({outboundLayer:this,inboundLayers:l,nodeIndices:u,tensorIndices:d,inputTensors:o,outputTensors:t,inputMasks:n,outputMasks:r,inputShapes:a,outputShapes:i},s);for(let c=0;c<t.length;c++)t[c].sourceLayer=this,t[c].nodeIndex=this.inboundNodes.length-1,t[c].tensorIndex=c}getConfig(){let e={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(e.batchInputShape=this.batchInputShape),null!=this.dtype&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach((e=>e.dispose())),this.weights.length}assertNotDisposed(){if(0===this._refCount)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(null===this._refCount)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return 0==--this._refCount&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}};function PV(e,t,n){if((null==t||null!=n&&n>0)&&(t=e.sourceLayer,n=e.nodeIndex),0===t.inboundNodes.length)return[e];{let e=t.inboundNodes[n];if(0===e.inboundLayers.length)return e.inputTensors;{let t=[];for(let n=0;n<e.inboundLayers.length;n++){let r=PV(e.inputTensors[n],e.inboundLayers[n],e.nodeIndices[n]);for(let e of r)-1===t.indexOf(e)&&t.push(e)}return t}}}var LV=class extends OV{constructor(e){if(super({dtype:e.dtype,name:null!=e.name?e.name:fW("input").toString()}),null==e.batchSize&&(e.batchSize=null),null==e.sparse&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,null!=e.inputShape&&null!=e.batchInputShape)throw new VB("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let t=e.batchInputShape;if(null==t){if(null==e.inputShape)throw new VB("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");t=[e.batchSize].concat(e.inputShape)}else if(null!=e.batchSize)throw new VB("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");let n=e.dtype||"float32";this.batchInputShape=t,this.dtype=n,this.inputSpec=[{shape:t}];let r=new RV(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new FV({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[t],outputShapes:[t]})}apply(e,t){throw new VB(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}};function zV(e){if(null==e.batchShape&&null==e.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=e.batchShape&&null!=e.shape)throw new VB("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let t=e.batchShape;null!=e.shape&&null==t&&(t=[null].concat(e.shape));let n=e.dtype;return null==n&&(n="float32"),new LV({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}LV.className="InputLayer",uO.registerClass(LV);var BV=class{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof BV)for(let t in e.id2Value)this.id2Value[t]=e.id2Value[t],t in e.id2Mask&&(this.id2Mask[t]=e.id2Mask[t]);else{if(null==e)return;for(let t of e)this.add(t.key,t.value)}}add(e,t,n){if(null!=this.id2Value[e.id])throw new VB(`Duplicate key: name=${e.name}, id=${e.id}`);return this.id2Value[e.id]=function(e,t){if(null==e.dtype||e.dtype===t.dtype)return t;try{return D_(t,e.dtype)}catch(n){throw new VB(`The dtype of the feed (${t.dtype}) can not be cast to the dtype of the key '${e.name}' (${e.dtype}).`)}}(e,t),this.name2Id[e.name]=e.id,null!=n&&(this.id2Mask[e.id]=n),this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return null!=this.id2Value[e.id]}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof RV){if(null==this.id2Value[e.id])throw new VB(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}{let t=this.name2Id[e];if(null==t)throw new VB(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[t]}}getMask(e){if(e instanceof RV){if(null==this.id2Value[e.id])throw new VB(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}{let t=this.name2Id[e];if(null==t)throw new VB(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[t]}}disposeMasks(){null!=this.id2Mask&&H_(this.id2Mask)}},WV=new HB,VV=new HB;function UV(e,t,n,r){let a=null!=n&&n.training,i=Array.isArray(e),s=i?e:[e],o=s.map((e=>e.name)),l=[],u=t.names();for(let f of o)-1!==u.indexOf(f)?l.push(t.getValue(f)):l.push(null);null!=r&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);let d,c=o.join(",")+"|"+t.names().sort().join(","),p=WV.get(c);if(null==p){let e=function(e,t){pT.assert(null!=e&&e.length>0,(()=>"Expected at least one fetch, got none"));let n=[],r={};if(1===e.length){let a=HV(e[0],t);n=a.sorted,r=a.recipientMap}else{let a=new Set;for(let i of e){let{sorted:e,recipientMap:s}=HV(i,t);for(let t of e)a.has(t.name)||(n.push(t),a.add(t.name));for(let t in s)null==r[t]&&(r[t]=new Set),s[t].forEach((e=>r[t].add(e)))}}return{sorted:n,recipientCounts:jV(r)}}(s,t);p=e.sorted,d=e.recipientCounts,WV.put(c,p),VV.put(c,d)}d={},a||Object.assign(d,VV.get(c));let h=new BV(t);for(let f=0;f<p.length;++f){if(null!=r){let e=V_().numTensors;e>r.maxNumTensors&&(r.maxNumTensors=e),e<r.minNumTensors&&(r.minNumTensors=e)}let e=p[f],i=e.sourceLayer;if(i instanceof LV)continue;let s=[],u=[],c=[],m=!1;for(let n of e.inputs){let e=h.getValue(n),r=h.getMask(n);s.push(e),u.push(r),null!=r&&(m=!0),a||(d[n.name]--,0===d[n.name]&&!t.hasKey(n)&&-1===o.indexOf(n.name)&&!e.isDisposed&&!0!==n.sourceLayer.stateful&&c.push(e))}m&&((n=n||{}).mask=u[0]);let g=YB(i.apply(s,n)),b=null;i.supportsMasking&&(b=i.computeMask(s,u));let y=GV(e),v=Array.isArray(y)?y:[y];for(let t=0;t<v.length;++t){h.hasKey(v[t])||h.add(v[t],g[t],Array.isArray(b)?b[0]:b);let e=o.indexOf(v[t].name);-1!==e&&(l[e]=g[t])}a||H_(c)}return h.disposeMasks(),i?l:l[0]}function jV(e){let t={};for(let n in e)t[n]=e[n].size;return t}function HV(e,t){let n=new Set,r=[],a={};for(let o of t.names())n.add(o);let i=[],s=[];for(i.push(e);i.length>0;){let e=i[i.length-1];if(n.has(e.name)){i.pop();continue}let t=s[s.length-1]===i.length-1;if(0===e.inputs.length||t)i.pop(),r.push(e),n.add(e.name),t&&s.pop();else{s.push(i.length-1);for(let t of e.inputs)null==a[t.name]&&(a[t.name]=new Set),a[t.name].add(e.name),!n.has(t.name)&&i.push(t)}}return{sorted:r,recipientMap:a}}function GV(e){let t;if(1===e.sourceLayer.inboundNodes.length)t=e.sourceLayer.output;else{let n=null;for(let t=0;t<e.sourceLayer.inboundNodes.length;++t)for(let r of e.sourceLayer.inboundNodes[t].outputTensors)if(r.id===e.id){n=t;break}t=e.sourceLayer.getOutputAt(n)}return t}$S().registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",(()=>100),(function(e){null!=WV&&WV.setMaxEntries(e),null!=VV&&VV.setMaxEntries(e)}));var qV={};function KV(e,t){return j_((()=>KA(YA(s$(e,e),t,!0))))}ok(qV,{maxNorm:()=>aU,minMaxNorm:()=>oU,nonNeg:()=>sU,unitNorm:()=>iU});var XV=class extends uO.Serializable{getConfig(){return{}}},YV=class extends XV{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=null!=e.maxValue?e.maxValue:this.defaultMaxValue,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return j_((()=>{let t=KV(e,this.axis),n=nA(t,0,this.maxValue);return s$(e,i$(n,r$(PW(),t)))}))}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}};YV.className="MaxNorm",uO.registerClass(YV);var JV=class extends XV{constructor(e){super(),this.defaultAxis=0,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return j_((()=>i$(e,r$(PW(),KV(e,this.axis)))))}getConfig(){return{axis:this.axis}}};JV.className="UnitNorm",uO.registerClass(JV);var ZV=class extends XV{apply(e){return VD(e)}};ZV.className="NonNeg",uO.registerClass(ZV);var QV=class extends XV{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=null!=e.minValue?e.minValue:this.defaultMinValue,this.maxValue=null!=e.maxValue?e.maxValue:this.defaultMaxValue,this.rate=null!=e.rate?e.rate:this.defaultRate,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return j_((()=>{let t=KV(e,this.axis),n=r$(s$(this.rate,nA(t,this.minValue,this.maxValue)),s$(1-this.rate,t));return s$(e,i$(n,r$(PW(),t)))}))}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}};QV.className="MinMaxNorm",uO.registerClass(QV);var eU={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function tU(e){return eW(e)}function nU(e,t={}){return nW(e,uO.SerializationMap.getMap().classNameMap,t,"constraint")}function rU(e){return null==e?null:"string"==typeof e?nU({className:e in eU?eU[e]:e,config:{}}):e instanceof XV?e:nU(e)}function aU(e){return new YV(e)}function iU(e){return new JV(e)}function sU(){return new ZV}function oU(e){return new QV(e)}var lU={};function uU(){return new rV}function dU(){return new aV}function cU(e){return new iV(e)}function pU(e){return new sV(e)}function hU(e){return new oV(e)}function fU(e){return new lV(e)}function mU(e){return new uV(e)}function gU(e){return new dV(e)}function bU(e){return new cV(e)}function yU(e){return new pV(e)}function vU(e){return new hV(e)}function xU(e){return new fV(e)}function wU(e){return new mV(e)}function kU(e){return new gV(e)}function SU(e){return new bV(e)}ok(lU,{constant:()=>cU,glorotNormal:()=>yU,glorotUniform:()=>bU,heNormal:()=>vU,heUniform:()=>xU,identity:()=>mU,leCunNormal:()=>wU,leCunUniform:()=>kU,ones:()=>dU,orthogonal:()=>SU,randomNormal:()=>hU,randomUniform:()=>pU,truncatedNormal:()=>fU,varianceScaling:()=>gU,zeros:()=>uU});var IU,NU={};async function CU(e){if(null==e)return;let t=[],n=[],r=[];for(let a in e){let i=e[a];if("number"!=typeof i){let e=i;t.push(e.data()),n.push(a),r.push(e)}}if(t.length>0){let a=await Promise.all(t);for(let t=0;t<a.length;++t)e[n[t]]=a[t][0];H_(r)}}function TU(e){if(null!=e)for(let t in e){let n=e[t];"number"!=typeof n&&n.dispose()}}ok(NU,{Layer:()=>OV,RNN:()=>zH,RNNCell:()=>BH,activation:()=>yq,add:()=>Tq,alphaDropout:()=>bK,average:()=>Eq,averagePooling1d:()=>Pq,averagePooling2d:()=>Bq,averagePooling3d:()=>Uq,avgPool1d:()=>Lq,avgPool2d:()=>Wq,avgPool3d:()=>jq,avgPooling1d:()=>zq,avgPooling2d:()=>Vq,avgPooling3d:()=>Hq,batchNormalization:()=>Fq,bidirectional:()=>uK,categoryEncoding:()=>kK,centerCrop:()=>xK,concatenate:()=>_q,conv1d:()=>uq,conv2d:()=>dq,conv2dTranspose:()=>cq,conv3d:()=>pq,conv3dTranspose:()=>hq,convLstm2d:()=>iK,convLstm2dCell:()=>sK,cropping2D:()=>mq,dense:()=>vq,depthwiseConv2d:()=>bq,dot:()=>Dq,dropout:()=>xq,elu:()=>rq,embedding:()=>Cq,flatten:()=>kq,gaussianDropout:()=>gK,gaussianNoise:()=>mK,globalAveragePooling1d:()=>Gq,globalAveragePooling2d:()=>qq,globalMaxPool1d:()=>cK,globalMaxPool2d:()=>pK,globalMaxPooling1d:()=>Kq,globalMaxPooling2d:()=>Xq,gru:()=>Qq,gruCell:()=>eK,input:()=>Bj,inputLayer:()=>nq,layerNormalization:()=>Mq,leakyReLU:()=>iq,lstm:()=>tK,lstmCell:()=>nK,masking:()=>yK,maxPool1d:()=>hK,maxPool2d:()=>fK,maxPooling1d:()=>Yq,maxPooling2d:()=>Jq,maxPooling3d:()=>Zq,maximum:()=>$q,minimum:()=>Aq,multiply:()=>Rq,permute:()=>Nq,prelu:()=>sq,randomWidth:()=>SK,reLU:()=>aq,repeatVector:()=>Sq,rescaling:()=>vK,reshape:()=>Iq,resizing:()=>wK,rnn:()=>oK,separableConv2d:()=>fq,simpleRNN:()=>rK,simpleRNNCell:()=>aK,softmax:()=>oq,spatialDropout1d:()=>wq,stackedRNNCells:()=>lK,thresholdedReLU:()=>lq,timeDistributed:()=>dK,upSampling2d:()=>gq,zeroPadding2d:()=>Oq}),function(e){e[e.SILENT=0]="SILENT",e[e.VERBOSE=1]="VERBOSE"}(IU||(IU={}));var EU=class{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,t){}async onEpochEnd(e,t){}async onBatchBegin(e,t){}async onBatchEnd(e,t){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}},_U=class{constructor(e,t=10){null==e&&(e=[]),this.callbacks=e,this.queueLength=t}append(e){this.callbacks.push(e)}setParams(e){for(let t of this.callbacks)t.setParams(e)}setModel(e){for(let t of this.callbacks)t.setModel(e)}async onEpochBegin(e,t){null==t&&(t={});for(let n of this.callbacks)await n.onEpochBegin(e,t)}async onEpochEnd(e,t){null==t&&(t={});for(let n of this.callbacks)await n.onEpochEnd(e,t)}async onBatchBegin(e,t){null==t&&(t={});for(let n of this.callbacks)await n.onBatchBegin(e,t)}async onBatchEnd(e,t){null==t&&(t={});for(let n of this.callbacks)await n.onBatchEnd(e,t)}async onTrainBegin(e){null==e&&(e={});for(let t of this.callbacks)await t.onTrainBegin(e)}async onTrainEnd(e){null==e&&(e={});for(let t of this.callbacks)await t.onTrainEnd(e)}},$U=class extends EU{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,t){null==t&&(t={});let n=null==t.size?0:t.size;this.seen+=n;for(let r in t){let e=t[r];if("number"==typeof e)this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+e*n;else{let t;r in this.totals?t=this.totals[r]:this.totals[r]=0;let a=j_((()=>r$(this.totals[r],s$(e,n))));this.totals[r]=a,null!=t&&t.dispose()}}}async onEpochEnd(e,t){if(null!=t)for(let n of this.params.metrics)null!=this.totals[n]&&("number"==typeof this.totals[n]?t[n]=this.totals[n]/this.seen:j_((()=>{let e=s$(i$(1,this.seen),this.totals[n]);t[n]=e,this.totals[n].dispose(),G_(t[n])})))}},AU=class extends EU{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,t){null==t&&(t={}),this.epoch.push(e);for(let n in t)null==this.history[n]&&(this.history[n]=[]),this.history[n].push(t[n])}async syncData(){let e=[],t=[],n=[];for(let a in this.history){let r=this.history[a];for(let i=0;i<r.length;++i)if("number"!=typeof r[i]){let s=r[i];e.push(s.data()),t.push(a),n.push(i)}}let r=await Promise.all(e);for(let a=0;a<r.length;++a)this.history[t[a]][n[a]].dispose(),this.history[t[a]][n[a]]=r[a][0]}},RU=class extends EU{constructor(e,t){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||TP,this.yieldEvery=t||"auto","auto"===this.yieldEvery&&(this.yieldEvery=125),"never"===this.yieldEvery&&null!=e.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");pT.isNumber(this.yieldEvery)&&(this.maybeWait=function(e,t,n){let r,a=null!=n?n():pT.now();return(...i)=>{let s=null!=n?n():pT.now();return s-a<t||(a=s,r=e(...i)),r}}(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,t,n){let r=[];null!=this.yield&&(await CU(n),r.push(this.yield(e,t,n))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(e,t){this.currentEpoch=e,null!=this.epochBegin&&(await CU(t),await this.epochBegin(e,t))}async onEpochEnd(e,t){let n=[];null!=this.epochEnd&&(await CU(t),n.push(this.epochEnd(e,t))),"epoch"===this.yieldEvery&&n.push(this.nextFrameFunc()),await Promise.all(n)}async onBatchBegin(e,t){null!=this.batchBegin&&(await CU(t),await this.batchBegin(e,t))}async onBatchEnd(e,t){let n=[];null!=this.batchEnd&&(await CU(t),n.push(this.batchEnd(e,t))),"batch"===this.yieldEvery?n.push(this.nextFrameFunc()):pT.isNumber(this.yieldEvery)&&n.push(this.maybeWait(this.currentEpoch,e,t)),await Promise.all(n)}async onTrainBegin(e){null!=this.trainBegin&&(await CU(e),await this.trainBegin(e))}async onTrainEnd(e){null!=this.trainEnd&&(await CU(e),await this.trainEnd(e))}};function DU(e,t){return null==e&&(e={}),e instanceof EU?[e]:Array.isArray(e)&&e[0]instanceof EU?e:YB(e).map((e=>new RU(e,t)))}var FU=class{constructor(){}static registerCallbackConstructor(e,t){pT.assert(e>=0&&Number.isInteger(e),(()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`)),FU.checkForDuplicate(t),null==FU.constructors[e]&&(FU.constructors[e]=[]),FU.constructors[e].push(t)}static checkForDuplicate(e){for(let t in FU.constructors)FU.constructors[+t].forEach((t=>{if(t===e)throw new VB("Duplicate callback constructor.")}))}static clear(){FU.constructors={}}static createCallbacks(e){let t=[];for(let n in FU.constructors){let r=+n;e>=r&&t.push(...FU.constructors[r])}return t.map((e=>new e))}};function MU(e,t,n,r,a,i,s,o,l){let u=new AU,d=[new $U,...FU.createCallbacks(t)];null!=e&&d.push(...e),d.push(u);let c=new _U(d);return c.setParams({epochs:n,initialEpoch:r,samples:a,steps:i,batchSize:s,verbose:t,doValidation:o,metrics:l}),{callbackList:c,history:u}}function OU(e,t={},n=!1){return nW(e,uO.SerializationMap.getMap().classNameMap,t,"layer",n)}function PU(e,t){return j_((()=>{"float32"!==e.dtype&&(e=D_(e,"float32"));let n=YA(XW(e),t,!0),r=tA(n.shape,PW()),a=KA(UR(n,r));return i$(e,a)}))}function LU(e,t){return j_((()=>jR(XW($R(t,e)),-1)))}function zU(e,t){return j_((()=>jR(o$($R(t,e)),-1)))}function BU(e,t){return j_((()=>{let n=$R(e,t),r=nA(o$(e),PW(),Number.MAX_VALUE),a=o$(i$(n,r));return s$(100,jR(a,-1))}))}function WU(e,t,n=!1){return j_((()=>{if(n)t=oF(t);else{let e=YA(t,t.shape.length-1,!0);t=i$(t,e)}return t=nA(t,PW(),1-PW()),TR(YA(s$(D_(e,"float32"),yR(t)),t.shape.length-1))}))}function VU(e,t,n=!1){return j_((()=>{let r=D_(iR(function(e){let t=[DW(e.shape)];return M$(e,t)}(e)),"int32"),a=(t=nA(t,PW(),1-PW())).shape;return WU(M$(tD(r,a[a.length-1]),a),t,n)}))}function UU(e,t){return j_((()=>{let n;return n=nA(t,PW(),1-PW()),n=yR(i$(n,$R(1,n))),jR(function(e,t){if(!pT.arraysEqual(e.shape,t.shape))throw new VB(`logits and labels must have the same shape, but got shapes ${JSON.stringify(e.shape)} and ${JSON.stringify(t.shape)}`);return j_((()=>{let n=VD(t),r=TR(o$(t));return r$($R(n,s$(t,e)),vR(eR(r)))}))}(e,n),-1)}))}function jU(e,t){return j_((()=>{let n=PU(e,-1),r=PU(t,-1),a=s$(n,r);return TR(YA(a,-1))}))}FU.constructors={};var HU={meanSquaredError:LU,meanAbsoluteError:zU,meanAbsolutePercentageError:BU,meanSquaredLogarithmicError:function(e,t){return j_((()=>{let n=nA(t,PW(),Number.MAX_VALUE),r=yR(r$(1,n)),a=nA(e,PW(),Number.MAX_VALUE),i=yR(r$(1,a));return jR(XW($R(r,i)),-1)}))},squaredHinge:function(e,t){return j_((()=>{let n=UR(0,$R(1,s$(e,t)));return jR(XW(n),-1)}))},hinge:function(e,t){return j_((()=>{let n=UR(0,$R(1,s$(e,t)));return jR(n,-1)}))},categoricalHinge:function(e,t){return j_((()=>{let n=YA(s$(e,t),-1),r=jA(s$($R(1,e),t),-1);return UR(0,r$(1,$R(r,n)))}))},logcosh:function(e,t){return j_((()=>{let n=Math.log(2),r=$R(t,e),a=$R(r$(r,ER(s$(-2,r))),n);return jR(a,-1)}))},categoricalCrossentropy:WU,sparseCategoricalCrossentropy:VU,binaryCrossentropy:UU,kullbackLeiblerDivergence:function(e,t){return j_((()=>{let n=nA(e,PW(),1),r=nA(t,PW(),1);return YA(s$(e,yR(i$(n,r))),-1)}))},poisson:function(e,t){return j_((()=>{let n=yR(r$(PW(),t));return jR($R(t,s$(e,n)),-1)}))},cosineProximity:jU};function GU(e){if("string"==typeof e){if(e in HU)return HU[e];let t=`Unknown loss ${e}`;throw e.toLowerCase().includes("softmaxcrossentropy")&&(t=`Unknown loss ${e}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new VB(t)}return e}function qU(e,t){return j_((()=>{let n=s$(.5,nD(t)),r=LW(oR(t,n),e.dtype);return jR(TA(e,r),-1)}))}function KU(e,t){return j_((()=>LW(TA(h$(e,-1),h$(t,-1)),"float32")))}function XU(e,t){return j_((()=>D_(YA(DR(TA(e,1),TA(t,1))),"float32")))}function YU(e,t){return j_((()=>{let n=XU(e,t),r=function(e,t){return j_((()=>D_(YA(DR(TA(e,0),TA(t,1))),"float32")))}(e,t),a=r$(n,r);return D_(EA(oR(a,0),i$(n,a),0),"float32")}))}function JU(e,t){return j_((()=>{let n=XU(e,t),r=function(e,t){return j_((()=>D_(YA(DR(TA(e,1),TA(t,0))),"float32")))}(e,t),a=r$(n,r);return D_(EA(oR(a,0),i$(n,a),0),"float32")}))}function ZU(e,t){return UU(e,t)}function QU(e,t){return e.rank===t.rank&&(e=fF(e,[e.rank-1])),(t=h$(t,-1)).dtype!==e.dtype&&(t=D_(t,e.dtype)),D_(TA(e,t),"float32")}var ej=WU,tj=VU,nj={binaryAccuracy:qU,categoricalAccuracy:KU,precision:YU,categoricalCrossentropy:ej,sparseCategoricalCrossentropy:tj,mse:LU,MSE:LU,mae:zU,MAE:zU,mape:BU,MAPE:BU,cosine:jU};function rj(e){if("string"==typeof e&&e in nj)return nj[e];if("string"!=typeof e&&null!=e)return e;throw new VB(`Unknown metric ${e}`)}function aj(e){if(qB(null!==e,`Unknown LossOrMetricFn ${e}`),"string"==typeof e)return e;{let t;for(let n of Object.keys(HU))if(HU[n]===e){t=n;break}if(void 0!==t)return t;for(let n of Object.keys(nj))if(nj[n]===e){t=n;break}return void 0!==t?t:e.name}}function ij(e,t,n=!1){if(null==e||"object"!=typeof e||Object.getPrototypeOf(e)!==Object.prototype||!sj(e))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){let n=JSON.stringify(e);n.length>1048576&&console.warn(`User-defined metadata of model "${t}" is too large in size (length=${n.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= 1048576.`)}}function sj(e){if(null===e)return!0;if("object"==typeof e){if(Object.getPrototypeOf(e)===Object.prototype){let t=Object.keys(e);for(let n of t)if("string"!=typeof n||!sj(e[n]))return!1;return!0}if(Array.isArray(e)){for(let t of e)if(!sj(t))return!1;return!0}return!1}{let t=typeof e;return"string"===t||"number"===t||"boolean"===t}}function oj(e,t,n,r=console.log){let a,i=function(e){let t=!0,n=[],r=[];for(let a in e.nodesByDepth)n.push(e.nodesByDepth[a]);for(let a of n){if(a.length>1||1===a.length&&a[0].inboundLayers.length>1){t=!1;break}r.push(...a)}if(t)for(let a of e.layers){let e=!1;for(let n of a.inboundNodes)if(-1!==r.indexOf(n)){if(e){t=!1;break}e=!0}if(!t)break}return t}(e),s=["Layer (type)","Input Shape","Output shape","Param #"];if(i?(t=t||90,n=n||[.32,.61,.89,1]):(t=t||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map((e=>Math.floor(t*e)))),!i){s.push("Receives inputs"),a=[];for(let t in e.nodesByDepth)a.push(...e.nodesByDepth[t])}r("_".repeat(t)),lj(s,n,r),r("=".repeat(t));let o=e.layers;for(let d=0;d<o.length;++d)i?uj(o[d],n,r):dj(o[d],n,a,r),r((d===o.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();let l=function(e){let t;return t=null!=e.collectedTrainableWeights?CV(e.collectedTrainableWeights):CV(e.trainableWeights),t}(e),u=CV(e.nonTrainableWeights);r(`Total params: ${l+u}`),r(`Trainable params: ${l}`),r(`Non-trainable params: ${u}`),r("_".repeat(t))}function lj(e,t,n=console.log){let r="";for(let a=0;a<e.length;++a)a>0&&(r=r.slice(0,r.length-1)+" "),r+=e[a],r=r.slice(0,t[a]),r+=" ".repeat(t[a]-r.length);n(r)}function uj(e,t,n){let r,a;try{a=e.inboundNodes.map((e=>JSON.stringify(e.inputShapes))).join(",")}catch(Tp){a="multiple"}try{r=JSON.stringify(e.outputShape)}catch(Tp){r="multiple"}lj([`${e.name} (${e.getClassName()})`,a,r,e.countParams().toString()],t,n)}function dj(e,t,n,r){let a,i;try{i=e.inboundNodes.map((e=>JSON.stringify(e.inputShapes))).join(",")}catch(wp){i="multiple"}try{a=JSON.stringify(e.outputShape)}catch(wp){a="multiple"}let s=[];for(let d of e.inboundNodes)if(!(null!=n&&n.length>0&&-1===n.indexOf(d)))for(let e=0;e<d.inboundLayers.length;++e){let t=d.inboundLayers[e].name,n=d.nodeIndices[e],r=d.tensorIndices[e];s.push(`${t}[${n}][${r}]`)}let o=e.name,l=e.getClassName(),u=0===s.length?"":s[0];lj([`${o} (${l})`,i,a,e.countParams().toString(),u],t,r);for(let d=1;d<s.length;++d)lj(["","","","",s[d]],t,r)}function cj(e,t,n){return("inboundNodes"===e||"outputLayers"===e||"inputLayers"===e)&&0===t&&"string"==typeof n}function pj(e,t){if(null===e)return null;if("string"==typeof e)return ZB(e);if("number"==typeof e||"boolean"==typeof e)return e;if(e instanceof Array){let n=[],r=e.length;for(let a=0;a<r;++a){let r=e[a];cj(t,a,r)?n.push(r):n.push(pj(r,t))}return n}{let t={};for(let n of Object.keys(e)){let r=e[n];if("name"===n&&"string"==typeof r)t[n]=r;else{let e=ZB(n);t[e]=pj(r,e)}}return t}}function hj(e,t){if(null==e)return null;if("string"==typeof e)return JB(e);if("number"==typeof e||"boolean"==typeof e)return e;if(e instanceof Array){let n=[],r=e.length;for(let a=0;a<r;++a){let r=e[a];cj(t,a,r)?n.push(r):n.push(hj(r,t))}return n}{let t={};for(let n of Object.keys(e)){let r=e[n],a=JB(n);t[a]="name"!==n&&"className"!==n||"string"!=typeof r?hj(r,n):r}return t}}var fj="4.7.0",mj=class extends OV{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,null==this.name){let e=this.getClassName().toLowerCase();this.name=fW(e)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],aW(this.inputs).length!==this.inputs.length)throw new VB(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map((e=>e.name))}`);aW(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map((e=>e.name))}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(let b of this.outputs){let e=b.sourceLayer,t=b.nodeIndex,n=b.tensorIndex;this.outputLayers.push(e),this.outputLayersNodeIndices.push(t),this.outputLayersTensorIndices.push(n)}for(let b of this.inputs){let e=b.sourceLayer,t=b.nodeIndex,n=b.tensorIndex;qB(0===t,"input layer has >1 nodes"),qB(0===n,"input layer has >1 tensors"),this.inputLayers.push(e),this.inputLayersNodeIndices.push(t),this.inputLayersTensorIndices.push(n)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let b=0;b<this.inputLayers.length;b++){let t=this.inputLayers[b];if(!(t instanceof LV))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${b} (0-based) originates from layer type ${t.getClassName()}.`);this.inputNames.push(t.name),this.feedInputShapes.push(t.batchInputShape),this.feedInputNames.push(t.name)}for(let b of this.outputLayers)this.outputNames.push(b.name);this.internalInputShapes=this.inputs.map((e=>e.shape)),this.internalOutputShapes=this.outputs.map((e=>e.shape));let t={},n={},r={},a={},i={},s=[],o=(e,t,n,r,a,l)=>{(null==r||null==a||null==l)&&(r=e.sourceLayer,a=e.nodeIndex,l=e.tensorIndex);let u=r.inboundNodes[a];if(-1!==n.indexOf(u))throw new WB(`The tensor ${e.name} at layer "${r.name}" is part of a cycle.`);if(-1!==t.indexOf(u))return;this.containerNodes.add(mj.nodeKey(r,a)),r.id in i||(i[r.id]=Object.keys(i).length),-1===n.indexOf(u)&&n.push(u);let d=u.inboundLayers.length;for(let i=0;i<d;i++){let e=u.inputTensors[i],r=u.inboundLayers[i],a=u.nodeIndices[i],s=u.tensorIndices[i];o(e,t,n,r,a,s)}for(t.push(u);n.indexOf(u)>=0;)n.splice(n.indexOf(u),1);s.push(u)},l=[],u=[];for(let b of this.outputs)o(b,l,u);let d=s.slice().reverse();for(let b of d){n[b.id]=b,b.id in t||(t[b.id]=0);let e=t[b.id],i=null==r[b.outboundLayer.id]?0:r[b.outboundLayer.id];e=Math.max(e,i),r[b.outboundLayer.id]=e,a[b.outboundLayer.id]=b.outboundLayer,t[b.id]=e;for(let r=0;r<b.inboundLayers.length;r++){let a=b.inboundLayers[r],i=b.nodeIndices[r],s=a.inboundNodes[i],o=null==t[s.id]?0:t[s.id];t[s.id]=Math.max(e+1,o),n[s.id]=s}}let c={};for(let b in t){let e=t[b];e in c||(c[e]=[]),c[e].push(n[b])}let p={};for(let b in r){let e=r[b];e in p||(p[e]=[]),p[e].push(a[b])}let h=Object.keys(p).map((e=>parseInt(e,10))).sort(rW);this.layers=[];for(let b of h){let e=p[b];e.sort(((e,t)=>{let n=i[e.id],r=i[t.id];return n<r?-1:n>r?1:0}));for(let t of e)t instanceof mj&&this.internalContainerRefs.push(t),this.layers.push(t)}this.layersByDepth=p,h=Object.keys(c).map((e=>parseInt(e,10))).sort(rW);let f=this.inputs.slice(),m=[];for(let b of h)for(let e of c[b]){let t=e.outboundLayer;if(null!=t){for(let n of e.inputTensors)if(-1===f.indexOf(n))throw new WB(`Graph disconnected: cannot obtain value for tensor ${n} at layer "${t.name}". The following previous layers were accessed without issue: ${m}`);for(let t of e.outputTensors)f.push(t);m.push(t.name)}}this.nodesByDepth=c;let g=this.layers.map((e=>e.name));for(let b of g){let e=g.filter((e=>e===b)).length;if(1!==e)throw new WB(`The name "${b}" is used ${e} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(g))}this.outboundNodes=[],this.inboundNodes=[],new FV({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map((e=>null)),outputMasks:this.outputs.map((e=>null)),inputShapes:this.inputs.map((e=>e.shape)),outputShapes:this.outputs.map((e=>e.shape))}),this.built=!0,this._refCount=1}assertNotDisposed(){if(0===this._refCount)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();let e={refCountAfterDispose:null,numDisposedVariables:0};if(0==--this._refCount){for(let t of this.layers)e.numDisposedVariables+=t.dispose().numDisposedVariables;for(let t of this.internalContainerRefs)e.numDisposedVariables+=t.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach((t=>{t._trainableWeights.forEach((t=>t.trainable=e))})),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new VB("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(let t of this.layers)e=e.concat(t.trainableWeights);return e}get nonTrainableWeights(){let e=[];for(let t of this.layers)e.push(...t.nonTrainableWeights);if(!this.trainable){let t=[];for(let e of this.layers)t.push(...e.trainableWeights);return t.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,t=!0){let n={},r=0;for(let i of this.layers)for(let e of i.weights){if(null!=n[e.originalName])throw new VB(`Duplicate weight name: ${e.originalName}`);n[e.originalName]=e,r++}let a=[];for(let i in e){let r=i;if(null==n[i]){let e=i.split("/");r=e.slice(0,-2).concat([e[e.length-1]]).join("/")}if(null!=n[r])a.push([n[r],e[i]]);else if(t)throw new VB(`Provided weight data has no target variable: ${i}`);delete n[r]}if(t){let e=[];for(let t in n)e.push(t);if(e.length>0)throw new VB(`${e.length} of ${r} weights are not set: ${e}`)}$V(a)}updatedConfig(){let e=this.getConfig(),t={};return t.className=this.getClassName(),t.config=e,t.kerasVersion=`tfjs-layers ${fj}`,t.backend="TensorFlow.js",t}toJSON(e,t=!0){let n=hj(this.updatedConfig());return t?JSON.stringify(n):n}call(e,t){return j_((()=>{e=YB(e);let n=new BV;for(let t=0;t<this.inputs.length;++t)n.add(this.inputs[t],e[t]);return UV(this.outputs,n,t)}))}computeMask(e,t){return j_((()=>{let n;return e=YB(e),n=null==t?GB(null,e.length):YB(t),this.runInternalGraph(e,n)[1]}))}computeOutputShape(e){let t=SV(e);if(t.length!==this.inputLayers.length)throw new VB(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);let n={};for(let s=0;s<t.length;s++){let e=this.inputLayers[s],r=t[s];n[e.name+"_0_0"]=r}let r=Object.keys(this.nodesByDepth).map((e=>parseInt(e,10))).sort(rW);if(r.length>1)for(let s of r){let e=this.nodesByDepth[s];for(let t of e){let e=t.outboundLayer;if(-1!==this.inputLayers.map((e=>e.id)).indexOf(e.id))continue;let r=[];for(let s=0;s<t.inboundLayers.length;s++){let e=t.inboundLayers[s],a=t.nodeIndices[s],i=t.tensorIndices[s],o=n[`${e.name}_${a}_${i}`];r.push(o)}let a=SV(e.computeOutputShape(XB(r))),i=e.inboundNodes.indexOf(t);for(let t=0;t<a.length;t++)n[`${e.name}_${i}_${t}`]=a[t]}}let a=[],i=[];for(let s=0;s<this.outputLayers.length;s++){let e=this.outputLayers[s],t=this.outputLayersNodeIndices[s],n=this.outputLayersTensorIndices[s],r=`${e.name}_${t}_${n}`;i.push(r)}for(let s=0;s<i.length;s++){let e=i[s];qB(e in n),a.push(n[e])}return XB(a)}runInternalGraph(e,t){null==t&&(t=GB(null,e.length));let n={};for(let o=0;o<this.inputs.length;++o){let r=this.inputs[o],a=e[o],i=t[o];n[r.id]=[a,i]}let r=Object.keys(this.nodesByDepth).map((e=>parseInt(e,10))).sort(rW);for(let o of r){let e=this.nodesByDepth[o];for(let t of e){let e=t.outboundLayer,r=t.inputTensors,a=t.outputTensors,i=new Array;for(let t of r)t.id in n&&i.push(n[t.id]);if(i.length===r.length){let r,s,o,l,u={};if(null!=t.callArgs&&(u=t.callArgs),1===i.length){let[t,n]=i[0];null==u.mask&&(u.mask=n),o=YB(e.call(t,u)),l=YB(e.computeMask(t,n)),r=[t],s=[n]}else r=i.map((e=>e[0])),s=i.map((e=>e[1])),null==u.mask&&(u.mask=s),o=YB(e.call(r,u)),l=YB(e.computeMask(r,s));if(e.activityRegularizer)throw new UB("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let e=0;e<a.length;++e){let t=a[e],r=o[e],i=l[e];n[t.id]=[r,i]}}}}let a=[],i=[],s=[];for(let o of this.outputs){qB(o.id in n,`Could not compute output ${o.name} : ${o.id}`);let[e,t]=n[o.id];s.push(e.shape),a.push(e),i.push(t)}return[a,i,s]}buildNodeConversionMap(e){let t,n={};for(let r of this.layers){t=r instanceof mj?1:0;for(let e=0;e<r.inboundNodes.length;e++){let a=mj.nodeKey(r,e);this.containerNodes.has(a)&&(n[a]=t,t+=1)}}return n}getLayer(e,t){if(null!=t)return this.findLayer(t);if(null==e)throw new VB("Provide either a layer name or layer index");if("number"==typeof e)return this.findLayer(e);for(let n of this.layers)if(n.name===e)return n;throw new VB(`No such layer: ${e}`)}findLayer(e){if(this.layers.length<=e)throw new VB(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}calculateLosses(){return j_((()=>{let e=[];for(let t of this.layers)for(let n=0;n<t.inboundNodes.length;++n){let r=mj.nodeKey(t,n);this.containerNodes.has(r)&&e.push(...t.calculateLosses())}return e}))}getConfig(){let e={name:this.name},t=this.buildNodeConversionMap(this.layers),n=[];for(let i of this.layers){let e=i.getClassName(),r=i.getConfig(),a=[];for(let n=0;n<i.inboundNodes.length;n++){let e=i.inboundNodes[n],r=mj.nodeKey(i,n),s={};if(this.containerNodes.has(r)){if(e.callArgs)try{JSON.stringify(e.callArgs),s=e.callArgs}catch(Ep){console.warn(`Layer ${i.name} was passed non-serializable keyword arguments: ${e.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),s={}}if(e.inboundLayers.length>0){let n=[];for(let r=0;r<e.inboundLayers.length;r++){let a=e.inboundLayers[r],i=e.nodeIndices[r],o=e.tensorIndices[r],l=t[mj.nodeKey(a,i)];null==l&&(l=0),n.push([a.name,l,o,s])}a.push(n)}}}let s={};s.name=i.name,s.className=e,s.config=r,s.inboundNodes=a,n.push(s)}e.layers=n;let r=[];for(let i=0;i<this.inputLayers.length;i++){let e=this.inputLayers[i],n=this.inputLayersNodeIndices[i],a=mj.nodeKey(e,n);if(!this.containerNodes.has(a))continue;let s=t[a];null==s&&(s=0);let o=this.inputLayersTensorIndices[i];r.push([e.name,s,o])}e.inputLayers=r;let a=[];for(let i=0;i<this.outputLayers.length;i++){let e=this.outputLayers[i],n=this.outputLayersNodeIndices[i],r=mj.nodeKey(e,n);if(!this.containerNodes.has(r))continue;let s=t[r];null==s&&(s=0);let o=this.outputLayersTensorIndices[i];a.push([e.name,s,o])}return e.outputLayers=a,e}static fromConfig(e,t,n={},r=!1){let a={},i={};function s(e,t){e.name in i?i[e.name].push(t):i[e.name]=[t]}function o(e,t){let n,r=[];for(let i of t){let o=i[0],l=i[1],u=i[2];if(n=null==i[3]?{}:i[3],!(o in a))return void s(e,t);let d=a[o];if(d.inboundNodes.length<=l)return void s(e,t);let c=d.inboundNodes[l];r.push(c.outputTensors[u])}r.length>0&&e.apply(XB(r),n)}function l(e){let n=e.name,i=OU(e,null!=t.customObjects?t.customObjects:{});i.setFastWeightInitDuringBuild(r),a[n]=i,e.inboundNodes.forEach((e=>{if(!(e instanceof Array))throw new VB(`Corrupted configuration, expected array for nodeData: ${e}`);s(i,e)}))}let u=t.name,d=t.layers;for(let m of d)l(m);for(;!iW(i);)for(let e of d){let t=a[e.name];if(t.name in i){let e=i[t.name];delete i[t.name];for(let n of e)o(t,n)}}let c=[],p=[],h=t.inputLayers;for(let m of h){let e=m[0],t=m[1],n=m[2];qB(e in a);let r=a[e].inboundNodes[t].outputTensors;c.push(r[n])}let f=t.outputLayers;for(let m of f){let e=m[0],t=m[1],n=m[2];qB(e in a);let r=a[e].inboundNodes[t].outputTensors;p.push(r[n])}return new e({inputs:c,outputs:p,name:u})}get stateful(){if(this._stateful)throw new VB("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(let e of this.layers)if(e.stateful)return!0;return!1}resetStates(){j_((()=>{this.layers.forEach((e=>{e.stateful&&e.resetStates()}))}))}};function gj(e,t){return function(e,t,n){let r=t.length;if(null==e||Array.isArray(e)&&0===e.length)return t.map((e=>null));if(1===r)return Array.isArray(e)&&1===e.length?e:"object"==typeof e&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==r)throw new Error(`Provided ${n} is an array of ${e.length} element(s), but the model has ${r} outputs. Make sure a set of weights is provided for each model output.`);return e}if("object"==typeof e&&Object.keys(e).length>0&&"object"==typeof e[Object.keys(e)[0]]){let n=[];return t.forEach((t=>{t in e?n.push(e[t]):n.push(null)})),n}throw new Error(`The model has multiple (${r}) outputs, so ${n} must be either an array with ${r} elements or an object with ${t} keys. Provided ${n} not understood: ${JSON.stringify(e)}`)}(e,t,"classWeight")}async function bj(e,t,n,r){if(null!=t||null!=r)throw new Error("Support sampleWeight is not implemented yet");if(null!=n){let t=j_((()=>{if(1===e.shape.length)return F_(e);if(2===e.shape.length){if(e.shape[1]>1)return h$(e,1);if(1===e.shape[1])return M$(e,[e.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${e.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}throw new Error(`Unexpected rank of target (y) tensor (${e.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)})),r=Array.from(await t.data());H_(t);let a=[];return r.forEach((e=>{if(null==n[e])throw new Error(`classWeight must contain all classes in the training data. The class ${e} exists in the data but not in classWeight`);a.push(n[e])})),vF(a,"float32")}return null}function yj(e,t){return s$(e,t)}function vj(e,t){let n,r,a=t;n=a.xs,r=a.ys,pT.assert(null!=n&&null!=r,(()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${t}`));let i=xj("input",e.inputNames,n),s=xj("output",e.outputNames,r),o=i[0].shape[0];pT.assert(i.length===e.inputs.length,(()=>`LayersModel has ${e.inputs.length} inputs, but the dataset provides ${i.length} inputs.  (Expected input keys: ${JSON.stringify(e.inputNames)})`)),pT.assert(s.length===e.outputs.length,(()=>`LayersModel has ${e.outputs.length} outputs, but the dataset provides ${s.length} outputs.  (Expected output keys: ${JSON.stringify(e.outputNames)})`));for(let l=0;l<i.length;l++)pT.assert(i[l].shape[0]===o,(()=>`Batch size mismatch: input ${e.inputNames[l]} has ${i[l].shape[0]}; expected  ${o} based on input ${e.inputNames[0]}.`));for(let l=0;l<s.length;l++)pT.assert(s[l].shape[0]===o,(()=>`Batch size mismatch: output ${e.outputNames[l]} has ${s[l].shape[0]}; expected  ${o} based on input ${e.inputNames[0]}.`));return{xs:i,ys:s}}function xj(e,t,n){if(n instanceof XT)return[n];if(Array.isArray(n))return pT.assert(n.length===t.length,(()=>`Received an array of ${n.length} Tensors, but expected ${t.length} to match the ${e} keys ${t}.`)),n;{let r=[];for(let a of t){if(null==n[a])throw new VB(`The feature data generated by the dataset lacks the required ${e} key '${a}'.`);r.push(n[a])}return r}}async function wj(e,t,n){let r=null!=n.batchesPerEpoch;if(pT.assert(null!=e.optimizer,(()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig).")),pT.assert(null!=n,(()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call.")),pT.assert(null!=n.epochs&&n.epochs>0&&Number.isInteger(n.epochs),(()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`)),pT.assert(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),(()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`)),pT.assert(null==n.validationSplit,(()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead.")),e.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");e.isTraining=!0;try{let a,i,s=null!=n.validationData;if(s)if(kj(n.validationData))pT.assert(null==n.validationBatches||n.validationBatches>0&&Number.isInteger(n.validationBatches),(()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`));else{let e=function(e){if(3===e.length)throw new UB("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}(n.validationData);a=e.xs,i=e.ys}let o,l=e.makeTrainFunction(),u=e.getDedupedMetricsNames();o=s?u.slice().concat(u.map((e=>"val_"+e))):u.slice();let d=DU(n.callbacks,n.yieldEvery),c=null==n.verbose?1:n.verbose,{callbackList:p,history:h}=MU(d,c,n.epochs,null,null,function(e,t){let n=null;return null!=t.batchesPerEpoch?n=t.batchesPerEpoch:Number.isFinite(e.size)&&(n=e.size),n}(t,n),null,s,o);p.setModel(e),e.history=h,await p.onTrainBegin(),e.stopTraining_=!1;let f=null==n.initialEpoch?0:n.initialEpoch,m=await t.iterator();for(;f<n.epochs;){let o={};await p.onEpochBegin(f);let d=0,c=0;for(r||(m=await t.iterator());!r||d<n.batchesPerEpoch;){let t=await m.next();if(r&&t.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${d} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(null!=t.value){let{xs:r,ys:a}=vj(e,t.value),i={};i.batch=c,i.size=r[0].shape[0],await p.onBatchBegin(c,i);let s=[];if(null!=n.classWeight){let t=gj(n.classWeight,e.outputNames);for(let e=0;e<t.length;++e)s.push(await bj(a[e],null,t[e]))}let o=r.concat(a).concat(s),h=l(o);H_(o);for(let e=0;e<u.length;++e){let t=u[e],n=h[e];i[t]=n,G_(n)}await p.onBatchEnd(c,i),TU(i),c++,d++}if(r?d>=n.batchesPerEpoch:t.done){if(s){let t;t=kj(n.validationData)?YB(await e.evaluateDataset(n.validationData,{batches:n.validationBatches})):YB(e.evaluate(a,i,{batchSize:null==n.validationBatchSize?32:n.validationBatchSize,verbose:0}));for(let n=0;n<e.metricsNames.length;++n)o[`val_${e.metricsNames[n]}`]=t[n]}break}if(e.stopTraining_)break}if(await p.onEpochEnd(f,o),f++,e.stopTraining_)break}return await p.onTrainEnd(),await e.history.syncData(),e.history}finally{e.isTraining=!1}}function kj(e){return"function"==typeof e.iterator}function Sj(e){pT.assert(e>0&&Number.isInteger(e),(()=>`batchSize is required to be a positive integer, but got ${e}`))}function Ij(e,t,n){return null==e?[null]:Array.isArray(e)?e.map((e=>BW(e,t,n-t))):BW(e,t,n-t)}function Nj(e,t){return j_((()=>null==e?null:Array.isArray(e)?e.map((e=>Nj(e,t))):KW(e,"int32"===t.dtype?t:D_(t,"int32"))))}function Cj(e,t){let n=[],r=0,a=null;for(;r<e;)a=r+t,a>=e&&(a=e),n.push([r,a]),r=a;return n}function Tj(e){let t=[];e instanceof XT&&(e=[e]);for(let n=0;n<e.length;++n){let r=e[n];if(1===r.rank)t.push(zW(r,1));else{if(0===r.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(r)}}return t}function Ej(e,t){if(null==e)return;let n=[];if(t instanceof XT)n.push(t.id);else if(Array.isArray(t))t.forEach((e=>n.push(e.id)));else if(null!=t)for(let a in t){let e=t[a];n.push(e.id)}let r=[];if(e instanceof XT)-1===n.indexOf(e.id)&&r.push(e);else if(Array.isArray(e))e.forEach((e=>{-1===n.indexOf(e.id)&&r.push(e)}));else if(null!=e)for(let a in e){let t=e[a];-1===n.indexOf(t.id)&&r.push(t)}r.forEach((e=>{e.isDisposed||e.dispose()}))}function _j(e){return Array.isArray(e)}function $j(e){return!function(e){return e instanceof XT}(e)&&!_j(e)}function Aj(e,t,n,r=!0,a=""){if(null==t||0===t.length){if(null!=e){let t=!1;if(_j(e)&&e.length>0)t=!0;else if($j(e)){for(let n in e)if(e.hasOwnProperty(n)){t=!0;break}}else t=!0;if(t)throw new VB(`Error when checking model ${a} expected no data, but got ${e}`)}return[]}if(null==e)return t.map((e=>null));let i;if($j(e)){i=[];for(let n of t){if(null==e[n])throw new VB(`No data provided for "${n}". Need data for each key in: ${t}`);i.push(e[n])}}else if(_j(e)){if(e.length!==t.length)throw new VB(`Error when checking model ${a}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${t.length} Tensor(s), but instead got the following list of Tensor(s): ${e}`);i=e}else{if(t.length>1)throw new VB(`The model ${a} expects ${t.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${e.shape}`);i=[e]}if(i=Tj(i),null!=n)for(let s=0;s<t.length;++s){if(null==n[s])continue;let e=i[s];if(e.shape.length!==n[s].length)throw new VB(`Error when checking ${a}: expected ${t[s]} to have ${n[s].length} dimension(s). but got array with shape ${e.shape}`);for(let t=0;t<n[s].length;++t){if(0===t&&!r)continue;let i=e.shape[t],o=n[s][t];if(null!=o&&o>=0&&i!==o)throw new VB(`${a} expected a batch of elements where each example has shape [${n[s].slice(1,n[s].length)}] (i.e.,tensor shape [*,${n[s].slice(1,n[s].length)}]) but the ${a} received an input with ${e.shape[0]} examples, each with shape [${e.shape.slice(1,e.shape.length)}] (tensor shape [${e.shape}])`)}}return i}function Rj(e,t,n,r=!0,a=""){let i;if(Array.isArray(e)){if(e.length!==t.length)throw new VB(`Error when checking model ${a}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${t.length} Tensor(s), but instead got ${e.length} Tensors(s).`);i=e}else{if(t.length>1)throw new VB(`The model expects ${t.length} ${a} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(e.shape)}.`);i=[e]}if(null!=n)for(let s=0;s<t.length;++s){if(null==n[s])continue;let e=i[s];if(e.shape.length!==n[s].length)throw new VB(`Error when checking ${a}: expected ${t[s]} to have ${n[s].length} dimension(s), but got array with shape ${JSON.stringify(e.shape)}`);for(let i=0;i<n[s].length;++i){if(0===i&&!r)continue;let o=e.shape[i],l=n[s][i];if(null!=l&&l!==o)throw new VB(`Error when checking ${a}: expected ${t[s]} to have shape ${JSON.stringify(n[s])} but got array with shape ${JSON.stringify(e.shape)}.`)}}}var Dj=class extends mj{constructor(e){super(e),this.isTraining=!1}summary(e,t,n=console.log){if(!this.built)throw new VB("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");oj(this,e,t,n)}compile(e){if(null==e.loss&&(e.loss=[]),this.loss=e.loss,"string"==typeof e.optimizer)this.optimizer_=function(e){let t={Adagrad:()=>NP.adagrad(.01),Adadelta:()=>NP.adadelta(1,.95,PW()),Adam:()=>NP.adam(.001,.9,.999,PW()),Adamax:()=>NP.adamax(.002,.9,.999,PW(),0),RMSProp:()=>NP.rmsprop(.001,.9,0,PW()),SGD:()=>NP.sgd(.01)};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new VB(`Unknown Optimizer ${e}`)}(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof hO))throw new VB("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let t=[];if(Array.isArray(e.loss)||"string"==typeof e.loss||"function"==typeof e.loss)if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new VB(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);t=e.loss.map((e=>GU(e)))}else{let n=GU(e.loss);this.outputs.forEach((e=>{t.push(n)}))}else{e.loss=e.loss;for(let t in e.loss)if(-1===this.outputNames.indexOf(t))throw new VB(`Unknown entry in loss dictionary: "${t}". Only expected the following keys: ${this.outputNames}`);for(let n of this.outputNames)null==e.loss[n]&&console.warn(`Output "${n}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${n} during training`),t.push(GU(e.loss[n]))}this.lossFunctions=t,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let i=0;i<this.outputs.length;++i){let e=this.internalOutputShapes[i],t=this.outputNames[i];this.feedOutputNames.push(t),this.feedOutputShapes.push(e),this.feedLossFns.push(this.lossFunctions[i])}let n=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],CW("loss",(()=>{for(let e=0;e<this.outputs.length;++e){if(-1!==n.indexOf(e))continue;let t=this.lossFunctions[e];this.outputs.length>1&&(this.metricsTensors.push([t,e]),this.metricsNames.push(this.outputNames[e]+"_loss"))}}));let r=function(e,t){if(null==e||Array.isArray(e)&&0===e.length)return t.map((e=>[]));let n;if("string"==typeof e||"function"==typeof e)n=[e];else{if(!Array.isArray(e)&&"object"!=typeof e)throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${e}`);n=e}if(Array.isArray(n))return t.map((e=>n));{let e=[];for(let r of t){let t=n.hasOwnProperty(r)?n[r]:[];Array.isArray(t)||(t=[t]),e.push(t)}return e}}(e.metrics,this.outputNames),a=(e,t,n)=>{this.outputNames.length>1&&(t=this.outputNames[e]+"_"+t),this.metricsNames.push(t),this.metricsTensors.push([n,e])};CW("metric",(()=>{for(let e=0;e<this.outputs.length;++e)-1===n.indexOf(e)&&(t=>{let n,r,i;for(let s of t){if("string"==typeof s&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(s)){let t,a=this.internalOutputShapes[e];1===a[a.length-1]||this.lossFunctions[e]===UU?-1!==["accuracy","acc"].indexOf(s)?r=qU:-1!==["crossentropy","ce"].indexOf(s)&&(r=ZU):this.lossFunctions[e]===VU?-1!==["accuracy","acc"].indexOf(s)?r=QU:-1!==["crossentropy","ce"].indexOf(s)&&(r=tj):-1!==["accuracy","acc"].indexOf(s)?r=KU:-1!==["crossentropy","ce"].indexOf(s)&&(r=ej),-1!==["accuracy","acc"].indexOf(s)?t="acc":-1!==["crossentropy","ce"].indexOf(s)&&(t="ce"),i=r,n=""+t}else i=rj(s),n=""+aj(s);let t;CW(n,(()=>{t=i})),a(e,n,t)}})(r[e])})),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,t,n={}){let r=null==n.batchSize?32:n.batchSize;Sj(r);let a=this.standardizeUserDataXY(e,t,!0,r);try{let e=a[0].concat(a[1]);this.makeTestFunction();let t=this.testFunction;return XB(this.testLoop(t,e,r,n.verbose,n.steps))}finally{Ej(a[0],e),Ej(a[1],t)}}async evaluateDataset(e,t){return this.makeTestFunction(),async function(e,t,n){let r=null!=(n=n||{}).batches,a=e.testFunction,i=[];if(n.verbose>0)throw new UB("Verbose mode is not implemented yet.");pT.assert(!r||n.batches>0&&Number.isInteger(n.batches),(()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`));let s=function(e){return"function"==typeof e.next}(t)?t:await t.iterator(),o=0,l=0;for(;!r||l<n.batches;){let t=await s.next();if(i=j_((()=>{if(t.value){let{xs:n,ys:r}=vj(e,t.value),s=n.concat(r),u=j_((()=>a(s)));if(H_(s),0===l)for(let e=0;e<u.length;++e)i.push(qA(0));let d=s[0].shape[0];for(let e=0;e<u.length;++e){let t=u[e],n=i[e];i[e]=j_((()=>r$(i[e],s$(d,t)))),l>0&&H_(n)}H_(u),o+=d,++l}return i})),t.done){r&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let u=0;u<i.length;++u){let e=i[u];i[u]=i$(i[u],o),H_(e)}return XB(i)}(this,e,t)}checkNumSamples(e,t,n,r="steps"){let a;if(null!=n){if(a=null,null!=t)throw new VB(`If ${r} is set, batchSize must be null or undefined.Got batchSize = ${t}`)}else{if(null==e)throw new VB(`Either the input data should have a defined shape, or ${r} shoud be specified.`);a=Array.isArray(e)?e[0].shape[0]:e.shape[0]}return a}execute(e,t){if(Array.isArray(t)&&0===t.length)throw new VB("`outputs` is an empty Array, which is not allowed.");let n=Array.isArray(t),r=n?t:[t],a=this.retrieveSymbolicTensors(r),i=new BV;if(e instanceof XT&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new VB(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let t=0;t<this.inputs.length;++t)i.add(this.inputs[t],e[t])}else for(let o of this.inputs){let t=e[o.name];if(null==t)throw new VB(`No value is provided for the model's input ${o.name}`);i.add(o,t)}let s=UV(a,i);return n?s:s[0]}retrieveSymbolicTensors(e){let t=GB(null,e.length),n=e.length;for(let r of this.layers){let a=Array.isArray(r.output)?r.output:[r.output],i=a.map((e=>e.name));for(let r=0;r<e.length;++r){let s=i.indexOf(e[r]);if(-1!==s&&(t[r]=a[s],n--),0===n)break}if(0===n)break}if(n>0){let n=[];throw t.forEach(((t,r)=>{null==t&&n.push(e[r])})),new VB(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(n)}`)}return t}predictLoop(e,t=32,n=!1){return j_((()=>{let r=this.checkNumSamples(e);if(n)throw new UB("Verbose predictLoop() is not implemented yet.");let a=Cj(r,t),i=this.outputs.map((e=>[]));for(let t=0;t<a.length;++t)j_((()=>{let n=a[t][0],r=a[t][1],i=Ij(e,n,r),s=[];if(Array.isArray(i))for(let e=0;e<i.length;++e)s.push({key:this.inputs[e],value:i[e]});else s.push({key:this.inputs[0],value:i});let o=new BV(s);return UV(this.outputs,o)})).forEach(((e,t)=>i[t].push(e)));return XB(i.map((e=>L$(e,0))))}))}predict(e,t={}){let n=Tj(e);Rj(n,this.inputNames,this.feedInputShapes,!1);try{let e=null==t.batchSize?32:t.batchSize;return Sj(e),this.predictLoop(n,e)}finally{Ej(n,e)}}predictOnBatch(e){Rj(e,this.inputNames,this.feedInputShapes,!0);let t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}standardizeUserDataXY(e,t,n=!0,r){if(null==this.optimizer_)throw new WB("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");let a=[];for(let i=0;i<this.feedOutputShapes.length;++i){let e=this.feedOutputShapes[i];this.feedLossFns[i]===VU?a.push(e.slice(0,e.length-1).concat([1])):a.push(e)}if(function(e,t,n){let r=aW(e.map((e=>e.shape[0])));r.sort();let a=aW(t.map((e=>e.shape[0])));if(a.sort(),r.length>1)throw new VB(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map((e=>e.shape)))}`);if(a.length>1)throw new VB(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map((e=>e.shape)))}`);if(r.length>0&&a.length>0&&!pT.arraysEqual(r,a))throw new VB(`Input Tensors should have the same number of samples as target Tensors. Found ${r[0]} input sample(s) and ${a[0]} target sample(s).`)}(e=Aj(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=Aj(t,this.feedOutputNames,a,!1,"target")),function(e,t,n){let r=[LU,UU,WU];for(let a=0;a<e.length;++a){let i=e[a],s=t[a],o=n[a];if(null!=s){if(s===WU&&1===i.shape[i.shape.length-1])throw new VB(`You are passing a target array of shape ${i.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(-1!==r.indexOf(s)){let e=i.shape.slice(1),t=o.slice(1);for(let n=0;n<e.length;++n){let r=e[n],a=t[n];if(null!=a&&r!==a)throw new VB(`A target Tensor with shape ${i.shape} was passed for an output of shape ${o}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=r&&r>0&&e[0].shape[0]%r!=0)throw new VB(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${r}. Found: ${e[0].shape[0]} sample(s).`);return[e,t]}async standardizeUserData(e,t,n,r,a=!0,i){let[s,o]=this.standardizeUserDataXY(e,t,a,i);if(null!=n)throw new Error("sample weight is not supported yet.");let l=null;if(null!=r){let e=gj(r,this.outputNames);l=[];for(let t=0;t<e.length;++t)l.push(await bj(o[t],null,e[t]))}return[s,o,l]}testLoop(e,t,n,r=0,a){return j_((()=>{let i=this.checkNumSamples(t,n,a,"steps"),s=[];if(r>0)throw new UB("Verbose mode is not implemented yet.");if(null!=a)throw new UB("steps mode in testLoop() is not implemented yet");{let r=Cj(i,n),a=vF(OW(0,i));for(let n=0;n<r.length;++n){let i=r[n][0],o=r[n][1],l=BW(a,i,o-i),u=Nj(t,l),d=e(u);if(0===n)for(let e=0;e<d.length;++e)s.push(qA(0));for(let e=0;e<d.length;++e){let t=d[e];s[e]=r$(s[e],s$(o-i,t))}}for(let e=0;e<s.length;++e)s[e]=i$(s[e],i)}return s}))}getDedupedMetricsNames(){let e=this.metricsNames,t=[];for(let n=0;n<e.length;++n){let r=e[n],a=r;KB(e,r)>1&&(a+=`_${KB(e.slice(0,n),r)}`),t.push(a)}return t}makeTrainFunction(){return e=>{let t=[],n=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),a=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+2*this.outputs.length),i=[],s=this.collectedTrainableWeights.map((e=>e.read()));return[this.optimizer_.minimize((()=>{let e=[];for(let t=0;t<this.inputs.length;++t)e.push({key:this.inputs[t],value:n[t]});let s,o=new BV(e),l=UV(this.outputs,o,{training:!0});for(let n=0;n<this.lossFunctions.length;++n){let e=(0,this.lossFunctions[n])(r[n],l[n]);null!=a[n]&&(e=yj(e,a[n]));let i=jR(e);t.push(i),s=0===n?e:r$(s,e)}for(let n=0;n<this.metricsTensors.length;++n){let e;if(this.outputs.length>1&&n<this.outputs.length)e=t[n];else{let t=this.metricsTensors[n][0],a=this.metricsTensors[n][1];e=jR(t(r[a],l[a]))}G_(e),i.push(e)}return s=jR(s),this.calculateLosses().forEach((e=>{s=r$(s,e)})),s}),!0,s)].concat(i)}}makeTestFunction(){this.testFunction=e=>j_((()=>{let t,n=[],r=e.slice(0,this.inputs.length),a=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=[];for(let e=0;e<this.inputs.length;++e)i.push({key:this.inputs[e],value:r[e]});let s=new BV(i),o=UV(this.outputs,s);for(let e=0;e<this.lossFunctions.length;++e){let r=this.lossFunctions[e],i=jR(r(a[e],o[e]));t=0===e?i:r$(t,i),n.push(t)}for(let e=0;e<this.metricsTensors.length;++e){let t=this.metricsTensors[e][0],r=this.metricsTensors[e][1],i=jR(t(a[r],o[r]));n.push(i)}return n}))}async fit(e,t,n={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");let r,a,i,s,o,l,u,d,c;this.isTraining=!0;try{let p=null==n.batchSize?32:n.batchSize;Sj(p);let h=!1,f=await this.standardizeUserData(e,t,n.sampleWeight,n.classWeight,h,p);r=f[0],a=f[1],c=f[2];let m,g=!1;if(null!=n.validationData&&n.validationData.length>0){if(g=!0,2!==n.validationData.length)throw 3===n.validationData.length?new UB("validationData including sample weights is not supported yet."):new VB(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${n.validationData} is invalid.`);o=n.validationData[0],l=n.validationData[1];let e=!0,t=await this.standardizeUserData(o,l,null,null,e,p);u=t[0],d=t[1],m=u.concat(d)}else if(null!=n.validationSplit&&n.validationSplit>0&&n.validationSplit<1){g=!0;let e=Math.floor(r[0].shape[0]*(1-n.validationSplit)),t=r[0].shape[0];u=Ij(r,e,t),i=r,r=Ij(r,0,e),d=Ij(a,e,t),s=a,a=Ij(a,0,e),m=u.concat(d)}else null!=n.validationSteps&&(g=!0);let b=r.concat(a).concat(c);this.checkTrainableWeightsConsistency();let y,v,x=this.makeTrainFunction(),w=this.getDedupedMetricsNames();g?(this.makeTestFunction(),y=this.testFunction,v=w.slice().concat(w.map((e=>"val_"+e)))):(y=null,m=[],v=w.slice());let k=DU(n.callbacks,n.yieldEvery);return await this.fitLoop(x,b,w,p,n.epochs,n.verbose,k,y,m,n.shuffle,v,n.initialEpoch,null,null)}finally{this.isTraining=!1,Ej(r,e),Ej(a,t),Ej(i,e),Ej(s,t),Ej(u,o),Ej(d,l),null!=c&&H_(c)}}async fitLoop(e,t,n,r,a,i,s,o,l,u,d,c,p,h){null==r&&(r=32),null==a&&(a=1),null==u&&(u=!0),null==c&&(c=0);let f=!1;if(null!=o&&null!=l&&(f=!0),null!=h&&(f=!0,null==p))throw new VB("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");let m,g=this.checkNumSamples(t,r,p,"steps_per_epoch");null!=g&&(m=OW(0,g)),null==i&&(i=1);let{callbackList:b,history:y}=MU(s,i,a,c,g,p,r,f,d);b.setModel(this),this.history=y,await b.onTrainBegin(),this.stopTraining_=!1;for(let v=c;v<a;++v){await b.onEpochBegin(v);let a={};if(null!=p)throw new UB("stepsPerEpoch mode is not implemented yet.");{if("batch"===u)throw new UB("batch shuffling is not implemneted yet");u&&pT.shuffle(m);let i=vF(m),s=Cj(g,r);for(let u=0;u<s.length;++u){let d={};if(await b.onBatchBegin(u,d),j_((()=>{let c=s[u][0],p=s[u][1],h=BW(i,c,p-c);d.batch=u,d.size=p-c;let m=Nj(t,h),g=e(m);for(let e=0;e<n.length;++e){let t=n[e],r=g[e];d[t]=r,G_(r)}if(u===s.length-1&&f){let e=this.testLoop(o,l,r);for(let t=0;t<n.length;++t){let r=n[t],i=e[t];G_(i),a["val_"+r]=i}}})),await b.onBatchEnd(u,d),TU(d),this.stopTraining_)break}i.dispose()}if(await b.onEpochEnd(v,a),this.stopTraining_)break}return await b.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,t){return wj(this,e,t)}async trainOnBatch(e,t){let n=await this.standardizeUserData(e,t),r=n[0],a=n[1],i=this.makeTrainFunction()(r.concat(a)),s=[];for(let o of i){let e=await o.data();s.push(e[0])}return H_(i),Ej(n[0],e),Ej(n[1],t),XB(s)}getNamedWeights(e){let t=[],n=null!=e&&e.trainableOnly,r=n?this.trainableWeights:this.weights,a=this.getWeights(n);for(let i=0;i<r.length;++i)n&&!r[i].trainable||t.push({name:r[i].originalName,tensor:a[i]});return t}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){let e=super.dispose();if(0===e.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){let t=V_().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-V_().numTensors}return e}getLossIdentifiers(){let e;if("string"==typeof this.loss)e=JB(this.loss);else if(Array.isArray(this.loss)){for(let e of this.loss)if("string"!=typeof e)throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map((e=>JB(e)))}else{let t=Object.keys(this.loss);e={};let n=this.loss;for(let r of t){if("string"!=typeof n[r])throw new Error("Serialization of non-string loss is not supported.");e[r]=JB(n[r])}}return e}getMetricIdentifiers(){if("string"==typeof this.metrics||"function"==typeof this.metrics)return[JB(aj(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map((e=>JB(aj(e))));{let e={};for(let t in this.metrics)e[t]=JB(aj(this.metrics[t]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(null!=e.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=e.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=e.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");let t,n,r=OU(pj(e.optimizer_config));if("string"==typeof e.loss)t=ZB(e.loss);else if(Array.isArray(e.loss))t=e.loss.map((e=>ZB(e)));else if(null!=e.loss){t={};for(let n in e.loss)t[n]=ZB(e.loss[n])}if(Array.isArray(e.metrics))n=e.metrics.map((e=>ZB(e)));else if(null!=e.metrics){n={};for(let t in e.metrics)n[t]=ZB(e.metrics[t])}this.compile({loss:t,metrics:n,optimizer:r})}async save(e,t){if("string"==typeof e){let t=kO.getSaveHandlers(e);if(0===t.length)throw new VB(`Cannot find any save handlers for URL '${e}'`);if(t.length>1)throw new VB(`Found more than one (${t.length}) save handlers for URL '${e}'`);e=t[0]}if(null==e.save)throw new VB("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");let n=await kO.encodeWeights(this.getNamedWeights(t)),r={modelTopology:this.toJSON(null,!1),format:"layers-model",generatedBy:`TensorFlow.js tfjs-layers v${fj}`,convertedBy:null};if(null!=t&&t.includeOptimizer&&null!=this.optimizer){r.trainingConfig=this.getTrainingConfig();let e="optimizer",{data:t,specs:a}=await kO.encodeWeights(await this.optimizer.getWeights(),e);n.specs.push(...a),n.data=kO.concatenateArrayBuffers([n.data,t])}return null!=this.userDefinedMetadata&&(ij(this.userDefinedMetadata,this.name,!0),r.userDefinedMetadata=this.userDefinedMetadata),r.weightData=n.data,r.weightSpecs=n.specs,e.save(r)}setUserDefinedMetadata(e){ij(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}};Dj.className="Model",uO.registerClass(Dj);var Fj=class extends Dj{};async function Mj(e,t){"modelTopology"in e||(e={modelTopology:e});let n=e.modelTopology;null!=n.model_config&&(n=n.model_config);let r=OU(pj(n),t);if(null!=e.weightsManifest){let t=await kO.loadWeights(e.weightsManifest,e.pathPrefix,r.weights.map((e=>e.originalName))),n={};for(let e of r.weights)n[e.originalName]=t[e.originalName];r.loadWeights(n),H_(t)}return r}async function Oj(e,t){if(null==t&&(t={}),"string"==typeof e){let n=kO.getLoadHandlers(e,t);if(0===n.length)n.push(kO.browserHTTPRequest(e,t));else if(n.length>1)throw new VB(`Found more than one (${n.length}) load handlers for URL '${e}'`);e=n[0]}return async function(e,t,n){if(null==n&&(n={}),null==e.load)throw new VB("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");let r=await e.load(),a=r.modelTopology;null!=a.model_config&&(a=a.model_config);let i=null==n.strict||n.strict,s=null!=r.weightData&&null!=r.weightSpecs&&i,o=OU(pj(a),t,s),l=r.trainingConfig;if(null!=l&&o.loadTrainingConfig(l),null!=r.userDefinedMetadata&&o.setUserDefinedMetadata(r.userDefinedMetadata),null!=r.weightData){if(null==r.weightSpecs)throw new VB("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");let{modelWeights:e,optimizerWeights:t}=function(e,t){let n=kO.decodeWeights(e,t),r={},a=[];return t.forEach((e=>{"optimizer"===e.group?a.push({name:e.name,tensor:n[e.name]}):r[e.name]=n[e.name]})),{modelWeights:r,optimizerWeights:a}}(r.weightData,r.weightSpecs);o.loadWeights(e,i),null!=o.optimizer&&t.length>0&&await o.optimizer.setWeights(t),H_(e),H_(t.map((e=>e.tensor)))}return o}(e,void 0,t)}Fj.className="Functional",uO.registerClass(Fj);var Pj=class extends Dj{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=null!=e.name?e.name:fW("sequential_"),null!=e.layers)for(let t of e.layers)this.add(t)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some((e=>e<0)))throw new VB(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){let t,n=e instanceof Pj||e instanceof Dj;if(n){if(t=e,1!==t.outputs.length)throw new VB("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==t.inputs.length)throw new VB("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===e.inboundNodes.length){if(null==e.batchInputShape)throw new VB("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");let t=zV({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(t)}if(n)this.outputs=t.outputs,this.inputs=t.inputs;else{if(1!==e.inboundNodes.length)throw new VB(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(1!==e.inboundNodes[0].outputTensors.length)throw new VB("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=PV(this.outputs[0])}this.inboundNodes=[],new FV({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:GB(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map((e=>e.shape)),outputShapes:this.outputs[0].shape})}else{let t=e.apply(this.outputs[0]);if(Array.isArray(t))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[t],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{let e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,t){return null==this.model&&this.build(),this.model.call(e,t)}build(e){if(NV(e),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Dj({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,t,n=console.log){this.built||this.build(),super.summary(e,t,n)}setWeights(e){null==this.model&&this.build(),this.model.setWeights(e)}evaluate(e,t,n={}){if(!this.built)throw new WB("The model needs to be compiled before being used.");return this.model.evaluate(e,t,n)}async evaluateDataset(e,t){if(!this.built)throw new WB("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,t)}predict(e,t={}){return null==this.model&&this.build(),this.model.predict(e,t)}predictOnBatch(e){return null==this.model&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return null==this.model?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,t,n={}){if(!this.built)throw new WB("The model needs to be compiled before being used.");return this.model.fit(e,t,n)}async fitDataset(e,t){if(!this.built)throw new WB("The model needs to be compiled before being used.");return this.model.fitDataset(e,t)}async trainOnBatch(e,t){return this.model.trainOnBatch(e,t)}static fromConfig(e,t,n={},r=!1){let a,i={};if(t instanceof Array){if(null==t[0].className||"Merge"===t[0].className)throw new VB("Legacy serialization format not supported yet.");a=t}else pT.assert(null!=t.layers,(()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field.")),a=t.layers,delete t.layers,i=t;let s=new e(i);if(!(s instanceof Pj))throw new UB(`Sequential.fromConfig called on non-Sequential input: ${s}`);for(let o of a){let e=OU(o,void 0,r);r&&e.setFastWeightInitDuringBuild(!0),s.add(e)}return s}set stopTraining(e){if(null==this.model)throw new VB("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(null==this.model)throw new VB("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){let e=[];for(let t of this.layers){let n={};n.className=t.getClassName(),n.config=t.getConfig(),e.push(n)}return{name:this.name,layers:e}}};function Lj(e){return new Dj(e)}function zj(e){return new Pj(e)}function Bj(e){return zV(e)}function Wj(e,t){FU.registerCallbackConstructor(e,t)}Pj.className="Sequential",uO.registerClass(Pj);var Vj=class extends uO.Serializable{getConfig(){return{}}},Uj=class extends Vj{apply(e,t=1){return function(e,t=1){if(1!==t)throw new UB(`Support for alpha values other than 1 (${t}) is not implemented yet.`);return DA(e)}(e,t)}};Uj.className="elu",uO.registerClass(Uj);var jj=class extends Vj{apply(e){return JD(e)}};jj.className="selu",uO.registerClass(jj);var Hj=class extends Vj{apply(e){return VD(e)}};Hj.className="relu",uO.registerClass(Hj);var Gj=class extends Vj{apply(e){return j_((()=>KR(6,VD(e))))}};Gj.className="relu6",uO.registerClass(Gj);var qj=class extends Vj{apply(e){return e}};qj.className="linear",uO.registerClass(qj);var Kj=class extends Vj{apply(e){return B$(e)}};Kj.className="sigmoid",uO.registerClass(Kj);var Xj=class extends Vj{apply(e){return function(e){return j_((()=>{let t=r$(.5,s$(.2,e));return nA(t,0,1)}))}(e)}};Xj.className="hardSigmoid",uO.registerClass(Xj);var Yj=class extends Vj{apply(e){return ER(e)}};Yj.className="softplus",uO.registerClass(Yj);var Jj=class extends Vj{apply(e){return function(e){return j_((()=>i$(e,r$(o$(e),1))))}(e)}};Jj.className="softsign",uO.registerClass(Jj);var Zj=class extends Vj{apply(e){return V$(e)}};Zj.className="tanh",uO.registerClass(Zj);var Qj=class extends Vj{apply(e,t=-1){return oF(e,t)}};Qj.className="softmax",uO.registerClass(Qj);var eH=class extends Vj{apply(e,t=-1){return AR(e,t)}};eH.className="logSoftmax",uO.registerClass(eH);var tH=class extends Vj{apply(e,t=1){return j_((()=>s$(B$(s$(e,t)),e)))}};tH.className="swish",uO.registerClass(tH);var nH=class extends Vj{apply(e){return j_((()=>s$(e,V$(ER(e)))))}};function rH(e){return e.getClassName()}function aH(e,t={}){return nW(e,uO.SerializationMap.getMap().classNameMap,t,"activation")}function iH(e){if(null==e){let e={className:"linear",config:{}};return aH(e)}if("string"==typeof e){let t={};return t.className=e,t.config={},aH(t)}return e instanceof Vj?e:aH(e)}function sH(e){if(null!=e&&"object"!=typeof e)throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${e}`)}nH.className="mish",uO.registerClass(nH);var oH=class extends uO.Serializable{},lH=class extends oH{constructor(e){super(),sH(e),this.l1=null==e||null==e.l1?.01:e.l1,this.l2=null==e||null==e.l2?.01:e.l2,this.hasL1=0!==this.l1,this.hasL2=0!==this.l2}apply(e){return j_((()=>{let t=HR([1]);return this.hasL1&&(t=r$(t,YA(s$(this.l1,o$(e))))),this.hasL2&&(t=r$(t,YA(s$(this.l2,XW(e))))),M$(t,[])}))}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,t){return new e({l1:t.l1,l2:t.l2})}};lH.className="L1L2",uO.registerClass(lH);var uH={l1l2:"L1L2"};function dH(e){return eW(e)}function cH(e,t={}){return nW(e,uO.SerializationMap.getMap().classNameMap,t,"regularizer")}function pH(e){return null==e?null:"string"==typeof e?cH({className:e in uH?uH[e]:e,config:{}}):e instanceof oH?e:cH(e)}var hH=class extends OV{constructor(e){super(null==e?{}:e),this.supportsMasking=!0,null!=e&&(this.maxValue=e.maxValue)}call(e,t){e=IV(e);let n=VD(e);return null!=this.maxValue&&(n=nA(n,0,this.maxValue)),n}computeOutputShape(e){return e}getConfig(){let e={maxValue:this.maxValue},t=super.getConfig();return Object.assign(e,t),e}};hH.className="ReLU",uO.registerClass(hH);var fH=class extends OV{constructor(e){super(null==e?{}:e),this.DEFAULT_ALPHA=.3,null==e&&(e={}),this.alpha=null==e.alpha?this.DEFAULT_ALPHA:e.alpha}call(e,t){let n=IV(e);return hR(n,this.alpha)}computeOutputShape(e){return e}getConfig(){let e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}};fH.className="LeakyReLU",uO.registerClass(fH);var mH=class extends OV{constructor(e){if(super(null==e?{}:e),this.DEFAULT_ALPHA_INITIALIZER="zeros",null==e&&(e={}),this.supportsMasking=!0,this.alphaInitializer=wV(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=pH(e.alphaRegularizer),this.alphaConstraint=rU(e.alphaConstraint),null==e.sharedAxes)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else{if("number"!=typeof e.sharedAxes)throw new VB(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`);this.sharedAxes=[e.sharedAxes]}}build(e){let t=(e=NV(e)).slice(1);if(null!=this.sharedAxes)for(let r of this.sharedAxes)t[r-1]=1;this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);let n={};if(null!=this.sharedAxes)for(let r=1;r<e.length;++r)n[r]=e[r];this.inputSpec=[new AV({ndim:e.length,axes:n})],this.built=!0}call(e,t){return e=IV(e),cD(e,this.alpha.read())}getConfig(){let e={alphaInitializer:xV(this.alphaInitializer),alphaRegularizer:dH(this.alphaRegularizer),alphaConstraint:tU(this.alphaConstraint),sharedAxes:this.sharedAxes},t=super.getConfig();return Object.assign(e,t),e}};mH.className="PReLU",uO.registerClass(mH);var gH=class extends OV{constructor(e){if(super(null==e?{}:e),this.DEFAULT_ALPHA=1,null==e&&(e={}),null!=e.alpha&&e.alpha!==this.DEFAULT_ALPHA)throw new UB(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=null==e.alpha?this.DEFAULT_ALPHA:e.alpha}call(e,t){let n=IV(e);return DA(n)}computeOutputShape(e){return e}getConfig(){let e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}};gH.className="ELU",uO.registerClass(gH);var bH=class extends OV{constructor(e){super(null==e?{}:e),this.DEFAULT_THETA=1,null==e&&(e={}),this.theta=null==e.theta?this.DEFAULT_THETA:e.theta}call(e,t){let n=IV(e);return s$(n,D_(oR(n,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){let e={theta:this.theta},t=super.getConfig();return Object.assign(e,t),e}};bH.className="ThresholdedReLU",uO.registerClass(bH);var yH=class extends OV{constructor(e){super(null==e?{}:e),this.DEFAULT_AXIS=1,null==e&&(e={}),this.softmax=(new Qj).apply,this.axis=null==e.axis?this.DEFAULT_AXIS:e.axis}call(e,t){let n=IV(e);return this.softmax(n,this.axis)}computeOutputShape(e){return e}getConfig(){let e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}};function vH(e,t,n){if("number"==typeof e)return GB(e,t);if(e.length!==t)throw new VB(`The ${n} argument must be an integer or tuple of ${t} integers. Received: ${e.length} elements.`);for(let r=0;r<t;++r){let a=e[r];if(!RW(a))throw new VB(`The ${n} argument must be an integer or tuple of ${t} integers. Received: ${JSON.stringify(e)} including a non-integer number ${a}`)}return e}function xH(e,t,n,r,a=1){if(null==e)return e;let i;return i="same"===n?e:e-(t+(t-1)*(a-1))+1,Math.floor((i+r-1)/r)}function wH(e,t,n,r){if(null==e)return null;if("valid"===r)e=e*t+MW([n-t,0]);else{if("same"!==r)throw new VB(`Unsupport padding mode: ${r}.`);e*=t}return e}function kH(e,t){return j_((()=>(wW(t),"channelsFirst"===t?BF(e,[0,2,3,1]):e)))}function SH(e,t){return j_((()=>(wW(t),"channelsFirst"===t?BF(e,[0,2,3,4,1]):e)))}function IH(e,t,n,r=[1,1],a="valid",i,s,o=null){return j_((()=>{if(null==i&&(i="channelsLast"),wW(i),3!==e.rank&&4!==e.rank)throw new VB(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${e.rank}.`);if(3!==t.rank&&4!==t.rank)throw new VB(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${e.rank}.`);let l=kH(e,i);if("causal"===a)throw new UB("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=XF.conv2d({x:l,filter:t,strides:r,pad:"same"===a?"same":"valid",dilations:s,dataFormat:"NHWC",bias:n,activation:o}),"channelsFirst"===i&&(l=BF(l,[0,3,1,2])),l}))}yH.className="Softmax",uO.registerClass(yH);var NH=class extends OV{constructor(e,t){if(super(t),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",NH.verifyArgs(t),this.rank=e,lW(this.rank,"rank"),1!==this.rank&&2!==this.rank&&3!==this.rank)throw new UB(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=vH(t.kernelSize,e,"kernelSize"),this.strides=vH(null==t.strides?1:t.strides,e,"strides"),this.padding=null==t.padding?"valid":t.padding,kW(this.padding),this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,wW(this.dataFormat),this.activation=iH(t.activation),this.useBias=null==t.useBias||t.useBias,this.biasInitializer=wV(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=rU(t.biasConstraint),this.biasRegularizer=pH(t.biasRegularizer),this.activityRegularizer=pH(t.activityRegularizer),this.dilationRate=vH(null==t.dilationRate?1:t.dilationRate,e,"dilationRate"),1===this.rank&&Array.isArray(this.dilationRate)&&1!==this.dilationRate.length)throw new VB(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(2===this.rank){if("number"==typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate];else if(2!==this.dilationRate.length)throw new VB(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(3===this.rank)if("number"==typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(3!==this.dilationRate.length)throw new VB(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}static verifyArgs(e){if(qB("kernelSize"in e,"required key 'kernelSize' not in config"),"number"!=typeof e.kernelSize&&!oW(e.kernelSize,"number",1,3))throw new VB(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){let e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:rH(this.activation),useBias:this.useBias,biasInitializer:xV(this.biasInitializer),biasRegularizer:dH(this.biasRegularizer),activityRegularizer:dH(this.activityRegularizer),biasConstraint:tU(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}},CH=class extends NH{constructor(e,t){super(e,t),this.kernel=null,CH.verifyArgs(t),this.filters=t.filters,lW(this.filters,"filters"),this.kernelInitializer=wV(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=rU(t.kernelConstraint),this.kernelRegularizer=pH(t.kernelRegularizer)}build(e){e=NV(e);let t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new VB(`The channel dimension of the input should be defined. Found ${e[t]}`);let n=e[t],r=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[t]:n}}],this.built=!0}call(e,t){return j_((()=>{e=IV(e);let t,n=null==this.bias?null:this.bias.read(),r=dW(this.activation.getClassName());if(null!=r&&2===this.rank)t=IH(e,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate,r);else{if(1===this.rank)t=function(e,t,n,r=1,a="valid",i,s=1){return j_((()=>{if(null==i&&(i="channelsLast"),wW(i),3!==e.shape.length)throw new VB(`The input of a conv1dWithBias operation should be 3, but is ${e.shape.length} instead.`);if(3!==t.shape.length)throw new VB(`The kernel for a conv1dWithBias operation should be 3, but is ${t.shape.length} instead`);if(null!=n&&1!==n.shape.length)throw new VB(`The bias for a conv1dWithBias operation should be 1, but is ${t.shape.length} instead`);if("channelsFirst"===i&&(e=BF(e,[0,2,1])),"causal"===a)throw new UB("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let o=lA(e,t,r,"same"===a?"same":"valid","NWC",s);return null!=n&&(o=JW(o,n)),o}))}(e,this.kernel.read(),n,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(2===this.rank)t=IH(e,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate);else{if(3!==this.rank)throw new UB("convolutions greater than 3D are not implemented yet.");t=function(e,t,n,r=[1,1,1],a="valid",i,s){return j_((()=>{if(null==i&&(i="channelsLast"),wW(i),4!==e.rank&&5!==e.rank)throw new VB(`conv3dWithBias expects input to be of rank 4 or 5, but received ${e.rank}.`);if(4!==t.rank&&5!==t.rank)throw new VB(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${e.rank}.`);let o=SH(e,i);if("causal"===a)throw new UB("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return o=cA(o,t,r,"same"===a?"same":"valid","NDHWC",s),null!=n&&(o=JW(o,n)),"channelsFirst"===i&&(o=BF(o,[0,4,1,2,3])),o}))}(e,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate)}null!=this.activation&&(t=this.activation.apply(t))}return t}))}computeOutputShape(e){e=NV(e);let t=[],n="channelsLast"===this.dataFormat?e.slice(1,e.length-1):e.slice(2);for(let a=0;a<n.length;++a){let e=xH(n[a],this.kernelSize[a],this.padding,this.strides[a],"number"==typeof this.dilationRate?this.dilationRate:this.dilationRate[a]);t.push(e)}let r=[e[0]];return"channelsLast"===this.dataFormat?(r=r.concat(t),r.push(this.filters)):(r.push(this.filters),r=r.concat(t)),r}getConfig(){let e={filters:this.filters,kernelInitializer:xV(this.kernelInitializer),kernelRegularizer:dH(this.kernelRegularizer),kernelConstraint:tU(this.kernelConstraint)},t=super.getConfig();return Object.assign(e,t),e}static verifyArgs(e){if(!("filters"in e)||"number"!=typeof e.filters||e.filters<1)throw new VB(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}},TH=class extends CH{constructor(e){super(2,e),TH.verifyArgs(e)}getConfig(){let e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if("number"!=typeof e.kernelSize&&!oW(e.kernelSize,"number",1,2))throw new VB(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}};TH.className="Conv2D",uO.registerClass(TH);var EH=class extends CH{constructor(e){super(3,e),EH.verifyArgs(e)}getConfig(){let e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if("number"!=typeof e.kernelSize&&(!Array.isArray(e.kernelSize)||1!==e.kernelSize.length&&3!==e.kernelSize.length))throw new VB(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}};EH.className="Conv3D",uO.registerClass(EH);var _H=class extends TH{constructor(e){if(super(e),this.inputSpec=[new AV({ndim:4})],"same"!==this.padding&&"valid"!==this.padding)throw new VB(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(4!==(e=NV(e)).length)throw new VB("Input should have rank 4; Received input shape: "+JSON.stringify(e));let t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new VB("The channel dimension of the inputs should be defined. Found `None`.");let n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new AV({ndim:4,axes:{[t]:n}})],this.built=!0}call(e,t){return j_((()=>{let t=IV(e);if(4!==t.shape.length)throw new VB(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${t.shape.length}`);let n,r,a=t.shape,i=a[0];"channelsFirst"===this.dataFormat?(n=2,r=3):(n=1,r=2);let s=a[n],o=a[r],l=this.kernelSize[0],u=this.kernelSize[1],d=this.strides[0],c=this.strides[1],p=[i,wH(s,d,l,this.padding),wH(o,c,u,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(t=BF(t,[0,2,3,1]));let h=dA(t,this.kernel.read(),p,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(h=BF(h,[0,3,1,2])),null!=this.bias&&(h=JW(h,this.bias.read(),this.dataFormat)),null!=this.activation&&(h=this.activation.apply(h)),h}))}computeOutputShape(e){let t,n,r,a=(e=NV(e)).slice();"channelsFirst"===this.dataFormat?(t=1,n=2,r=3):(t=3,n=1,r=2);let i=this.kernelSize[0],s=this.kernelSize[1],o=this.strides[0],l=this.strides[1];return a[t]=this.filters,a[n]=wH(a[n],o,i,this.padding),a[r]=wH(a[r],l,s,this.padding),a}getConfig(){let e=super.getConfig();return delete e.dilationRate,e}};_H.className="Conv2DTranspose",uO.registerClass(_H);var $H=class extends EH{constructor(e){if(super(e),this.inputSpec=[new AV({ndim:5})],"same"!==this.padding&&"valid"!==this.padding)throw new VB(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(5!==(e=NV(e)).length)throw new VB("Input should have rank 5; Received input shape: "+JSON.stringify(e));let t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new VB("The channel dimension of the inputs should be defined. Found `None`.");let n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new AV({ndim:5,axes:{[t]:n}})],this.built=!0}call(e,t){return j_((()=>{let t=IV(e);if(5!==t.shape.length)throw new VB(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${t.shape.length}`);let n,r,a,i=t.shape,s=i[0];"channelsFirst"===this.dataFormat?(a=2,n=3,r=4):(a=1,n=2,r=3);let o=i[a],l=i[n],u=i[r],d=this.kernelSize[0],c=this.kernelSize[1],p=this.kernelSize[2],h=this.strides[0],f=this.strides[1],m=this.strides[2],g=[s,wH(o,h,d,this.padding),wH(l,f,c,this.padding),wH(u,m,p,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(t=BF(t,[0,2,3,4,1]));let b=hA(t,this.kernel.read(),g,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(b=BF(b,[0,4,1,2,3])),null!==this.bias&&(b=JW(b,this.bias.read(),this.dataFormat)),null!==this.activation&&(b=this.activation.apply(b)),b}))}computeOutputShape(e){let t,n,r,a,i=(e=NV(e)).slice();"channelsFirst"===this.dataFormat?(t=1,n=2,r=3,a=4):(t=4,n=1,r=2,a=3);let s=this.kernelSize[0],o=this.kernelSize[1],l=this.kernelSize[2],u=this.strides[0],d=this.strides[1],c=this.strides[2];return i[t]=this.filters,i[n]=wH(i[n],u,s,this.padding),i[r]=wH(i[r],d,o,this.padding),i[a]=wH(i[a],c,l,this.padding),i}getConfig(){let e=super.getConfig();return delete e.dilationRate,e}};$H.className="Conv3DTranspose",uO.registerClass($H);var AH=class extends CH{constructor(e,t){if(super(e,t),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,null==t.filters)throw new VB("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=t.kernelInitializer||null!=t.kernelRegularizer||null!=t.kernelConstraint)throw new VB("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=t.padding&&"same"!==t.padding&&"valid"!==t.padding)throw new VB(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(t.padding)}`);this.depthMultiplier=null==t.depthMultiplier?1:t.depthMultiplier,this.depthwiseInitializer=wV(t.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=pH(t.depthwiseRegularizer),this.depthwiseConstraint=rU(t.depthwiseConstraint),this.pointwiseInitializer=wV(t.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=pH(t.pointwiseRegularizer),this.pointwiseConstraint=rU(t.pointwiseConstraint)}build(e){if((e=NV(e)).length<this.rank+2)throw new VB(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);let t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t]||e[t]<0)throw new VB(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[t])}`);let n=e[t],r=this.kernelSize.concat([n,this.depthMultiplier]),a=[];for(let s=0;s<this.rank;++s)a.push(1);a.push(n*this.depthMultiplier,this.filters);let i=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,i,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",a,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,i,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,i,this.biasConstraint):this.bias=null,this.inputSpec=[new AV({ndim:this.rank+2,axes:{[t]:n}})],this.built=!0}call(e,t){return j_((()=>{let t;if(e=IV(e),1===this.rank)throw new UB("1D separable convolution is not implemented yet.");return 2===this.rank&&("channelsFirst"===this.dataFormat&&(e=BF(e,[0,2,3,1])),t=ZD(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(t=JW(t,this.bias.read(),this.dataFormat)),null!=this.activation&&(t=this.activation.apply(t)),"channelsFirst"===this.dataFormat&&(t=BF(t,[0,3,1,2])),t}))}getConfig(){let e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=xV(this.depthwiseInitializer),e.pointwiseInitializer=xV(this.pointwiseInitializer),e.depthwiseRegularizer=dH(this.depthwiseRegularizer),e.pointwiseRegularizer=dH(this.pointwiseRegularizer),e.depthwiseConstraint=tU(this.depthwiseConstraint),e.pointwiseConstraint=tU(this.pointwiseConstraint),e}};AH.className="SeparableConv";var RH=class extends AH{constructor(e){super(2,e)}};RH.className="SeparableConv2D",uO.registerClass(RH);var DH=class extends CH{constructor(e){super(1,e),DH.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){let e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if("number"!=typeof e.kernelSize&&!oW(e.kernelSize,"number",1,1))throw new VB(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}};DH.className="Conv1D",uO.registerClass(DH);var FH=class extends OV{constructor(e){super(e),"number"==typeof e.cropping?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:"number"==typeof e.cropping[0]?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=void 0===e.dataFormat?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return"channelsFirst"===this.dataFormat?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,t){return j_((()=>{if(e=IV(e),"channelsLast"===this.dataFormat){let t=VW(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return VW(t,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}{let t=VW(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return VW(t,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}}))}getConfig(){let e={cropping:this.cropping,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}};FH.className="Cropping2D",uO.registerClass(FH);var MH=class extends OV{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=null==e.size?this.DEFAULT_SIZE:e.size,this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,wW(this.dataFormat),this.interpolation=null==e.interpolation?"nearest":e.interpolation,function(e){sW(gW,"InterpolationFormat",e)}(this.interpolation)}computeOutputShape(e){if("channelsFirst"===this.dataFormat){let t=null==e[2]?null:this.size[0]*e[2],n=null==e[3]?null:this.size[1]*e[3];return[e[0],e[1],t,n]}{let t=null==e[1]?null:this.size[0]*e[1],n=null==e[2]?null:this.size[1]*e[2];return[e[0],t,n,e[3]]}}call(e,t){return j_((()=>{let t=IV(e),n=t.shape;if("channelsFirst"===this.dataFormat){t=BF(t,[0,2,3,1]);let e=this.size[0]*n[2],r=this.size[1]*n[3],a="nearest"===this.interpolation?aO.resizeNearestNeighbor(t,[e,r]):aO.resizeBilinear(t,[e,r]);return BF(a,[0,3,1,2])}{let e=this.size[0]*n[1],r=this.size[1]*n[2];return"nearest"===this.interpolation?aO.resizeNearestNeighbor(t,[e,r]):aO.resizeBilinear(t,[e,r])}}))}getConfig(){let e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}};MH.className="UpSampling2D",uO.registerClass(MH);var OH=class extends NH{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,this.depthwiseInitializer=wV(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=rU(e.depthwiseConstraint),this.depthwiseRegularizer=pH(e.depthwiseRegularizer)}build(e){if((e=NV(e)).length<4)throw new VB(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);let t="channelsFirst"===this.dataFormat?1:3;if(null==e[t]||e[t]<0)throw new VB(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[t]}).`);let n=e[t],r=[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return j_((()=>{let t=function(e,t,n=[1,1],r="valid",a,i){return j_((()=>{null==a&&(a="channelsLast"),wW(a);let s=kH(e,a);if(4!==e.rank)throw new VB(`Input for depthwiseConv2d is required to be 4-D, but is instead ${e.rank}-D`);if(4!==t.rank)throw new VB(`depthwiseKernel is required to be 4-D, but is instead ${t.rank}-D`);return s=xA(s,t,n,"same"===r?"same":"valid","NHWC",i),"channelsFirst"===a&&(s=BF(s,[0,3,1,2])),s}))}(e=IV(e),this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(t=JW(t,this.bias.read(),this.dataFormat)),null!=this.activation&&(t=this.activation.apply(t)),t}))}computeOutputShape(e){e=NV(e);let t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],r="channelsFirst"===this.dataFormat?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,a=xH(t,this.kernelSize[0],this.padding,this.strides[0]),i=xH(n,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[e[0],r,a,i]:[e[0],a,i,r]}getConfig(){let e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=xV(this.depthwiseInitializer),e.depthwiseRegularizer=dH(this.depthwiseRegularizer),e.depthwiseConstraint=tU(this.depthwiseRegularizer),e}};function PH(e,t,n,r){if(Array.isArray(e)){if(null!=t||null!=n)throw new VB("When inputs is an array, neither initialState or constants should be provided");null!=r&&(n=e.slice(e.length-r,e.length),e=e.slice(0,e.length-r)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function a(e){return null==e||Array.isArray(e)?e:[e]}return{inputs:e,initialState:t=a(t),constants:n=a(n)}}function LH(e,t,n,r=!1,a,i,s=!1,o=!1){return j_((()=>{let l=t.shape.length;if(l<3)throw new VB(`Input should be at least 3D, but is ${l}D.`);let u=[1,0].concat(OW(2,l));if(t=BF(t,u),null!=i)throw new UB("The rnn() functoin of the deeplearn.js backend does not support constants yet.");s&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=a&&((a=D_(D_(a,"bool"),"float32")).rank===l-1&&(a=tR(a,-1)),a=BF(a,u)),r&&(t=jD(t,0),null!=a&&(a=jD(a,0)));let d,c,p,h=[],f=n,m=t.shape[0],g=FF(t);null!=a&&(c=FF(a));for(let t=0;t<m;++t){let n=g[t],r=j_((()=>e(n,f)));if(null==a)d=r[0],f=r[1];else{let e=j_((()=>{let e=c[t],n=$R(nD(e),e),a=r$(s$(r[0],e),s$(f[0],n)),i=f.map(((t,a)=>r$(s$(r[1][a],e),s$(t,n))));return{output:a,newStates:i}}));d=e.output,f=e.newStates}o&&h.push(d)}return o&&(p=mF(h,1)),[d,p,f]}))}OH.className="DepthwiseConv2D",uO.registerClass(OH);var zH=class extends OV{constructor(e){let t;if(super(e),null==e.cell)throw new VB("cell property is missing for the constructor of RNN.");if(t=Array.isArray(e.cell)?new qH({cells:e.cell}):e.cell,null==t.stateSize)throw new VB("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=t,this.returnSequences=null!=e.returnSequences&&e.returnSequences,this.returnState=null!=e.returnState&&e.returnState,this.goBackwards=null!=e.goBackwards&&e.goBackwards,this._stateful=null!=e.stateful&&e.stateful,this.unroll=null!=e.unroll&&e.unroll,this.supportsMasking=!0,this.inputSpec=[new AV({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){return null==this.states_?OW(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map((e=>null)):this.states_}setStates(e){this.states_=e}computeOutputShape(e){kV(e)&&(e=e[0]);let t=this.cell.stateSize;Array.isArray(t)||(t=[t]);let n,r=t[0];if(n=this.returnSequences?[e[0],e[1],r]:[e[0],r],this.returnState){let r=[];for(let n of t)r.push([e[0],n]);return[n].concat(r)}return n}computeMask(e,t){return j_((()=>{Array.isArray(t)&&(t=t[0]);let e=this.returnSequences?t:null;if(this.returnState){let t=this.states.map((e=>null));return[e].concat(t)}return e}))}get states(){if(null==this.states_){let e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,t=[];for(let n=0;n<e;++n)t.push(null);return t}return this.states_}set states(e){this.states_=e}build(e){if(null!=this.numConstants)throw new UB("Constants support is not implemented in RNN yet.");kV(e)&&(e=e[0]);let t=this.stateful?e[0]:null,n=e.slice(2);this.inputSpec[0]=new AV({shape:[t,null,...n]});let r,a=[e[0]].concat(e.slice(2));if(this.cell.build(a),r=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!pT.arraysEqual(this.stateSpec.map((e=>e.shape[e.shape.length-1])),r))throw new VB(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=r.map((e=>new AV({shape:[null,e]})));this.stateful&&this.resetStates()}resetStates(e,t=!1){j_((()=>{if(!this.stateful)throw new BB("Cannot call resetStates() on an RNN Layer that is not stateful.");let n=this.inputSpec[0].shape[0];if(null==n)throw new VB("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.states_)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((e=>HR([n,e]))):this.states_=[HR([n,this.cell.stateSize])];else if(null==e)H_(this.states_),null!=this.keptStates&&(H_(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((e=>HR([n,e]))):this.states_[0]=HR([n,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new VB(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);!0===t?this.keptStates.push(this.states_.slice()):H_(this.states_);for(let t=0;t<this.states_.length;++t){let r=e[t],a=Array.isArray(this.cell.stateSize)?this.cell.stateSize[t]:this.cell.stateSize,i=[n,a];if(!pT.arraysEqual(r.shape,i))throw new VB(`State ${t} is incompatible with layer ${this.name}: expected shape=${i}, received shape=${r.shape}`);this.states_[t]=r}}this.states_=this.states_.map((e=>G_(e.clone())))}))}apply(e,t){let n=null==t?null:t.initialState,r=null==t?null:t.constants;null==t&&(t={});let a=PH(e,n,r,this.numConstants);e=a.inputs,n=a.initialState,r=a.constants;let i=[],s=[];if(null!=n){t.initialState=n,i=i.concat(n),this.stateSpec=[];for(let e of n)this.stateSpec.push(new AV({shape:e.shape}));s=s.concat(this.stateSpec)}if(null!=r&&(t.constants=r,i=i.concat(r),this.numConstants=r.length),i[0]instanceof RV){let n=[e].concat(i),r=this.inputSpec.concat(s),a=this.inputSpec;this.inputSpec=r;let o=super.apply(n,t);return this.inputSpec=a,o}return super.apply(e,t)}call(e,t){return j_((()=>{let n=null==t?null:t.mask,r=null==t?null:t.training,a=null==t?null:t.initialState;e=IV(e),null==a&&(a=this.stateful?this.states_:this.getInitialState(e));let i=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(a.length!==i)throw new VB(`RNN Layer has ${i} state(s) but was passed ${a.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");let s={training:r},o=LH(((e,t)=>{let n=this.cell.call([e].concat(t),s);return[n[0],n.slice(1)]}),e,a,this.goBackwards,n,null,this.unroll,this.returnSequences),l=o[0],u=o[1],d=o[2];this.stateful&&this.resetStates(d,r);let c=this.returnSequences?u:l;return this.returnState?[c].concat(d):c}))}getInitialState(e){return j_((()=>{let t=HR(e.shape);return t=YA(t,[1,2]),t=zW(t),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map((e=>e>1?HW(t,[1,e]):t)):this.cell.stateSize>1?[HW(t,[1,this.cell.stateSize])]:[t]}))}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){let e=super.getConfig(),t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(t.numConstants=this.numConstants);let n=this.cell.getConfig();return this.getClassName()===zH.className&&(t.cell={className:this.cell.getClassName(),config:n}),Object.assign(Object.assign(Object.assign({},n),e),t)}static fromConfig(e,t,n={}){let r=OU(t.cell,n);return new e(Object.assign(t,{cell:r}))}};zH.className="RNN",uO.registerClass(zH);var BH=class extends OV{},WH=class extends BH{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,lW(this.units,"units"),this.activation=iH(null==e.activation?this.DEFAULT_ACTIVATION:e.activation),this.useBias=null==e.useBias||e.useBias,this.kernelInitializer=wV(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=wV(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=wV(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=pH(e.kernelRegularizer),this.recurrentRegularizer=pH(e.recurrentRegularizer),this.biasRegularizer=pH(e.biasRegularizer),this.kernelConstraint=rU(e.kernelConstraint),this.recurrentConstraint=rU(e.recurrentConstraint),this.biasConstraint=rU(e.biasConstraint),this.dropout=FW([1,MW([0,null==e.dropout?0:e.dropout])]),this.recurrentDropout=FW([1,MW([0,null==e.recurrentDropout?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=NV(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return j_((()=>{if(2!==e.length)throw new VB(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let n=e[1];e=e[0];let r=null!=t.training&&t.training;0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=KH({ones:()=>nD(e),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=KH({ones:()=>nD(n),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));let a,i=this.dropoutMask,s=this.recurrentDropoutMask;a=qW(null!=i?s$(e,i):e,this.kernel.read()),null!=this.bias&&(a=JW(a,this.bias.read())),null!=s&&(n=s$(n,s));let o=r$(a,qW(n,this.recurrentKernel.read()));return null!=this.activation&&(o=this.activation.apply(o)),[o,o]}))}getConfig(){let e=super.getConfig(),t={units:this.units,activation:rH(this.activation),useBias:this.useBias,kernelInitializer:xV(this.kernelInitializer),recurrentInitializer:xV(this.recurrentInitializer),biasInitializer:xV(this.biasInitializer),kernelRegularizer:dH(this.kernelRegularizer),recurrentRegularizer:dH(this.recurrentRegularizer),biasRegularizer:dH(this.biasRegularizer),activityRegularizer:dH(this.activityRegularizer),kernelConstraint:tU(this.kernelConstraint),recurrentConstraint:tU(this.recurrentConstraint),biasConstraint:tU(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),t)}};WH.className="SimpleRNNCell",uO.registerClass(WH);var VH=class extends zH{constructor(e){e.cell=new WH(e),super(e)}call(e,t){return j_((()=>{null!=this.cell.dropoutMask&&(H_(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(H_(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let n=null==t?null:t.mask,r=null==t?null:t.training,a=null==t?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:a})}))}static fromConfig(e,t){return new e(t)}};VH.className="SimpleRNN",uO.registerClass(VH);var UH=class extends BH{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new VB("GRUCell does not support reset_after parameter set to true.");this.units=e.units,lW(this.units,"units"),this.activation=iH(void 0===e.activation?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=iH(void 0===e.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=null==e.useBias||e.useBias,this.kernelInitializer=wV(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=wV(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=wV(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=pH(e.kernelRegularizer),this.recurrentRegularizer=pH(e.recurrentRegularizer),this.biasRegularizer=pH(e.biasRegularizer),this.kernelConstraint=rU(e.kernelConstraint),this.recurrentConstraint=rU(e.recurrentConstraint),this.biasConstraint=rU(e.biasConstraint),this.dropout=FW([1,MW([0,null==e.dropout?0:e.dropout])]),this.recurrentDropout=FW([1,MW([0,null==e.recurrentDropout?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){let t=(e=NV(e))[e.length-1];this.kernel=this.addWeight("kernel",[t,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return j_((()=>{if(2!==e.length)throw new VB(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);let n=null!=t.training&&t.training,r=e[1];e=e[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=KH({ones:()=>nD(e),rate:this.dropout,training:n,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=KH({ones:()=>nD(r),rate:this.recurrentDropout,training:n,count:3,dropoutFunc:this.dropoutFunc}));let a,i,s,o=this.dropoutMask,l=this.recurrentDropoutMask;0<this.dropout&&this.dropout<1&&(e=s$(e,o[0]));let u=qW(e,this.kernel.read());this.useBias&&(u=JW(u,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=s$(r,l[0]));let d=this.recurrentKernel.read(),[c,p]=cF(d,[2*this.units,this.units],d.rank-1),h=qW(r,c),[f,m,g]=cF(u,3,u.rank-1),[b,y]=cF(h,2,h.rank-1);a=this.recurrentActivation.apply(r$(f,b)),i=this.recurrentActivation.apply(r$(m,y));let v=qW(s$(i,r),p);s=this.activation.apply(r$(g,v));let x=r$(s$(a,r),s$(r$(1,TR(a)),s));return[x,x]}))}getConfig(){let e=super.getConfig(),t={units:this.units,activation:rH(this.activation),recurrentActivation:rH(this.recurrentActivation),useBias:this.useBias,kernelInitializer:xV(this.kernelInitializer),recurrentInitializer:xV(this.recurrentInitializer),biasInitializer:xV(this.biasInitializer),kernelRegularizer:dH(this.kernelRegularizer),recurrentRegularizer:dH(this.recurrentRegularizer),biasRegularizer:dH(this.biasRegularizer),activityRegularizer:dH(this.activityRegularizer),kernelConstraint:tU(this.kernelConstraint),recurrentConstraint:tU(this.recurrentConstraint),biasConstraint:tU(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),t)}};UH.className="GRUCell",uO.registerClass(UH);var jH=class extends zH{constructor(e){0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new UH(e),super(e)}call(e,t){return j_((()=>{null!=this.cell.dropoutMask&&(H_(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(H_(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let n=null==t?null:t.mask,r=null==t?null:t.training,a=null==t?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:a})}))}static fromConfig(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}};jH.className="GRU",uO.registerClass(jH);var HH=class extends BH{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,lW(this.units,"units"),this.activation=iH(void 0===e.activation?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=iH(void 0===e.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=null==e.useBias||e.useBias,this.kernelInitializer=wV(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=wV(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=wV(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=pH(e.kernelRegularizer),this.recurrentRegularizer=pH(e.recurrentRegularizer),this.biasRegularizer=pH(e.biasRegularizer),this.kernelConstraint=rU(e.kernelConstraint),this.recurrentConstraint=rU(e.recurrentConstraint),this.biasConstraint=rU(e.biasConstraint),this.dropout=FW([1,MW([0,null==e.dropout?0:e.dropout])]),this.recurrentDropout=FW([1,MW([0,null==e.recurrentDropout?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var t;let n,r=(e=NV(e))[e.length-1];if(this.kernel=this.addWeight("kernel",[r,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){let e=this.biasInitializer,r=this.units;n=new(t=class extends nV{apply(t,n){let a=e.apply([r]),i=(new aV).apply([r]),s=e.apply([2*r]);return jW(jW(a,i),s)}},t.className="CustomInit",t)}else n=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,n,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,t){return j_((()=>{let n=null!=t.training&&t.training;if(3!==e.length)throw new VB(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let r=e[1],a=e[2];e=e[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=KH({ones:()=>nD(e),rate:this.dropout,training:n,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=KH({ones:()=>nD(r),rate:this.recurrentDropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));let i,s,o,l,u=this.dropoutMask,d=this.recurrentDropoutMask;0<this.dropout&&this.dropout<1&&(e=s$(e,u[0]));let c=qW(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=s$(r,d[0])),c=r$(c,qW(r,this.recurrentKernel.read())),this.useBias&&(c=JW(c,this.bias.read()));let[p,h,f,m]=cF(c,4,c.rank-1);i=this.recurrentActivation.apply(p),s=this.recurrentActivation.apply(h),o=r$(s$(s,a),s$(i,this.activation.apply(f))),l=this.recurrentActivation.apply(m);let g=s$(l,this.activation.apply(o));return[g,g,o]}))}getConfig(){let e=super.getConfig(),t={units:this.units,activation:rH(this.activation),recurrentActivation:rH(this.recurrentActivation),useBias:this.useBias,kernelInitializer:xV(this.kernelInitializer),recurrentInitializer:xV(this.recurrentInitializer),biasInitializer:xV(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:dH(this.kernelRegularizer),recurrentRegularizer:dH(this.recurrentRegularizer),biasRegularizer:dH(this.biasRegularizer),activityRegularizer:dH(this.activityRegularizer),kernelConstraint:tU(this.kernelConstraint),recurrentConstraint:tU(this.recurrentConstraint),biasConstraint:tU(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),t)}};HH.className="LSTMCell",uO.registerClass(HH);var GH=class extends zH{constructor(e){0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new HH(e),super(e)}call(e,t){return j_((()=>{null!=this.cell.dropoutMask&&(H_(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(H_(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let n=null==t?null:t.mask,r=null==t?null:t.training,a=null==t?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:a})}))}static fromConfig(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}};GH.className="LSTM",uO.registerClass(GH);var qH=class extends BH{constructor(e){super(e),this.cells=e.cells}get stateSize(){let e=[];for(let t of this.cells.slice().reverse())Array.isArray(t.stateSize)?e.push(...t.stateSize):e.push(t.stateSize);return e}call(e,t){return j_((()=>{let n=e.slice(1),r=[];for(let e of this.cells.slice().reverse())Array.isArray(e.stateSize)?r.push(n.splice(0,e.stateSize.length)):r.push(n.splice(0,1));r.reverse();let a,i=[];for(let s=0;s<this.cells.length;++s){let o=this.cells[s];n=r[s],a=0===s?[e[0]].concat(n):[a[0]].concat(n),a=o.call(a,t),i.push(a.slice(1))}n=[];for(let e of i.slice().reverse())n.push(...e);return[a[0]].concat(n)}))}build(e){let t;kV(e)&&(e=e[0]),this.cells.forEach(((n,r)=>{CW(`RNNCell_${r}`,(()=>{n.build(e),t=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,e=[e[0],t]}))})),this.built=!0}getConfig(){let e=super.getConfig(),t={cells:this.cells.map((e=>({className:e.getClassName(),config:e.getConfig()})))};return Object.assign(Object.assign({},e),t)}static fromConfig(e,t,n={}){let r=[];for(let a of t.cells)r.push(OU(a,n));return new e({cells:r})}get trainableWeights(){if(!this.trainable)return[];let e=[];for(let t of this.cells)e.push(...t.trainableWeights);return e}get nonTrainableWeights(){let e=[];for(let t of this.cells)e.push(...t.nonTrainableWeights);if(!this.trainable){let t=[];for(let e of this.cells)t.push(...e.trainableWeights);return t.concat(e)}return e}getWeights(){let e=[];for(let t of this.cells)e.push(...t.weights);return _V(e)}setWeights(e){let t=[];for(let n of this.cells){let r=n.weights.length,a=e.splice(r);for(let e=0;e<n.weights.length;++e)t.push([n.weights[e],a[e]])}$V(t)}};function KH(e){let{ones:t,rate:n,training:r=!1,count:a=1,dropoutFunc:i}=e,s=()=>null!=i?i(t(),n):ZW(t(),n),o=()=>QW(s,t,r);return!a||a<=1?G_(o().clone()):Array(a).fill(void 0).map(o).map((e=>G_(e.clone())))}qH.className="StackedRNNCells",uO.registerClass(qH);var XH=class extends zH{constructor(e){if(e.unroll)throw new UB("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new UB("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new AV({ndim:5})]}call(e,t){return j_((()=>{if(null!=this.cell.dropoutMask&&(H_(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(H_(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),t&&t.constants)throw new VB("ConvRNN2D cell does not support constants");let n=null==t?null:t.mask,r=null==t?null:t.training,a=null==t?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:a})}))}computeOutputShape(e){let t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0],...t.slice(2)]),this.returnState&&(t=[t,...Array(2).fill([e[0],...t.slice(-3)])]),t}getInitialState(e){return j_((()=>{let{stateSize:t}=this.cell,n=e.shape,r=this.computeSingleOutputShape(n),a=HR([r[0],...r.slice(2)]);return Array.isArray(t)?Array(t.length).fill(a):[a]}))}resetStates(e,t=!1){j_((()=>{if(!this.stateful)throw new BB("Cannot call resetStates() on an RNN Layer that is not stateful.");let n=this.inputSpec[0].shape,r=this.computeSingleOutputShape(n),a=[r[0],...r.slice(2)];if(null==n[0])throw new VB("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.getStates())Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((()=>HR(a))):this.states_=[HR(a)];else if(null==e)H_(this.states_),null!=this.keptStates&&(H_(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((()=>HR(a))):this.states_[0]=HR(a);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new VB(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);t?this.keptStates.push(this.states_.slice()):H_(this.states_);for(let t=0;t<this.states_.length;++t){let n=e[t],r=a;if(!pT.arraysEqual(n.shape,r))throw new VB(`State ${t} is incompatible with layer ${this.name}: expected shape=${r}, received shape=${n.shape}`);this.states_[t]=n}}this.states_=this.states_.map((e=>G_(e.clone())))}))}computeSingleOutputShape(e){let{dataFormat:t,filters:n,kernelSize:r,padding:a,strides:i,dilationRate:s}=this.cell,o="channelsFirst"===t,l=e[o?3:2],u=e[o?4:3],d=xH(l,r[0],a,i[0],s[0]),c=xH(u,r[1],a,i[1],s[1]);return[...e.slice(0,2),...o?[n,d,c]:[d,c,n]]}};XH.className="ConvRNN2D";var YH=class extends HH{constructor(e){let{filters:t,kernelSize:n,strides:r,padding:a,dataFormat:i,dilationRate:s}=e;super(Object.assign(Object.assign({},e),{units:t})),this.filters=t,lW(this.filters,"filters"),this.kernelSize=vH(n,2,"kernelSize"),this.kernelSize.forEach((e=>lW(e,"kernelSize"))),this.strides=vH(r||1,2,"strides"),this.strides.forEach((e=>lW(e,"strides"))),this.padding=a||"valid",kW(this.padding),this.dataFormat=i||"channelsLast",wW(this.dataFormat),this.dilationRate=vH(s||1,2,"dilationRate"),this.dilationRate.forEach((e=>lW(e,"dilationRate")))}build(e){var t;e=NV(e);let n="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[n])throw new VB(`The channel dimension of the input should be defined. Found ${e[n]}`);let r=e[n],a=this.kernelSize.concat([r,4*this.filters]);this.kernel=this.addWeight("kernel",a,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);let i=this.kernelSize.concat([this.filters,4*this.filters]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",i,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let e;if(this.unitForgetBias){let n=this.biasInitializer,r=this.filters;e=new((t=class extends nV{apply(e,t){return UW([n.apply([r]),GR([r]),n.apply([2*r])])}}).className="CustomInit",t)}else e=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.filters],null,e,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,t){return j_((()=>{if(3!==e.length)throw new VB(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let n=t.training||!1,r=e[0],a=e[1],i=e[2];0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=KH({ones:()=>nD(r),rate:this.dropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));let s=this.dropoutMask,o=(e,t,n)=>t&&t[n]?s$(t[n],e):e,l=o(r,s,0),u=o(r,s,1),d=o(r,s,2),c=o(r,s,3);0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=KH({ones:()=>nD(a),rate:this.recurrentDropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));let p=this.recurrentDropoutMask,h=o(a,p,0),f=o(a,p,1),m=o(a,p,2),g=o(a,p,3),[b,y,v,x]=cF(this.kernel.read(),4,3),[w,k,S,I]=this.useBias?cF(this.bias.read(),4):[null,null,null,null];l=this.inputConv(l,b,w,this.padding),u=this.inputConv(u,y,k,this.padding),d=this.inputConv(d,v,S,this.padding),c=this.inputConv(c,x,I,this.padding);let[N,C,T,E]=cF(this.recurrentKernel.read(),4,3);h=this.recurrentConv(h,N),f=this.recurrentConv(f,C),m=this.recurrentConv(m,T),g=this.recurrentConv(g,E);let _=this.recurrentActivation.apply(r$(l,h)),$=this.recurrentActivation.apply(r$(u,f)),A=r$(s$($,i),s$(_,this.activation.apply(r$(d,m)))),R=s$(this.recurrentActivation.apply(r$(c,g)),this.activation.apply(A));return[R,R,A]}))}getConfig(){let e=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}(super.getConfig(),["units"]),t={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},e),t)}inputConv(e,t,n,r){let a=oA(e,t,this.strides,r||"valid","channelsFirst"===this.dataFormat?"NCHW":"NHWC",this.dilationRate);return n?JW(a,n,this.dataFormat):a}recurrentConv(e,t){return oA(e,t,1,"same","channelsFirst"===this.dataFormat?"NCHW":"NHWC")}};YH.className="ConvLSTM2DCell",uO.registerClass(YH);var JH=class extends XH{constructor(e){let t=new YH(e);super(Object.assign(Object.assign({},e),{cell:t}))}static fromConfig(e,t){return new e(t)}};JH.className="ConvLSTM2D",uO.registerClass(JH);var ZH=class extends OV{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(null==this.noiseShape)return this.noiseShape;let t=e.shape,n=[];for(let r=0;r<this.noiseShape.length;++r)n.push(null==this.noiseShape[r]?t[r]:this.noiseShape[r]);return n}call(e,t){return j_((()=>{this.invokeCallHook(e,t);let n=IV(e);if(0<this.rate&&this.rate<1){let e=null!=t.training&&t.training,r=this.getNoiseShape(n);return QW((()=>ZW(n,this.rate,r,this.seed)),(()=>n),e)}return e}))}getConfig(){let e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=super.getConfig();return Object.assign(e,t),e}dispose(){return super.dispose()}};ZH.className="Dropout",uO.registerClass(ZH);var QH=class extends ZH{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){let t=e.shape;return[t[0],1,t[2]]}};QH.className="SpatialDropout1D",uO.registerClass(QH);var eG=class extends OV{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",null==e.batchInputShape&&null==e.inputShape&&null!=e.inputDim){let t=null;null!=e.batchSize&&(t=e.batchSize),this.batchInputShape=[t,e.inputDim]}this.units=e.units,lW(this.units,"units"),this.activation=iH(e.activation),null!=e.useBias&&(this.useBias=e.useBias),this.kernelInitializer=wV(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=wV(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=rU(e.kernelConstraint),this.biasConstraint=rU(e.biasConstraint),this.kernelRegularizer=pH(e.kernelRegularizer),this.biasRegularizer=pH(e.biasRegularizer),this.activityRegularizer=pH(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){let t=(e=NV(e))[e.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:t}}],this.built=!0}computeOutputShape(e){let t=(e=NV(e)).slice();return t[t.length-1]=this.units,t}call(e,t){return j_((()=>{this.invokeCallHook(e,t);let n,r=IV(e),a=dW(this.activation.getClassName());return null!=a?n=qW(r,this.kernel.read(),a,this.bias?this.bias.read():null):(n=qW(r,this.kernel.read()),null!=this.bias&&(n=JW(n,this.bias.read())),null!=this.activation&&(n=this.activation.apply(n))),n}))}getConfig(){let e={units:this.units,activation:rH(this.activation),useBias:this.useBias,kernelInitializer:xV(this.kernelInitializer),biasInitializer:xV(this.biasInitializer),kernelRegularizer:dH(this.kernelRegularizer),biasRegularizer:dH(this.biasRegularizer),activityRegularizer:dH(this.activityRegularizer),kernelConstraint:tU(this.kernelConstraint),biasConstraint:tU(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}};eG.className="Dense",uO.registerClass(eG);var tG=class extends OV{constructor(e){super(e=e||{}),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=NV(e);for(let t of e.slice(1))if(null==t)throw new VB(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],DW(e,1)]}call(e,t){return j_((()=>{this.invokeCallHook(e,t);let n=IV(e);if("channelsFirst"===this.dataFormat&&n.rank>1){let e=[0];for(let t=2;t<n.rank;++t)e.push(t);e.push(1),n=BF(n,e)}return function(e){if(e.rank<=1)throw new VB(`batchFlatten requires a minimum rank of 2. Got rank: ${e.rank}.`);let t=[e.shape[0],DW(e.shape,1)];return M$(e,t)}(n)}))}getConfig(){let e={};null!=this.dataFormat&&(e.dataFormat=this.dataFormat);let t=super.getConfig();return Object.assign(e,t),e}};tG.className="Flatten",uO.registerClass(tG);var nG=class extends OV{constructor(e){super(e),this.supportsMasking=!0,this.activation=iH(e.activation)}call(e,t){return j_((()=>{this.invokeCallHook(e,t);let n=IV(e);return this.activation.apply(n)}))}getConfig(){let e={activation:rH(this.activation)},t=super.getConfig();return Object.assign(e,t),e}};nG.className="Activation",uO.registerClass(nG);var rG=class extends OV{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,t){return j_((()=>function(e,t){return j_((()=>{if(2!==e.shape.length)throw new VB(`repeat() expects a rank-2 tensor, but received a rank-${e.shape.length} tensor.`);return HW(zW(e,1),[1,t,1])}))}(e=IV(e),this.n)))}getConfig(){let e={n:this.n},t=super.getConfig();return Object.assign(e,t),e}};rG.className="RepeatVector",uO.registerClass(rG);var aG=class extends OV{constructor(e){super(e),this.targetShape=e.targetShape;for(let t=0;t<this.targetShape.length;++t)this.isUnknown(this.targetShape[t])&&(this.targetShape[t]=null)}isUnknown(e){return e<0||null==e}fixUnknownDimension(e,t){let n="Total size of new array must be unchanged.",r=t.slice(),a=1,i=null;for(let o=0;o<r.length;++o){let e=r[o];if(this.isUnknown(e)){if(null!==i)throw new VB("Can only specifiy one unknown dimension.");i=o}else a*=e}let s=DW(e);if(null!==i){if(0===a||s%a!=0)throw new VB(n);r[i]=s/a}else if(s!==a)throw new VB(n);return r}computeOutputShape(e){let t=!1;for(let n=0;n<e.length;++n)if(this.isUnknown(e[n])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,t){return j_((()=>{this.invokeCallHook(e,t);let n=IV(e),r=n.shape,a=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return M$(n,a)}))}getConfig(){let e={targetShape:this.targetShape},t=super.getConfig();return Object.assign(e,t),e}};aG.className="Reshape",uO.registerClass(aG);var iG=class extends OV{constructor(e){if(super(e),null==e.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);let t=OW(1,e.dims.length+1);if(!pT.arraysEqual(e.dims.slice().sort(),t))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new AV({ndim:this.dims.length+1})]}computeOutputShape(e){let t=(e=NV(e)).slice();return this.dims.forEach(((n,r)=>{t[r+1]=e[n]})),t}call(e,t){return BF(IV(e),this.dimsIncludingBatch)}getConfig(){let e={dims:this.dims},t=super.getConfig();return Object.assign(e,t),e}};iG.className="Permute",uO.registerClass(iG);var sG=class extends OV{constructor(e){super(null==e?{}:e),this.supportsMasking=!0,this.maskValue=null!=e?null==e.maskValue?0:e.maskValue:0}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={maskValue:this.maskValue};return Object.assign(t,e),t}computeMask(e,t){let n=IV(e);return p$(eD(n,this.maskValue),-1)}call(e,t){return j_((()=>{this.invokeCallHook(e,t);let n=IV(e),r=p$(eD(n,this.maskValue),-1,!0);return s$(n,D_(r,n.dtype))}))}};sG.className="Masking",uO.registerClass(sG);var oG=class extends OV{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==e.batchInputShape&&null==e.inputShape){let t=null;null!=e.batchSize&&(t=e.batchSize),null==e.inputLength?this.batchInputShape=[t,null]:this.batchInputShape=[t].concat(YB(e.inputLength))}this.inputDim=e.inputDim,lW(this.inputDim,"inputDim"),this.outputDim=e.outputDim,lW(this.outputDim,"outputDim"),this.embeddingsInitializer=wV(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=pH(e.embeddingsRegularizer),this.activityRegularizer=pH(e.activityRegularizer),this.embeddingsConstraint=rU(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,t){return j_((()=>this.maskZero?(e=IV(e),eD(e,_A(e))):null))}computeOutputShape(e){if(e=NV(e),null==this.inputLength)return[...e,this.outputDim];let t=YB(this.inputLength);if(t.length!==e.length-1)throw new VB(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let n=0;for(let r=0;r<t.length;++r){let a=t[r],i=e[r+1];if(null!=a&&null!=i&&a!==i)throw new VB(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);null==a&&(t[n]=i),n++}}return[e[0],...t,this.outputDim]}call(e,t){return j_((()=>{this.invokeCallHook(e,t);let n=IV(e);"int32"!==n.dtype&&(n=LW(n,"int32"));let r=KW(this.embeddings.read(),M$(n,[n.size]));return M$(r,NV(this.computeOutputShape(n.shape)))}))}getConfig(){let e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:xV(this.embeddingsInitializer),embeddingsRegularizer:dH(this.embeddingsRegularizer),activityRegularizer:dH(this.activityRegularizer),embeddingsConstraint:tU(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=super.getConfig();return Object.assign(e,t),e}};oG.className="Embedding",uO.registerClass(oG);var lG=class extends OV{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new UB}computeElementwiseOpOutputShape(e,t){if(null==e||null==t)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(0===t.length)return e;let n=e.slice(0,e.length-t.length);for(let r=0;r<t.length;++r){let a=e[e.length-t.length+r],i=t[r];if(null==a||null==i||a<0||i<0)n.push(null);else if(1===a)n.push(i);else if(1===i)n.push(a);else{if(a!==i)throw new VB("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));n.push(a)}}return n}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[NV(e)]),e.length<2)throw new VB(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let t=[];for(let a of e)null!=a&&null!==a[0]&&t.push(a[0]);if(t=aW(t),t.length>1)throw new VB(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let n=null==e[0]?null:e[0].slice(1);for(let a=1;a<e.length;++a){let t=null==e[a]?null:e[a].slice(1);n=this.computeElementwiseOpOutputShape(n,t)}let r=e.map((e=>e.length));-1===e.indexOf(null)&&1===aW(r).length?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,t){return j_((()=>{if(this.reshapeRequired){let t=[],n=e.map((e=>e.rank));if(-1===n.indexOf(null)){let r=MW(n);for(let n of e){let e=n.rank;for(let t=0;t<r-e;++t)n=zW(n,1);t.push(n)}return this.mergeFunction(t)}{let n=!1;for(let i of e){let e=i.rank;if(null==e){let e=i.shape,r=e[0],a=e.slice(1).concat([r]),s=M$(i,[r].concat(DW(e.slice(1))));s=BF(s,[1,0]),s=M$(s,a),t.push(s),n=!0}else if(e>1){let r=OW(1,e).concat([0]);t.push(BF(i,r)),n=!0}else t.push(i)}let r=this.mergeFunction(t),a=r.rank;if(n)if(null==a){let e=r.shape,t=e[e.length-1],n=[t].concat(e.slice(0,e.length-1));r=M$(BF(M$(r,[-1,t]),[1,0]),n)}else if(a>1){let e=[a-1].concat(OW(0,a-1));r=BF(r,e)}return r}}return this.mergeFunction(e)}))}computeOutputShape(e){let t;t=null==e[0]?null:e[0].slice(1);for(let r=1;r<e.length;++r){let n=null==e[r]?null:e[r].slice(1);t=this.computeElementwiseOpOutputShape(t,n)}let n=[];for(let r of e)null!=r&&null!==r[0]&&n.push(r[0]);return n=aW(n),t=1===n.length?n.concat(t):[null].concat(t),t}computeMask(e,t){return j_((()=>{if(null==t)return null;if(!Array.isArray(t))throw new VB("`mask` should be an Array");if(!Array.isArray(e))throw new VB("`inputs` should be an Array");if(t.length!==e.length)throw new VB(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${t.length})`);if(t.every((e=>null==e)))return null;t=t.map((e=>null==e?e:tR(e,0)));let n=t[0];for(let e=1;e<t.length-1;++e)n=DR(n,t[e]);return n}))}},uG=class extends lG{constructor(e){super(e)}mergeFunction(e){return j_((()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=r$(t,e[n]);return t}))}};uG.className="Add",uO.registerClass(uG);var dG=class extends lG{constructor(e){super(e)}mergeFunction(e){return j_((()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=s$(t,e[n]);return t}))}};dG.className="Multiply",uO.registerClass(dG);var cG=class extends lG{constructor(e){super(e)}mergeFunction(e){return j_((()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=r$(t,e[n]);return s$(1/e.length,t)}))}};cG.className="Average",uO.registerClass(cG);var pG=class extends lG{constructor(e){super(e)}mergeFunction(e){return j_((()=>{let t=e[0];for(let n=1;n<e.length;++n)t=UR(t,e[n]);return t}))}};pG.className="Maximum",uO.registerClass(pG);var hG=class extends lG{constructor(e){super(e)}mergeFunction(e){return j_((()=>{let t=e[0];for(let n=1;n<e.length;++n)t=KR(t,e[n]);return t}))}};hG.className="Minimum",uO.registerClass(hG);var fG=class extends lG{constructor(e){super(e),this.DEFAULT_AXIS=-1,null==e&&(e={}),this.axis=null==e.axis?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!Array.isArray(e)||!Array.isArray(e[0])||1===e.length)throw new VB("A `Concatenate` layer should be called on a list of at least 2 inputs");let t=!0;for(let r of e)if(null!=r){t=!1;break}if(t)return;let n=[];for(let r=0;r<e.length;++r){let t=e[r].slice();t.splice(this.axis,1);let a=!1;for(let e of n)if(pT.arraysEqual(e,t)){a=!0;break}a||n.push(t)}if(n.length>1)throw new VB("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return j_((()=>UW(e,this.axis)))}computeOutputShape(e){if(!Array.isArray(e)||!Array.isArray(e[0]))throw new VB("A `Concatenate` layer should be called on a list of inputs.");let t=e,n=t[0].slice(),r=this.axis<0?n.length+this.axis:this.axis;for(let a of t.slice(1)){if(null==n[r]||null==a[r]){n[r]=null;break}n[r]+=a[r]}return n}computeMask(e,t){if(null==t)return null;if(!Array.isArray(t))throw new VB("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new VB("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new VB(`Mismatch in the length of mask (${t.length}) and the legnth of inputs (${e.length})`);return j_((()=>{let n=!0;if(t.forEach((e=>{null==e||(n=!1)})),n)return null;let r=[];for(let i=0;i<e.length;++i)null==t[i]?r.push(D_(nD(e[i]),"bool")):t[i].rank<e[i].rank?r.push(tR(t[i],-1)):r.push(t[i]);let a=L$(r,this.axis);return c$(a,-1,!1)}))}getConfig(){let e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}};function mG(e,t){for(;e<0;)e+=t;return e}fG.className="Concatenate",uO.registerClass(fG);var gG=class extends lG{constructor(e){super(e),this.axes=e.axes,this.normalize=null!=e.normalize&&e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){pT.assert(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),(()=>"A `Dot` layer should be called on a list of exactly 2 inputs."));let t=e[0],n=e[1];if(t.length>3||n.length>3)throw new UB("Dot layer does not support tensors of 4D or higher rank yet.");let r=this.interpretAxes(t,n);if(t[r[0]]!==n[r[1]])throw new VB(`Dimension incompatibility: ${t[r[0]]} !== ${n[r[1]]}`)}mergeFunction(e){if(2!==e.length)throw new VB(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let t,n=e[0],r=e[1];return t=Array.isArray(this.axes)?this.axes.map(((t,n)=>mG(t,e[n].shape.length))):[mG(this.axes,n.shape.length),mG(this.axes,r.shape.length)],this.normalize&&(n=PU(n,t[0]),r=PU(r,t[1])),function(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new UB("batchDot is not implemented for tensors of 4D or higher rank yet");if(pT.assert(e.shape.length>=2,(()=>`batchDot requires the rank of x to be >= 2, but got ${e.shape.length}`)),pT.assert(e.shape.length>=2,(()=>`batchDot requires the rank of y to be >= 2, but got ${t.shape.length}`)),"number"==typeof n&&(n=[n,n]),"complex64"===e.dtype||"complex64"===t.dtype)throw new UB("batchDot is not implemented for complex64-type Tensors yet.");let r=e.shape.length,a=t.shape.length;null==n&&(n=[r-1,a-2]);let i=n;return j_((()=>{let n,s;if(r>a){n=r-a;let e=[];for(let t=0;t<n;++t)e.push(1);t=M$(t,t.shape.concat(e))}else if(a>r){n=a-r;let t=[];for(let e=0;e<n;++e)t.push(1);e=M$(e,e.shape.concat(t))}else n=0;if(2===e.shape.length&&2===t.shape.length)s=i[0]===i[1]?YA(s$(e,t),i[0]):YA(s$(BF(e,[1,0]),t),i[1]);else{let n=i[0]!==e.shape.length-1,r=i[1]===t.shape.length-1;s=z$(e,t,n,r)}if(n>0){let e;e=r>a?r+a-3:r-1;let t=[];for(let r=e;r<e+n;++r)t.push(r);s=fF(s,t)}return 1===s.shape.length&&(s=tR(s,1)),s}))}(n,r,t)}interpretAxes(e,t){let n;return n=Array.isArray(this.axes)?this.axes:[mG(this.axes,e.length),mG(this.axes,t.length)],n}computeOutputShape(e){pT.assert(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),(()=>"A `Dot` layer should be called on a list of exactly 2 inputs."));let t=e[0].slice(),n=e[1].slice();if(t.length>3||n.length>3)throw new UB("Dot layer does not support tensors of 4D or higher rank yet.");let r=this.interpretAxes(t,n);t.splice(r[0],1),n.splice(r[1],1),n.splice(0,1);let a=t.concat(n);return 1===a.length&&a.push(1),a}computeMask(e,t){return null}getConfig(){let e={axes:this.axes,normalize:this.normalize},t=super.getConfig();return Object.assign(e,t),e}};gG.className="Dot",uO.registerClass(gG);var bG=class extends OV{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={stddev:this.stddev};return Object.assign(t,e),t}call(e,t){return j_((()=>{this.invokeCallHook(e,t);let n=IV(e);return QW((()=>r$(GW(n.shape,0,this.stddev),n)),(()=>n),t.training||!1)}))}};bG.className="GaussianNoise",uO.registerClass(bG);var yG=class extends OV{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return j_((()=>{this.invokeCallHook(e,t);let n=IV(e);return this.rate>0&&this.rate<1?QW((()=>{let e=Math.sqrt(this.rate/(1-this.rate));return s$(n,GW(n.shape,1,e))}),(()=>n),t.training||!1):n}))}};yG.className="GaussianDropout",uO.registerClass(yG);var vG=class extends OV{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||IV(e).shape}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return j_((()=>{if(this.rate<1&&this.rate>0){let n=this._getNoiseShape(e);return QW((()=>{let t=IV(e),r=-1.7580993408473766,a=lR(PD(n),this.rate);a=LW(a,"float32");let i=((1-this.rate)*(1+this.rate*r**2))**-.5,s=-i*r*this.rate,o=r$(s$(t,a),s$(r$(a,-1),r));return r$(s$(o,i),s)}),(()=>IV(e)),t.training||!1)}return e}))}};function xG(e,t,n,r,a,i=.001){let s;if(2===e.rank)s=q$(e,t,n,r,a,i);else if(3===e.rank)s=K$(e,t,n,r,a,i);else{if(4!==e.rank)throw new UB(`batchNormalization is not implemented for array of rank ${e.rank} yet`);s=X$(e,t,n,r,a,i)}return s}function wG(e,t,n,r,a=.001){return pT.arraysEqual(r.slice().sort(),OW(0,e.rank-1))?function(e,t,n,r,a=.001){return j_((()=>{let i=JR(e,r),s=i.mean,o=i.variance;return[xG(e,s,o,n,t,a),s,o]}))}(e,t,n,r,a):function(e,t,n,r,a=.001){return j_((()=>{let i=JR(e,r),s=i.mean,o=i.variance,l=[];for(let t of OW(0,e.rank))-1!==r.indexOf(t)?l.push(1):l.push(e.shape[t]);let u=M$(s,l),d=M$(o,l),c=null==t?null:M$(t,l),p=null==n?null:M$(n,l);return[xG(e,u,d,p,c,a),s,o]}))}(e,t,n,r,a)}vG.className="AlphaDropout",uO.registerClass(vG);var kG=class extends OV{constructor(e){null==e&&(e={}),super(e),this.supportsMasking=!0,this.axis=null==e.axis?-1:e.axis,this.momentum=null==e.momentum?.99:e.momentum,this.epsilon=null==e.epsilon?.001:e.epsilon,this.center=null==e.center||e.center,this.scale=null==e.scale||e.scale,this.betaInitializer=wV(e.betaInitializer||"zeros"),this.gammaInitializer=wV(e.gammaInitializer||"ones"),this.movingMeanInitializer=wV(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=wV(e.movingVarianceInitializer||"ones"),this.betaConstraint=rU(e.betaConstraint),this.gammaConstraint=rU(e.gammaConstraint),this.betaRegularizer=pH(e.betaRegularizer),this.gammaRegularizer=pH(e.gammaRegularizer)}build(e){e=NV(e);let t=this.axis>=0?this.axis:this.axis+e.length,n=e[t];if(null==n)throw new VB(`Axis ${t} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new AV({ndim:e.length,axes:{[t]:n}})];let r=[n];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,t){return j_((()=>{let n=null!=t.training&&t.training,r=IV(e),a=r.shape,i=a.length,s=OW(0,i),o=this.axis>=0?this.axis:this.axis+i;s.splice(o,1);let l=GB(1,i);l[o]=a[o];let u=s.slice();u.sort();let d=!pT.arraysEqual(u,OW(0,i).slice(0,i-1));if(!n)return(()=>{if(d){let e=M$(this.movingMean.read(),l),t=M$(this.movingVariance.read(),l),n=this.center?M$(this.beta.read(),l):null,a=this.scale?M$(this.gamma.read(),l):null;return xG(r,e,t,n,a,this.epsilon)}return xG(r,this.movingMean.read(),this.movingVariance.read(),null==this.beta?null:this.beta.read(),null==this.gamma?null:this.gamma.read(),this.epsilon)})();let[c,p,h]=wG(r,this.gamma.read(),this.beta.read(),s,this.epsilon),f=(e,t,n)=>{j_((()=>{let r=1-n,a=e.read(),i=s$($R(a,t),r);e.write($R(a,i))}))};return f(this.movingMean,p,this.momentum),f(this.movingVariance,h,this.momentum),c}))}getConfig(){let e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:xV(this.betaInitializer),gammaInitializer:xV(this.gammaInitializer),movingMeanInitializer:xV(this.movingMeanInitializer),movingVarianceInitializer:xV(this.movingVarianceInitializer),betaRegularizer:dH(this.betaRegularizer),gammaRegularizer:dH(this.gammaRegularizer),betaConstraint:tU(this.betaConstraint),gammaConstraint:tU(this.gammaConstraint)},t=super.getConfig();return Object.assign(e,t),e}};kG.className="BatchNormalization",uO.registerClass(kG);var SG=class extends OV{constructor(e){if(null==e&&(e={}),super(e),this.axis=null==e.axis?-1:e.axis,"number"==typeof this.axis){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else{if(!Array.isArray(this.axis))throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);for(let e of this.axis)if(!Number.isInteger(e))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}this.epsilon=null==e.epsilon?.001:e.epsilon,this.center=null==e.center||e.center,this.scale=null==e.scale||e.scale,this.betaInitializer=wV(e.betaInitializer||"zeros"),this.gammaInitializer=wV(e.gammaInitializer||"ones"),this.betaRegularizer=pH(e.betaRegularizer),this.gammaRegularizer=pH(e.gammaRegularizer),this.supportsMasking=!0}build(e){let t=(e=NV(e)).length;"number"==typeof this.axis&&(this.axis=[this.axis]);for(let r=0;r<this.axis.length;++r)this.axis[r]<0&&(this.axis[r]+=t);for(let r of this.axis)if(r<0||r>=t)throw new Error(`Invalid axis: ${r}`);if(this.axis.length!==aW(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);let n=this.axis.map((t=>e[t]));this.scale?this.gamma=this.addWeight("gamma",n,"float32",this.gammaInitializer,this.gammaRegularizer,!0):this.gamma=null,this.center?this.beta=this.addWeight("beta",n,"float32",this.betaInitializer,this.betaRegularizer,!0):this.beta=null,this.built=!0}call(e,t){let n=IV(e),r=n.shape,a=r.length;return j_((()=>{let{mean:e,variance:t}=JR(n,this.axis,!0),i=GB(1,a);for(let n of this.axis)i[n]=r[n];let s=e=>null!=e&&e.shape.length!==a?M$(e,i):e,o=this.scale?s(this.gamma.read()):null,l=this.center?s(this.beta.read()):null,u=[],d=[];for(let n=0;n<a;++n)-1!==this.axis.indexOf(n)?(u.push(r[n]),d.push(1)):(u.push(1),d.push(r[n]));return e=rR(e,u),t=rR(t,u),null!=o&&(o=rR(o,d)),null!=l&&(l=rR(l,d)),xG(n,e,t,l,o,this.epsilon)}))}getConfig(){let e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:xV(this.betaInitializer),gammaInitializer:xV(this.gammaInitializer),betaRegularizer:dH(this.betaRegularizer),gammaRegularizer:dH(this.gammaRegularizer)},t=super.getConfig();return Object.assign(e,t),e}};SG.className="LayerNormalization",uO.registerClass(SG);var IG=class extends OV{constructor(e){if(null==e&&(e={}),super(e),this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,null==e.padding)this.padding=[[1,1],[1,1]];else if("number"==typeof e.padding)this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,2!==e.padding.length)throw new VB(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let t,n;if("number"==typeof e.padding[0])t=[e.padding[0],e.padding[0]],n=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,2!==e.padding[0].length)throw new VB(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(t=e.padding[0],2!==e.padding[1].length)throw new VB(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);n=e.padding[1]}this.padding=[t,n]}this.inputSpec=[new AV({ndim:4})]}computeOutputShape(e){let t,n;return e=NV(e),"channelsFirst"===this.dataFormat?(t=null!=e[2]&&e[2]>=0?e[2]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[3]&&e[3]>=0?e[3]+this.padding[1][0]+this.padding[1][1]:null,[e[0],e[1],t,n]):(t=null!=e[1]&&e[1]>=0?e[1]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[2]&&e[2]>=0?e[2]+this.padding[1][0]+this.padding[1][1]:null,[e[0],t,n,e[3]])}call(e,t){return j_((()=>function(e,t,n){return j_((()=>{if(4!==e.rank)throw new VB(`temporalPadding expects input tensor to be 4-D, but received a ${e.rank}-D tensor.`);if(null==t&&(t=[[1,1],[1,1]]),2!==t.length||2!==t[0].length||2!==t[1].length)throw new VB("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==n&&(n="channelsLast"),"channelsLast"!==n&&"channelsFirst"!==n)throw new VB(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let r;return r="channelsFirst"===n?[[0,0],[0,0],t[0],t[1]]:[[0,0],t[0],t[1],[0,0]],aD(e,r)}))}(IV(e),this.padding,this.dataFormat)))}getConfig(){let e={padding:this.padding,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}};function NG(e,t,n,r,a,i){return j_((()=>{wW(a),SW(i),kW(r),null==n&&(n=[1,1]),null==r&&(r="valid"),null==a&&(a="channelsLast"),null==i&&(i="max"),e=kH(e,a);let s,o="same"===r?"same":"valid";return s="max"===i?BR(e,t,n,o):O$(e,t,n,o),"channelsFirst"===a&&(s=BF(s,[0,3,1,2])),s}))}function CG(e,t,n,r,a,i){return j_((()=>{wW(a),SW(i),kW(r),null==n&&(n=[1,1,1]),null==r&&(r="valid"),null==a&&(a="channelsLast"),null==i&&(i="max"),e=SH(e,a);let s,o="same"===r?"same":"valid";return s="max"===i?WR(e,t,n,o):P$(e,t,n,o),"channelsFirst"===a&&(s=BF(s,[0,4,1,2,3])),s}))}IG.className="ZeroPadding2D",uO.registerClass(IG);var TG=class extends OV{constructor(e){if(null==e.poolSize&&(e.poolSize=2),super(e),"number"==typeof e.poolSize)this.poolSize=[e.poolSize];else{if(!Array.isArray(e.poolSize)||1!==e.poolSize.length||"number"!=typeof e.poolSize[0])throw new VB(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);this.poolSize=e.poolSize}if(lW(this.poolSize,"poolSize"),null==e.strides)this.strides=this.poolSize;else if("number"==typeof e.strides)this.strides=[e.strides];else{if(!Array.isArray(e.strides)||1!==e.strides.length||"number"!=typeof e.strides[0])throw new VB(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);this.strides=e.strides}lW(this.strides,"strides"),this.padding=null==e.padding?"valid":e.padding,kW(this.padding),this.inputSpec=[new AV({ndim:3})]}computeOutputShape(e){let t=xH((e=NV(e))[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}call(e,t){return j_((()=>{this.invokeCallHook(e,t),e=zW(IV(e),2);let n=this.poolingFunction(IV(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return fF(n,[2])}))}getConfig(){let e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=super.getConfig();return Object.assign(e,t),e}},EG=class extends TG{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return wW(a),kW(r),NG(e,t,n,r,a,"max")}};EG.className="MaxPooling1D",uO.registerClass(EG);var _G=class extends TG{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return wW(a),kW(r),NG(e,t,n,r,a,"avg")}};_G.className="AveragePooling1D",uO.registerClass(_G);var $G=class extends OV{constructor(e){if(null==e.poolSize&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],null==e.strides)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(2!==e.strides.length)throw new VB(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];lW(this.poolSize,"poolSize"),lW(this.strides,"strides"),this.padding=null==e.padding?"valid":e.padding,this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,wW(this.dataFormat),kW(this.padding),this.inputSpec=[new AV({ndim:4})]}computeOutputShape(e){e=NV(e);let t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2];return t=xH(t,this.poolSize[0],this.padding,this.strides[0]),n=xH(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n]:[e[0],t,n,e[3]]}call(e,t){return j_((()=>(this.invokeCallHook(e,t),this.poolingFunction(IV(e),this.poolSize,this.strides,this.padding,this.dataFormat))))}getConfig(){let e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}},AG=class extends $G{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return wW(a),kW(r),NG(e,t,n,r,a,"max")}};AG.className="MaxPooling2D",uO.registerClass(AG);var RG=class extends $G{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return wW(a),kW(r),NG(e,t,n,r,a,"avg")}};RG.className="AveragePooling2D",uO.registerClass(RG);var DG=class extends OV{constructor(e){if(null==e.poolSize&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],null==e.strides)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(3!==e.strides.length)throw new VB(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];lW(this.poolSize,"poolSize"),lW(this.strides,"strides"),this.padding=null==e.padding?"valid":e.padding,this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,wW(this.dataFormat),kW(this.padding),this.inputSpec=[new AV({ndim:5})]}computeOutputShape(e){e=NV(e);let t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],r="channelsFirst"===this.dataFormat?e[4]:e[3];return t=xH(t,this.poolSize[0],this.padding,this.strides[0]),n=xH(n,this.poolSize[1],this.padding,this.strides[1]),r=xH(r,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n,r]:[e[0],t,n,r,e[4]]}call(e,t){return j_((()=>(this.invokeCallHook(e,t),this.poolingFunction(IV(e),this.poolSize,this.strides,this.padding,this.dataFormat))))}getConfig(){let e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}},FG=class extends DG{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return wW(a),kW(r),CG(e,t,n,r,a,"max")}};FG.className="MaxPooling3D",uO.registerClass(FG);var MG=class extends DG{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return wW(a),kW(r),CG(e,t,n,r,a,"avg")}};MG.className="AveragePooling3D",uO.registerClass(MG);var OG=class extends OV{constructor(e){super(e),this.inputSpec=[new AV({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,t){throw new UB}},PG=class extends OG{constructor(e){super(e||{})}call(e,t){return j_((()=>{let t=IV(e);return jR(t,1)}))}};PG.className="GlobalAveragePooling1D",uO.registerClass(PG);var LG=class extends OG{constructor(e){super(e||{})}call(e,t){return j_((()=>{let t=IV(e);return jA(t,1)}))}};LG.className="GlobalMaxPooling1D",uO.registerClass(LG);var zG=class extends OV{constructor(e){super(e),this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,wW(this.dataFormat),this.inputSpec=[new AV({ndim:4})]}computeOutputShape(e){return"channelsLast"===this.dataFormat?[e[0],e[3]]:[e[0],e[1]]}call(e,t){throw new UB}getConfig(){let e={dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}},BG=class extends zG{call(e,t){return j_((()=>{let t=IV(e);return"channelsLast"===this.dataFormat?jR(t,[1,2]):jR(t,[2,3])}))}};BG.className="GlobalAveragePooling2D",uO.registerClass(BG);var WG=class extends zG{call(e,t){return j_((()=>{let t=IV(e);return"channelsLast"===this.dataFormat?jA(t,[1,2]):jA(t,[2,3])}))}};WG.className="GlobalMaxPooling2D",uO.registerClass(WG);var VG=class extends OV{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return null!=this.layer&&this.layer.trainable}set trainable(e){null!=this.layer&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){let e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=super.getConfig();return Object.assign(e,t),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,t,n={}){let r=OU(t.layer,n);delete t.layer;let a={layer:r};return Object.assign(a,t),new e(a)}},UG=class extends VG{constructor(e){super(e),this.supportsMasking=!0}build(e){if((e=NV(e)).length<3)throw new VB(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];let t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),super.build(e)}computeOutputShape(e){let t=[(e=NV(e))[0]].concat(e.slice(2)),n=this.layer.computeOutputShape(t),r=e[1];return[n[0],r].concat(n.slice(1))}call(e,t){return j_((()=>LH(((e,n)=>[IV(this.layer.call(e,t)),[]]),e=IV(e),[],!1,null,null,!1,!0)[1]))}};UG.className="TimeDistributed",uO.registerClass(UG);var jG=class extends VG{constructor(e){super(e);let t=e.layer.getConfig(),n={};n.className=e.layer.getClassName(),n.config=t,this.forwardLayer=OU(n),t.goBackwards=!0!==t.goBackwards;let r={};if(r.className=e.layer.getClassName(),r.config=t,this.backwardLayer=OU(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=void 0===e.mergeMode?"concat":e.mergeMode,function(e){sW(vW,"BidirectionalMergeMode",e)}(this.mergeMode),e.weights)throw new UB("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,null!=this.forwardLayer&&(this.forwardLayer.trainable=e),null!=this.backwardLayer&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){let t=e.length,n=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,n)),this.backwardLayer.setWeights(e.slice(n))}computeOutputShape(e){let t,n,r,a=this.forwardLayer.computeOutputShape(e);return Array.isArray(a)&&Array.isArray(a[0])||(a=[a]),this.returnState&&(r=a.slice(1)),t=a[0],"concat"===this.mergeMode?(t[t.length-1]*=2,n=[t]):n=null==this.mergeMode?[t,t.slice()]:[t],this.returnState?null==this.mergeMode?n.concat(r).concat(r.slice()):[t].concat(r).concat(r.slice()):XB(n)}apply(e,t){let n=null==t?null:t.initialState,r=null==t?null:t.constants;null==t&&(t={});let a=PH(e,n,r,this.numConstants);if(e=a.inputs,n=a.initialState,r=a.constants,Array.isArray(e)&&(n=e.slice(1),e=e[0]),(null==n||0===n.length)&&null==r)return super.apply(e,t);let i=[],s=[];if(null!=n){let e=n.length;if(e%2>0)throw new VB("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=n,i.push(...n);let r=n.map((e=>new AV({shape:e.shape})));this.forwardLayer.stateSpec=r.slice(0,e/2),this.backwardLayer.stateSpec=r.slice(e/2),s.push(...r)}if(null!=r)throw new UB("Support for constants in Bidirectional layers is not implemented yet.");let o=i[0]instanceof RV;for(let l of i)if(l instanceof RV!==o)throw new VB("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(o){let n=[e].concat(i),r=this.inputSpec.concat(s),a=this.inputSpec;this.inputSpec=r;let o=super.apply(n,t);return this.inputSpec=a,o}return super.apply(e,t)}call(e,t){return j_((()=>{let n,r,a,i,s=t.initialState;if(null==s)n=this.forwardLayer.call(e,t),r=this.backwardLayer.call(e,t);else{let a=s.slice(0,s.length/2),i=s.slice(s.length/2);n=this.forwardLayer.call(e,Object.assign(t,{initialState:a})),r=this.backwardLayer.call(e,Object.assign(t,{initialState:i}))}return this.returnState&&(Array.isArray(n)&&(a=n.slice(1).concat(r.slice(1))),n=n[0],r=r[0]),this.returnSequences&&(r=jD(r,1)),"concat"===this.mergeMode?i=UW([n,r]):"sum"===this.mergeMode?i=r$(n,r):"ave"===this.mergeMode?i=s$(.5,r$(n,r)):"mul"===this.mergeMode?i=s$(n,r):null==this.mergeMode&&(i=[n,r]),this.returnState?null==this.mergeMode?i.concat(a):[i].concat(a):i}))}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){CW(this.forwardLayer.name,(()=>{this.forwardLayer.build(e)})),CW(this.backwardLayer.name,(()=>{this.backwardLayer.build(e)})),this.built=!0}computeMask(e,t){let n;if(Array.isArray(t)&&(t=t[0]),n=this.returnSequences?null==this.mergeMode?[t,t]:t:null==this.mergeMode?[null,null]:null,this.returnState){let e=this.forwardLayer.states.map((e=>null));return Array.isArray(n)?n.concat(e).concat(e):[n].concat(e).concat(e)}return n}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(e),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){let e={mergeMode:this.mergeMode},t=super.getConfig();return Object.assign(e,t),e}static fromConfig(e,t){let n=OU(t.layer);if(delete t.layer,null!=t.numConstants)throw new UB("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");let r=t;return r.layer=n,new e(r)}};jG.className="Bidirectional",uO.registerClass(jG);var HG=class extends OV{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){let e={scale:this.scale,offset:this.offset},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return j_((()=>("float32"!==(e=IV(e)).dtype&&(e=LW(e,"float32")),r$(s$(e,this.scale),this.offset))))}};HG.className="Rescaling",uO.registerClass(HG);var{resizeBilinear:GG,cropAndResize:qG}=aO,KG=class extends OV{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,t,n,r,a,i,s,o){return j_((()=>{let l,u=!1,d=[t/i,n/s,(r+t)/i,(a+n)/s],c=[];3===e.rank?(u=!0,l=mF([e])):l=e;for(let e=0;e<l.shape[0];e++)c.push(d);let p=ME(c,[c.length,4]),h=zD(0,c.length,1,"int32"),f=qG(l,p,h,[r,a],"nearest");return LW(u?IV(FF(f)):f,o)}))}upsize(e,t,n,r){return j_((()=>LW(GG(e,[t,n]),r)))}call(e,t){return j_((()=>{let t=IV(e),n=t.dtype,r=t.shape,a=r[r.length-3],i=r[r.length-2],s=0;a!==this.height&&(s=Math.floor((a-this.height)/2));let o=0;return i!==this.width&&(o=Math.floor((i-this.width)/2),0===o&&(o=1)),s>=0&&o>=0?this.centerCrop(t,s,o,this.height,this.width,a,i,n):this.upsize(e,this.height,this.width,n)}))}getConfig(){let e={height:this.height,width:this.width},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){let t=(e=NV(e)).length-3,n=e.length-2;return e[t]=this.height,e[n]=this.width,e}};KG.className="CenterCrop",uO.registerClass(KG);var XG=class extends OV{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){let e={numTokens:this.numTokens,outputMode:this.outputMode},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){return null==(e=NV(e))?[this.numTokens]:"oneHot"===this.outputMode&&1!==e[e.length-1]?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,t){return j_((()=>{let n;if("int32"!==(e=IV(e)).dtype&&(e=LW(e,"int32")),void 0!==t.countWeights){if("count"!==this.outputMode)throw new VB(`countWeights is not used when outputMode !== count.\n              Received countWeights=${t.countWeights}`);n=IV(t.countWeights)}let r=jA(e),a=HA(e),i=oR(this.numTokens,r).bufferSync().get(0),s=lR(a,0).bufferSync().get(0);if(!i||!s)throw new VB(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return function(e,t,n,r){let a=IV(e);if("int32"!==a.dtype&&(a=LW(a,"int32")),"int"===t)return a;let i=a.shape;if(0===a.rank&&(a=tR(a,-1)),"oneHot"===t&&1!==a.shape[a.shape.length-1]&&(a=tR(a,-1)),a.rank>2)throw new VB(`When outputMode is not int, maximum output rank is 2 Received outputMode ${t} and input shape ${i} which would result in output rank ${a.rank}.`);let s,o=["multiHot","oneHot"].includes(t),l=a;if(s=yA(l,void 0!==r&&"count"===t?r:[],n,o),"tfIdf"!==t)return s;if(r)return s$(s,r);throw new VB("When outputMode is 'tfIdf', weights must be provided.")}(e,this.outputMode,this.numTokens,n)}))}};XG.className="CategoryEncoding",uO.registerClass(XG);var YG=new Set(["bilinear","nearest"]),JG=class extends OV{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation){if(!YG.has(e.interpolation))throw new VB(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);this.interpolation=e.interpolation}else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){let t=(e=NV(e))[2];return[this.height,this.width,t]}getConfig(){let e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return j_((()=>{let t=[this.height,this.width];if("bilinear"===this.interpolation)return aO.resizeBilinear(e,t,!this.cropToAspectRatio);if("nearest"===this.interpolation)return aO.resizeNearestNeighbor(e,t,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...YG]} are supported`)}))}};JG.className="Resizing",uO.registerClass(JG);var ZG=class{constructor(e){this.seed=e}next(){if(void 0!==this.seed)return this.seed++}};ZG.className="RandomSeed";var QG=class extends OV{constructor(e){super(e),this.randomGenerator=new ZG(e.seed)}getConfig(){let e={seed:this.randomGenerator.seed},t=super.getConfig();return Object.assign(e,t),e}};QG.className="BaseRandomLayer";var eq=new Set(["bilinear","nearest"]),tq=class extends QG{constructor(e){super(e);let{factor:t,interpolation:n="bilinear"}=e;if(this.factor=t,Array.isArray(this.factor)&&2===this.factor.length)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else{if(Array.isArray(this.factor)||!(this.factor>0))throw new VB(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);this.widthLower=-this.factor,this.widthUpper=this.factor}if(this.widthLower<-1||this.widthUpper<-1)throw new VB(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new VB(`factor cannot have upper bound less than lower bound.\n        Got upper bound: ${this.widthUpper}.\n        Got lower bound: ${this.widthLower}\n      `);if(n){if(!eq.has(n))throw new VB(`Invalid interpolation parameter: ${n} is not implemented`);this.interpolation=n}}getConfig(){let e={factor:this.factor,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){let t=(e=NV(e))[2];return[this.imgHeight,-1,t]}call(e,t){return j_((()=>{let t=IV(e);this.imgHeight=t.shape[t.shape.length-3];let n=t.shape[t.shape.length-2];this.widthFactor=PD([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let r=this.widthFactor.dataSync()[0]*n;r=Math.round(r);let a=[this.imgHeight,r];switch(this.interpolation){case"bilinear":return aO.resizeBilinear(e,a);case"nearest":return aO.resizeNearestNeighbor(e,a);default:throw new Error(`Interpolation is ${this.interpolation}\n          but only ${[...eq]} are supported`)}}))}};function nq(e){return new LV(e)}function rq(e){return new gH(e)}function aq(e){return new hH(e)}function iq(e){return new fH(e)}function sq(e){return new mH(e)}function oq(e){return new yH(e)}function lq(e){return new bH(e)}function uq(e){return new DH(e)}function dq(e){return new TH(e)}function cq(e){return new _H(e)}function pq(e){return new EH(e)}function hq(e){return new $H(e)}function fq(e){return new RH(e)}function mq(e){return new FH(e)}function gq(e){return new MH(e)}function bq(e){return new OH(e)}function yq(e){return new nG(e)}function vq(e){return new eG(e)}function xq(e){return new ZH(e)}function wq(e){return new QH(e)}function kq(e){return new tG(e)}function Sq(e){return new rG(e)}function Iq(e){return new aG(e)}function Nq(e){return new iG(e)}function Cq(e){return new oG(e)}function Tq(e){return new uG(e)}function Eq(e){return new cG(e)}function _q(e){return new fG(e)}function $q(e){return new pG(e)}function Aq(e){return new hG(e)}function Rq(e){return new dG(e)}function Dq(e){return new gG(e)}function Fq(e){return new kG(e)}function Mq(e){return new SG(e)}function Oq(e){return new IG(e)}function Pq(e){return new _G(e)}function Lq(e){return Pq(e)}function zq(e){return Pq(e)}function Bq(e){return new RG(e)}function Wq(e){return Bq(e)}function Vq(e){return Bq(e)}function Uq(e){return new MG(e)}function jq(e){return Uq(e)}function Hq(e){return Uq(e)}function Gq(e){return new PG(e)}function qq(e){return new BG(e)}function Kq(e){return new LG(e)}function Xq(e){return new WG(e)}function Yq(e){return new EG(e)}function Jq(e){return new AG(e)}function Zq(e){return new FG(e)}function Qq(e){return new jH(e)}function eK(e){return new UH(e)}function tK(e){return new GH(e)}function nK(e){return new HH(e)}function rK(e){return new VH(e)}function aK(e){return new WH(e)}function iK(e){return new JH(e)}function sK(e){return new YH(e)}function oK(e){return new zH(e)}function lK(e){return new qH(e)}function uK(e){return new jG(e)}function dK(e){return new UG(e)}tq.className="RandomWidth",uO.registerClass(tq);var cK=Kq,pK=Xq,hK=Yq,fK=Jq;function mK(e){return new bG(e)}function gK(e){return new yG(e)}function bK(e){return new vG(e)}function yK(e){return new sG(e)}function vK(e){return new HG(e)}function xK(e){return new KG(e)}function wK(e){return new JG(e)}function kK(e){return new XG(e)}function SK(e){return new tq(e)}var IK={};function NK(e,t){return qU(e,t)}function CK(e,t){return ZU(e,t)}function TK(e,t){return QU(e,t)}function EK(e,t){return KU(e,t)}function _K(e,t){return ej(e,t)}function $K(e,t){return YU(e,t)}function AK(e,t){return JU(e,t)}function RK(e,t){return jU(e,t)}function DK(e,t){return zU(e,t)}function FK(e,t){return BU(e,t)}function MK(e,t){return BU(e,t)}function OK(e,t){return BU(e,t)}function PK(e,t){return LU(e,t)}function LK(e,t){return LU(e,t)}function zK(e,t){return LU(e,t)}ok(IK,{MAPE:()=>MK,MSE:()=>LK,binaryAccuracy:()=>NK,binaryCrossentropy:()=>CK,categoricalAccuracy:()=>EK,categoricalCrossentropy:()=>_K,cosineProximity:()=>RK,mape:()=>OK,meanAbsoluteError:()=>DK,meanAbsolutePercentageError:()=>FK,meanSquaredError:()=>PK,mse:()=>zK,precision:()=>$K,recall:()=>AK,sparseCategoricalAccuracy:()=>TK});var BK={};ok(BK,{modelFromJSON:()=>Mj});var WK={};function VK(e){return new lH(e)}function UK(e){return function(e){return sH(e),new lH({l1:null!=e?e.l1:null,l2:0})}(e)}function jK(e){return function(e){return sH(e),new lH({l2:null!=e?e.l2:null,l1:0})}(e)}ok(WK,{l1:()=>UK,l1l2:()=>VK,l2:()=>jK});var HK=class extends EU{constructor(){super(...arguments),this.model=null}setModel(e){if(!(e instanceof Dj))throw new Error("model must be a LayersModel, not some other Container");this.model=e}};function GK(e,t){return e<t}function qK(e,t){return e>t}var KK,XK,YK=class extends HK{constructor(e){if(super(),null==e&&(e={}),e.restoreBestWeights)throw new UB("restoreBestWeights = True is not implemented in EarlyStopping yet.");this.monitor=e.monitor||"val_loss",this.minDelta=Math.abs(e.minDelta||0),this.patience=e.patience||0,this.verbose=e.verbose||0,this.mode=e.mode||"auto",this.baseline=e.baseline,-1===["auto","min","max"].indexOf(this.mode)&&(console.warn(`EarlyStopping mode '${this.mode}' is invalid. Falling back to mode 'auto'.`),this.mode="auto"),"min"===this.mode?this.monitorFunc=GK:"max"===this.mode||-1!==this.monitor.indexOf("acc")?this.monitorFunc=qK:this.monitorFunc=GK,this.monitorFunc===GK&&(this.minDelta*=-1)}async onTrainBegin(e){this.wait=0,this.stoppedEpoch=0,null!=this.baseline?this.best=this.baseline:this.best=this.monitorFunc===GK?1/0:-1/0}async onEpochEnd(e,t){await CU(t);let n=this.getMonitorValue(t);null!=n&&(this.monitorFunc(n-this.minDelta,this.best)?(this.best=n,this.wait=0):(this.wait++,this.wait>=this.patience&&(this.stoppedEpoch=e,this.model.stopTraining=!0)))}async onTrainEnd(e){this.stoppedEpoch>0&&this.verbose&&console.log(`Epoch ${this.stoppedEpoch}: early stopping.`)}getMonitorValue(e){null==e&&(e={});let t=e[this.monitor];return null==t&&console.warn(`Metric for EarlyStopping ${this.monitor} is not available. Available metrics are: ${Object.keys(e)}`),t}},JK={earlyStopping:function(e){return new YK(e)}};$S().registerFlag("KEEP_INTERMEDIATE_TENSORS",(()=>!1),(e=>{e&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")})),function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_QINT16=15]="DT_QINT16",e[e.DT_QUINT16=16]="DT_QUINT16",e[e.DT_UINT16=17]="DT_UINT16",e[e.DT_COMPLEX128=18]="DT_COMPLEX128",e[e.DT_HALF=19]="DT_HALF",e[e.DT_RESOURCE=20]="DT_RESOURCE",e[e.DT_VARIANT=21]="DT_VARIANT",e[e.DT_UINT32=22]="DT_UINT32",e[e.DT_UINT64=23]="DT_UINT64",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",e[e.DT_QINT16_REF=115]="DT_QINT16_REF",e[e.DT_QUINT16_REF=116]="DT_QUINT16_REF",e[e.DT_UINT16_REF=117]="DT_UINT16_REF",e[e.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",e[e.DT_HALF_REF=119]="DT_HALF_REF",e[e.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",e[e.DT_VARIANT_REF=121]="DT_VARIANT_REF",e[e.DT_UINT32_REF=122]="DT_UINT32_REF",e[e.DT_UINT64_REF=123]="DT_UINT64_REF"}(KK||(KK={})),function(e){!function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"}(e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))}(XK||(XK={}));var ZK={};function QK(e,t){let n={tfOpName:e,category:"custom",inputs:[],attrs:[],customExecutor:t};ZK[e]=n}function eX(e){return ZK[e]}function tX(e){delete ZK[e]}function nX(e,t,n,r,a){let i=t.inputParams[e];if(i&&void 0!==i.inputIndexStart){let e=i.inputIndexStart,s=0===i.inputIndexEnd?void 0:void 0===i.inputIndexEnd?e+1:i.inputIndexEnd,o=e<0?t.inputNames.length+e:e;if("tensor"===i.type)return rX(t.inputNames[o],n,r,a);if("tensors"===i.type){let i=t.inputs.slice(e,s);return t.inputNames.slice(e,s).filter(((e,t)=>{var n;return"NoOp"!==(null===(n=i[t])||void 0===n?void 0:n.op)})).map((e=>rX(e,n,r,a)))}let l=rX(t.inputNames[o],n,r,a),u=l.dataSync();return"number"===i.type?u[0]:pT.toNestedArray(l.shape,u)}let s=t.attrParams[e];return s&&s.value}function rX(e,t,n,r){let[a,i]=oX(e,n);if(null!=r){let e=r.getHashTableHandleByName(a);if(null!=e)return e}let s=n.currentContextIds.find((e=>!!t[sX(a,e)]));return void 0!==s?t[sX(a,s)][i]:void 0}function aX(e,t,n){return t[sX(e,n.currentContextId)]}function iX(e,t){let[n,r,a]=oX(e,t);return[sX(n,t&&t.currentContextId),r,a]}function sX(e,t){return t?`${e}-${t}`:e}function oX(e,t){if(""===e)return["",0,void 0];let n=null!=t&&null!=t.parseNodeNameCache;if(n){let n=t.parseNodeNameCache.get(e);if(null!=n)return n}let r,a=e.split(":");if(1===a.length)r=[e,0,void 0];else{let e=a[0],t=3===a.length?a[1]:void 0;r=[e,Number(a[a.length-1]),t]}return n&&t.parseNodeNameCache.set(e,r),r}function lX(e,t,n){let r=nX("pad",e,t,n);if("explicit"===r){r=nX("explicitPaddings",e,t,n);let a=[[0,0],[0,0],[0,0],[0,0]];for(let e=0;e<4;e++)a[e][0]=r[2*e],a[e][1]=r[2*e+1];return a}return r}function uX(e){return e.kept?e:F_(e)}var dX={};ok(dX,{json:()=>cX});var cX=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],pX={};ok(pX,{json:()=>hX});var hX=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],fX={};ok(fX,{json:()=>mX});var mX=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],gX={};ok(gX,{json:()=>bX});var bX=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],yX={};ok(yX,{json:()=>vX});var vX=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],xX={};ok(xX,{json:()=>wX});var wX=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],kX={};ok(kX,{json:()=>SX});var SX=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],IX={};ok(IX,{json:()=>NX});var NX=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],CX={};ok(CX,{json:()=>TX});var TX=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],EX={};ok(EX,{json:()=>_X});var _X=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],$X={};ok($X,{json:()=>AX});var AX=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],RX={};ok(RX,{json:()=>DX});var DX=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],FX={};ok(FX,{json:()=>MX});var MX=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],OX={};ok(OX,{json:()=>PX});var PX=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],LX={};ok(LX,{json:()=>zX});var zX=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],BX={};ok(BX,{json:()=>WX});var WX=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],VX={};ok(VX,{json:()=>UX});var UX=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],jX={};ok(jX,{json:()=>HX});var HX=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],GX={};ok(GX,{json:()=>qX});var qX=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],KX=class{static get Instance(){return this._instance||(this._instance=new this)}constructor(){let e=[].concat(...[dX,pX,fX,gX,yX,xX,kX,IX,CX,EX,$X,RX,FX,OX,LX,BX,VX,jX,GX].map((e=>e.json)));this.opMappers=e.reduce(((e,t)=>(e[t.tfOpName]=t,e)),{})}transformGraph(e,t={}){let n=e.node,r=[],a=[],i=[],s=n.reduce(((e,t)=>(e[t.name]=this.mapNode(t),t.op.startsWith("Placeholder")?r.push(e[t.name]):"Const"===t.op?a.push(e[t.name]):(null==t.input||0===t.input.length)&&i.push(e[t.name]),e)),{}),o=[],l=[],u={},d={};null!=t&&(u=this.mapSignatureEntries(t.inputs),d=this.mapSignatureEntries(t.outputs));let c=Object.keys(s);c.forEach((e=>{let t=s[e];t.inputNames.forEach(((e,n)=>{let[r,,a]=iX(e),i=s[r];if(null!=i.outputs){let e=i.outputs.indexOf(a);if(-1!==e){let a=`${r}:${e}`;t.inputNames[n]=a}}t.inputs.push(i),i.children.push(t)}))})),0===Object.keys(d).length?c.forEach((e=>{let t=s[e];0===t.children.length&&l.push(t)})):Object.keys(d).forEach((e=>{let[t]=iX(e),n=s[t];null!=n&&(n.signatureKey=d[e],l.push(n))})),Object.keys(u).length>0?Object.keys(u).forEach((e=>{let[t]=iX(e),n=s[t];n&&(n.signatureKey=u[e],o.push(n))})):o=r;let p={};null!=e.library&&null!=e.library.function&&(p=e.library.function.reduce(((e,t)=>(e[t.signature.name]=this.mapFunction(t),e)),{}));let h={nodes:s,inputs:o,outputs:l,weights:a,placeholders:r,signature:t,functions:p};return i.length>0&&(h.initNodes=i),h}mapSignatureEntries(e){return Object.keys(e||{}).reduce(((t,n)=>(t[e[n].name]=n,t)),{})}mapNode(e){let t=eX(e.op)||this.opMappers[e.op]||{};null==e.attr&&(e.attr={});let n={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map((e=>e.startsWith("^")?e.slice(1):e)),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:t.outputs};return null!=t.inputs&&(n.inputParams=t.inputs.reduce(((e,t)=>(e[t.name]={type:t.type,inputIndexStart:t.start,inputIndexEnd:t.end},e)),{})),null!=t.attrs&&(n.attrParams=t.attrs.reduce(((t,n)=>{let r,a=n.type;switch(n.type){case"string":r=YX(e.attr,n.tfName,n.defaultValue),void 0===r&&n.tfDeprecatedName&&(r=YX(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"string[]":r=sY(e.attr,n.tfName,n.defaultValue),void 0===r&&n.tfDeprecatedName&&(r=sY(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number":r=ZX(e.attr,n.tfName,n.defaultValue||0),void 0===r&&n.tfDeprecatedName&&(r=ZX(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number[]":r=iY(e.attr,n.tfName,n.defaultValue),void 0===r&&n.tfDeprecatedName&&(r=iY(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool":r=JX(e.attr,n.tfName,n.defaultValue),void 0===r&&n.tfDeprecatedName&&(r=JX(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool[]":r=lY(e.attr,n.tfName,n.defaultValue),void 0===r&&n.tfDeprecatedName&&(r=lY(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape":r=aY(e.attr,n.tfName,n.defaultValue),void 0===r&&n.tfDeprecatedName&&(r=aY(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape[]":r=oY(e.attr,n.tfName,n.defaultValue),void 0===r&&n.tfDeprecatedName&&(r=oY(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype":r=tY(e.attr,n.tfName,n.defaultValue),void 0===r&&n.tfDeprecatedName&&(r=tY(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype[]":r=nY(e.attr,n.tfName,n.defaultValue),void 0===r&&n.tfDeprecatedName&&(r=nY(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"func":r=eY(e.attr,n.tfName,n.defaultValue),void 0===r&&n.tfDeprecatedName&&(r=eY(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${n.type} for op: ${e.op}`)}return t[n.name]={value:r,type:a},t}),{})),n}mapFunction(e){let t=e.nodeDef,n=[],r={};null!=t&&(r=t.reduce(((e,t)=>(e[t.name]=this.mapNode(t),"Const"===t.op&&n.push(e[t.name]),e)),{}));let a=[],i=[];e.signature.inputArg.forEach((e=>{let[t]=iX(e.name),n={name:t,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:QX(e.type),type:"dtype"}},children:[]};n.signatureKey=e.name,a.push(n),r[t]=n})),Object.keys(r).forEach((e=>{let t=r[e];t.inputNames.forEach(((e,n)=>{let[a,,i]=iX(e),s=r[a];if(null!=s.outputs){let e=s.outputs.indexOf(i);if(-1!==e){let r=`${a}:${e}`;t.inputNames[n]=r}}t.inputs.push(s),s.children.push(t)}))}));let s=e.ret;e.signature.outputArg.forEach((e=>{let[t,n]=iX(s[e.name]),a=r[t];null!=a&&(a.defaultOutput=n,i.push(a))}));let o=this.mapArgsToSignature(e);return{nodes:r,inputs:a,outputs:i,weights:n,placeholders:[],signature:o}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce(((e,t)=>(e[t.name]=this.mapArgToTensorInfo(t),e)),{}),outputs:e.signature.outputArg.reduce(((t,n)=>(t[n.name]=this.mapArgToTensorInfo(n,e.ret),t)),{})}}mapArgToTensorInfo(e,t){let n=e.name;return null!=t&&(n=t[n]),{name:n,dtype:e.type}}};function XX(e,t){let n=Array.isArray(e)?String.fromCharCode.apply(null,e):function(e){let t=$S().global;if(void 0!==t.atob)return t.atob(e);if("undefined"!=typeof Buffer)return new Buffer(e,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}(e);return t?n:n.toLowerCase()}function YX(e,t,n,r=!1){let a=e[t];return null!=a?XX(a.s,r):n}function JX(e,t,n){let r=e[t];return r?r.b:n}function ZX(e,t,n){let r=e[t]||{},a=null!=r.i?r.i:null!=r.f?r.f:n;return"number"==typeof a?a:parseInt(a,10)}function QX(e){switch("string"==typeof e&&(e=KK[e]),e){case KK.DT_FLOAT:case KK.DT_HALF:return"float32";case KK.DT_INT32:case KK.DT_INT64:case KK.DT_INT8:case KK.DT_UINT8:return"int32";case KK.DT_BOOL:return"bool";case KK.DT_DOUBLE:return"float32";case KK.DT_STRING:return"string";default:return null}}function eY(e,t,n){let r=e[t];return r&&r.func?r.func.name:n}function tY(e,t,n){let r=e[t];return r&&r.type?QX(r.type):n}function nY(e,t,n){let r=e[t];return r&&r.list&&r.list.type?r.list.type.map((e=>QX(e))):n}function rY(e){if(!e.unknownRank)return null!=e.dim?e.dim.map((e=>"number"==typeof e.size?e.size:parseInt(e.size,10))):[]}function aY(e,t,n){let r=e[t];return r&&r.shape?rY(r.shape):n}function iY(e,t,n){let r=e[t];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map((e=>"number"==typeof e?e:parseInt(e,10))):n}function sY(e,t,n,r=!1){let a=e[t];return a&&a.list&&a.list.s?a.list.s.map((e=>XX(e,r))):n}function oY(e,t,n){let r=e[t];return r&&r.list&&r.list.shape?r.list.shape.map((e=>rY(e))):n}function lY(e,t,n){let r=e[t];return r&&r.list&&r.list.b?r.list.b:n}var uY={};function dY(e,t,n=""){if("number"!=typeof e&&"number"!=typeof t){pT.assert(e.length===t.length,(()=>n+` Shapes ${e} and ${t} must match`));for(let r=0;r<e.length;r++){let a=e[r],i=t[r];pT.assert(a<0||i<0||a===i,(()=>n+` Shapes ${e} and ${t} must match`))}}}function cY(e){return!("number"==typeof e||e.some((e=>e<0)))}function pY(e,t,n){let r=hY(e,n),a=!cY(r);if(a&&0===t.length)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${r}`);if(a&&t.forEach((e=>{r=hY(e.shape,r)})),!cY(r))throw new Error(`Non-fully-defined elementShape: ${r}`);return r}function hY(e,t){if("number"==typeof e)return t;if("number"==typeof t)return e;if(e.length!==t.length)throw new Error(`Incompatible ranks during merge: ${e} vs. ${t}`);let n=[];for(let r=0;r<e.length;++r){let a=e[r],i=t[r];if(a>=0&&i>=0&&a!==i)throw new Error(`Incompatible shape during merge: ${e} vs. ${t}`);n[r]=a>=0?a:i}return n}ok(uY,{OP_SCOPE_SUFFIX:()=>AE,abs:()=>o$,acos:()=>l$,acosh:()=>u$,add:()=>r$,addN:()=>d$,all:()=>c$,any:()=>p$,argMax:()=>h$,argMin:()=>f$,asin:()=>m$,asinh:()=>g$,atan:()=>b$,atan2:()=>y$,atanh:()=>v$,avgPool:()=>O$,avgPool3d:()=>P$,basicLSTMCell:()=>U$,batchNorm:()=>G$,batchNorm2d:()=>q$,batchNorm3d:()=>K$,batchNorm4d:()=>X$,batchToSpaceND:()=>j$,bincount:()=>Y$,bitwiseAnd:()=>J$,booleanMaskAsync:()=>zF,broadcastArgs:()=>Z$,broadcastTo:()=>Q$,buffer:()=>R_,cast:()=>D_,ceil:()=>eA,clipByValue:()=>nA,clone:()=>F_,complex:()=>DE,concat:()=>L$,concat1d:()=>rA,concat2d:()=>aA,concat3d:()=>iA,concat4d:()=>sA,conv1d:()=>lA,conv2d:()=>oA,conv2dTranspose:()=>dA,conv3d:()=>cA,conv3dTranspose:()=>hA,cos:()=>fA,cosh:()=>mA,cosineWindow:()=>qF,cumprod:()=>gA,cumsum:()=>bA,denseBincount:()=>yA,depthToSpace:()=>vA,depthwiseConv2d:()=>xA,diag:()=>wA,dilation2d:()=>kA,div:()=>i$,divNoNan:()=>$A,dot:()=>AA,dropout:()=>HF,einsum:()=>RA,elu:()=>DA,enclosingPowerOfTwo:()=>GF,ensureShape:()=>FA,equal:()=>TA,erf:()=>MA,euclideanNorm:()=>QA,exp:()=>eR,expandDims:()=>tR,expm1:()=>nR,eye:()=>aR,fft:()=>lF,fill:()=>tA,floor:()=>iR,floorDiv:()=>a$,fused:()=>XF,gather:()=>sR,gatherND:()=>jF,greater:()=>oR,greaterEqual:()=>lR,ifft:()=>uF,imag:()=>uR,image:()=>aO,inTopKAsync:()=>KF,irfft:()=>dF,isFinite:()=>dR,isInf:()=>cR,isNaN:()=>pR,leakyRelu:()=>hR,less:()=>fR,lessEqual:()=>mR,linalg:()=>iO,linspace:()=>gR,localResponseNormalization:()=>bR,log:()=>yR,log1p:()=>vR,logSigmoid:()=>_R,logSoftmax:()=>AR,logSumExp:()=>RR,logicalAnd:()=>DR,logicalNot:()=>FR,logicalOr:()=>MR,logicalXor:()=>OR,losses:()=>sO,lowerBound:()=>zR,matMul:()=>z$,max:()=>jA,maxPool:()=>BR,maxPool3d:()=>WR,maxPoolWithArgmax:()=>VR,maximum:()=>UR,mean:()=>jR,meshgrid:()=>qR,min:()=>HA,minimum:()=>KR,mirrorPad:()=>XR,mod:()=>YR,moments:()=>JR,movingAverage:()=>WF,mul:()=>s$,multiRNNCell:()=>ZR,multinomial:()=>QR,neg:()=>TR,norm:()=>ZA,notEqual:()=>eD,oneHot:()=>tD,ones:()=>GR,onesLike:()=>nD,op:()=>RE,outerProduct:()=>rD,pad:()=>aD,pad1d:()=>iD,pad2d:()=>sD,pad3d:()=>oD,pad4d:()=>lD,pool:()=>dD,pow:()=>GA,prelu:()=>cD,print:()=>M_,prod:()=>pD,raggedGather:()=>hD,raggedRange:()=>fD,raggedTensorToTensor:()=>mD,rand:()=>gD,randomGamma:()=>FD,randomNormal:()=>MD,randomStandardNormal:()=>OD,randomUniform:()=>PD,randomUniformInt:()=>LD,range:()=>zD,real:()=>BD,reciprocal:()=>WD,relu:()=>VD,relu6:()=>UD,reshape:()=>M$,reverse:()=>jD,reverse1d:()=>HD,reverse2d:()=>GD,reverse3d:()=>qD,reverse4d:()=>KD,rfft:()=>pF,round:()=>XD,rsqrt:()=>YD,scalar:()=>qA,scatterND:()=>VF,searchSorted:()=>LR,selu:()=>JD,separableConv2d:()=>ZD,setdiff1dAsync:()=>QD,sigmoid:()=>B$,sign:()=>eF,signal:()=>rO,sin:()=>tF,sinh:()=>nF,slice:()=>W$,slice1d:()=>rF,slice2d:()=>aF,slice3d:()=>iF,slice4d:()=>sF,softmax:()=>oF,softplus:()=>ER,spaceToBatchND:()=>uD,sparse:()=>oO,sparseToDense:()=>UF,spectral:()=>nO,split:()=>cF,sqrt:()=>KA,square:()=>XA,squaredDifference:()=>hF,squeeze:()=>fF,stack:()=>mF,step:()=>gF,stridedSlice:()=>bF,string:()=>lO,sub:()=>$R,sum:()=>YA,tan:()=>yF,tanh:()=>V$,tensor:()=>ME,tensor1d:()=>vF,tensor2d:()=>xF,tensor3d:()=>wF,tensor4d:()=>kF,tensor5d:()=>SF,tensor6d:()=>IF,tensorScatterUpdate:()=>_F,tile:()=>rR,topk:()=>$F,transpose:()=>BF,truncatedNormal:()=>AF,unique:()=>RF,unsortedSegmentSum:()=>DF,unstack:()=>FF,upperBound:()=>MF,variable:()=>OF,where:()=>EA,whereAsync:()=>LF,zeros:()=>HR,zerosLike:()=>_A});var fY=class{get id(){return this.idTensor.id}constructor(e,t,n,r=-1){this.tensors=e,this.elementShape=t,this.elementDtype=n,null!=e&&e.forEach((e=>{if(n!==e.dtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${e.dtype}`);dY(t,e.shape,"TensorList shape mismatch: "),G_(e)})),this.idTensor=qA(0),this.maxNumElements=r,G_(this.idTensor)}copy(){return new fY([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach((t=>{(null==e||!e.has(t.id))&&t.dispose()})),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,t,n=-1){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);if(-1!==n&&this.tensors.length!==n)throw new Error(`Operation expected a list with ${n} elements but got a list with ${this.tensors.length} elements.`);dY(e,this.elementShape,"TensorList shape mismatch: ");let r=pY(this.elementShape,this.tensors,e);return j_((()=>{let e=this.tensors.map((e=>M$(e,r)));return mF(e,0)}))}popBack(e,t){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);if(0===this.size())throw new Error("Trying to pop from an empty list.");let n=pY(this.elementShape,this.tensors,e),r=this.tensors.pop();return r.kept=!1,dY(r.shape,e,"TensorList shape mismatch: "),M$(r,n)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(dY(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");G_(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(-1!==this.maxNumElements&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);let t=new fY([],this.elementShape,this.elementDtype,this.maxNumElements);t.tensors.length=e;for(let n=0;n<Math.min(this.tensors.length,e);++n)t.tensors[n]=this.tensors[n];return t}getItem(e,t,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(null==this.tensors[e])throw new Error(`element at index ${e} is null.`);dY(this.tensors[e].shape,t,"TensorList shape mismatch: ");let r=pY(this.elementShape,this.tensors,t);return M$(this.tensors[e],r)}setItem(e,t){if(t.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${this.elementDtype}`);if(e<0||-1!==this.maxNumElements&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);dY(this.elementShape,t.shape,"TensorList shape mismatch: "),G_(t),null!=this.tensors[e]&&(this.tensors[e].kept=!1),this.tensors[e]=t}gather(e,t,n){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);dY(this.elementShape,n,"TensorList shape mismatch: "),e=e.slice(0,this.size());let r=pY(this.elementShape,this.tensors,n);return 0===e.length?ME([],[0].concat(r)):j_((()=>{let t=e.map((e=>M$(this.tensors[e],r)));return mF(t,0)}))}concat(e,t){if(e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);dY(this.elementShape,t,"TensorList shape mismatch: ");let n=pY(this.elementShape,this.tensors,t);return 0===this.size()?ME([],[0].concat(n)):j_((()=>{let e=this.tensors.map((e=>M$(e,n)));return L$(e,0)}))}},mY=async(e,t,n)=>{switch(e.op){case"If":case"StatelessIf":{let r=nX("thenBranch",e,t,n),a=nX("elseBranch",e,t,n),i=nX("cond",e,t,n),s=nX("args",e,t,n);return(await i.data())[0]?n.functionMap[r].executeFunctionAsync(s,n.tensorArrayMap,n.tensorListMap):n.functionMap[a].executeFunctionAsync(s,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{let r=nX("body",e,t,n),a=nX("cond",e,t,n),i=nX("args",e,t,n),s=await n.functionMap[a].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap),o=i.map((e=>e.id)),l=await s[0].data();s.forEach((e=>{!e.kept&&-1===o.indexOf(e.id)&&e.dispose()}));let u=i;for(;l[0];){let e=u;u=await n.functionMap[r].executeFunctionAsync(u,n.tensorArrayMap,n.tensorListMap);let t=u.map((e=>e.id));e.forEach((e=>{!e.kept&&-1===o.indexOf(e.id)&&-1===t.indexOf(e.id)&&e.dispose()}));let i=await n.functionMap[a].executeFunctionAsync(u,n.tensorArrayMap,n.tensorListMap);l=await i[0].data(),i.forEach((e=>{!e.kept&&-1===o.indexOf(e.id)&&-1===t.indexOf(e.id)&&e.dispose()}))}return u}case"LoopCond":return[uX(nX("pred",e,t,n))];case"Switch":{let r=nX("pred",e,t,n),a=nX("data",e,t,n);return a.kept||(a=uX(a)),(await r.data())[0]?[void 0,a]:[a,void 0]}case"Merge":{let r=e.inputNames.find((e=>void 0!==rX(e,t,n)));return r?[uX(rX(r,t,n))]:void 0}case"Enter":{let r=nX("frameName",e,t,n),a=nX("tensor",e,t,n);return n.enterFrame(r),[uX(a)]}case"Exit":{let r=nX("tensor",e,t,n);return n.exitFrame(),[uX(r)]}case"NextIteration":{let r=nX("tensor",e,t,n);return n.nextIteration(),[uX(r)]}case"TensorArrayV3":{let r=nX("size",e,t,n),a=nX("dtype",e,t,n),i=nX("elementShape",e,t,n),s=nX("dynamicSize",e,t,n),o=nX("clearAfterRead",e,t,n),l=nX("identicalElementShapes",e,t,n),u=nX("name",e,t,n),d=new class{constructor(e,t,n,r,a,i,s){this.name=e,this.dtype=t,this.maxSize=n,this.elementShape=r,this.identicalElementShapes=a,this.dynamicSize=i,this.clearAfterRead=s,this.tensors=[],this.closed_=!1,this.idTensor=qA(0),G_(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach((t=>{(null==e||!e.has(t.tensor.id))&&t.tensor.dispose()})),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);let t=this.tensors[e];if(t.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}readMany(e){return e.map((e=>this.read(e)))}write(e,t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);let n=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},\n          because the value dtype is ${t.dtype}, but TensorArray dtype is ${this.dtype}.`);if(0===this.size()&&(null==this.elementShape||0===this.elementShape.length)&&(this.elementShape=t.shape),dY(this.elementShape,t.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),n.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(n.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);n.tensor=t,G_(t),n.written=!0,this.tensors[e]=n}writeMany(e,t){if(e.length!==t.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${t.length}.`);e.forEach(((e,n)=>this.write(e,t[n])))}gather(e,t){if(t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${t}`);if(e)e=e.slice(0,this.size());else{e=[];for(let t=0;t<this.size();t++)e.push(t)}if(0===e.length)return ME([],[0].concat(this.elementShape));let n=this.readMany(e);return dY(this.elementShape,n[0].shape,"TensorArray shape mismatch: "),mF(n,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(0===this.size())return ME([],[0].concat(this.elementShape));let t=[];for(let r=0;r<this.size();r++)t.push(r);let n=this.readMany(t);return dY(this.elementShape,n[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${n[0].shape})`),L$(n,0)}scatter(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);let n=Math.max(...e);if(!this.dynamicSize&&n>=this.maxSize)throw new Error(`Max index must be < array size (${n}  vs. ${this.maxSize})`);this.writeMany(e,FF(t,0))}split(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);let n=0,r=e.map((e=>(n+=e,n)));if(n!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ${n}, and tensor's shape is: ${t.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);let a=0===n?0:t.size/n,i=[];j_((()=>{t=M$(t,[1,n,a]);for(let n=0;n<e.length;++n){let s=[0,0===n?0:r[n-1],0],o=[1,e[n],a];i[n]=M$(W$(t,s,o),this.elementShape)}return i}));let s=[];for(let o=0;o<e.length;o++)s[o]=o;this.writeMany(s,i)}}(u,a,r,i,l,s,o);return n.addTensorArray(d),[d.idTensor,qA(1)]}case"TensorArrayWriteV3":{let r=nX("tensorArrayId",e,t,n),a=nX("index",e,t,n),i=nX("tensor",e,t,n),s=n.getTensorArray(r.id);return s.write(a,i),[s.idTensor]}case"TensorArrayReadV3":{let r=nX("tensorArrayId",e,t,n),a=nX("index",e,t,n);return[n.getTensorArray(r.id).read(a)]}case"TensorArrayGatherV3":{let r=nX("tensorArrayId",e,t,n),a=nX("indices",e,t,n),i=nX("dtype",e,t,n);return[n.getTensorArray(r.id).gather(a,i)]}case"TensorArrayScatterV3":{let r=nX("tensorArrayId",e,t,n),a=nX("indices",e,t,n),i=nX("tensor",e,t,n),s=n.getTensorArray(r.id);return s.scatter(a,i),[s.idTensor]}case"TensorArrayConcatV3":{let r=nX("tensorArrayId",e,t,n),a=n.getTensorArray(r.id),i=nX("dtype",e,t,n);return[a.concat(i)]}case"TensorArraySplitV3":{let r=nX("tensorArrayId",e,t,n),a=nX("tensor",e,t,n),i=nX("lengths",e,t,n),s=n.getTensorArray(r.id);return s.split(i,a),[s.idTensor]}case"TensorArraySizeV3":{let r=nX("tensorArrayId",e,t,n);return[qA(n.getTensorArray(r.id).size(),"int32")]}case"TensorArrayCloseV3":{let r=nX("tensorArrayId",e,t,n),a=n.getTensorArray(r.id);return a.clearAndClose(),[a.idTensor]}case"TensorListSetItem":{let r=nX("tensorListId",e,t,n),a=nX("index",e,t,n),i=nX("tensor",e,t,n),s=n.getTensorList(r.id);return s.setItem(a,i),[s.idTensor]}case"TensorListGetItem":{let r=nX("tensorListId",e,t,n),a=nX("index",e,t,n),i=nX("elementShape",e,t,n),s=nX("elementDType",e,t,n);return[n.getTensorList(r.id).getItem(a,i,s)]}case"TensorListScatterV2":case"TensorListScatter":{let r=nX("indices",e,t,n),a=function(e,t,n,r){if(t.length!==e.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${t.length} vs. ${e.shape[0]}`);let a=Math.max(...t);if(null!=r&&-1!==r&&a>=r)throw new Error(`Max index must be < array size (${a}  vs. ${r})`);let i=new fY([],n,e.dtype,r),s=FF(e,0);return t.forEach(((e,t)=>{i.setItem(e,s[t])})),i}(nX("tensor",e,t,n),r,nX("elementShape",e,t,n),nX("numElements",e,t,n));return n.addTensorList(a),[a.idTensor]}case"TensorListReserve":case"EmptyTensorList":{let r,a=nX("elementShape",e,t,n),i=nX("elementDType",e,t,n);r="TensorListReserve"===e.op?"numElements":"maxNumElements";let s=nX(r,e,t,n),o=function(e,t,n,r){return new fY([],e,t,r)}(a,i,0,"TensorListReserve"===e.op?-1:s);return n.addTensorList(o),[o.idTensor]}case"TensorListGather":{let r=nX("tensorListId",e,t,n),a=nX("indices",e,t,n),i=nX("elementShape",e,t,n),s=nX("elementDType",e,t,n);return[n.getTensorList(r.id).gather(a,s,i)]}case"TensorListStack":{let r=nX("tensorListId",e,t,n),a=nX("elementShape",e,t,n),i=nX("elementDType",e,t,n),s=nX("numElements",e,t,n);return[n.getTensorList(r.id).stack(a,i,s)]}case"TensorListFromTensor":{let r=function(e,t,n){let r=e.dtype;if(e.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${e.shape}`);if(e.dtype!==n)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${n}`);dY(e.shape.slice(1),t,"TensorList shape mismatch: ");let a=FF(e);return new fY(a,t,r)}(nX("tensor",e,t,n),nX("elementShape",e,t,n),nX("elementDType",e,t,n));return n.addTensorList(r),[r.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{let r=nX("tensorListId",e,t,n),a=n.getTensorList(r.id),i=nX("dtype",e,t,n),s=nX("elementShape",e,t,n);return[a.concat(i,s)]}case"TensorListPushBack":{let r=nX("tensorListId",e,t,n),a=nX("tensor",e,t,n),i=n.getTensorList(r.id);return i.pushBack(a),[i.idTensor]}case"TensorListPopBack":{let r=nX("tensorListId",e,t,n),a=nX("elementShape",e,t,n),i=nX("elementDType",e,t,n);return[n.getTensorList(r.id).popBack(a,i)]}case"TensorListSplit":{let r=nX("tensor",e,t,n),a=nX("elementShape",e,t,n),i=function(e,t,n){let r=0,a=t.map((e=>(r+=e,r)));if(r!==e.shape[0])throw new Error(`Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ${r}, and tensor's shape is: ${e.shape}`);let i=hY(e.shape.slice(1),n),s=0===r?0:e.size/r,o=j_((()=>{let n=[];e=M$(e,[1,r,s]);for(let r=0;r<t.length;++r){let o=[0,0===r?0:a[r-1],0],l=[1,t[r],s];n[r]=M$(W$(e,o,l),i)}return e.dispose(),n})),l=new fY([],n,e.dtype,t.length);for(let u=0;u<o.length;u++)l.setItem(u,o[u]);return l}(r,nX("lengths",e,t,n),a);return n.addTensorList(i),[i.idTensor]}case"TensorListLength":{let r=nX("tensorListId",e,t,n);return[qA(n.getTensorList(r.id).size(),"int32")]}case"TensorListResize":{let r=nX("tensorListId",e,t,n),a=nX("size",e,t,n),i=n.getTensorList(r.id).resize(a);return n.addTensorList(i),[i.idTensor]}default:throw TypeError(`Node type ${e.op} is not implemented`)}};function gY(e,t,n){let[r,a]=nX("fusedOps",e,t,n),i="biasadd"===r,s=!i,o="prelu"===a,l="fusedbatchnorm"===r,u=nX("numArgs",e,t,n);if(i){if(o&&2!==u)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&i&&1!==u)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");let d=nX("strides",e,t,n),c=lX(e,t,n),p=nX("dataFormat",e,t,n).toUpperCase(),h=nX("dilations",e,t,n),[f,m]=nX("args",e,t,n);return s&&(m=f,f=void 0),{stride:d,pad:c,dataFormat:p,dilations:h,biasArg:f,preluArg:m,activationFunc:a,leakyreluAlpha:nX("leakyreluAlpha",e,t,n)}}function bY(e,t,n){return{boxes:nX("boxes",e,t,n),scores:nX("scores",e,t,n),maxOutputSize:nX("maxOutputSize",e,t,n),iouThreshold:nX("iouThreshold",e,t,n),scoreThreshold:nX("scoreThreshold",e,t,n),softNmsSigma:nX("softNmsSigma",e,t,n)}}var yY=async(e,t,n,r)=>{switch(e.op){case"HashTable":case"HashTableV2":{let a=r.getHashTableHandleByName(e.name);if(null!=a)return[a];{let a=nX("keyDType",e,t,n),i=nX("valueDType",e,t,n),s=new class{get id(){return this.handle.id}constructor(e,t){this.keyDType=e,this.valueDType=t,this.handle=qA(0),this.tensorMap=new Map,G_(this.handle)}clearAndClose(){this.tensorMap.forEach((e=>e.dispose())),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return qA(this.size(),"int32")}async import(e,t){this.checkKeyAndValueTensor(e,t);let n=await e.data();return this.tensorMap.forEach((e=>e.dispose())),this.tensorMap.clear(),j_((()=>{let e=FF(t),r=n.length,a=e.length;pT.assert(r===a,(()=>`The number of elements doesn't match, keys has ${r} elements, the values has ${a} elements.`));for(let t=0;t<r;t++){let r=n[t],a=e[t];G_(a),this.tensorMap.set(r,a)}return this.handle}))}async find(e,t){this.checkKeyAndValueTensor(e,t);let n=await e.data();return j_((()=>{let e=[];for(let r=0;r<n.length;r++){let a=n[r],i=this.findWithDefault(a,t);e.push(i)}return mF(e)}))}findWithDefault(e,t){let n=this.tensorMap.get(e);return null!=n?n:t}checkKeyAndValueTensor(e,t){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(t.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${t.dtype}`)}}(a,i);return r.addHashTable(e.name,s),[s.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{let a=nX("tableHandle",e,t,n,r),i=nX("keys",e,t,n),s=nX("values",e,t,n);return[await r.getHashTableById(a.id).import(i,s)]}case"LookupTableFind":case"LookupTableFindV2":{let a=nX("tableHandle",e,t,n,r),i=nX("keys",e,t,n),s=nX("defaultValue",e,t,n);return[await r.getHashTableById(a.id).find(i,s)]}case"LookupTableSize":case"LookupTableSizeV2":{let a=nX("tableHandle",e,t,n,r);return[r.getHashTableById(a.id).tensorSize()]}default:throw TypeError(`Node type ${e.op} is not implemented`)}};function vY(e,t,n,r,a=j_){let i=((e,t,n)=>{switch(e.category){case"arithmetic":return a((()=>((e,t,n,r=uY)=>{switch(e.op){case"BiasAdd":case"AddV2":case"Add":return[r.add(nX("a",e,t,n),nX("b",e,t,n))];case"AddN":return[r.addN(nX("tensors",e,t,n))];case"FloorMod":case"Mod":return[r.mod(nX("a",e,t,n),nX("b",e,t,n))];case"Mul":return[r.mul(nX("a",e,t,n),nX("b",e,t,n))];case"RealDiv":case"Div":return[r.div(nX("a",e,t,n),nX("b",e,t,n))];case"DivNoNan":return[r.divNoNan(nX("a",e,t,n),nX("b",e,t,n))];case"FloorDiv":return[r.floorDiv(nX("a",e,t,n),nX("b",e,t,n))];case"Sub":return[r.sub(nX("a",e,t,n),nX("b",e,t,n))];case"Minimum":return[r.minimum(nX("a",e,t,n),nX("b",e,t,n))];case"Maximum":return[r.maximum(nX("a",e,t,n),nX("b",e,t,n))];case"Pow":return[r.pow(nX("a",e,t,n),nX("b",e,t,n))];case"SquaredDifference":return[r.squaredDifference(nX("a",e,t,n),nX("b",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"basic_math":return a((()=>((e,t,n,r=uY)=>{switch(e.op){case"Abs":case"ComplexAbs":return[r.abs(nX("x",e,t,n))];case"Acos":return[r.acos(nX("x",e,t,n))];case"Acosh":return[r.acosh(nX("x",e,t,n))];case"Asin":return[r.asin(nX("x",e,t,n))];case"Asinh":return[r.asinh(nX("x",e,t,n))];case"Atan":return[r.atan(nX("x",e,t,n))];case"Atan2":return[r.atan2(nX("x",e,t,n),nX("y",e,t,n))];case"Atanh":return[r.atanh(nX("x",e,t,n))];case"Ceil":return[r.ceil(nX("x",e,t,n))];case"Complex":return[r.complex(nX("real",e,t,n),nX("imag",e,t,n))];case"Cos":return[r.cos(nX("x",e,t,n))];case"Cosh":return[r.cosh(nX("x",e,t,n))];case"Elu":return[r.elu(nX("x",e,t,n))];case"Erf":return[r.erf(nX("x",e,t,n))];case"Exp":return[r.exp(nX("x",e,t,n))];case"Expm1":return[r.expm1(nX("x",e,t,n))];case"Floor":return[r.floor(nX("x",e,t,n))];case"Log":return[r.log(nX("x",e,t,n))];case"Log1p":return[r.log1p(nX("x",e,t,n))];case"Imag":return[r.imag(nX("x",e,t,n))];case"Neg":return[r.neg(nX("x",e,t,n))];case"Reciprocal":return[r.reciprocal(nX("x",e,t,n))];case"Real":return[r.real(nX("x",e,t,n))];case"Relu":return[r.relu(nX("x",e,t,n))];case"Round":return[r.round(nX("x",e,t,n))];case"Selu":return[r.selu(nX("x",e,t,n))];case"Sigmoid":return[r.sigmoid(nX("x",e,t,n))];case"Sin":return[r.sin(nX("x",e,t,n))];case"Sign":return[r.sign(nX("x",e,t,n))];case"Sinh":return[r.sinh(nX("x",e,t,n))];case"Softplus":return[r.softplus(nX("x",e,t,n))];case"Sqrt":return[r.sqrt(nX("x",e,t,n))];case"Square":return[r.square(nX("x",e,t,n))];case"Tanh":return[r.tanh(nX("x",e,t,n))];case"Tan":return[r.tan(nX("x",e,t,n))];case"ClipByValue":return[r.clipByValue(nX("x",e,t,n),nX("clipValueMin",e,t,n),nX("clipValueMax",e,t,n))];case"Relu6":return[r.relu6(nX("x",e,t,n))];case"Rsqrt":return[r.rsqrt(rX(e.inputNames[0],t,n))];case"LeakyRelu":return[r.leakyRelu(nX("x",e,t,n),nX("alpha",e,t,n))];case"Prelu":return[r.prelu(nX("x",e,t,n),nX("alpha",e,t,n))];case"IsNan":return[r.isNaN(rX(e.inputNames[0],t,n))];case"IsInf":return[r.isInf(rX(e.inputNames[0],t,n))];case"IsFinite":return[r.isFinite(rX(e.inputNames[0],t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"control":return mY(e,t,n);case"convolution":return a((()=>((e,t,n,r=uY)=>{switch(e.op){case"Conv1D":{let a=nX("stride",e,t,n),i=nX("pad",e,t,n),s=nX("dataFormat",e,t,n).toUpperCase(),o=nX("dilation",e,t,n);return[r.conv1d(nX("x",e,t,n),nX("filter",e,t,n),a,i,s,o)]}case"Conv2D":{let a=nX("strides",e,t,n),i=lX(e,t,n),s=nX("dataFormat",e,t,n).toUpperCase(),o=nX("dilations",e,t,n);return[r.conv2d(nX("x",e,t,n),nX("filter",e,t,n),[a[1],a[2]],i,s,[o[1],o[2]])]}case"_FusedConv2D":{let{stride:a,pad:i,dataFormat:s,dilations:o,biasArg:l,preluArg:u,activationFunc:d,leakyreluAlpha:c}=gY(e,t,n);return[r.fused.conv2d({x:nX("x",e,t,n),filter:nX("filter",e,t,n),strides:[a[1],a[2]],pad:i,dataFormat:s,dilations:[o[1],o[2]],bias:l,activation:d,preluActivationWeights:u,leakyreluAlpha:c})]}case"FusedDepthwiseConv2dNative":{let{stride:a,pad:i,dataFormat:s,dilations:o,biasArg:l,preluArg:u,activationFunc:d,leakyreluAlpha:c}=gY(e,t,n);return[r.fused.depthwiseConv2d({x:nX("x",e,t,n),filter:nX("filter",e,t,n),strides:[a[1],a[2]],pad:i,dataFormat:s,dilations:[o[1],o[2]],bias:l,activation:d,preluActivationWeights:u,leakyreluAlpha:c})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{let a=nX("outputShape",e,t,n),i=nX("strides",e,t,n),s=lX(e,t,n);return[r.conv2dTranspose(nX("x",e,t,n),nX("filter",e,t,n),a,[i[1],i[2]],s)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{let a=nX("strides",e,t,n),i=lX(e,t,n),s=nX("dilations",e,t,n),o=nX("dataFormat",e,t,n).toUpperCase();return[r.depthwiseConv2d(nX("input",e,t,n),nX("filter",e,t,n),[a[1],a[2]],i,o,[s[1],s[2]])]}case"Conv3D":{let a=nX("strides",e,t,n),i=nX("pad",e,t,n),s=nX("dataFormat",e,t,n).toUpperCase(),o=nX("dilations",e,t,n);return[r.conv3d(nX("x",e,t,n),nX("filter",e,t,n),[a[1],a[2],a[3]],i,s,[o[1],o[2],o[3]])]}case"AvgPool":{let a=nX("strides",e,t,n),i=nX("pad",e,t,n),s=nX("kernelSize",e,t,n);return[r.avgPool(nX("x",e,t,n),[s[1],s[2]],[a[1],a[2]],i)]}case"MaxPool":{let a=nX("strides",e,t,n),i=nX("pad",e,t,n),s=nX("kernelSize",e,t,n);return[r.maxPool(nX("x",e,t,n),[s[1],s[2]],[a[1],a[2]],i)]}case"MaxPoolWithArgmax":{let a=nX("strides",e,t,n),i=nX("pad",e,t,n),s=nX("kernelSize",e,t,n),o=nX("includeBatchInIndex",e,t,n),{result:l,indexes:u}=r.maxPoolWithArgmax(nX("x",e,t,n),[s[1],s[2]],[a[1],a[2]],i,o);return[l,u]}case"AvgPool3D":{let a=nX("strides",e,t,n),i=nX("pad",e,t,n),s=nX("kernelSize",e,t,n);return[r.avgPool3d(nX("x",e,t,n),[s[1],s[2],s[3]],[a[1],a[2],a[3]],i)]}case"MaxPool3D":{let a=nX("strides",e,t,n),i=nX("pad",e,t,n),s=nX("kernelSize",e,t,n);return[r.maxPool3d(nX("x",e,t,n),[s[1],s[2],s[3]],[a[1],a[2],a[3]],i)]}case"Dilation2D":{let a=nX("strides",e,t,n),i=nX("pad",e,t,n),s=nX("dilations",e,t,n),o=a[1],l=a[2],u=s[1],d=s[2];return[r.dilation2d(nX("x",e,t,n),nX("filter",e,t,n),[o,l],i,[u,d],"NHWC")]}default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"creation":return a((()=>((e,t,n,r=uY)=>{switch(e.op){case"Fill":{let a=nX("shape",e,t,n),i=nX("dtype",e,t,n),s=nX("value",e,t,n);return[r.fill(a,s,i)]}case"LinSpace":{let a=nX("start",e,t,n),i=nX("stop",e,t,n),s=nX("num",e,t,n);return[r.linspace(a,i,s)]}case"Multinomial":{let a=nX("logits",e,t,n),i=nX("numSamples",e,t,n),s=nX("seed",e,t,n);return[r.multinomial(a,i,s)]}case"OneHot":{let a=nX("indices",e,t,n),i=nX("depth",e,t,n),s=nX("onValue",e,t,n),o=nX("offValue",e,t,n),l=nX("dtype",e,t,n);return[r.oneHot(a,i,s,o,l)]}case"Ones":return[r.ones(nX("shape",e,t,n),nX("dtype",e,t,n))];case"OnesLike":return[r.onesLike(nX("x",e,t,n))];case"RandomStandardNormal":return[r.randomStandardNormal(nX("shape",e,t,n),nX("dtype",e,t,n),nX("seed",e,t,n))];case"RandomUniform":return[r.randomUniform(nX("shape",e,t,n),nX("minval",e,t,n),nX("maxval",e,t,n),nX("dtype",e,t,n))];case"RandomUniformInt":return[r.randomUniformInt(nX("shape",e,t,n),nX("minval",e,t,n),nX("maxval",e,t,n),nX("seed",e,t,n))];case"Range":{let a=nX("start",e,t,n),i=nX("stop",e,t,n),s=nX("step",e,t,n);return[r.range(a,i,s,nX("dtype",e,t,n))]}case"TruncatedNormal":{let a=nX("shape",e,t,n),i=nX("mean",e,t,n),s=nX("stdDev",e,t,n),o=nX("seed",e,t,n);return[r.truncatedNormal(a,i,s,nX("dtype",e,t,n),o)]}case"Zeros":return[r.zeros(nX("shape",e,t,n),nX("dtype",e,t,n))];case"ZerosLike":return[r.zerosLike(nX("x",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"dynamic":return(async(e,t,n,r,a=uY)=>{switch(e.op){case"NonMaxSuppressionV5":{let{boxes:r,scores:i,maxOutputSize:s,iouThreshold:o,scoreThreshold:l,softNmsSigma:u}=bY(e,t,n),d=await a.image.nonMaxSuppressionWithScoreAsync(r,i,s,o,l,u);return[d.selectedIndices,d.selectedScores]}case"NonMaxSuppressionV4":{let{boxes:r,scores:i,maxOutputSize:s,iouThreshold:o,scoreThreshold:l}=bY(e,t,n),u=nX("padToMaxOutputSize",e,t,n),d=await a.image.nonMaxSuppressionPaddedAsync(r,i,s,o,l,u);return[d.selectedIndices,d.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{let{boxes:r,scores:i,maxOutputSize:s,iouThreshold:o,scoreThreshold:l}=bY(e,t,n);return[await a.image.nonMaxSuppressionAsync(r,i,s,o,l)]}case"Where":{let r=a.cast(nX("condition",e,t,n),"bool"),i=[await a.whereAsync(r)];return r.dispose(),i}case"ListDiff":return a.setdiff1dAsync(nX("x",e,t,n),nX("y",e,t,n));default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n);case"evaluation":return a((()=>((e,t,n,r=uY)=>{switch(e.op){case"LowerBound":{let a=nX("sortedSequence",e,t,n),i=nX("values",e,t,n);return[r.lowerBound(a,i)]}case"TopKV2":{let a=nX("x",e,t,n),i=nX("k",e,t,n),s=nX("sorted",e,t,n),o=r.topk(a,i,s);return[o.values,o.indices]}case"UpperBound":{let a=nX("sortedSequence",e,t,n),i=nX("values",e,t,n);return[r.upperBound(a,i)]}case"Unique":{let a=nX("x",e,t,n),i=r.unique(a);return[i.values,i.indices]}case"UniqueV2":{let a=nX("x",e,t,n),i=nX("axis",e,t,n),s=r.unique(a,i);return[s.values,s.indices]}default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"image":return a((()=>((e,t,n,r=uY)=>{switch(e.op){case"ResizeBilinear":{let a=nX("images",e,t,n),i=nX("size",e,t,n),s=nX("alignCorners",e,t,n),o=nX("halfPixelCenters",e,t,n);return[r.image.resizeBilinear(a,[i[0],i[1]],s,o)]}case"ResizeNearestNeighbor":{let a=nX("images",e,t,n),i=nX("size",e,t,n),s=nX("alignCorners",e,t,n),o=nX("halfPixelCenters",e,t,n);return[r.image.resizeNearestNeighbor(a,[i[0],i[1]],s,o)]}case"CropAndResize":{let a=nX("image",e,t,n),i=nX("boxes",e,t,n),s=nX("boxInd",e,t,n),o=nX("cropSize",e,t,n),l=nX("method",e,t,n),u=nX("extrapolationValue",e,t,n);return[r.image.cropAndResize(a,i,s,o,l,u)]}case"ImageProjectiveTransformV3":{let a=nX("images",e,t,n),i=nX("transforms",e,t,n),s=nX("outputShape",e,t,n),o=nX("fillValue",e,t,n),l=nX("interpolation",e,t,n),u=nX("fillMode",e,t,n);return[r.image.transform(a,i,l.toLowerCase(),u.toLowerCase(),o,s)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"graph":return a((()=>((e,t,n,r=uY)=>{switch(e.op){case"Const":return t[e.name];case"PlaceholderWithDefault":let a=nX("default",e,t,n);return[rX(e.name,t,n)||a];case"Placeholder":return[rX(e.name,t,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":case"Snapshot":return[uX(nX("x",e,t,n))];case"IdentityN":return nX("x",e,t,n).map((e=>uX(e)));case"Shape":return[r.tensor1d(nX("x",e,t,n).shape,"int32")];case"ShapeN":return nX("x",e,t,n).map((e=>r.tensor1d(e.shape)));case"Size":return[r.scalar(nX("x",e,t,n).size,"int32")];case"Rank":return[r.scalar(nX("x",e,t,n).rank,"int32")];case"NoOp":return[r.scalar(1)];case"Print":let i=nX("x",e,t,n),s=nX("data",e,t,n),o=nX("message",e,t,n),l=nX("summarize",e,t,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(o);for(let e=0;e<s.length;e++)console.log(Array.prototype.slice.call(s[e].dataSync()).slice(0,l));return[i];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"logical":return a((()=>((e,t,n,r=uY)=>{switch(e.op){case"Equal":return[r.equal(nX("a",e,t,n),nX("b",e,t,n))];case"NotEqual":return[r.notEqual(nX("a",e,t,n),nX("b",e,t,n))];case"Greater":return[r.greater(nX("a",e,t,n),nX("b",e,t,n))];case"GreaterEqual":return[r.greaterEqual(nX("a",e,t,n),nX("b",e,t,n))];case"Less":return[r.less(nX("a",e,t,n),nX("b",e,t,n))];case"LessEqual":return[r.lessEqual(nX("a",e,t,n),nX("b",e,t,n))];case"LogicalAnd":return[r.logicalAnd(nX("a",e,t,n),nX("b",e,t,n))];case"LogicalNot":return[r.logicalNot(nX("a",e,t,n))];case"LogicalOr":return[r.logicalOr(nX("a",e,t,n),nX("b",e,t,n))];case"Select":case"SelectV2":return[r.where(nX("condition",e,t,n),nX("a",e,t,n),nX("b",e,t,n))];case"BitwiseAnd":return[r.bitwiseAnd(nX("a",e,t,n),nX("b",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"matrices":return a((()=>((e,t,n,r=uY)=>{switch(e.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[r.matMul(nX("a",e,t,n),nX("b",e,t,n),nX("transposeA",e,t,n),nX("transposeB",e,t,n))];case"Einsum":return[r.einsum(nX("equation",e,t,n),...nX("tensors",e,t,n))];case"Transpose":return[r.transpose(nX("x",e,t,n),nX("perm",e,t,n))];case"_FusedMatMul":let[a,i]=nX("fusedOps",e,t,n),s="biasadd"===a,o="prelu"===i,l=nX("numArgs",e,t,n),u=nX("leakyreluAlpha",e,t,n);if(s){if(o&&2!==l)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&1!==l)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}let[d,c]=nX("args",e,t,n);return[r.fused.matMul({a:nX("a",e,t,n),b:nX("b",e,t,n),transposeA:nX("transposeA",e,t,n),transposeB:nX("transposeB",e,t,n),bias:d,activation:i,preluActivationWeights:c,leakyreluAlpha:u})];case"MatrixBandPart":return[r.linalg.bandPart(nX("a",e,t,n),nX("numLower",e,t,n),nX("numUpper",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"normalization":return a((()=>((e,t,n,r=uY)=>{switch(e.op){case"EuclideanNorm":return[r.euclideanNorm(nX("x",e,t,n),nX("axis",e,t,n),nX("keepDims",e,t,n))];case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[r.batchNorm(nX("x",e,t,n),nX("mean",e,t,n),nX("variance",e,t,n),nX("offset",e,t,n),nX("scale",e,t,n),nX("epsilon",e,t,n))];case"LRN":return[r.localResponseNormalization(nX("x",e,t,n),nX("radius",e,t,n),nX("bias",e,t,n),nX("alpha",e,t,n),nX("beta",e,t,n))];case"Softmax":return[r.softmax(nX("x",e,t,n))];case"LogSoftmax":return[r.logSoftmax(nX("x",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"ragged":return a((()=>((e,t,n,r=uY)=>{switch(e.op){case"RaggedGather":{let{outputNestedSplits:a,outputDenseValues:i}=r.raggedGather(nX("paramsNestedSplits",e,t,n),nX("paramsDenseValues",e,t,n),nX("indices",e,t,n),nX("outputRaggedRank",e,t,n));return a.concat(i)}case"RaggedRange":{let{rtNestedSplits:a,rtDenseValues:i}=r.raggedRange(nX("starts",e,t,n),nX("limits",e,t,n),nX("splits",e,t,n));return[a,i]}case"RaggedTensorToTensor":return[r.raggedTensorToTensor(nX("shape",e,t,n),nX("values",e,t,n),nX("defaultValue",e,t,n),nX("rowPartitionTensors",e,t,n),nX("rowPartitionTypes",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"reduction":return a((()=>((e,t,n,r=uY)=>{switch(e.op){case"Max":{let a=nX("axis",e,t,n),i=nX("keepDims",e,t,n);return[r.max(nX("x",e,t,n),a,i)]}case"Mean":{let a=nX("axis",e,t,n),i=nX("keepDims",e,t,n);return[r.mean(nX("x",e,t,n),a,i)]}case"Min":{let a=nX("axis",e,t,n),i=nX("keepDims",e,t,n);return[r.min(nX("x",e,t,n),a,i)]}case"Sum":{let a=nX("axis",e,t,n),i=nX("keepDims",e,t,n);return[r.sum(nX("x",e,t,n),a,i)]}case"All":{let a=nX("axis",e,t,n),i=nX("keepDims",e,t,n);return[r.all(nX("x",e,t,n),a,i)]}case"Any":{let a=nX("axis",e,t,n),i=nX("keepDims",e,t,n);return[r.any(nX("x",e,t,n),a,i)]}case"ArgMax":{let a=nX("axis",e,t,n);return[r.argMax(nX("x",e,t,n),a)]}case"ArgMin":{let a=nX("axis",e,t,n);return[r.argMin(nX("x",e,t,n),a)]}case"Prod":{let a=nX("axis",e,t,n),i=nX("keepDims",e,t,n);return[r.prod(nX("x",e,t,n),a,i)]}case"Cumprod":{let a=nX("axis",e,t,n),i=nX("exclusive",e,t,n),s=nX("reverse",e,t,n);return[r.cumprod(nX("x",e,t,n),a,i,s)]}case"Cumsum":{let a=nX("axis",e,t,n),i=nX("exclusive",e,t,n),s=nX("reverse",e,t,n);return[r.cumsum(nX("x",e,t,n),a,i,s)]}case"Bincount":let a=nX("x",e,t,n),i=nX("weights",e,t,n),s=nX("size",e,t,n);return[r.bincount(a,i,s)];case"DenseBincount":{let a=nX("x",e,t,n),i=nX("weights",e,t,n),s=nX("size",e,t,n),o=nX("binaryOutput",e,t,n);return[r.denseBincount(a,i,s,o)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"slice_join":return a((()=>((e,t,n,r=uY)=>{switch(e.op){case"ConcatV2":case"Concat":{let a=nX("n",e,t,n),i=nX("axis",e,t,n),s=nX("tensors",e,t,n);return s=s.slice(0,a),[r.concat(s,i)]}case"Gather":{let a=nX("x",e,t,n),i=nX("indices",e,t,n);return[r.gather(a,r.cast(i,"int32"),0)]}case"GatherV2":{let a=nX("axis",e,t,n),i=nX("batchDims",e,t,n),s=nX("x",e,t,n),o=nX("indices",e,t,n);return[r.gather(s,r.cast(o,"int32"),a,i)]}case"Reverse":{let a=nX("dims",e,t,n),i=[];for(let e=0;e<a.length;e++)a[e]&&i.push(e);let s=nX("x",e,t,n);return[r.reverse(s,i)]}case"ReverseV2":{let a=nX("axis",e,t,n),i=nX("x",e,t,n);return[r.reverse(i,a)]}case"Slice":{let a=nX("begin",e,t,n),i=nX("size",e,t,n);return[r.slice(nX("x",e,t,n),a,i)]}case"StridedSlice":{let a=nX("begin",e,t,n),i=nX("end",e,t,n),s=nX("strides",e,t,n),o=nX("beginMask",e,t,n),l=nX("endMask",e,t,n),u=nX("ellipsisMask",e,t,n),d=nX("newAxisMask",e,t,n),c=nX("shrinkAxisMask",e,t,n),p=nX("x",e,t,n);return[r.stridedSlice(p,a,i,s,o,l,u,d,c)]}case"Pack":return j_((()=>{let a=nX("axis",e,t,n),i=nX("tensors",e,t,n),s=i[0].shape,o=r.squeeze(i[0]).shape,l=i.map((e=>{let t=pT.arraysEqual(e.shape,s);if(!t&&!pT.arraysEqual(r.squeeze(e).shape,o))throw new Error("the input tensors shape does not match");return t?e:r.reshape(e,s)}));return[r.stack(l,a)]}));case"Unpack":{let a=nX("axis",e,t,n),i=nX("tensor",e,t,n);return r.unstack(i,a)}case"Tile":{let a=nX("reps",e,t,n);return[r.tile(nX("x",e,t,n),a)]}case"Split":case"SplitV":{let a=nX("axis",e,t,n),i=nX("numOrSizeSplits",e,t,n),s=nX("x",e,t,n);return r.split(s,i,a)}case"ScatterNd":{let a=nX("indices",e,t,n),i=nX("values",e,t,n),s=nX("shape",e,t,n);return[r.scatterND(a,i,s)]}case"GatherNd":{let a=nX("x",e,t,n),i=nX("indices",e,t,n);return[r.gatherND(a,i)]}case"SparseToDense":{let a=nX("sparseIndices",e,t,n),i=nX("outputShape",e,t,n),s=nX("sparseValues",e,t,n),o=nX("defaultValue",e,t,n);return[r.sparseToDense(a,s,i,s.dtype===o.dtype?o:r.cast(o,s.dtype))]}case"TensorScatterUpdate":{let a=nX("indices",e,t,n),i=nX("values",e,t,n),s=nX("tensor",e,t,n);return[r.tensorScatterUpdate(s,a,i)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"sparse":return a((()=>((e,t,n,r=uY)=>{switch(e.op){case"SparseFillEmptyRows":{let{outputIndices:a,outputValues:i,emptyRowIndicator:s,reverseIndexMap:o}=r.sparse.sparseFillEmptyRows(nX("indices",e,t,n),nX("values",e,t,n),nX("denseShape",e,t,n),nX("defaultValue",e,t,n));return[a,i,s,o]}case"SparseReshape":{let{outputIndices:a,outputShape:i}=r.sparse.sparseReshape(nX("inputIndices",e,t,n),nX("inputShape",e,t,n),nX("newShape",e,t,n));return[a,i]}case"SparseSegmentMean":return[r.sparse.sparseSegmentMean(nX("data",e,t,n),nX("indices",e,t,n),nX("segmentIds",e,t,n))];case"SparseSegmentSum":return[r.sparse.sparseSegmentSum(nX("data",e,t,n),nX("indices",e,t,n),nX("segmentIds",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"spectral":return a((()=>((e,t,n,r=uY)=>{switch(e.op){case"FFT":return[r.fft(nX("x",e,t,n))];case"IFFT":return[r.ifft(nX("x",e,t,n))];case"RFFT":return[r.rfft(nX("x",e,t,n))];case"IRFFT":return[r.irfft(nX("x",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"string":return a((()=>((e,t,n,r=uY)=>{switch(e.op){case"StaticRegexReplace":return[r.string.staticRegexReplace(nX("input",e,t,n),nX("pattern",e,t,n),nX("rewrite",e,t,n),nX("replaceGlobal",e,t,n))];case"StringNGrams":{let{nGrams:a,nGramsSplits:i}=r.string.stringNGrams(nX("data",e,t,n),nX("dataSplits",e,t,n),nX("separator",e,t,n),nX("nGramWidths",e,t,n),nX("leftPad",e,t,n),nX("rightPad",e,t,n),nX("padWidth",e,t,n),nX("preserveShortSequences",e,t,n));return[a,i]}case"StringSplit":{let{indices:a,values:i,shape:s}=r.string.stringSplit(nX("input",e,t,n),nX("delimiter",e,t,n),nX("skipEmpty",e,t,n));return[a,i,s]}case"StringToHashBucketFast":return[r.string.stringToHashBucketFast(nX("input",e,t,n),nX("numBuckets",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"transformation":return a((()=>((e,t,n,r=uY)=>{switch(e.op){case"Cast":return[r.cast(nX("x",e,t,n),nX("dtype",e,t,n))];case"ExpandDims":{let a=nX("axis",e,t,n);return[r.expandDims(nX("x",e,t,n),a)]}case"Squeeze":{let a=nX("axis",e,t,n);return[r.squeeze(nX("x",e,t,n),a)]}case"Reshape":return[r.reshape(nX("x",e,t,n),nX("shape",e,t,n))];case"EnsureShape":return[r.ensureShape(nX("x",e,t,n),nX("shape",e,t,n))];case"MirrorPad":return[r.mirrorPad(nX("x",e,t,n),nX("padding",e,t,n),nX("mode",e,t,n))];case"PadV2":case"Pad":return[r.pad(nX("x",e,t,n),nX("padding",e,t,n),nX("constantValue",e,t,n))];case"SpaceToBatchND":{let a=nX("blockShape",e,t,n),i=nX("paddings",e,t,n);return[r.spaceToBatchND(nX("x",e,t,n),a,i)]}case"BatchToSpaceND":{let a=nX("blockShape",e,t,n),i=nX("crops",e,t,n);return[r.batchToSpaceND(nX("x",e,t,n),a,i)]}case"DepthToSpace":{let a=nX("blockSize",e,t,n),i=nX("dataFormat",e,t,n).toUpperCase();return[r.depthToSpace(nX("x",e,t,n),a,i)]}case"BroadcastTo":return[r.broadcastTo(nX("x",e,t,n),nX("shape",e,t,n))];case"BroadcastArgs":return[r.broadcastArgs(nX("s0",e,t,n),nX("s1",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"hash_table":return yY(e,t,n,r);case"custom":let i=eX(e.op);if(i&&i.customExecutor)return i.customExecutor(new class{constructor(e,t,n){this.node=e,this.tensorMap=t,this.context=n,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map((e=>this.getInput(e))),null!=e.rawAttrs&&(this.attrs=Object.keys(e.rawAttrs).reduce(((e,t)=>(e[t]=this.getAttr(t),e)),{}))}getInput(e){return rX(e,this.tensorMap,this.context)}getAttr(e,t){let n=this.node.rawAttrs[e];if(null!=n.tensor)return rX(e,this.tensorMap,this.context);if(null!=n.i||null!=n.f)return ZX(this.node.rawAttrs,e,t);if(null!=n.s)return YX(this.node.rawAttrs,e,t);if(null!=n.b)return JX(this.node.rawAttrs,e,t);if(null!=n.shape)return aY(this.node.rawAttrs,e,t);if(null!=n.type)return tY(this.node.rawAttrs,e,t);if(null!=n.list){if(null!=n.list.i||null!=n.list.f)return iY(this.node.rawAttrs,e,t);if(null!=n.list.s)return sY(this.node.rawAttrs,e,t);if(null!=n.list.shape)return oY(this.node.rawAttrs,e,t);if(null!=n.list.b)return lY(this.node.rawAttrs,e,t);if(null!=n.list.type)return nY(this.node.rawAttrs,e,t)}return t}}(e,t,n));throw TypeError(`Custom op ${e.op} is not registered.`);default:throw TypeError(`Unknown op '${e.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(e,t,n);return pT.isPromise(i)?i.then((e=>[].concat(e))):[].concat(i)}var xY=class{constructor(e={},t={},n={},r={},a){this.weightMap=e,this.tensorArrayMap=t,this.tensorListMap=n,this.functionMap=r,this.parseNodeNameCache=a,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,t){return{id:e,frameName:t,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){let e=[];for(let t=0;t<this.contexts.length-1;t++){let n=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(n))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map((e=>0===e.id&&0===e.iterationId?"":`${e.frameName}-${e.iterationId}`)).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()}nextIteration(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");{this.contexts=this.contexts.slice(),this.lastId++;let e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(let t in this.tensorArrayMap)this.tensorArrayMap[t].clearAndClose(e);for(let t in this.tensorListMap)this.tensorListMap[t].clearAndClose(e)}};function wY(e,t,n,r){let a=new Set,i=[],s=null,o=null,l=new Set,u=new Set(Object.keys(e).map((e=>oX(e)[0])));r=r||[];let d=new Set(r.map((e=>oX(e.name)[0]))),c=[...t];for(;c.length>0;){let e=c.pop();if((TY(e)||EY(e)||_Y(e))&&null==s&&(s=e,o=s.children.map((e=>e.name)).filter((e=>a.has(e)))),a.add(e.name),null==n[e.name]&&!u.has(e.name)&&!d.has(e.name)){if(0===e.inputs.length){i.push(e.name);continue}e.inputs.forEach((e=>{l.has(e.name)||(l.add(e.name),c.push(e))}))}}return{inputs:e,outputs:t,usedNodes:a,missingInputs:i,dynamicNode:s,syncInputs:o}}function kY(e,t){let{usedNodes:n,inputs:r}=t,a=Object.keys(r).map((e=>oX(e)[0])).map((t=>e.nodes[t])),i=e.initNodes||[],s=e=>n.has("string"==typeof e?e:e.name);function o(e){return[...new Map(e.map((e=>[e.name,e]))).values()]}let l=o([...a,...e.weights,...i]).filter(s),u=o([...l,...Object.values(e.nodes)]).filter(s),d=new Map(u.map((e=>[e.name,e]))),c={};for(let g of u){c[g.name]=c[g.name]||0;for(let e of g.children)s(e)||(c[e.name]=Number.POSITIVE_INFINITY),c[e.name]=(c[e.name]||0)+1}let p=Object.entries(c).filter((([,e])=>0===e)).map((([e])=>e)),h=[...p];for(;p.length>0;){let e=p.pop(),t=d.get(e);for(let n of t.children.filter(s))0==--c[n.name]&&(h.push(n.name),p.push(n.name))}let f=h.map((e=>d.get(e))),m=function(e,t){let n=new Map(e.map((e=>[e.name,e]))),r=t.map((e=>e.name)),a=new Set(r);for(;r.length>0;){let e=r.pop(),t=n.get(e);for(let i of t.children)!n.has(i.name)||a.has(i.name)||(a.add(i.name),r.push(i.name))}return e.filter((e=>a.has(e.name)))}(f,l);return function(e,t){let n=new Map(e.map(((e,t)=>[e.name,t]))),r=new Set(t.map((e=>e.name))),a=e=>r.has("string"==typeof e?e:e.name),i=new Set(e.map((e=>e.name))),s=e=>i.has("string"==typeof e?e:e.name);for(let o of e){for(let e of o.children.filter(s)){if(!n.has(e.name))throw new SY(`Child ${e.name} of node ${o.name} is unreachable.`);if(n.get(o.name)>n.get(e.name))throw new SY(`Node ${o.name} is scheduled to run after its child ${e.name}.`)}if(!a(o))for(let e of o.inputs){if(!n.has(e.name))throw new SY(`Input ${e.name} of node ${o.name} is unreachable.`);if(n.get(e.name)>n.get(o.name))throw new SY(`Node ${o.name} is scheduled to run before its input ${e.name}.`)}}}(m,l),m}var SY=class extends Error{constructor(e){super(`NodesExecutionOrderError: ${e}`)}},IY=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),NY=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),CY=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function TY(e){return IY.has(e.op)}function EY(e){return NY.has(e.op)}function _Y(e){return CY.has(e.op)}var $Y=class{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){let t=Object.keys(e).map((t=>e[t].map((e=>e.id))));this._weightIds=[].concat(...t),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map((e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0})))}get outputs(){return this._outputs.map((e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0})))}get inputNodes(){return this._inputs.map((e=>e.signatureKey||e.name))}get outputNodes(){return this._outputs.map((e=>{let t=e.signatureKey||e.name;return e.defaultOutput?`${t}:${e.defaultOutput}`:t}))}get functions(){return Object.keys(this._functions).reduce(((e,t)=>(e[t]=this._functions[t].signature,e)),{})}constructor(e,t){this.graph=e,this.parent=t,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,null!=e.functions&&Object.keys(e.functions).forEach((t=>{this._functionExecutorMap[t]=new $Y(e.functions[t],this)}))}getCompilationKey(e,t){let n=e.map((e=>e.name)).sort(),r=t.map((e=>e.name)).sort();return n.join(this.SEPARATOR)+"--"+r.join(this.SEPARATOR)}compile(e,t){let n=wY(e,t,this.weightMap,this._initNodes),{missingInputs:r,dynamicNode:a,syncInputs:i}=n;if(null!=a)throw new Error(`This execution contains the node '${a.name}', which has the dynamic op '${a.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${i}]`);if(r.length>0){let n=t.map((e=>e.name)),a=Object.keys(e);throw new Error(`Cannot compute the outputs [${n}] from the provided inputs [${a}]. Missing the following inputs: [${r}]`)}let s=kY(this.graph,n),o=function(e){let t=new Map(e.map(((e,t)=>[e.name,t]))),n=Number.MAX_SAFE_INTEGER,r=e.map(((e,t)=>TY(e)?n:t)),a=e=>{let n=r[t.get(e.name)];return null==n?-1:n},i=e.map(((e,t)=>e.children.map(a).reduce(((e,t)=>Math.max(e,t)),r[t]))),s=new Map;for(let o=0;o<e.length;++o){let t=i[o];if(t===n)continue;let r=e[o],a=e[t];s.has(a.name)||s.set(a.name,[]),s.get(a.name).push(r)}return s}(s);return{orderedNodes:s,nodeLiveUntilMap:o}}cloneAndKeepTensor(e){if(null==e)return null;let t=e.clone();return G_(t),t}cloneTensorList(e){return e?e.map((e=>this.cloneAndKeepTensor(e))):null}cloneTensorMap(e){return Object.fromEntries(Object.entries(e).map((([e,t])=>[e,this.cloneTensorList(t)])))}execute(e,t){this.disposeIntermediateTensors(),e=this.mapInputs(e);let n=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);let r=n.map((e=>this.graph.nodes[oX(e)[0]])),a=t.map((e=>oX(e)[0])),i=new Set(a),s=a.map((e=>this.graph.nodes[e]));0===s.length&&(s=this._outputs);let o=this.getCompilationKey(r,s),l=this.compiledMap.get(o);null==l&&(l=this.compile(e,s),this.compiledMap.set(o,l));try{this.keepIntermediateTensors=$S().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(wp){this.keepIntermediateTensors=!1,console.warn(wp.message)}let u={},d={};return j_((()=>{let n=new xY(this.weightMap,u,d,this.functionExecutorMap,this.parseNodeNameCache),r=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(e).forEach((t=>{let[a,i]=oX(t,n),s=[];s[i]=e[t],r[a]=s,this.keepIntermediateTensors&&(this.clonedTensorsMap[a]=this.cloneTensorList(s))}));let a=this.getFrozenTensorIds(r),{orderedNodes:s,nodeLiveUntilMap:o}=l;for(let e of s){if(r[e.name])continue;let t=vY(e,r,n,this._resourceManager);if(pT.isPromise(t))throw new Error(`The execution of the op '${e.op}' returned a promise. Please use model.executeAsync() instead.`);r[e.name]=t,this.keepIntermediateTensors&&(this.clonedTensorsMap[e.name]=this.cloneTensorList(t)),this.checkTensorForDisposalWithNodeLiveUntilInfo(e,r,n,a,i,o.get(e.name))}return null==this.parent&&n.dispose(a),t.map((e=>rX(e,r,n)))}))}getFrozenTensorIds(e){let t=[].concat.apply([],Object.keys(e).map((t=>e[t])).map((e=>e.map((e=>e.id)))));return new Set(t)}checkTensorForDisposal(e,t,n,r,a,i,s){if(!TY(t)&&!i.has(e)){for(let r of n[e])null!=r&&(s[r.id]=(s[r.id]||0)+t.children.length);for(let e of t.inputs){if(TY(e))continue;let t=aX(e.name,n,r);if(null!=t)for(let e of t){if(!e||e.kept||a.has(e.id))continue;let t=s[e.id];1===t?(e.dispose(),delete s[e.id]):null!=t&&s[e.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(e,t,n,r,a,i){function s(e){return TY(e)||a.has(e.name)}if(!TY(e)&&null!=i)for(let o of i){if(s(o))continue;let e=aX(o.name,t,n);for(let t of e)!t||t.kept||r.has(t.id)||t.dispose()}}async executeAsync(e,t){return this._executeAsync(e,t)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach((e=>{for(let t of e)t&&!t.isDisposed&&t.dispose()})),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(e,t,n=!1,r={},a={}){this.disposeIntermediateTensors(),n||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t));try{this.keepIntermediateTensors=$S().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(wp){this.keepIntermediateTensors=!1,console.warn(wp.message)}let i=new xY(this.weightMap,r,a,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));let s=await this.executeWithControlFlow(e,i,t,n),o=t.map((e=>rX(e,s,i))),l=o.map((e=>e.id)),u=Object.keys(e).map((t=>e[t].id)),d=new Set([...l,...u,...this.weightIds]);return Object.values(s).forEach((e=>{e.forEach((e=>{e&&!e.isDisposed&&!d.has(e.id)&&e.dispose()}))})),null==this.parent&&i.dispose(d),o}async executeFunctionAsync(e,t,n){let r=e.reduce(((e,t,n)=>(e[this.inputs[n].name]=t,e)),{});return this._executeAsync(r,this.outputNodes,!0,t,n)}async executeWithControlFlow(e,t,n,r){let a=Object.keys(e),i=a.map((e=>this.graph.nodes[oX(e)[0]])),s=n.map((e=>oX(e)[0])),o=new Set(s),l=s.map((e=>this.graph.nodes[e]));0===l.length&&(l=this._outputs);let{usedNodes:u,missingInputs:d,dynamicNode:c,syncInputs:p}=wY(e,l,this.weightMap,this._initNodes),h=[...i,...this.graph.weights,...this._initNodes||[]].map((e=>({node:e,contexts:t.currentContext}))),f=Object.assign({},this.weightMap);Object.keys(e).forEach((t=>{let[n,r]=oX(t),a=[];a[r]=e[t],f[n]=a}));let m={},g=this.getFrozenTensorIds(f),b={};for(;h.length>0;){let e=this.processStack(i,h,t,f,b,g,o,m,u);await Promise.all(e)}null==c&&!r&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");let y=l.filter((e=>!TY(e)&&!rX(e.name,f,t))).map((e=>e.name));if(y.length>0){let e="";throw null!=c&&(e=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${p}]`),new Error(`Cannot compute the outputs [${y}] from the provided inputs [${a}]. Consider providing the following inputs: [${d}]. ${e}`)}return f}processStack(e,t,n,r,a,i,s,o,l){let u=[];for(;t.length>0;){let e=t.pop();n.currentContext=e.contexts;let d="";if("Enter"===e.node.op&&nX("isConstant",e.node,r,n)&&([d]=iX(e.node.name,n)),null==r[e.node.name]){let c=vY(e.node,r,n,this._resourceManager);d||([d]=iX(e.node.name,n));let p=n.currentContext;pT.isPromise(c)?u.push(c.then((u=>(r[d]=u,this.keepIntermediateTensors&&(this.clonedTensorsMap[d]=this.cloneTensorList(u)),n.currentContext=p,this.checkTensorForDisposal(d,e.node,r,n,i,s,o),this.processChildNodes(e.node,t,n,r,a,l),u)))):(r[d]=c,this.keepIntermediateTensors&&(this.clonedTensorsMap[d]=this.cloneTensorList(c)),this.checkTensorForDisposal(d,e.node,r,n,i,s,o),this.processChildNodes(e.node,t,n,r,a,l))}else this.processChildNodes(e.node,t,n,r,a,l)}return u}processChildNodes(e,t,n,r,a,i){e.children.forEach((e=>{let[s]=iX(e.name,n);a[s]||!i.has(e.name)||("Merge"===e.op?e.inputNames.some((e=>!!rX(e,r,n)))&&(a[s]=!0,t.push({contexts:n.currentContext,node:e})):e.inputNames.every((e=>!!rX(e,r,n)))&&(a[s]=!0,t.push({contexts:n.currentContext,node:e})))}))}dispose(){Object.keys(this.weightMap).forEach((e=>this.weightMap[e].forEach((e=>e.dispose()))))}checkInputShapeAndType(e){Object.keys(e).forEach((t=>{let n=e[t],[r]=oX(t),a=this.graph.nodes[r];if(a.attrParams.shape&&a.attrParams.shape.value){let e=a.attrParams.shape.value,t=e.length===n.shape.length&&n.shape.every(((t,n)=>-1===e[n]||e[n]===t));pT.assert(t,(()=>`The shape of dict['${a.name}'] provided in model.execute(dict) must be [${e}], but was [${n.shape}]`))}a.attrParams.dtype&&a.attrParams.dtype.value&&pT.assert(n.dtype===a.attrParams.dtype.value,(()=>`The dtype of dict['${a.name}'] provided in model.execute(dict) must be ${a.attrParams.dtype.value}, but was ${n.dtype}`))}))}mapInputs(e){var t,n;let r={};for(let a in e){let i=null===(n=null===(t=this._signature)||void 0===t?void 0:t.inputs)||void 0===n?void 0:n[a];null!=i?r[i.name]=e[a]:r[a]=e[a]}return r}checkInputs(e){let t=Object.keys(e).filter((e=>{let[t]=oX(e);return null==this.graph.nodes[t]}));if(t.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${t}] that are not part of graph`)}mapOutputs(e){return e.map((e=>{var t,n;let r=null===(n=null===(t=this._signature)||void 0===t?void 0:t.outputs)||void 0===n?void 0:n[e];return null!=r?r.name:e}),{})}checkOutputs(e){e.forEach((e=>{let[t]=oX(e);if(!this.graph.nodes[t])throw new Error(`The output '${e}' is not found in the graph`)}))}},AY="?tfjs-format=file",RY="model.json",DY=class{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(e,t={},n=kO){this.modelUrl=e,this.loadOptions=t,this.version="n/a",this.io=n,null==t&&(this.loadOptions={}),this.resourceManager=new class{constructor(e={},t={}){this.hashTableNameToHandle=e,this.hashTableMap=t}addHashTable(e,t){this.hashTableNameToHandle[e]=t.handle,this.hashTableMap[t.id]=t}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(let e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(let e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}}findIOHandler(){let e=this.modelUrl;if(null!=e.load)this.handler=e;else if(null!=this.loadOptions.requestInit)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{let t=this.io.getLoadHandlers(e,this.loadOptions);if(0===t.length)t.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(t.length>1)throw new Error(`Found more than one (${t.length}) load handlers for URL '${[e]}'`);this.handler=t[0]}}load(){if(this.findIOHandler(),null==this.handler.load)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");let e=this.handler.load();return pT.isPromise(e)?e.then((e=>this.loadSync(e))):this.loadSync(e)}loadSync(e){this.artifacts=e;let t=this.artifacts.modelTopology,n=this.artifacts.signature;if(null!=this.artifacts.userDefinedMetadata){let e=this.artifacts.userDefinedMetadata;null!=e.signature&&(n=e.signature),null!=e.structuredOutputKeys&&(this.structuredOutputKeys=e.structuredOutputKeys)}this.signature=n,this.version=`${t.versions.producer}.${t.versions.minConsumer}`;let r=this.io.decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs);if(this.executor=new $Y(KX.Instance.transformGraph(t,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(r),this.executor.resourceManager=this.resourceManager,null!=e.modelInitializer&&null!=e.modelInitializer.node){let t=KX.Instance.transformGraph(e.modelInitializer);this.initializer=new $Y(t),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}async save(e,t){if("string"==typeof e){let t=this.io.getSaveHandlers(e);if(0===t.length)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(t.length>1)throw new Error(`Found more than one (${t.length}) save handlers for URL '${e}'`);e=t[0]}if(null==e.save)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}addStructuredOutputNames(e){if(this.structuredOutputKeys){let t={};return(e instanceof XT?[e]:e).forEach(((e,n)=>t[this.structuredOutputKeys[n]]=e)),t}return e}predict(e,t){let n=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(n)}async predictAsync(e,t){let n=await this.executeAsync(e,this.outputNodes);return this.addStructuredOutputNames(n)}normalizeInputs(e){var t;if(!(e instanceof XT||Array.isArray(e))){let n=null===(t=this.signature)||void 0===t?void 0:t.inputs;if(null!=n)for(let t in n){let r=n[t];null!=r.resourceId&&(e[t]=this.resourceIdToCapturedInput[r.resourceId])}return e}e=Array.isArray(e)?e:[e];let n=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+n!==this.inputNodes.length)throw new Error(`Input tensor count mismatch, the graph model has ${this.inputNodes.length-n} non-resource placeholders, while there are ${e.length} input tensors provided.`);let r=0;return this.inputNodes.reduce(((t,n)=>{var a,i,s;let o=null===(s=null===(i=null===(a=this.signature)||void 0===a?void 0:a.inputs)||void 0===i?void 0:i[n])||void 0===s?void 0:s.resourceId;return t[n]=null!=o?this.resourceIdToCapturedInput[o]:e[r++],t}),{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}executeInitializerGraph(){return null==this.initializer?[]:null==this.initializerSignature?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return null==this.initializer?[]:null==this.initializerSignature?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(e){if(this.resourceIdToCapturedInput={},this.initializerSignature){let t=this.initializerSignature.outputs,n=Object.keys(t);for(let r=0;r<n.length;r++){let a=t[n[r]];this.resourceIdToCapturedInput[a.resourceId]=e[r]}}}execute(e,t){null==this.resourceIdToCapturedInput&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);let n=this.executor.execute(e,t);return n.length>1?n:n[0]}async executeAsync(e,t){null==this.resourceIdToCapturedInput&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);let n=await this.executor.executeAsync(e,t);return n.length>1?n:n[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce(((t,n)=>(t[n]=[e[n]],t)),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&H_(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}};async function FY(e,t={},n=kO){if(null==e)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");null==t&&(t={}),t.fromTFHub&&"string"==typeof e&&(e=function(e){return e.endsWith("/")||(e+="/"),`${e}${RY}${AY}`}(e));let r=new DY(e,t,n);return await r.load(),r}function MY(e){if(null==e)throw new Error("modelUrl in loadGraphModelSync() cannot be null. Please provide model artifacts or an IOHandler that loads the model");let t;if(e instanceof Array){let[n,r]=e;if(!n)throw new Error("modelJSON must be the first element of the array");if(!(r&&r instanceof ArrayBuffer))throw new Error("An ArrayBuffer of weights must be the second element of the array");if(!("modelTopology"in n))throw new Error("Model JSON is missing 'modelTopology'");if(!("weightsManifest"in n))throw new Error("Model JSON is missing 'weightsManifest'");let a=kO.getWeightSpecs(n.weightsManifest),i=kO.getModelArtifactsForJSONSync(n,a,r);t=kO.fromMemorySync(i)}else if("load"in e)t=e;else{if(!("modelTopology"in e&&"weightSpecs"in e&&"weightData"in e))throw new Error("Unknown model format");t=kO.fromMemorySync(e)}let n=new DY(t);return n.load(),n}var OY="4.7.0",PY={};ok(PY,{CSVDataset:()=>_J,Dataset:()=>gJ,FileDataSource:()=>VJ,TextLineDataset:()=>kJ,URLDataSource:()=>UJ,array:()=>yJ,csv:()=>jJ,func:()=>HJ,generator:()=>GJ,microphone:()=>KJ,version_data:()=>XJ,webcam:()=>qJ,zip:()=>vJ});var LY=lk(xk()),zY=lk(xk());function BY(e,t,n=new Map,r=new Set){if(null==e)return null;if("function"==typeof Blob&&e instanceof Blob)return e.slice();if(r.has(e))throw new Error("Circular references are not supported.");if(n.has(e))return n.get(e);let a=t(e);if(a.recurse&&null!==a.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(a.recurse){if(HY(e)){let a=Array.isArray(e)?[]:{};r.add(e);for(let i in e){let s=BY(e[i],t,n,r);a[i]=s}return r.delete(e),e.__proto__&&(a.__proto__=e.__proto__),a}throw new Error(`Can't recurse into non-iterable type: ${e}`)}return n.set(e,a.value),a.value}function WY(e,t=UY){return VY(e,t)}function VY(e,t,n=new Set){let r=e[0];if(n.has(r))throw new Error("Circular references are not supported.");let a=t(e);if(a.recurse&&null!==a.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(a.recurse){if(HY(r)){let a=Array.isArray(r)?[]:{};n.add(r);for(let i in r){let r=e.map((e=>e[i])),s=VY(r,t,n);a[i]=s}return n.delete(r),a}throw new Error(`Can't recurse into non-iterable type: ${r}`)}return a.value}function UY(e){return null===e?null:HY(e[0])?{value:null,recurse:!0}:{value:e,recurse:!1}}async function jY(e,t){let n=new Map;BY(e,t,n);for(let r of Array.from(n.keys())){let e=n.get(r);if(pT.isPromise(e)){let t=await e;n.set(r,t)}}return BY(e,t,n)}function HY(e){let t=!1;if($S().get("IS_BROWSER"))t=e instanceof TextDecoder;else{let{StringDecoder:n}=wk();t=e instanceof n}return null!=e&&!ArrayBuffer.isView(e)&&(Array.isArray(e)||"object"==typeof e&&!(e instanceof XT)&&!(e instanceof Promise)&&!t)}function GY(e){return function(e,t){return BY(e,t)}(e,qY)}function qY(e){return e instanceof XT?{value:e.clone(),recurse:!1}:HY(e)?{value:null,recurse:!0}:{value:e,recurse:!1}}var KY=class{constructor(e){if(this.capacity=e,this.begin=0,this.end=0,null==e)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(e<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(e),this.doubledCapacity=2*e}wrap(e){for(;e<0;)e+=this.doubledCapacity;return e%this.doubledCapacity}get(e){if(e<0)throw new RangeError("Can't get item at a negative index.");return this.data[e%this.capacity]}set(e,t){if(e<0)throw new RangeError("Can't set item at a negative index.");this.data[e%this.capacity]=t}length(){let e=this.end-this.begin;return e<0&&(e=this.doubledCapacity+e),e}isFull(){return this.length()===this.capacity}isEmpty(){return 0===this.length()}push(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,e),this.end=this.wrap(this.end+1)}pushAll(e){for(let t of e)this.push(t)}pop(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);let e=this.get(this.end);return this.set(this.end,void 0),e}unshift(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,e)}shift(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");let e=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),e}shuffleExcise(e){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");let t=this.wrap(this.begin+e),n=this.get(t);return this.set(t,this.pop()),n}},XY=class extends KY{constructor(){super(XY.INITIAL_CAPACITY)}isFull(){return!1}push(e){super.isFull()&&this.expand(),super.push(e)}unshift(e){super.isFull()&&this.expand(),super.unshift(e)}expand(){let e=2*this.capacity,t=new Array(e),n=this.length();for(let r=0;r<n;r++)t[r]=this.get(this.wrap(this.begin+r));this.data=t,this.capacity=e,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n}};function YY(e){return new eJ(e)}function JY(e){return new tJ(e)}XY.INITIAL_CAPACITY=32;var ZY,QY=class{async toArray(){let e=[],t=await this.next();for(;!t.done;)e.push(t.value),t=await this.next();return e}async toArrayForTest(){let e=this.prefetch(100),t=[],n=await e.next();for(;!n.done;)t.push(n.value),n=await e.next();return t}async resolveFully(){let e=await this.next();for(;!e.done;)e=await this.next()}async resolveWhile(e){let t=await this.next(),n=e(t.value);for(;!t.done&&n;)t=await this.next(),n=e(t.value)}handleErrors(e){return new lJ(this,e)}filter(e){return new sJ(this,e)}map(e){return new oJ(this,e)}mapAsync(e){return new uJ(this,e)}serialMapAsync(e){return new uJ(this,e).serial()}flatmap(e){return new cJ(this,e)}async forEachAsync(e){return this.map(e).resolveFully()}async serialForEach(e){return this.serialMapAsync(e).resolveWhile((e=>!0===e))}rowMajorBatch(e,t=!0){return new iJ(this,e,t)}columnMajorBatch(e,t=!0,n=UY){return this.rowMajorBatch(e,t).map((e=>WY(e,n)))}concatenate(e,t){return new pJ(YY([this,e]),t)}take(e){return e<0||null==e?this:new aJ(this,e)}skip(e){return e<0||null==e?this:new rJ(this,e)}prefetch(e){return new fJ(this,e)}shuffle(e,t){return new mJ(this,e,t)}serial(){return new nJ(this)}},eJ=class extends QY{constructor(e){super(),this.items=e,this.trav=0}summary(){return`Array of ${this.items.length} items`}async next(){if(this.trav>=this.items.length)return{value:null,done:!0};let e=this.items[this.trav];return this.trav++,{value:GY(e),done:!1}}},tJ=class extends QY{constructor(e){super(),this.nextFn=e}summary(){return"Function call"}async next(){try{return this.nextFn()}catch(kp){throw kp.message=`Error thrown while iterating through a dataset: ${kp.message}`,kp}}},nJ=class extends QY{constructor(e){super(),this.upstream=e,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Serial`}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){return this.upstream.next()}},rJ=class extends QY{constructor(e,t){super(),this.upstream=e,this.maxCount=t,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Skip`}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){for(;this.count++<this.maxCount;){let e=await this.upstream.next();if(e.done)return e;H_(e.value)}return this.upstream.next()}},aJ=class extends QY{constructor(e,t){super(),this.upstream=e,this.maxCount=t,this.count=0}summary(){return`${this.upstream.summary()} -> Take`}async next(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()}},iJ=class extends QY{constructor(e,t,n=!0){super(),this.upstream=e,this.batchSize=t,this.enableSmallLastBatch=n,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> RowMajorBatch`}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){let e=[];for(;e.length<this.batchSize;){let t=await this.upstream.next();if(t.done)return this.enableSmallLastBatch&&e.length>0?{value:e,done:!1}:{value:null,done:!0};e.push(t.value)}return{value:e,done:!1}}},sJ=class extends QY{constructor(e,t){super(),this.upstream=e,this.predicate=t,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Filter`}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){for(;;){let e=await this.upstream.next();if(e.done||this.predicate(e.value))return e;H_(e.value)}}},oJ=class extends QY{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return`${this.upstream.summary()} -> Map`}async next(){let e=await this.upstream.next();if(e.done)return{value:null,done:!0};let t=rE.getTensorsInContainer(e.value),n=this.transform(e.value),r=rE.getTensorsInContainer(n);for(let a of t)rE.isTensorInList(a,r)||a.dispose();return{value:n,done:!1}}},lJ=class extends QY{constructor(e,t){super(),this.upstream=e,this.handler=t,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> handleErrors`}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){for(;;)try{return await this.upstream.next()}catch(kp){if(!this.handler(kp))return{value:null,done:!0}}}},uJ=class extends QY{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return`${this.upstream.summary()} -> AsyncMap`}async next(){let e=await this.upstream.next();if(e.done)return{value:null,done:!0};let t=rE.getTensorsInContainer(e.value),n=await this.transform(e.value),r=rE.getTensorsInContainer(n);for(let a of t)rE.isTensorInList(a,r)||a.dispose();return{value:n,done:!1}}},dJ=class extends QY{constructor(){super(),this.outputQueue=new XY,this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){for(;0===this.outputQueue.length();)if(!(await this.pump()))return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}}},cJ=class extends dJ{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return`${this.upstream.summary()} -> Flatmap`}async pump(){let e=await this.upstream.next();if(e.done)return!1;let t=rE.getTensorsInContainer(e.value),n=this.transform(e.value),r=rE.getTensorsInContainer(n);this.outputQueue.pushAll(n);for(let a of t)rE.isTensorInList(a,r)||a.dispose();return!0}},pJ=class extends QY{constructor(e,t){super(),this.baseErrorHandler=t,this.lastRead=null,this.iterator=null,this.moreIterators=e}summary(){return"TODO: fill in upstream of chained summaries -> Chained"}async next(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead}async readFromChain(e){if(await e,null==this.iterator){let e=await this.moreIterators.next();if(e.done)return{value:null,done:!0};this.iterator=e.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}let t=await this.iterator.next();return t.done?(this.iterator=null,this.readFromChain(e)):t}};!function(e){e[e.FAIL=0]="FAIL",e[e.SHORTEST=1]="SHORTEST",e[e.LONGEST=2]="LONGEST"}(ZY||(ZY={}));var hJ=class extends QY{constructor(e,t=ZY.FAIL){super(),this.iterators=e,this.mismatchMode=t,this.count=0,this.currentPromise=null}summary(){return"{TODO: fill in upstream of zip summaries} -> Zip"}async nextState(e){await e;let t=0,n=0,r=await jY(this.iterators,(function(e){return e instanceof QY?{value:e.next().then((e=>(t++,e.done&&n++,e.value))),recurse:!1}:{value:null,recurse:!0}}));if(t===n)return{value:null,done:!0};if(n>0)switch(this.mismatchMode){case ZY.FAIL:throw new Error(`Zipped streams should have the same length. Mismatched at element ${this.count}.`);case ZY.SHORTEST:return{value:null,done:!0};case ZY.LONGEST:}return this.count++,{value:r,done:!1}}async next(){return this.currentPromise=this.nextState(this.currentPromise),this.currentPromise}},fJ=class extends QY{constructor(e,t){super(),this.upstream=e,this.bufferSize=t,this.buffer=new KY(t)}summary(){return`${this.upstream.summary()} -> Prefetch`}refill(){for(;!this.buffer.isFull();){let e=this.upstream.next();this.buffer.push(e)}}next(){return this.refill(),this.buffer.shift()}},mJ=class extends fJ{constructor(e,t,n){super(e,t),this.upstream=e,this.windowSize=t,this.upstreamExhausted=!1,this.random=zY.alea(n||pT.now().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}randomInt(e){return Math.floor(this.random()*e)}chooseIndex(){return this.randomInt(this.buffer.length())}async serialNext(){for(this.upstreamExhausted||this.refill();!this.buffer.isEmpty();){let e=this.chooseIndex(),t=await this.buffer.shuffleExcise(e);if(!t.done)return this.refill(),t;this.upstreamExhausted=!0}return{value:null,done:!0}}},gJ=class{constructor(){this.size=null}batch(e,t=!0){let n,r=this;return pT.assert(e>0,(()=>`batchSize needs to be positive, but it is\n      ${e}`)),n=this.size===1/0||null==this.size?this.size:t?Math.ceil(this.size/e):Math.floor(this.size/e),bJ((async()=>(await r.iterator()).columnMajorBatch(e,t,xJ)),n)}concatenate(e){let t,n=this;return t=this.size===1/0||e.size===1/0?1/0:null!=this.size&&null!=e.size?this.size+e.size:null,bJ((async()=>(await n.iterator()).concatenate(await e.iterator())),t)}filter(e){let t,n=this;return t=this.size===1/0?1/0:null,bJ((async()=>(await n.iterator()).filter((t=>j_((()=>e(t)))))),t)}async forEachAsync(e){return(await this.iterator()).forEachAsync(e)}map(e){let t=this;return bJ((async()=>(await t.iterator()).map((t=>j_((()=>e(t)))))),this.size)}mapAsync(e){let t=this;return bJ((async()=>(await t.iterator()).mapAsync(e)),this.size)}prefetch(e){if(null==e)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");let t=this;return bJ((async()=>(await t.iterator()).prefetch(e)),this.size)}repeat(e){let t,n=this;return t=null!=this.size&&e>0?this.size*e:0===e?0:null!=this.size&&(void 0===e||e<0)?1/0:null,bJ((async()=>function(e,t){return new pJ(e,t)}(JY((async()=>({value:await n.iterator(),done:!1}))).take(e))),t)}skip(e){let t,n=this;return t=null!=this.size&&e>=0&&this.size>=e?this.size-e:null!=this.size&&(this.size<e||void 0===e||e<0)?0:null,bJ((async()=>(await n.iterator()).skip(e)),t)}shuffle(e,t,n=!0){if(null==e||e<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError(`\`Dataset.shuffle()\` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for \`tf.Tensor\`s), consider setting bufferSize to the dataset size (${this.size} elements)`);let r=this,a=LY.alea(t||pT.now().toString());return bJ((async()=>{let t=a.int32();return n&&(t+=a.int32()),(await r.iterator()).shuffle(e,t.toString())}),this.size)}take(e){let t,n=this;return t=null!=this.size&&this.size>e?e:null!=this.size&&this.size<=e?this.size:null,bJ((async()=>(await n.iterator()).take(e)),t)}async toArray(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArray()}async toArrayForTest(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArrayForTest()}};function bJ(e,t=null){return new class extends gJ{constructor(){super(...arguments),this.size=t}async iterator(){return e()}}}function yJ(e){return bJ((async()=>YY(e)),e.length)}function vJ(e){if(!HY(e))throw new Error("The argument to zip() must be an object or array.");let t;if(Array.isArray(e))for(let n=0;n<e.length;n++)t=null==t?e[n].size:Math.min(t,e[n].size);else if(e instanceof Object)for(let n in e)t=null==t?e[n].size:Math.min(t,e[n].size);return bJ((async()=>{let t=await jY(e,(e=>{if(e instanceof gJ)return{value:e.iterator(),recurse:!1};if(HY(e))return{value:null,recurse:!0};throw new Error("Leaves of the structure passed to zip() must be Datasets, not primitives.")}));return function(e,t=ZY.FAIL){return new hJ(e,t)}(t,ZY.SHORTEST)}),t)}function xJ(e){return null===e?null:function(e){return null==e||function(e){return null===e||"object"!=typeof e&&"function"!=typeof e}(e)||Array.isArray(e)||"object"==typeof e&&e instanceof XT||pT.isTypedArray(e)}(e[0])?{value:wJ(e),recurse:!1}:{value:null,recurse:!0}}function wJ(e){if(0===e.length)throw new Error("Can't make a batch of zero elements.");return e[0]instanceof XT?mF(e):ME(e)}gJ.MAX_BUFFER_SIZE=1e4;var kJ=class extends gJ{constructor(e){super(),this.input=e}async iterator(){return(await this.input.iterator()).decodeUTF8().split("\n").map((e=>(e.endsWith("\r")&&(e=e.slice(0,-1)),e)))}},SJ='"',IJ=Symbol("out"),NJ=Symbol("field"),CJ=Symbol("quote"),TJ=Symbol("quoteafterquote"),EJ=Symbol("quoteinquote"),_J=class extends gJ{async columnNames(){return this.columnNamesValidated||await this.setColumnNames(),this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames}async setColumnNames(){let e=await this.maybeReadHeaderLine();if(!this.fullColumnNames&&!e)throw new Error("Column names must be provided if there is no header line.");this.fullColumnNames&&e&&pT.assert(e.length===this.fullColumnNames.length,(()=>"The length of provided columnNames ("+this.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+e.length.toString()+").")),this.fullColumnNames||(this.fullColumnNames=e);let t=this.fullColumnNames.reduce(((e,t)=>(e[t]=e[t]+1||1,e)),{}),n=Object.keys(t).filter((e=>t[e]>1));if(pT.assert(0===n.length,(()=>"Duplicate column names found: "+n.toString())),this.columnConfigs)for(let r of Object.keys(this.columnConfigs))if(-1===this.fullColumnNames.indexOf(r))throw new Error('The key "'+r+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").");this.columnNamesValidated=!0}async maybeReadHeaderLine(){if(this.hasHeader){let e=await(await this.base.iterator()).next();if(e.done)throw new Error("No data was found for CSV parsing.");let t=e.value;return this.parseRow(t,!1)}return null}constructor(e,t){super(),this.input=e,this.hasHeader=!0,this.fullColumnNames=null,this.columnNamesValidated=!1,this.columnConfigs=null,this.configuredColumnsOnly=!1,this.delimiter=",",this.delimWhitespace=!1,this.base=new kJ(e),t||(t={}),this.hasHeader=!1!==t.hasHeader,this.fullColumnNames=t.columnNames,this.columnConfigs=t.columnConfigs,this.configuredColumnsOnly=t.configuredColumnsOnly,t.delimWhitespace?(pT.assert(null==t.delimiter,(()=>"Delimiter should not be provided when delimWhitespace is true.")),this.delimWhitespace=!0,this.delimiter=" "):this.delimiter=t.delimiter?t.delimiter:","}async iterator(){this.columnNamesValidated||await this.setColumnNames();let e=await this.base.iterator();return this.hasHeader&&(e=e.skip(1)),e.map((e=>this.makeDataElement(e)))}makeDataElement(e){let t=this.parseRow(e),n={},r={};for(let a=0;a<this.fullColumnNames.length;a++){let i=this.fullColumnNames[a],s=this.columnConfigs?this.columnConfigs[i]:null;if(!this.configuredColumnsOnly||s){let o=t[a],l=null;if(""===o)if(s&&void 0!==s.default)l=s.default;else{if(s&&(s.required||s.isLabel))throw new Error(`Required column ${i} is empty in this line: ${e}`);l=void 0}else{let e=Number(o);if(isNaN(e))l=s&&"bool"===s.dtype?this.getBoolean(o):o;else if(s&&s.dtype)switch(s.dtype){case"float32":default:l=e;break;case"int32":l=Math.floor(e);break;case"bool":l=this.getBoolean(o)}else l=e}s&&s.isLabel?r[i]=l:n[i]=l}}return 0===Object.keys(r).length?n:{xs:n,ys:r}}getBoolean(e){return"1"===e||"true"===e.toLowerCase()?1:0}parseRow(e,t=!0){let n=[],r=0,a=e.length,i=IJ;for(let s=0;s<a;s++)switch(i){case IJ:switch(e.charAt(s)){case SJ:r=s+1,i=CJ;break;case this.delimiter:if(r=s+1," "===this.delimiter&&this.delimWhitespace)break;n.push(""),i=IJ;break;default:i=NJ,r=s}break;case NJ:e.charAt(s)===this.delimiter&&(n.push(e.substring(r,s)),i=IJ,r=s+1);break;case CJ:e.charAt(s)===SJ&&(i=TJ);break;case TJ:switch(e.charAt(s)){case this.delimiter:n.push(e.substring(r,s-1)),i=IJ,r=s+1;break;case SJ:i=CJ;break;default:i=EJ}break;case EJ:e.charAt(s)===SJ&&(i=CJ)}if(i===TJ?n.push(e.substring(r,a-1)):n.push(e.substring(r)),t&&n.length!==this.fullColumnNames.length)throw new Error(`Invalid row in csv file. Should have ${this.fullColumnNames.length} elements in a row, but got ${n}`);return n}},$J=class extends QY{constructor(e){super(),this.microphoneConfig=e,this.isClosed=!1,this.fftSize=e.fftSize||1024;let t=Math.log2(this.fftSize);if(this.fftSize<0||t<4||t>14||!Number.isInteger(t))throw new Error(`Invalid fftSize: it must be a power of 2 between 2 to 4 and 2 to 14, but got ${this.fftSize}`);if(this.numFrames=e.numFramesPerSpectrogram||43,this.sampleRateHz=e.sampleRateHz,this.columnTruncateLength=e.columnTruncateLength||this.fftSize,this.audioTrackConstraints=e.audioTrackConstraints,this.smoothingTimeConstant=e.smoothingTimeConstant||0,this.includeSpectrogram=!1!==e.includeSpectrogram,this.includeWaveform=!0===e.includeWaveform,!this.includeSpectrogram&&!this.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.")}summary(){return"microphone"}static async create(e={}){if(!$S().get("IS_BROWSER"))throw new Error("microphone API is only supported in browser environment.");let t=new $J(e);return await t.start(),t}async start(){try{this.stream=await navigator.mediaDevices.getUserMedia({audio:null==this.audioTrackConstraints||this.audioTrackConstraints,video:!1})}catch(_p){throw new Error(`Error thrown while initializing video stream: ${_p.message}`)}if(!this.stream)throw new Error("Could not obtain audio from microphone.");let e=window.AudioContext||window.webkitAudioContext;if(this.audioContext=new e,this.sampleRateHz){if(this.audioContext.sampleRate!==this.sampleRateHz)throw new Error(`Mismatch in sampling rate: Expected: ${this.sampleRateHz}; Actual: ${this.audioContext.sampleRate}`)}else this.sampleRateHz=this.audioContext.sampleRate;let t=this.audioContext.createMediaStreamSource(this.stream);this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2*this.fftSize,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,t.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize)}async next(){if(this.isClosed)return{value:null,done:!0};let e,t,n=await this.getAudioData();if(this.includeSpectrogram){let t=this.flattenQueue(n.freqDataQueue);e=this.getTensorFromAudioDataArray(t,[this.numFrames,this.columnTruncateLength,1])}if(this.includeWaveform){let e=this.flattenQueue(n.timeDataQueue);t=this.getTensorFromAudioDataArray(e,[this.numFrames*this.fftSize,1])}return{value:{spectrogram:e,waveform:t},done:!1}}async capture(){return(await this.next()).value}async getAudioData(){let e=[],t=[],n=0;return new Promise((r=>{let a=setInterval((()=>{this.includeSpectrogram&&(this.analyser.getFloatFrequencyData(this.freqData),this.freqData[0]===-1/0&&r({freqDataQueue:e,timeDataQueue:t}),e.push(this.freqData.slice(0,this.columnTruncateLength))),this.includeWaveform&&(this.analyser.getFloatTimeDomainData(this.timeData),t.push(this.timeData.slice())),++n===this.numFrames&&(clearInterval(a),r({freqDataQueue:e,timeDataQueue:t}))}),this.fftSize/this.sampleRateHz*1e3)}))}stop(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),null!=this.stream&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())}toArray(){throw new Error("Can not convert infinite audio stream to array.")}getSampleRate(){return this.sampleRateHz}flattenQueue(e){let t=e[0].length,n=new Float32Array(e.length*t);return e.forEach(((e,r)=>n.set(e,r*t))),n}getTensorFromAudioDataArray(e,t){let n=new Float32Array(pT.sizeFromShape(t));return n.set(e,n.length-e.length),ME(n,t)}},AJ=class extends QY{constructor(e,t){if(super(),this.webcamVideoElement=e,this.webcamConfig=t,this.isClosed=!0,this.resize=!1,this.needToResize())if(this.resize=!0,this.cropSize=[this.webcamConfig.resizeHeight,this.webcamConfig.resizeWidth],this.cropBoxInd=vF([0],"int32"),this.webcamConfig.centerCrop){let e=1*this.webcamConfig.resizeWidth/this.webcamVideoElement.width,t=1*this.webcamConfig.resizeHeight/this.webcamVideoElement.height,n=(1-e)/2,r=(1-t)/2,a=n+e,i=t+r;this.cropBox=xF([r,n,i,a],[1,4])}else this.cropBox=xF([0,0,1,1],[1,4])}summary(){return"webcam"}static async create(e,t={}){if(!$S().get("IS_BROWSER"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!e){if(e=document.createElement("video"),!t.resizeWidth||!t.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");e.width=t.resizeWidth,e.height=t.resizeHeight}let n=new AJ(e,t);return await n.start(),n}async start(){this.webcamConfig.facingMode&&pT.assert("user"===this.webcamConfig.facingMode||"environment"===this.webcamConfig.facingMode,(()=>`Invalid webcam facing mode: ${this.webcamConfig.facingMode}. Please provide 'user' or 'environment'`));try{this.stream=await navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})}catch(kp){throw kp.message=`Error thrown while initializing video stream: ${kp.message}`,kp}if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(kp){console.log(kp),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,new Promise((e=>{this.webcamVideoElement.onloadedmetadata=()=>{e()}}))}async next(){if(this.isClosed)return{value:null,done:!0};let e;try{e=HO.fromPixels(this.webcamVideoElement)}catch(Dp){throw new Error(`Error thrown converting video to pixels: ${JSON.stringify(Dp)}`)}if(!this.resize)return{value:e,done:!1};try{return{value:this.cropAndResizeFrame(e),done:!1}}catch(Dp){throw new Error(`Error thrown cropping the video: ${Dp.message}`)}finally{e.dispose()}}needToResize(){return!(!this.webcamConfig.resizeWidth||!this.webcamConfig.resizeHeight||this.webcamVideoElement.width===this.webcamConfig.resizeWidth&&this.webcamVideoElement.height===this.webcamConfig.resizeHeight)}cropAndResizeFrame(e){return j_((()=>{let t,n=tR(D_(e,"float32"),0);t=aO.cropAndResize(n,this.cropBox,this.cropBoxInd,this.cropSize,"bilinear");let r=t.shape;return M$(t,r.slice(1))}))}async capture(){return(await this.next()).value}stop(){this.stream.getTracks().forEach((e=>e.stop()));try{this.webcamVideoElement.srcObject=null}catch(kp){console.log(kp),this.webcamVideoElement.src=null}this.isClosed=!0}toArray(){throw new Error("Can not convert infinite video stream to array.")}},RJ=class{},DJ=class extends QY{split(e){return new FJ(this,e)}},FJ=class extends DJ{constructor(e,t){super(),this.upstream=e,this.impl=new MJ(e,t)}summary(){return this.impl.summary()}async next(){return this.impl.next()}},MJ=class extends dJ{constructor(e,t){super(),this.upstream=e,this.separator=t,this.carryover=""}summary(){return`${this.upstream.summary()} -> Split('${this.separator}')`}async pump(){let e=await this.upstream.next();if(e.done)return""!==this.carryover&&(this.outputQueue.push(this.carryover),this.carryover="",!0);let t=e.value.split(this.separator);t[0]=this.carryover+t[0];for(let n of t.slice(0,-1))this.outputQueue.push(n);return this.carryover=t[t.length-1],!0}},OJ=class extends QY{decodeUTF8(){return new PJ(this)}},PJ=class extends DJ{constructor(e){super(),this.upstream=e,this.impl=new LJ(e)}summary(){return this.impl.summary()}async next(){return this.impl.next()}},LJ=class extends dJ{constructor(e){if(super(),this.upstream=e,$S().get("IS_BROWSER"))this.decoder=new TextDecoder("utf-8");else{let{StringDecoder:e}=wk();this.decoder=new e("utf8")}}summary(){return`${this.upstream.summary()} -> Utf8`}async pump(){let e,t,n=await this.upstream.next();return!n.done&&(e=n.value,t=$S().get("IS_BROWSER")?this.decoder.decode(e,{stream:!0}):this.decoder.write(Buffer.from(e.buffer)),this.outputQueue.push(t),!0)}},zJ=class extends OJ{constructor(e,t={}){super(),this.file=e,this.options=t,pT.assert(e instanceof Uint8Array||!!$S().get("IS_BROWSER")&&(e instanceof File||e instanceof Blob),(()=>"FileChunkIterator only supports File, Blob and Uint8Array right now.")),this.offset=t.offset||0,this.chunkSize=t.chunkSize||1048576}summary(){return`FileChunks ${this.file}`}async next(){return this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size)?{value:null,done:!0}:{value:await new Promise(((e,t)=>{let n=this.offset+this.chunkSize;if(this.file instanceof Uint8Array)e(new Uint8Array(this.file.slice(this.offset,n)));else{let r=new FileReader;r.onload=n=>{let a=r.result;if(a instanceof ArrayBuffer&&(a=new Uint8Array(a)),!(a instanceof Uint8Array))return t(new TypeError("FileReader returned unknown type."));e(a)},r.onabort=e=>t(new Error("Aborted")),r.onerror=e=>t(new Error(e.type));let a=this.file.slice(this.offset,n);r.readAsArrayBuffer(a)}this.offset=n})),done:!1}}},BJ=e=>({method:e.method,headers:e.headers,body:e.body,mode:e.mode,credentials:e.credentials,cache:e.cache,redirect:e.redirect,referrer:e.referrer,integrity:e.integrity});function WJ(e){return"string"==typeof e&&"file://"===e.slice(0,7)}var VJ=class extends RJ{constructor(e,t={}){super(),this.input=e,this.options=t}async iterator(){if(WJ(this.input)&&$S().get("IS_NODE")){let e=kk();this.input=e.readFileSync(this.input.slice(7))}return new zJ(this.input,this.options)}},UJ=class extends RJ{constructor(e,t={}){super(),this.url=e,this.fileOptions=t}async iterator(){return WJ(this.url)?new VJ(this.url,this.fileOptions).iterator():async function(e,t={},n){let r,a;"string"==typeof e?r=e:(r=e.url,a=BJ(e));let i=await(n||pT.fetch)(r,a);if(i.ok){let e=new Uint8Array(await i.arrayBuffer());return new zJ(e,t)}throw new Error(i.statusText)}(this.url,this.fileOptions)}};function jJ(e,t={}){return new _J(new UJ(e),t)}function HJ(e){let t=JY(e);return bJ((async()=>t))}function GJ(e){return bJ((async()=>{let t=await e();return JY((()=>t.next()))}))}async function qJ(e,t){return AJ.create(e,t)}async function KJ(e){return $J.create(e)}var XJ="4.7.0";function YJ(e,t){Array.isArray(e)||(e=[e]),e.forEach((e=>{null!=e&&pT.assert("complex64"!==e.dtype,(()=>`${t} does not support complex64 tensors in the CPU backend.`))}))}var JJ=ML.whereImpl,ZJ=class extends Ak{nextDataId(){return ZJ.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new $k(this,W_())}write(e,t,n){this.firstUse&&(this.firstUse=!1,$S().get("IS_NODE")&&_P.warn("\n============================\nHi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. \n============================"));let r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:n,refCount:1}),r}makeTensorInfo(e,t,n){let r;if("string"===t&&null!=n&&n.length>0&&pT.isString(n[0])){let a=n.map((e=>pT.encodeString(e)));r=this.write(a,e,t)}else r=this.write(n,e,t);return{dataId:r,shape:e,dtype:t}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){this.data.get(e).refCount++}decRef(e){this.data.has(e)&&this.data.get(e).refCount--}move(e,t,n,r,a){this.data.set(e,{values:t,dtype:r,refCount:a})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){let{dtype:t,complexTensorInfos:n}=this.data.get(e);if("complex64"===t){let e=this.readSync(n.real.dataId),t=this.readSync(n.imag.dataId);return _P.mergeRealAndImagArrays(e,t)}return pT.convertBackendValuesAndArrayBuffer(this.data.get(e).values,t)}bufferSync(e){let t=this.readSync(e.dataId);if("string"===e.dtype)try{let n=t.map((e=>pT.decodeString(e)));return R_(e.shape,e.dtype,n)}catch(_p){throw new Error("Failed to decode encoded string bytes into utf-8")}return R_(e.shape,e.dtype,t)}makeOutput(e,t,n){return W_().makeTensorFromTensorInfo(this.makeTensorInfo(t,n,e),this)}disposeData(e,t=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!t&&this.data.get(e).refCount>0)return!1;let{complexTensorInfos:n}=this.data.get(e);null!=n&&(this.disposeData(n.real.dataId,!0),this.disposeData(n.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){let t=pT.now();return e(),{kernelMs:pT.now()-t}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){YJ([e],"where");let t=this.readSync(e.dataId);return JJ(e.shape,t)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}};ZJ.nextDataId=0;var QJ={};function eZ(e){let t=new Float32Array(e.length);for(let n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t}ok(QJ,{addImpl:()=>mZ,bincountImpl:()=>vZ,bincountReduceImpl:()=>xZ,bitwiseAndImpl:()=>wZ,castImpl:()=>dZ,ceilImpl:()=>TZ,concatImpl:()=>$Z,equalImpl:()=>AZ,expImpl:()=>FZ,expm1Impl:()=>PZ,floorDivImpl:()=>UZ,floorImpl:()=>BZ,gatherNdImpl:()=>GZ,gatherV2Impl:()=>qZ,greaterEqualImpl:()=>JZ,greaterImpl:()=>KZ,lessEqualImpl:()=>rQ,lessImpl:()=>eQ,linSpaceImpl:()=>sQ,logImpl:()=>oQ,maxImpl:()=>dQ,maximumImpl:()=>cQ,minimumImpl:()=>fQ,multiplyImpl:()=>bQ,negImpl:()=>wQ,notEqualImpl:()=>SQ,prodImpl:()=>_Q,raggedGatherImpl:()=>FQ,raggedRangeImpl:()=>OQ,raggedTensorToTensorImpl:()=>WQ,rangeImpl:()=>VQ,rsqrtImpl:()=>UQ,scatterImpl:()=>GQ,sigmoidImpl:()=>qQ,simpleAbsImpl:()=>eZ,sliceImpl:()=>YQ,sparseFillEmptyRowsImpl:()=>QQ,sparseReshapeImpl:()=>e0,sparseSegmentReductionImpl:()=>t0,sqrtImpl:()=>n0,squaredDifferenceImpl:()=>i0,staticRegexReplaceImpl:()=>l0,stridedSliceImpl:()=>c0,stringNGramsImpl:()=>h0,stringSplitImpl:()=>m0,stringToHashBucketFastImpl:()=>g0,subImpl:()=>b0,tileImpl:()=>w0,topKImpl:()=>I0,transposeImpl:()=>CQ,uniqueImpl:()=>N0});var tZ={kernelName:MS,backendName:"cpu",kernelFunc:e=>{let{x:t}=e.inputs,n=e.backend;YJ(t,"abs");let r=new Float32Array(pT.sizeFromShape(t.shape));return r=eZ(n.data.get(t.dataId).values),n.makeOutput(r,t.shape,t.dtype)}};function nZ(e){return(t,n,r,a,i)=>{let s=_P.assertAndGetBroadcastShape(t,n),o=s.length,l=pT.computeStrides(s),u=pT.sizeFromShape(s),d=pT.getTypedArrayFromDType(i,u),c=t.length,p=n.length,h=pT.computeStrides(t),f=pT.computeStrides(n),m=_P.getBroadcastDims(t,s),g=_P.getBroadcastDims(n,s);if(m.length+g.length===0)for(let b=0;b<d.length;++b)d[b]=e(r[b%r.length],a[b%a.length]);else for(let b=0;b<d.length;++b){let t=pT.indexToLoc(b,o,l),n=t.slice(-c);m.forEach((e=>n[e]=0));let i=pT.locToIndex(n,c,h),s=t.slice(-p);g.forEach((e=>s[e]=0));let u=pT.locToIndex(s,p,f);d[b]=e(r[i],a[u])}return[d,s]}}function rZ(e){let{inputs:t,backend:n}=e,{real:r,imag:a}=t,i=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,o=n.makeTensorInfo(r.shape,"complex64");return n.data.get(o.dataId).complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",i),imag:n.makeTensorInfo(a.shape,"float32",s)},o}var aZ={kernelName:lI,backendName:"cpu",kernelFunc:rZ};function iZ(e,t,n="float32"){if("complex64"===n)return rZ({inputs:{real:iZ(e,t,"float32"),imag:iZ(e,t,"float32")},backend:e});let r=pT.makeZerosTypedArray(pT.sizeFromShape(t),n);return e.makeTensorInfo(t,n,r)}function sZ(e){let{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var oZ={kernelName:JI,backendName:"cpu",kernelFunc:sZ};function lZ(e){let{inputs:t,backend:n}=e,{input:r}=t,a=n.data.get(r.dataId).complexTensorInfos.real,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}var uZ={kernelName:XN,backendName:"cpu",kernelFunc:lZ};function dZ(e,t,n,r){if("int32"===r)return[t,"int32",Int32Array.from(e)];if("bool"===r){let r=pT.toTypedArray([0],n),[a,i]=nZ(((e,t)=>e!==t?1:0))(t,[],e,r,"bool");return[i,"bool",a]}throw new Error(`Error in Cast: failed to cast ${n} to ${r}`)}function cZ(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{dtype:i}=r;if("complex64"===i){if("complex64"===a.dtype)return sZ({inputs:{x:a},backend:n});let e=iZ(n,a.shape,a.dtype),t=cZ({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),r=rZ({inputs:{real:t,imag:e},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),r}if("complex64"===a.dtype){let e=lZ({inputs:{input:a},backend:n}),t=cZ({inputs:{x:e},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(e),t}if(!pT.hasEncodingLoss(a.dtype,i)){let e=sZ({inputs:{x:a},backend:n});return{dataId:e.dataId,shape:e.shape,dtype:i}}let s=n.data.get(a.dataId).values,[o,l,u]=dZ(s,a.shape,a.dtype,i);return n.makeTensorInfo(o,l,u)}var pZ={kernelName:iI,backendName:"cpu",kernelFunc:cZ};function hZ(e,t,n,r){return null==n?({inputs:n,backend:a})=>{let{a:i,b:s}=n,o=a;YJ([i,s],e);let l=o.data.get(i.dataId).values,u=o.data.get(s.dataId).values,d="string"===i.dtype?_P.fromUint8ToStringArray(l):l,c="string"===i.dtype?_P.fromUint8ToStringArray(u):u,p=r||i.dtype,[h,f]=t(i.shape,s.shape,d,c,p);return o.makeTensorInfo(f,p,h)}:({inputs:e,backend:a})=>{let{a:i,b:s}=e,o=a;if("complex64"===i.dtype||"complex64"===s.dtype){let e=cZ({inputs:{x:i},backend:o,attrs:{dtype:"complex64"}}),t=o.data.get(e.dataId),r=t.complexTensorInfos.real,a=t.complexTensorInfos.imag,l=o.data.get(r.dataId).values,u=o.data.get(a.dataId).values,d=cZ({inputs:{x:s},backend:o,attrs:{dtype:"complex64"}}),c=o.data.get(d.dataId),p=c.complexTensorInfos.real,h=c.complexTensorInfos.imag,f=o.data.get(p.dataId).values,m=o.data.get(h.dataId).values,[g,b,y]=n(i.shape,s.shape,l,u,f,m),v=o.makeTensorInfo(y,"float32",g),x=o.makeTensorInfo(y,"float32",b),w=rZ({inputs:{real:v,imag:x},backend:o});return o.disposeIntermediateTensorInfo(e),o.disposeIntermediateTensorInfo(d),o.disposeIntermediateTensorInfo(v),o.disposeIntermediateTensorInfo(x),w}{let e=o.data.get(i.dataId).values,n=o.data.get(s.dataId).values,a=r||i.dtype,[l,u]=t(i.shape,s.shape,e,n,a);return o.makeTensorInfo(u,a,l)}}}function fZ(e){return(t,n,r,a,i,s)=>{let o=_P.assertAndGetBroadcastShape(t,n),l=pT.sizeFromShape(o),u=o.length,d=pT.computeStrides(o),c=pT.getTypedArrayFromDType("float32",l),p=pT.getTypedArrayFromDType("float32",l),h=_P.getBroadcastDims(t,o),f=_P.getBroadcastDims(n,o),m=_P.mergeRealAndImagArrays(r,a),g=_P.mergeRealAndImagArrays(i,s),b=t.length,y=pT.computeStrides(t),v=n.length,x=pT.computeStrides(n);if(h.length+f.length===0)for(let w=0;w<c.length;w++){let t=w%m.length,n=w%g.length,r=e(m[2*t],m[2*t+1],g[2*n],g[2*n+1]);c[w]=r.real,p[w]=r.imag}else for(let w=0;w<c.length;w++){let t=pT.indexToLoc(w,u,d),n=t.slice(-b);h.forEach((e=>n[e]=0));let r=pT.locToIndex(n,b,y),a=t.slice(-v);f.forEach((e=>a[e]=0));let i=pT.locToIndex(a,v,x),s=e(m[2*r],m[2*r+1],g[2*i],g[2*i+1]);c[w]=s.real,p[w]=s.imag}return[c,p,o]}}var mZ=nZ(((e,t)=>e+t)),gZ=fZ(((e,t,n,r)=>({real:e+n,imag:t+r}))),bZ=hZ(LS,mZ,gZ),yZ={kernelName:LS,backendName:"cpu",kernelFunc:bZ};function vZ(e,t,n,r,a){let i=pT.sizeFromShape(r),s=pT.makeZerosTypedArray(a,n);for(let o=0;o<e.length;o++){let n=e[o];if(n<0)throw new Error("Input x must be non-negative!");n>=a||(s[n]+=i>0?t[o]:1)}return s}function xZ(e,t,n,r=!1){let a=e.shape[0],i=e.shape[1],s=R_([a,n],t.dtype);for(let o=0;o<a;o++)for(let a=0;a<i;a++){let i=e.get(o,a);if(i<0)throw new Error("Input x must be non-negative!");i>=n||(r?s.set(1,o,i):t.size>0?s.set(s.get(o,i)+t.get(o,a),o,i):s.set(s.get(o,i)+1,o,i))}return s}var wZ=nZ(((e,t)=>e&t)),kZ=hZ(nI,wZ),SZ={kernelName:nI,backendName:"cpu",kernelFunc:kZ};function IZ(e){return(t,n,r)=>{let a=pT.getArrayFromDType(n,t.length);for(let i=0;i<t.length;++i)a[i]=e(t[i],r);return a}}function NZ(e,t,n){return CZ(e,IZ(t),n)}function CZ(e,t,n){return({inputs:r,attrs:a,backend:i})=>{let{x:s}=r;YJ(s,e);let o,l=i,u=l.data.get(s.dataId).values;if("string"===s.dtype){if(!Array.isArray(u))throw new Error("String tensor's value was not an instance of Array");o=_P.fromUint8ToStringArray(u)}else o=u;let d=n||s.dtype,c=t(o,d,a);return l.makeTensorInfo(s.shape,d,c)}}var TZ=IZ((e=>Math.ceil(e))),EZ=CZ(sI,TZ),_Z={kernelName:sI,backendName:"cpu",kernelFunc:EZ};function $Z(e,t,n,r){let a=pT.getArrayFromDType(n,pT.sizeFromShape(t));if(r&&"string"!==n){let t=0;e.forEach((e=>{let n=pT.sizeFromShape(e.shape);a.set(e.vals,t),t+=n}))}else{let r=0;e.forEach((e=>{let i="string"===n?_P.fromUint8ToStringArray(e.vals):e.vals,s=0;for(let n=0;n<e.shape[0];++n){let o=n*t[1]+r;for(let t=0;t<e.shape[1];++t)a[o+t]=i[s++]}r+=e.shape[1]}))}return a}var AZ=nZ(((e,t)=>e===t?1:0)),RZ=hZ(PI,AZ,null,"bool"),DZ={kernelName:PI,backendName:"cpu",kernelFunc:RZ},FZ=IZ((e=>Math.exp(e))),MZ=CZ(LI,FZ,"float32"),OZ={kernelName:LI,backendName:"cpu",kernelFunc:MZ},PZ=IZ((e=>Math.expm1(e))),LZ=CZ(BI,PZ),zZ={kernelName:BI,backendName:"cpu",kernelFunc:LZ},BZ=IZ((e=>Math.floor(e))),WZ=CZ(jI,BZ),VZ={kernelName:jI,backendName:"cpu",kernelFunc:WZ},UZ=nZ(((e,t)=>Math.floor(e/t))),jZ=hZ(HI,UZ,null,"int32"),HZ={kernelName:HI,backendName:"cpu",kernelFunc:jZ};function GZ(e,t,n,r,a,i,s,o,l){let u=R_([r,i],n);for(let d=0;d<r;d++){let n=[],r=0;for(let t=0;t<a;t++){let i=e[d*a+t];r+=i*s[t],n.push(i)}if(r<0||r>=l/i)throw new Error(`Invalid indices: ${n} does not index into ${o}`);for(let e=0;e<i;e++)u.values[d*i+e]=t.get(...t.indexToLoc(r*i+e))}return u}function qZ(e,t,n){let r=R_(n,e.dtype);for(let a=0;a<r.size;++a){let n=r.indexToLoc(a).slice(),i=n[0],s=n[2],o=t.locToIndex([i,s]);n[2]=t.values[o];let l=e.locToIndex(n);0<=l&&l<e.values.length&&(r.values[a]=e.values[l])}return r}var KZ=nZ(((e,t)=>e>t?1:0)),XZ=hZ(XI,KZ,null,"bool"),YZ={kernelName:XI,backendName:"cpu",kernelFunc:XZ},JZ=nZ(((e,t)=>e>=t?1:0)),ZZ=hZ(YI,JZ,null,"bool"),QZ={kernelName:YI,backendName:"cpu",kernelFunc:ZZ},eQ=nZ(((e,t)=>e<t?1:0)),tQ=hZ(aN,eQ,null,"bool"),nQ={kernelName:aN,backendName:"cpu",kernelFunc:tQ},rQ=nZ(((e,t)=>e<=t?1:0)),aQ=hZ(iN,rQ,null,"bool"),iQ={kernelName:iN,backendName:"cpu",kernelFunc:aQ};function sQ(e,t,n){let r=(t-e)/(n-1),a=pT.makeZerosTypedArray(n,"float32");a[0]=e;for(let i=1;i<a.length;i++)a[i]=a[i-1]+r;return a}var oQ=IZ((e=>Math.log(e))),lQ=CZ(oN,oQ),uQ={kernelName:oN,backendName:"cpu",kernelFunc:lQ};function dQ(e,t,n,r){let a=pT.getTypedArrayFromDType(r,pT.sizeFromShape(n));for(let i=0;i<a.length;++i){let n=i*t,r=e[n];for(let a=0;a<t;++a){let t=e[n+a];(Number.isNaN(t)||t>r)&&(r=t)}a[i]=r}return a}var cQ=nZ(((e,t)=>Math.max(e,t))),pQ=hZ(vN,cQ),hQ={kernelName:vN,backendName:"cpu",kernelFunc:pQ},fQ=nZ(((e,t)=>Math.min(e,t))),mQ=hZ(TN,fQ),gQ={kernelName:TN,backendName:"cpu",kernelFunc:mQ},bQ=nZ(((e,t)=>e*t)),yQ=fZ(((e,t,n,r)=>({real:e*n-t*r,imag:e*r+t*n}))),vQ=hZ(AN,bQ,yQ),xQ={kernelName:AN,backendName:"cpu",kernelFunc:vQ};function wQ(e,t,n){let r=pT.createScalarValue(-1,n);return bQ([],t,r,e,n)}var kQ={kernelName:RN,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{x:r}=t;YJ(r,"neg");let a=n.data.get(r.dataId).values,[i,s]=wQ(a,r.shape,r.dtype);return n.makeTensorInfo(s,r.dtype,i)}},SQ=nZ(((e,t)=>e!==t?1:0)),IQ=hZ(DN,SQ,null,"bool"),NQ={kernelName:DN,backendName:"cpu",kernelFunc:IQ};function CQ(e,t,n,r,a){let i=t.length,s=pT.sizeFromShape(t),o=pT.computeStrides(t),l=pT.computeStrides(a),u=pT.getTypedArrayFromDType(n,pT.sizeFromShape(a));for(let d=0;d<s;++d){let t=pT.indexToLoc(d,i,o),n=new Array(t.length);for(let e=0;e<n.length;e++)n[e]=t[r[e]];u[pT.locToIndex(n,i,l)]=e[d]}return u}function TQ(e){let{inputs:t,attrs:n,backend:r}=e,{x:a}=t,{perm:i}=n;YJ(a,"transpose");let s=a.shape.length,o=new Array(s);for(let u=0;u<o.length;u++)o[u]=a.shape[i[u]];let l=CQ(r.data.get(a.dataId).values,a.shape,a.dtype,i,o);return{dataId:r.write(l,o,a.dtype),shape:o,dtype:a.dtype}}var EQ={kernelName:WC,backendName:"cpu",kernelFunc:TQ};function _Q(e,t,n,r){let[a,i]=_P.computeOutAndReduceShapes(e,r),s=iE(t,"int32"),o=pT.makeZerosTypedArray(pT.sizeFromShape(a),s),l=pT.sizeFromShape(i);for(let u=0;u<o.length;++u){let e=u*l,t=1;for(let r=0;r<l;++r)t*=n[e+r];o[u]=t}return{outVals:o,outShape:a,outDtype:s}}var $Q={kernelName:jN,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:s}=r;YJ(a,"prod");let o=a.shape.length,l=pT.parseAxisParam(i,a.shape),u=_P.getAxesPermutation(l,o),d=l,c=a,p=[];null!=u&&(c=TQ({inputs:{x:a},backend:n,attrs:{perm:u}}),p.push(c),d=_P.getInnerMostAxes(d.length,o));let h=n.data.get(c.dataId).values,{outVals:f,outShape:m,outDtype:g}=_Q(c.shape,c.dtype,h,d),b=m;return s&&(b=_P.expandShapeToKeepDim(m,l)),p.forEach((e=>n.disposeIntermediateTensorInfo(e))),n.makeTensorInfo(b,g,f)}};function AQ(e,t,n,r){let a=[],i=0,s=t.length-1+n.length,o=new Array(s).fill(null).map((()=>[0]));!function(e,t){for(let n=0;n<e.length;++n){let r=e[n],a=n===e.length-1?t:e[n+1].length;if(0===r.length)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>a)throw new Error("Ragged splits must not point past values");for(let e=1;e<r.length;++e)if(r[e-1]>r[e])throw new Error("Ragged splits must be sorted in ascending order")}}(n,r);let l=1;for(let u=0;u<t.length-1;++u){l*=t[u];let e=t[u+1];for(let t=1;t<l+1;++t)o[u].push(t*e)}for(let u=0;u<e.length;++u){let r=e[u],s=e[u]+1;for(let e=0;e<n.length;++e){let a=n[e],i=e+t.length-1;if(i>=0){let e=o[i],t=e[e.length-1]-a[r];for(let n=r;n<s;++n)o[i].push(a[n+1]+t)}r=a[r],s=a[s]}s!==r&&(a.push([r,s]),i+=s-r)}return{outSplits:o,valueSlices:a,numValues:i}}function RQ(e,t){let n=e.slice(0,t);for(;n.length<t;)n.push(1);for(let r=t;r<e.length;r++)n[t-1]*=e[r];return n}function DQ(e,t,n,r,a){let i=t.slice();i[0]=a;let s=pT.getArrayFromDType(n,pT.sizeFromShape(i)),o=e.length;return function(e,t,n,r,a,i){let s=RQ(t,2)[1],o=RQ(i,2)[1],l=0;for(let u of n)for(let t=u[0];t<u[1];++t){for(let n=0;n<r;++n)a[l*o+n]=e[t*s+n];++l}}(e,t,r,0===o?0:o/t[0],s,i),[s,i]}function FQ(e,t,n,r,a,i,s,o){if(0===e.length)throw new Error("paramsNestedSplits must be non empty");if(0===t[0].length)throw new Error("Split tensors must not be scalars");if(function(e,t,n){e.forEach(((e,r)=>{if(e<0||e>=n){let a=pT.indexToLoc(r,t.length,pT.computeStrides(t)).join(",");throw new Error(`indices[${a}] = ${e} is not in [0, ${n})`)}}))}(i,s,t[0][0]-1),0===r.length)throw new Error("params.rank must be nonzero");let l=r[0],{outSplits:u,valueSlices:d,numValues:c}=AQ(i,s,e,l),p=function(e){let t=[];for(let n=0;n<e.length;++n){let r=e[n].length,a=pT.getArrayFromDType("int32",r);t.push(a),e[n].forEach(((e,t)=>a[t]=e))}return t}(u),h=DQ(n,r,a,d,c);return[p,h[0],h[1]]}var MQ=2147483647;function OQ(e,t,n,r,a,i,s){if(t.length>1)throw new Error("starts must be a scalar or vector");if(a.length>1)throw new Error("limits must be a scalar or vector");if(s.length>1)throw new Error("deltas must be a scalar or vector");let o=0===t.length,l=0===a.length,u=0===s.length,d=[];o||d.push(t[0]),l||d.push(a[0]),u||d.push(s[0]);for(let g=1;g<d.length;++g)if(d[g]!==d[g-1])throw new Error("starts, limits, and deltas must have the same shape");let c=0===d.length?1:d[0],p=pT.getArrayFromDType("int32",c+1);p[0]=0;for(let g=0;g<c;++g){let t,n=o?e[0]:e[g],a=l?r[0]:r[g],s=u?i[0]:i[g];if(0===s)throw new Error("Requires delta != 0");if(s>0&&a<n||s<0&&a>n)t=0;else if(t=Math.ceil(Math.abs((a-n)/s)),t>MQ)throw new Error(`Requires ((limit - start) / delta) <= ${MQ}`);p[g+1]=p[g]+t}let h=p[c],f=pT.getArrayFromDType(n,h),m=0;for(let g=0;g<c;++g){let t=p[g+1]-p[g],n=o?e[0]:e[g],r=u?i[0]:i[g];for(let e=0;e<t;++e)f[m++]=n,n+=r}return[p,f]}var PQ=_P.RowPartitionType,LQ=class{constructor(e,t,n,r,a,i,s,o,l,u){this.shape=e,this.shapeShape=t,this.values=n,this.valuesShape=r,this.valuesDType=a,this.defaultValue=i,this.defaultValueShape=s,this.rowPartitionValues=o,this.rowPartitionValuesShapes=l,this.rowPartitionTypes=_P.getRowPartitionTypesHelper(u),this.raggedRank=_P.getRaggedRank(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===PQ.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===PQ.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){let t=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case PQ.VALUE_ROWIDS:return LQ.getMaxWidthValueRowID(t);case PQ.ROW_SPLITS:return LQ.getMaxWidthRowSplit(t);default:throw new Error(`Cannot handle partition type ${PQ[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){let t=e.length;if(0===t||1===t)return 0;let n=0;for(let r=0;r<t-1;++r){let t=e[r+1]-e[r];t>n&&(n=t)}return n}static getMaxWidthValueRowID(e){let t=e.length;if(0===t)return 0;let n=0,r=e[0],a=0;for(let i=1;i<t;++i){let t=e[i];t!==r&&(r=t,a=Math.max(i-n,a),n=i)}return Math.max(t-n,a)}tensorShapeFromTensor(e,t,n=!0){if(0===t.length){if(-1===e[0])return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return BQ(e,n)}calculateOutputSize(e){let t=this.valuesShape,n=this.defaultValueShape;_P.validateDefaultValueShape(n,t);let r=this.tensorShapeFromTensor(this.shape,this.shapeShape),a=_P.combineRaggedTensorToTensorShapes(this.raggedRank,r,t);a[0]<0&&(a[0]=e);for(let i=1;i<=this.raggedRank;++i)a[i]<0&&(a[i]=this.getMaxWidth(i));return a}calculateFirstParentOutputIndex(e,t,n){let r=Math.min(e,n),a=[],i=0;for(let s=0;s<r;++s,i+=t)a.push(i);for(let s=r;s<e;++s)a.push(-1);return pT.assert(a.length===e,(()=>"Final length of result must be equal to firstDimension.")),a}calculateOutputIndexRowSplit(e,t,n,r){let a=e.length,i=[];for(let s=0;s<a-1;++s){let a=e[s+1]-e[s],o=Math.min(r,a),l=t[s];-1===l&&(o=0);for(let e=0;e<o;++e)i.push(l),l+=n;for(let e=0;e<a-o;++e)i.push(-1)}if(a>0&&i.length!==e[a-1])throw new Error("Invalid row split size.");return i}calculateOutputIndexValueRowID(e,t,n,r){let a=e.length,i=[];if(0===a)return[];let s=0,o=e[0];if(o>=t.length)throw new Error(`Got currentValueRowId=${o}, which is not less than ${t.length}`);let l=t[o];i.push(l);for(let u=1;u<a;++u){let a=e[u];if(a===o)l>=0&&(++s,s<r?l+=n:l=-1);else{if(s=0,o=a,a>=t.length)throw new Error(`Got nextValueRowId=${a} which is not less than ${t.length}`);l=t[a]}i.push(l)}if(i.length!==e.length)throw new Error("Invalid row ids.");return i}calculateOutputIndex(e,t,n,r){let a=this.getRowPartitionTensor(e),i=this.getRowPartitionTypeByDimension(e);switch(i){case PQ.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(a,t,n,r);case PQ.ROW_SPLITS:if(a.length-1>t.length)throw new Error(`Row partition size is greater than output size: ${a.length-1} > ${t.length}`);return this.calculateOutputIndexRowSplit(a,t,n,r);default:throw new Error(`Unsupported partition type: ${PQ[i]}`)}}getFirstDimensionSize(){let e=this.rowPartitionValues[0];if(0===this.rowPartitionTypes.length)throw new Error("No row_partition_types given.");let t=this.rowPartitionTypes[0];switch(t){case PQ.FIRST_DIM_SIZE:return e[0];case PQ.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case PQ.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${PQ[t]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");let e=this.getFirstDimensionSize(),t=this.calculateOutputSize(e),n=new Array(this.raggedRank+1);n[n.length-1]=1;for(let i=n.length-2;i>=0;--i)n[i]=n[i+1]*t[i+1];let r=BQ(t,!1),a=pT.getArrayFromDType(this.valuesDType,pT.sizeFromShape(r));if(n[0]*t[0]>0){let i=this.calculateFirstParentOutputIndex(e,n[0],t[0]);for(let e=1;e<=this.raggedRank;++e)i=this.calculateOutputIndex(e-1,i,n[e],t[e]);this.setOutput(this.raggedRank,i,a,r)}return[r,a]}setOutput(e,t,n,r){if(0===n.length)return;let a=this.values,i=n,s=r.slice();s=s.slice(e+1);let o=pT.sizeFromShape(s),l=t.length,u=this.defaultValue;if(u.length!==o&&1!==u.length){let e=this.defaultValueShape;j_((()=>{let t=M$(u,e);u=Q$(t,s).dataSync()}))}let d=0,c=0,p=0;for(let h=0;h<=l;++h){let e=h<l?t[h]:-1;if(e!==p){if(c<p){let e=a.subarray(d*o);zQ(i.subarray(c*o),e,(p-c)*o)}if(h>=l){let t=n.length;e=Math.floor(t/o)}if(e>p)if(1===this.defaultValue.length)i.subarray(p*o,e*o).fill(this.defaultValue[0]),p=e;else for(;e>p;)zQ(i.slice(p*o),u,o),++p;e<0?(d=h+1,c=p):(d=h,c=p,p=c+1)}else++p}}};function zQ(e,t,n){for(let r=0;r<n;r++)e[r]=t[r]}function BQ(e,t){let n=[];for(let r of e){if(r<0){if(!t)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}n.push(r)}return n}function WQ(e,t,n,r,a,i,s,o,l,u){return new LQ(e,t,n,r,a,i,s,o,l,u).compute()}function VQ(e,t,n,r){if(e===t||e<t&&n<0||t<e&&n>1)return pT.makeZerosTypedArray(0,r);let a=Math.abs(Math.ceil((t-e)/n)),i=pT.makeZerosTypedArray(a,r);t<e&&1===n&&(n=-1),i[0]=e;for(let s=1;s<i.length;s++)i[s]=i[s-1]+n;return i}var UQ=IZ((e=>1/Math.sqrt(e))),jQ=CZ(sC,UQ),HQ={kernelName:sC,backendName:"cpu",kernelFunc:jQ};function GQ(e,t,n,r,a,i,s,o,l,u){let d=[r/a,a],c=e.values,p=t.values;if(0===r)return R_(n,t.dtype);let h=l instanceof GT?l:R_(d,t.dtype);"string"==typeof l||"number"==typeof l?h.values.fill(l):"boolean"==typeof l&&h.values.fill(+l);for(let f=0;f<i;f++){let e=[],i=0;for(let t=0;t<s;t++){let n=c[f*s+t];e.push(n),i+=n*o[t]}if(i<0||i>=r/a)throw new Error(`Invalid indices: ${e} does not index into ${n}`);for(let n=0;n<a;n++)u?h.values[i*a+n]+=p[f*a+n]:h.values[i*a+n]=0===t.rank?p[0]:p[f*a+n]}return h}var qQ=IZ((e=>1/(1+Math.exp(-e)))),KQ=NZ(gC,(e=>1/(1+Math.exp(-e)))),XQ={kernelName:gC,backendName:"cpu",kernelFunc:KQ};function YQ(e,t,n,r,a){let i=rP.isSliceContinous(r,t,n),s=pT.sizeFromShape(n),o=pT.computeStrides(r);if(i){let n=rP.computeFlatOffset(t,o);return"string"===a?e.slice(n,n+s):e.subarray(n,n+s)}let l=R_(r,a,"string"===a?_P.fromUint8ToStringArray(e):e),u=R_(n,a);for(let d=0;d<u.size;++d){let e=u.indexToLoc(d),n=e.map(((e,n)=>e+t[n]));u.set(l.get(...n),...e)}return"string"===a?_P.fromStringArrayToUint8(u.values):u.values}function JQ(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{begin:i,size:s}=r;YJ(a,"slice");let[o,l]=rP.parseSliceParams(a,i,s);rP.assertParamsValid(a,o,l);let u=YQ(n.data.get(a.dataId).values,o,l,a.shape,a.dtype);return n.makeTensorInfo(l,a.dtype,u)}var ZQ={kernelName:pC,backendName:"cpu",kernelFunc:JQ};function QQ(e,t,n,r,a,i,s){let o=t[0],l=i[0],u=new Array(l),d=new Array(o),c=t[1];if(0===l){if(0!==o)throw new Error(_P.getSparseFillEmptyRowsIndicesDenseShapeMismatch(o));return[pT.getArrayFromDType(n,0),[0,c],pT.getArrayFromDType(a,0),u,d]}let p=!0,h=0,f=new Array(l).fill(0);for(let g=0;g<o;++g){let t=e[g*c];if(t<0)throw new Error(_P.getSparseFillEmptyRowsNegativeIndexErrorMessage(g,t));if(t>=l)throw new Error(_P.getSparseFillEmptyRowsOutOfRangeIndexErrorMessage(g,t,l));++f[t],p=p&&t>=h,h=t}let m=!0;for(let g=0;g<l;++g){let e=0===f[g];u[g]=e,m=m&&!e,f[g]=Math.max(f[g],1),g>0&&(f[g]+=f[g-1])}if(m&&p){let t=e,n=r;for(let e=0;e<o;++e)d[e]=e;return[t,[o,c],n,u,d]}{let t=f[l-1],i=pT.getArrayFromDType(n,t*c),p=pT.getArrayFromDType(a,t),h=new Array(l).fill(0);for(let n=0;n<o;++n){let t=e[n*c],a=h[t],s=(0===t?0:f[t-1])+a;h[t]++;for(let r=0;r<c;++r)i[s*c+r]=e[n*c+r];p[s]=r[n],d[n]=s}for(let e=0;e<l;++e)if(0===h[e]){let t=0===e?0:f[e-1];i[t*c+0]=e;for(let e=1;e<c;++e)i[t*c+e]=0;p[t]=s}return[i,[t,c],p,u,d]}}function e0(e,t,n,r,a){let i=pT.sizeFromShape(r),s=t[0],o=a.length,l=[],u=1,d=-1;for(let m=0;m<o;++m){let e=a[m];if(-1===e){if(-1!==d)throw new Error(_P.getSparseReshapeMultipleNegativeOneOutputDimErrorMessage(d,m));d=m,l.push(1)}else{if(e<0)throw new Error(_P.getSparseReshapeNegativeOutputDimErrorMessage(m,e));u*=e,l.push(e)}}if(-1!==d){if(u<=0)throw new Error(_P.getSparseReshapeEmptyTensorZeroOutputDimErrorMessage());let e=Math.trunc(i/u);if(u*e!==i)throw new Error(_P.getSparseReshapeInputOutputMultipleErrorMessage(r,l));l[d]=e}if(pT.sizeFromShape(l)!==i)throw new Error(_P.getSparseReshapeInputOutputMismatchErrorMessage(r,l));let c=r.length,p=[];if(c>0){p[c-1]=1;for(let e=c-2;e>=0;--e)p[e]=p[e+1]*r[e+1]}let h=[];if(o>0){h[o-1]=1;for(let e=o-2;e>=0;--e)h[e]=h[e+1]*l[e+1]}let f=pT.getArrayFromDType(n,s*o);for(let m=0;m<s;++m){let t=0;for(let n=0;n<c;++n)t+=e[m*c+n]*p[n];for(let e=0;e<o;++e)f[m*o+e]=Math.trunc(t/h[e]),t%=h[e]}return[f,[s,o],l]}function t0(e,t,n,r,a,i=!1,s=0){let o=r.length,l=[t[0],e.length/t[0]],u=l[1],d=o>0?a[o-1]+1:0;if(d<0)throw new Error(_P.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let c=t.slice();c[0]=d;let p=c.reduce(((e,t)=>e*t),1),h=pT.getArrayFromDType(n,p);if(0===o)return d>0&&h.fill(s),[h,c];if(d<=0)throw new Error(_P.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let f=0,m=1,g=0,b=a[f];for(;;){let t=0;if(m<o){if(t=a[m],b===t){++m;continue}if(b>=t)throw new Error(_P.getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage())}if(b<0||b>=d)throw new Error(_P.getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage(b,d));b>g&&h.fill(s,g*u,b*u);for(let n=f;n<m;++n){let t=r[n];if(t<0||t>=l[0])throw new Error(_P.getSparseSegmentReductionIndicesOutOfRangeErrorMessage(n,r[n],l[0]));for(let n=0;n<u;n++)h[b*u+n]+=e[t*u+n]}if(i)for(let e=0;e<u;e++)h[b*u+e]/=m-f;if(f=m,++m,g=b+1,b=t,m>o)break}return g<d&&h.fill(s,g*u,d*u),[h,c]}var n0=IZ((e=>Math.sqrt(e))),r0=NZ(yC,(e=>Math.sqrt(e))),a0={kernelName:yC,backendName:"cpu",kernelFunc:r0},i0=nZ(((e,t)=>{let n=e-t;return n*n})),s0=hZ(EC,i0),o0={kernelName:EC,backendName:"cpu",kernelFunc:s0},l0=IZ(((e,t)=>{let{pattern:n,replaceGlobal:r,rewrite:a}=t;return e.replace(new RegExp(n,r?"g":""),a)})),u0=CZ($C,l0),d0={kernelName:$C,backendName:"cpu",kernelFunc:u0};function c0(e,t,n,r){let a=R_(e,t.dtype);for(let i=0;i<a.size;i++){let e=a.indexToLoc(i),s=new Array(e.length);for(let t=0;t<s.length;t++)s[t]=e[t]*n[t]+r[t];a.set(t.get(...s),...e)}return a}var p0=class{constructor(e,t,n,r,a,i){this.separator=pT.encodeString(e),this.nGramWidths=t,this.leftPad=pT.encodeString(n),this.rightPad=pT.encodeString(r),this.padWidth=a,this.preserveShort=i}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){let n=this.getPadWidth(t);return Math.max(0,e+2*n-t+1)}createNGrams(e,t,n,r,a,i){for(let s=0;s<a;++s){let o=this.getPadWidth(i),l=Math.max(0,o-s),u=Math.max(0,o-(a-(s+1))),d=i-(l+u),c=t+(l>0?0:s-o),p=0;p+=l*this.leftPad.length;for(let t=0;t<d;++t)p+=e[c+t].length;p+=u*this.rightPad.length,p+=(l+u+d-1)*this.separator.length,n[r+s]=new Uint8Array(p);let h=n[r+s],f=0,m=e=>e.forEach((e=>h[f++]=e));for(let e=0;e<l;++e)m(this.leftPad),m(this.separator);for(let t=0;t<d-1;++t)m(e[c+t]),m(this.separator);if(d>0){m(e[c+d-1]);for(let e=0;e<u;++e)m(this.separator),m(this.rightPad)}else{for(let e=0;e<u-1;++e)m(this.rightPad),m(this.separator);m(this.rightPad)}}}compute(e,t){let n=e.length,r=t.length;if(r>0){let e=t[0];if(0!==e)throw new Error(`First split value must be 0, got ${e}`);for(let a=1;a<r;++a){let r=t[a]>=e;if(r=r&&t[a]<=n,!r)throw new Error(`Invalid split value ${t[a]}, must be in [${e}, ${n}]`);e=t[a]}if(e!==n)throw new Error(`Last split value must be data size. Expected ${n}, got ${e}`)}let a=r-1,i=pT.getArrayFromDType("int32",r);if(0===n||0===r){let e=new Array(n);for(let t=0;t<=a;++t)i[t]=0;return[e,i]}i[0]=0;for(let o=1;o<=a;++o){let e=t[o]-t[o-1],n=0;this.nGramWidths.forEach((t=>{n+=this.getNumNGrams(e,t)})),this.preserveShort&&e>0&&0===n&&(n=1),i[o]=i[o-1]+n}let s=new Array(i[a]);for(let o=0;o<a;++o){let n=t[o],r=i[o];if(this.nGramWidths.forEach((a=>{let i=t[o+1]-t[o],l=this.getNumNGrams(i,a);this.createNGrams(e,n,s,r,l,a),r+=l})),this.preserveShort&&r===i[o]){let a=t[o+1]-t[o];if(0===a)continue;let i=a+2*this.padWidth,l=1;this.createNGrams(e,n,s,r,l,i)}}return[s,i]}};function h0(e,t,n,r,a,i,s,o){return new p0(n,r,a,i,s,o).compute(e,t)}function f0(e,t,n,r){if(!e.length)return;if(0===t.length){for(let t=0;t<e.length;++t)r.push(e.subarray(t,t+1));return}if(1===t.length){let a=t[0],i=e.indexOf(a);for(;-1!==i;){let t=e.subarray(0,i);(!n||0!==t.length)&&r.push(t),i=(e=e.subarray(i+1)).indexOf(a)}return void((!n||0!==e.length)&&r.push(e))}let a=0;for(let i=0;i<e.length+1;i++)if(i===e.length||-1!==t.indexOf(e[i])){let t=e.subarray(a,i);(!n||0!==t.length)&&r.push(t),a=i+1}}function m0(e,t,n){let r=e.length,a=[],i=0,s=0,o=new Array(r);for(let p=0;p<r;++p){let r=a.length;f0(e[p],t,n,a);let l=a.length-r;o[p]=l,i+=l,s=Math.max(s,l)}let l=pT.getArrayFromDType("int32",2*i),u=new Array(i),d=[r,s],c=0;for(let p=0;p<r;++p)for(let e=0;e<o[p];++e)l[2*c]=p,l[2*c+1]=e,u[c]=a[c],++c;return[l,u,d]}function g0(e,t){let n=pT.getArrayFromDType("int32",e.length);for(let r=0;r<e.length;++r)n[r]=pT.fingerPrint64(e[r]).modulo(t).getLowBitsUnsigned();return n}var b0=nZ(((e,t)=>e-t)),y0=fZ(((e,t,n,r)=>({real:e-n,imag:t-r}))),v0=hZ(MC,b0,y0),x0={kernelName:MC,backendName:"cpu",kernelFunc:v0};function w0(e,t){let n=new Array(e.rank);for(let a=0;a<n.length;a++)n[a]=e.shape[a]*t[a];let r=R_(n,e.dtype);for(let a=0;a<r.values.length;++a){let t=r.indexToLoc(a),n=new Array(e.rank);for(let r=0;r<n.length;r++)n[r]=t[r]%e.shape[r];let i=e.locToIndex(n);r.values[a]=e.values[i]}return r}var k0=(e,t)=>{let n=t.value-e.value;return 0===n?e.index-t.index:n};function S0(e,t,n=0,r=e.length-1){for(;r>n;){if(r-n>600){let a=r-n+1,i=t-n+1,s=Math.log(a),o=.5*Math.exp(2*s/3),l=.5*Math.sqrt(s*o*(a-o)/a)*Math.sign(i-a/2);S0(e,t,Math.max(n,Math.floor(t-i*o/a+l)),Math.min(r,Math.floor(t+(a-i)*o/a+l)))}let a=e[t],i=n,s=r;for(pT.swap(e,n,t),k0(e[r],a)>0&&pT.swap(e,n,r);i<s;){for(pT.swap(e,i,s),i++,s--;k0(e[i],a)<0;)i+=1;for(;k0(e[s],a)>0;)s-=1}0===k0(e[n],a)?pT.swap(e,n,s):(s+=1,pT.swap(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}}function I0(e,t,n,r,a){let i=t[t.length-1],[s,o]=[e.length/i,i],l=pT.getTypedArrayFromDType(n,s*r),u=pT.getTypedArrayFromDType("int32",s*r);for(let c=0;c<s;c++){let t=c*o,n=e.subarray(t,t+o),i=new Array(n.length);n.forEach(((e,t)=>i[t]={value:e,index:t})),r<i.length&&(S0(i,r),i=i.slice(0,r)),a&&i.sort(k0);let s=c*r,d=l.subarray(s,s+r),p=u.subarray(s,s+r);for(let e=0;e<r;e++)d[e]=i[e].value,p[e]=i[e].index}let d=t.slice();return d[d.length-1]=r,[R_(d,n,l),R_(d,"int32",u)]}function N0(e,t,n,r){let a=pT.parseAxisParam(t,n)[0],i=[1,n[0],1];for(let f=0;f<a;f++)i[0]*=n[f];i[1]=n[a];for(let f=a+1;f<n.length;f++)i[2]*=n[f];let s=new Map,o=new Int32Array(n[a]),l=new GT(i,r,e),u=[],d=1===i[0]&&1===i[2];for(let f=0;f<n[a];f++){let t;if(d)t=e[f].toString();else{let e=[];for(let t=0;t<i[0];t++)for(let n=0;n<i[2];n++)e.push(l.get(t,f,n));t=e.join(",")}let n=s.get(t);if(null!=n)o[f]=n;else{let e=s.size;s.set(t,e),o[f]=e,u.push(f)}}let c=i.slice();c[1]=s.size;let p=new GT(c,r);u.forEach(((e,t)=>{for(let n=0;n<i[0];n++)for(let r=0;r<i[2];r++)p.set(l.get(n,e,r),n,t,r)}));let h=n.slice();return h[a]=c[1],{outputValues:p.values,outputShape:h,indices:o}}var C0="4.7.0";e$("cpu",(()=>new ZJ),1);var T0=NZ(FI,(e=>e>=0?e:Math.exp(e)-1)),E0={kernelName:FI,backendName:"cpu",kernelFunc:T0};function _0(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{alpha:i}=r;YJ([a],"leakyRelu");let s=pT.sizeFromShape(a.shape),o=n.data.get(a.dataId).values,l=pT.getTypedArrayFromDType("float32",s);for(let u=0;u<o.length;u++)l[u]=o[u]<0?i*o[u]:o[u];return n.makeTensorInfo(a.shape,"float32",l)}var $0={kernelName:rN,backendName:"cpu",kernelFunc:_0},A0=nZ(((e,t)=>e<0?t*e:e));function R0(e){let{inputs:t,backend:n}=e,{x:r,alpha:a}=t;YJ([r,a],"prelu");let i=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,[o,l]=A0(r.shape,a.shape,i,s,"float32");return n.makeTensorInfo(l,"float32",o)}var D0={kernelName:UN,backendName:"cpu",kernelFunc:R0},F0=NZ(JN,(e=>Math.max(0,e))),M0={kernelName:JN,backendName:"cpu",kernelFunc:F0},O0=NZ(rC,(e=>Math.min(Math.max(0,e),6))),P0={kernelName:rC,backendName:"cpu",kernelFunc:O0};function L0(e,t,n,r,a){if("linear"===n)return sZ({inputs:{x:t},backend:e});if("relu"===n)return F0({inputs:{x:t},backend:e});if("elu"===n)return T0({inputs:{x:t},backend:e});if("relu6"===n)return O0({inputs:{x:t},backend:e});if("prelu"===n)return R0({inputs:{x:t,alpha:r},backend:e});if("leakyrelu"===n)return _0({inputs:{x:t},backend:e,attrs:{alpha:a}});if("sigmoid"===n)return KQ({inputs:{x:t},backend:e});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}function z0(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{shape:i}=r,s=pT.sizeFromShape(a.shape),o=pT.inferFromImplicitShape(i,s),l=pT.sizeFromShape(o);pT.assert(s===l,(()=>`The new shape (${o}) has ${l} elements and the old shape (${a.shape}) has ${s} elements. The new shape and old shape must have the same number of elements.`)),n.incRef(a.dataId);let u=n.data.get(a.dataId);if(null!=u.complexTensorInfos){let e=u.complexTensorInfos.real,t=u.complexTensorInfos.imag;e.shape=o,t.shape=o}return{dataId:a.dataId,shape:o,dtype:a.dtype}}var B0={kernelName:ZN,backendName:"cpu",kernelFunc:z0};function W0(e){let{inputs:t,backend:n,attrs:r}=e,{a:a,b:i}=t,{transposeA:s,transposeB:o}=r;YJ([a,i],"matMul");let l=a.shape.length,u=i.shape.length,d=s?a.shape[l-2]:a.shape[l-1],c=o?i.shape[u-1]:i.shape[u-2],p=s?a.shape[l-1]:a.shape[l-2],h=o?i.shape[u-2]:i.shape[u-1],f=a.shape.slice(0,-2),m=i.shape.slice(0,-2),g=pT.sizeFromShape(f),b=pT.sizeFromShape(m),y=SA.assertAndGetBroadcastShape(a.shape.slice(0,-2),i.shape.slice(0,-2)).concat([p,h]);pT.assert(d===c,(()=>`Error in matMul: inner shapes (${d}) and (${c}) of Tensors with shapes ${a.shape} and ${i.shape} and transposeA=${s} and transposeB=${o} must match.`));let v=o?[b,h,c]:[b,c,h],x=z0({inputs:{x:a},backend:n,attrs:{shape:s?[g,d,p]:[g,p,d]}}),w=z0({inputs:{x:i},backend:n,attrs:{shape:v}}),k=s?x.shape[1]:x.shape[2],S=s?x.shape[2]:x.shape[1],I=o?w.shape[1]:w.shape[2],N=Math.max(g,b),C=n.data.get(x.dataId).values,T=n.data.get(w.dataId).values,E=pT.computeStrides(x.shape),_=pT.computeStrides(w.shape),[$,A,R]=s?[E[0],1,E[1]]:[E[0],E[1],1],[D,F,M]=o?[1,_[1],_[0]]:[_[1],1,_[0]],O=S*I,P=R_([N,S,I],x.dtype),L=P.values,z=n.blockSize;for(let B=0;B<N;B++){let e=B%g,t=B%b;for(let n=0;n<S;n+=z){let r=Math.min(n+z,S);for(let a=0;a<I;a+=z){let i=Math.min(a+z,I);for(let s=0;s<k;s+=z){let o=Math.min(s+z,k);for(let l=n;l<r;l++)for(let n=a;n<i;n++){let r=0;for(let a=s;a<o;a++)r+=C[e*$+l*A+a*R]*T[a*D+n*F+t*M];L[B*O+(l*I+n)]+=r}}}}}return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(w),n.makeTensorInfo(y,P.dtype,P.values)}var V0={kernelName:QS,backendName:"cpu",kernelFunc:W0},U0={kernelName:YC,backendName:"cpu",kernelFunc:function(e){let t,n,r,{inputs:a,backend:i,attrs:s}=e,{a:o,b:l,bias:u,preluActivationWeights:d}=a,{transposeA:c,transposeB:p,activation:h,leakyreluAlpha:f}=s,m=[];t=W0({inputs:{a:o,b:l},attrs:{transposeA:c,transposeB:p},backend:i}),u&&(n=bZ({inputs:{a:t,b:u},backend:i}),m.push(t),t=n),h&&(r=L0(i,t,h,d,f),m.push(t),t=r);for(let g of m)i.disposeIntermediateTensorInfo(g);return t}},j0=NZ(OS,(e=>Math.acos(e))),H0={kernelName:OS,backendName:"cpu",kernelFunc:j0},G0=NZ(PS,(e=>Math.acosh(e))),q0={kernelName:PS,backendName:"cpu",kernelFunc:G0},K0={kernelName:zS,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,r=t;YJ(t,"addN");let a=r.map((e=>n.data.get(e.dataId).values)),i=R_(r[0].shape,r[0].dtype),s=i.values;for(let o=0;o<r.length;o++){let e=a[o];for(let t=0;t<s.length;t++)s[t]+=e[t]}return n.makeTensorInfo(i.shape,i.dtype,i.values)}},X0={kernelName:BS,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:s}=r;YJ(a,"all");let o=pT.parseAxisParam(i,a.shape),l=o,u=_P.getAxesPermutation(l,a.shape.length),d=a;null!=u&&(d=TQ({inputs:{x:a},backend:n,attrs:{perm:u}}),l=_P.getInnerMostAxes(l.length,a.shape.length)),_P.assertAxesAreInnerMostDims("all",l,d.shape.length);let[c,p]=_P.computeOutAndReduceShapes(d.shape,l),h=pT.sizeFromShape(p),f=pT.makeZerosTypedArray(pT.sizeFromShape(c),d.dtype),m=n.data.get(d.dataId).values;for(let b=0;b<f.length;++b){let e=b*h,t=m[e];for(let n=0;n<h;++n){let r=m[e+n];t=t&&r}f[b]=t}null!=u&&n.disposeIntermediateTensorInfo(d);let g=n.makeTensorInfo(c,d.dtype,f);if(s){let e=z0({inputs:{x:g},backend:n,attrs:{shape:_P.expandShapeToKeepDim(c,o)}});return n.disposeIntermediateTensorInfo(g),e}return g}},Y0={kernelName:WS,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:s}=r;YJ(a,"any");let o=pT.parseAxisParam(i,a.shape),l=o,u=_P.getAxesPermutation(l,a.shape.length),d=a;null!=u&&(d=TQ({inputs:{x:a},backend:n,attrs:{perm:u}}),l=_P.getInnerMostAxes(l.length,a.shape.length)),_P.assertAxesAreInnerMostDims("any",l,d.shape.length);let[c,p]=_P.computeOutAndReduceShapes(d.shape,l),h=pT.sizeFromShape(p),f=pT.makeZerosTypedArray(pT.sizeFromShape(c),d.dtype),m=n.data.get(d.dataId).values;for(let b=0;b<f.length;++b){let e=b*h,t=m[e];for(let n=0;n<h;++n){let r=m[e+n];t=t||r}f[b]=t}null!=u&&n.disposeIntermediateTensorInfo(d);let g=n.makeTensorInfo(c,d.dtype,f);if(s){let e=z0({inputs:{x:g},backend:n,attrs:{shape:_P.expandShapeToKeepDim(c,o)}});return n.disposeIntermediateTensorInfo(g),e}return g}},J0={kernelName:VS,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i}=r;YJ(a,"argMax");let s=pT.parseAxisParam(i,a.shape),o=_P.getAxesPermutation(s,a.shape.length),l=a,u=[];null!=o&&(l=TQ({inputs:{x:a},backend:n,attrs:{perm:o}}),u.push(l),s=_P.getInnerMostAxes(s.length,l.shape.length)),s=[s[0]],_P.assertAxesAreInnerMostDims("argMax",s,l.shape.length);let[d,c]=_P.computeOutAndReduceShapes(l.shape,s),p=pT.sizeFromShape(d),h=pT.makeZerosTypedArray(p,"int32"),f=pT.sizeFromShape(c),m=n.data.get(l.dataId).values;for(let g=0;g<h.length;++g){let e=g*f,t=m[e],n=0;for(let r=0;r<f;++r){let a=m[e+r];a>t&&(t=a,n=r)}h[g]=n}return u.forEach((e=>n.disposeIntermediateTensorInfo(e))),n.makeTensorInfo(d,"int32",h)}},Z0={kernelName:US,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i}=r;YJ(a,"argMin");let s=pT.parseAxisParam(i,a.shape),o=_P.getAxesPermutation(s,a.shape.length),l=a,u=[];null!=o&&(l=TQ({inputs:{x:a},backend:n,attrs:{perm:o}}),u.push(l),s=_P.getInnerMostAxes(s.length,l.shape.length)),s=[s[0]],_P.assertAxesAreInnerMostDims("argMin",s,l.shape.length);let[d,c]=_P.computeOutAndReduceShapes(l.shape,s),p=pT.sizeFromShape(d),h=pT.makeZerosTypedArray(p,"int32"),f=pT.sizeFromShape(c),m=n.data.get(l.dataId).values;for(let g=0;g<h.length;++g){let e=g*f,t=m[e],n=0;for(let r=0;r<f;++r){let a=m[e+r];a<t&&(t=a,n=r)}h[g]=n}return u.forEach((e=>n.disposeIntermediateTensorInfo(e))),n.makeTensorInfo(d,"int32",h)}},Q0=NZ(jS,(e=>Math.asin(e))),e1={kernelName:jS,backendName:"cpu",kernelFunc:Q0},t1=NZ(HS,(e=>Math.asinh(e))),n1={kernelName:HS,backendName:"cpu",kernelFunc:t1},r1=NZ(GS,(e=>Math.atan(e))),a1={kernelName:GS,backendName:"cpu",kernelFunc:r1},i1=nZ(((e,t)=>Math.atan2(e,t))),s1=hZ(KS,i1),o1={kernelName:KS,backendName:"cpu",kernelFunc:s1},l1=NZ(qS,(e=>Math.atanh(e))),u1={kernelName:qS,backendName:"cpu",kernelFunc:l1};function d1(e,t,n,r,a,i){let s=a.strideHeight,o=a.strideWidth,l=a.dilationHeight,u=a.dilationWidth,d=a.effectiveFilterHeight,c=a.effectiveFilterWidth,p=a.padInfo.top,h=a.padInfo.left,f="max"===i?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=R_(a.outShape,n),g=m.values,b=a.outShape[1]*a.outShape[2]*a.outShape[3],y=a.outShape[2]*a.outShape[3],v=a.outShape[3];for(let x=0;x<a.batchSize;++x){let t=x*b,n=x*r[0];for(let m=0;m<a.inChannels;++m)for(let b=0;b<a.outHeight;++b){let x=b*s-p,w=Math.max(0,x),k=Math.min(a.inHeight,d+x),S=t+b*y;for(let t=0;t<a.outWidth;++t){let s=t*o-h,d=Math.max(0,s),p=Math.min(a.inWidth,c+s),b=f,y=0,x=0;for(let t=w;t<k;t+=l){let a=n+t*r[1];for(let t=d;t<p;t+=u){let n=e[a+t*r[2]+m];"max"===i&&n>b?b=n:"avg"===i&&(y+=n,x++)}if(isNaN(b))break}g[S+t*v+m]="avg"===i?y/x:b}}}return m}function c1(e,t,n,r,a=!1,i=!1){let s=R_(r.outShape,"int32"),o=r.strideHeight,l=r.strideWidth,u=r.dilationHeight,d=r.dilationWidth,c=r.effectiveFilterHeight,p=r.effectiveFilterWidth,h=r.padInfo.top,f=r.padInfo.left,m=R_(t,n,e);for(let g=0;g<r.batchSize;++g)for(let e=0;e<r.inChannels;++e)for(let t=0;t<r.outHeight;++t){let n=t*o-h,b=n;for(;b<0;)b+=u;let y=Math.min(r.inHeight,c+n);for(let o=0;o<r.outWidth;++o){let c=o*l-f,h=c;for(;h<0;)h+=d;let v=Math.min(r.inWidth,p+c),x=Number.NEGATIVE_INFINITY,w=-1;for(let t=b;t<y;t+=u){let s=t-n;for(let n=h;n<v;n+=d){let o=n-c,l=m.get(g,t,n,e);l>x&&(x=l,w=a?i?((g*r.inHeight+t)*r.inWidth+n)*r.inChannels+e:(t*r.inWidth+n)*r.inChannels+e:s*p+o)}}s.set(w,g,t,o,e)}}return s}function p1(e,t,n,r,a,i){let s=a.strideDepth,o=a.strideHeight,l=a.strideWidth,u=a.dilationDepth,d=a.dilationHeight,c=a.dilationWidth,p=a.effectiveFilterDepth,h=a.effectiveFilterHeight,f=a.effectiveFilterWidth,m=a.padInfo.front,g=a.padInfo.top,b=a.padInfo.left,y="max"===i?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=R_(a.outShape,n),x=v.values,w=a.outShape[1]*a.outShape[2]*a.outShape[3]*a.outShape[4],k=a.outShape[2]*a.outShape[3]*a.outShape[4],S=a.outShape[3]*a.outShape[4],I=a.outShape[4];for(let N=0;N<a.batchSize;++N){let t=N*w,n=N*r[0];for(let v=0;v<a.inChannels;++v)for(let w=0;w<a.outDepth;++w){let N=w*s-m,C=N;for(;C<0;)C+=u;let T=Math.min(a.inDepth,p+N),E=t+w*k;for(let t=0;t<a.outHeight;++t){let s=t*o-g,p=s;for(;p<0;)p+=d;let m=Math.min(a.inHeight,h+s),w=E+t*S;for(let t=0;t<a.outWidth;++t){let s=t*l-b,o=s;for(;o<0;)o+=c;let h=Math.min(a.inWidth,f+s),g=w+t*I,k=y,S=0,N=0;for(let t=C;t<T;t+=u){let a=n+t*r[1];for(let t=p;t<m;t+=d){let n=a+t*r[2];for(let t=o;t<h;t+=c){let a=e[n+t*r[3]+v];if("max"===i&&a>k?k=a:"avg"===i&&(S+=a,N++),isNaN(k))break}if(isNaN(k))break}if(isNaN(k))break}x[g+v]="avg"===i?S/Math.max(N,1):k}}}}return v}var h1={kernelName:XS,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t;YJ(a,"avgPool");let{filterSize:i,strides:s,pad:o,dimRoundingMode:l}=r;pT.assert(_P.eitherStridesOrDilationsAreOne(s,1),(()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${s} and dilations '1'`));let u,d=_P.computePool2DInfo(a.shape,i,s,1,o,l);if(1===d.filterWidth&&1===d.filterHeight&&pT.arraysEqual(d.inShape,d.outShape))u=sZ({inputs:{x:a},backend:n});else{let e=n.data.get(a.dataId).values,t=pT.computeStrides(a.shape),r=d1(e,a.shape,a.dtype,t,d,"avg");u=n.makeTensorInfo(d.outShape,a.dtype,r.values)}return u}},f1={kernelName:JS,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:i,strides:s,pad:o,dimRoundingMode:l,dataFormat:u}=r;YJ(a,"avgPool3d");let d=_P.computePool3DInfo(a.shape,i,s,1,o,l,u),c=p1(n.data.get(a.dataId).values,a.shape,a.dtype,pT.computeStrides(a.shape),d,"avg");return n.makeTensorInfo(c.shape,"float32",c.values)}},m1={kernelName:ZS,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,{filterSize:s,strides:o,pad:l,dimRoundingMode:u}=r;YJ([a,i],"avgPool3DGrad");let d=_P.computePool3DInfo(i.shape,s,o,1,l,u),c=d.strideDepth,p=d.strideHeight,h=d.strideWidth,f=d.filterDepth,m=d.filterHeight,g=d.filterWidth,b=d.dilationDepth,y=d.dilationHeight,v=d.dilationWidth,x=d.effectiveFilterDepth,w=d.effectiveFilterHeight,k=d.effectiveFilterWidth,S=x-1-d.padInfo.front,I=k-1-d.padInfo.left,N=w-1-d.padInfo.top,C=R_(i.shape,"float32"),T=1/(f*m*g),E=n.bufferSync(a);for(let _=0;_<d.batchSize;++_)for(let e=0;e<d.inChannels;++e)for(let t=0;t<d.inDepth;++t)for(let n=0;n<d.inHeight;++n)for(let r=0;r<d.inWidth;++r){let a=t-S,i=n-N,s=r-I,o=0;for(let t=0;t<x;t+=b){let n=(a+t)/c;if(!(n<0||n>=d.outDepth||Math.floor(n)!==n))for(let t=0;t<w;t+=y){let r=(i+t)/p;if(!(r<0||r>=d.outHeight||Math.floor(r)!==r))for(let t=0;t<k;t+=v){let a=(s+t)/h;a<0||a>=d.outWidth||Math.floor(a)!==a||(o+=E.get(_,n,r,a,e))}}}C.set(o*T,_,t,n,r,e)}return n.makeTensorInfo(C.shape,C.dtype,C.values)}},g1={kernelName:YS,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,s=i;YJ([a,i],"avgPoolGrad");let{filterSize:o,strides:l,pad:u}=r,d=_P.computePool2DInfo(s.shape,o,l,1,u),c=d.strideHeight,p=d.strideWidth,h=d.filterHeight,f=d.filterWidth,m=d.dilationHeight,g=d.dilationWidth,b=d.effectiveFilterHeight,y=d.effectiveFilterWidth,v=y-1-d.padInfo.left,x=b-1-d.padInfo.top,w=R_(s.shape,"float32"),k=1/(h*f),S=n.data.get(a.dataId).values,I=R_(a.shape,"float32",S);for(let N=0;N<d.batchSize;++N)for(let e=0;e<d.inChannels;++e)for(let t=0;t<d.inHeight;++t)for(let n=0;n<d.inWidth;++n){let r=t-x,a=n-v,i=0;for(let t=0;t<b;t+=m){let n=(r+t)/c;if(!(n<0||n>=d.outHeight||Math.floor(n)!==n))for(let t=0;t<y;t+=g){let r=(a+t)/p;r<0||r>=d.outWidth||Math.floor(r)!==r||(i+=I.get(N,n,r,e))}}w.set(i*k,N,t,n,e)}return n.makeTensorInfo(w.shape,w.dtype,w.values)}},b1={kernelName:GI,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,scale:i,offset:s,mean:o,variance:l}=t;pT.assert(o.shape.length===l.shape.length,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),pT.assert(null==s||o.shape.length===s.shape.length,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),pT.assert(null==i||o.shape.length===i.shape.length,(()=>"Batch normalization gradient requires mean and scale to have equal ranks.")),YJ([a,o,l,i,s],"batchNorm");let{varianceEpsilon:u}=r;null==u&&(u=.001);let d=n.data.get(a.dataId).values,c=n.data.get(o.dataId).values,p=n.data.get(l.dataId).values,h=i?n.data.get(i.dataId).values:new Float32Array([1]),f=s?n.data.get(s.dataId).values:new Float32Array([0]),m=new Float32Array(d.length),g=f.length,b=h.length,y=p.length,v=c.length,x=0,w=0,k=0,S=0;for(let I=0;I<d.length;++I)m[I]=f[x++]+(d[I]-c[w++])*h[k++]/Math.sqrt(p[S++]+u),x>=g&&(x=0),w>=v&&(w=0),k>=b&&(k=0),S>=y&&(S=0);return n.makeTensorInfo(a.shape,a.dtype,m)}},y1={kernelName:eI,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:i,crops:s}=r;YJ([a],"batchToSpaceND");let o=i.reduce(((e,t)=>e*t)),l=_P.getReshaped(a.shape,i,o),u=_P.getPermuted(l.length,i.length),d=_P.getReshapedPermuted(a.shape,i,o),c=_P.getSliceBeginCoords(s,i.length),p=_P.getSliceSize(d,s,i.length),h=z0({inputs:{x:a},backend:n,attrs:{shape:l}}),f=TQ({inputs:{x:h},backend:n,attrs:{perm:u}}),m=z0({inputs:{x:f},backend:n,attrs:{shape:d}}),g=JQ({inputs:{x:m},backend:n,attrs:{begin:c,size:p}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),g}},v1={kernelName:tI,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,weights:i}=t,{size:s}=r,o=vZ(n.data.get(a.dataId).values,n.data.get(i.dataId).values,i.dtype,i.shape,s);return n.makeTensorInfo([s],i.dtype,o)}},x1={kernelName:aI,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{s0:r,s1:a}=t,i=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,o=_P.assertAndGetBroadcastShape(Array.from(i),Array.from(s));return n.makeTensorInfo([o.length],"int32",Int32Array.from(o))}},w1=NZ(oI,((e,t)=>{let n=t;return e>n.clipValueMax?n.clipValueMax:e<n.clipValueMin?n.clipValueMin:e})),k1={kernelName:oI,backendName:"cpu",kernelFunc:w1},S1={kernelName:uI,backendName:"cpu",kernelFunc:e=>{let{x:t}=e.inputs,n=e.backend,r=new Float32Array(pT.sizeFromShape(t.shape)),a=n.data.get(t.dataId),i=a.complexTensorInfos.real,s=a.complexTensorInfos.imag,o=n.data.get(i.dataId).values,l=n.data.get(s.dataId).values;for(let u=0;u<o.length;u++){let e=o[u],t=l[u];r[u]=Math.hypot(e,t)}return n.makeOutput(r,t.shape,"float32")}};function I1(e){let{inputs:t,backend:n}=e,{input:r}=t,a=n.data.get(r.dataId).complexTensorInfos.imag,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}var N1={kernelName:QI,backendName:"cpu",kernelFunc:I1};function C1(e){let{inputs:t,backend:n,attrs:r}=e,{axis:a}=r,i=pT.parseAxisParam(a,t[0].shape)[0],s=t.map((e=>e.shape));_P.assertParamsConsistent(s,i);let o=_P.computeOutShape(t.map((e=>e.shape)),i);if(0===pT.sizeFromShape(o))return n.makeTensorInfo(o,t[0].dtype,[]);let l=t.filter((e=>pT.sizeFromShape(e.shape)>0));if(1===l.length)return sZ({inputs:{x:l[0]},backend:n});if("complex64"===l[0].dtype){let e=l.map((e=>lZ({inputs:{input:e},backend:n}))),t=l.map((e=>I1({inputs:{input:e},backend:n}))),r=C1({inputs:e,backend:n,attrs:{axis:i}}),a=C1({inputs:t,backend:n,attrs:{axis:i}}),s=rZ({inputs:{real:r,imag:a},backend:n});return e.forEach((e=>n.disposeIntermediateTensorInfo(e))),t.forEach((e=>n.disposeIntermediateTensorInfo(e))),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(a),s}let u=l.map((e=>{let t=[-1,pT.sizeFromShape(e.shape.slice(i))];return z0({inputs:{x:e},backend:n,attrs:{shape:t}})})),d=u.map((e=>({vals:n.data.get(e.dataId).values,shape:e.shape})));o=_P.computeOutShape(u.map((e=>e.shape)),1);let c=1===u[0].shape[0],p=$Z(d,o,t[0].dtype,c),h=_P.computeOutShape(l.map((e=>e.shape)),i),f=n.makeTensorInfo(h,t[0].dtype,p);return u.forEach((e=>n.disposeIntermediateTensorInfo(e))),f}var T1={kernelName:dI,backendName:"cpu",kernelFunc:C1};function E1(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:s,pad:o,dataFormat:l,dilations:u,dimRoundingMode:d}=r;YJ([a,i],"conv2d");let c=_P.convertConv2DDataFormat(l),p=_P.computeConv2DInfo(a.shape,i.shape,s,u,o,d,!1,c),h=p.filterHeight,f=p.filterWidth,m=p.dilationHeight,g=p.dilationWidth,b=p.padInfo.left,y=p.padInfo.top,v="channelsLast"===p.dataFormat,x=new GT(p.outShape,a.dtype),w=pT.computeStrides(a.shape),k=pT.computeStrides(i.shape),S=w[0],I=v?w[1]:w[2],N=v?w[2]:1,C=v?1:w[1],T=x.strides[0],E=v?x.strides[1]:x.strides[2],_=v?x.strides[2]:1,$=v?1:x.strides[1],A=n.data.get(a.dataId).values,R=n.data.get(i.dataId).values,D=x.values;for(let F=0;F<p.batchSize;++F){let e=F*S,t=F*T;for(let n=0;n<p.outHeight;++n){let r=t+n*E,a=n*p.strideHeight-y;for(let t=0;t<h;++t){let n=a+t*m;if(n<0||n>=p.inHeight)continue;let i=t*k[0],s=e+n*I;for(let e=0;e<p.outWidth;++e){let t=r+e*_,n=e*p.strideWidth-b;for(let e=0;e<f;++e){let r=n+e*g;if(r<0||r>=p.inWidth)continue;let a=s+r*N,o=i+e*k[1];for(let e=0;e<p.inChannels;++e){let n=A[a+e*C];for(let e=0;e<p.outChannels;++e)D[t+e*$]+=n*R[o+e];o+=p.outChannels}}}}}}return n.makeTensorInfo(x.shape,x.dtype,D)}var _1={kernelName:cI,backendName:"cpu",kernelFunc:E1},$1={kernelName:pI,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,dy:i}=t,{strides:s,pad:o,dataFormat:l,dimRoundingMode:u,filterShape:d}=r;YJ([a,i],"conv2dBackpropFilter");let c=_P.convertConv2DDataFormat(l),p=_P.computeConv2DInfo(a.shape,d,s,1,o,u,!1,c),{strideHeight:h,strideWidth:f,filterHeight:m,filterWidth:g}=p,b="channelsLast"===p.dataFormat,y=new GT(p.filterShape,"float32"),v=p.padInfo.left,x=p.padInfo.top,w=n.data.get(a.dataId).values,k=n.data.get(i.dataId).values,S=new GT(a.shape,a.dtype,w),I=new GT(i.shape,i.dtype,k);for(let N=0;N<m;++N){let e=Math.max(0,Math.ceil((x-N)/h)),t=Math.min(p.outHeight,(p.inHeight+x-N)/h);for(let n=0;n<g;++n){let r=Math.max(0,Math.ceil((v-n)/f)),a=Math.min(p.outWidth,(p.inWidth+v-n)/f);for(let i=0;i<p.inChannels;++i)for(let s=0;s<p.outChannels;++s){let o=0;for(let l=0;l<p.batchSize;++l)for(let u=e;u<t;++u){let e=N+u*h-x;for(let t=r;t<a;++t){let r=n+t*f-v;o+=b?S.get(l,e,r,i)*I.get(l,u,t,s):S.get(l,i,e,r)*I.get(l,s,u,t)}}y.set(o,N,n,i,s)}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}},A1={kernelName:hI,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:i}=t,{inputShape:s,strides:o,pad:l,dataFormat:u,dimRoundingMode:d}=r;YJ([a,i],"conv2dBackpropInput");let c=pT.computeStrides(i.shape),p=pT.computeStrides(a.shape),h=_P.convertConv2DDataFormat(u),f=_P.computeConv2DInfo(s,i.shape,o,1,l,d,!1,h),m=new GT(f.inShape,"float32"),g=m.values,b=n.data.get(a.dataId).values,y=n.data.get(i.dataId).values,[v,x,w]=c,{batchSize:k,filterHeight:S,filterWidth:I,inChannels:N,inHeight:C,inWidth:T,outChannels:E,outHeight:_,outWidth:$,strideHeight:A,strideWidth:R}=f;h=f.dataFormat;let D=S-1-f.padInfo.top,F=I-1-f.padInfo.left,M="channelsLast"===h,O=m.strides[0],P=M?m.strides[1]:m.strides[2],L=M?m.strides[2]:1,z=M?1:m.strides[1],B=p[0],W=M?p[1]:p[2],V=M?p[2]:1,U=M?1:p[1];for(let j=0;j<k;++j)for(let e=0;e<N;++e)for(let t=0;t<C;++t){let n=t-D,r=Math.max(0,Math.ceil(n/A)),a=Math.min(_,(S+n)/A);for(let i=0;i<T;++i){let s=i-F,o=Math.max(0,Math.ceil(s/R)),l=Math.min($,(I+s)/R),u=0;for(let t=r;t<a;++t){let r=t*A-n;for(let n=o;n<l;++n){let a=B*j+W*t+V*n,i=v*(S-1-r)+x*(I-1-(n*R-s))+w*e;for(let e=0;e<E;++e)u+=b[a+U*e]*y[i+e]}}g[O*j+P*t+L*i+z*e]=u}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}},R1={kernelName:fI,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:s,pad:o,dilations:l}=r;YJ([a,i],"conv3d");let u=_P.computeConv3DInfo(a.shape,i.shape,s,l,o),{filterDepth:d,filterHeight:c,filterWidth:p,dilationDepth:h,dilationHeight:f,dilationWidth:m,padInfo:g}=u,b=g.front,y=g.left,v=g.top,x=new GT(u.outShape,a.dtype),w=n.data.get(a.dataId).values,k=n.data.get(i.dataId).values,S=x.values,I=pT.computeStrides(a.shape),N=pT.computeStrides(i.shape);for(let C=0;C<u.batchSize;++C){let e=C*I[0],t=C*x.strides[0];for(let n=0;n<u.outDepth;++n){let r=t+n*x.strides[1],a=n*u.strideDepth-b;for(let t=0;t<d;++t){let n=a+t*h;if(n<0||n>=u.inDepth)continue;let i=t*N[0],s=e+n*I[1];for(let e=0;e<u.outHeight;++e){let t=r+e*x.strides[2],n=e*u.strideHeight-v;for(let e=0;e<c;++e){let r=n+e*f;if(r<0||r>=u.inHeight)continue;let a=i+e*N[1],o=s+r*I[2];for(let e=0;e<u.outWidth;++e){let n=t+e*u.outChannels,r=e*u.strideWidth-y;for(let e=0;e<p;++e){let t=r+e*m;if(t<0||t>=u.inWidth)continue;let i=a+e*N[2],s=o+t*u.inChannels,l=i;for(let e=0;e<u.inChannels;++e){let t=w[s+e];for(let e=0;e<u.outChannels;++e)S[n+e]+=t*k[l+e];l+=u.outChannels}}}}}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}},D1={kernelName:mI,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,dy:i}=t,{strides:s,pad:o,filterShape:l}=r;YJ([a,i],"conv3dBackpropFilterV2");let u=pT.computeStrides(a.shape),d=pT.computeStrides(i.shape),c=_P.computeConv3DInfo(a.shape,l,s,1,o),p=c.strideDepth,h=c.strideHeight,f=c.strideWidth,m=c.filterDepth,g=c.filterHeight,b=c.filterWidth,y=new GT(c.filterShape,"float32"),v=y.values,[x,w,k,S]=y.strides,I=n.data.get(i.dataId).values,[N,C,T,E]=d,_=n.data.get(a.dataId).values,[$,A,R,D]=u,F=c.padInfo.front,M=c.padInfo.left,O=c.padInfo.top;for(let P=0;P<m;++P){let e=Math.max(0,Math.ceil((F-P)/p)),t=Math.min(c.outDepth,(c.inDepth+F-P)/p),n=P*x;for(let r=0;r<g;++r){let a=Math.max(0,Math.ceil((O-r)/h)),i=Math.min(c.outHeight,(c.inHeight+O-r)/h),s=r*w+n;for(let n=0;n<b;++n){let o=Math.max(0,Math.ceil((M-n)/f)),l=Math.min(c.outWidth,(c.inWidth+M-n)/f),u=n*k+s;for(let s=0;s<c.inChannels;++s){let d=s*S+u;for(let u=0;u<c.outChannels;++u){let m=0;for(let d=0;d<c.batchSize;++d){let c=d*$,g=d*N;for(let d=e;d<t;++d){let e=(P+d*p-F)*A+c,t=d*C+g;for(let d=a;d<i;++d){let a=(r+d*h-O)*R+e,i=d*T+t;for(let e=o;e<l;++e){let t=e*E+i;m+=_[(n+e*f-M)*D+a+s]*I[t+u]}}}}v[d+u]=m}}}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}},F1={kernelName:gI,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:i}=t,{pad:s,strides:o,inputShape:l}=r;YJ([a],"conv3dBackpropInputV2");let u=pT.computeStrides(a.shape),d=pT.computeStrides(i.shape),c=_P.computeConv3DInfo(l,i.shape,o,1,s),p=new GT(c.inShape,"float32"),h=p.values,[f,m,g,b]=p.strides,y=n.data.get(a.dataId).values,[v,x,w,k]=u,S=n.data.get(i.dataId).values,[I,N,C,T]=d,{batchSize:E,filterDepth:_,filterHeight:$,filterWidth:A,inChannels:R,inDepth:D,inHeight:F,inWidth:M,outChannels:O,outDepth:P,outHeight:L,outWidth:z,strideDepth:B,strideHeight:W,strideWidth:V}=c,U=_-1-c.padInfo.front,j=$-1-c.padInfo.top,H=A-1-c.padInfo.left;for(let G=0;G<E;++G)for(let e=0;e<R;++e)for(let t=0;t<D;++t){let n=t-U,r=Math.max(0,Math.ceil(n/B)),a=Math.min(P,(_+n)/B);for(let i=0;i<F;++i){let s=i-j,o=Math.max(0,Math.ceil(s/W)),l=Math.min(L,($+s)/W);for(let u=0;u<M;++u){let d=u-H,c=Math.max(0,Math.ceil(d/V)),p=Math.min(z,(A+d)/V),E=0;for(let t=r;t<a;++t){let r=t*B-n;for(let n=o;n<l;++n){let a=n*W-s;for(let i=c;i<p;++i){let s=v*G+x*t+w*n+k*i,o=I*(_-1-r)+N*($-1-a)+C*(A-1-(i*V-d))+T*e;for(let e=0;e<O;++e)E+=y[s+e]*S[o+e]}}}h[f*G+m*t+g*i+b*u+e]=E}}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}},M1=NZ(bI,(e=>Math.cos(e))),O1={kernelName:bI,backendName:"cpu",kernelFunc:M1},P1=NZ(yI,(e=>Math.cosh(e))),L1={kernelName:yI,backendName:"cpu",kernelFunc:P1},z1={kernelName:wI,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{image:a,boxes:i,boxInd:s}=t,{cropSize:o,method:l,extrapolationValue:u}=r,[d,c,p,h]=a.shape,f=i.shape[0],[m,g]=o,b=R_([f,m,g,h],"float32"),y=n.data.get(i.dataId).values,v=n.data.get(s.dataId).values,x=n.data.get(a.dataId).values,w=pT.computeStrides(a.shape),k=pT.computeStrides(b.shape);for(let S=0;S<f;S++){let e=4*S,t=y[e],n=y[e+1],r=y[e+2],a=y[e+3],i=v[S];if(i>=d)continue;let s=m>1?(r-t)*(c-1)/(m-1):0,o=g>1?(a-n)*(p-1)/(g-1):0;for(let d=0;d<m;d++){let e=m>1?t*(c-1)+d*s:.5*(t+r)*(c-1);if(e<0||e>c-1)for(let t=0;t<g;t++)for(let e=0;e<h;e++){let n=e+t*k[2]+d*k[1]+S*k[0];b.values[n]=u}else if("bilinear"===l){let t=Math.floor(e),r=Math.ceil(e),s=e-t;for(let e=0;e<g;e++){let l=g>1?n*(p-1)+e*o:.5*(n+a)*(p-1);if(l<0||l>p-1){for(let t=0;t<h;t++){let n=t+e*k[2]+d*k[1]+S*k[0];b.values[n]=u}continue}let c=Math.floor(l),f=Math.ceil(l),m=l-c;for(let n=0;n<h;n++){let a=n+c*w[2]+t*w[1]+i*w[0],o=x[a];a=n+f*w[2]+t*w[1]+i*w[0];let l=x[a];a=n+c*w[2]+r*w[1]+i*w[0];let u=x[a];a=n+f*w[2]+r*w[1]+i*w[0];let p=o+(l-o)*m,h=u+(x[a]-u)*m;a=n+e*k[2]+d*k[1]+S*k[0],b.values[a]=p+(h-p)*s}}}else for(let t=0;t<g;++t){let r=g>1?n*(p-1)+t*o:.5*(n+a)*(p-1);if(r<0||r>p-1){for(let e=0;e<h;e++){let n=e+t*k[2]+d*k[1]+S*k[0];b.values[n]=u}continue}let s=Math.round(r),l=Math.round(e);for(let e=0;e<h;e++){let n=e+s*w[2]+l*w[1]+i*w[0],r=e+t*k[2]+d*k[1]+S*k[0];b.values[r]=x[n]}}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}},B1={kernelName:vI,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,exclusive:s,reverse:o}=r;YJ(a,"cumprod");let l=_P.getAxesPermutation([i],a.shape.length),u=a;null!=l&&(u=TQ({inputs:{x:a},backend:n,attrs:{perm:l}}));let d=_P.getInnerMostAxes(1,a.shape.length)[0];if(d!==u.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${d}`);let c=iE(u.dtype,"int32"),p=pT.makeOnesTypedArray(pT.sizeFromShape(u.shape),c),h=n.data.get(u.dataId).values,f=u.shape[u.shape.length-1],m=o?(e,t)=>e+f-t-1:(e,t)=>e+t;for(let b=0;b<h.length;b+=f)for(let e=0;e<f;e++){let t=m(b,e);if(0===e)p[t]=s?1:h[t];else{let n=m(b,e-1);p[t]=s?h[n]*p[n]:h[t]*p[n]}}let g=n.makeTensorInfo(u.shape,c,p);if(null!=l){let e=TQ({inputs:{x:g},backend:n,attrs:{perm:_P.getUndoAxesPermutation(l)}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(u),e}return g}},W1={kernelName:xI,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,exclusive:s,reverse:o}=r;YJ(a,"cumsum");let l=_P.getAxesPermutation([i],a.shape.length),u=a;null!=l&&(u=TQ({inputs:{x:a},backend:n,attrs:{perm:l}}));let d=_P.getInnerMostAxes(1,a.shape.length)[0];if(d!==u.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${d}`);let c=iE(u.dtype,"int32"),p=pT.makeZerosTypedArray(pT.sizeFromShape(u.shape),c),h=n.data.get(u.dataId).values,f=u.shape[u.shape.length-1],m=o?(e,t)=>e+f-t-1:(e,t)=>e+t;for(let b=0;b<h.length;b+=f)for(let e=0;e<f;e++){let t=m(b,e);if(0===e)p[t]=s?0:h[t];else{let n=m(b,e-1);p[t]=s?h[n]+p[n]:h[t]+p[n]}}let g=n.makeTensorInfo(u.shape,c,p);if(null!=l){let e=TQ({inputs:{x:g},backend:n,attrs:{perm:_P.getUndoAxesPermutation(l)}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(u),e}return g}},V1={kernelName:kI,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,weights:i}=t,{size:s,binaryOutput:o}=r;if(1===a.shape.length){let e=vZ(n.data.get(a.dataId).values,n.data.get(i.dataId).values,i.dtype,i.shape,s);return n.makeTensorInfo([s],i.dtype,e)}if(2===a.shape.length){let e=xZ(n.bufferSync(a),n.bufferSync(i),s,o);return n.makeTensorInfo(e.shape,i.dtype,e.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${a.shape.length}.`)}},U1={kernelName:SI,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockSize:i,dataFormat:s}=r;pT.assert("NHWC"===s,(()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${s}`));let o=a.shape[0],l=a.shape[1],u=a.shape[2],d=a.shape[3],c=l*i,p=u*i,h=d/(i*i),f=n.data.get(a.dataId).values,m=new Float32Array(o*c*p*h),g=0;for(let b=0;b<o;++b)for(let e=0;e<c;++e){let t=Math.floor(e/i),n=e%i;for(let e=0;e<p;++e){let r=Math.floor(e/i),a=(n*i+e%i)*h;for(let e=0;e<h;++e){let n=e+a+d*(r+u*(t+l*b));m[g++]=f[n]}}}return n.makeTensorInfo([o,c,p,h],a.dtype,m)}};function j1(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:s,pad:o,dilations:l,dimRoundingMode:u}=r;YJ([a,i],"depthwiseConv2DNative");let d=pT.computeStrides(a.shape),c=pT.computeStrides(i.shape),p=l;null==p&&(p=[1,1]),pT.assert(_P.eitherStridesOrDilationsAreOne(s,p),(()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${s} and dilations '${p}'`));let h=_P.computeConv2DInfo(a.shape,i.shape,s,p,o,u,!0),{filterHeight:f,filterWidth:m,dilationHeight:g,dilationWidth:b,padInfo:y}=h,v=y.left,x=y.top,w=h.outChannels/h.inChannels,k=new GT(h.outShape,a.dtype),S=n.data.get(a.dataId).values,I=n.data.get(i.dataId).values,N=k.values;for(let C=0;C<h.batchSize;++C){let e=C*d[0],t=C*k.strides[0];for(let n=0;n<h.outHeight;++n){let r=t+n*k.strides[1],a=n*h.strideHeight-x;for(let t=0;t<f;++t){let n=a+t*g;if(n<0||n>=h.inHeight)continue;let i=t*c[0],s=e+n*d[1];for(let e=0;e<h.outWidth;++e){let t=r+e*k.strides[2],n=e*h.strideWidth-v;for(let e=0;e<m;++e){let r=n+e*b;if(r<0||r>=h.inWidth)continue;let a=i+e*c[1],o=s+r*h.inChannels,l=t,u=a;for(let e=0;e<h.inChannels;++e){let t=S[o+e];for(let e=0;e<w;++e)N[l+e]+=t*I[u+e];l+=w,u+=w}}}}}}return n.makeTensorInfo(k.shape,k.dtype,k.values)}var H1={kernelName:II,backendName:"cpu",kernelFunc:j1},G1={kernelName:NI,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,dy:i}=t,{strides:s,dilations:o,pad:l,dimRoundingMode:u,filterShape:d}=r;YJ([a,i],"depthwiseConv2dNativeBackpropFilter");let c=_P.computeConv2DInfo(a.shape,d,s,o,l,u,!0),{strideHeight:p,strideWidth:h,filterHeight:f,filterWidth:m}=c,g=new GT(c.filterShape,"float32"),b=c.padInfo.left,y=c.padInfo.top,v=c.outChannels/c.inChannels,x=n.data.get(a.dataId).values,w=new GT(a.shape,a.dtype,x),k=n.data.get(i.dataId).values,S=new GT(i.shape,i.dtype,k);for(let I=0;I<f;++I){let e=Math.max(0,Math.ceil((y-I)/p)),t=Math.min(c.outHeight,(c.inHeight+y-I)/p);for(let n=0;n<m;++n){let r=Math.max(0,Math.ceil((b-n)/h)),a=Math.min(c.outWidth,(c.inWidth+b-n)/h);for(let i=0;i<c.outChannels;++i){let s=Math.trunc(i/v),o=i%v,l=0;for(let u=0;u<c.batchSize;++u)for(let o=e;o<t;++o){let e=I+o*p-y;for(let t=r;t<a;++t){let r=n+t*h-b;l+=w.get(u,e,r,s)*S.get(u,o,t,i)}}g.set(l,I,n,s,o)}}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}},q1={kernelName:CI,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:i}=t,{strides:s,dilations:o,pad:l,dimRoundingMode:u,inputShape:d}=r;YJ([a,i],"depthwiseConv2DNativeBackpropInput");let c=pT.computeStrides(a.shape),p=pT.computeStrides(i.shape),h=_P.computeConv2DInfo(d,i.shape,s,o,l,u,!0),f=new GT(h.inShape,"float32"),m=f.values,[g,b,y]=f.strides,v=n.data.get(a.dataId).values,[x,w,k]=c,S=n.data.get(i.dataId).values,[I,N,C]=p,{batchSize:T,filterHeight:E,filterWidth:_,inChannels:$,inHeight:A,inWidth:R,outChannels:D,outHeight:F,outWidth:M,strideHeight:O,strideWidth:P}=h,L=E-1-h.padInfo.top,z=_-1-h.padInfo.left,B=D/$;for(let W=0;W<T;++W)for(let e=0;e<$;++e)for(let t=0;t<A;++t){let n=t-L,r=Math.max(0,Math.ceil(n/O)),a=Math.min(F,(E+n)/O);for(let i=0;i<R;++i){let s=i-z,o=Math.max(0,Math.ceil(s/P)),l=Math.min(M,(_+s)/P),u=0;for(let t=r;t<a;++t){let r=t*O-n;for(let n=o;n<l;++n){let a=x*W+w*t+k*n,i=I*(E-1-r)+N*(_-1-(n*P-s))+C*e;for(let t=0;t<B;++t)u+=v[a+(e*B+t)]*S[i+t]}}m[g*W+b*t+y*i+e]=u}}return n.makeTensorInfo(f.shape,f.dtype,f.values)}},K1={kernelName:TI,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{x:r}=t,a=pT.sizeFromShape(r.shape),i=n.data.get(r.dataId).values,s=R_([a,a],r.dtype),o=s.values;for(let u=0;u<i.length;u++)o[u*a+u]=i[u];let l=[...r.shape,...r.shape];return n.makeTensorInfo(l,s.dtype,s.values)}},X1={kernelName:EI,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{let{x:r,filter:a}=e,{strides:i,pad:s,dilations:o}=n,l=t,u=l.data.get(r.dataId).values,d=r.shape.length,c=l.data.get(a.dataId).values,p=a.shape.length,{batchSize:h,inHeight:f,inWidth:m,inChannels:g,outHeight:b,outWidth:y,padInfo:v,strideHeight:x,strideWidth:w,filterHeight:k,filterWidth:S,dilationHeight:I,dilationWidth:N,outShape:C}=_P.computeDilation2DInfo(r.shape,a.shape,i,s,"NHWC",o),T=pT.sizeFromShape(C),E=C.length,_=pT.getArrayFromDType(r.dtype,T);for(let $=0;$<h;++$)for(let e=0;e<b;++e){let t=e*x-v.top;for(let n=0;n<y;++n){let i=n*w-v.left;for(let s=0;s<g;++s){let o=Number.MIN_SAFE_INTEGER;for(let e=0;e<k;++e){let n=t+e*I;if(n>=0&&n<f)for(let t=0;t<S;++t){let l=i+t*N;if(l>=0&&l<m){let i=pT.locToIndex([$,n,l,s],d,pT.computeStrides(r.shape)),h=pT.locToIndex([e,t,s],p,pT.computeStrides(a.shape)),f=u[i]+c[h];f>o&&(o=f)}}}_[pT.locToIndex([$,e,n,s],E,pT.computeStrides(C))]=o}}}return{dataId:l.write(pT.toTypedArray(_,r.dtype),C,r.dtype),shape:C,dtype:r.dtype}}},Y1={kernelName:$I,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{let{x:r,filter:a,dy:i}=e,{strides:s,pad:o,dilations:l}=n,u=t,d=pT.toNestedArray(r.shape,u.data.get(r.dataId).values),c=pT.toNestedArray(a.shape,u.data.get(a.dataId).values),{batchSize:p,inHeight:h,inWidth:f,inChannels:m,outHeight:g,outWidth:b,padInfo:y,strideHeight:v,strideWidth:x,filterHeight:w,filterWidth:k,dilationHeight:S,dilationWidth:I,outShape:N}=_P.computeDilation2DInfo(r.shape,a.shape,s,o,"NHWC",l);pT.assert(i.rank===N.length,(()=>`Error in ${$I}, dy must have the same rank as output ${N.length}, but got ${i.rank}`));let C=pT.toNestedArray(N,u.data.get(i.dataId).values),T=pT.makeZerosNestedTypedArray(a.shape,a.dtype);for(let E=0;E<p;++E)for(let e=0;e<g;++e){let t=e*v-y.top;for(let n=0;n<b;++n){let r=n*x-y.left;for(let a=0;a<m;++a){let i=Number.MIN_SAFE_INTEGER,s=0,o=0;for(let e=0;e<w;++e){let n=t+e*S;if(n>=0&&n<h)for(let t=0;t<k;++t){let l=r+t*I;if(l>=0&&l<f){let r=d[E][n][l][a]+c[e][t][a];r>i&&(i=r,s=e,o=t)}}}T[s][o][a]+=C[E][e][n][a]}}}return{dataId:u.write(pT.toTypedArray(T,r.dtype),a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}},J1={kernelName:_I,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{let{x:r,filter:a,dy:i}=e,{strides:s,pad:o,dilations:l}=n,u=t,d=pT.toNestedArray(r.shape,u.data.get(r.dataId).values),c=pT.toNestedArray(a.shape,u.data.get(a.dataId).values),{batchSize:p,inHeight:h,inWidth:f,inChannels:m,outHeight:g,outWidth:b,padInfo:y,strideHeight:v,strideWidth:x,filterHeight:w,filterWidth:k,dilationHeight:S,dilationWidth:I,outShape:N}=_P.computeDilation2DInfo(r.shape,a.shape,s,o,"NHWC",l);pT.assert(i.rank===N.length,(()=>`Error in ${_I}, dy must have the same rank as output ${N.length}, but got ${i.rank}`));let C=pT.toNestedArray(N,u.data.get(i.dataId).values),T=pT.makeZerosNestedTypedArray(r.shape,r.dtype);for(let E=0;E<p;++E)for(let e=0;e<g;++e){let t=e*v-y.top;for(let n=0;n<b;++n){let r=n*x-y.left;for(let a=0;a<m;++a){let i=Number.MIN_SAFE_INTEGER,s=t<0?0:t,o=r<0?0:r;for(let e=0;e<w;++e){let n=t+e*S;if(n>=0&&n<h)for(let t=0;t<k;++t){let l=r+t*I;if(l>=0&&l<f){let r=d[E][n][l][a]+c[e][t][a];r>i&&(i=r,s=n,o=l)}}}T[E][s][o][a]+=C[E][e][n][a]}}}return{dataId:u.write(pT.toTypedArray(T,r.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},Z1={kernelName:AI,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{image:a}=t,{canvas:i,options:s}=r,{contextOptions:o,imageOptions:l}=s||{},u=(null==l?void 0:l.alpha)||1,d=(null==o?void 0:o.contextType)||"2d";if("2d"!==d)throw new Error(`Context type ${o.contextType} is not supported by the CPU backend.`);let c=i.getContext(d,(null==o?void 0:o.contextAttributes)||{});if(null==c)throw new Error(`Could not get the context with ${d} type.`);let[p,h]=a.shape.slice(0,2),f=2===a.shape.length?1:a.shape[2],m=n.data.get(a.dataId).values,g="float32"===a.dtype?255:1,b=new Uint8ClampedArray(h*p*4);for(let v=0;v<p*h;++v){let e=[0,0,0,255*u];for(let n=0;n<f;n++){let t=m[v*f+n];if("float32"===a.dtype){if(t<0||t>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${t}.`)}else if("int32"===a.dtype&&(t<0||t>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${t}.`);1===f?(e[0]=t*g,e[1]=t*g,e[2]=t*g):e[n]=t*g}let t=4*v;b[t+0]=Math.round(e[0]),b[t+1]=Math.round(e[1]),b[t+2]=Math.round(e[2]),b[t+3]=Math.round(e[3])}i.width=h,i.height=p;let y=new ImageData(b,h,p);return c.putImageData(y,0,0),a}};function Q1(e){let t,{inputs:n,backend:r,attrs:a}=e,{x:i}=n,{axis:s,keepDims:o}=a;YJ(i,"sum"),t="bool"===i.dtype?cZ({inputs:{x:i},backend:r,attrs:{dtype:"int32"}}):sZ({inputs:{x:i},backend:r});let l=t.shape.length,u=pT.parseAxisParam(s,t.shape),d=_P.getAxesPermutation(u,l),c=u,p=t;null!=d&&(p=TQ({inputs:{x:t},backend:r,attrs:{perm:d}}),c=_P.getInnerMostAxes(c.length,l)),_P.assertAxesAreInnerMostDims("sum",c,p.shape.length);let[h,f]=_P.computeOutAndReduceShapes(p.shape,c),m=iZ(r,h,_P.upcastType(p.dtype,"int32")),g=pT.sizeFromShape(f),b=r.data.get(m.dataId).values,y=r.data.get(p.dataId).values;for(let v=0;v<b.length;++v){let e=v*g,t=0;for(let n=0;n<g;++n)t+=y[e+n];b[v]=t}if(o){let e=m;m=z0({inputs:{x:m},backend:r,attrs:{shape:_P.expandShapeToKeepDim(m.shape,u)}}),r.disposeIntermediateTensorInfo(e)}return r.disposeIntermediateTensorInfo(t),null!=d&&r.disposeIntermediateTensorInfo(p),m}var e2={kernelName:vC,backendName:"cpu",kernelFunc:Q1},t2={kernelName:DI,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{equation:a}=r,i=t,{allDims:s,summedDims:o,idDims:l}=_P.decodeEinsumEquation(a,i.length);_P.checkEinsumDimSizes(s.length,l,i);let{path:u,steps:d}=_P.getEinsumComputePath(o,l),c=d.length,p=null,h=s.length,f=[];for(let m=0;m<c;++m){for(let e of d[m]){let t,{permutationIndices:r,expandDims:a}=_P.getEinsumPermutation(h,l[e]);_P.isIdentityPermutation(r)?t=i[e]:(t=TQ({inputs:{x:i[e]},backend:n,attrs:{perm:r}}),f.push(t));let s=t.shape.slice();for(let e=0;e<a.length;++e)s.splice(a[e],0,1);pT.arraysEqual(t.shape,s)||(t=z0({inputs:{x:t},backend:n,attrs:{shape:s}}),f.push(t)),null===p?p=t:(p=vQ({inputs:{a:t,b:p},backend:n}),f.push(p))}m<c-1&&(u[m]>=0&&(p=Q1({inputs:{x:p},backend:n,attrs:{axis:u[m]-(s.length-h),keepDims:!1}}),f.push(p)),h--)}for(let m of f)m!==p&&n.disposeIntermediateTensorInfo(m);return p}},n2={kernelName:MI,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{dy:r,y:a}=t;YJ([r,a],"eluGrad");let i=new Float32Array(pT.sizeFromShape(a.shape)),s=n.data.get(a.dataId).values,o=n.data.get(r.dataId).values;for(let l=0;l<s.length;++l){let e=s[l];i[l]=e>=0?o[l]:o[l]*(e+1)}return n.makeTensorInfo(a.shape,"float32",i)}},r2=_P.ERF_P,a2=_P.ERF_A1,i2=_P.ERF_A2,s2=_P.ERF_A3,o2=_P.ERF_A4,l2=_P.ERF_A5,u2=NZ(OI,(e=>{let t=Math.sign(e),n=Math.abs(e),r=1/(1+r2*n);return t*(1-((((l2*r+o2)*r+s2)*r+i2)*r+a2)*r*Math.exp(-n*n))})),d2={kernelName:OI,backendName:"cpu",kernelFunc:u2};function c2(e){let{inputs:t,backend:n,attrs:r}=e,{input:a}=t,{dim:i}=r,s=a.shape.length,o=a.shape.slice(),l=i;return i<0&&(pT.assert(-(s+1)<=i,(()=>`Axis must be in the interval [${-(s+1)}, ${s}]`)),l=s+i+1),o.splice(l,0,1),z0({inputs:{x:a},backend:n,attrs:{shape:o}})}var p2={kernelName:zI,backendName:"cpu",kernelFunc:c2},h2=nZ(((e,t)=>e/t)),f2=hZ(RI,h2),m2={kernelName:RI,backendName:"cpu",kernelFunc:f2};function g2(e,t,n){let r=e.shape,a=r[0],i=r[1],s=n.data.get(e.dataId),o=s.complexTensorInfos.real,l=s.complexTensorInfos.imag,u=[a,i],d=pT.sizeFromShape(u),c=pT.getTypedArrayFromDType("float32",d),p=pT.getTypedArrayFromDType("float32",d);for(let g=0;g<a;g++){let e=JQ({inputs:{x:o},backend:n,attrs:{begin:[g,0],size:[1,i]}}),r=JQ({inputs:{x:l},backend:n,attrs:{begin:[g,0],size:[1,i]}}),a=rZ({inputs:{real:e,imag:r},backend:n}),{real:s,imag:u}=b2(a,t,n),d=_P.mergeRealAndImagArrays(s,u);for(let t=0;t<i;t++){let e=_P.getComplexWithIndex(d,t);c[g*i+t]=e.real,p[g*i+t]=e.imag}n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(a)}let h=n.makeTensorInfo(u,"float32",c),f=n.makeTensorInfo(u,"float32",p),m=rZ({inputs:{real:h,imag:f},backend:n});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),m}function b2(e,t,n){let r=pT.sizeFromShape(e.shape),a=n.data.get(e.dataId),i=n.data.get(a.complexTensorInfos.real.dataId).values,s=n.data.get(a.complexTensorInfos.imag.dataId).values;if(function(e){return 0==(e&e-1)}(r)){let a=y2(i,s,r,t,n),o=[e.shape[0],e.shape[1]];if(t){let e=n.makeTensorInfo(o,"float32",a.real),t=n.makeTensorInfo(o,"float32",a.imag),i=n.makeTensorInfo([],"float32",pT.createScalarValue(r,"float32")),s=sZ({inputs:{x:i},backend:n}),l=m2.kernelFunc({inputs:{a:e,b:i},backend:n}),u=m2.kernelFunc({inputs:{a:t,b:s},backend:n}),d=n.data.get(l.dataId).values,c=n.data.get(u.dataId).values;return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(u),{real:d,imag:c}}return a}{let e=function(e,t,n){let r=new Float32Array(2*t);for(let a=0;a<t;a++){let i=0,s=0;for(let r=0;r<t;r++){let o=_P.exponent(a*r,t,n),l=_P.getComplexWithIndex(e,r);i+=l.real*o.real-l.imag*o.imag,s+=l.real*o.imag+l.imag*o.real}n&&(i/=t,s/=t),_P.assignToTypedArray(r,i,s,a)}return r}(_P.mergeRealAndImagArrays(i,s),r,t);return _P.splitRealAndImagArrays(e)}}function y2(e,t,n,r,a){if(1===n)return{real:e,imag:t};let i=_P.mergeRealAndImagArrays(e,t),s=n/2,o=_P.complexWithEvenIndex(i),l=o.real,u=o.imag,d=[l.length],c=a.makeTensorInfo(d,"float32",l),p=a.makeTensorInfo(d,"float32",u),h=rZ({inputs:{real:c,imag:p},backend:a}),f=_P.complexWithOddIndex(i),m=f.real,g=f.imag,b=[m.length],y=a.makeTensorInfo(b,"float32",m),v=a.makeTensorInfo(b,"float32",g),x=rZ({inputs:{real:y,imag:v},backend:a}),w=y2(l,u,s,r,a),k=w.real,S=w.imag,I=[k.length],N=a.makeTensorInfo(I,"float32",k),C=a.makeTensorInfo(I,"float32",S),T=rZ({inputs:{real:N,imag:C},backend:a}),E=y2(m,g,s,r,a),_=E.real,$=E.imag,A=[_.length],R=a.makeTensorInfo(A,"float32",_),D=a.makeTensorInfo(A,"float32",$),F=rZ({inputs:{real:R,imag:D},backend:a}),M=_P.exponents(n,r),O=[M.real.length],P=a.makeTensorInfo(O,"float32",M.real),L=a.makeTensorInfo(O,"float32",M.imag),z=rZ({inputs:{real:P,imag:L},backend:a}),B=vQ({inputs:{a:z,b:F},backend:a}),W=bZ({inputs:{a:T,b:B},backend:a}),V=v0({inputs:{a:T,b:B},backend:a}),U=lZ({inputs:{input:W},backend:a}),j=lZ({inputs:{input:V},backend:a}),H=I1({inputs:{input:W},backend:a}),G=I1({inputs:{input:V},backend:a}),q=C1({inputs:[U,j],backend:a,attrs:{axis:0}}),K=C1({inputs:[H,G],backend:a,attrs:{axis:0}}),X=a.data.get(q.dataId).values,Y=a.data.get(K.dataId).values;return a.disposeIntermediateTensorInfo(c),a.disposeIntermediateTensorInfo(p),a.disposeIntermediateTensorInfo(h),a.disposeIntermediateTensorInfo(y),a.disposeIntermediateTensorInfo(v),a.disposeIntermediateTensorInfo(x),a.disposeIntermediateTensorInfo(N),a.disposeIntermediateTensorInfo(C),a.disposeIntermediateTensorInfo(T),a.disposeIntermediateTensorInfo(R),a.disposeIntermediateTensorInfo(D),a.disposeIntermediateTensorInfo(F),a.disposeIntermediateTensorInfo(P),a.disposeIntermediateTensorInfo(L),a.disposeIntermediateTensorInfo(z),a.disposeIntermediateTensorInfo(B),a.disposeIntermediateTensorInfo(W),a.disposeIntermediateTensorInfo(V),a.disposeIntermediateTensorInfo(U),a.disposeIntermediateTensorInfo(H),a.disposeIntermediateTensorInfo(j),a.disposeIntermediateTensorInfo(G),a.disposeIntermediateTensorInfo(q),a.disposeIntermediateTensorInfo(K),{real:X,imag:Y}}var v2={kernelName:WI,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{input:r}=t,a=pT.sizeFromShape(r.shape),i=r.shape[r.shape.length-1],s=z0({inputs:{x:r},backend:n,attrs:{shape:[a/i,i]}}),o=g2(s,!1,n),l=z0({inputs:{x:o},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),l}};function x2(e){let{backend:t,attrs:n}=e,{shape:r,value:a,dtype:i}=n,s=i||pT.inferDtype(a),o=pT.getArrayFromDType(s,pT.sizeFromShape(r));return function(e,t,n){e.fill(t)}(o,a),t.makeTensorInfo(r,s,o)}var w2={kernelName:VI,backendName:"cpu",kernelFunc:x2},k2={kernelName:UI,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{image:r}=e,a=n,i=pT.getTypedArrayFromDType(r.dtype,pT.sizeFromShape(r.shape)),[s,o,l,u]=r.shape,d=a.data.get(r.dataId).values;for(let c=0;c<s;c++){let e=c*l*o*u;for(let t=0;t<o;t++){let n=t*(l*u);for(let t=0;t<l;t++){let r=t*u;for(let a=0;a<u;a++){let s=Math.round(l-t-1),o=e+n+r+a,c=d[o];s>=0&&s<l&&(c=d[e+n+s*u+a]),i[o]=c}}}}return{dataId:a.write(i,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},S2={kernelName:JC,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i,bias:s,preluActivationWeights:o}=t,{strides:l,pad:u,dataFormat:d,dilations:c,dimRoundingMode:p,activation:h,leakyreluAlpha:f}=r,m=E1({inputs:{x:a,filter:i},backend:n,attrs:{strides:l,pad:u,dataFormat:d,dilations:c,dimRoundingMode:p}});if(s){let e=m;if("NCHW"===d&&1===s.shape.length&&1!==s.shape[0]){let e=z0({inputs:{x:s},backend:n,attrs:{shape:[s.shape[0],1,1]}});m=bZ({inputs:{a:m,b:e},backend:n}),n.disposeIntermediateTensorInfo(e)}else m=bZ({inputs:{a:m,b:s},backend:n});n.disposeIntermediateTensorInfo(e)}if(h){let e=m;if("NCHW"===d&&"prelu"===h&&1===o.shape.length&&1!==o.shape[0]){let e=z0({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});m=L0(n,m,h,e,f),n.disposeIntermediateTensorInfo(e)}else m=L0(n,m,h,o,f);n.disposeIntermediateTensorInfo(e)}return m}},I2={kernelName:ZC,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i,bias:s,preluActivationWeights:o}=t,{strides:l,pad:u,dataFormat:d,dilations:c,dimRoundingMode:p,activation:h,leakyreluAlpha:f}=r,m=j1({inputs:{x:a,filter:i},backend:n,attrs:{strides:l,pad:u,dataFormat:d,dilations:c,dimRoundingMode:p}});if(s){let e=m;m=bZ({inputs:{a:m,b:s},backend:n}),n.disposeIntermediateTensorInfo(e)}if(h){let e=m;m=L0(n,m,h,o,f),n.disposeIntermediateTensorInfo(e)}return m}},N2={kernelName:KI,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{params:r,indices:a}=t,i=pT.sizeFromShape(r.shape),s=a.shape,o=s[s.length-1],[l,u,d,c]=_P.prepareAndValidate(r,a);if(0===u)return n.makeTensorInfo(l,r.dtype,[]);let p=GZ(n.data.get(a.dataId).values,n.bufferSync(r),r.dtype,u,o,d,c,r.shape,i);return n.makeTensorInfo(l,r.dtype,p.values)}},C2={kernelName:qI,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,indices:i}=t,{axis:s,batchDims:o}=r;YJ([a,i],"gatherV2");let l=pT.parseAxisParam(s,a.shape)[0],u=n.data.get(i.dataId).values,d=a.shape[l];for(let v=0;v<u.length;++v){let e=u[v];pT.assert(e<=d-1&&e>=0,(()=>`GatherV2: the index value ${e} is not in [0, ${d-1}]`))}let c=o;null==o&&(c=0);let p=pT.sizeFromShape(i.shape),h=_P.segment_util.collectGatherOpShapeInfo(a,i,l,c),f=z0({inputs:{x:a},backend:n,attrs:{shape:[h.batchSize,h.outerSize,h.dimSize,h.sliceSize]}}),m=z0({inputs:{x:i},backend:n,attrs:{shape:[h.batchSize,p/h.batchSize]}}),g=[h.batchSize,h.outerSize,p/h.batchSize,h.sliceSize],b=n.bufferSync(m),y=qZ(n.bufferSync(f),b,g);return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.makeTensorInfo(h.outputShape,y.dtype,y.values)}},T2={kernelName:ZI,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{input:r}=t,a=pT.sizeFromShape(r.shape),i=r.shape[r.shape.length-1],s=z0({inputs:{x:r},backend:n,attrs:{shape:[a/i,i]}}),o=g2(s,!0,n),l=z0({inputs:{x:o},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),l}},E2=NZ(eN,(e=>Number.isFinite(e)?1:0),"bool"),_2={kernelName:eN,backendName:"cpu",kernelFunc:E2},$2=NZ(tN,(e=>Math.abs(e)===1/0?1:0),"bool"),A2={kernelName:tN,backendName:"cpu",kernelFunc:$2},R2=NZ(nN,(e=>Number.isNaN(e)?1:0),"bool"),D2={kernelName:nN,backendName:"cpu",kernelFunc:R2},F2={kernelName:sN,backendName:"cpu",kernelFunc:function(e){let{backend:t,attrs:n}=e,{start:r,stop:a,num:i}=n,s=sQ(r,a,i);return t.makeTensorInfo([s.length],"float32",s)}},M2=NZ(lN,(e=>Math.log1p(e))),O2={kernelName:lN,backendName:"cpu",kernelFunc:M2},P2=nZ(((e,t)=>e&&t)),L2=hZ(uN,P2,null,"bool"),z2={kernelName:uN,backendName:"cpu",kernelFunc:L2},B2=NZ(dN,(e=>e?0:1),"bool"),W2={kernelName:dN,backendName:"cpu",kernelFunc:B2},V2=nZ(((e,t)=>e||t)),U2=hZ(cN,V2,null,"bool"),j2={kernelName:cN,backendName:"cpu",kernelFunc:U2},H2={kernelName:mN,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{depthRadius:i,bias:s,alpha:o,beta:l}=r;YJ(a,"LRN");let u=a.shape[3],d=u-1,c=n.data.get(a.dataId).values,p=pT.sizeFromShape(a.shape),h=new Float32Array(p);function f(e){let t=e%u,n=e-t+Math.max(0,t-i),r=e-t+Math.min(t+i,d),a=0;for(;n<=r;n++){let e=c[n];a+=e*e}return a}for(let m=0;m<p;m++){let e=f(m),t=c[m]*Math.pow(s+o*e,-l);h[m]=t}return n.makeTensorInfo(a.shape,a.dtype,h)}},G2={kernelName:gN,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,y:i,dy:s}=t,{depthRadius:o,bias:l,alpha:u,beta:d}=r;YJ(s,"LRNGrad");let c=pT.sizeFromShape(s.shape),p=s.shape[3],h=n.data.get(s.dataId).values,f=n.data.get(a.dataId).values,m=n.data.get(i.dataId).values,g=new Float32Array(c),b=c;for(let y=0;y<b;y++){let e=y%p,t=y-e+Math.max(0,e-o),n=y-e+Math.min(p,e+o+1),r=0;for(let a=t;a<n;a++)r+=Math.pow(f[a],2);r=u*r+l;for(let a=t;a<n;a++){let e=-2*u*d*f[a]*m[y]/r;y===a&&(e+=Math.pow(r,-d)),e*=h[y],g[a]+=e}}return n.makeTensorInfo(s.shape,a.dtype,g)}};function q2(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{reductionIndices:i,keepDims:s}=r,o=n,l=a.shape,u=l.length,d=pT.parseAxisParam(i,l),c=d,p=_P.getAxesPermutation(c,u),h=o.data.get(a.dataId).values;if(null!=p){let e=new Array(u);for(let t=0;t<e.length;t++)e[t]=l[p[t]];h=CQ(h,l,a.dtype,p,e),c=_P.getInnerMostAxes(c.length,u),l=e}YJ(a,"max"),_P.assertAxesAreInnerMostDims("max",c,u);let[f,m]=_P.computeOutAndReduceShapes(l,c),g=dQ(h,pT.sizeFromShape(m),f,a.dtype),b=o.write(g,f,a.dtype),y=f;return s&&(y=_P.expandShapeToKeepDim(f,d)),{dataId:b,shape:y,dtype:a.dtype}}var K2={kernelName:yN,backendName:"cpu",kernelFunc:q2},X2={kernelName:xN,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t;YJ(a,"maxPool");let{filterSize:i,strides:s,pad:o,dimRoundingMode:l}=r;pT.assert(_P.eitherStridesOrDilationsAreOne(s,1),(()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${s} and dilations '1'`));let u,d=_P.computePool2DInfo(a.shape,i,s,1,o,l);if(1===d.filterWidth&&1===d.filterHeight&&pT.arraysEqual(d.inShape,d.outShape))u=sZ({inputs:{x:a},backend:n});else{let e=n.data.get(a.dataId).values,t=pT.computeStrides(a.shape),r=d1(e,a.shape,a.dtype,t,d,"max");u=n.makeTensorInfo(d.outShape,a.dtype,r.values)}return u}},Y2={kernelName:kN,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:i,strides:s,pad:o,dimRoundingMode:l,dataFormat:u}=r;YJ(a,"maxPool3d");let d=_P.computePool3DInfo(a.shape,i,s,1,o,l,u),c=p1(n.data.get(a.dataId).values,a.shape,a.dtype,pT.computeStrides(a.shape),d,"max");return n.makeTensorInfo(c.shape,"float32",c.values)}},J2={kernelName:SN,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,{filterSize:s,strides:o,pad:l,dimRoundingMode:u}=r;YJ([a,i],"maxPool3DGrad");let d=_P.computePool3DInfo(i.shape,s,o,1,l,u),c=function(e,t){let n=R_(t.outShape,"int32"),r=t.strideDepth,a=t.strideHeight,i=t.strideWidth,s=t.dilationDepth,o=t.dilationHeight,l=t.dilationWidth,u=t.effectiveFilterDepth,d=t.effectiveFilterHeight,c=t.effectiveFilterWidth,p=t.padInfo.front,h=t.padInfo.top,f=t.padInfo.left;for(let m=0;m<t.batchSize;++m)for(let g=0;g<t.inChannels;++g)for(let b=0;b<t.outDepth;++b){let y=b*r-p,v=y;for(;v<0;)v+=s;let x=Math.min(t.inDepth,u+y);for(let r=0;r<t.outHeight;++r){let u=r*a-h,p=u;for(;p<0;)p+=o;let w=Math.min(t.inHeight,d+u);for(let a=0;a<t.outWidth;++a){let h=a*i-f,k=h;for(;k<0;)k+=l;let S=Math.min(t.inWidth,c+h),I=Number.NEGATIVE_INFINITY,N=-1;for(let t=v;t<x;t+=s){let n=t-y;for(let r=p;r<w;r+=o){let a=r-u;for(let i=k;i<S;i+=l){let s=i-h,o=e.get(m,t,r,i,g);o>=I&&(I=o,N=n*d*c+a*d+s)}}}n.set(N,m,b,r,a,g)}}}return n}(n.bufferSync(i),d),p=d.strideDepth,h=d.strideHeight,f=d.strideWidth,m=d.dilationDepth,g=d.dilationHeight,b=d.dilationWidth,y=d.effectiveFilterDepth,v=d.effectiveFilterHeight,x=d.effectiveFilterWidth,w=y-1-d.padInfo.front,k=x-1-d.padInfo.left,S=v-1-d.padInfo.top,I=R_(i.shape,"float32"),N=n.bufferSync(a);for(let C=0;C<d.batchSize;++C)for(let e=0;e<d.inChannels;++e)for(let t=0;t<d.inDepth;++t)for(let n=0;n<d.inHeight;++n)for(let r=0;r<d.inWidth;++r){let a=t-w,i=n-S,s=r-k,o=0;for(let t=0;t<y;t+=m){let n=(a+t)/p;if(!(n<0||n>=d.outDepth||Math.floor(n)!==n))for(let r=0;r<v;r+=g){let a=(i+r)/h;if(!(a<0||a>=d.outHeight||Math.floor(a)!==a))for(let i=0;i<x;i+=b){let l=(s+i)/f;if(l<0||l>=d.outWidth||Math.floor(l)!==l)continue;let u=y*v*x-1-c.get(C,n,a,l,e)===t*v*x+r*x+i?1:0;0!==u&&(o+=N.get(C,n,a,l,e)*u)}}}I.set(o,C,t,n,r,e)}return n.makeTensorInfo(I.shape,I.dtype,I.values)}},Z2={kernelName:wN,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i,output:s}=t,o=i;YJ([i,s],"maxPoolGrad");let{filterSize:l,strides:u,pad:d,dimRoundingMode:c}=r,p=_P.computePool2DInfo(o.shape,l,u,1,d,c),h=n.data.get(o.dataId).values,f=R_(p.outShape,o.dtype,c1(h,o.shape,o.dtype,p).values),m=p.strideHeight,g=p.strideWidth,b=p.dilationHeight,y=p.dilationWidth,v=p.effectiveFilterHeight,x=p.effectiveFilterWidth,w=x-1-p.padInfo.left,k=v-1-p.padInfo.top,S=R_(o.shape,"float32"),I=n.data.get(a.dataId).values,N=R_(a.shape,"float32",I);for(let C=0;C<p.batchSize;++C)for(let e=0;e<p.inChannels;++e)for(let t=0;t<p.inHeight;++t)for(let n=0;n<p.inWidth;++n){let r=t-k,a=n-w,i=0;for(let t=0;t<v;t+=b){let n=(r+t)/m;if(!(n<0||n>=p.outHeight||Math.floor(n)!==n))for(let r=0;r<x;r+=y){let s=(a+r)/g;if(s<0||s>=p.outWidth||Math.floor(s)!==s)continue;let o=v*x-1-f.get(C,n,s,e)===t*x+r?1:0;0!==o&&(i+=N.get(C,n,s,e)*o)}}S.set(i,C,t,n,e)}return n.makeTensorInfo(S.shape,S.dtype,S.values)}},Q2={kernelName:IN,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{x:r}=e,{filterSize:a,strides:i,pad:s,includeBatchInIndex:o}=t,l=n;YJ(r,"MaxPoolWithArgmax");let u=l.data.get(r.dataId).values,d=_P.computePool2DInfo(r.shape,a,i,[1,1],s),[c,p]=function(e,t,n,r,a){let i=d1(e,0,n,pT.computeStrides(t),a,"max"),s=c1(e,t,n,a,!0,r);return[i.values,s.values]}(u,r.shape,r.dtype,o,d),h=l.write(c,d.outShape,r.dtype),f=l.write(p,d.outShape,r.dtype);return[{dataId:h,shape:d.outShape,dtype:r.dtype},{dataId:f,shape:d.outShape,dtype:"int32"}]}},e3={kernelName:NN,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:s}=r,o=pT.parseAxisParam(i,a.shape),l=_P.computeOutAndReduceShapes(a.shape,o)[1],u=pT.sizeFromShape(l),d=[],c=n.makeTensorInfo([],"float32",new Float32Array([u]));d.push(c);let p=cZ({inputs:{x:a},backend:n,attrs:{dtype:"float32"}});d.push(p);let h=f2({inputs:{a:p,b:c},backend:n});d.push(h);let f=Q1({inputs:{x:h},backend:n,attrs:{axis:i,keepDims:s}});return d.forEach((e=>n.disposeIntermediateTensorInfo(e))),f}},t3={kernelName:CN,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:s}=r;YJ(a,"min");let o=pT.parseAxisParam(i,a.shape),l=o,u=_P.getAxesPermutation(l,a.shape.length),d=a;null!=u&&(d=TQ({inputs:{x:a},backend:n,attrs:{perm:u}}),l=_P.getInnerMostAxes(l.length,a.shape.length)),_P.assertAxesAreInnerMostDims("min",l,d.shape.length);let[c,p]=_P.computeOutAndReduceShapes(d.shape,l),h=pT.sizeFromShape(p),f=pT.makeZerosTypedArray(pT.sizeFromShape(c),d.dtype),m=n.data.get(d.dataId).values;for(let b=0;b<f.length;++b){let e=b*h,t=m[e];for(let n=0;n<h;++n){let r=m[e+n];(Number.isNaN(r)||r<t)&&(t=r)}f[b]=t}null!=u&&n.disposeIntermediateTensorInfo(d);let g=n.makeTensorInfo(c,d.dtype,f);if(s){let e=z0({inputs:{x:g},backend:n,attrs:{shape:_P.expandShapeToKeepDim(c,o)}});return n.disposeIntermediateTensorInfo(g),e}return g}},n3={kernelName:EN,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{paddings:i,mode:s}=r;YJ(a,"mirrorPad");let o=i.map(((e,t)=>e[0]+a.shape[t]+e[1])),l=i.map((e=>e[0])),u=i.map(((e,t)=>e[0]+a.shape[t])),d="reflect"===s?0:1,c=n.data.get(a.dataId).values,p=a.shape.length,h=pT.computeStrides(a.shape),f=pT.sizeFromShape(o),m=o.length,g=pT.computeStrides(o),b=pT.getTypedArrayFromDType(a.dtype,f);for(let y=0;y<f;y++){let e=pT.indexToLoc(y,m,g);for(let n=0;n<m;n++)e[n]<l[n]?e[n]=2*l[n]-e[n]-d:e[n]>=u[n]&&(e[n]=2*(u[n]-1)-e[n]+d);e=e.map(((e,t)=>e-l[t]));let t=pT.locToIndex(e,p,h);b[y]=c[t]}return{dataId:n.write(b,o,a.dtype),shape:o,dtype:a.dtype}}},r3=nZ(((e,t)=>{let n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t})),a3=hZ(_N,r3),i3={kernelName:_N,backendName:"cpu",kernelFunc:a3},s3=lk(xk());function o3(e){let{inputs:t,backend:n,attrs:r}=e,{logits:a}=t,{dim:i}=r,s=a.shape.length,o=i;if(-1===o&&(o=s-1),o!==s-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${s} and dim was ${o}`);let l=pT.parseAxisParam([o],a.shape),u=q2({inputs:{x:a},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),d=_P.expandShapeToKeepDim(u.shape,l),c=z0({inputs:{x:u},backend:n,attrs:{shape:d}}),p=v0({inputs:{a:a,b:c},backend:n}),h=MZ({inputs:{x:p},backend:n}),f=Q1({inputs:{x:h},backend:n,attrs:{axis:l,keepDims:!1}}),m=z0({inputs:{x:f},backend:n,attrs:{shape:d}}),g=f2({inputs:{a:h,b:m},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),g}var l3={kernelName:kC,backendName:"cpu",kernelFunc:o3},u3={kernelName:$N,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{logits:a}=t,{numSamples:i,seed:s,normalized:o}=r;YJ(a,"multinomial");let l=o?a:o3({inputs:{logits:a},backend:n,attrs:{dim:-1}}),u=l.shape[0],d=l.shape[1],c=n.data.get(l.dataId).values,p=[u,i],h=pT.makeZerosTypedArray(pT.sizeFromShape(p),"int32");for(let f=0;f<u;++f){let e=f*d,t=new Float32Array(d-1);t[0]=c[e];for(let a=1;a<t.length;++a)t[a]=t[a-1]+c[e+a];let n=s3.alea(s.toString()),r=f*i;for(let a=0;a<i;++a){let e=n();h[r+a]=t.length;for(let n=0;n<t.length;n++)if(e<t[n]){h[r+a]=n;break}}}return o||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(p,"int32",h)}},d3=ML.nonMaxSuppressionV3Impl,c3={kernelName:FN,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:i}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l}=r;YJ(a,"NonMaxSuppression");let u=n.data.get(a.dataId).values,d=n.data.get(i.dataId).values,{selectedIndices:c}=d3(u,d,s,o,l);return n.makeTensorInfo([c.length],"int32",new Int32Array(c))}},p3=ML.nonMaxSuppressionV4Impl,h3={kernelName:MN,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:i}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:u}=r;YJ(a,"NonMaxSuppressionPadded");let d=n.data.get(a.dataId).values,c=n.data.get(i.dataId).values,{selectedIndices:p,validOutputs:h}=p3(d,c,s,o,l,u);return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([],"int32",new Int32Array([h]))]}},f3=ML.nonMaxSuppressionV5Impl,m3={kernelName:ON,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:i}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l,softNmsSigma:u}=r;YJ(a,"NonMaxSuppressionWithScore");let d=n.data.get(a.dataId).values,c=n.data.get(i.dataId).values,p=s,h=o,f=l,m=u,{selectedIndices:g,selectedScores:b}=f3(d,c,p,h,f,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([b.length],"float32",new Float32Array(b))]}},g3={kernelName:LN,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{indices:a}=t,{dtype:i,depth:s,onValue:o,offValue:l}=r;YJ(a,"oneHot");let u=pT.sizeFromShape(a.shape),d=new Float32Array(u*s);d.fill(l);let c=n.data.get(a.dataId).values;for(let p=0;p<u;++p)c[p]>=0&&c[p]<s&&(d[p*s+c[p]]=o);return n.makeTensorInfo([...a.shape,s],i,d)}};function b3(e){let{inputs:t,backend:n}=e,{x:r}=t;if("string"===r.dtype)throw new Error("zerosLike is not supported for string tensors");if("complex64"===r.dtype){let e=lZ({inputs:{input:r},backend:n}),t=b3({inputs:{x:e},backend:n}),a=I1({inputs:{input:r},backend:n}),i=b3({inputs:{x:a},backend:n}),s=rZ({inputs:{real:t,imag:i},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),s}return x2({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}var y3={kernelName:GC,backendName:"cpu",kernelFunc:b3},v3={kernelName:PN,backendName:"cpu",kernelFunc:function e(t){let{inputs:n,backend:r}=t,{x:a}=n;if("string"===a.dtype)throw new Error("onesLike is not supported for string tensors");if("complex64"===a.dtype){let t=lZ({inputs:{input:a},backend:r}),n=e({inputs:{x:t},backend:r}),i=I1({inputs:{input:a},backend:r}),s=b3({inputs:{x:i},backend:r}),o=rZ({inputs:{real:n,imag:s},backend:r});return r.disposeIntermediateTensorInfo(t),r.disposeIntermediateTensorInfo(n),r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(s),o}return x2({backend:r,attrs:{shape:a.shape,value:1,dtype:a.dtype}})}};function x3(e){let{inputs:t,backend:n,attrs:r}=e,{axis:a}=r;if(1===t.length)return c2({inputs:{input:t[0]},backend:n,attrs:{dim:a}});let i=t[0].shape,s=t[0].dtype;t.forEach((e=>{pT.assertShapesMatch(i,e.shape,"All tensors passed to stack must have matching shapes"),pT.assert(s===e.dtype,(()=>"All tensors passed to stack must have matching dtypes"))}));let o=[],l=t.map((e=>{let t=c2({inputs:{input:e},backend:n,attrs:{dim:a}});return o.push(t),t})),u=C1({inputs:l,backend:n,attrs:{axis:a}});return o.forEach((e=>n.disposeIntermediateTensorInfo(e))),u}var w3={kernelName:zN,backendName:"cpu",kernelFunc:x3},k3={kernelName:BN,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{paddings:i,constantValue:s}=r;YJ(a,"pad");let o=i.map(((e,t)=>e[0]+a.shape[t]+e[1])),l=i.map((e=>e[0])),u=n.data.get(a.dataId).values,d=pT.sizeFromShape(a.shape),c=a.shape.length,p=pT.computeStrides(a.shape),h=pT.sizeFromShape(o),f=o.length,m=pT.computeStrides(o),g=pT.getTypedArrayFromDType(a.dtype,h);0!==s&&g.fill(s);for(let b=0;b<d;b++){let e=pT.indexToLoc(b,c,p).map(((e,t)=>e+l[t]));g[pT.locToIndex(e,f,m)]=u[b]}return{dataId:n.write(g,o,a.dtype),shape:o,dtype:a.dtype}}},S3=nZ(((e,t)=>Math.pow(e,t))),I3=hZ(VN,S3),N3={kernelName:VN,backendName:"cpu",kernelFunc:I3},C3={kernelName:HN,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{paramsNestedSplits:a,paramsDenseValues:i,indices:s}=t,o=a.map((e=>n.data.get(e.dataId).values)),l=a.map((e=>e.shape)),u=n.data.get(i.dataId).values,d=n.data.get(s.dataId).values,[c,p,h]=FQ(o,l,u,i.shape,i.dtype,d,s.shape),f=c.map((e=>n.makeTensorInfo([e.length],"int32",e))),m=n.makeTensorInfo(h,i.dtype,p);return f.concat([m])}},T3={kernelName:GN,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{starts:r,limits:a,deltas:i}=t,s=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,[u,d]=OQ(s,r.shape,r.dtype,o,a.shape,l,i.shape);return[n.makeTensorInfo([u.length],"int32",u),n.makeTensorInfo([d.length],r.dtype,d)]}},E3={kernelName:qN,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{shape:a,values:i,defaultValue:s,rowPartitionTensors:o}=t,{rowPartitionTypes:l}=r,u=n.data.get(a.dataId).values,d=n.data.get(i.dataId).values,c=n.data.get(s.dataId).values,p=o.map((e=>n.data.get(e.dataId).values)),h=o.map((e=>e.shape)),[f,m]=WQ(u,a.shape,d,i.shape,i.dtype,c,s.shape,p,h,l);return n.makeTensorInfo(f,i.dtype,m)}},_3={kernelName:KN,backendName:"cpu",kernelFunc:function(e){let{backend:t,attrs:n}=e,{start:r,stop:a,dtype:i,step:s}=n,o=VQ(r,a,s,i);return t.makeTensorInfo([o.length],i,o)}},$3=NZ(YN,(e=>1/e)),A3={kernelName:YN,backendName:"cpu",kernelFunc:$3},R3={kernelName:tC,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{images:a}=t,{alignCorners:i,halfPixelCenters:s,size:o}=r;YJ(a,"resizeBilinear");let l=pT.computeStrides(a.shape),[u,d]=o,[c,p,h,f]=a.shape,m=n.data.get(a.dataId).values,g=new Float32Array(pT.sizeFromShape([c,u,d,f])),b=[i&&u>1?p-1:p,i&&d>1?h-1:h],y=[i&&u>1?u-1:u,i&&d>1?d-1:d],v=0,x=b[0]/y[0],w=b[1]/y[1];for(let k=0;k<c;k++)for(let e=0;e<u;e++){let t;t=s?x*(e+.5)-.5:x*e;let n=Math.max(0,Math.floor(t)),r=t-n,a=Math.min(p-1,Math.ceil(t)),i=k*l[0]+n*l[1],o=k*l[0]+a*l[1];for(let e=0;e<d;e++){let t;t=s?w*(e+.5)-.5:w*e;let n=Math.max(0,Math.floor(t)),a=t-n,u=Math.min(h-1,Math.ceil(t)),d=i+n*l[2],c=o+n*l[2],p=i+u*l[2],b=o+u*l[2];for(let e=0;e<f;e++){let t=m[d+e],n=m[c+e],i=t+(m[p+e]-t)*a,s=i+(n+(m[b+e]-n)*a-i)*r;g[v++]=s}}}return n.makeTensorInfo([c,u,d,f],"float32",g)}},D3={kernelName:nC,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{images:a,dy:i}=t,{alignCorners:s}=r;YJ([i,a],"resizeBilinearGrad");let o=pT.computeStrides(a.shape),[l,u,d,c]=a.shape,[,p,h]=i.shape,f=new Float32Array(l*u*d*c),m=[s&&p>1?u-1:u,s&&h>1?d-1:d],g=[s&&p>1?p-1:p,s&&h>1?h-1:h],b=m[0]/g[0],y=m[1]/g[1],v=n.data.get(i.dataId).values,x=0;for(let w=0;w<l;w++){let e=w*o[0];for(let t=0;t<p;t++){let n=t*b,r=Math.floor(n),a=Math.min(Math.ceil(n),u-1),i=e+r*o[1],s=e+a*o[1],l=n-r,p=1-l;for(let e=0;e<h;e++){let t=e*y,n=Math.floor(t),r=Math.min(Math.ceil(t),d-1),a=t-n,u=1-a,h=i+n*o[2],m=i+r*o[2],g=s+n*o[2],b=s+r*o[2],w=p*u,k=p*a,S=l*u,I=l*a;for(let e=0;e<c;e++){let t=v[x++];f[h+e]+=t*w,f[m+e]+=t*k,f[g+e]+=t*S,f[b+e]+=t*I}}}}return n.makeTensorInfo([l,d,u,c],"float32",f)}},F3={kernelName:QN,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{images:a}=t,{alignCorners:i,halfPixelCenters:s,size:o}=r;YJ(a,"resizeNearestNeighbor");let l=pT.computeStrides(a.shape),[u,d]=o,[c,p,h,f]=a.shape,m=n.data.get(a.dataId).values,g=new Float32Array(c*u*d*f),b=[i&&u>1?p-1:p,i&&d>1?h-1:h],y=[i&&u>1?u-1:u,i&&d>1?d-1:d],v=b[0]/y[0],x=b[1]/y[1],w=0;for(let k=0;k<c;k++){let e=k*l[0];for(let t=0;t<u;t++){let n=s?v*(t+.5):v*t,r=Math.min(p-1,i?Math.round(n):Math.floor(n));s&&(r=Math.max(0,r));let a=e+r*l[1];for(let e=0;e<d;e++){let t=s?x*(e+.5):x*e,n=Math.min(h-1,i?Math.round(t):Math.floor(t));s&&(n=Math.max(0,n));let r=a+n*l[2];for(let e=0;e<f;e++){let t=m[r+e];g[w++]=t}}}}return n.makeTensorInfo([c,u,d,f],a.dtype,g)}},M3={kernelName:eC,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{images:a,dy:i}=t,{alignCorners:s}=r;YJ([i,a],"resizeNearestNeighborGrad");let o=pT.computeStrides(a.shape),l=pT.computeStrides(i.shape),[u,d,c,p]=a.shape,[,h,f]=i.shape,m=new Float32Array(u*d*c*p),g=n.data.get(i.dataId).values,b=[s&&h>1?d-1:d,s&&f>1?c-1:c],y=[s&&h>1?h-1:h,s&&f>1?f-1:f],v=b[0]/y[0],x=b[1]/y[1],w=1/v,k=1/x,S=2*Math.ceil(w)+2,I=2*Math.ceil(k)+2;for(let N=0;N<u;N++){let e=N*o[0];for(let t=0;t<d;t++){let n=e+t*o[1],r=Math.floor(t*w),a=Math.floor(r-S/2);for(let i=0;i<c;i++){let r=n+i*o[2],u=Math.floor(i*k),b=Math.floor(u-I/2);for(let n=0;n<p;n++){let o=0;for(let r=0;r<S;r++){let u=r+a;if(u<0||u>=h)continue;let p=e+u*l[1],m=u*v;if(t===Math.min(d-1,s?Math.round(m):Math.floor(m)))for(let e=0;e<I;e++){let t=e+b;if(t<0||t>=f)continue;let r=p+t*l[2],a=t*x;i===Math.min(c-1,s?Math.round(a):Math.floor(a))&&(o+=g[r+n])}}m[r+n]=o}}}}return n.makeTensorInfo(a.shape,a.dtype,m)}},O3={kernelName:aC,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{dims:i}=r;YJ(a,"reverse");let s=a.shape.length,o=pT.parseAxisParam(i,a.shape);if(0===s)return sZ({inputs:{x:a},backend:n});let l=new GT(a.shape,a.dtype),u=n.bufferSync(a);for(let d=0;d<l.size;d++){let e=l.indexToLoc(d),t=e.slice();o.forEach((e=>t[e]=a.shape[e]-1-t[e])),l.set(u.get(...t),...e)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}},P3={kernelName:XC,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{image:r}=e,{radians:a,fillValue:i,center:s}=t,o=n,l=pT.getTypedArrayFromDType(r.dtype,pT.sizeFromShape(r.shape)),[u,d,c,p]=r.shape,[h,f]=_P.getImageCenter(s,d,c),m=Math.sin(a),g=Math.cos(a),b=o.data.get(r.dataId).values;for(let y=0;y<u;y++){let e=y*c*d*p;for(let t=0;t<d;t++){let n=t*(c*p);for(let r=0;r<c;r++){let a=r*p;for(let s=0;s<p;s++){let o=[u,t,r,s],y=o[2],v=o[1],x=(y-h)*g-(v-f)*m,w=(y-h)*m+(v-f)*g;x=Math.round(x+h),w=Math.round(w+f);let k=i;"number"!=typeof i&&(k=3===s?255:i[s]),x>=0&&x<c&&w>=0&&w<d&&(k=b[e+w*(c*p)+x*p+s]),l[e+n+a+s]=k}}}}return{dataId:o.write(l,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},L3=NZ(iC,(e=>{let t=Math.floor(e);return e-t<.5?Math.floor(e):e-t>.5?Math.ceil(e):t%2==0?t:t+1})),z3={kernelName:iC,backendName:"cpu",kernelFunc:L3},B3={kernelName:oC,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{indices:a,updates:i}=t,{shape:s}=r,{sliceRank:o,numUpdates:l,sliceSize:u,strides:d,outputSize:c}=_P.calculateShapes(i,a,s),p=GQ(n.bufferSync(a),n.bufferSync(i),s,c,u,l,o,d,0,!0);return n.makeTensorInfo(s,p.dtype,p.values)}};function W3(e,t){let n=0,r=e.length,a=0;for(;n<r;)a=Math.floor((n+r)/2),e[a]<t?n=a+1:r=a;return r}function V3(e,t){let n=0,r=e.length,a=0;for(;n<r;)a=Math.floor((n+r)/2),e[a]<=t?n=a+1:r=a;return r}var U3={kernelName:uC,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{sortedSequence:a,values:i}=t,{side:s}=r,o=function(e,t,n,r,a,i){let s=pT.getArrayFromDType("int32",n*a);for(let o=0;o<n;++o){let n=e.slice(o*r,(o+1)*r),l=o*a;for(let e=0;e<a;++e)s[l+e]="left"===i?W3(n,t[e+l]):V3(n,t[e+l])}return s}(n.data.get(a.dataId).values,n.data.get(i.dataId).values,a.shape[0],a.shape[1],i.shape[1],s);return n.makeTensorInfo(i.shape,"int32",o)}},j3={kernelName:dC,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{condition:r,t:a,e:i}=t;YJ([r,a,i],"select");let s=r.shape.length,o=n.data.get(r.dataId).values,l=n.data.get(a.dataId).values,u=n.data.get(i.dataId).values,d=iE(a.dtype,i.dtype),c=pT.makeZerosTypedArray(pT.sizeFromShape(a.shape),d),p=0,h=0===s||s>1||1===a.shape.length?1:pT.sizeFromShape(a.shape.slice(1));for(let f=0;f<o.length;f++)for(let e=0;e<h;e++)1===o[f]?c[p++]=l[f]:c[p++]=u[f];return n.makeTensorInfo(a.shape,d,c)}},H3=_P.SELU_SCALEALPHA,G3=_P.SELU_SCALE,q3=NZ(cC,(e=>e>=0?G3*e:H3*(Math.exp(e)-1))),K3={kernelName:cC,backendName:"cpu",kernelFunc:q3},X3=NZ(mC,(e=>e<0?-1:e>0?1:0)),Y3={kernelName:mC,backendName:"cpu",kernelFunc:X3},J3=NZ(hC,(e=>Math.sin(e))),Z3={kernelName:hC,backendName:"cpu",kernelFunc:J3},Q3=NZ(fC,(e=>Math.sinh(e))),e4={kernelName:fC,backendName:"cpu",kernelFunc:Q3},t4=Math.log(1.1920928955078125e-7)+2,n4=NZ(bC,(e=>{let t,n=e>-t4,r=e<t4,a=Math.exp(e);return t=r?a:n?e:Math.log(1+a),t})),r4={kernelName:bC,backendName:"cpu",kernelFunc:n4},a4={kernelName:xC,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:i,paddings:s}=r;YJ([a],"spaceToBatchND");let o=pT.sizeFromShape(i),l=[[0,0]];l.push(...s);for(let g=1+i.length;g<a.shape.length;++g)l.push([0,0]);let u=k3.kernelFunc({inputs:{x:a},backend:n,attrs:{paddings:l,constantValue:0}}),d=_P.getReshaped(u.shape,i,o,!1),c=_P.getPermuted(d.length,i.length,!1),p=_P.getReshapedPermuted(u.shape,i,o,!1),h=z0({inputs:{x:u},backend:n,attrs:{shape:d}}),f=TQ({inputs:{x:h},backend:n,attrs:{perm:c}}),m=z0({inputs:{x:f},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),m}},i4={kernelName:SC,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{indices:r,values:a,denseShape:i,defaultValue:s}=t;if(1!==i.shape.length)throw new Error(`Dense shape must be a vector, saw:\n        ${i.shape}`);if(2!==r.shape.length)throw new Error(`Indices must be a matrix, saw:\n        ${r.shape}`);if(1!==a.shape.length)throw new Error(`Values must be a vector, saw:\n        ${a.shape}`);if(0!==s.shape.length)throw new Error(`Default value must be a scalar, saw:\n        ${s.shape}`);let o=n.data.get(r.dataId).values,l=n.data.get(a.dataId).values,u=n.data.get(i.dataId).values,d=n.data.get(s.dataId).values[0],[c,p,h,f,m]=QQ(o,r.shape,r.dtype,l,a.dtype,u,d);return[n.makeTensorInfo(p,r.dtype,c),n.makeTensorInfo([p[0]],a.dtype,h),n.makeTensorInfo([f.length],"bool",new Uint8Array(f.map((e=>Number(e))))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}},s4={kernelName:IC,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{inputIndices:r,inputShape:a,newShape:i}=t;if(2!==r.shape.length)throw new Error(`Input indices should be a matrix but received shape\n        ${r.shape}`);if(1!==a.shape.length)throw new Error(`Input shape should be a vector but received shape\n        ${a.shape}`);if(1!==i.shape.length)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);let s=Array.from(n.data.get(a.dataId).values),o=n.data.get(r.dataId).values,l=Array.from(n.data.get(i.dataId).values),[u,d,c]=e0(o,r.shape,r.dtype,s,l);return[n.makeTensorInfo(d,r.dtype,u),n.makeTensorInfo([c.length],i.dtype,new Int32Array(c))]}},o4={kernelName:NC,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{data:r,indices:a,segmentIds:i}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error(`Indices should be a vector but received shape\n          ${a.shape}`);if(1!==i.shape.length)throw new Error(`Segment ids should be a vector but received shape\n          ${i.shape}`);if(a.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");let s=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,[u,d]=t0(s,r.shape,r.dtype,o,l,!0);return n.makeTensorInfo(d,r.dtype,u)}},l4={kernelName:CC,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{data:r,indices:a,segmentIds:i}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error(`Indices should be a vector but received shape\n         ${a.shape}`);if(1!==i.shape.length)throw new Error(`Segment ids should be a vector but received shape\n         ${i.shape}`);if(a.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");let s=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,[u,d]=t0(s,r.shape,r.dtype,o,l);return n.makeTensorInfo(d,r.dtype,u)}},u4={kernelName:TC,backendName:"cpu",kernelFunc:function(e){let t,{inputs:n,backend:r,attrs:a}=e,{sparseIndices:i,sparseValues:s,defaultValue:o}=n,{outputShape:l}=a,{sliceRank:u,numUpdates:d,sliceSize:c,strides:p,outputSize:h}=_P.calculateShapes(s,i,l),f=!1,m=r.bufferSync(i);switch(s.dtype){case"bool":t=GQ(m,r.bufferSync(s),l,h,c,d,u,p,!!r.data.get(o.dataId).values[0],f);break;case"float32":case"int32":t=GQ(m,r.bufferSync(s),l,h,c,d,u,p,r.data.get(o.dataId).values[0],f);break;case"string":t=GQ(m,r.bufferSync(s),l,h,c,d,u,p,pT.decodeString(r.data.get(o.dataId).values[0]),f);break;default:throw new Error(`Unsupported type ${s.dtype}`)}return r.makeTensorInfo(l,t.dtype,t.values)}},d4={kernelName:wC,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{numOrSizeSplits:i,axis:s}=r,o=pT.parseAxisParam(s,a.shape)[0],l=_P.prepareSplitSize(a,i,o),u=new Array(a.shape.length).fill(0),d=a.shape.slice();return l.map((e=>{let t=[...d];t[o]=e;let r=JQ({inputs:{x:a},backend:n,attrs:{begin:u,size:t}});return u[o]+=e,r}))}},c4={kernelName:_C,backendName:"cpu",kernelFunc:({inputs:e,backend:t})=>{let{x:n}=e,r=t;YJ(n,"square");let a=r.data.get(n.dataId).values,i=new Float32Array(a.length);for(let s=0;s<a.length;++s){let e=a[s];i[s]=e*e}return{dataId:r.write(i,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}},p4=NZ(qC,((e,t)=>{let n=t;return isNaN(e)?NaN:e>0?1:n.alpha})),h4={kernelName:qC,backendName:"cpu",kernelFunc:p4},f4={kernelName:AC,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{begin:i,end:s,strides:o,beginMask:l,endMask:u,ellipsisMask:d,newAxisMask:c,shrinkAxisMask:p}=r;YJ(a,"stridedSlice");let h,{finalShapeSparse:f,finalShape:m,isIdentity:g,sliceDim0:b,isSimpleSlice:y,begin:v,end:x,strides:w}=rP.sliceInfo(a.shape,i,s,o,l,u,d,c,p);if(g)h=z0({inputs:{x:a},backend:n,attrs:{shape:m}});else if(b||y){pT.assert(a.shape.length>=1,(()=>`Input must have rank at least 1, got: ${a.shape.length}`));let e=rP.computeOutShape(v,x,w),t=JQ({inputs:{x:a},backend:n,attrs:{begin:v,size:e}});h=z0({inputs:{x:t},backend:n,attrs:{shape:m}}),n.disposeIntermediateTensorInfo(t)}else{let e=c0(f,n.bufferSync(a),w,v);h=n.makeTensorInfo(m,e.dtype,e.values)}return h}},m4={kernelName:RC,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{separator:a,nGramWidths:i,leftPad:s,rightPad:o,padWidth:l,preserveShortSequences:u}=r,{data:d,dataSplits:c}=t,p=n.data.get(d.dataId).values,h=n.data.get(c.dataId).values,[f,m]=h0(p,h,a,i,s,o,l,u);return[n.makeTensorInfo([f.length],"string",f),n.makeTensorInfo(c.shape,"int32",m)]}},g4={kernelName:DC,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{skipEmpty:a}=r,{input:i,delimiter:s}=t;if("string"!==i.dtype)throw new Error("Input must be of datatype string");if(1!==i.shape.length)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(0!==s.shape.length)throw new Error(`Delimiter must be a scalar, got shape: ${s.shape}`);let o=n.data.get(i.dataId).values,l=n.data.get(s.dataId).values[0],[u,d,c]=m0(o,l,a),p=d.length;return[n.makeTensorInfo([p,2],"int32",u),n.makeTensorInfo([p],"string",d),n.makeTensorInfo([2],"int32",new Int32Array(c))]}},b4={kernelName:FC,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{numBuckets:a}=r,{input:i}=t;if("string"!==i.dtype)throw new Error("Input must be of datatype string");if(a<=0)throw new Error("Number of buckets must be at least 1");let s=g0(n.data.get(i.dataId).values,a);return n.makeTensorInfo(i.shape,"int32",s)}},y4=NZ(OC,(e=>Math.tan(e))),v4={kernelName:OC,backendName:"cpu",kernelFunc:y4},x4=NZ(PC,(e=>Math.tanh(e))),w4={kernelName:lC,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{tensor:r,indices:a,updates:i}=t,{sliceRank:s,numUpdates:o,sliceSize:l,strides:u,outputSize:d}=_P.calculateShapes(i,a,r.shape),c=n.bufferSync(a),p=n.bufferSync(i),h=n.bufferSync(r),f=GQ(c,p,r.shape,d,l,o,s,u,h,!1);return n.makeTensorInfo(r.shape,f.dtype,f.values)}},k4={kernelName:LC,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{reps:i}=r;YJ(a,"tile");let s=w0(n.bufferSync(a),i);return n.makeTensorInfo(s.shape,s.dtype,s.values)}},S4={kernelName:zC,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{k:i,sorted:s}=r;YJ(a,"topk");let o=n.data.get(a.dataId).values,[l,u]=I0(o,a.shape,a.dtype,i,s);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(u.shape,u.dtype,u.values)]}},I4={kernelName:BC,backendName:"cpu",kernelFunc:function(e){let{inputs:t,attrs:n,backend:r}=e,{image:a,transforms:i}=t,{interpolation:s,fillMode:o,fillValue:l,outputShape:u}=n,[d,c,p,h]=a.shape,[f,m]=null!=u?u:[c,p],g=[d,f,m,h],b=pT.computeStrides(a.shape),y=b[0],v=b[1],x=b[2],w=pT.computeStrides(g),k=w[0],S=w[1],I=w[2],N=pT.getTypedArrayFromDType(a.dtype,pT.sizeFromShape(g));N.fill(l);let C=r.data.get(a.dataId).values,T=r.data.get(i.dataId).values;for(let E=0;E<d;++E){let e=1===i.shape[0]?T:T.subarray(8*E,8*E+8);for(let t=0;t<f;++t)for(let n=0;n<m;++n)for(let r=0;r<h;++r){let a,i=e[6]*n+e[7]*t+1;if(0===i)continue;let u=(e[0]*n+e[1]*t+e[2])/i,d=(e[3]*n+e[4]*t+e[5])/i,h=N4(u,p,o),f=N4(d,c,o);switch(s){case"nearest":a=T4(C,c,p,y,v,x,E,f,h,r,l);break;case"bilinear":a=E4(C,c,p,y,v,x,E,f,h,r,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${s}`)}N[E*k+t*S+n*I+r]=a}return r.makeTensorInfo(g,a.dtype,N)}return{dataId:r.write(N,g,a.dtype),shape:a.shape,dtype:a.dtype}}};function N4(e,t,n){switch(n){case"reflect":return function(e,t){let n=e;if(n<0)if(t<=1)n=0;else{let e=2*t;n<e&&(n=e*Math.trunc(-n/e)+n),n=n<-t?n+e:-n-1}else if(n>t-1)if(t<=1)n=0;else{let e=2*t;n-=e*Math.trunc(n/e),n>=t&&(n=e-n-1)}return pT.clamp(0,n,t-1)}(e,t);case"wrap":return function(e,t){let n=e;if(n<0)if(t<=1)n=0;else{let e=t-1;n+=t*(Math.trunc(-n/e)+1)}else if(n>t-1)if(t<=1)n=0;else{let e=t-1;n-=t*Math.trunc(n/e)}return pT.clamp(0,n,t-1)}(e,t);case"nearest":return function(e,t){return pT.clamp(0,e,t-1)}(e,t);default:return function(e,t){return e}(e)}}function C4(e,t,n,r,a,i,s,o,l,u,d){return 0<=o&&o<t&&0<=l&&l<n?e[s*r+o*a+l*i+u]:d}function T4(e,t,n,r,a,i,s,o,l,u,d){return C4(e,t,n,r,a,i,s,Math.round(o),Math.round(l),u,d)}function E4(e,t,n,r,a,i,s,o,l,u,d){let c=Math.floor(o),p=Math.floor(l),h=c+1,f=p+1;return(h-o)*((f-l)*C4(e,t,n,r,a,i,s,c,p,u,d)+(l-p)*C4(e,t,n,r,a,i,s,c,f,u,d))+(o-c)*((f-l)*C4(e,t,n,r,a,i,s,h,p,u,d)+(l-p)*C4(e,t,n,r,a,i,s,h,f,u,d))}var _4={kernelName:VC,backendName:"cpu",kernelFunc:function(e){let{inputs:t,attrs:n,backend:r}=e,{axis:a}=n,{x:i}=t;YJ(i,"unique");let s=r.data.get(i.dataId).values,{outputValues:o,outputShape:l,indices:u}=N0(s,a,i.shape,i.dtype);return[r.makeTensorInfo(l,i.dtype,o),r.makeTensorInfo([u.length],"int32",u)]}},$4={kernelName:UC,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{value:a}=t,{axis:i}=r;i<0&&(i+=a.shape.length);let s=a.shape.length,o=a.shape[i],l=new Array(s-1),u=0;for(let h=0;h<s;h++)h!==i&&(l[u++]=a.shape[h]);let d=new Array(s).fill(0),c=a.shape.slice();c[i]=1;let p=new Array(o);for(let h=0;h<p.length;h++){d[i]=h;let e=JQ({inputs:{x:a},backend:n,attrs:{begin:d,size:c}});p[h]=z0({inputs:{x:e},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(e)}return p}},A4={kernelName:jC,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,segmentIds:i}=t,{numSegments:s}=r;YJ(a,"unsortedSegmentSum");let o=[],l=[],u=a.shape.length-i.shape.length,d=i;for(let p=0;p<u;++p){let e=c2({inputs:{input:d},backend:n,attrs:{dim:p+1}});d=e,l.push(e)}for(let p=0;p<s;++p){let e=pT.createScalarValue(p,"int32"),t=n.makeTensorInfo([],"int32",e),r=RZ({inputs:{a:t,b:d},backend:n}),i=cZ({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),s=vQ({inputs:{a:i,b:a},backend:n}),u=Q1({inputs:{x:s},backend:n,attrs:{axis:0,keepDims:!1}});o.push(u),l.push(t),l.push(r),l.push(i),l.push(s),l.push(u)}let c=x3({inputs:o,backend:n,attrs:{axis:0}});return l.forEach((e=>n.disposeIntermediateTensorInfo(e))),c}},R4=[U0,tZ,H0,q0,yZ,K0,X0,Y0,J0,Z0,e1,n1,a1,o1,u1,h1,f1,m1,g1,V0,b1,y1,v1,SZ,x1,pZ,_Z,k1,aZ,S1,T1,_1,$1,A1,R1,D1,F1,O1,L1,z1,B1,W1,V1,U1,H1,G1,q1,K1,X1,Y1,J1,Z1,t2,E0,n2,DZ,d2,OZ,p2,zZ,v2,w2,k2,VZ,HZ,S2,I2,N2,C2,YZ,QZ,oZ,T2,N1,_2,A2,D2,$0,nQ,iQ,F2,uQ,O2,z2,W2,j2,H2,G2,K2,hQ,X2,Y2,J2,Z2,Q2,e3,t3,gQ,n3,i3,u3,xQ,kQ,c3,h3,m3,NQ,g3,v3,w3,k3,N3,D0,$Q,C3,T3,E3,_3,uZ,m2,A3,M0,P0,B0,R3,D3,F3,M3,O3,P3,z3,HQ,B3,U3,j3,K3,XQ,Y3,Z3,e4,ZQ,l3,r4,a4,i4,s4,o4,l4,u4,d4,a0,c4,o0,d0,h4,f4,m4,g4,b4,x0,e2,v4,{kernelName:PC,backendName:"cpu",kernelFunc:x4},w4,k4,S4,I4,EQ,_4,$4,A4,y3];for(let e of R4)sT(e);var D4={};ok(D4,{assertNotComplex:()=>V5,bindCanvasToFramebuffer:()=>y5,bindColorTextureToFramebuffer:()=>v5,bindTextureToProgramUniformSampler:()=>b5,bindTextureUnit:()=>h5,bindVertexBufferToProgramAttribute:()=>p5,callAndCheck:()=>H4,canBeRepresented:()=>K4,createFragmentShader:()=>Z4,createFramebuffer:()=>c5,createProgram:()=>r5,createStaticIndexBuffer:()=>o5,createStaticVertexBuffer:()=>s5,createTexture:()=>u5,createVertexShader:()=>J4,getBatchDim:()=>N5,getExtensionOrThrow:()=>Y4,getFramebufferErrorMessage:()=>k5,getMaxTexturesInShader:()=>F5,getNumChannels:()=>l5,getProgramUniformLocation:()=>g5,getProgramUniformLocationOrThrow:()=>m5,getRowsCols:()=>C5,getShapeAs3D:()=>T5,getTextureShapeFromLogicalShape:()=>E5,getWebGLDisjointQueryTimerVersion:()=>M5,getWebGLErrorMessage:()=>X4,getWebGLMaxTextureSize:()=>A5,hasExtension:()=>O5,isCapableOfRenderingToFloatTexture:()=>L5,isDownloadFloatTextureEnabled:()=>z5,isReshapeFree:()=>$5,isWebGLFenceEnabled:()=>W5,isWebGLVersionEnabled:()=>P5,linkProgram:()=>a5,logShaderSourceAndInfoLog:()=>n5,resetMaxTextureSize:()=>R5,resetMaxTexturesInShader:()=>D5,unbindColorTextureFromFramebuffer:()=>x5,unbindTextureUnit:()=>f5,validateFramebuffer:()=>w5,validateProgram:()=>i5,validateTextureSize:()=>d5});var F4,M4,O4,P4={},L4={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function z4(e,t){P4[e]=t}function B4(e,t){if(!(e in P4)||null!=t){let n=function(e,t){if(1!==e&&2!==e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");let n=null==t?function(e){if(!$S().getBool("IS_SAFARI")&&"undefined"!=typeof OffscreenCanvas&&2===e)return new OffscreenCanvas(300,150);if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(e):t;return n.addEventListener("webglcontextlost",(t=>{t.preventDefault(),delete P4[e]}),!1),$S().getBool("SOFTWARE_WEBGL_ENABLED")&&(L4.failIfMajorPerformanceCaveat=!1),1===e?n.getContext("webgl",L4)||n.getContext("experimental-webgl",L4):n.getContext("webgl2",L4)}(e,t);if(null===n)return console.log("Could not get context for WebGL version",e),null;P4[e]=n}let n=P4[e];return null==n||n.isContextLost()?(delete P4[e],B4(e)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),P4[e])}function W4(e,t){return[t,e]}function V4(e){let t=pT.sizeFromShape(e),n=Math.ceil(t/4);return pT.sizeToSquarishShape(n)}function U4(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function j4(e,t){let n,r,a,i,s,o,l,u,d,c,p=e;return 2===$S().getNumber("WEBGL_VERSION")?(n=p.R32F,r=p.R16F,a=p.RGBA16F,i=p.RGBA32F,s=p.RED,l=4,u=1,d=p.HALF_FLOAT,c=p.FLOAT,o=p.RGBA8):(n=e.RGBA,r=e.RGBA,a=e.RGBA,i=p.RGBA,s=e.RGBA,l=4,u=4,d=null!=t?t.HALF_FLOAT_OES:null,c=e.FLOAT,o=e.RGBA),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:i,textureFormatFloat:s,downloadTextureFormat:o,downloadUnpackNumChannels:l,defaultNumChannels:u,textureTypeHalfFloat:d,textureTypeFloat:c}}function H4(e,t){let n=t();return $S().getBool("DEBUG")&&function(e){let t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+X4(e,t))}(e),n}!function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"}(F4||(F4={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(M4||(M4={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(O4||(O4={}));var G4=5.96e-8,q4=65504;function K4(e){return!!($S().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===e||G4<Math.abs(e)&&Math.abs(e)<q4)}function X4(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${t}`}}function Y4(e,t){return S5(e,(()=>e.getExtension(t)),'Extension "'+t+'" not supported on this browser.')}function J4(e,t){let n=S5(e,(()=>e.createShader(e.VERTEX_SHADER)),"Unable to create vertex WebGLShader.");if(H4(e,(()=>e.shaderSource(n,t))),H4(e,(()=>e.compileShader(n))),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function Z4(e,t){let n=S5(e,(()=>e.createShader(e.FRAGMENT_SHADER)),"Unable to create fragment WebGLShader.");if(H4(e,(()=>e.shaderSource(n,t))),H4(e,(()=>e.compileShader(n))),$S().get("ENGINE_COMPILE_ONLY"))return n;if(!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw n5(t,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}var Q4,e5,t5=/ERROR: [0-9]+:([0-9]+):/g;function n5(e,t){let n=t5.exec(t);if(null==n)return console.log(`Couldn't parse line number in error: ${t}`),void console.log(e);let r=+n[1],a=e.split("\n"),i=a.length.toString().length+2,s=a.map(((e,t)=>pT.rightPad((t+1).toString(),i)+e)),o=0;for(let c=0;c<s.length;c++)o=Math.max(s[c].length,o);let l=s.slice(0,r-1),u=s.slice(r-1,r),d=s.slice(r);console.log(l.join("\n")),console.log(t.split("\n")[0]),console.log(`%c ${pT.rightPad(u[0],o)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(d.join("\n"))}function r5(e){return S5(e,(()=>e.createProgram()),"Unable to create WebGLProgram.")}function a5(e,t){if(H4(e,(()=>e.linkProgram(t))),!$S().get("ENGINE_COMPILE_ONLY")&&!1===e.getProgramParameter(t,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}function i5(e,t){if(H4(e,(()=>e.validateProgram(t))),!1===e.getProgramParameter(t,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function s5(e,t){let n=S5(e,(()=>e.createBuffer()),"Unable to create WebGLBuffer");return H4(e,(()=>e.bindBuffer(e.ARRAY_BUFFER,n))),H4(e,(()=>e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW))),n}function o5(e,t){let n=S5(e,(()=>e.createBuffer()),"Unable to create WebGLBuffer");return H4(e,(()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n))),H4(e,(()=>e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW))),n}function l5(){return 2===$S().getNumber("WEBGL_VERSION")?1:4}function u5(e){return S5(e,(()=>e.createTexture()),"Unable to create WebGLTexture.")}function d5(e,t){let n=$S().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0)throw new Error(`Requested texture size [${e}x${t}] is invalid.`);if(e>n||t>n)throw new Error(`Requested texture size [${e}x${t}] greater than WebGL maximum on this browser / GPU [${n}x${n}].`)}function c5(e){return S5(e,(()=>e.createFramebuffer()),"Unable to create WebGLFramebuffer.")}function p5(e,t,n,r,a,i,s){let o=e.getAttribLocation(t,n);return-1!==o&&(H4(e,(()=>e.bindBuffer(e.ARRAY_BUFFER,r))),H4(e,(()=>e.vertexAttribPointer(o,a,e.FLOAT,!1,i,s))),H4(e,(()=>e.enableVertexAttribArray(o))),!0)}function h5(e,t,n){I5(e,n),H4(e,(()=>e.activeTexture(e.TEXTURE0+n))),H4(e,(()=>e.bindTexture(e.TEXTURE_2D,t)))}function f5(e,t){I5(e,t),H4(e,(()=>e.activeTexture(e.TEXTURE0+t))),H4(e,(()=>e.bindTexture(e.TEXTURE_2D,null)))}function m5(e,t,n){return S5(e,(()=>e.getUniformLocation(t,n)),'uniform "'+n+'" not present in program.')}function g5(e,t,n){return e.getUniformLocation(t,n)}function b5(e,t,n,r){H4(e,(()=>h5(e,t,r))),H4(e,(()=>e.uniform1i(n,r)))}function y5(e){H4(e,(()=>e.bindFramebuffer(e.FRAMEBUFFER,null))),H4(e,(()=>e.viewport(0,0,e.canvas.width,e.canvas.height))),H4(e,(()=>e.scissor(0,0,e.canvas.width,e.canvas.height)))}function v5(e,t,n){H4(e,(()=>e.bindFramebuffer(e.FRAMEBUFFER,n))),H4(e,(()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)))}function x5(e,t){H4(e,(()=>e.bindFramebuffer(e.FRAMEBUFFER,t))),H4(e,(()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)))}function w5(e){let t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+k5(e,t))}function k5(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${t}`}}function S5(e,t,n){let r=H4(e,(()=>t()));if(null==r)throw new Error(n);return r}function I5(e,t){let n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n)throw new Error(`textureUnit must be in [gl.TEXTURE0, gl.TEXTURE${n}].`)}function N5(e,t=2){return pT.sizeFromShape(e.slice(0,e.length-t))}function C5(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function T5(e){let t=[1,1,1];return 0===e.length||1===e.length&&1===e[0]||(t=[N5(e),...C5(e)]),t}function E5(e,t=!1){let n=$S().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=$S().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&$S().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),t&&(n*=2,r*=2,e=e.map(((t,n)=>n>=e.length-2?pT.nearestLargerEven(e[n]):e[n])),1===e.length&&(e=[2,e[0]])),2!==e.length&&(e=pT.squeezeShape(e).newShape);let a=pT.sizeFromShape(e),i=null;e.length<=1&&a<=n?i=[1,a]:2===e.length&&e[0]<=n&&e[1]<=n?i=e:3===e.length&&e[0]*e[1]<=n&&e[2]<=n?i=[e[0]*e[1],e[2]]:3===e.length&&e[0]<=n&&e[1]*e[2]<=n?i=[e[0],e[1]*e[2]]:4===e.length&&e[0]*e[1]*e[2]<=n&&e[3]<=n?i=[e[0]*e[1]*e[2],e[3]]:4===e.length&&e[0]<=n&&e[1]*e[2]*e[3]<=n&&(i=[e[0],e[1]*e[2]*e[3]]);let s=null!=i&&Math.max(...i)>r&&Math.min(...i)<=(t?2:1)&&Math.min(...i)>0;if(null==i||s)if(t){let t=N5(e),n=2,r=2;e.length&&([n,r]=C5(e)),a=t*(n/2)*(r/2),i=pT.sizeToSquarishShape(a).map((e=>2*e))}else i=pT.sizeToSquarishShape(a);return i}function _5(e){return e%2==0}function $5(e,t){if(e=e.slice(-2),t=t.slice(-2),pT.arraysEqual(e,t)||!e.length||!t.length||0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){let n=e[e.length-1],r=t[t.length-1];if(n===r||_5(n)&&_5(r)&&(1===e[0]||1===t[0]))return!0}return e[1]===t[1]&&_5(e[0])&&_5(t[0])}function A5(e){if(null==Q4){let t=B4(e);Q4=t.getParameter(t.MAX_TEXTURE_SIZE)}return Q4}function R5(){Q4=null}function D5(){e5=null}function F5(e){if(null==e5){let t=B4(e);e5=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,e5)}function M5(e){if(0===e)return 0;let t,n=B4(e);return t=O5(n,"EXT_disjoint_timer_query_webgl2")&&2===e?2:O5(n,"EXT_disjoint_timer_query")?1:0,t}function O5(e,t){return null!=e.getExtension(t)}function P5(e){try{if(null!=B4(e))return!0}catch(Dp){return console.log("Error when getting WebGL context: ",Dp),!1}return!1}function L5(e){if(0===e)return!1;let t=B4(e);if(1===e){if(!O5(t,"OES_texture_float"))return!1}else if(!O5(t,"EXT_color_buffer_float"))return!1;return B5(t)}function z5(e){if(0===e)return!1;let t=B4(e);if(1!==e){if(O5(t,"EXT_color_buffer_float"))return B5(t);let e="EXT_color_buffer_half_float";if(O5(t,e)){let n=t.getExtension(e);return function(e,t){let n=j4(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r);let a=1,i=1;e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,a,i,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);let s=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,s),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);let o=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(s),o}(t,n)}return!1}return!(!O5(t,"OES_texture_float")||!O5(t,"WEBGL_color_buffer_float"))&&B5(t)}function B5(e){let t=j4(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);let r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);let a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),a}function W5(e){return 2===e&&null!=B4(e).fenceSync}function V5(e,t){Array.isArray(e)||(e=[e]),e.forEach((e=>{null!=e&&pT.assert("complex64"!==e.dtype,(()=>`${t} does not support complex64 tensors in the WebGL backend.`))}))}var U5=$S();function j5(){let e,t,n,r,a,i,s,o,l,u;return 2===$S().getNumber("WEBGL_VERSION")?(e="#version 300 es",t="in",n="out",r="in",a="texture",i="outputColor",s="out vec4 outputColor;",o=$S().getBool("WEBGL2_ISNAN_CUSTOM")?"\n      bool isnan_custom(float val) {\n        uint floatToUint = floatBitsToUint(val);\n        return (floatToUint & 0x7fffffffu) > 0x7f800000u;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ":"",l="",u="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(e="",t="attribute",n="varying",r="varying",a="texture2D",i="gl_FragColor",s="",o="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",l="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",u="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:a,output:i,defineOutput:s,defineSpecialNaN:o,defineSpecialInf:l,defineRound:u}}function H5(e,t,n="index"){let r=pT.computeStrides(t);return r.map(((t,a)=>`int ${e[a]} = ${n} / ${t}; ${a===r.length-1?`int ${e[a+1]} = ${n} - ${e[a]} * ${t}`:`index -= ${e[a]} * ${t}`};`)).join("")}function G5(e,t,n="index"){let r=pT.computeStrides(t);return r.map(((t,a)=>`int ${e[a]} = ${n} / outShapeStrides[${a}]; ${a===r.length-1?`int ${e[a+1]} = ${n} - ${e[a]} * outShapeStrides[${a}]`:`index -= ${e[a]} * outShapeStrides[${a}]`};`)).join("")}function q5(e,t,n="index"){let r=function(e,t){let n=e.length,r=e.map((e=>`${t}[${e}]`)),a=new Array(n-1);a[n-2]=r[n-1];for(let i=n-3;i>=0;--i)a[i]=`(${a[i+1]} * ${r[i+1]})`;return a}(e.map(((e,t)=>t)),t);return r.map(((t,a)=>`int ${e[a]} = ${n} / ${r[a]}; ${a===r.length-1?`int ${e[a+1]} = ${n} - ${e[a]} * ${r[a]}`:`index -= ${e[a]} * ${r[a]}`};`)).join("")}function K5(e){let t=pT.computeStrides(e).map((e=>e.toString()));return`\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ${t[0]} + coords.y * ${t[1]} + coords.z;\n  }\n`}U5.registerFlag("HAS_WEBGL",(()=>U5.getNumber("WEBGL_VERSION")>0)),U5.registerFlag("WEBGL_VERSION",(()=>P5(2)?2:P5(1)?1:0)),U5.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",(()=>!1)),U5.registerFlag("WEBGL_BUFFER_SUPPORTED",(()=>2===U5.get("WEBGL_VERSION"))),U5.registerFlag("WEBGL_CPU_FORWARD",(()=>!0)),U5.registerFlag("WEBGL_FORCE_F16_TEXTURES",(()=>!1)),U5.registerFlag("WEBGL_PACK",(()=>U5.getBool("HAS_WEBGL"))),U5.registerFlag("WEBGL_PACK_NORMALIZATION",(()=>U5.getBool("WEBGL_PACK"))),U5.registerFlag("WEBGL_PACK_CLIP",(()=>U5.getBool("WEBGL_PACK"))),U5.registerFlag("WEBGL_PACK_DEPTHWISECONV",(()=>U5.getBool("WEBGL_PACK"))),U5.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(()=>U5.getBool("WEBGL_PACK"))),U5.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(()=>U5.getBool("WEBGL_PACK"))),U5.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(()=>U5.getBool("WEBGL_PACK"))),U5.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(()=>U5.getBool("WEBGL_PACK"))),U5.registerFlag("WEBGL_PACK_REDUCE",(()=>U5.getBool("WEBGL_PACK"))),U5.registerFlag("WEBGL_LAZILY_UNPACK",(()=>U5.getBool("WEBGL_PACK"))),U5.registerFlag("WEBGL_CONV_IM2COL",(()=>U5.getBool("WEBGL_PACK"))),U5.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(()=>A5(U5.getNumber("WEBGL_VERSION")))),U5.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(()=>F5(U5.getNumber("WEBGL_VERSION")))),U5.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(()=>{let e=U5.getNumber("WEBGL_VERSION");return 0===e?0:M5(e)})),U5.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(()=>U5.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!wE.isMobile())),U5.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(()=>L5(U5.getNumber("WEBGL_VERSION")))),U5.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(()=>!U5.getBool("WEBGL_FORCE_F16_TEXTURES")&&U5.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))),U5.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(()=>z5(U5.getNumber("WEBGL_VERSION")))),U5.registerFlag("WEBGL_FENCE_API_ENABLED",(()=>W5(U5.getNumber("WEBGL_VERSION")))),U5.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(()=>U5.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0)),U5.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",(()=>-1),(e=>{if(e<0&&-1!==e)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${e}.`)})),U5.registerFlag("WEBGL_FLUSH_THRESHOLD",(()=>wE.isMobile()?1:-1),(e=>{if(e<0&&-1!==e)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${e}.`)})),U5.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",(()=>128)),U5.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",(()=>!1)),U5.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",(()=>1e5)),U5.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",(()=>128)),U5.registerFlag("WEBGL_EXP_CONV",(()=>!1)),U5.registerFlag("SOFTWARE_WEBGL_ENABLED",(()=>U5.getBool("IS_TEST"))),U5.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",(()=>1/0)),U5.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",(()=>!1)),U5.registerFlag("WEBGL2_ISNAN_CUSTOM",(()=>!1)),U5.registerFlag("ENGINE_COMPILE_ONLY",(()=>!1));var X5="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",{getBroadcastDims:Y5}=_P;function J5(e,t,n){let r=[];if(e.forEach((e=>{let t=pT.sizeFromShape(e.shapeInfo.logicalShape);if(e.shapeInfo.isUniform?r.push(`uniform float ${e.name}${t>1?`[${t}]`:""};`):(r.push(`uniform sampler2D ${e.name};`),r.push(`uniform int offset${e.name};`)),n.enableShapeUniforms){let{uniformShape:t}=o6(n.packedInputs,e.shapeInfo.logicalShape,e.shapeInfo.texShape);switch(t.length){case 1:r.push(`uniform int ${e.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${e.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${e.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${e.name}Shape;`)}r.push(`uniform ivec2 ${e.name}TexShape;`)}})),n.enableShapeUniforms){switch(t.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;")}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach((e=>{r.push(`uniform ${e.type} ${e.name}${e.arrayIndex?`[${e.arrayIndex}]`:""};`)}));let a,i,s=r.join("\n"),o=e.map((e=>function(e,t,n=!1,r){let a="";a+=n?Q5(e,r):Z5(e,r);let i=e.shapeInfo.logicalShape,s=t.logicalShape;return i.length<=s.length&&(a+=n?function(e,t){let n,r=e.name,a=r.charAt(0).toUpperCase()+r.slice(1),i="get"+a+"AtOutCoords",s=e.shapeInfo.logicalShape.length,o=t.logicalShape.length,l=Y5(e.shapeInfo.logicalShape,t.logicalShape),u=s6(o),d=o-s,c=["x","y","z","w","u","v"];n=0===s?"":o<2&&l.length>=1?"coords = 0;":l.map((e=>`coords.${c[e+d]} = 0;`)).join("\n");let p="";p=o<2&&s>0?"coords":e.shapeInfo.logicalShape.map(((e,t)=>`coords.${c[t+d]}`)).join(", ");let h="return outputValue;",f=1===pT.sizeFromShape(e.shapeInfo.logicalShape),m=1===pT.sizeFromShape(t.logicalShape);if(1!==s||f||m){if(f&&!m)h=1===o?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(l.length){let e=s-2,t=s-1;l.indexOf(e)>-1&&l.indexOf(t)>-1?h="return vec4(outputValue.x);":l.indexOf(e)>-1?h="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":l.indexOf(t)>-1&&(h="return vec4(outputValue.xx, outputValue.zz);")}}else h="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return`\n    vec4 ${i}() {\n      ${u} coords = getOutputCoords();\n      ${n}\n      vec4 outputValue = get${a}(${p});\n      ${h}\n    }\n  `}(e,t):function(e,t){let n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",i=t.texShape,s=e.shapeInfo.texShape,o=e.shapeInfo.logicalShape.length,l=t.logicalShape.length;if(!e.shapeInfo.isUniform&&o===l&&null==e.shapeInfo.flatOffset&&pT.arraysEqual(s,i))return`\n      float ${a}() {\n        return sampleTexture(${n}, resultUV);\n      }\n    `;let u,d=s6(l),c=Y5(e.shapeInfo.logicalShape,t.logicalShape),p=l-o,h=["x","y","z","w","u","v"];u=0===o?"":l<2&&c.length>=1?"coords = 0;":c.map((e=>`coords.${h[e+p]} = 0;`)).join("\n");let f="";return f=l<2&&o>0?"coords":e.shapeInfo.logicalShape.map(((e,t)=>`coords.${h[t+p]}`)).join(", "),`\n    float ${a}() {\n      ${d} coords = getOutputCoords();\n      ${u}\n      return get${r}(${f});\n    }\n  `}(e,t)),a}(e,t,n.packedInputs,n.enableShapeUniforms))).join("\n"),l=t.texShape,u=j5(),d=function(e){return`\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ${e.texture2D}(textureSampler, uv).r;\n    }\n  `}(u),c=function(e){return`${e.version}\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ${e.varyingFs} vec2 resultUV;\n    ${e.defineOutput}\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ${e.defineSpecialNaN}\n    ${e.defineSpecialInf}\n    ${e.defineRound}\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ${e6}\n    ${t6}\n    ${n6}\n  `}(u);return t.isPacked?(a=function(e,t,n){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t,n){let r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];return 1===r[0]?n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));\n      }\n    ":`\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ${r[1]}.0);\n      }\n    `:1===r[1]?n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));\n      }\n    ":`\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ${r[0]}.0);\n      }\n    `:n?"\n    int getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);\n    }\n  ":`\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${r[0]}, ${r[1]}));\n      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);\n    }\n  `}(0,t,n);case 2:return function(e,t,n){let r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(pT.arraysEqual(e,t))return n?"\n      ivec2 getOutputCoords() {\n        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));\n      }\n    `;let a=Math.ceil(e[1]/2);return n?"\n    ivec2 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec2(r, c);\n    }\n  ":`\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${r[0]}, ${r[1]}));\n\n      int index = resTexRC.x * ${r[1]} + resTexRC.y;\n      int r = 2 * (index / ${a});\n      int c = imod(index, ${a}) * 2;\n\n      return ivec2(r, c);\n    }\n  `}(e,t,n);case 3:return function(e,t,n){if(n)return"\n    ivec3 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";let r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],a=Math.ceil(e[2]/2),i=a*Math.ceil(e[1]/2);return`\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${r[0]}, ${r[1]}));\n      int index = resTexRC.x * ${r[1]} + resTexRC.y;\n\n      int b = index / ${i};\n      index -= b * ${i};\n\n      int r = 2 * (index / ${a});\n      int c = imod(index, ${a}) * 2;\n\n      return ivec3(b, r, c);\n    }\n  `}(e,t,n);default:return function(e,t,n){if(n)return"\n    ivec4 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatchN = texelsInBatch * outShape[1];\n\n      int b2 = index / texelsInBatchN;\n      index -= b2 * texelsInBatchN;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec4(b2, b, r, c);\n    }\n  ";let r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],a=Math.ceil(e[e.length-1]/2),i=a*Math.ceil(e[e.length-2]/2),s=i,o="",l="b, r, c";for(let u=2;u<e.length-1;u++)s*=e[e.length-u-1],o=`\n      int b${u} = index / ${s};\n      index -= b${u} * ${s};\n    `+o,l=`b${u}, `+l;return`\n    ivec${e.length} getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${r[0]}, ${r[1]}));\n      int index = resTexRC.x * ${r[1]} + resTexRC.y;\n\n      ${o}\n\n      int b = index / ${i};\n      index -= b * ${i};\n\n      int r = 2 * (index / ${a});\n      int c = imod(index, ${a}) * 2;\n\n      return ivec${e.length}(${l});\n    }\n  `}(e,t,n)}}(t.logicalShape,l,n.enableShapeUniforms),i=function(e){return`\n    void setOutput(vec4 val) {\n      ${e.output} = val;\n    }\n  `}(u)):(a=function(e,t,n){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t,n){return 1===t[0]?n?"\n      int getOutputCoords() {\n        return int(resultUV.x * float(outTexShape[1]));\n      }\n    ":`\n      int getOutputCoords() {\n        return int(resultUV.x * ${t[1]}.0);\n      }\n    `:1===t[1]?n?"\n      int getOutputCoords() {\n        return int(resultUV.y * float(outTexShape[0]));\n      }\n    ":`\n      int getOutputCoords() {\n        return int(resultUV.y * ${t[0]}.0);\n      }\n    `:n?"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      return resTexRC.x * outTexShape[1] + resTexRC.y;\n    }\n  ":`\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${t[0]}, ${t[1]}));\n      return resTexRC.x * ${t[1]} + resTexRC.y;\n    }\n  `}(0,t,n);case 2:return function(e,t,n){return pT.arraysEqual(e,t)?n?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(${t[0]}, ${t[1]}));\n      }\n    `:1===e[1]?n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(${t[0]}, ${t[1]}));\n        int index = resTexRC.x * ${t[1]} + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    `:1===e[0]?n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(${t[0]}, ${t[1]}));\n        int index = resTexRC.x * ${t[1]} + resTexRC.y;\n        return ivec2(0, index);\n      }\n    `:n?"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      int r = index / outShape[1];\n      int c = index - r * outShape[1];\n      return ivec2(r, c);\n    }\n  ":`\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${t[0]}, ${t[1]}));\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n      int r = index / ${e[1]};\n      int c = index - r * ${e[1]};\n      return ivec2(r, c);\n    }\n  `}(e,t,n);case 3:return function(e,t,n){if(n)return`\n  ivec3 getOutputCoords() {\n    ivec2 resTexRC = ivec2(resultUV.yx *\n                           vec2(outTexShape[0], outTexShape[1]));\n    int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n    ${G5(["r","c","d"],e)}\n    return ivec3(r, c, d);\n  }\n`;let r=H5(["r","c","d"],e);return`\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${t[0]}, ${t[1]}));\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n      ${r}\n      return ivec3(r, c, d);\n    }\n  `}(e,t,n);case 4:return function(e,t,n){if(n)return`\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      ${G5(["r","c","d","d2"],e)}\n      return ivec4(r, c, d, d2);\n    }\n  `;let r=H5(["r","c","d","d2"],e);return`\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(${t[0]}, ${t[1]}));\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n      ${r}\n      return ivec4(r, c, d, d2);\n    }\n  `}(e,t,n);case 5:return function(e,t){let n=H5(["r","c","d","d2","d3"],e);return`\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${t[0]},\n                             ${t[1]}));\n\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n\n      ${n}\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  `}(e,t);case 6:return function(e,t){let n=H5(["r","c","d","d2","d3","d4"],e);return`\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(${t[0]}, ${t[1]}));\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n\n      ${n}\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  `}(e,t);default:throw new Error(`${e.length}-D output sampling is not yet supported`)}}(t.logicalShape,l,n.enableShapeUniforms),i=function(e){return`\n    void setOutput(float val) {\n      ${e.output} = vec4(val, 0, 0, 0);\n    }\n  `}(u)),n.packedInputs&&(c+=r6),[c,d,i,s,a,o,n.userCode].join("\n")}function Z5(e,t=!1){let n=e.shapeInfo.logicalShape;switch(n.length){case 0:return function(e,t){let n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return`float ${r}() {return ${n};}`;let[a,i]=e.shapeInfo.texShape;if(1===a&&1===i)return`\n      float ${r}() {\n        return sampleTexture(${n}, halfCR);\n      }\n    `;let s=a6(n);if(t)return`\n    float ${r}() {\n      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${s});\n      return sampleTexture(${n}, uv);\n    }\n  `;let[o,l]=e.shapeInfo.texShape;return`\n    float ${r}() {\n      vec2 uv = uvFromFlat(${o}, ${l}, ${s});\n      return sampleTexture(${n}, uv);\n    }\n  `}(e,t);case 1:return function(e,t){let n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return`\n      float ${r}(int index) {\n        ${i6(e)}\n      }\n    `;let a=e.shapeInfo.texShape,i=a[0],s=a[1];if(1===s&&1===i)return`\n      float ${r}(int index) {\n        return sampleTexture(${n}, halfCR);\n      }\n    `;let o=a6(n);return 1===s?t?`\n      float ${r}(int index) {\n        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / float(${n}TexShape[0]));\n        return sampleTexture(${n}, uv);\n      }\n    `:`\n      float ${r}(int index) {\n        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / ${i}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `:1===i?t?`\n      float ${r}(int index) {\n        vec2 uv = vec2((float(index + ${o}) + 0.5) / float(${n}TexShape[1]), 0.5);\n        return sampleTexture(${n}, uv);\n      }\n    `:`\n      float ${r}(int index) {\n        vec2 uv = vec2((float(index + ${o}) + 0.5) / ${s}.0, 0.5);\n        return sampleTexture(${n}, uv);\n      }\n    `:t?`\n    float ${r}(int index) {\n      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${o});\n      return sampleTexture(${n}, uv);\n    }\n  `:`\n    float ${r}(int index) {\n      vec2 uv = uvFromFlat(${i}, ${s}, index + ${o});\n      return sampleTexture(${n}, uv);\n    }\n  `}(e,t);case 2:return function(e,t){let n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape;if(null!=i&&pT.arraysEqual(n,i)){if(t)return`\n      float ${a}(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `;let e=i[0];return`\n    float ${a}(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(${i[1]}.0, ${e}.0);\n      return sampleTexture(${r}, uv);\n    }\n  `}let{newShape:s,keptDims:o}=pT.squeezeShape(n),l=s;if(l.length<n.length){let n=["row","col"];return`\n      ${Z5(l6(e,l),t)}\n      float ${a}(int row, int col) {\n        return ${a}(${u6(n,o)});\n      }\n    `}if(e.shapeInfo.isUniform)return`\n      float ${a}(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));\n        ${i6(e)}\n      }\n    `;let u=i[0],d=i[1],c=a6(r);return 1===d?t?`\n      float ${a}(int row, int col) {\n        float index = dot(vec3(row, col, ${c}), vec3(${r}Shape[1], 1, 1));\n        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n    float ${a}(int row, int col) {\n      float index = dot(vec3(row, col, ${c}), vec3(${n[1]}, 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);\n      return sampleTexture(${r}, uv);\n    }\n  `:1===u?t?`\n      float ${a}(int row, int col) {\n        float index = dot(vec3(row, col, ${c}), vec3(${r}Shape[1], 1, 1));\n        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n    float ${a}(int row, int col) {\n      float index = dot(vec3(row, col, ${c}), vec3(${n[1]}, 1, 1));\n      vec2 uv = vec2((index + 0.5) / ${d}.0, 0.5);\n      return sampleTexture(${r}, uv);\n    }\n  `:t?`\n      float ${a}(int row, int col) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ${r}Shape[1] + col + ${c};\n        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n  float ${a}(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ${n[1]} + col + ${c};\n    vec2 uv = uvFromFlat(${u}, ${d}, index);\n    return sampleTexture(${r}, uv);\n  }\n`}(e,t);case 3:return function(e,t){let n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[1]*n[2],s=n[2],{newShape:o,keptDims:l}=pT.squeezeShape(n),u=o;if(u.length<n.length){let n=["row","col","depth"];return`\n        ${Z5(l6(e,u),t)}\n        float ${a}(int row, int col, int depth) {\n          return ${a}(${u6(n,l)});\n        }\n      `}if(e.shapeInfo.isUniform)return`\n      float ${a}(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(${i}, ${s}, 1)));\n        ${i6(e)}\n      }\n    `;let d=e.shapeInfo.texShape,c=d[0],p=d[1],h=e.shapeInfo.flatOffset;if(p===i&&null==h)return t?`\n      float ${a}(int row, int col, int depth) {\n        int stride1 = ${r}Shape[2];\n        float texR = float(row);\n        float texC = dot(vec2(col, depth), vec2(stride1, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n        float ${a}(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(${s}, 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(${p}.0, ${c}.0);\n          return sampleTexture(${r}, uv);\n        }\n      `;if(p===s&&null==h)return t?`\n      float ${a}(int row, int col, int depth) {\n        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));\n        float texC = float(depth);\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n    float ${a}(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${p}.0, ${c}.0);\n      return sampleTexture(${r}, uv);\n    }\n  `;let f=a6(r);return t?`\n    float ${a}(int row, int col, int depth) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int stride0 = ${r}Shape[1] * ${r}Shape[2];\n      int stride1 = ${r}Shape[2];\n      int index = row * stride0 + col * stride1 + depth + ${f};\n      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);\n      return sampleTexture(${r}, uv);\n    }\n    `:`\n      float ${a}(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ${i} + col * ${s} + depth + ${f};\n        vec2 uv = uvFromFlat(${c}, ${p}, index);\n        return sampleTexture(${r}, uv);\n      }\n  `}(e,t);case 4:return function(e,t){let n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[3],s=n[2]*i,o=n[1]*s,{newShape:l,keptDims:u}=pT.squeezeShape(n);if(l.length<n.length){let n=["row","col","depth","depth2"];return`\n      ${Z5(l6(e,l),t)}\n      float ${a}(int row, int col, int depth, int depth2) {\n        return ${a}(${u6(n,u)});\n      }\n    `}if(e.shapeInfo.isUniform)return`\n      float ${a}(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(${o}, ${s}, ${i}, 1)));\n        ${i6(e)}\n      }\n    `;let d=e.shapeInfo.flatOffset,c=e.shapeInfo.texShape,p=c[0],h=c[1],f=`int stride2 = ${r}Shape[3];`,m=`int stride1 = ${r}Shape[2] * stride2;`,g=`int stride0 = ${r}Shape[1] * stride1;`;if(h===o&&null==d)return t?`\n      float ${a}(int row, int col, int depth, int depth2) {\n        ${f}\n        ${m}\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(stride1, stride2, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n      float ${a}(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(${s}, ${i}, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${h}.0, ${p}.0);\n        return sampleTexture(${r}, uv);\n      }\n    `;if(h===i&&null==d)return t?`\n      float ${a}(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n      float ${a}(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(${n[1]*n[2]}, ${n[2]}, 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${h}.0, ${p}.0);\n        return sampleTexture(${r}, uv);\n      }\n    `;let b=a6(r);return t?`\n    float ${a}(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      ${f}\n      ${m}\n      ${g}\n      int index = row * stride0 + col * stride1 +\n          depth * stride2 + depth2;\n      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${b});\n      return sampleTexture(${r}, uv);\n    }\n  `:`\n    float ${a}(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${o} + col * ${s} +\n          depth * ${i} + depth2;\n      vec2 uv = uvFromFlat(${p}, ${h}, index + ${b});\n      return sampleTexture(${r}, uv);\n    }\n  `}(e,t);case 5:return function(e){let t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[4],i=t[3]*a,s=t[2]*i,o=t[1]*s,{newShape:l,keptDims:u}=pT.squeezeShape(t);if(l.length<t.length){let t=["row","col","depth","depth2","depth3"];return`\n      ${Z5(l6(e,l))}\n      float ${r}(int row, int col, int depth, int depth2, int depth3) {\n        return ${r}(${u6(t,u)});\n      }\n    `}if(e.shapeInfo.isUniform)return`\n      float ${r}(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(${o}, ${s}, ${i}, ${a})) +\n          depth3;\n        ${i6(e)}\n      }\n    `;let d=e.shapeInfo.flatOffset,c=e.shapeInfo.texShape,p=c[0],h=c[1];if(h===o&&null==d)return`\n      float ${r}(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(${s}, ${i}, ${a}, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${h}.0, ${p}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `;if(h===a&&null==d)return`\n      float ${r}(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(${t[1]*t[2]*t[3]},\n               ${t[2]*t[3]}, ${t[3]}, 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${h}.0, ${p}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `;let f=a6(n);return`\n    float ${r}(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${o} + col * ${s} + depth * ${i} +\n          depth2 * ${a} + depth3 + ${f};\n      vec2 uv = uvFromFlat(${p}, ${h}, index);\n      return sampleTexture(${n}, uv);\n    }\n  `}(e);case 6:return function(e){let t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:a,keptDims:i}=pT.squeezeShape(t);if(a.length<t.length){let t=["row","col","depth","depth2","depth3","depth4"];return`\n      ${Z5(l6(e,a))}\n      float ${r}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ${r}(${u6(t,i)});\n      }\n    `}let s=t[5],o=t[4]*s,l=t[3]*o,u=t[2]*l,d=t[1]*u;if(e.shapeInfo.isUniform)return`\n      float ${r}(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(${d}, ${u}, ${l}, ${o})) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(${s}, 1)));\n        ${i6(e)}\n      }\n    `;let c=e.shapeInfo.flatOffset,p=e.shapeInfo.texShape,h=p[0],f=p[1];if(f===d&&null==c)return`\n      float ${r}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(${u}, ${l}, ${o}, ${s})) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${f}.0, ${h}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `;if(f===s&&null==c)return`\n      float ${r}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(${t[1]*t[2]*t[3]*t[4]},\n               ${t[2]*t[3]*t[4]},\n               ${t[3]*t[4]},\n               ${t[4]})) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${f}.0, ${h}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `;let m=a6(n);return`\n    float ${r}(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${d} + col * ${u} + depth * ${l} +\n          depth2 * ${o} + depth3 * ${s} + depth4 + ${m};\n      vec2 uv = uvFromFlat(${h}, ${f}, index);\n      return sampleTexture(${n}, uv);\n    }\n  `}(e);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function Q5(e,t){switch(e.shapeInfo.logicalShape.length){case 0:return function(e){let t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=j5();return`\n    vec4 ${n}() {\n      return ${r.texture2D}(${t}, halfCR);\n    }\n  `}(e);case 1:return function(e,t){let n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape,i=j5();if(t)return`\n    vec4 ${r}(int index) {\n      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));\n      vec2 uv = packedUVfrom1D(\n        packedTexShape[0], packedTexShape[1], index);\n      return ${i.texture2D}(${n}, uv);\n    }\n  `;let s=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];return`\n    vec4 ${r}(int index) {\n      vec2 uv = packedUVfrom1D(\n        ${s[0]}, ${s[1]}, index);\n      return ${i.texture2D}(${n}, uv);\n    }\n  `}(e,t);case 2:return function(e,t){let n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape,s=i[0],o=i[1],l=j5();if(null!=i&&pT.arraysEqual(n,i))return t?`\n      vec4 ${a}(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);\n\n        return ${l.texture2D}(${r}, uv);\n      }\n    `:`\n      vec4 ${a}(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(${o}.0, ${s}.0);\n\n        return ${l.texture2D}(${r}, uv);\n      }\n    `;if(t)return`\n    vec4 ${a}(int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);\n      return ${l.texture2D}(${r}, uv);\n    }\n  `;let u=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],d=Math.ceil(n[1]/2);return`\n    vec4 ${a}(int row, int col) {\n      vec2 uv = packedUVfrom2D(${d}, ${u[0]}, ${u[1]}, row, col);\n      return ${l.texture2D}(${r}, uv);\n    }\n  `}(e,t);case 3:return function(e,t){let n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape,s=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(1===n[0]){let r=[1,2],i=["b","row","col"];return`\n        ${Q5(l6(e,n.slice(1)),t)}\n        vec4 ${a}(int b, int row, int col) {\n          return ${a}(${u6(i,r)});\n        }\n      `}let o=j5();if(t)return`\n    vec4 ${a}(int b, int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom3D(\n        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);\n      return ${o.texture2D}(${r}, uv);\n    }\n  `;let l=s[0],u=s[1],d=Math.ceil(n[2]/2),c=d*Math.ceil(n[1]/2);return`\n    vec4 ${a}(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ${l}, ${u}, ${c}, ${d}, b, row, col);\n      return ${o.texture2D}(${r}, uv);\n    }\n  `}(e,t);default:return function(e,t){let n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=j5();if(t)return`\n    vec4 ${r}(int b2, int b, int row, int col) {\n      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));\n      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);\n      texelsInBatch *= ${n}Shape[1];\n      index = b2 * texelsInBatch + index;\n      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));\n      int texR = index / packedTexShape[1];\n      int texC = index - texR * packedTexShape[1];\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${a.texture2D}(${n}, uv);\n    }\n  `;let i=e.shapeInfo.logicalShape,s=i.length,o=e.shapeInfo.texShape,l=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],u=l[0],d=l[1],c=Math.ceil(i[s-1]/2),p=c*Math.ceil(i[s-2]/2),h="int b, int row, int col",f=`b * ${p} + (row / 2) * ${c} + (col / 2)`;for(let m=2;m<s-1;m++)h=`int b${m}, `+h,p*=i[s-m-1],f=`b${m} * ${p} + `+f;return`\n    vec4 ${r}(${h}) {\n      int index = ${f};\n      int texR = index / ${d};\n      int texC = index - texR * ${d};\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${d}, ${u});\n      return ${a.texture2D}(${n}, uv);\n    }\n  `}(e,t)}}var e6="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",t6="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",n6="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",r6="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function a6(e){return`offset${e}`}function i6(e){let t=e.name,n=pT.sizeFromShape(e.shapeInfo.logicalShape);return n<2?`return ${t};`:`\n    for (int i = 0; i < ${n}; i++) {\n      if (i == index) {\n        return ${t}[i];\n      }\n    }\n  `}function s6(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error(`GPU for rank ${e} is not yet supported`)}function o6(e,t,n){let{newShape:r,keptDims:a}=pT.squeezeShape(t),i=t.length,s=e&&3===i&&1===t[0],o=s?t.slice(1):r,l=!e&&i>1&&!pT.arraysEqual(t,n)&&r.length<i||s;return{useSqueezeShape:l,uniformShape:l?o:t,keptDims:a}}function l6(e,t){let n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function u6(e,t){return t.map((t=>e[t])).join(", ")}function d6(e,t,n){let r,a,i,s=[],o=[],l=null,u=null;u=e.getUniformLocation(n,"NAN",!1),1===$S().getNumber("WEBGL_VERSION")&&(l=e.getUniformLocation(n,"INFINITY",!1));let d=!1;for(let c of t.variableNames){let r={name:c,uniform:e.getUniformLocation(n,c,d),offset:e.getUniformLocation(n,`offset${c}`,d)};t.enableShapeUniforms&&(r.shape=e.getUniformLocation(n,`${c}Shape`,d),r.texShape=e.getUniformLocation(n,`${c}TexShape`,d)),s.push(r)}if(t.enableShapeUniforms&&(r=e.getUniformLocation(n,"outShape",d),i=e.getUniformLocation(n,"outShapeStrides",d),a=e.getUniformLocation(n,"outTexShape",d)),t.customUniforms)for(let c of t.customUniforms)o.push(e.getUniformLocation(n,c.name,d));return{variablesLocations:s,customUniformLocations:o,infLoc:l,nanLoc:u,outShapeLocation:r,outShapeStridesLocation:i,outTexShapeLocation:a}}function c6(e,t){if(e.length!==t.length)throw Error(`Binary was compiled with ${e.length} inputs, but was executed with ${t.length} inputs`);e.forEach(((e,n)=>{let r=e.logicalShape,a=t[n],i=a.shape;if(!pT.arraysEqual(r,i))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${r} and ${i} must match`);if(e.isUniform&&a.isUniform)return;let s=e.texShape,o=a.isUniform?null:a.texData.texShape;if(!pT.arraysEqual(s,o))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${s} and ${o} must match`)}))}function p6(e){return $S().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&e<=4}var h6={R:0,G:1,B:2,A:3},f6=class{constructor(e,t=!1,n="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];let r=j5();this.outputShape=e,this.enableShapeUniforms=p6(this.outputShape.length);let a="result";t&&(a="floor(result * 255. + 0.5)");let i="";for(let s=0;s<n.length;s++){let e=n[s];i+=`\n          if(offset == ${s}) {\n            result = values[${h6[e]}];\n          }`}this.userCode=`\n      ${this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":K5(e)}\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int flatIndex = getFlatIndex(coords);\n        float result = 0.;\n        int offset = imod(flatIndex, ${n.length});\n\n        flatIndex = idiv(flatIndex, ${n.length}, 1.);\n\n        int r = flatIndex / texShape[1];\n        if (r < texShape[0]) {\n          int c = imod(flatIndex, texShape[1]);\n          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n          vec4 values = ${r.texture2D}(A, uv);\n          ${i}\n        }\n        ${r.output} = vec4(${a}, 0., 0., 0.);\n      }\n    `}},m6={};function g6(e){let t=j5();return J4(e,`${t.version}\n    precision highp float;\n    ${t.attribute} vec3 clipSpacePos;\n    ${t.attribute} vec2 uv;\n    ${t.varyingVs} vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }`)}function b6(e){return s5(e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function y6(e){return o5(e,new Uint16Array([0,1,2,2,1,3]))}function v6(e,t,n,r,a,i){d5(t,n);let s=u5(e),o=e.TEXTURE_2D;return H4(e,(()=>e.bindTexture(o,s))),H4(e,(()=>e.texParameteri(o,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE))),H4(e,(()=>e.texParameteri(o,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE))),H4(e,(()=>e.texParameteri(o,e.TEXTURE_MIN_FILTER,e.NEAREST))),H4(e,(()=>e.texParameteri(o,e.TEXTURE_MAG_FILTER,e.NEAREST))),1===$S().getNumber("WEBGL_VERSION")?H4(e,(()=>e.texImage2D(o,0,r,t,n,0,a,i,null))):H4(e,(()=>e.texStorage2D(o,1,r,t,n))),H4(e,(()=>e.bindTexture(e.TEXTURE_2D,null))),{texture:s,texShape:[n,t]}}function x6(e){return e.internalFormatFloat}function w6(e,t,n,r){let[a,i]=W4(t,n);return v6(e,a,i,x6(r),r.textureFormatFloat,e.FLOAT)}function k6(e){return e.internalFormatHalfFloat}function S6(e,t,n,r){let[a,i]=W4(t,n);return v6(e,a,i,k6(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function I6(e){return e.downloadTextureFormat}function N6(e,t,n,r){let[a,i]=W4(t,n);return v6(e,a,i,I6(r),e.RGBA,e.UNSIGNED_BYTE)}function C6(e){return e.internalFormatPackedFloat}function T6(e,t,n,r){let[a,i]=U4(t,n);return v6(e,a,i,C6(r),e.RGBA,e.FLOAT)}function E6(e){return e.internalFormatPackedHalfFloat}function _6(e,t,n,r){let[a,i]=U4(t,n);return v6(e,a,i,E6(r),e.RGBA,r.textureTypeHalfFloat)}function $6(e,t,n){return H4(e,(()=>e.bindBuffer(e.ARRAY_BUFFER,n))),p5(e,t,"clipSpacePos",n,3,20,0)&&p5(e,t,"uv",n,2,20,12)}function A6(e,t,n,r,a,i){let s,o,l;H4(e,(()=>e.bindTexture(e.TEXTURE_2D,t))),a instanceof Uint8Array?(s=new Uint8Array(n*r*4),o=e.UNSIGNED_BYTE,l=e.RGBA):(s=new Float32Array(n*r*4),o=e.FLOAT,l=i.internalFormatPackedFloat),s.set(a),2===$S().getNumber("WEBGL_VERSION")?H4(e,(()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n,r,e.RGBA,o,s))):H4(e,(()=>e.texImage2D(e.TEXTURE_2D,0,l,n,r,0,e.RGBA,o,s))),H4(e,(()=>e.bindTexture(e.TEXTURE_2D,null)))}function R6(e,t,n){H4(e,(()=>e.bindTexture(e.TEXTURE_2D,t))),n.data instanceof Uint8Array?2===$S().getNumber("WEBGL_VERSION")?H4(e,(()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n.width,n.height,e.RGBA,e.UNSIGNED_BYTE,n.data))):H4(e,(()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data))):2===$S().getNumber("WEBGL_VERSION")?H4(e,(()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,n))):H4(e,(()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n))),H4(e,(()=>e.bindTexture(e.TEXTURE_2D,null)))}function D6(e,t,n,r){let a=e.createBuffer();H4(e,(()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,a)));let i=16*t*n;return H4(e,(()=>e.bufferData(e.PIXEL_PACK_BUFFER,i,e.STREAM_READ))),H4(e,(()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0))),H4(e,(()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,null))),a}function F6(e,t,n){let r=e,a=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,a),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),a}function M6(e,t,n,r){let[a,i]=W4(t,n),s=new Uint8Array(function(e,t){return e*t}(t*n,4));return H4(e,(()=>e.readPixels(0,0,a,i,r.downloadTextureFormat,e.UNSIGNED_BYTE,s))),new Float32Array(s.buffer)}function O6(e,t,n,r,a,i,s,o){let l=e,u=new Float32Array(function(e,t){let[n,r]=U4(e,t);return n*r*4}(i,s));return l.bindBuffer(l.PIXEL_PACK_BUFFER,t),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,u),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),u}function P6(e,t,n){let r=new Float32Array(t*n*4);return H4(e,(()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,r))),r}ok(m6,{bindVertexProgramAttributeStreams:()=>$6,createBufferFromOutputTexture:()=>D6,createFloat16MatrixTexture:()=>S6,createFloat16PackedMatrixTexture:()=>_6,createFloat32MatrixTexture:()=>w6,createIndexBuffer:()=>y6,createPackedMatrixTexture:()=>T6,createUnsignedBytesMatrixTexture:()=>N6,createVertexBuffer:()=>b6,createVertexShader:()=>g6,downloadByteEncodedFloatMatrixFromOutputTexture:()=>M6,downloadFloat32MatrixFromBuffer:()=>F6,downloadMatrixFromPackedOutputTexture:()=>P6,downloadPackedMatrixFromBuffer:()=>O6,getInternalFormatForFloat16MatrixTexture:()=>k6,getInternalFormatForFloat16PackedMatrixTexture:()=>E6,getInternalFormatForFloat32MatrixTexture:()=>x6,getInternalFormatForPackedMatrixTexture:()=>C6,getInternalFormatForUnsignedBytesMatrixTexture:()=>I6,uploadDenseMatrixToTexture:()=>A6,uploadPixelDataToTexture:()=>R6});var L6=class{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];let t=$S().getNumber("WEBGL_VERSION");if(null!=e?(this.gl=e,z4(t,e)):this.gl=B4(t),e=this.gl,2===$S().getNumber("WEBGL_VERSION")){let t=e;this.createVertexArray=()=>H4(t,(()=>t.createVertexArray())),this.bindVertexArray=e=>H4(t,(()=>t.bindVertexArray(e))),this.deleteVertexArray=e=>H4(t,(()=>t.deleteVertexArray(e))),this.getVertexArray=()=>H4(t,(()=>t.getParameter(t.VERTEX_ARRAY_BINDING)))}else if(null!=e){let t=e.getExtension("OES_vertex_array_object");if(null==t)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>H4(e,(()=>t.createVertexArrayOES())),this.bindVertexArray=n=>H4(e,(()=>t.bindVertexArrayOES(n))),this.deleteVertexArray=n=>H4(e,(()=>t.deleteVertexArrayOES(n))),this.getVertexArray=()=>H4(e,(()=>e.getParameter(t.VERTEX_ARRAY_BINDING_OES)))}let n="WEBGL_color_buffer_float",r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),1===$S().getNumber("WEBGL_VERSION")){let e="OES_texture_float",t="OES_texture_half_float";if(this.textureFloatExtension=Y4(this.gl,e),O5(this.gl,t))this.textureHalfFloatExtension=Y4(this.gl,t);else if($S().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),O5(this.gl,r))this.colorBufferHalfFloatExtension=Y4(this.gl,r);else if($S().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",O5(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!O5(this.gl,r))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension(r)}this.vertexBuffer=b6(this.gl),this.indexBuffer=y6(this.gl),this.framebuffer=c5(this.gl),this.textureConfig=j4(this.gl,this.textureHalfFloatExtension)}get debug(){return $S().getBool("DEBUG")}dispose(){if(this.disposed)return;null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");let e=this.gl;H4(e,(()=>e.finish())),H4(e,(()=>e.bindFramebuffer(e.FRAMEBUFFER,null))),H4(e,(()=>e.deleteFramebuffer(this.framebuffer))),H4(e,(()=>e.bindBuffer(e.ARRAY_BUFFER,null))),H4(e,(()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null))),H4(e,(()=>e.deleteBuffer(this.indexBuffer))),this.disposed=!0}createFloat32MatrixTexture(e,t){return this.throwIfDisposed(),w6(this.gl,e,t,this.textureConfig)}createFloat16MatrixTexture(e,t){return this.throwIfDisposed(),S6(this.gl,e,t,this.textureConfig)}createUnsignedBytesMatrixTexture(e,t){return this.throwIfDisposed(),N6(this.gl,e,t,this.textureConfig)}uploadPixelDataToTexture(e,t){this.throwIfDisposed(),R6(this.gl,e,t)}uploadDenseMatrixToTexture(e,t,n,r){this.throwIfDisposed(),A6(this.gl,e,t,n,r,this.textureConfig)}createFloat16PackedMatrixTexture(e,t){return this.throwIfDisposed(),_6(this.gl,e,t,this.textureConfig)}createPackedMatrixTexture(e,t){return this.throwIfDisposed(),T6(this.gl,e,t,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(x5(this.gl,this.framebuffer),this.outputTexture=null),H4(this.gl,(()=>this.gl.deleteTexture(e)))}downloadByteEncodedFloatMatrixFromOutputTexture(e,t,n){return this.downloadMatrixDriver(e,(()=>M6(this.gl,t,n,this.textureConfig)))}downloadPackedMatrixFromBuffer(e,t,n,r,a,i){return O6(this.gl,e,0,0,0,a,i,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,t){return F6(this.gl,e,t)}createBufferFromTexture(e,t,n){this.bindTextureToFrameBuffer(e);let r=D6(this.gl,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){let e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,n;if($S().getBool("WEBGL_FENCE_API_ENABLED")){let r=e,a=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=()=>{let e=r.clientWaitSync(a,0,0);return e===r.ALREADY_SIGNALED||e===r.CONDITION_SATISFIED},t=a}else $S().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=()=>this.isQueryAvailable(t,$S().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):n=()=>!0;return{query:t,isFencePassed:n}}downloadMatrixFromPackedTexture(e,t,n){return this.downloadMatrixDriver(e,(()=>P6(this.gl,t,n)))}createProgram(e){this.throwIfDisposed();let t=this.gl;null==this.vertexShader&&(this.vertexShader=g6(t));let n=r5(t);H4(t,(()=>t.attachShader(n,this.vertexShader))),H4(t,(()=>t.attachShader(n,e))),a5(t,n);let r=Object.assign(n,{vao:this.createVertexArray()});return this.debug&&i5(t,r),r}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);let t=this.gl;H4(t,(()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer))),$6(t,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&(H4(this.gl,(()=>this.gl.deleteProgram(e))),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,null!=this.program&&this.debug&&i5(this.gl,this.program),H4(this.gl,(()=>this.gl.useProgram(e)))}getUniformLocation(e,t,n=!0){return this.throwIfDisposed(),n?m5(this.gl,e,t):g5(this.gl,e,t)}getAttributeLocation(e,t){return this.throwIfDisposed(),H4(this.gl,(()=>this.gl.getAttribLocation(e,t)))}getUniformLocationNoThrow(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}setInputMatrixTexture(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),b5(this.gl,e,t,n)}setOutputMatrixTexture(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)}setOutputPackedMatrixTexture(e,t,n){this.throwIfDisposed();let[r,a]=U4(t,n);this.setOutputMatrixTextureDriver(e,r,a)}setOutputMatrixWriteRegion(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)}setOutputPackedMatrixWriteRegion(e,t,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){null!=this.program&&i5(this.gl,this.program),w5(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();let e=this.gl;if(this.debug){let e=this.getVertexArray();console.assert(e===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}H4(e,(()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),H4(this.gl,(()=>this.gl.finish()))}getQueryTimerExtension(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=Y4(this.gl,2===$S().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(2===$S().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){let e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}let e=this.getQueryTimerExtensionWebGL1(),t=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,t),t}endQuery(){if(2===$S().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){let e=this.gl,t=this.getQueryTimerExtensionWebGL2();return void e.endQuery(t.TIME_ELAPSED_EXT)}let e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await pT.repeatedTry((()=>this.disposed||this.isQueryAvailable(e,$S().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")))),this.getQueryTime(e,$S().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,t){if(0===t)return null;if(2===t){let t=this.gl;return t.getQueryParameter(e,t.QUERY_RESULT)/1e6}{let t=this.getQueryTimerExtensionWebGL1();return t.getQueryObjectEXT(e,t.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,t){if(0===t)return!0;if(2===t){let t=this.gl,n=this.getQueryTimerExtensionWebGL2(),r=t.getQueryParameter(e,t.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(n.GPU_DISJOINT_EXT)),r&&!this.disjoint}{let t=this.getQueryTimerExtensionWebGL1(),n=t.getQueryObjectEXT(e,t.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(t.GPU_DISJOINT_EXT)),n&&!this.disjoint}}pollFence(e){return new Promise((t=>{this.addItemToPoll((()=>e.isFencePassed()),(()=>t()))}))}pollItems(){let e=function(e){let t=0;for(;t<e.length&&e[t]();++t);return t-1}(this.itemsToPoll.map((e=>e.isDoneFn)));for(let t=0;t<=e;++t){let{resolveFn:e}=this.itemsToPoll[t];e()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1)return;let n;"setTimeoutCustom"in $S().platform&&(n=$S().platform.setTimeoutCustom.bind($S().platform)),pT.repeatedTry((()=>(this.pollItems(),0===this.itemsToPoll.length)),(()=>0),null,n)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),v5(this.gl,e,this.framebuffer),this.debug&&w5(this.gl)}unbindTextureToFrameBuffer(){null!=this.outputTexture?(v5(this.gl,this.outputTexture,this.framebuffer),this.debug&&w5(this.gl)):x5(this.gl,this.framebuffer)}downloadMatrixDriver(e,t){this.bindTextureToFrameBuffer(e);let n=t();return this.unbindTextureToFrameBuffer(),n}setOutputMatrixTextureDriver(e,t,n){this.throwIfDisposed();let r=this.gl;v5(r,e,this.framebuffer),this.debug&&w5(r),this.outputTexture=e,H4(r,(()=>r.viewport(0,0,t,n))),H4(r,(()=>r.scissor(0,0,t,n)))}setOutputMatrixWriteRegionDriver(e,t,n,r){this.throwIfDisposed(),H4(this.gl,(()=>this.gl.scissor(e,t,n,r)))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(null==this.program)throw new Error("No GPU program is currently set.")}},{addImpl:z6,bincountImpl:B6,bincountReduceImpl:W6,bitwiseAndImpl:V6,castImpl:U6,ceilImpl:j6,concatImpl:H6,equalImpl:G6,expImpl:q6,expm1Impl:K6,floorImpl:X6,gatherNdImpl:Y6,gatherV2Impl:J6,greaterImpl:Z6,greaterEqualImpl:Q6,lessImpl:e8,lessEqualImpl:t8,linSpaceImpl:n8,logImpl:r8,maxImpl:a8,maximumImpl:i8,minimumImpl:s8,multiplyImpl:o8,negImpl:l8,notEqualImpl:u8,prodImpl:d8,raggedGatherImpl:c8,raggedRangeImpl:p8,raggedTensorToTensorImpl:h8,rangeImpl:f8,rsqrtImpl:m8,scatterImpl:g8,sigmoidImpl:b8,simpleAbsImpl:y8,sliceImpl:v8,sparseFillEmptyRowsImpl:x8,sparseReshapeImpl:w8,sparseSegmentReductionImpl:k8,sqrtImpl:S8,staticRegexReplaceImpl:I8,stridedSliceImpl:N8,stringNGramsImpl:C8,stringSplitImpl:T8,stringToHashBucketFastImpl:E8,subImpl:_8,tileImpl:$8,topKImpl:A8,transposeImpl:R8,uniqueImpl:D8}=QJ;function F8(e,t){return["x","y","z","w","u","v"].slice(0,t).map((t=>`${e}.${t}`))}function M8(e,t){return 1===t?[e]:F8(e,t)}var O8=class{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=p6(this.outputShape.length);let n="";for(let r=0;r<4;r++){let e="thisRC = rc;";r%2==1&&(e+="thisRC.z += 1;"),r>1&&(e+="thisRC.y += 1;"),n+=`\n        ${e}\n        ${r>0?"if(thisRC.y < rows && thisRC.z < cols){":""}\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[${r}] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ${r>0?"}":""}\n      `}this.userCode=`\n      ${function(e,t){return`\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ${t?q5(["r","c","d"],"inputShape"):H5(["r","c","d"],e)}\n      return ivec3(r, c, d);\n    }\n  `}(t,this.enableShapeUniforms)}\n      ${this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":K5(e)}\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};\n        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};\n\n        ${n}\n\n        setOutput(result);\n      }\n    `}};function P8(e,t,n,r,a){let i,s=function(e,t){switch(e){case O4.PACKED_2X2_FLOAT32:return C6(t);case O4.PACKED_2X2_FLOAT16:return E6(t);case O4.UNPACKED_FLOAT32:return x6(t);case O4.UNPACKED_FLOAT16:return k6(t);case O4.PACKED_4X1_UNSIGNED_BYTE:return I6(t);default:throw new Error(`Unknown physical texture type ${e}`)}}(t,r);if(a){let[t,n]=U4(e[0],e[1]);i=t*n}else{let[t,n]=W4(e[0],e[1]);i=t*n}let o=function(e,t){let n=e;if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F||t===e.RGBA)return 16;if(t===n.RGBA16F)return 8;if(t===n.RGBA8)return 4;throw new Error(`Unknown internal format ${t}`)}(n,s);return i*o}function L8(e,t){if(e===M4.UPLOAD)return O4.PACKED_2X2_FLOAT32;if(e===M4.RENDER||null==e)return function(e){return $S().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?O4.PACKED_2X2_FLOAT32:O4.UNPACKED_FLOAT32:e?O4.PACKED_2X2_FLOAT16:O4.UNPACKED_FLOAT16}(t);if(e===M4.DOWNLOAD||e===M4.PIXELS)return O4.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${e}`)}function z8(e,t,n){return`${e[0]}_${e[1]}_${t}_${n}`}var B8=class{constructor(e,t){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=p6(this.outputShape.length),this.userCode=`\n      float unaryOperation(float x) {\n        ${t}\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    `}},W8="if (isnan(x)) return x;",V8="return x;",U8="return abs(x);",j8="return (x >= 0.0) ? x : (exp(x) - 1.0);",H8=W8+"\n  return (x < 0.0) ? 0.0 : x;\n",G8=W8+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",q8="return x;",K8="return 1.0 / (1.0 + exp(-1.0 * x));",X8="return x;",Y8="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",J8="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",Z8="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",Q8="return 1.0 / (1.0 + exp(-1.0 * x));",e7=class{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=p6(this.outputShape.length),this.userCode=`\n      vec4 unaryOperation(vec4 x) {\n        ${t}\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    `}},t7=ML.whereImpl,n7={},r7=$S().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),a7=class extends Ak{nextDataId(){return a7.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!$S().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let t;if(null!=e){if(e instanceof L6)t=e;else{let n=B4($S().getNumber("WEBGL_VERSION"),e);t=new L6(n)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{let e=B4($S().getNumber("WEBGL_VERSION"));t=new L6(e),this.binaryCache=function(e){return e in n7||(n7[e]={}),n7[e]}($S().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=t,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new class{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,t,n){let r=L8(t,n),a=z8(e,r,n);a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]);let i,s=P8(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=s,this.log();let e=this.freeTextures[a].pop();return this.usedTextures[a].push(e),e}return r===O4.PACKED_2X2_FLOAT32?i=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===O4.PACKED_2X2_FLOAT16?i=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===O4.UNPACKED_FLOAT32?i=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===O4.UNPACKED_FLOAT16?i=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===O4.PACKED_4X1_UNSIGNED_BYTE&&(i=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[a].push(i),this.numUsedTextures++,this._numBytesAllocated+=s,this.log(),i}releaseTexture(e,t,n,r){if(null==this.freeTextures)return;let a=L8(n,r),i=z8(t,a,r);i in this.freeTextures||(this.freeTextures[i]=[]);let s=P8(t,a,this.gpgpu.gl,this.gpgpu.textureConfig,r),o=$S().get("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==o&&this._numBytesAllocated>o?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=s):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=s),this.numUsedTextures--;let l=this.usedTextures[i],u=l&&l.indexOf(e);if(null==u||u<0)throw new Error("Cannot release a texture that was never provided by this texture manager");l[u]=l[l.length-1],l.pop(),this.log()}log(){if(!this.logEnabled)return;let e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);let t=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*t)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(null!=this.freeTextures){for(let e in this.freeTextures)this.freeTextures[e].forEach((e=>{this.gpgpu.deleteMatrixTexture(e.texture)}));for(let e in this.usedTextures)this.usedTextures[e].forEach((e=>{this.gpgpu.deleteMatrixTexture(e.texture)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}(this.gpgpu),this.numMBBeforeWarning=null==$S().global.screen?1024:$S().global.screen.height*$S().global.screen.width*window.devicePixelRatio*600/1024/1024,this.texData=new $k(this,W_())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,t,n,r,a,i){let s=this.makeTensorInfo(t,n),o=this.texData.get(s.dataId);o.isPacked=!1,o.texture={texture:e,texShape:[r,a]},o.texShape=[r,a];let l=T5(t),u=new f6(l,!1,i),d=this.runWebGLProgram(u,[s],n,[[r,a]]);return d.shape=t,o.texture=null,this.disposeIntermediateTensorInfo(s),d.dataId}write(e,t,n){if(($S().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||$S().getBool("DEBUG"))&&this.checkNumericalProblems(e),"complex64"===n&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");let r={id:this.nextDataId()};return this.texData.set(r,{shape:t,dtype:n,values:e,usage:M4.UPLOAD,refCount:1}),r}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){this.texData.get(e).refCount++}decRef(e){this.texData.has(e)&&this.texData.get(e).refCount--}move(e,t,n,r,a){if($S().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:r,values:t,usage:M4.UPLOAD,refCount:a})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){let t=this.texData.get(e),{values:n,dtype:r,complexTensorInfos:a,slice:i,shape:s,isPacked:o}=t;if(null!=i){let t;t=o?new e7(s,q8):new B8(s,q8);let n=this.runWebGLProgram(t,[{dataId:e,shape:s,dtype:r}],r),a=this.readSync(n.dataId);return this.disposeIntermediateTensorInfo(n),a}if(null!=n)return this.convertAndCacheOnCPU(e);if("string"===r)return n;let l,u,d=null!=this.activeTimers;if(d&&(l=pT.now()),"complex64"===r){let e=this.readSync(a.real.dataId),t=this.readSync(a.imag.dataId);u=_P.mergeRealAndImagArrays(e,t)}else u=this.getValuesFromTexture(e);return d&&(this.downloadWaitMs+=pT.now()-l),this.convertAndCacheOnCPU(e,u)}async read(e){if(this.pendingRead.has(e)){let t=this.pendingRead.get(e);return new Promise((e=>t.push(e)))}let t=this.texData.get(e),{values:n,shape:r,slice:a,dtype:i,complexTensorInfos:s,isPacked:o}=t;if(null!=a){let t;t=o?new e7(r,q8):new B8(r,q8);let n=this.runWebGLProgram(t,[{dataId:e,shape:r,dtype:i}],i),a=this.read(n.dataId);return this.disposeIntermediateTensorInfo(n),a}if(null!=n)return this.convertAndCacheOnCPU(e);if($S().getBool("DEBUG")&&!$S().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===$S().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let l,u,d=null;if("complex64"!==i&&$S().get("WEBGL_BUFFER_SUPPORTED")){l=this.decode(e);let t=this.texData.get(l.dataId);d=this.gpgpu.createBufferFromTexture(t.texture.texture,...V4(r))}if(this.pendingRead.set(e,[]),"complex64"!==i&&await this.gpgpu.createAndWaitForFence(),"complex64"===i){let e=await Promise.all([this.read(s.real.dataId),this.read(s.imag.dataId)]),t=e[0],n=e[1];u=_P.mergeRealAndImagArrays(t,n)}else if(null==d)u=this.getValuesFromTexture(e);else{let e=pT.sizeFromShape(r);u=this.gpgpu.downloadFloat32MatrixFromBuffer(d,e)}if(null!=l&&this.disposeIntermediateTensorInfo(l),null!=d){let e=this.gpgpu.gl;H4(e,(()=>e.deleteBuffer(d)))}let c=this.convertAndCacheOnCPU(e,u),p=this.pendingRead.get(e);return this.pendingRead.delete(e),p.forEach((e=>e(c))),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&W_().removeDataId(e,this),this.pendingDeletes--),c}readToGPU(e,t={}){let n=this.texData.get(e),{values:r,shape:a,slice:i,dtype:s,isPacked:o,texture:l}=n;if("complex64"===s)throw new Error("Does not support reading texture for complex64 dtype.");if(null!=i){let n;n=o?new e7(a,q8):new B8(a,q8);let r=this.runWebGLProgram(n,[{dataId:e,shape:a,dtype:s}],s),i=this.readToGPU(r,t);return this.disposeIntermediateTensorInfo(r),i}if(null==l)throw null!=r?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");let u=this.decode(e,t.customTexShape),d=W_().makeTensorFromTensorInfo(u),c=this.texData.get(u.dataId);return Object.assign({tensorRef:d},c.texture)}bufferSync(e){let t=this.readSync(e.dataId);if("string"===e.dtype)try{let n=t.map((e=>pT.decodeString(e)));return R_(e.shape,e.dtype,n)}catch(_p){throw new Error("Failed to decode encoded string bytes into utf-8")}return R_(e.shape,e.dtype,t)}checkNumericalProblems(e){if(null!=e)for(let t=0;t<e.length;t++){let n=e[t];if(!K4(n))throw $S().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${n} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${n} cannot be represented on this device.`)}}getValuesFromTexture(e){let{shape:t,dtype:n,isPacked:r}=this.texData.get(e),a=pT.sizeFromShape(t);if($S().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){let n=this.decode(e),r=this.texData.get(n.dataId),i=this.gpgpu.downloadMatrixFromPackedTexture(r.texture.texture,...V4(t)).subarray(0,a);return this.disposeIntermediateTensorInfo(n),i}let i=$S().getBool("WEBGL_PACK")&&!0===r,s=i?T5(t):t,o=i?new class{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=M4.DOWNLOAD;let t=j5();this.outputShape=e,this.userCode=`\n      ${X5}\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ${t.output} = encode_float(x);\n      }\n    `}}(s):new class{constructor(e){this.variableNames=["A"],this.outTexUsage=M4.DOWNLOAD;let t=j5();this.outputShape=e,this.userCode=`\n      ${X5}\n\n      void main() {\n        float x = getAAtOutCoords();\n        ${t.output} = encode_float(x);\n      }\n    `}}(s),l=this.runWebGLProgram(o,[{shape:s,dtype:n,dataId:e}],"float32"),u=this.texData.get(l.dataId),d=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(u.texture.texture,u.texShape[0],u.texShape[1]).subarray(0,a);return this.disposeIntermediateTensorInfo(l),d}timerAvailable(){return $S().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){let t=this.activeTimers,n=[],r=!1;null==this.programTimersStack?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,e();let a=pT.flatten(this.activeTimers.map((e=>e.query))).filter((e=>null!=e)),i=pT.flatten(this.activeTimers.map((e=>e.name))).filter((e=>null!=e));this.activeTimers=t,r&&(this.programTimersStack=null);let s={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if($S().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){let e=await Promise.all(a);s.kernelMs=pT.sum(e),s.getExtraProfileInfo=()=>e.map(((e,t)=>({name:i[t],ms:e}))).map((e=>`${e.name}: ${e.ms}`)).join(", ")}else s.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,s})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return $S().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:pT.now(),endMs:null}}endTimer(e){return $S().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=pT.now(),e)}async getQueryTime(e){if($S().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);let t=e;return t.endMs-t.startMs}disposeData(e,t=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);let{complexTensorInfos:n}=this.texData.get(e);return null!=n&&(this.disposeData(n.real.dataId,t),this.disposeData(n.imag.dataId,t)),this.texData.delete(e),!0}releaseGPUData(e){let{texture:t,dtype:n,texShape:r,usage:a,isPacked:i,slice:s}=this.texData.get(e),o=s&&s.origDataId||e,l=this.dataRefCount.get(o);l>1?this.dataRefCount.set(o,l-1):(this.dataRefCount.delete(o),null!=t&&(this.numBytesInGPU-=this.computeBytes(r,n),this.textureManager.releaseTexture(t,r,a,i)));let u=this.texData.get(e);u.texture=null,u.texShape=null,u.isPacked=!1,u.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,t=r7){return $S().getBool("WEBGL_CPU_FORWARD")&&e.every((e=>null==this.texData.get(e.dataId).texture&&pT.sizeFromShape(e.shape)<t))}getGPGPUContext(){return this.gpgpu}where(e){_P.warn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");let t=e.dataSync();return t7(e.shape,t)}packedUnaryOp(e,t,n){let r=new e7(e.shape,t),a=this.compileAndRun(r,[e],n);return W_().makeTensorFromTensorInfo(a)}abs(e){if(this.shouldExecuteOnCPU([e])&&"complex64"!==e.dtype){let t=y8(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,t)}if($S().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,U8,e.dtype);let t=new B8(e.shape,U8),n=this.compileAndRun(t,[e]);return W_().makeTensorFromTensorInfo(n)}makeTensorInfo(e,t,n){let r;if("string"===t&&null!=n&&n.length>0&&pT.isString(n[0])){let a=n.map((e=>pT.encodeString(e)));r=this.write(a,e,t)}else r=this.write(n,e,t);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:t}}makeOutput(e,t,n){return W_().makeTensorFromTensorInfo(this.makeTensorInfo(e,t,n),this)}unpackTensor(e){let t=new class{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=p6(this.outputShape.length);let t=e.length,n=M8("rc",t),r=s6(t),a=function(e,t){if(1===e)return"rc";let n="";for(let r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}(t,n),i=n.slice(-2),s=t<=1?"rc":`vec2(${i.join(",")})`;this.userCode=`\n      void main() {\n        ${r} rc = getOutputCoords();\n        vec4 packedInput = getA(${a});\n\n        setOutput(getChannel(packedInput, ${s}));\n      }\n    `}}(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}packTensor(e){let t=new class{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=p6(this.outputShape.length),0===this.rank)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{let e=M8("rc",this.rank),t=s6(this.rank),n=this.getOutOfBoundsCondition(e),r=this.getSetup(e),a=this.getOutput(e);this.userCode=`\n        void main() {\n          ${t} rc = getOutputCoords();\n\n          if(${n}) {\n            setOutput(vec4(0));\n          } else {\n            ${r}\n\n            setOutput(vec4(${a}));\n          }\n        }\n      `}}getSourceCoordsArr(e){let t=[];for(let n=0;n<=1;n++)for(let r=0;r<=1;r++){let a=`${0===n?"r":"rp1"}, ${0===r?"c":"cp1"}`;for(let t=2;t<this.rank;t++)a=`${e[e.length-1-t]},`+a;t.push(a)}return t}getOutOfBoundsCondition(e){if(1===this.rank)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let t="";for(let n=this.rank-2;n<this.rank;n++)t+=`${e[n]} >= ${this.enableShapeUniforms?`outShape[${n}]`:this.outputShape[n]}`,n<this.rank-1&&(t+="||");return t}getSetup(e){if(1===this.rank)return"";let t=e.slice(-2),n=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],r=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`\n      int r = ${t[0]};\n      int c = ${t[1]};\n      int rp1 = r + 1;\n      int cp1 = c + 1;\n\n      bool cEdge = cp1 >= ${n};\n      bool rEdge = rp1 >= ${r};\n    `}getOutput(e){let t=this.getSourceCoordsArr(e);return 1===this.rank?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${t[0]}),\n            cEdge ? 0. : getA(${t[1]}),\n            rEdge ? 0. : getA(${t[2]}),\n            rEdge || cEdge ? 0. : getA(${t[3]})`}}(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}packedReshape(e,t){let n=[N5(e.shape),...C5(e.shape)],r={dtype:e.dtype,shape:n,dataId:e.dataId},a=[N5(t),...C5(t)],i=new O8(a,n),s=[n],o=this.runWebGLProgram(i,[r],e.dtype,s,!0);return{dataId:o.dataId,shape:t,dtype:o.dtype}}decode(e,t){let n=this.texData.get(e),{isPacked:r,shape:a,dtype:i}=n;if(null!=t){let e=pT.sizeFromShape(a),n=t[0]*t[1]*4;pT.assert(e<=n,(()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data."))}let s,o=T5(a);s=r?new class{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=F4.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];let t=j5();this.outputShape=e,this.enableShapeUniforms=p6(this.outputShape.length),this.userCode=`\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ${this.enableShapeUniforms?G5(["r","c","d"],e):H5(["r","c","d"],e)}\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ${t.output} = result;\n      }\n    `}}(o):new class{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=F4.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];let t=j5();this.outputShape=e,this.enableShapeUniforms=p6(this.outputShape.length),this.userCode=`\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ${this.enableShapeUniforms?G5(["r","c","d"],e):H5(["r","c","d"],e)}\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ${t.output} = result;\n      }\n    `}}(o);let l=[null!=t?t:V4(o)];return{dtype:i,shape:a,dataId:this.runWebGLProgram(s,[{shape:o,dtype:i,dataId:e}],i,l,!0,t).dataId}}runWebGLProgram(e,t,n,r,a=!1,i){let s=this.makeTensorInfo(e.outputShape,n),o=this.texData.get(s.dataId);if(e.packedOutput&&(o.isPacked=!0),e.outPackingScheme===F4.DENSE){let t=null!=i?i:V4(e.outputShape);o.texShape=t.map((e=>2*e))}if(null!=e.outTexUsage&&(o.usage=e.outTexUsage),0===pT.sizeFromShape(s.shape))return o.values=pT.getTypedArrayFromDType(s.dtype,0),s;let l=[],u=t.map((t=>{if("complex64"===t.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let n=this.texData.get(t.dataId);if(null==n.texture){if(!e.packedInputs&&pT.sizeFromShape(t.shape)<=$S().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:t.shape,texData:null,isUniform:!0,uniformValues:n.values};e.packedInputs&&(n.isPacked=!0,n.shape=t.shape)}if(this.uploadToGPU(t.dataId),!!n.isPacked!=!!e.packedInputs)t=n.isPacked?this.unpackTensor(t):this.packTensor(t),l.push(t),n=this.texData.get(t.dataId);else if(n.isPacked&&!$5(n.shape,t.shape)){let e=t,r=t.shape;t.shape=n.shape,t=this.packedReshape(t,r),l.push(t),n=this.texData.get(t.dataId),e.shape=r}return{shape:t.shape,texData:n,isUniform:!1}}));this.uploadToGPU(s.dataId);let d,c={shape:s.shape,texData:o,isUniform:!1},p=function(e,t,n){let r="";t.concat(n).forEach((t=>{let a=null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0;if(e.enableShapeUniforms&&!t.isUniform){let i=t.texData.texShape,{useSqueezeShape:s,uniformShape:o,keptDims:l}=o6(e.packedInputs,t.shape,i),u="",d="",c="";if(1===o.length&&e.packedInputs){let e=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];u=`${e[0]>1}_${e[1]>1}`}else if(2!==o.length||e.packedInputs){if(o.length>2&&!e.packedInputs){let e=pT.computeStrides(o);c=`${e[0]===i[1]}_${e[e.length-1]===i[1]}`}}else d=`${o[0]>1}_${o[1]>1}`;let p=t.shape.length,h=2===o.length&&pT.arraysEqual(t.shape,i),f=1===pT.sizeFromShape(t.shape),m=_P.getBroadcastDims(t.shape,n.shape),g=!e.packedInputs&&p===n.shape.length&&pT.arraysEqual(i,n.texData.texShape),b=e.packedInputs||o.length>2?"":`${i[0]>1}_${i[1]>1}`;r+=`${p}_${g}_${s?l:""}_${o.length}_${f}_${m}_${h}_${u}_${d}_${c}_${b}_${a}`}else{let e=t.isUniform?"uniform":t.texData.texShape;r+=`${t.shape}_${e}_${a}`}}));let a=e.userCode,i=e.constructor.name;return i+="_"+r+"_"+a+`${$S().getNumber("WEBGL_VERSION")}`,i}(e,u,c),h=this.getAndSaveBinary(p,(()=>function(e,t,n,r){let a=n.map(((e,n)=>{let r={logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:!e.isUniform&&e.texData.isPacked,flatOffset:null};return null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0&&(r.flatOffset=e.texData.slice.flatOffset),{name:t.variableNames[n],shapeInfo:r}})),i=a.map((e=>e.shapeInfo)),s={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},o=J5(a,s,t),l=Z4(e.gl,o),u=e.createProgram(l);return $S().get("ENGINE_COMPILE_ONLY")?{program:t,fragmentShader:l,source:o,webGLProgram:u,inShapeInfos:i,outShapeInfo:s,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(e.buildVao(u),Object.assign({program:t,fragmentShader:l,source:o,webGLProgram:u,inShapeInfos:i,outShapeInfo:s},d6(e,t,u)))}(this.gpgpu,e,u,c))),f=null!=this.activeTimers;f&&(d=this.startTimer()),$S().get("ENGINE_COMPILE_ONLY")||function(e,t,n,r,a){t.program.enableShapeUniforms||(c6(t.inShapeInfos,n),c6([t.outShapeInfo],[r]));let i=r.texData.texture,s=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(i.texture,s[0],s[1]):e.setOutputMatrixTexture(i.texture,s[0],s[1]),e.setProgram(t.webGLProgram),e.bindVertexArray(t.webGLProgram.vao),1===$S().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&e.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&e.gl.uniform1f(t.nanLoc,NaN);for(let l=0;l<n.length;++l){let r=n[l],{uniform:a,offset:i,shape:s,texShape:o}=t.variablesLocations[l];if(s){let{uniformShape:n}=o6(t.program.packedInputs,r.shape,r.texData.texShape);switch(n.length){case 1:e.gl.uniform1iv(s,new Int32Array(n));break;case 2:e.gl.uniform2iv(s,new Int32Array(n));break;case 3:e.gl.uniform3iv(s,new Int32Array(n));break;case 4:e.gl.uniform4iv(s,new Int32Array(n))}}if(o&&e.gl.uniform2i(o,r.texData.texShape[0],r.texData.texShape[1]),null!=a){if(r.isUniform){if(pT.sizeFromShape(r.shape)<2)e.gl.uniform1f(a,r.uniformValues[0]);else{let t=r.uniformValues;t instanceof Float32Array||(t=new Float32Array(t)),e.gl.uniform1fv(a,t)}continue}null!=r.texData.slice&&null!=i&&e.gl.uniform1i(i,r.texData.slice.flatOffset),e.setInputMatrixTexture(r.texData.texture.texture,a,l)}}let o=t.outShapeLocation;if(o)switch(r.shape.length){case 1:e.gl.uniform1iv(o,new Int32Array(r.shape));break;case 2:e.gl.uniform2iv(o,new Int32Array(r.shape));break;case 3:e.gl.uniform3iv(o,new Int32Array(r.shape));break;case 4:e.gl.uniform4iv(o,new Int32Array(r.shape))}if(t.outShapeStridesLocation){let n=pT.computeStrides(r.shape);switch(r.shape.length){case 2:e.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(n));break;case 3:e.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(n));break;case 4:e.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(n))}}if(t.outTexShapeLocation&&e.gl.uniform2i(t.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),t.program.customUniforms&&a)for(let l=0;l<t.program.customUniforms.length;++l){let n=t.program.customUniforms[l],r=t.customUniformLocations[l],i=a[l];if("float"===n.type)e.gl.uniform1fv(r,i);else if("vec2"===n.type)e.gl.uniform2fv(r,i);else if("vec3"===n.type)e.gl.uniform3fv(r,i);else if("vec4"===n.type)e.gl.uniform4fv(r,i);else if("int"===n.type)e.gl.uniform1iv(r,i);else if("ivec2"===n.type)e.gl.uniform2iv(r,i);else if("ivec3"===n.type)e.gl.uniform3iv(r,i);else{if("ivec4"!==n.type)throw Error(`uniform type ${n.type} is not supported yet.`);e.gl.uniform4iv(r,i)}}e.executeProgram()}(this.gpgpu,h,u,c,r),l.forEach((e=>this.disposeIntermediateTensorInfo(e))),f&&(d=this.endTimer(d),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(d)}));let m=$S().get("WEBGL_FLUSH_THRESHOLD");if(m>0){let e=pT.now();e-this.lastGlFlushTime>m&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=e)}if(!$S().getBool("WEBGL_LAZILY_UNPACK")&&o.isPacked&&!1===a){let e=this.unpackTensor(s);return this.disposeIntermediateTensorInfo(s),e}return s}compileAndRun(e,t,n,r,a=!1){return n=n||t[0].dtype,this.runWebGLProgram(e,t,n,r,a)}getAndSaveBinary(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||($S().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach((e=>{this.gpgpu.deleteProgram(this.binaryCache[e].webGLProgram),delete this.binaryCache[e]})),this.textureManager.dispose(),null!=this.canvas&&"undefined"!=typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return null==this.floatPrecisionValue&&(this.floatPrecisionValue=j_((()=>{if(!$S().get("WEBGL_RENDER_FLOAT32_ENABLED")){let e=$S().getBool("DEBUG");$S().set("DEBUG",!1);let t=this.abs(qA(1e-8)).dataSync()[0];if($S().set("DEBUG",e),t>0)return 32}return 16}))),this.floatPrecisionValue}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}uploadToGPU(e){let t=this.texData.get(e),{shape:n,dtype:r,values:a,texture:i,usage:s,isPacked:o}=t;if(null!=i)return;let l,u=null!=this.activeTimers;u&&(l=pT.now());let d=t.texShape;if(null==d&&(d=E5(n,o),t.texShape=d),null!=a){let e,i=T5(n),s=d[1],c=d[0],p=a instanceof Uint8Array||a instanceof Uint8ClampedArray;(o||!p)&&([s,c]=U4(d[0],d[1])),e=o?new class{constructor(e,t=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];let n=j5();this.outputShape=e,this.enableShapeUniforms=p6(this.outputShape.length);let r="",a="result";t&&(a="floor(result * 255. + 0.5)");for(let i=0;i<=1;i++)for(let t=0;t<=1;t++){let a=2*i+t;r+=`\n          localCoords = coords;\n          if(localCoords[2] + ${t} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {\n          localCoords[2] += ${t};\n          if (localCoords[1] + ${i} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {\n            localCoords[1] += ${i};\n\n            flatIndex = getFlatIndex(localCoords);\n            offset = imod(flatIndex, 4);\n\n            flatIndex = idiv(flatIndex, 4, 1.);\n\n            int r = flatIndex / texShape[1];\n            int c = imod(flatIndex, texShape[1]);\n            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n            values = ${n.texture2D}(A, uv);\n\n            if (offset == 0) {\n              result[${a}] = values[0];\n            } else if (offset == 1) {\n              result[${a}] = values[1];\n            } else if (offset == 2) {\n              result[${a}] = values[2];\n            } else {\n              result[${a}] = values[3];\n            }\n          }\n        }\n        `}this.userCode=`\n        ${this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":K5(e)}\n\n        void main() {\n          ivec3 coords = getOutputCoords();\n\n          vec4 result = vec4(0.);\n          int flatIndex, r, c, offset;\n          ivec3 localCoords;\n          vec2 uv;\n          vec4 values;\n\n          ${r}\n\n          ${n.output} = ${a};\n        }\n    `}}(i,p):new f6(i,p);let h=p?[c,s]:d,f=this.makeTensorInfo(h,r),m=this.texData.get(f.dataId);m.usage=p?M4.PIXELS:M4.UPLOAD,m.texShape=h,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(f.dataId),s,c,a);let g=[[c,s]],b=!0,y=this.runWebGLProgram(e,[f],r,g,b),v=this.texData.get(y.dataId);t.texShape=v.texShape,t.isPacked=v.isPacked,t.usage=v.usage,$S().get("ENGINE_COMPILE_ONLY")?this.disposeData(y.dataId):(t.texture=v.texture,t.values=null,this.texData.delete(y.dataId)),this.disposeIntermediateTensorInfo(f),u&&(this.uploadWaitMs+=pT.now()-l)}else{let e=this.acquireTexture(d,s,r,o);t.texture=e}}convertAndCacheOnCPU(e,t){let n=this.texData.get(e),{dtype:r}=n;return null!=t&&(n.values=function(e,t){if("float32"===t||"complex64"===t)return e;if("int32"===t||"bool"===t){let n="int32"===t?new Int32Array(e.length):new Uint8Array(e.length);for(let t=0;t<n.length;++t)n[t]=Math.round(e[t]);return n}throw new Error(`Unknown dtype ${t}`)}(t,r)),n.values}acquireTexture(e,t,n,r){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){let e=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${e} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,t,r)}computeBytes(e,t){return e[0]*e[1]*pT.bytesPerElement(t)}checkCompileCompletion(){for(let[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){let e=[];if(this.gpgpu.parallelCompilationExtension){for(let[,t]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(t));return Promise.all(e)}for(let[,t]of Object.entries(this.binaryCache)){let n=new Promise((e=>{try{this.checkCompletion_(t),e(!0)}catch(Rp){throw Rp}}));e.push(n)}return Promise.all(e)}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await TP(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(!1===this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS))throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),!1===this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)?(n5(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(let e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);let{variablesLocations:t,customUniformLocations:n,infLoc:r,nanLoc:a,outShapeLocation:i,outShapeStridesLocation:s,outTexShapeLocation:o}=d6(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=t,e.customUniformLocations=n,e.infLoc=r,e.nanLoc=a,e.outShapeLocation=i,e.outShapeStridesLocation=s,e.outTexShapeLocation=o}}createTensorFromGPUData(e,t,n){e.channels=e.channels||"RGBA";let{texture:r,height:a,width:i,channels:s}=e,o=W_().backend;if(!o.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");let l=o.writeTexture(r,t,n,a,i,s);return W_().makeTensorFromDataId(l,t,n,o)}};a7.nextDataId=0;var i7="4.7.0";function s7(){$S().set("WEBGL_FORCE_F16_TEXTURES",!0)}wE.isBrowser()&&e$("webgl",(()=>new a7),2);var o7={forceHalfFloat:s7},l7="\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n",u7=class{constructor(e,t,n){this.variableNames=["A","B"],this.outputShape=_P.assertAndGetBroadcastShape(t,n),this.enableShapeUniforms=p6(this.outputShape.length),this.userCode=`\n      float binaryOperation(float a, float b) {\n        ${e}\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    `}},d7="\n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n",c7=class{constructor(e,t,n,r=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=_P.assertAndGetBroadcastShape(t,n);let a=this.outputShape.length;this.enableShapeUniforms=p6(a);let i="";if(r)if(0===a||1===pT.sizeFromShape(this.outputShape))i="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(i=`\n          ${s6(a)} coords = getOutputCoords();\n        `,1===a)this.enableShapeUniforms?i+="\n            result.y = (coords + 1) >= outShape ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ":i+=`\n            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          `;else{let e=M8("coords",a);this.enableShapeUniforms?i+=`\n            bool nextRowOutOfBounds =\n              (${e[a-2]} + 1) >= outShape[${a} - 2];\n            bool nextColOutOfBounds =\n              (${e[a-1]} + 1) >= outShape[${a} - 1];\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          `:i+=`\n            bool nextRowOutOfBounds =\n              (${e[a-2]} + 1) >= ${this.outputShape[a-2]};\n            bool nextColOutOfBounds =\n              (${e[a-1]} + 1) >= ${this.outputShape[a-1]};\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          `}this.userCode=`\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ${e}\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ${i}\n\n        setOutput(result);\n      }\n    `}};function p7(e){let{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var h7={kernelName:JI,backendName:"webgl",kernelFunc:p7};function f7(e){let{inputs:t,backend:n}=e,{real:r,imag:a}=t,i=n.makeTensorInfo(r.shape,"complex64"),s=n.texData.get(i.dataId),o=p7({inputs:{x:r},backend:n}),l=p7({inputs:{x:a},backend:n});return s.complexTensorInfos={real:o,imag:l},i}var m7={kernelName:lI,backendName:"webgl",kernelFunc:f7},g7="return (a < 0.) ? b * a : a;",b7="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",y7={kernelName:rN,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{alpha:i}=r,s=n.makeTensorInfo([],"float32",pT.createScalarValue(i,"float32")),o=$S().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new c7(b7,a.shape,s.shape):new u7(g7,a.shape,s.shape),l=n.runWebGLProgram(o,[a,s],"float32");return n.disposeIntermediateTensorInfo(s),l}},v7="return (a < 0.) ? b * a : a;",x7="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",w7={kernelName:UN,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{x:r,alpha:a}=t,i=$S().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new c7(x7,r.shape,a.shape):new u7(v7,r.shape,a.shape);return n.runWebGLProgram(i,[r,a],"float32")}},k7="if (isnan(x)) return x;";function S7({opSnippet:e,packedOpSnippet:t,cpuKernelImpl:n,dtype:r}){return({inputs:a,backend:i})=>{let s,{x:o}=a,l=i,u=r||o.dtype;if(l.shouldExecuteOnCPU([o])&&null!=n){let e=l.texData.get(o.dataId),t=n(e.values,u);return l.makeTensorInfo(o.shape,u,t)}return s=$S().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=t?new e7(o.shape,t):new B8(o.shape,e),l.runWebGLProgram(s,[o],u)}}function I7({opSnippet:e,packedOpSnippet:t,checkOutOfBounds:n=!1,supportsComplex:r=!1,cpuKernelImpl:a,dtype:i}){return({inputs:s,backend:o})=>{let{a:l,b:u}=s,d=o;if(r&&"complex64"===l.dtype){let t=d.texData.get(l.dataId),n=d.texData.get(u.dataId),[r,a]=[[t.complexTensorInfos.real,n.complexTensorInfos.real],[t.complexTensorInfos.imag,n.complexTensorInfos.imag]].map((t=>{let[n,r]=t,a={dataId:n.dataId,dtype:n.dtype,shape:l.shape},i={dataId:r.dataId,dtype:r.dtype,shape:u.shape},s=new u7(e,l.shape,u.shape);return d.runWebGLProgram(s,[a,i],iE(n.dtype,r.dtype))})),i=f7({inputs:{real:r,imag:a},backend:d});return d.disposeIntermediateTensorInfo(r),d.disposeIntermediateTensorInfo(a),i}let c,p=i||iE(l.dtype,u.dtype);if(("string"===l.dtype||"string"===u.dtype||d.shouldExecuteOnCPU([l,u]))&&null!=a){let e=d.texData.get(l.dataId).values,t=d.texData.get(u.dataId).values,n="string"===l.dtype?_P.fromUint8ToStringArray(e):e,r="string"===l.dtype?_P.fromUint8ToStringArray(t):t,[i,s]=a(l.shape,u.shape,n,r,p),o=d.makeTensorInfo(s,p);return d.texData.get(o.dataId).values=i,o}return c=$S().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=t?new c7(t,l.shape,u.shape,n):new u7(e,l.shape,u.shape),d.runWebGLProgram(c,[l,u],p)}}function N7(e,t=!1){if("linear"===e)return t?X8:V8;if("relu"===e)return t?J8:H8;if("elu"===e)return t?Y8:j8;if("relu6"===e)return t?Z8:G8;if("prelu"===e)return t?x7:v7;if("leakyrelu"===e)return t?b7:g7;if("sigmoid"===e)return t?Q8:K8;throw new Error(`Activation ${e} has not been implemented for the WebGL backend.`)}var C7=class{constructor(e,t,n,r=!1,a=!1,i=!1,s=null,o=!1,l=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.enableShapeUniforms=p6(this.outputShape.length);let u=r?e[1]:e[2],d=Math.ceil(u/2),c=r?"i * 2, rc.y":"rc.y, i * 2",p=a?"rc.z, i * 2":"i * 2, rc.z",h=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],f=a?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],m="",g="";s&&(m=o?`vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ${s}\n        }`:l?`vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ${s}\n        }`:`vec4 activation(vec4 x) {\n          ${s}\n        }`,g="result = activation(result);");let b=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),l&&this.variableNames.push("leakyreluAlpha");let y="rc.x",v="rc.x";e[0]<t[0]?y=`imod(rc.x, ${e[0]})`:t[0]<e[0]&&(v=`imod(rc.x, ${t[0]})`),this.userCode=`\n      ${m}\n      // Don't use uniform for sharedDimensionPacked for performance.\n      const float sharedDimension = ${d}.0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        int batchA = ${y};\n        int batchB = ${v};\n        for (int i = 0; i < ${d}; i++) {\n          vec4 a = getMatrixA(batchA, ${c});\n          vec4 b = getMatrixB(batchB, ${p});\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (${h[0]} * ${f[0]});\n          result += (${h[1]} * ${f[1]});\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ${b}\n\n        ${g}\n\n        setOutput(result);\n      }\n    `}},T7={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"},E7=class{constructor(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=_P.assertAndGetBroadcastShape(t,n),this.userCode=`\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ${e}\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    `}},_7="return a * b;";function $7(e){let t,{inputs:n,backend:r}=e,{a:a,b:i}=n,s=_P.upcastType(a.dtype,i.dtype);if("complex64"===a.dtype){let e=r.texData.get(a.dataId),t=r.texData.get(i.dataId),n=new E7(T7.REAL,a.shape,i.shape),s=new E7(T7.IMAG,a.shape,i.shape),o=[{dataId:e.complexTensorInfos.real.dataId,dtype:e.complexTensorInfos.real.dtype,shape:a.shape},{dataId:e.complexTensorInfos.imag.dataId,dtype:e.complexTensorInfos.imag.dtype,shape:a.shape},{dataId:t.complexTensorInfos.real.dataId,dtype:t.complexTensorInfos.real.dtype,shape:i.shape},{dataId:t.complexTensorInfos.imag.dataId,dtype:t.complexTensorInfos.imag.dtype,shape:i.shape}],l=r.runWebGLProgram(n,o,"float32"),u=r.runWebGLProgram(s,o,"float32"),d=f7({inputs:{real:l,imag:u},backend:r});return r.disposeIntermediateTensorInfo(l),r.disposeIntermediateTensorInfo(u),d}if(r.shouldExecuteOnCPU([a,i])){let e=r.texData.get(a.dataId),t=r.texData.get(i.dataId),[n,o]=o8(a.shape,i.shape,e.values,t.values,s),l=r.makeTensorInfo(o,s);return r.texData.get(l.dataId).values=n,l}return t=$S().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new c7(_7,a.shape,i.shape):new u7(_7,a.shape,i.shape),r.runWebGLProgram(t,[a,i],s)}var A7={kernelName:AN,backendName:"webgl",kernelFunc:$7};function R7(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{shape:i}=r,s=n,o=pT.sizeFromShape(a.shape),l=pT.inferFromImplicitShape(i,o),u=pT.sizeFromShape(l);pT.assert(o===u,(()=>`The new shape (${l}) has ${u} elements and the old shape (${a.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`));let d=s.texData.get(a.dataId);return!d.isPacked||$5(a.shape,l)||null!==d.texture&&$5(d.shape,l)?(s.incRef(a.dataId),{dataId:a.dataId,shape:l,dtype:a.dtype}):function(e,t,n){let r=[N5(e.shape),...C5(e.shape)],a={dtype:e.dtype,shape:r,dataId:e.dataId},i=[N5(t),...C5(t)],s=new O8(i,r),o=[r],l=n.runWebGLProgram(s,[a],e.dtype,o,!0);return{dataId:l.dataId,shape:t,dtype:l.dtype}}(a,l,s)}var D7={kernelName:ZN,backendName:"webgl",kernelFunc:R7},F7=class{constructor(e,t){this.variableNames=["x"];let{windowSize:n,batchSize:r,inSize:a,outSize:i}=e;this.outputShape=[r,i];let s=4*Math.floor(n/4),o=n%4,l="sumValue += dot(values, ones);";if(null!=t){let e=1/t;l=`sumValue += dot(values * ${pT.isInt(e)?e.toPrecision(2):e}, ones);`}let u="";a%n>0&&(u=`\n        if (inIdx < 0 || inIdx >= ${a}) {\n          return 0.0;\n        }\n      `),this.userCode=`\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ${u}\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${n};\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ${s}; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ${l}\n        }\n\n        int inIdx = inOffset + ${s};\n        if (${1===o}) {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ${l}\n        } else if (${2===o}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ${l}\n        } else if (${3===o}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ${l}\n        }\n        setOutput(sumValue);\n      }\n    `}},M7=class{constructor(e,t){this.variableNames=["x"];let{windowSize:n,batchSize:r,inSize:a,outSize:i}=e;this.outputShape=[r,i];let s="0.0",o="";"prod"===t?s="1.0":"min"===t?(s="1.0 / 1e-20",o="min"):"max"===t&&(s="-1.0 / 1e-20",o="max");let l=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"sum"===t?l="sumValue":"prod"===t?l="prodValue":"all"===t?l="allValue":"any"===t&&(l="anyValue");let u=4*Math.floor(n/4),d=n%4,c=`\n      if (${"sum"===t}) {\n        sumValue += dot(values, ones);\n      } else if (${"prod"===t}) {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ${o}(values, minMaxValue);\n        if (${"min"===t} || ${"max"===t}) {\n          minMaxValue = ${o}(values, minMaxValue);\n          bvec4 isNaN = isnan(values);\n          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {\n            minMaxValue = vec4(NAN);\n          }\n        }\n      }\n    `,p="vec4";"all"===t?(s="1.0",c="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",p="bvec4"):"any"===t&&(s="0.0",c="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",p="bvec4");let h="";a%n>0&&(h=`\n        if (inIdx < 0 || inIdx >= ${a}) {\n          return initializationValue;\n        }\n      `),this.userCode=`\n      const float initializationValue = ${s};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ${h}\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${n};\n\n        vec4 minMaxValue = vec4(${s});\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ${u}; i += 4) {\n          int inIdx = inOffset + i;\n          ${p} values = ${p}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ${c}\n        }\n\n        int inIdx = inOffset + ${u};\n        if (${1===d}) {\n          ${p} values = ${p}(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ${c}\n        } else if (${2===d}) {\n          ${p} values = ${p}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ${c}\n        } else if (${3===d}) {\n          ${p} values = ${p}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ${c}\n        }\n        setOutput(${l});\n      }\n    `}};function O7(e,t,n,r){let a=function(e){let t=[];for(;0===t.length||1!==t[t.length-1].outSize;){let n=t.length?t[t.length-1].outSize:e[1],r=_P.computeOptimalWindowSize(n);t.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return t}(e.shape),i=e;for(let s=0;s<a.length;s++){let o,l,{inSize:u,windowSize:d,outSize:c}=a[s];o="mean"===n?0===s?new F7({windowSize:d,inSize:u,batchSize:e.shape[0],outSize:c},u):new F7({windowSize:d,inSize:u,batchSize:e.shape[0],outSize:c}):new M7({windowSize:d,inSize:u,batchSize:e.shape[0],outSize:c},n),l=i,i=r.runWebGLProgram(o,[i],t),l.dataId!==e.dataId&&r.disposeIntermediateTensorInfo(l)}return i}var P7=class{constructor(e,t){this.variableNames=["A"];let n=new Array(e.length);for(let i=0;i<n.length;i++)n[i]=e[t[i]];this.outputShape=n,this.rank=n.length;let r=s6(this.rank),a=function(e){let t=e.length;if(t>6)throw Error(`Transpose for rank ${t} is not yet supported`);let n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t);for(let a=0;a<e.length;a++)r[e[a]]=n[a];return r.join()}(t);this.userCode=`\n    void main() {\n      ${r} resRC = getOutputCoords();\n      setOutput(getA(${a}));\n    }\n    `}},L7=class{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;let n=new Array(e.length);for(let u=0;u<n.length;u++)n[u]=e[t[u]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);let r=s6(this.rank),a=F8("rc",this.rank),i=new Array(this.rank);for(let u=0;u<t.length;u++)i[t[u]]=a[u];let s=`vec2(${i.slice(-2).join()})`,o=`++${a[this.rank-1]} < ${n[this.rank-1]}`,l=`getChannel(getA(${i.join()}), ${s})`;this.userCode=`\n    void main() {\n      ${r} rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ${l};\n      if(${o}) {\n        result[1] = ${l};\n      }\n      --${a[this.rank-1]};\n      if(++${a[this.rank-2]} < ${n[this.rank-2]}) {\n        result[2] = ${l};\n        if(${o}) {\n          result[3] = ${l};\n        }\n      }\n      setOutput(result);\n    }\n    `}};function z7(e,t,n){let r=$S().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new L7(e.shape,t):new P7(e.shape,t);return n.runWebGLProgram(r,[e],e.dtype)}function B7(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:s}=r;return function(e,t,n,r){let a=t,i=e.shape.length,s=pT.parseAxisParam(a,e.shape),o=s,l=_P.getAxesPermutation(o,i),u=null!=l,d=e;u&&(d=z7(e,l,r),o=_P.getInnerMostAxes(o.length,i)),_P.assertAxesAreInnerMostDims("sum",o,i);let[c,p]=_P.computeOutAndReduceShapes(d.shape,o),h=c;n&&(h=_P.expandShapeToKeepDim(c,s));let f=pT.sizeFromShape(p),m=R7({inputs:{x:d},attrs:{shape:[pT.sizeFromShape(e.shape)/f,f]},backend:r}),g=O7(m,sE(e.dtype),"sum",r),b=R7({inputs:{x:g},attrs:{shape:h},backend:r});return r.disposeIntermediateTensorInfo(m),r.disposeIntermediateTensorInfo(g),u&&r.disposeIntermediateTensorInfo(d),b}(a,i,s,n)}var W7={kernelName:vC,backendName:"webgl",kernelFunc:B7};function V7(e){let t,{inputs:n,backend:r,attrs:a}=e,{x:i}=n,{perm:s}=a,o=r,l=i.shape.length,u=new Array(l);for(let d=0;d<u.length;d++)u[d]=i.shape[s[d]];if(o.shouldExecuteOnCPU([i])){let e=o.texData.get(i.dataId).values,n=R8(e,i.shape,i.dtype,s,u);t=o.makeTensorInfo(u,i.dtype),o.texData.get(t.dataId).values=n}else t=z7(i,s,o);return t}var U7={kernelName:WC,backendName:"webgl",kernelFunc:V7},j7=1e3;function H7({a:e,b:t,transposeA:n,transposeB:r,backend:a,bias:i=null,preluActivationWeights:s=null,leakyreluAlpha:o=0,activation:l=null}){let u=e.shape.length,d=t.shape.length,c=n?e.shape[u-2]:e.shape[u-1],p=r?t.shape[d-1]:t.shape[d-2],h=n?e.shape[u-1]:e.shape[u-2],f=r?t.shape[d-2]:t.shape[d-1],m=e.shape.slice(0,-2),g=t.shape.slice(0,-2),b=pT.sizeFromShape(m),y=pT.sizeFromShape(g),v=SA.assertAndGetBroadcastShape(e.shape.slice(0,-2),t.shape.slice(0,-2)).concat([h,f]);pT.assert(c===p,(()=>`Error in matMul: inner shapes (${c}) and (${p}) of Tensors with shapes ${e.shape} and ${t.shape} and transposeA=${n} and transposeB=${r} must match.`));let x,w=n?[b,c,h]:[b,h,c],k=r?[y,f,p]:[y,p,f],S=R7({inputs:{x:e},backend:a,attrs:{shape:w}}),I=R7({inputs:{x:t},backend:a,attrs:{shape:k}}),N=[S,I],C=Math.max(b,y),T=n?S.shape[1]:S.shape[2],E=null!=i,_=null!=s,$="leakyrelu"===l,A=null!=l?N7(l,!0):null;if((1===h||1===f)&&T>j7&&!1===(E||_||$||null!=A)){let e=S,t=I;n&&(e=V7({inputs:{x:S},backend:a,attrs:{perm:[0,2,1]}}),N.push(e)),r&&(t=V7({inputs:{x:I},backend:a,attrs:{perm:[0,2,1]}}),N.push(t));let i=1===f,s=e;1!==f&&(s=R7({inputs:{x:e},backend:a,attrs:{shape:[C,T,1]}}),N.push(s));let o=1===f?2:1,l=t;i&&(l=R7({inputs:{x:t},backend:a,attrs:{shape:[C,1,T]}}),N.push(l));let u=$7({inputs:{a:s,b:l},backend:a});x=B7({inputs:{x:u},backend:a,attrs:{axis:o,keepDims:!0}}),N.push(u)}else{let l=iE(e.dtype,t.dtype),u=new C7(w,k,[C,h,f],n,r,E,A,_,$),d=[S,I];if(null!=i&&d.push(i),_&&d.push(s),$){let e=a.makeTensorInfo([],"float32",pT.createScalarValue(o,"float32"));d.push(e),N.push(e)}x=a.runWebGLProgram(u,d,l)}let R=R7({inputs:{x:x},backend:a,attrs:{shape:v}});N.push(x);for(let D of N)a.disposeIntermediateTensorInfo(D);return R}var G7={kernelName:YC,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{a:a,b:i,bias:s,preluActivationWeights:o}=t,{transposeA:l,transposeB:u,activation:d,leakyreluAlpha:c}=r;return H7({a:a,b:i,transposeA:l,transposeB:u,backend:n,bias:s,preluActivationWeights:o,leakyreluAlpha:c,activation:d})}},q7="return abs(x);",K7={kernelName:MS,backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:r}=e,{x:a}=n;if(r.shouldExecuteOnCPU([a])&&"complex64"!==a.dtype){let e=r.texData.get(a.dataId),t=y8(e.values);return r.makeTensorInfo(a.shape,a.dtype,t)}return t=$S().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new e7(a.shape,q7):new B8(a.shape,q7),r.runWebGLProgram(t,[a],a.dtype)}},X7=S7({opSnippet:W8+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n"}),Y7={kernelName:OS,backendName:"webgl",kernelFunc:X7},J7=S7({opSnippet:W8+"\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));"}),Z7={kernelName:PS,backendName:"webgl",kernelFunc:J7},Q7="return a + b;",e9=I7({opSnippet:Q7,packedOpSnippet:Q7,supportsComplex:!0,cpuKernelImpl:z6}),t9={kernelName:LS,backendName:"webgl",kernelFunc:e9},n9={kernelName:zS,backendName:"webgl",kernelFunc:function e(t){let{inputs:n,backend:r}=t,a=n;if(1===a.length)return p7({inputs:{x:a[0]},backend:r});if(a.length>$S().get("WEBGL_MAX_TEXTURES_IN_SHADER")){let t=Math.floor(a.length/2),n=e({inputs:a.slice(0,t),backend:r}),i=e({inputs:a.slice(t),backend:r});return e({inputs:[n,i],backend:r})}let i=a.map((e=>e.dtype)).reduce(((e,t)=>iE(e,t))),s=a.map((e=>e.shape)),o=$S().getBool("WEBGL_PACK")?new class{constructor(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map(((e,t)=>`T${t}`));let n=[];this.variableNames.forEach((e=>{n.push(`vec4 v${e} = get${e}AtOutCoords();`)}));let r=this.variableNames.map((e=>`v${e}`)).join(" + ");this.userCode=`\n      void main() {\n        ${n.join("\n        ")}\n\n        vec4 result = ${r};\n        setOutput(result);\n      }\n    `}}(a[0].shape,s):new class{constructor(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map(((e,t)=>`T${t}`));let n=[];this.variableNames.forEach((e=>{n.push(`float v${e} = get${e}AtOutCoords();`)}));let r=this.variableNames.map((e=>`v${e}`)).join(" + ");this.userCode=`\n      void main() {\n        ${n.join("\n        ")}\n\n        float result = ${r};\n        setOutput(result);\n      }\n    `}}(a[0].shape,s);return r.runWebGLProgram(o,a,i)}},r9={kernelName:BS,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:s}=r,o=a.shape.length,l=pT.parseAxisParam(i,a.shape),u=l,d=_P.getAxesPermutation(u,o),c=a;null!=d&&(c=V7({inputs:{x:a},backend:n,attrs:{perm:d}}),u=_P.getInnerMostAxes(u.length,o)),_P.assertAxesAreInnerMostDims("all",u,o);let p,[h,f]=_P.computeOutAndReduceShapes(c.shape,u),m=R7({inputs:{x:c},backend:n,attrs:{shape:[-1,pT.sizeFromShape(f)]}}),g=O7(m,m.dtype,"all",n);return p=R7(s?{inputs:{x:g},backend:n,attrs:{shape:_P.expandShapeToKeepDim(h,l)}}:{inputs:{x:g},backend:n,attrs:{shape:h}}),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),null!=d&&n.disposeIntermediateTensorInfo(c),p}},a9={kernelName:WS,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:s}=r,o=a.shape.length,l=pT.parseAxisParam(i,a.shape),u=l,d=_P.getAxesPermutation(u,o),c=a;null!=d&&(c=V7({inputs:{x:a},backend:n,attrs:{perm:d}}),u=_P.getInnerMostAxes(u.length,o)),_P.assertAxesAreInnerMostDims("any",u,o);let p,[h,f]=_P.computeOutAndReduceShapes(c.shape,u),m=R7({inputs:{x:c},backend:n,attrs:{shape:[-1,pT.sizeFromShape(f)]}}),g=O7(m,m.dtype,"any",n);return p=R7(s?{inputs:{x:g},backend:n,attrs:{shape:_P.expandShapeToKeepDim(h,l)}}:{inputs:{x:g},backend:n,attrs:{shape:h}}),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),null!=d&&n.disposeIntermediateTensorInfo(c),p}},i9=class{constructor(e,t,n){this.variableNames=["A"];let{windowSize:r,batchSize:a,outSize:i}=e;n||this.variableNames.push("bestIndicesA"),this.outputShape=[a,i];let s="max"===t?">":"<",o=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${r};\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ${r}; i++) {\n          int inIdx = ${o};\n          float candidate = getA(batch, inIdx);\n          if (candidate ${s} bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    `}},s9=class{constructor(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,pT.assert(e.length>2,(()=>`Packed arg${n.charAt(0).toUpperCase()+n.slice(1)} supports only inputs with rank above 2.`));let a=e[e.length-1],i=Math.ceil(a/t);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");let s,o,l=this.outputShape,u=l.length,d=s6(u),c=M8("coords",u);if(1===i){o=u+1;let e=s6(o);s=`\n        ${e} sourceLocR = ${e}(${c.join()}, 0);\n        ++${c[u-1]};\n        ${e} sourceLocG = ${e}(${c.join()}, 0);\n        ++${c[u-2]};\n        ${e} sourceLocA = ${e}(${c.join()}, 0);\n        --${c[u-1]};\n        ${e} sourceLocB = ${e}(${c.join()}, 0);\n        --${c[u-2]};`}else o=u,s=`\n        ${d} sourceLocR = coords;\n        ++${c[u-1]};\n        ${d} sourceLocG = coords;\n        ++${c[u-2]};\n        ${d} sourceLocA = coords;\n        --${c[u-1]};\n        ${d} sourceLocB = coords;\n        --${c[u-2]};`;let p=["x","y","z","w","u","v"].slice(0,o),h="."+p[o-1],f=p.map((e=>"int "+e)),m=M8("sourceLocR",o-1).concat("inIdx.r"),g=M8("sourceLocG",o-1).concat("inIdx.g"),b=M8("sourceLocB",o-1).concat("inIdx.b"),y=M8("sourceLocA",o-1).concat("inIdx.a"),v="max"===n?"greaterThan":"lessThan",x=r?"":`\n          inIdx = round(vec4(getBestIndicesAChannel(${m.join()}),\n                             getBestIndicesAChannel(${g.join()}),\n                             getBestIndicesAChannel(${b.join()}),\n                             getBestIndicesAChannel(${y.join()})));`,w=`vec4(\n            getAChannel(${m.join()}),\n            hasNextCol ? getAChannel(${g.join()}) : 0.,\n            hasNextRow ? getAChannel(${b.join()}) : 0.,\n            hasNextRow && hasNextCol ? getAChannel(${y.join()}) : 0.)`,k=r?"":`\n      float getBestIndicesAChannel(${f.join()}) {\n        return getChannel(getBestIndicesA(${p.join()}),\n                                          vec2(${p.slice(-2).join()}));\n      }`;this.userCode=`\n      float getAChannel(${f.join()}) {\n        return getChannel(getA(${p.join()}),\n                               vec2(${p.slice(-2).join()}));\n      }\n      ${k}\n      void main() {\n        ${d} coords = getOutputCoords();\n        bool hasNextCol = ${c[u-1]} < ${l[u-1]-1};\n        bool hasNextRow = ${c[u-2]} < ${l[u-2]-1};\n        ${s}\n        ivec4 srcIdx = ivec4(sourceLocR${h}, sourceLocG${h},\n          sourceLocB${h}, sourceLocA${h}) * ${t};\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ${w};\n\n        for (int i = 0; i < ${t}; i++) {\n          inIdx = srcIdx;\n          ${x}\n          vec4 candidate = ${w};\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(${v}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    `}};function o9(e,t,n,r=null){let a=t.shape[0],i=t.shape[1];null!=r&&(a=r.shape[0],i=r.shape[1]);let s=_P.computeOptimalWindowSize(i),o={windowSize:s,inSize:i,batchSize:a,outSize:Math.ceil(i/s)},l=new i9(o,n,null==r),u=[t];null!=r&&u.push(r);let d=e.runWebGLProgram(l,u,"int32");if(1===d.shape[1])return d;let c=o9(e,t,n,d);return e.disposeIntermediateTensorInfo(d),c}function l9(e,t,n,r=null){let a=null!=r?r.shape:t.shape,i=a[a.length-1],s=_P.computeOptimalWindowSize(i),o=new s9(a,s,n,null==r),l=null==r?[t]:[t,r],u=e.runWebGLProgram(o,l,"int32");if(u.shape.length===t.shape.length){let r=l9(e,t,n,u);return e.disposeIntermediateTensorInfo(u),r}return u}function u9(e,t,n,r){let a=[n];if(_P.assertAxesAreInnerMostDims("arg"+r.charAt(0).toUpperCase()+r.slice(1),a,t.shape.length),!$S().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){let n=[],i=e.texData.get(t.dataId),s=t;null!==i&&i.isPacked&&(s=e.unpackTensor(t),n.push(s));let[o,l]=_P.computeOutAndReduceShapes(s.shape,a),u=pT.sizeFromShape(l),d=R7({inputs:{x:s},backend:e,attrs:{shape:[-1,u]}});n.push(d);let c=o9(e,d,r);n.push(c);let p=R7({inputs:{x:c},backend:e,attrs:{shape:o}});return n.forEach((t=>e.disposeIntermediateTensorInfo(t))),p}return l9(e,t,r)}var d9={kernelName:VS,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i}=r,s=pT.parseAxisParam(i,a.shape),o=_P.getAxesPermutation(s,a.shape.length),l=a,u=[];null!=o&&(l=V7({inputs:{x:a},backend:n,attrs:{perm:o}}),u.push(l),s=_P.getInnerMostAxes(s.length,l.shape.length)),_P.assertAxesAreInnerMostDims("argMax",[s[0]],l.shape.length);let d=u9(n,l,s[0],"max");return u.forEach((e=>n.disposeIntermediateTensorInfo(e))),d}},c9={kernelName:US,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i}=r,s=pT.parseAxisParam(i,a.shape),o=_P.getAxesPermutation(s,a.shape.length),l=a,u=[];null!=o&&(l=V7({inputs:{x:a},backend:n,attrs:{perm:o}}),u.push(l),s=_P.getInnerMostAxes(s.length,l.shape.length)),_P.assertAxesAreInnerMostDims("argMin",[s[0]],l.shape.length);let d=u9(n,l,s[0],"min");return u.forEach((e=>n.disposeIntermediateTensorInfo(e))),d}},p9=S7({opSnippet:W8+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n"}),h9={kernelName:jS,backendName:"webgl",kernelFunc:p9},f9=S7({opSnippet:W8+"return log(x + sqrt(x * x + 1.0));"}),m9={kernelName:HS,backendName:"webgl",kernelFunc:f9},g9=S7({opSnippet:W8+"\n  return atan(x);\n"}),b9={kernelName:GS,backendName:"webgl",kernelFunc:g9},y9=I7({opSnippet:l7+"\n  return atan(a, b);\n",packedOpSnippet:"\n  vec4 result = atan(a, b);\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+d7+"\n  return result;\n"}),v9={kernelName:KS,backendName:"webgl",kernelFunc:y9},x9=S7({opSnippet:W8+"\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;"}),w9={kernelName:qS,backendName:"webgl",kernelFunc:x9},k9=class{constructor(e,t,n,r=!1,a=!1){if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");let i=e.filterWidth,s=e.strideHeight,o=e.strideWidth,l=e.dilationHeight,u=e.dilationWidth,d=e.effectiveFilterHeight,c=e.effectiveFilterWidth,p=e.padInfo.top,h=e.padInfo.left;this.outputShape=e.outShape;let f="avg"===t,m=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,g=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`,b="0.0";if(f||(b="-1.0 / 1e-20"),n){let t=">=";return void(this.userCode=`\n        const ivec2 strides = ivec2(${s}, ${o});\n        const ivec2 pads = ivec2(${p}, ${h});\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ${d};\n              wR += ${l}) {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ${e.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${c};\n                wC += ${u}) {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ${e.inWidth}) {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ${t} currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ${r?a?m:g:`wR * ${c} + wC`};\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      `)}let y=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"avg"===t&&(y="avgValue / max(count, 1.0)");let v=4*Math.floor(i/4),x=i%4,w=`\n      if (${f}) {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    `;this.userCode=`\n      const ivec2 strides = ivec2(${s}, ${o});\n      const ivec2 pads = ivec2(${p}, ${h});\n      const float initializationValue = ${b};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ${e.inWidth}) {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(${b});\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ${d};\n            wR += ${l}) {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ${e.inHeight}) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${v}; wC += 4) {\n            int xC = xCCorner + wC * ${u};\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${u}, d),\n              getValue(batch, xR, xC + 2 * ${u}, d),\n              getValue(batch, xR, xC + 3 * ${u}, d)\n            );\n\n            ${w}\n          }\n\n          int xC = xCCorner + ${v};\n          if (${1===x}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ${w}\n          } else if (${2===x}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${u}, d),\n              initializationValue,\n              initializationValue\n            );\n\n            ${w}\n          } else if (${3===x}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${u}, d),\n              getValue(batch, xR, xC + 2 * ${u}, d),\n              initializationValue\n            );\n\n            ${w}\n          }\n        }\n        setOutput(${y});\n      }\n    `}},S9=class{constructor(e,t,n,r=!1,a=!1){if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");let i=e.filterWidth,s=e.strideDepth,o=e.strideHeight,l=e.strideWidth,u=e.dilationDepth,d=e.dilationHeight,c=e.dilationWidth,p=e.effectiveFilterDepth,h=e.effectiveFilterHeight,f=e.effectiveFilterWidth,m=e.padInfo.front,g=e.padInfo.top,b=e.padInfo.left;this.outputShape=e.outShape;let y="avg"===t,v="0.0";if(y||(v="-1.0 / 1e-20"),n){let t=">=";return void(this.userCode=`\n        const ivec3 strides =\n            ivec3(${s}, ${o}, ${l});\n        const ivec3 pads = ivec3(${m}, ${g}, ${b});\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ${p};\n              wD += ${u}) {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ${e.inDepth}) {\n              continue;\n            }\n\n            for (int wR = 0; wR < ${h};\n                wR += ${d}) {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ${e.inHeight}) {\n                continue;\n              }\n\n              for (int wC = 0; wC < ${f};\n                  wC += ${c}) {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ${e.inWidth}) {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value ${t} currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ${r?a?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${h} * ${f} +\n                      wR * ${f} + wC`};\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      `)}let x=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"avg"===t&&(x="avgValue / max(count, 1.0)");let w=4*Math.floor(i/4),k=i%4,S=`\n      if (${y}) {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    `;this.userCode=`\n      const ivec3 strides =\n        ivec3(${s}, ${o}, ${l});\n      const ivec3 pads = ivec3(${m}, ${g}, ${b});\n      const float initializationValue = ${v};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ${e.inWidth}) {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(${v});\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ${p};\n            wD += ${u}) {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ${e.inDepth}) {\n            continue;\n          }\n\n          for (int wR = 0; wR < ${h};\n            wR += ${d}) {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ${e.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${w}; wC += 4) {\n              int xC = xCCorner + wC * ${c};\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${c}, ch),\n                getValue(batch, xD, xR, xC + 2 * ${c}, ch),\n                getValue(batch, xD, xR, xC + 3 * ${c}, ch)\n              );\n\n              ${S}\n            }\n\n            int xC = xCCorner + ${w};\n            if (${1===k}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ${S}\n            } else if (${2===k}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${c}, ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ${S}\n            } else if (${3===k}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${c}, ch),\n                getValue(batch, xD, xR, xC + 2 * ${c}, ch),\n                initializationValue\n              );\n\n              ${S}\n            }\n          }\n        }\n        setOutput(${x});\n      }\n    `}},I9={kernelName:XS,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t;V5(a,"avgPool");let{filterSize:i,strides:s,pad:o,dimRoundingMode:l}=r;pT.assert(_P.eitherStridesOrDilationsAreOne(s,1),(()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${s} and dilations '1'`));let u=_P.computePool2DInfo(a.shape,i,s,1,o,l);if(1===u.filterWidth&&1===u.filterHeight&&pT.arraysEqual(u.inShape,u.outShape))return p7({inputs:{x:a},backend:n});let d=new k9(u,"avg",!1);return n.runWebGLProgram(d,[a],"float32")}},N9={kernelName:JS,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:i,strides:s,pad:o,dimRoundingMode:l,dataFormat:u}=r,d=_P.computePool3DInfo(a.shape,i,s,[1,1,1],o,l,u),c=new S9(d,"avg",!1);return n.runWebGLProgram(c,[a],"float32")}},C9={kernelName:ZS,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,s=i,{filterSize:o,strides:l,pad:u,dimRoundingMode:d}=r,c=_P.computePool3DInfo(s.shape,o,l,[1,1,1],u,d),p=new class{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;let t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,a=e.strideDepth,i=e.strideHeight,s=e.strideWidth,o=e.dilationDepth,l=e.dilationHeight,u=e.dilationWidth,d=e.effectiveFilterDepth,c=e.effectiveFilterHeight,p=e.effectiveFilterWidth,h=d-1-e.padInfo.front,f=c-1-e.padInfo.top,m=p-1-e.padInfo.left,g=1/(t*n*r);this.userCode=`\n      const ivec3 pads = ivec3(${h}, ${f}, ${m});\n      const float avgMultiplier = float(${g});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ${d};\n            wD += ${o}) {\n          float dyD = float(dyDCorner + wD) / ${a}.0;\n\n          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ${c};\n              wR += ${l}) {\n            float dyR = float(dyRCorner + wR) / ${i}.0;\n\n            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ${p};\n                wC += ${u}) {\n              float dyC = float(dyCCorner + wC) / ${s}.0;\n\n              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}(c);return n.runWebGLProgram(p,[a],s.dtype)}},T9={kernelName:YS,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,s=i;V5([a,i],"avgPoolGrad");let{filterSize:o,strides:l,pad:u}=r,d=_P.computePool2DInfo(s.shape,o,l,1,u),c=new class{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;let t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,a=e.strideWidth,i=e.dilationHeight,s=e.dilationWidth,o=e.effectiveFilterHeight,l=e.effectiveFilterWidth,u=o-1-e.padInfo.top,d=l-1-e.padInfo.left,c=1/(t*n);this.userCode=`\n      const ivec2 pads = ivec2(${u}, ${d});\n      const float avgMultiplier = float(${c});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${o};\n            wR += ${i}) {\n          float dyR = float(dyRCorner + wR) / ${r}.0;\n\n          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ${l};\n            wC+= ${s}) {\n            float dyC = float(dyCCorner + wC) / ${a}.0;\n\n            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}(d);return n.runWebGLProgram(c,[a],s.dtype)}},E9={kernelName:QS,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{a:a,b:i}=t,{transposeA:s,transposeB:o}=r;return H7({a:a,b:i,transposeA:s,transposeB:o,backend:n})}},_9={kernelName:GI,backendName:"webgl",kernelFunc:({inputs:e,backend:t,attrs:n})=>{let{x:r,mean:a,variance:i,offset:s,scale:o}=e;pT.assert(a.shape.length===i.shape.length,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),pT.assert(null==s||a.shape.length===s.shape.length,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),pT.assert(null==o||a.shape.length===o.shape.length,(()=>"Batch normalization gradient requires mean and scale to have equal ranks."));let{varianceEpsilon:l}=n;null==l&&(l=.001);let u=[r,a,i],d=null;null!=s&&(d=s.shape,u.push(s));let c=null;null!=o&&(c=o.shape,u.push(o));let p=$S().getBool("WEBGL_PACK_NORMALIZATION")?new class{constructor(e,t,n,r,a,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],_P.assertAndGetBroadcastShape(e,t),_P.assertAndGetBroadcastShape(e,n);let s="vec4(0.0)";null!=r&&(_P.assertAndGetBroadcastShape(e,r),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");let o="vec4(1.0)";null!=a&&(_P.assertAndGetBroadcastShape(e,a),this.variableNames.push("scale"),o="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`\n      void main() {\n        vec4 offset = ${s};\n        vec4 scale = ${o};\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(${i}));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    `}}(r.shape,a.shape,i.shape,d,c,l):new class{constructor(e,t,n,r,a,i){this.outputShape=[],this.variableNames=["x","mean","variance"],_P.assertAndGetBroadcastShape(e,t),_P.assertAndGetBroadcastShape(e,n);let s="0.0";null!=r&&(_P.assertAndGetBroadcastShape(e,r),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");let o="1.0";null!=a&&(_P.assertAndGetBroadcastShape(e,a),this.variableNames.push("scale"),o="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ${s};\n        float scale = ${o};\n        float inv = scale * inversesqrt(variance + float(${i}));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    `}}(r.shape,a.shape,i.shape,d,c,l);return t.runWebGLProgram(p,u,u[0].dtype)}},$9=class{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;let t=s6(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];let n,r=function(e){if(1===e)return"sourceLoc";if(e<=6)return A9.slice(0,e).map((e=>"sourceLoc."+e)).join(",");throw Error(`Slicing for rank ${e} is not yet supported`)}(this.rank);n=`\n        ${t} sourceLoc;\n        ${t} coords = getOutputCoords();\n        ${e.map(((e,t)=>`sourceLoc.${A9[t]} = start[${t}] + coords.${A9[t]};`)).join("\n")}\n      `,this.userCode=`\n      void main() {\n        ${n}\n        setOutput(getSource(${r}));\n      }\n    `}},A9=["x","y","z","w","u","v"],R9=class{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];let t=s6(this.rank),n=M8("coords",this.rank),r=M8("sourceLoc",this.rank),a=1===this.rank?"sourceLoc":`vec2(${r.slice(-2).join()})`,i=`getChannel(getSource(${r.join()}), ${a})`,s=`\n      result.x = ${i};\n      if (++${n[this.rank-1]} < ${e[this.rank-1]}) {\n        ++${r[this.rank-1]};\n        result.y = ${i};\n        --${r[this.rank-1]};\n      }\n    `,o=1===this.rank?"":`\n      --${n[this.rank-1]};\n      if (++${n[this.rank-2]} < ${e[this.rank-2]}) {\n        ++${r[this.rank-2]};\n        result.z = ${i};\n        if (++${n[this.rank-1]} < ${e[this.rank-1]}) {\n          ++${r[this.rank-1]};\n          result.w = ${i};\n        }\n      }\n    `,l=this.rank<=4?`sourceLoc = coords +\n            ${t}(${e.map(((e,t)=>`start[${t}]`)).join()});`:e.map(((e,t)=>`${r[t]} = ${n[t]} + start[${t}];`)).join("\n");this.userCode=`\n      void main() {\n        ${t} coords = getOutputCoords();\n        ${t} sourceLoc;\n        ${l}\n        vec4 result = vec4(0.);\n        ${s}\n        ${o}\n        setOutput(result);\n      }\n    `}};function D9(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{begin:i,size:s}=r,[o,l]=rP.parseSliceParams(a,i,s);if(rP.assertParamsValid(a,o,l),0===pT.sizeFromShape(l))return n.makeTensorInfo(l,a.dtype,[]);if(n.shouldExecuteOnCPU([a])||"string"===a.dtype){let e=n.texData.get(a.dataId),t=v8(e.values,o,l,a.shape,a.dtype);return n.makeTensorInfo(l,a.dtype,t)}let{isPacked:u}=n.texData.get(a.dataId),d=rP.isSliceContinous(a.shape,o,l);if(u||!d){let e=$S().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new R9(l):new $9(l),t=[o];return n.runWebGLProgram(e,[a],a.dtype,t)}return n.uploadToGPU(a.dataId),function(e,t,n,r){let a=r.texData.get(e.dataId),i=r.makeTensorInfo(n,e.dtype),s=r.texData.get(i.dataId);Object.assign(s,a),s.refCount=1,s.shape=n,s.dtype=e.dtype;let o=rP.computeFlatOffset(t,pT.computeStrides(e.shape));a.slice&&(o+=a.slice.flatOffset),s.slice={flatOffset:o,origDataId:a.slice&&a.slice.origDataId||e.dataId};let l=r.dataRefCount.get(s.slice.origDataId)||1;return r.dataRefCount.set(s.slice.origDataId,l+1),i}(a,o,l,n)}var F9={kernelName:pC,backendName:"webgl",kernelFunc:D9},M9={kernelName:eI,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:i,crops:s}=r;pT.assert(a.shape.length<=4,(()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"));let o=i.reduce(((e,t)=>e*t)),l=_P.getReshaped(a.shape,i,o),u=_P.getPermuted(l.length,i.length),d=_P.getReshapedPermuted(a.shape,i,o),c=_P.getSliceBeginCoords(s,i.length),p=_P.getSliceSize(d,s,i.length),h=[],f=R7({inputs:{x:a},backend:n,attrs:{shape:l}}),m=V7({inputs:{x:f},backend:n,attrs:{perm:u}}),g=R7({inputs:{x:m},backend:n,attrs:{shape:d}}),b=D9({inputs:{x:g},backend:n,attrs:{begin:c,size:p}});return h.push(f),h.push(m),h.push(g),h.forEach((e=>n.disposeIntermediateTensorInfo(e))),b}},O9={kernelName:tI,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,weights:i}=t,{size:s}=r,o=n.readSync(a.dataId),l=n.readSync(i.dataId),u=B6(o,l,i.dtype,i.shape,s);return n.makeTensorInfo([s],i.dtype,u)}},P9={kernelName:nI,backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:r}=e,{a:a,b:i}=n,s=$S().getBool("WEBGL_PACK_BINARY_OPERATIONS"),o=$S().getNumber("WEBGL_VERSION");if(r.shouldExecuteOnCPU([a,i])||1===o){let e=r.texData.get(a.dataId).values,t=r.texData.get(i.dataId).values,[n,s]=V6(a.shape,i.shape,e,t,a.dtype),o=r.makeTensorInfo(s,a.dtype);return r.texData.get(o.dataId).values=n,o}return t=s?new c7("\n  int r = int(a.r) & int(b.r);\n  int g = int(a.g) & int(b.g);\n  int rb = int(a.b) & int(b.b);\n  int ra = int(a.a) & int(b.a);\n  return vec4(r, g, rb, ra);\n",a.shape,i.shape,!1):new u7("\n  return float(int(a.r) & int(b.r));\n",a.shape,i.shape),r.runWebGLProgram(t,[a,i],a.dtype)}},L9={kernelName:aI,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{s0:r,s1:a}=t,i=n.readSync(r.dataId),s=n.readSync(a.dataId),o=_P.assertAndGetBroadcastShape(Array.from(i),Array.from(s));return n.makeTensorInfo([o.length],"int32",Int32Array.from(o))}},z9=I7({opSnippet:"return float(a != b);",cpuKernelImpl:u8,dtype:"bool"}),B9={kernelName:DN,backendName:"webgl",kernelFunc:z9};function W9(e){let{inputs:t,backend:n}=e,{input:r}=t;return p7({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.real},backend:n})}var V9={kernelName:XN,backendName:"webgl",kernelFunc:W9},U9="return float(int(x));",j9={kernelName:iI,backendName:"webgl",kernelFunc:function e(t){let{inputs:n,backend:r,attrs:a}=t,{x:i}=n,{dtype:s}=a;if("complex64"===s){if("complex64"===i.dtype)return p7({inputs:{x:i},backend:r});let t=HR(i.shape),n=e({inputs:{x:i},backend:r,attrs:{dtype:"float32"}}),a=f7({inputs:{real:n,imag:t},backend:r});return t.dispose(),r.disposeIntermediateTensorInfo(n),a}if("complex64"===i.dtype){let t=W9({inputs:{input:i},backend:r}),n=e({inputs:{x:t},backend:r,attrs:{dtype:s}});return r.disposeIntermediateTensorInfo(t),n}if(!pT.hasEncodingLoss(i.dtype,s)){let e=p7({inputs:{x:i},backend:r});return{dataId:e.dataId,shape:e.shape,dtype:s}}if(r.shouldExecuteOnCPU([i])){let e=r.texData.get(i.dataId).values,[t,n,a]=U6(e,i.shape,i.dtype,s);return r.makeTensorInfo(t,n,a)}if("int32"===s)return function(e,t){let n=new B8(e.shape,U9),r=t.runWebGLProgram(n,[e],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}(i,r);if("bool"===s){let e=r.makeTensorInfo([],"bool",pT.getTypedArrayFromDType("bool",1)),t=z9({inputs:{a:i,b:e},backend:r});return r.disposeIntermediateTensorInfo(e),t}throw new Error(`Error in Cast: failed to cast ${i.dtype} to ${s}`)}},H9="return ceil(x);",G9=S7({opSnippet:H9,packedOpSnippet:H9,cpuKernelImpl:j6}),q9={kernelName:sI,backendName:"webgl",kernelFunc:G9},K9={kernelName:oI,backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:r,attrs:a}=e,{x:i}=n,{clipValueMin:s,clipValueMax:o}=a;t=$S().getBool("WEBGL_PACK_CLIP")?new class{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode="\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}}(i.shape):new class{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode="\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}}(i.shape);let l=[[s],[o]];return r.runWebGLProgram(t,[i],i.dtype,l)}};function X9(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}var Y9={kernelName:uI,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{x:r}=t,a=n.texData.get(r.dataId),i=new class{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}}(r.shape),s=[X9(r,a.complexTensorInfos.real),X9(r,a.complexTensorInfos.imag)];return n.runWebGLProgram(i,s,s[0].dtype)}},J9=class{constructor(e){this.outputShape=[],this.outputShape=_P.computeOutShape(e,1),this.variableNames=e.map(((e,t)=>`T${t}`));let t=new Array(e.length-1);t[0]=e[0][1];for(let i=1;i<t.length;i++)t[i]=t[i-1]+e[i][1];let n=[`if (yC < ${t[0]}) setOutput(getT0(yR, yC));`];for(let i=1;i<t.length;i++){let e=t[i-1];n.push(`else if (yC < ${t[i]}) setOutput(getT${i}(yR, yC-${e}));`)}let r=t.length,a=t[t.length-1];n.push(`else setOutput(getT${r}(yR, yC-${a}));`),this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ${n.join("\n        ")}\n      }\n    `}},Z9=class{constructor(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=_P.computeOutShape(e,t);let n=this.outputShape,r=n.length,a=s6(r),i=M8("coords",r),s=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map(((e,t)=>`T${t}`));let o=new Array(e.length-1);o[0]=e[0][t];for(let f=1;f<o.length;f++)o[f]=o[f-1]+e[f][t];let l=s[t],u=s.slice(-2),d=s.join(),c=`if (${l} < ${o[0]}) {\n        return getChannel(\n            getT0(${d}), vec2(${u.join()}));\n        }`;for(let f=1;f<o.length;f++){let e=o[f-1];c+=`\n        if (${l} < ${o[f]}  && ${l} >= ${o[f-1]}) {\n          return getChannel(\n            getT${f}(${Q9(s,l,e)}),\n            vec2(${Q9(u,l,e)}));\n        }`}let p=o.length,h=o[o.length-1];c+=`\n        return getChannel(\n          getT${p}(${Q9(s,l,h)}),\n          vec2(${Q9(u,l,h)}));`,this.userCode=`\n      float getValue(${s.map((e=>"int "+e))}) {\n        ${c}\n      }\n\n      void main() {\n        ${a} coords = getOutputCoords();\n        vec4 result = vec4(getValue(${i}), 0., 0., 0.);\n\n        ${i[r-1]} = ${i[r-1]} + 1;\n        if (${i[r-1]} < ${n[r-1]}) {\n          result.g = getValue(${i});\n        }\n\n        ${i[r-2]} = ${i[r-2]} + 1;\n        if (${i[r-2]} < ${n[r-2]}) {\n          result.a = getValue(${i});\n        }\n\n        ${i[r-1]} = ${i[r-1]} - 1;\n        if (${i[r-2]} < ${n[r-2]} &&\n            ${i[r-1]} < ${n[r-1]}) {\n          result.b = getValue(${i});\n        }\n        setOutput(result);\n      }\n    `}};function Q9(e,t,n){let r=e.indexOf(t);return e.map(((e,t)=>t===r?`${e} - ${n}`:e)).join()}function eee(e){let{inputs:t,backend:n}=e,{input:r}=t;return p7({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.imag},backend:n})}var tee={kernelName:QI,backendName:"webgl",kernelFunc:eee};function nee(e,t,n){let r=e[0].dtype;if("complex64"===r){let r=e.map((e=>W9({inputs:{input:e},backend:n}))),a=e.map((e=>eee({inputs:{input:e},backend:n}))),i=nee(r,t,n),s=nee(a,t,n),o=f7({inputs:{real:i,imag:s},backend:n});return r.forEach((e=>n.disposeIntermediateTensorInfo(e))),a.forEach((e=>n.disposeIntermediateTensorInfo(e))),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),o}let a=n.shouldExecuteOnCPU(e);if("string"===r&&(a=!0),a){let a=e.map((e=>{let r=[-1,pT.sizeFromShape(e.shape.slice(t))];return R7({inputs:{x:e},backend:n,attrs:{shape:r}})})),i=a.map((e=>({vals:n.readSync(e.dataId),shape:e.shape}))),s=_P.computeOutShape(a.map((e=>e.shape)),1),o=1===a[0].shape[0],l=H6(i,s,r,o),u=_P.computeOutShape(e.map((e=>e.shape)),t),d=n.makeTensorInfo(u,r,l);return a.forEach((e=>n.disposeIntermediateTensorInfo(e))),d}let i=e.filter((e=>pT.sizeFromShape(e.shape)>0)),s=$S().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&i[0].shape.length>1;if(1===i.length){let t=s?new B8(e[0].shape,q8):new e7(e[0].shape,q8);return n.runWebGLProgram(t,e,r)}let o=$S().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(i.length>o){let e=[];for(let a=0;a<i.length;a+=o){let r=i.slice(a,a+o);e.push(nee(r,t,n))}let r=nee(e,t,n);for(let t of e)n.disposeIntermediateTensorInfo(t);return r}if(s){let e=new Z9(i.map((e=>e.shape)),t);return n.runWebGLProgram(e,i,r)}let{tensors2D:l,outShape:u}=function(e,t,n){let r=_P.computeOutShape(e.map((e=>e.shape)),t);return{tensors2D:e.map((e=>R7({inputs:{x:e},attrs:{shape:[-1,pT.sizeFromShape(e.shape.slice(t))]},backend:n}))),outShape:r}}(i,t,n),d=new J9(l.map((e=>e.shape))),c=n.runWebGLProgram(d,l,r);l.forEach((e=>n.disposeIntermediateTensorInfo(e)));let p=R7({inputs:{x:c},attrs:{shape:u},backend:n});return n.disposeIntermediateTensorInfo(c),p}function ree(e){let{inputs:t,backend:n,attrs:r}=e,{axis:a}=r,i=pT.parseAxisParam(a,t[0].shape)[0],s=t.map((e=>e.shape));_P.assertParamsConsistent(s,i);let o=_P.computeOutShape(t.map((e=>e.shape)),i);if(0===pT.sizeFromShape(o))return n.makeTensorInfo(o,t[0].dtype,[]);let l=t.filter((e=>pT.sizeFromShape(e.shape)>0));return 1===l.length?p7({inputs:{x:l[0]},backend:n}):nee(l,i,n)}var aee={kernelName:dI,backendName:"webgl",kernelFunc:ree},iee=class{constructor(e,t=!1,n=null,r=!1,a=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;let i=e.padInfo.top,s=e.padInfo.left,o=e.strideHeight,l=e.strideWidth,u=e.dilationHeight,d=e.dilationWidth,c=e.filterHeight,p=e.filterWidth,h=4*Math.floor(e.inChannels/4),f=e.inChannels%4,m="channelsLast"===e.dataFormat,g=m?1:2,b=m?2:3,y=m?3:1,v="",x="";n&&(v=r?`float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ${n}\n        }`:a?`float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ${n}\n        }`:`\n          float activation(float x) {\n            ${n}\n          }\n        `,x="result = activation(result);");let w=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n      ${v}\n\n      const ivec2 strides = ivec2(${o}, ${l});\n      const ivec2 pads = ivec2(${i}, ${s});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[${y}];\n\n        ivec2 xRCCorner =\n            ivec2(coords[${g}], coords[${b}]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${c}; wR++) {\n          int xR = xRCorner + wR * ${u};\n\n          if (xR < 0 || xR >= ${e.inHeight}) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${p}; wC++) {\n            int xC = xCCorner + wC * ${d};\n\n            if (xC < 0 || xC >= ${e.inWidth}) {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ${h}; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (${m}) {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (${1===f}) {\n\n              if (${m}) {\n                dotProd +=\n                    getX(batch, xR, xC, ${h}) *\n                    getW(wR, wC, ${h}, d2);\n              } else {\n                dotProd +=\n                    getX(batch, ${h}, xR, xC) *\n                    getW(wR, wC, ${h}, d2);\n              }\n\n            } else if (${2===f}) {\n              vec2 wValues = vec2(\n                getW(wR, wC, ${h}, d2),\n                getW(wR, wC, ${h} + 1, d2)\n              );\n\n              if (${m}) {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ${h}),\n                  getX(batch, xR, xC, ${h} + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ${h}, xR, xC),\n                  getX(batch, ${h} + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (${3===f}) {\n              vec3 wValues = vec3(\n                getW(wR, wC, ${h}, d2),\n                getW(wR, wC, ${h} + 1, d2),\n                getW(wR, wC, ${h} + 2, d2)\n              );\n\n              if (${m}) {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ${h}),\n                  getX(batch, xR, xC, ${h} + 1),\n                  getX(batch, xR, xC, ${h} + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ${h}, xR, xC),\n                  getX(batch, ${h} + 1, xR, xC),\n                  getX(batch, ${h} + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ${w}\n        ${x}\n        setOutput(result);\n      }\n    `}},see=class{constructor(e,t=!1,n=null,r=!1,a=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=p6(this.outputShape.length);let i=e.padInfo.left,s=e.strideWidth,o=e.dilationWidth,l=e.filterHeight,u=e.filterWidth,d=u,c="\n       int xR; int xC; int xCOffset;\n       vec4 wTexel; vec4 previous; vec4 final;";for(let m=0;m<u;m++)c+=`\n           vec4 xTexelC${2*m};\n           int xTexelC${2*m}Ready;\n           vec4 xTexelC${2*m+1};\n           int xTexelC${2*m+1}Ready;\n           vec4 xC${m};`;c+=`\n     for (int r = 0; r < ${l}; r++) {\n      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {\n       `;for(let m=0;m<u;m++)c+=`\n           xTexelC${2*m} = vec4(0.0);\n           xTexelC${2*m}Ready = 0;\n           xTexelC${2*m+1} = vec4(0.0);\n           xTexelC${2*m+1}Ready = 0;\n           xC${m} = vec4(0.0);`;c+="\n         xR = xRCorner + r * dilations[0];\n         if (xR >=0 && xR < inDims[0]) {\n       ";for(let m=0;m<(d+1)/2;m++){let t=2*m;if(c+=`\n           xC = xCCorner + ${t*o};\n           `,1===s){if(t<u&&(i%2==1?(c+=`\n                 xCOffset = xC + 1;\n                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t}Ready == 0) {\n                   xTexelC${t} = getX(batch, xR, xCOffset, d1);\n\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC${t}.zw = vec2(0.0);\n                   }\n                   xTexelC${t}Ready = 1;\n                 }\n               `,c+=1===o&&t>0?`\n                 xC${t} = vec4(xTexelC${t-2}.zw, xTexelC${t}.xy);\n                 `:`\n                   xCOffset = xC + 1 - 2;\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       previous.zw = vec2(0.0);\n                     }\n\n                     xC${t} = vec4(previous.zw, xTexelC${t}.xy);\n                   } else {\n                     xC${t} = vec4(0.0, 0.0, xTexelC${t}.xy);\n                   }\n                   `):c+=`\n                 if (xC >= 0 && xC < inDims[1] && xTexelC${t}Ready == 0) {\n                   xTexelC${t} = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC${t}.zw = vec2(0.0);\n                   }\n                   xTexelC${t}Ready = 1;\n                 }\n\n                 xC${t} = xTexelC${t};\n                 `,t+1<u)){let e=i%2==0?pT.nearestLargerEven(o):o;o%2==0&&i%2==1||o%2!=0&&i%2!=1?(c+=`\n                   xCOffset = xC + imod(pads[1], 2) + ${e};\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t+1}Ready == 0) {\n                     xTexelC${t+1} = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       xTexelC${t+1}.zw = vec2(0.0);\n                     }\n                     xTexelC${t+1}Ready = 1;\n                   }\n                   `,c+=o>1?`\n                     xCOffset -= 2;\n                     if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                      previous = getX(batch, xR, xCOffset, d1);\n                      xC${t+1} = vec4(previous.zw, xTexelC${t+1}.xy);\n                     } else {\n                      xC${t+1} = vec4(0.0, 0.0, xTexelC${t+1}.xy);\n                     }\n                     `:`\n                     xC${t+1} = vec4(xTexelC${t}.zw, xTexelC${t+1}.xy);\n                     `):c+=1===e?`\n                     xC${t+1} = xTexelC${t};\n                     `:`\n                     xCOffset = xC + ${e};\n\n                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t+1}Ready == 0) {\n                       xTexelC${t+1} = getX(batch, xR, xCOffset, d1);\n                       if (xCOffset + 1 >= inDims[1]) {\n                         xTexelC${t+1}.zw = vec2(0.0);\n                       }\n                       xTexelC${t+1}Ready = 1;\n                     }\n\n                     xC${t+1} = xTexelC${t+1};\n                     `}}else t<u&&(i%2==1?(c+=`\n                 xCOffset = xC + 1 - strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t}Ready == 0) {\n                   xTexelC${t} = getX(batch, xR, xCOffset, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC${t}.zw = vec2(0.0);\n                   }\n                   xTexelC${t}Ready = 1;\n                 }\n\n                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${t+1}Ready == 0) {\n                   xTexelC${t+1} = getX(batch, xR, xC + 1, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xC + 2 >= inDims[1]) {\n                     xTexelC${t+1}.zw = vec2(0.0);\n                   }\n                   xTexelC${t+1}Ready = 1;\n                 }\n\n                 xC${t} = vec4(xTexelC${t}.zw, xTexelC${t+1}.zw);\n               `,t+1<u&&(c+=`\n                   final = vec4(0.0);\n                   xCOffset = xC + 1 + strides[1];\n                   if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                     final = getX(batch, xR, xCOffset, d1);\n                   }\n                   xC${t+1} = vec4(xTexelC${t+1}.xy, final.xy);\n                 `)):(c+=`\n                 if(xC >= 0 && xC < inDims[1] && xTexelC${t}Ready == 0) {\n                   xTexelC${t} = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC${t}.zw = vec2(0.0);\n                   }\n                   xTexelC${t}Ready = 1;\n                 }\n\n                 xCOffset = xC + strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t+1}Ready == 0) {\n                   xTexelC${t+1} = getX(batch, xR, xCOffset, d1);\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC${t+1}.zw = vec2(0.);\n                   }\n                   xTexelC${t+1}Ready = 1;\n                 }\n\n                 xC${t} = vec4(\n                   xTexelC${t}.xy, xTexelC${t+1}.xy);\n               `,t+1<u&&(c+=`\n                   xC${t+1} = vec4(xTexelC${t}.zw, xTexelC${t+1}.zw);\n                 `)));t<u&&(c+=`\n             wTexel = getW(r, ${t}, d1, d2);\n             dotProd += xC${t}.xxzz * vec4(wTexel.xy, wTexel.xy);\n             if(d1 + 1 < ${e.inChannels}) {\n               dotProd += xC${t}.yyww * vec4(wTexel.zw, wTexel.zw);\n             }\n           `,t+1<u&&(c+=`\n               wTexel = getW(r, ${t+1}, d1, d2);\n               dotProd += xC${t+1}.xxzz * vec4(wTexel.xy, wTexel.xy);\n               if(d1 + 1 < ${e.inChannels}) {\n                 dotProd += xC${t+1}.yyww * vec4(wTexel.zw, wTexel.zw);\n               }\n             `))}c+="\n     }\n   ",c+="\n     }\n   ",c+="\n     }\n   ";let p="",h="";n&&(p=r?`vec4 activation(vec4 a) {\n           vec4 b = getPreluActivationWeightsAtOutCoords();\n           ${n}\n         }`:a?`vec4 activation(vec4 a) {\n           vec4 b = getLeakyreluAlphaAtOutCoords();\n           ${n}\n         }`:`vec4 activation(vec4 x) {\n           ${n}\n         }`,h="result = activation(result);");let f=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n       ${p}\n\n       void main() {\n         ivec4 coords = getOutputCoords();\n         int batch = coords.x;\n         ivec2 xRCCorner = coords.yz * strides - pads;\n         int d2 = coords.w;\n         int xRCorner = xRCCorner.x;\n         int xCCorner = xRCCorner.y;\n\n         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n         vec4 dotProd = vec4(0.000000000000001);\n\n         ${c}\n\n         vec4 result = dotProd - vec4(0.000000000000001);\n         ${f}\n         ${h}\n         setOutput(result);\n       }\n     `}},oee=class{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=p6(this.outputShape.length);let{dataFormat:n}=t,r=j5(),a="channelsLast"===n,i=a?1:2,s=a?2:3,o=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`,l="";for(let u=0;u<=1;u++)for(let e=0;e<=1;e++)l+=`\n          blockIndex = rc.z + ${e};\n          pos = rc.y + ${u};\n\n          ${o}\n            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];\n            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);\n\n            if(d0 < inputShape[${i}] && d0 >= 0) {\n              // Use custom imod instead mod. On Intel GPU, mod may generate\n              // unexpected value.\n              // https://github.com/tensorflow/tfjs/issues/5447\n              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];\n              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /\n                  inChannels);\n\n              if(d1 < inputShape[${s}] && d1 >= 0) {\n\n                ch = imod(pos, inChannels);\n\n                if (${a}) {\n                  innerDims = vec2(d1, ch);\n                  result[${2*u+e}] = getChannel(\n                    getA(rc.x, d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[${2*u+e}] = getChannel(\n                    getA(rc.x, ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        `;this.userCode=`\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ${l}\n\n        ${r.output} = result;\n      }\n    `}};function lee(e,t){let n=e.length;return n>=3?t?[...e.slice(0,-3),e[n-3]*e[n-2],e[n-1]]:[...e.slice(0,-3),e[n-3],e[n-2]*e[n-1]]:!t&&1===n&&e[0]>1?[e[0],1]:null}function uee({x:e,filter:t,convInfo:n,backend:r,bias:a=null,preluActivationWeights:i=null,leakyreluAlpha:s=0,activation:o=null}){let l,u=e.shape,d=r.texData.get(e.dataId),c=n.inChannels,p=u[0]*u[1]*u[2],h=n.outChannels,f="channelsLast"===n.dataFormat,m=[];if(null!=i){let e=lee(i.shape,f);null!=e&&(i=R7({inputs:{x:i},backend:r,attrs:{shape:e}}),m.push(i))}if(null!=a){let e=lee(a.shape,f);null!=e&&(a=R7({inputs:{x:a},backend:r,attrs:{shape:e}}),m.push(a))}if((1!==p&&1!==h||!(c>j7))&&d.isPacked&&f&&null!=d.texture&&u[2]%2!=0&&pT.arraysEqual(d.shape.slice(-3),u.slice(-3))){let c=u[0]*u[1]*(u[2]+1),p={dataId:e.dataId,shape:[1,c,n.inChannels],dtype:e.dtype},h=d.shape;d.shape=d.shape.slice(),d.shape[d.shape.length-2]++,pT.assert($5(d.shape,p.shape),(()=>`packed reshape ${d.shape} to ${p.shape} isn't free`));let f=R7({inputs:{x:t},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});m.push(f);let g=H7({a:p,b:f,backend:r,transposeA:!1,transposeB:!1,bias:a,activation:o,preluActivationWeights:i,leakyreluAlpha:s}),b=r.texData.get(g.dataId);pT.assert(b.isPacked,(()=>"batchMatMul result is expected to be packed")),d.shape=h,b.shape=n.outShape,l=p7({inputs:{x:g},backend:r}),l.shape=n.outShape,m.push(g)}else{let u=n.outHeight*n.outWidth,d=R7({inputs:{x:e},backend:r,attrs:{shape:f?[n.batchSize,u,n.inChannels]:[n.batchSize,n.inChannels,u]}}),c=R7({inputs:{x:t},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}}),p=H7({a:f?d:c,b:f?c:d,transposeA:!f,transposeB:!1,backend:r,bias:a,activation:o,preluActivationWeights:i,leakyreluAlpha:s});l=R7({inputs:{x:p},backend:r,attrs:{shape:n.outShape}}),m.push(d),m.push(c),m.push(p)}for(let g of m)r.disposeIntermediateTensorInfo(g);return l}function dee({x:e,filter:t,convInfo:n,backend:r,bias:a=null,preluActivationWeights:i=null,leakyreluAlpha:s=0,activation:o=null}){let{filterWidth:l,filterHeight:u,inChannels:d,outWidth:c,outHeight:p,dataFormat:h}=n,f="channelsLast"===h,m=l*u*d,g=p*c,b=[n.batchSize,m,g],y=[];if(null!=i){let e=lee(i.shape,f);null!=e&&(i=R7({inputs:{x:i},backend:r,attrs:{shape:e}}),y.push(i))}if(null!=a){let e=lee(a.shape,f);null!=e&&(a=R7({inputs:{x:a},backend:r,attrs:{shape:e}}),y.push(a))}let v=R7({inputs:{x:t},backend:r,attrs:{shape:[1,m,pT.sizeFromShape(t.shape)/m]}});y.push(v);let x=new oee(b,n),w=[e.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],k=r.runWebGLProgram(x,[e],"float32",w),S=R7({inputs:{x:k},backend:r,attrs:{shape:b}});y.push(k),y.push(S);let I=null!=a,N=null!=i,C="leakyrelu"===o,T=o?N7(o,!0):null,E=new C7(f?S.shape:v.shape,f?v.shape:S.shape,f?[n.batchSize,g,n.outChannels]:[n.batchSize,n.outChannels,g],!0,!1,I,T,N,C),_=f?[S,v]:[v,S];if(a&&_.push(a),N&&_.push(i),C){let e=r.makeTensorInfo([],"float32",pT.createScalarValue(s,"float32"));_.push(e),y.push(e)}let $=r.runWebGLProgram(E,_,"float32"),A=R7({inputs:{x:$},backend:r,attrs:{shape:n.outShape}});y.push($);for(let R of y)r.disposeIntermediateTensorInfo(R);return A}var cee,pee={kernelName:cI,backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:r,attrs:a}=e,{x:i,filter:s}=n,{strides:o,pad:l,dataFormat:u,dilations:d,dimRoundingMode:c}=a,p=_P.convertConv2DDataFormat(u),h=_P.computeConv2DInfo(i.shape,s.shape,o,d,l,c,!1,p);if(1!==h.filterHeight||1!==h.filterWidth||1!==h.dilationHeight||1!==h.dilationWidth||1!==h.strideHeight||1!==h.strideWidth||"SAME"!==h.padInfo.type&&"VALID"!==h.padInfo.type)if(h.strideWidth<=2&&"channelsLast"===p&&$S().getBool("WEBGL_EXP_CONV")){let e=new see(h),n=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];t=r.runWebGLProgram(e,[i,s],"float32",n)}else if($S().getBool("WEBGL_CONV_IM2COL"))t=dee({x:i,filter:s,convInfo:h,backend:r});else{let e=new iee(h);t=r.runWebGLProgram(e,[i,s],"float32")}else t=uee({x:i,filter:s,convInfo:h,backend:r});let f=R7({inputs:{x:t},backend:r,attrs:{shape:h.outShape}});return r.disposeIntermediateTensorInfo(t),f}},hee={kernelName:pI,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,dy:i}=t,{strides:s,pad:o,dataFormat:l,dimRoundingMode:u,filterShape:d}=r,c=_P.convertConv2DDataFormat(l),p=_P.computeConv2DInfo(a.shape,d,s,1,o,u,!1,c),h=new class{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;let t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,a=e.padInfo.left,i="channelsLast"===e.dataFormat;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ${e.batchSize}; b++) {\n          for (int yR = 0; yR < ${e.outHeight}; yR++) {\n            int xR = wR + yR * ${t} - ${r};\n\n            if (xR < 0 || xR >= ${e.inHeight}) {\n              continue;\n            }\n\n            for (int yC = 0; yC < ${e.outWidth}; yC++) {\n              int xC = wC + yC * ${n} - ${a};\n\n              if (xC < 0 || xC >= ${e.inWidth}) {\n                continue;\n              }\n\n              ${i?"float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);":"float dyValue = getDy(b, d2, yR, yC);\n              float xValue = getX(b, d1, xR, xC);\n              dotProd += (xValue * dyValue);"}\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}(p);return n.runWebGLProgram(h,[a,i],"float32")}},fee={kernelName:hI,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:i}=t,{inputShape:s,strides:o,pad:l,dataFormat:u,dimRoundingMode:d}=r,c=_P.convertConv2DDataFormat(u),p=_P.computeConv2DInfo(s,i.shape,o,1,l,d,!1,c);if($S().getBool("WEBGL_PACK")&&"channelsLast"===c){let e=[[p.strideHeight,p.strideWidth]],t=new class{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=p6(this.outputShape.length);let t=e.filterHeight,n=e.filterWidth,r=t-1-e.padInfo.top,a=n-1-e.padInfo.left;this.userCode=`\n      const ivec2 pads = ivec2(${r}, ${a});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n\n        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        vec4 result = vec4(0.);\n        for (int wR = 0; wR < ${t}; wR++) {\n          float dyR = float(dyRCorner + wR) / strides[0];\n          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n          int wRPerm = ${t} - 1 - wR;\n\n          for (int wC = 0; wC < ${n}; wC++) {\n            int wCPerm = ${n} - 1 - wC;\n\n            float dyC = float(dyCCorner + wC) / strides[1];\n            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)\n              && (fract(dyC) == 0.0);\n            int idyC = int(dyC);\n\n            float dyC2 = float(dyCCorner + wC + 1) / strides[1];\n            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)\n              && (fract(dyC2) == 0.0);\n            int idyC2 = int(dyC2);\n\n            if (idyCVal && idyCVal2) {\n              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?\n                  dySample : getDy(batch, idyR, idyC2, d2);\n\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n\n                dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample2.xy : dySample2.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal) {\n              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal2) {\n              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC2, d2);\n                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            }\n          }\n        }\n        setOutput(result);\n      }\n    `}}(p);return n.runWebGLProgram(t,[a,i],"float32",e)}{let e=new class{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;let t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,a=e.strideWidth,i="channelsLast"===e.dataFormat,s=t-1-e.padInfo.top,o=n-1-e.padInfo.left,l=i?1:2,u=i?2:3,d=i?3:1;this.userCode=`\n      const ivec2 pads = ivec2(${s}, ${o});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[${d}];\n\n        ivec2 dyCorner = ivec2(coords[${l}], coords[${u}]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${t}; wR++) {\n          float dyR = float(dyRCorner + wR) / ${r}.0;\n\n          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ${t} - 1 - wR;\n\n          for (int wC = 0; wC < ${n}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${a}.0;\n\n            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ${n} - 1 - wC;\n\n            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {\n\n              if (${i}) {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}(p);return n.runWebGLProgram(e,[a,i],"float32")}}},mee={kernelName:fI,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:s,pad:o,dilations:l}=r,u=_P.computeConv3DInfo(a.shape,i.shape,s,l,o),d=new class{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;let t=e.padInfo.front,n=e.padInfo.top,r=e.padInfo.left,a=e.strideDepth,i=e.strideHeight,s=e.strideWidth,o=e.dilationDepth,l=e.dilationHeight,u=e.dilationWidth,d=e.filterDepth,c=e.filterHeight,p=e.filterWidth,h=4*Math.floor(e.inChannels/4),f=e.inChannels%4;this.userCode=`\n      const ivec3 strides = ivec3(${a}, ${i}, ${s});\n      const ivec3 pads = ivec3(${t}, ${n}, ${r});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ${d}; wF++) {\n          int xF = xFCorner + wF * ${o};\n\n          if (xF < 0 || xF >= ${e.inDepth}) {\n            continue;\n          }\n\n          for (int wR = 0; wR < ${c}; wR++) {\n            int xR = xRCorner + wR * ${l};\n\n            if (xR < 0 || xR >= ${e.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${p}; wC++) {\n              int xC = xCCorner + wC * ${u};\n\n              if (xC < 0 || xC >= ${e.inWidth}) {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ${h}; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (${1===f}) {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ${h}) *\n                  getW(wF, wR, wC, ${h}, d2);\n              } else if (${2===f}) {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ${h}),\n                  getX(batch, xF, xR, xC, ${h} + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ${h}, d2),\n                  getW(wF, wR, wC, ${h} + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (${3===f}) {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ${h}),\n                  getX(batch, xF, xR, xC, ${h} + 1),\n                  getX(batch, xF, xR, xC, ${h} + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ${h}, d2),\n                  getW(wF, wR, wC, ${h} + 1, d2),\n                  getW(wF, wR, wC, ${h} + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}(u);return n.runWebGLProgram(d,[a,i],"float32")}},gee={kernelName:mI,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,dy:i}=t,{strides:s,pad:o,filterShape:l}=r,u=_P.computeConv3DInfo(a.shape,l,s,1,o),d=new class{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;let t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,a=e.padInfo.front,i=e.padInfo.top,s=e.padInfo.left;this.userCode=`\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ${e.batchSize}; b++) {\n          for (int yF = 0; yF < ${e.outDepth}; yF++) {\n            int xF = wF + yF * ${t} - ${a};\n\n            if (xF < 0 || xF >= ${e.inDepth}) {\n              continue;\n            }\n\n            for (int yR = 0; yR < ${e.outHeight}; yR++) {\n              int xR = wR + yR * ${n} - ${i};\n\n              if (xR < 0 || xR >= ${e.inHeight}) {\n                continue;\n              }\n\n              for (int yC = 0; yC < ${e.outWidth}; yC++) {\n                int xC = wC + yC * ${r} - ${s};\n\n                if (xC < 0 || xC >= ${e.inWidth}) {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}(u);return n.runWebGLProgram(d,[a,i],"float32")}},bee={kernelName:gI,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:i}=t,{pad:s,strides:o,inputShape:l}=r,u=_P.computeConv3DInfo(l,i.shape,o,1,s),d=new class{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;let t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,a=e.strideDepth,i=e.strideHeight,s=e.strideWidth,o=t-1-e.padInfo.front,l=n-1-e.padInfo.top,u=r-1-e.padInfo.left;this.userCode=`\n      const ivec3 pads = ivec3(${o}, ${l}, ${u});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ${t}; wF++) {\n          float dyF = float(dyFCorner + wF) / ${a}.0;\n\n          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ${t} - 1 - wF;\n\n          for (int wR = 0; wR < ${n}; wR++) {\n            float dyR = float(dyRCorner + wR) / ${i}.0;\n\n            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ${n} - 1 - wR;\n\n            for (int wC = 0; wC < ${r}; wC++) {\n              float dyC = float(dyCCorner + wC) / ${s}.0;\n\n              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ${r} - 1 - wC;\n\n              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}(u);return n.runWebGLProgram(d,[a,i],"float32")}},yee=S7({opSnippet:k7+"\n  return cos(x);\n",packedOpSnippet:`\n  vec4 result = cos(x);\n  bvec4 isNaN = isnan(x);\n  ${d7}\n  return result;\n`}),vee={kernelName:bI,backendName:"webgl",kernelFunc:yee},xee=S7({opSnippet:"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n"}),wee={kernelName:yI,backendName:"webgl",kernelFunc:xee},kee={kernelName:wI,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e,{image:a,boxes:i,boxInd:s}=t,{cropSize:o,method:l,extrapolationValue:u}=r,d=new class{constructor(e,t,n,r,a){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];let[i,s,o,l]=e,[u]=t,[d,c]=n;this.outputShape=[u,d,c,l];let p="bilinear"===r?1:0,[h,f]=[s-1+".0",o-1+".0"],[m,g,b]=d>1?[""+(s-1)/(d-1),"(y2-y1) * height_ratio",`y1*${h} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${h}`],[y,v,x]=c>1?[""+(o-1)/(c-1),"(x2-x1) * width_ratio",`x1*${f} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${f}`];this.userCode=`\n      const float height_ratio = float(${m});\n      const float width_ratio = float(${y});\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ${i}) {\n          return;\n        }\n\n        float height_scale = ${g};\n        float width_scale = ${v};\n\n        float in_y = ${b};\n        if( in_y < 0.0 || in_y > ${h} ) {\n          setOutput(float(${a}));\n          return;\n        }\n        float in_x = ${x};\n        if( in_x < 0.0 || in_x > ${f} ) {\n          setOutput(float(${a}));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(${p} == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    `}}(a.shape,i.shape,o,l,u);return n.runWebGLProgram(d,[a,i,s],"float32")}};!function(e){e.Prod="*",e.Sum="+"}(cee||(cee={}));var See=class{constructor(e,t,n,r){this.op=e,this.outputShape=t,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];let a=this.outputShape.length,i=this.op===cee.Prod?"1.0":"0.0",s=n?i:`getX(${Iee(a,"coords",this.op)})`,o=this.outputShape[this.outputShape.length-1],l="",u="";n?(l=r?"end != "+(o-1):"end != 0",u=r?"end + 1":"end - 1"):(l=r?`end + pow2 < ${o}`:"end >= pow2",u=r?"end + pow2":"end - pow2"),this.userCode=`\n      void main() {\n        ${s6(a)} coords = getOutputCoords();\n        int end = ${Nee(a,"coords",this.op)};\n        float val = ${s};\n        int pow2 = int(pow(2.0, index));\n        if (${l}) {\n          int idx = ${u};\n          ${Nee(a,"coords",this.op)} = idx;\n          val ${this.op}= getX(${Iee(a,"coords",this.op)});\n        }\n        setOutput(val);\n      }\n    `}};function Iee(e,t,n){if(1===e)return`${t}`;if(2===e)return`${t}.x, ${t}.y`;if(3===e)return`${t}.x, ${t}.y, ${t}.z`;if(4===e)return`${t}.x, ${t}.y, ${t}.z, ${t}.w`;throw new Error(`Cumulative ${n} for rank ${e} is not yet supported`)}function Nee(e,t,n){if(1===e)return`${t}`;if(2===e)return`${t}.y`;if(3===e)return`${t}.z`;if(4===e)return`${t}.w`;throw new Error(`Cumulative ${n} for rank ${e} is not yet supported`)}function Cee(e,t,n,r,a,i){let s=t.shape.length,o=_P.getAxesPermutation([r],s),l=t;null!=o&&(l=V7({inputs:{x:t},backend:n,attrs:{perm:o}}));let u=_P.getInnerMostAxes(1,s)[0];if(u!==s-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${t.shape.length-1} but got axis=${r}`);let d=l.shape[u],c=p7({inputs:{x:l},backend:n});for(let p=0;p<=Math.ceil(Math.log2(d))-1;p++){let t=new See(e,l.shape,!1,i),r=[[p]],a=c;c=n.runWebGLProgram(t,[c],c.dtype,r),n.disposeIntermediateTensorInfo(a)}if(a){let t=new See(e,l.shape,a,i),r=c;c=n.runWebGLProgram(t,[c],c.dtype),n.disposeIntermediateTensorInfo(r)}if(null!=o){let e=V7({inputs:{x:c},backend:n,attrs:{perm:_P.getUndoAxesPermutation(o)}});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(l),e}return c}var Tee={kernelName:vI,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,exclusive:s,reverse:o}=r;return Cee(cee.Prod,a,n,i,s,o)}},Eee={kernelName:xI,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,exclusive:s,reverse:o}=r;return Cee(cee.Sum,a,n,i,s,o)}},_ee={kernelName:kI,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,weights:i}=t,{size:s,binaryOutput:o}=r;if(1===a.shape.length){let e=n.readSync(a.dataId),t=n.readSync(i.dataId),r=B6(e,t,i.dtype,i.shape,s);return n.makeTensorInfo([s],i.dtype,r)}if(2===a.shape.length){let e=n.bufferSync(a),t=n.bufferSync(i),r=W6(e,t,s,o);return n.makeTensorInfo(r.shape,i.dtype,r.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${a.shape.length}.`)}},$ee={kernelName:SI,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockSize:i,dataFormat:s}=r,o=a.shape[0],l=("NHWC"===s?a.shape[1]:a.shape[2])*i,u=("NHWC"===s?a.shape[2]:a.shape[3])*i,d=("NHWC"===s?a.shape[3]:a.shape[1])/(i*i),c="NHWC"===s?[o,l,u,d]:[o,d,l,u],p=new class{constructor(e,t,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=n,this.userCode=`\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ${this.getHeightCoordString()};\n      int w = ${this.getWidthCoordString()};\n      int d = ${this.getDepthCoordString()};\n\n      int in_h = h / ${t};\n      int offset_h = imod(h, ${t});\n      int in_w = w / ${t};\n      int offset_w = imod(w, ${t});\n      int offset_d = (offset_h * ${t} + offset_w) *\n        ${this.getOutputDepthSize()};\n      int in_d = d + offset_d;\n\n      float result = ${this.getInputSamplingString()};\n      setOutput(result);\n    }\n  `}getHeightCoordString(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}getWidthCoordString(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}getDepthCoordString(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}getOutputDepthSize(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}(c,i,s);return n.runWebGLProgram(p,[a],a.dtype)}},Aee=class{constructor(e,t=!1,n=null,r=!1,a=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=p6(this.outputShape.length);let i=e.filterHeight,s=e.filterWidth,o=e.outChannels/e.inChannels,l="",u="";n&&(l=r?`float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ${n}\n        }`:a?`float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ${n}\n        }`:`\n          float activation(float x) {\n            ${n}\n          }\n        `,u="result = activation(result);");let d=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n      ${l}\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ${o};\n        int q = d2 - d1 * ${o};\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ${i}; wR++) {\n          int xR = xRCorner + wR * dilations[0];\n\n          if (xR < 0 || xR >= inDims[0]) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${s}; wC++) {\n            int xC = xCCorner + wC * dilations[1];\n\n            if (xC < 0 || xC >= inDims[1]) {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ${d}\n        ${u}\n        setOutput(result);\n      }\n    `}},Ree=class{constructor(e,t=!1,n=null,r=!1,a=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=p6(this.outputShape.length);let i=e.outChannels/e.inChannels,s=e.padInfo.left,o=e.strideWidth,l=e.dilationWidth,u=e.filterHeight,d=e.filterWidth,c=d,p="\n      int xR; int xC; int xCOffset;\n      vec4 wTexel; vec4 previous; vec4 final;";for(let g=0;g<d;g++)p+=`\n          vec4 xTexelC${2*g};\n          int xTexelC${2*g}Ready;\n          vec4 xTexelC${2*g+1};\n          int xTexelC${2*g+1}Ready;\n          vec4 xC${g};`;p+=`\n    for (int r = 0; r < ${u}; r++) {\n      `;for(let g=0;g<d;g++)p+=`\n          xTexelC${2*g} = vec4(0.0);\n          xTexelC${2*g}Ready = 0;\n          xTexelC${2*g+1} = vec4(0.0);\n          xTexelC${2*g+1}Ready = 0;\n          xC${g} = vec4(0.0);`;p+="\n        xR = xRCorner + r * dilations[0];\n        if (xR >=0 && xR < inDims[0]) {\n      ";for(let g=0;g<(c+1)/2;g++){let e=2*g;if(p+=`\n          xC = xCCorner + ${e*l};\n          `,1===o){if(e<d&&(s%2==1?(p+=`\n                xCOffset = xC + 1;\n                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${e}Ready == 0) {\n                  xTexelC${e} = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC${e}.zw = vec2(0.0);\n                  }\n                  xTexelC${e}Ready = 1;\n                }\n              `,p+=1===l&&e>0?`\n                xC${e} = vec4(xTexelC${e-2}.zw, xTexelC${e}.xy);\n                `:`\n                  xCOffset = xC + 1 - 2;\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                    previous = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      previous.zw = vec2(0.0);\n                    }\n\n                    xC${e} = vec4(previous.zw, xTexelC${e}.xy);\n                  } else {\n                    xC${e} = vec4(0.0, 0.0, xTexelC${e}.xy);\n                  }\n                  `):p+=`\n                if (xC >= 0 && xC < inDims[1] && xTexelC${e}Ready == 0) {\n                  xTexelC${e} = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC${e}.zw = vec2(0.0);\n                  }\n                  xTexelC${e}Ready = 1;\n                }\n\n                xC${e} = xTexelC${e};\n                `,e+1<d)){let t=s%2==0?pT.nearestLargerEven(l):l;l%2==0&&s%2==1||l%2!=0&&s%2!=1?(p+=`\n                  xCOffset = xC + imod(pads[1], 2) + ${t};\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${e+1}Ready == 0) {\n                    xTexelC${e+1} = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      xTexelC${e+1}.zw = vec2(0.0);\n                    }\n                    xTexelC${e+1}Ready = 1;\n                  }\n                  `,p+=l>1?`\n                    xCOffset -= 2;\n                    if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n                     xC${e+1} = vec4(previous.zw, xTexelC${e+1}.xy);\n                    } else {\n                     xC${e+1} = vec4(0.0, 0.0, xTexelC${e+1}.xy);\n                    }\n                    `:`\n                    xC${e+1} = vec4(xTexelC${e}.zw, xTexelC${e+1}.xy);\n                    `):p+=1===t?`\n                    xC${e+1} = xTexelC${e};\n                    `:`\n                    xCOffset = xC + ${t};\n\n                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${e+1}Ready == 0) {\n                      xTexelC${e+1} = getX(batch, xR, xCOffset, d1);\n                      if (xCOffset + 1 >= inDims[1]) {\n                        xTexelC${e+1}.zw = vec2(0.0);\n                      }\n                      xTexelC${e+1}Ready = 1;\n                    }\n\n                    xC${e+1} = xTexelC${e+1};\n                    `}}else e<d&&(s%2==1?(p+=`\n                xCOffset = xC + 1 - strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${e}Ready == 0) {\n                  xTexelC${e} = getX(batch, xR, xCOffset, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC${e}.zw = vec2(0.0);\n                  }\n                  xTexelC${e}Ready = 1;\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${e+1}Ready == 0) {\n                  xTexelC${e+1} = getX(batch, xR, xC + 1, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xC + 2 >= inDims[1]) {\n                    xTexelC${e+1}.zw = vec2(0.0);\n                  }\n                  xTexelC${e+1}Ready = 1;\n                }\n\n                xC${e} = vec4(xTexelC${e}.zw, xTexelC${e+1}.zw);\n              `,e+1<d&&(p+=`\n                  final = vec4(0.0);\n                  xCOffset = xC + 1 + strides[1];\n                  if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xC${e+1} = vec4(xTexelC${e+1}.xy, final.xy);\n                `)):(p+=`\n                if(xC >= 0 && xC < inDims[1] && xTexelC${e}Ready == 0) {\n                  xTexelC${e} = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC${e}.zw = vec2(0.0);\n                  }\n                  xTexelC${e}Ready = 1;\n                }\n\n                xCOffset = xC + strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${e+1}Ready == 0) {\n                  xTexelC${e+1} = getX(batch, xR, xCOffset, d1);\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC${e+1}.zw = vec2(0.);\n                  }\n                  xTexelC${e+1}Ready = 1;\n                }\n\n                xC${e} = vec4(\n                  xTexelC${e}.xy, xTexelC${e+1}.xy);\n              `,e+1<d&&(p+=`\n                  xC${e+1} = vec4(xTexelC${e}.zw, xTexelC${e+1}.zw);\n                `)));e<d&&(p+=`\n            wTexel = getW(r, ${e}, d1, q);\n            dotProd += xC${e} * vec4(wTexel.xz, wTexel.xz);\n          `,e+1<d&&(p+=`\n              wTexel = getW(r, ${e+1}, d1, q);\n              dotProd += xC${e+1} * vec4(wTexel.xz, wTexel.xz);\n            `))}p+="\n    }\n  ",p+="\n      }\n    ";let h="",f="";n&&(h=r?`vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ${n}\n        }`:a?`vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ${n}\n        }`:`vec4 activation(vec4 x) {\n          ${n}\n        }`,f="result = activation(result);");let m=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n      ${h}\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ${i};\n        int q = d2 - d1 * ${i};\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n        vec4 dotProd = vec4(0.000000000000001);\n\n        ${p}\n\n        vec4 result = dotProd - vec4(0.000000000000001);\n        ${m}\n        ${f}\n        setOutput(result);\n      }\n    `}},Dee={kernelName:II,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:s,pad:o,dilations:l,dimRoundingMode:u}=r,d=l;null==d&&(d=[1,1]),pT.assert(_P.eitherStridesOrDilationsAreOne(s,d),(()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${s} and dilations '${d}'`));let c,p=_P.computeConv2DInfo(a.shape,i.shape,s,d,o,u,!0);c=$S().getBool("WEBGL_PACK_DEPTHWISECONV")&&p.strideWidth<=2&&p.outChannels/p.inChannels==1?new Ree(p):new Aee(p);let h=[[p.padInfo.top,p.padInfo.left],[p.strideHeight,p.strideWidth],[p.dilationHeight,p.dilationWidth],[p.inHeight,p.inWidth]];return n.runWebGLProgram(c,[a,i],"float32",h)}},Fee={kernelName:NI,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,dy:i}=t,{strides:s,dilations:o,pad:l,dimRoundingMode:u,filterShape:d}=r,c=_P.computeConv2DInfo(a.shape,d,s,o,l,u,!0),p=new class{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;let t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,a=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ${i} + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ${e.batchSize}; b++) {\n          for (int yR = 0; yR < ${e.outHeight}; yR++) {\n            int xR = wR + yR * ${t} - ${r};\n\n            if (xR < 0 || xR >= ${e.inHeight}) {\n              continue;\n            }\n\n            for (int yC = 0; yC < ${e.outWidth}; yC++) {\n              int xC = wC + yC * ${n} - ${a};\n\n              if (xC < 0 || xC >= ${e.inWidth}) {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}(c);return n.runWebGLProgram(p,[a,i],"float32")}},Mee={kernelName:CI,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:i}=t,{strides:s,dilations:o,pad:l,dimRoundingMode:u,inputShape:d}=r,c=_P.computeConv2DInfo(d,i.shape,s,o,l,u,!0),p=new class{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;let t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,a=e.strideWidth,i=t-1-e.padInfo.top,s=n-1-e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode=`\n      const ivec2 pads = ivec2(${i}, ${s});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ${t}; wR++) {\n          float dyR = float(dyRCorner + wR) / ${r}.0;\n\n          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ${t} - 1 - wR;\n\n          for (int wC = 0; wC < ${n}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${a}.0;\n\n            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ${n} - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ${o}; dm++) {\n              int d2 = d1 * ${o} + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}(c);return n.runWebGLProgram(p,[a,i],"float32")}},Oee={kernelName:TI,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{x:r}=t,a=[...r.shape,...r.shape],i=pT.sizeFromShape(r.shape),s=R7({inputs:{x:r},backend:n,attrs:{shape:[i]}}),o=new class{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}}(i),l=n.runWebGLProgram(o,[s],s.dtype),u=R7({inputs:{x:l},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(l),u}},Pee={kernelName:EI,backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:r,attrs:a}=e,{x:i,filter:s}=n,{strides:o,pad:l,dilations:u}=a,d=_P.computeDilation2DInfo(i.shape,s.shape,o,l,"NHWC",u),c=new class{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;let{inHeight:t,inWidth:n,padInfo:r,strideHeight:a,strideWidth:i,filterHeight:s,filterWidth:o,dilationHeight:l,dilationWidth:u}=e,{top:d,left:c}=r;this.userCode=`\n      const ivec2 strides = ivec2(${a}, ${i});\n      const ivec2 pads = ivec2(${d}, ${c});\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ${s}; h++) {\n          int hIn = hBeg + h * ${l};\n\n          if (hIn >= 0 && hIn < ${t}) {\n            for (int w = 0; w < ${o}; w++) {\n              int wIn = wBeg + w * ${u};\n\n              if (wIn >= 0 && wIn < ${n}) {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    `}}(d);t=r.runWebGLProgram(c,[i,s],"float32");let p=R7({inputs:{x:t},backend:r,attrs:{shape:d.outShape}});return r.disposeIntermediateTensorInfo(t),p}},Lee={kernelName:DI,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{equation:a}=r,i=t,{allDims:s,summedDims:o,idDims:l}=_P.decodeEinsumEquation(a,i.length);_P.checkEinsumDimSizes(s.length,l,i);let{path:u,steps:d}=_P.getEinsumComputePath(o,l),c=d.length,p=null,h=s.length,f=[];for(let m=0;m<c;++m){for(let e of d[m]){let t,{permutationIndices:r,expandDims:a}=_P.getEinsumPermutation(h,l[e]);_P.isIdentityPermutation(r)?t=i[e]:(t=V7({inputs:{x:i[e]},backend:n,attrs:{perm:r}}),f.push(t));let s=t.shape.slice();for(let e=0;e<a.length;++e)s.splice(a[e],0,1);pT.arraysEqual(t.shape,s)||(t=R7({inputs:{x:t},backend:n,attrs:{shape:s}}),f.push(t)),null===p?p=t:(p=$7({inputs:{a:t,b:p},backend:n}),f.push(p))}m<c-1&&(u[m]>=0&&(p=B7({inputs:{x:p},backend:n,attrs:{axis:u[m]-(s.length-h),keepDims:!1}}),f.push(p)),h--)}for(let m of f)m!==p&&n.disposeIntermediateTensorInfo(m);return p}},zee=S7({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n"}),Bee={kernelName:FI,backendName:"webgl",kernelFunc:zee},Wee={kernelName:MI,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n}=e,{dy:r,y:a}=t,i=$S().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new c7("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",r.shape,a.shape):new u7("return (b >= 0.0) ? a : a * (b + 1.0);",r.shape,a.shape);return n.runWebGLProgram(i,[r,a],r.dtype)}},Vee=I7({opSnippet:"return float(a == b);",packedOpSnippet:"\n  return vec4(equal(a, b));\n",dtype:"bool",cpuKernelImpl:G6}),Uee={kernelName:PI,backendName:"webgl",kernelFunc:Vee},jee=S7({opSnippet:`\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = ${_P.ERF_P};\n  float a1 = ${_P.ERF_A1};\n  float a2 = ${_P.ERF_A2};\n  float a3 = ${_P.ERF_A3};\n  float a4 = ${_P.ERF_A4};\n  float a5 = ${_P.ERF_A5};\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n`}),Hee={kernelName:OI,backendName:"webgl",kernelFunc:jee},Gee=S7({opSnippet:k7+"\n  return exp(x);\n",packedOpSnippet:"\n  vec4 result = exp(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:q6,dtype:"float32"}),qee={kernelName:LI,backendName:"webgl",kernelFunc:Gee};function Kee(e){let{inputs:t,attrs:n,backend:r}=e,{dim:a}=n,{input:i}=t,s=i.shape.length,o=i.shape.slice(),l=a;return a<0&&(pT.assert(-(s+1)<=a,(()=>`Axis must be in the interval [${-(s+1)}, ${s}]`)),l=s+a+1),o.splice(l,0,1),R7({inputs:{x:i},backend:r,attrs:{shape:o}})}var Xee={kernelName:zI,backendName:"webgl",kernelFunc:Kee},Yee="return exp(x) - 1.0;",Jee=S7({opSnippet:Yee,packedOpSnippet:Yee,cpuKernelImpl:K6}),Zee={kernelName:BI,backendName:"webgl",kernelFunc:Jee},Qee=class{constructor(e,t,n){this.variableNames=["real","imag"];let r=t[1];this.outputShape=t;let a,i=n?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,s=n?`${r}.0`:"1.0";if("real"===e)a="return real * expR - imag * expI;";else{if("imag"!==e)throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);a="return real * expI + imag * expR;"}this.userCode=`\n      const float exponentMultiplier = ${i};\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ${a}\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(${r});\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ${r}; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ${s};\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    `}};function ete(e,t,n){let r=n.texData.get(e.dataId),a=pT.sizeFromShape(e.shape),i=e.shape[e.shape.length-1],s=R7({inputs:{x:e},backend:n,attrs:{shape:[a/i,i]}}),o=s.shape,l=new Qee("real",o,t),u=new Qee("imag",o,t),d=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:o},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:o}],c=n.runWebGLProgram(l,d,"float32"),p=n.runWebGLProgram(u,d,"float32"),h=f7({inputs:{real:c,imag:p},backend:n});n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(p);let f=R7({inputs:{x:h},backend:n,attrs:{shape:e.shape}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(h),f}var tte={kernelName:WI,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{input:r}=t;return ete(r,!1,n)}},nte=class{constructor(e,t){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode="\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}};function rte(e){let{backend:t,attrs:n}=e,{shape:r,value:a}=n,{dtype:i}=n;if(i=i||pT.inferDtype(a),"string"===i){let e=pT.getArrayFromDType(i,pT.sizeFromShape(r));return e.fill(a),t.makeTensorInfo(r,i,e)}{let e=new nte(r,a),n=[[a]];return t.runWebGLProgram(e,[],i,n)}}var ate,ite={kernelName:VI,backendName:"webgl",kernelFunc:rte},ste={kernelName:UI,backendName:"webgl",kernelFunc:({inputs:e,backend:t})=>{let{image:n}=e,r=t,a=new class{constructor(e){this.variableNames=["Image"],this.outputShape=[];let t=e[2];this.outputShape=e,this.userCode=`\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ${t} - x - 1;\n          float outputValue;\n          if(coordX >= 0 && coordX < ${t}) {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    `}}(n.shape);return r.runWebGLProgram(a,[n],n.dtype)}},ote="return floor(x);",lte=S7({opSnippet:ote,packedOpSnippet:ote,cpuKernelImpl:X6}),ute={kernelName:jI,backendName:"webgl",kernelFunc:lte},dte=I7({opSnippet:"\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",packedOpSnippet:"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",dtype:"int32"}),cte={kernelName:HI,backendName:"webgl",kernelFunc:dte},pte={kernelName:KC,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{pixels:a}=t,{numChannels:i}=r,s="undefined"!=typeof HTMLVideoElement&&a instanceof HTMLVideoElement,o="undefined"!=typeof HTMLImageElement&&a instanceof HTMLImageElement,[l,u]=s?[a.videoWidth,a.videoHeight]:[a.width,a.height],d=[u,l],c=[u,l,i];if(o||s){let e=$S().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(null==ate||e!==hte)&&(hte=e,ate=document.createElement("canvas").getContext("2d",{willReadFrequently:hte})),ate.canvas.width=l,ate.canvas.height=u,ate.drawImage(a,0,0,l,u),a=ate.canvas}let p=n.makeTensorInfo(d,"int32");n.texData.get(p.dataId).usage=M4.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(p.dataId),a);let h=$S().getBool("WEBGL_PACK")?new class{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;let t=j5(),[n,r]=e;this.outputShape=e,this.userCode=`\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(${r}.0, ${n}.0);\n            vec4 values = ${t.texture2D}(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ${t.output} = result;\n      }\n    `}}(c):new class{constructor(e){this.variableNames=["A"];let t=j5(),[n,r]=e;this.outputShape=e,this.userCode=`\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${n}.0);\n\n        vec4 values = ${t.texture2D}(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    `}}(c),f=n.runWebGLProgram(h,[p],"int32");return n.disposeData(p.dataId),f}},hte=$S().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU"),fte={kernelName:JC,backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:r,attrs:a}=e,{x:i,filter:s,bias:o,preluActivationWeights:l}=n,{strides:u,pad:d,dataFormat:c,dilations:p,dimRoundingMode:h,activation:f,leakyreluAlpha:m}=a,g=_P.convertConv2DDataFormat(c),b=_P.computeConv2DInfo(i.shape,s.shape,u,p,d,h,!1,g),y=[],v=null!=o,x=null!=l,w="leakyrelu"===f,k=()=>{let e=[i,s],t=(e,t)=>{if("NCHW"===t&&1===e.shape.length&&1!==e.shape[0]){let t=R7({inputs:{x:e},backend:r,attrs:{shape:[e.shape[0],1,1]}});return y.push(t),t}return e};if(v&&e.push(t(o,c)),x&&e.push(t(l,c)),w){let t=r.makeTensorInfo([],"float32",pT.createScalarValue(m,"float32"));e.push(t),y.push(t)}return e};if(1!==b.filterHeight||1!==b.filterWidth||1!==b.dilationHeight||1!==b.dilationWidth||1!==b.strideHeight||1!==b.strideWidth||"SAME"!==b.padInfo.type&&"VALID"!==b.padInfo.type)if(b.strideWidth<=2&&"channelsLast"===g&&$S().getBool("WEBGL_EXP_CONV")){let e=f?N7(f,!0):null,n=new see(b,v,e,x,w),a=[[b.padInfo.top,b.padInfo.left],[b.strideHeight,b.strideWidth],[b.dilationHeight,b.dilationWidth],[b.inHeight,b.inWidth]],i=k();t=r.runWebGLProgram(n,i,"float32",a)}else if($S().getBool("WEBGL_CONV_IM2COL"))t=dee({x:i,filter:s,convInfo:b,backend:r,bias:o,activation:f,preluActivationWeights:l,leakyreluAlpha:m});else{let e=f?N7(f,!1):null,n=new iee(b,v,e,x,w),a=k();t=r.runWebGLProgram(n,a,"float32")}else t=uee({x:i,filter:s,convInfo:b,backend:r,bias:o,activation:f,preluActivationWeights:l,leakyreluAlpha:m});let S=R7({inputs:{x:t},backend:r,attrs:{shape:b.outShape}});return y.push(t),y.forEach((e=>r.disposeIntermediateTensorInfo(e))),S}},mte={kernelName:ZC,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i,bias:s,preluActivationWeights:o}=t,{strides:l,pad:u,dilations:d,dimRoundingMode:c,activation:p,leakyreluAlpha:h}=r,f=[],m=d;null==m&&(m=[1,1]),pT.assert(_P.eitherStridesOrDilationsAreOne(l,m),(()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${m}'`));let g,b=_P.computeConv2DInfo(a.shape,i.shape,l,m,u,c,!0),y=$S().getBool("WEBGL_PACK_DEPTHWISECONV")&&b.strideWidth<=2&&b.outChannels/b.inChannels==1,v=p?N7(p,y):null,x=[a,i],w=null!=s,k=null!=o,S="leakyrelu"===p;if(w&&x.push(s),k&&x.push(o),S){let e=n.makeTensorInfo([],"float32",pT.createScalarValue(h,"float32"));x.push(e),f.push(e)}g=y?new Ree(b,w,v,k,S):new Aee(b,w,v,k,S);let I=[[b.padInfo.top,b.padInfo.left],[b.strideHeight,b.strideWidth],[b.dilationHeight,b.dilationWidth],[b.inHeight,b.inWidth]],N=n.runWebGLProgram(g,x,"float32",I);return f.forEach((e=>n.disposeIntermediateTensorInfo(e))),N}},gte={kernelName:KI,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{params:r,indices:a}=t,i=a.shape,s=i[i.length-1],o=pT.sizeFromShape(r.shape),[l,u,d,c]=_P.prepareAndValidate(r,a),p=R7({inputs:{x:a},backend:n,attrs:{shape:[u,s]}}),h=R7({inputs:{x:r},backend:n,attrs:{shape:[pT.sizeFromShape(r.shape)/d,d]}});if(n.shouldExecuteOnCPU([r,a])||"string"===r.dtype){let e=n.readSync(a.dataId),t=n.bufferSync(r),i=Y6(e,t,r.dtype,u,s,d,c,r.shape,o);return n.makeTensorInfo(l,r.dtype,i.values)}let f=new class{constructor(e,t,n,r){this.sliceDim=e,this.strides=t,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=n;let a=s6(n.length),i="\n    int index;";for(let s=0;s<this.sliceDim;s++)i+=`\n          index = round(getIndices(coords[0], ${s}));\n          out_of_bounds = out_of_bounds || index < 0;\n          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[s]};\n          flattenIndex += index * ${this.strides[s]};`;this.userCode=`\n         void main() {\n          ${a} coords = getOutputCoords();\n          int flattenIndex = 0;\n          bool out_of_bounds = false;\n\n          ${i}\n\n          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));\n        }\n      `}}(s,c,[u,d],r.shape),m=n.runWebGLProgram(f,[h,p],h.dtype),g=R7({inputs:{x:m},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(m),g}},bte=class{constructor(e,t){this.variableNames=["A","indices"],this.outputShape=t,this.rank=t.length;let n=s6(this.rank),r=function(e,t){let n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let a=0;a<e.length;a++)2===a?r.push("index"):r.push(`${n[a]}`);return r.join()}(e);this.userCode=`\n      void main() {\n        ${n} resRC = getOutputCoords();\n        int index = int(getIndices(resRC.x, resRC.z));\n        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;\n        setOutput(inBounds * getA(${r}));\n      }\n    `}};function yte(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,indices:i}=t,{axis:s,batchDims:o}=r,l=pT.parseAxisParam(s,a.shape)[0];if($S().get("DEBUG")){let e=n.readSync(i.dataId),t=a.shape[l];for(let n=0;n<e.length;++n){let r=e[n];pT.assert(r<=t-1&&r>=0,(()=>`GatherV2: the index value ${r} is not in [0, ${t-1}]`))}}let u=_P.segment_util.collectGatherOpShapeInfo(a,i,l,o),d=pT.sizeFromShape(i.shape),c=[],p=R7({inputs:{x:a},backend:n,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),h=R7({inputs:{x:i},backend:n,attrs:{shape:[u.batchSize,d/u.batchSize]}});c.push(p),c.push(h);let f=[u.batchSize,u.outerSize,d/u.batchSize,u.sliceSize];if(n.shouldExecuteOnCPU([a,i])||"string"===a.dtype){let e=n.bufferSync(h),t=n.bufferSync(p),r=J6(t,e,f);return c.forEach((e=>n.disposeIntermediateTensorInfo(e))),n.makeTensorInfo(u.outputShape,r.dtype,r.values)}let m=new bte(p.shape,f),g=n.runWebGLProgram(m,[p,h],p.dtype);c.push(g);let b=R7({inputs:{x:g},backend:n,attrs:{shape:u.outputShape}});return c.forEach((e=>n.disposeIntermediateTensorInfo(e))),b}var vte={kernelName:qI,backendName:"webgl",kernelFunc:yte},xte=I7({opSnippet:"return float(a > b);",packedOpSnippet:"\n  return vec4(greaterThan(a, b));\n",cpuKernelImpl:Z6,dtype:"bool"}),wte={kernelName:XI,backendName:"webgl",kernelFunc:xte},kte=I7({opSnippet:"return float(a >= b);",packedOpSnippet:"\n  return vec4(greaterThanEqual(a, b));\n",dtype:"bool",cpuKernelImpl:Q6}),Ste={kernelName:YI,backendName:"webgl",kernelFunc:kte},Ite={kernelName:ZI,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{input:r}=t;return ete(r,!0,n)}},Nte=S7({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),Cte={kernelName:eN,backendName:"webgl",kernelFunc:Nte},Tte=S7({opSnippet:"return float(isinf(x));",dtype:"bool"}),Ete={kernelName:tN,backendName:"webgl",kernelFunc:Tte},_te=S7({opSnippet:"return float(isnan(x));",dtype:"bool"}),$te={kernelName:nN,backendName:"webgl",kernelFunc:_te},Ate=I7({opSnippet:"return float(a < b);",packedOpSnippet:"\n  return vec4(lessThan(a, b));\n",cpuKernelImpl:e8,dtype:"bool"}),Rte={kernelName:aN,backendName:"webgl",kernelFunc:Ate},Dte=I7({opSnippet:"return float(a <= b);",packedOpSnippet:"\n  return vec4(lessThanEqual(a, b));\n",cpuKernelImpl:t8,dtype:"bool"}),Fte={kernelName:iN,backendName:"webgl",kernelFunc:Dte},Mte={kernelName:sN,backendName:"webgl",kernelFunc:function(e){let{backend:t,attrs:n}=e,{start:r,stop:a,num:i}=n,s=n8(r,a,i);return t.makeTensorInfo([s.length],"float32",s)}},Ote=S7({opSnippet:k7+"\n  return x < 0.0 ? 0./0. : log(x);\n",packedOpSnippet:"\n  vec4 result = log(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);\n  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);\n  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);\n  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);\n  return result;\n",cpuKernelImpl:r8}),Pte={kernelName:oN,backendName:"webgl",kernelFunc:Ote},Lte=S7({opSnippet:k7+"\n  return log(1.0 + x);\n"}),zte={kernelName:lN,backendName:"webgl",kernelFunc:Lte},Bte=I7({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",dtype:"bool"}),Wte={kernelName:uN,backendName:"webgl",kernelFunc:Bte},Vte=S7({opSnippet:"return float(!(x >= 1.0));"}),Ute={kernelName:dN,backendName:"webgl",kernelFunc:Vte},jte=I7({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",dtype:"bool"}),Hte={kernelName:cN,backendName:"webgl",kernelFunc:jte},Gte={kernelName:mN,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{depthRadius:i,bias:s,alpha:o,beta:l}=r,u=$S().getBool("WEBGL_PACK_NORMALIZATION")?new class{constructor(e,t,n,r,a){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;let i=t,s=e[3]-1;this.outputShape=e;let o,l=`float(${n}) + float(${r}) * sum`;o=.5===a?`inversesqrt(${l})`:1===a?`1.0/(${l})`:`exp(log(${l}) * float(-${a}));`,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ${this.outputShape[3]};\n        bool hasNextRow = c < ${this.outputShape[2]};\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ${i};\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ${i}; j <= ${i}; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${s}));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ${o};\n        setOutput(result);\n      }\n    `}}(a.shape,i,s,o,l):new class{constructor(e,t,n,r,a){this.variableNames=["x"],this.outputShape=[];let i=t,s=e[3]-1;this.outputShape=e;let o,l=`float(${n}) + float(${r}) * sum`;o=.5===a?`inversesqrt(${l})`:1===a?`1.0/(${l})`:`exp(log(${l}) * float(-${a}));`,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -${i}; j <= ${i}; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ${s}) {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ${o};\n        setOutput(val);\n      }\n    `}}(a.shape,i,s,o,l);return n.runWebGLProgram(u,[a],a.dtype)}},qte={kernelName:gN,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e,{x:a,y:i,dy:s}=t,{depthRadius:o,bias:l,alpha:u,beta:d}=r,c=new class{constructor(e,t,n,r,a){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=r,this.beta=a,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ${this.depth}; ++d) {\n          int depthBegin = int(max(0.0, float(d - ${t})));\n          int depthEnd = int(min(float(${this.depth}),\n              float(d + ${t} + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ${this.depth};\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(${r}) * norm + float(${n});\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(${r})\n                * float(${a})\n                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ${a});\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    `}}(a.shape,o,l,u,d);return n.runWebGLProgram(c,[a,i,s],a.dtype)}};function Kte(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{reductionIndices:i,keepDims:s}=r,o=a.shape.length,l=pT.parseAxisParam(i,a.shape),u=l,d=_P.getAxesPermutation(u,o),c=null!=d,p=n.shouldExecuteOnCPU([a]),h=a;if(c){if(p){let e=n.texData.get(h.dataId).values,t=new Array(o);for(let n=0;n<t.length;n++)t[n]=a.shape[d[n]];let r=R8(e,a.shape,a.dtype,d,t);h=n.makeTensorInfo(t,a.dtype),n.texData.get(h.dataId).values=r}else h=z7(a,d,n);u=_P.getInnerMostAxes(u.length,o)}_P.assertAxesAreInnerMostDims("max",u,o);let f,[m,g]=_P.computeOutAndReduceShapes(h.shape,u),b=m;if(s&&(b=_P.expandShapeToKeepDim(m,l)),p){let e=n.texData.get(h.dataId).values,t=a8(e,pT.sizeFromShape(g),b,a.dtype);f=n.makeTensorInfo(b,a.dtype),n.texData.get(f.dataId).values=t}else f=function(e,t,n,r){let a=pT.sizeFromShape(t),i=R7({inputs:{x:e},attrs:{shape:[pT.sizeFromShape(e.shape)/a,a]},backend:r}),s=O7(i,e.dtype,"max",r),o=R7({inputs:{x:s},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(s),o}(h,g,b,n);return c&&n.disposeIntermediateTensorInfo(h),f}var Xte={kernelName:yN,backendName:"webgl",kernelFunc:Kte},Yte=I7({opSnippet:l7+"\n  return max(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(max(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+d7+"\n  return result;\n",cpuKernelImpl:i8}),Jte={kernelName:vN,backendName:"webgl",kernelFunc:Yte},Zte={kernelName:xN,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t;V5(a,"maxPool");let{filterSize:i,strides:s,pad:o,dimRoundingMode:l}=r;pT.assert(_P.eitherStridesOrDilationsAreOne(s,1),(()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${s} and dilations '1'`));let u=_P.computePool2DInfo(a.shape,i,s,1,o,l);if(1===u.filterWidth&&1===u.filterHeight&&pT.arraysEqual(u.inShape,u.outShape))return p7({inputs:{x:a},backend:n});let d=new k9(u,"max",!1);return n.runWebGLProgram(d,[a],a.dtype)}},Qte={kernelName:kN,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:i,strides:s,pad:o,dataFormat:l,dimRoundingMode:u}=r,d=_P.computePool3DInfo(a.shape,i,s,[1,1,1],o,u,l),c=new S9(d,"max",!1);return n.runWebGLProgram(c,[a],a.dtype)}},ene={kernelName:SN,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,s=i,{filterSize:o,strides:l,pad:u,dimRoundingMode:d}=r,c=_P.computePool3DInfo(s.shape,o,l,[1,1,1],u,d),p=new S9(c,"max",!0),h=n.runWebGLProgram(p,[s],s.dtype),f=new class{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;let t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,a=e.dilationDepth,i=e.dilationHeight,s=e.dilationWidth,o=e.effectiveFilterDepth,l=e.effectiveFilterHeight,u=e.effectiveFilterWidth,d=o-1-e.padInfo.front,c=l-1-e.padInfo.top,p=u-1-e.padInfo.left,h=o*l*u-1;this.userCode=`\n      const ivec3 pads = ivec3(${d}, ${c}, ${p});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ${o};\n           wD += ${a}) {\n          float dyD = float(dyDCorner + wD) / ${t}.0;\n\n          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ${l};\n              wR += ${i}) {\n            float dyR = float(dyRCorner + wR) / ${n}.0;\n\n            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ${u};\n                wC += ${s}) {\n              float dyC = float(dyCCorner + wC) / ${r}.0;\n\n              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ${h} -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ${l} * ${u} +\n                  wR * ${u} + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}(c),m=n.runWebGLProgram(f,[a,h],s.dtype);return n.disposeIntermediateTensorInfo(h),m}},tne={kernelName:wN,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i,output:s}=t,o=i;V5([i,s],"maxPoolGrad");let{filterSize:l,strides:u,pad:d,dimRoundingMode:c}=r,p=_P.computePool2DInfo(o.shape,l,u,1,d,c),h=new k9(p,"max",!0),f=n.runWebGLProgram(h,[o],o.dtype),m=new class{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;let t=e.strideHeight,n=e.strideWidth,r=e.dilationHeight,a=e.effectiveFilterHeight,i=e.effectiveFilterWidth,s=a-1-e.padInfo.top,o=i-1-e.padInfo.left,l=a*i-1;this.userCode=`\n      const ivec2 pads = ivec2(${s}, ${o});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${a};\n          wR += ${r}) {\n          float dyR = float(dyRCorner + wR) / ${t}.0;\n\n          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ${i}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${n}.0;\n\n            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ${l} - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ${i} + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}(p),g=n.runWebGLProgram(m,[a,f],o.dtype);return n.disposeIntermediateTensorInfo(f),g}},nne={kernelName:IN,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{x:r}=e,{filterSize:a,strides:i,pad:s,includeBatchInIndex:o}=t,l=n;pT.assert(4===r.shape.length,(()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`));let u=[1,1];pT.assert(_P.eitherStridesOrDilationsAreOne(i,u),(()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`));let d=_P.computePool2DInfo(r.shape,a,i,u,s),[c,p]=function(e,t,n,r){let a=new k9(n,"max",!1),i=r.runWebGLProgram(a,[e],"float32");return a=new k9(n,"max",!0,!0,t),[i,r.runWebGLProgram(a,[e],"float32")]}(r,o,d,l);return[c,p]}},rne={kernelName:NN,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{x:r}=e,{keepDims:a,axis:i}=t,s=n,o=r.shape.length,l=pT.parseAxisParam(i,r.shape),u=l,d=_P.getAxesPermutation(u,o),c=null!=d,p=s.shouldExecuteOnCPU([r]),h=[],f=r;if(c){if(p){let e=s.texData.get(f.dataId).values,t=new Array(o);for(let a=0;a<t.length;a++)t[a]=r.shape[d[a]];let n=R8(e,r.shape,r.dtype,d,t);f=s.makeTensorInfo(t,r.dtype),s.texData.get(f.dataId).values=n}else f=z7(r,d,s);h.push(f),u=_P.getInnerMostAxes(u.length,o)}_P.assertAxesAreInnerMostDims("sum",u,o);let[m,g]=_P.computeOutAndReduceShapes(f.shape,u),b=m;a&&(b=_P.expandShapeToKeepDim(m,l));let y=function(e,t,n,r){let a=pT.sizeFromShape(t),i=R7({inputs:{x:e},attrs:{shape:[pT.sizeFromShape(e.shape)/a,a]},backend:r}),s=O7(i,"float32","mean",r),o=R7({inputs:{x:s},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(s),o}(f,g,b,s);for(let v of h)s.disposeIntermediateTensorInfo(v);return y}},ane={kernelName:CN,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:s}=r,o=a.shape.length,l=pT.parseAxisParam(i,a.shape),u=l,d=_P.getAxesPermutation(u,o),c=a;null!=d&&(c=V7({inputs:{x:a},backend:n,attrs:{perm:d}}),u=_P.getInnerMostAxes(u.length,a.shape.length)),_P.assertAxesAreInnerMostDims("min",u,o);let p,[h,f]=_P.computeOutAndReduceShapes(c.shape,u),m=R7({inputs:{x:c},backend:n,attrs:{shape:[-1,pT.sizeFromShape(f)]}}),g=O7(m,m.dtype,"min",n);return p=R7(s?{inputs:{x:g},backend:n,attrs:{shape:_P.expandShapeToKeepDim(h,l)}}:{inputs:{x:g},backend:n,attrs:{shape:h}}),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),null!=d&&n.disposeIntermediateTensorInfo(c),p}},ine=I7({opSnippet:l7+"\n  return min(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(min(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+d7+"\n  return result;\n",cpuKernelImpl:s8}),sne={kernelName:TN,backendName:"webgl",kernelFunc:ine},one={kernelName:EN,backendName:"webgl",kernelFunc:({inputs:e,backend:t,attrs:n})=>{let{x:r}=e,{paddings:a,mode:i}=n,s=$S().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new class{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map(((t,n)=>t[0]+e[n]+t[1]));let r=e.length,a=s6(r),i=t.map((e=>e[0])).join(","),s=t.map(((t,n)=>t[0]+e[n])).join(","),o=M8("rc",r),l=M8("source",r),u=`${o[r-1]} < ${this.outputShape[r-1]}`,d=1===r?"source":`vec2(${l.slice(-2).join()})`,c="reflect"===n?0:1,p="";if(1===r){let e=`\n        ${a} source = rc;\n        if (source < start) {\n          source = start * 2 - source - ${c};\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ${c};\n        }\n        source -= start;\n      `;p=`\n        ${a} rc = outputLoc;\n        ${e}\n        result[0] = getChannel(getX(${l.join()}), ${d});\n        ${o[r-1]} += 1;\n        if(${u}) {\n          ${e}\n          result[1] = getChannel(getX(${l.join()}), ${d});\n        }\n      `}else{let e=`\n        ${a} source = rc;\n        ${a} lt = ${a}(lessThan(source, start));\n        ${a} gte = ${a}(greaterThanEqual(source, end));\n        ${a} orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ${c}) +\n                gte * ((end - 1) * 2 - source + ${c});\n        source -= start;\n      `;p=`\n        ${a} rc = outputLoc;\n        ${e}\n        result[0] = getChannel(getX(${l.join()}), ${d});\n        ${o[r-1]} += 1;\n        if(${u}) {\n          ${e}\n          result[1] = getChannel(getX(${l.join()}), ${d});\n        }\n        rc = outputLoc;\n        ${o[r-2]} += 1;\n        if(${o[r-2]} < ${this.outputShape[r-2]}) {\n          ${e}\n          result[2] = getChannel(getX(${l.join()}), ${d});\n          ${o[r-1]} += 1;\n          if(${u}) {\n            ${e}\n            result[3] = getChannel(getX(${l.join()}), ${d});\n          }\n        }\n      `}this.userCode=`\n      const ${a} start = ${a}(${i});\n      const ${a} end = ${a}(${s});\n\n      void main() {\n        ${a} outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ${p}\n        setOutput(result);\n      }\n    `}}(r.shape,a,i):new class{constructor(e,t,n){this.variableNames=["x"],this.outputShape=t.map(((t,n)=>t[0]+e[n]+t[1]));let r=e.length,a=s6(r),i=t.map((e=>e[0])).join(","),s=t.map(((t,n)=>t[0]+e[n])).join(","),o=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),l="reflect"===n?0:1;this.userCode=1!==r?`\n      ${a} start = ${a}(${i});\n      ${a} end = ${a}(${s});\n\n      void main() {\n        ${a} outC = getOutputCoords();\n        for (int i = 0; i < ${r}; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ${l};\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ${l};\n          }\n        }\n        ${a} coords = outC - start;\n        setOutput(getX(${o}));\n      }\n    `:`\n        int start = ${i};\n        int end = ${s};\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ${l};\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ${l};\n          }\n          setOutput(getX(outC - start));\n        }\n      `}}(r.shape,a,i);return t.runWebGLProgram(s,[r],r.dtype)}},lne=I7({opSnippet:"if (b == 0.0) return NAN;\n  return mod(a, b);",packedOpSnippet:"\n  vec4 result = mod(a, b);\n  bvec4 isNaN = equal(b, vec4(0.0));\n  "+d7+"\n  return result;\n"}),une={kernelName:_N,backendName:"webgl",kernelFunc:lne},dne=I7({opSnippet:"\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",packedOpSnippet:"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",checkOutOfBounds:!0}),cne={kernelName:RI,backendName:"webgl",kernelFunc:dne},pne="return a - b;",hne=I7({opSnippet:pne,packedOpSnippet:pne,supportsComplex:!0,cpuKernelImpl:_8}),fne={kernelName:MC,backendName:"webgl",kernelFunc:hne};function mne(e){let{inputs:t,backend:n,attrs:r}=e,{logits:a}=t,{dim:i}=r,s=pT.parseAxisParam([i],a.shape),o=Kte({inputs:{x:a},backend:n,attrs:{reductionIndices:s,keepDims:!1}}),l=_P.expandShapeToKeepDim(o.shape,s),u=R7({inputs:{x:o},backend:n,attrs:{shape:l}}),d=hne({inputs:{a:a,b:u},backend:n}),c=Gee({inputs:{x:d},backend:n}),p=B7({inputs:{x:c},backend:n,attrs:{axis:s,keepDims:!1}}),h=R7({inputs:{x:p},backend:n,attrs:{shape:l}}),f=dne({inputs:{a:c,b:h},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h),f}var gne={kernelName:kC,backendName:"webgl",kernelFunc:mne},bne={kernelName:$N,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{logits:a}=t,{numSamples:i,seed:s,normalized:o}=r,l=o?a:mne({inputs:{logits:a},backend:n,attrs:{dim:a.shape.length-1}}),u=l.shape[0],d=l.shape[1],c=new class{constructor(e,t,n){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,n],this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ${t-1}; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(${t-1}));\n      }\n    `}}(u,d,i),p=[[s]],h=n.runWebGLProgram(c,[l],"int32",p);return o||n.disposeIntermediateTensorInfo(l),h}},yne=W8+"\n  return -x;\n",vne={kernelName:RN,backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:r}=e,{x:a}=n;if(r.shouldExecuteOnCPU([a])){let e=r.texData.get(a.dataId),[t,n]=l8(e.values,a.shape,a.dtype);return r.makeTensorInfo(n,a.dtype,t)}return t=$S().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new e7(a.shape,"\n  vec4 result = -x;\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"):new B8(a.shape,yne),r.runWebGLProgram(t,[a],a.dtype)}},xne=ML.nonMaxSuppressionV3Impl,wne={kernelName:FN,backendName:"webgl",kernelFunc:function(e){_P.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:i}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l}=r,u=n.readSync(a.dataId),d=n.readSync(i.dataId),{selectedIndices:c}=xne(u,d,s,o,l);return n.makeTensorInfo([c.length],"int32",new Int32Array(c))}},kne=ML.nonMaxSuppressionV4Impl,Sne={kernelName:MN,backendName:"webgl",kernelFunc:function(e){_P.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:i}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:u}=r,d=n.readSync(a.dataId),c=n.readSync(i.dataId),{selectedIndices:p,validOutputs:h}=kne(d,c,s,o,l,u);return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([],"int32",new Int32Array([h]))]}},Ine=ML.nonMaxSuppressionV5Impl,Nne={kernelName:ON,backendName:"webgl",kernelFunc:function(e){_P.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:i}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l,softNmsSigma:u}=r,d=n.readSync(a.dataId),c=n.readSync(i.dataId),p=s,h=o,f=l,m=u,{selectedIndices:g,selectedScores:b}=Ine(d,c,p,h,f,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([b.length],"float32",new Float32Array(b))]}},Cne={kernelName:LN,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e,{indices:a}=t,{dtype:i,depth:s,onValue:o,offValue:l}=r,u=pT.sizeFromShape(a.shape),d=new class{constructor(e,t,n,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(${r}), float(${n}),\n                      float(index == coords.y)));\n      }\n    `}}(u,s,o,l),c=R7({inputs:{x:a},backend:n,attrs:{shape:[u]}}),p=n.runWebGLProgram(d,[c],i);n.disposeIntermediateTensorInfo(c);let h=R7({inputs:{x:p},backend:n,attrs:{shape:[...a.shape,s]}});return n.disposeIntermediateTensorInfo(p),h}};function Tne(e){let{inputs:t,backend:n}=e,{x:r}=t;if("complex64"===r.dtype){let e=W9({inputs:{input:r},backend:n}),t=Tne({inputs:{x:e},backend:n}),a=eee({inputs:{input:r},backend:n}),i=Tne({inputs:{x:a},backend:n}),s=f7({inputs:{real:t,imag:i},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),s}return rte({attrs:{shape:r.shape,dtype:r.dtype,value:"string"===r.dtype?"":0},backend:n})}var Ene={kernelName:GC,backendName:"webgl",kernelFunc:Tne},_ne={kernelName:PN,backendName:"webgl",kernelFunc:function e(t){let{inputs:n,backend:r}=t,{x:a}=n;if("string"===a.dtype)throw new Error("onesLike is not supported under string dtype");if("complex64"===a.dtype){let t=W9({inputs:{input:a},backend:r}),n=e({inputs:{x:t},backend:r}),i=eee({inputs:{input:a},backend:r}),s=Tne({inputs:{x:i},backend:r}),o=f7({inputs:{real:n,imag:s},backend:r});return r.disposeIntermediateTensorInfo(t),r.disposeIntermediateTensorInfo(n),r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(s),o}return rte({attrs:{shape:a.shape,dtype:a.dtype,value:1},backend:r})}},$ne={kernelName:zN,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{axis:a}=r;if(1===t.length)return Kee({inputs:{input:t[0]},backend:n,attrs:{dim:a}});let i=t[0].shape,s=t[0].dtype;t.forEach((e=>{pT.assertShapesMatch(i,e.shape,"All tensors passed to stack must have matching shapes"),pT.assert(s===e.dtype,(()=>"All tensors passed to stack must have matching dtypes"))}));let o=[],l=t.map((e=>{let t=Kee({inputs:{input:e},backend:n,attrs:{dim:a}});return o.push(t),t})),u=ree({inputs:l,backend:n,attrs:{axis:a}});return o.forEach((e=>n.disposeIntermediateTensorInfo(e))),u}},Ane=e=>{let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{paddings:i,constantValue:s}=r;if(0===pT.sizeFromShape(a.shape)){let e=i.map(((e,t)=>e[0]+a.shape[t]+e[1]));return rte({backend:n,attrs:{shape:e,value:s,dtype:a.dtype}})}let o=$S().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new class{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map(((t,n)=>t[0]+e[n]+t[1]));let r=e.length,a=s6(r),i=t.map((e=>e[0])).join(","),s=t.map(((t,n)=>t[0]+e[n])).join(","),o=M8("rc",r),l=M8("source",r),u=`${o[r-1]} < ${this.outputShape[r-1]}`,d=1===r?"source":`vec2(${l.slice(-2).join()})`,c=[`${a} rc = outputLoc;`,`${o[r-1]} += 1;\n       if(${u}) {\n      `,1===r?"":`}\n       rc = outputLoc;\n       ${o[r-2]} += 1;\n       if(${o[r-2]} < ${this.outputShape[r-2]}) {`,1===r?"":`  ${o[r-1]} += 1;\n         if(${u}) {`],p=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",h="";for(let f=0,m=1===r?2:4;f<m;f++)h+=`\n        ${c[f]}\n        if (${p}) {\n          result[${f}] = float(value);\n        } else {\n          ${a} source = rc - start;\n          result[${f}] = getChannel(getX(${l.join()}), ${d});\n        }\n      `;h+=1===r?"} ":"}}",this.userCode=`\n      const ${a} start = ${a}(${i});\n      const ${a} end = ${a}(${s});\n\n      void main() {\n        ${a} outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ${h}\n        setOutput(result);\n      }\n    `}}(a.shape,i,s):new class{constructor(e,t,n){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map(((t,n)=>t[0]+e[n]+t[1]));let r=e.length,a=s6(r),i=t.map((e=>e[0])).join(","),s=t.map(((t,n)=>t[0]+e[n])).join(","),o=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?`\n      ${a} start = ${a}(${i});\n      ${a} end = ${a}(${s});\n\n      void main() {\n        ${a} outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(value);\n        } else {\n          ${a} coords = outC - start;\n          setOutput(getX(${o}));\n        }\n      }\n    `:`\n        int start = ${i};\n        int end = ${s};\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(value);\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      `}}(a.shape,i,s),l=[[s]];return n.runWebGLProgram(o,[a],a.dtype,l)},Rne={kernelName:BN,backendName:"webgl",kernelFunc:Ane},Dne=I7({opSnippet:"\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",packedOpSnippet:"\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  bvec4 isNaN1 = lessThan(a, vec4(0.0));\n  bvec4 isNaN2 = lessThan(floor(b), b);\n  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);\n  "+d7+"\n  return result;\n"}),Fne={kernelName:VN,backendName:"webgl",kernelFunc:Dne},Mne={kernelName:jN,backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:r,attrs:a}=e,{x:i}=n,{axis:s,keepDims:o}=a,l=i.shape.length,u=[],d=pT.parseAxisParam(s,i.shape),c=d,p=_P.getAxesPermutation(c,l),h=i;if(null!=p&&(h=V7({inputs:{x:i},backend:r,attrs:{perm:p}}),c=_P.getInnerMostAxes(c.length,l),u.push(h)),_P.assertAxesAreInnerMostDims("prod",c,l),r.shouldExecuteOnCPU([h])){let e=r.texData.get(h.dataId).values,{outVals:n,outShape:a,outDtype:i}=d8(h.shape,h.dtype,e,c);t=r.makeTensorInfo(a,i,n)}else{let[e,n]=_P.computeOutAndReduceShapes(h.shape,c),a=pT.sizeFromShape(n),s=R7({inputs:{x:h},backend:r,attrs:{shape:[-1,a]}}),o=O7(s,sE(i.dtype),"prod",r);t=R7({inputs:{x:o},backend:r,attrs:{shape:e}}),u.push(s),u.push(o)}if(o){u.push(t);let e=_P.expandShapeToKeepDim(t.shape,d);t=R7({inputs:{x:t},backend:r,attrs:{shape:e}})}return u.forEach((e=>r.disposeIntermediateTensorInfo(e))),t}},One={kernelName:HN,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{paramsNestedSplits:a,paramsDenseValues:i,indices:s}=t,{outputRaggedRank:o}=r,l=a.map((e=>n.readSync(e.dataId))),u=a.map((e=>e.shape)),d=n.readSync(i.dataId),c=n.readSync(s.dataId),[p,h,f]=c8(l,u,d,i.shape,i.dtype,c,s.shape,o),m=p.map((e=>n.makeTensorInfo([e.length],"int32",e))),g=n.makeTensorInfo(f,i.dtype,h);return m.concat([g])}},Pne={kernelName:GN,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{starts:r,limits:a,deltas:i}=t,s=n.readSync(r.dataId),o=n.readSync(a.dataId),l=n.readSync(i.dataId),[u,d]=p8(s,r.shape,r.dtype,o,a.shape,l,i.shape);return[n.makeTensorInfo([u.length],"int32",u),n.makeTensorInfo([d.length],r.dtype,d)]}},Lne={kernelName:qN,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{shape:a,values:i,defaultValue:s,rowPartitionTensors:o}=t,{rowPartitionTypes:l}=r,u=n.readSync(a.dataId),d=n.readSync(i.dataId),c=n.readSync(s.dataId),p=o.map((e=>n.readSync(e.dataId))),h=o.map((e=>e.shape)),[f,m]=h8(u,a.shape,d,i.shape,i.dtype,c,s.shape,p,h,l);return n.makeTensorInfo(f,i.dtype,m)}},zne=e=>{let{backend:t,attrs:n}=e,{start:r,stop:a,step:i,dtype:s}=n,o=f8(r,a,i,s);return t.makeTensorInfo([o.length],s,o)},Bne={kernelName:KN,backendName:"webgl",kernelFunc:zne},Wne=S7({opSnippet:"return 1.0 / x;"}),Vne={kernelName:YN,backendName:"webgl",kernelFunc:Wne},Une=S7({opSnippet:W8+"\n  return (x < 0.0) ? 0.0 : x;\n",packedOpSnippet:"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),jne={kernelName:JN,backendName:"webgl",kernelFunc:Une},Hne=S7({opSnippet:W8+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",packedOpSnippet:"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),Gne={kernelName:rC,backendName:"webgl",kernelFunc:Hne},qne={kernelName:tC,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{images:a}=t,{alignCorners:i,halfPixelCenters:s,size:o}=r,[l,u]=o,d=$S().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new class{constructor(e,t,n,r,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];let[i,s,o,l]=e;this.outputShape=[i,t,n,l];let u,d=[r&&t>1?s-1:s,r&&n>1?o-1:o],c=[r&&t>1?t-1:t,r&&n>1?n-1:n];u=a?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ${d[0]/c[0]},\n          ${d[1]/c[1]},\n          ${d[1]/c[1]});\n      const vec3 inputShapeRC = vec3(${s}.0, ${o}.0,\n                                     ${o}.0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ${u};\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ${l-1};\n        bool hasNextRow = coords.z < ${n-1};\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    `}}(a.shape,l,u,i,s):new class{constructor(e,t,n,r,a){this.variableNames=["A"],this.outputShape=[];let[i,s,o,l]=e;this.outputShape=[i,t,n,l];let u,d=[r&&t>1?s-1:s,r&&n>1?o-1:o],c=[r&&t>1?t-1:t,r&&n>1?n-1:n];u=a?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ${d[0]/c[0]},\n          ${d[1]/c[1]});\n      const vec2 inputShapeRC = vec2(${s}.0, ${o}.0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ${u};\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    `}}(a.shape,l,u,i,s);return n.runWebGLProgram(d,[a],"float32")}},Kne={kernelName:nC,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{images:a,dy:i}=t,{alignCorners:s}=r,o=new class{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;let[,r,a]=t,[,i,s]=e,o=[n&&i>1?r-1:r,n&&s>1?a-1:a],l=[n&&i>1?i-1:i,n&&s>1?s-1:s],u=o[0]/l[0],d=o[1]/l[1],c=1/u,p=1/d,h=2*Math.ceil(c)+2,f=2*Math.ceil(p)+2;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(${u});\n        const float widthScale = float(${d});\n\n        const float invHeightScale = float(${c});\n        const float invWidthScale = float(${p});\n\n        const int winHeight = int(${h});\n        const int winWidth = int(${f});\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ${i}) {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ${s}) {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ${r-1}.0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ${a-1}.0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    `}}(i.shape,a.shape,s);return n.runWebGLProgram(o,[i],i.dtype)}},Xne={kernelName:QN,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{images:a}=t,{alignCorners:i,halfPixelCenters:s,size:o}=r,[l,u]=o,d=$S().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new class{constructor(e,t,n,r,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];let[i,s,o,l]=e;this.outputShape=[i,t,n,l];let u,d=[r&&t>1?s-1:s,r&&n>1?o-1:o],c=[r&&t>1?t-1:t,r&&n>1?n-1:n],p=r?"0.5":"0.0";u=a?"max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ${d[0]/c[0]},\n          ${d[1]/c[1]},\n          ${d[1]/c[1]});\n      const vec3 inputShapeRC = vec3(${s}.0, ${o}.0,\n                                     ${o}.0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ${u};\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec3 sourceNearestRC = ivec3(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${p})));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ${l-1};\n        bool hasNextRow = coords.z < ${n-1};\n\n        vec4 newValue = vec4(\n          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),\n          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);\n\n        setOutput(newValue);\n      }\n    `}}(a.shape,l,u,i,s):new class{constructor(e,t,n,r,a){this.variableNames=["A"],this.outputShape=[];let[i,s,o,l]=e;this.outputShape=[i,t,n,l];let u,d=[r&&t>1?s-1:s,r&&n>1?o-1:o],c=[r&&t>1?t-1:t,r&&n>1?n-1:n],p=r?"0.5":"0.0";u=a?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ${d[0]/c[0]},\n          ${d[1]/c[1]});\n      const vec2 inputShapeRC = vec2(${s}.0, ${o}.0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ${u};\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${p})));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    `}}(a.shape,l,u,i,s);return n.runWebGLProgram(d,[a],a.dtype)}},Yne={kernelName:eC,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{images:a,dy:i}=t,{alignCorners:s}=r,o=new class{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;let[,r,a]=t,[,i,s]=e,o=[n&&i>1?r-1:r,n&&s>1?a-1:a],l=[n&&i>1?i-1:i,n&&s>1?s-1:s],u=o[0]/l[0],d=o[1]/l[1],c=1/u,p=1/d,h=2*Math.ceil(c)+2,f=2*Math.ceil(p)+2;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(${u});\n        const float widthScale = float(${d});\n\n        const float invHeightScale = float(${c});\n        const float invWidthScale = float(${p});\n\n        const int winHeight = int(${h});\n        const int winWidth = int(${f});\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ${i}) {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ${s}) {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(${o[0]}) *\n                (float(dyR) / float(${l[0]}));\n\n            float sourceFracCol =\n                float(${o[1]}) *\n                  (float(dyC) / float(${l[1]}));\n\n            int sourceNearestRow = int(min(\n                float(int(${r}) - 1),\n                ${n} ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(${a}) - 1),\n                ${n} ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    `}}(i.shape,a.shape,s);return n.runWebGLProgram(o,[i],i.dtype)}},Jne={kernelName:aC,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{dims:i}=r,s=a.shape.length,o=pT.parseAxisParam(i,a.shape);if(0===s)return p7({inputs:{x:a},backend:n});let l=$S().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new class{constructor(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;let n=e.length;if(n>4)throw new Error(`WebGL backend: Reverse of rank-${n} tensor is not yet supported`);this.outputShape=e;let r=M8("rc",n),a=`${r[n-1]} + 1 < ${this.outputShape[n-1]}`,i=`${r[n-2]} + 1 < ${this.outputShape[n-2]}`,s=s6(n);function o(n){let r=e.map(((r,a)=>function(n,r){return-1!==t.indexOf(n)&&1!==e[n]?`${e[n]} - ${r[n]} - 1`:`${r[n]}`}(a,n)));return`getChannel(getX(${r.join(",")}), vec2(${r.slice(-2).join(",")}))`}this.userCode=1===n?`\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(${e[0]} - rc - 1),\n            ${e[0]} - rc - 1);\n          if(${a}){\n              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),\n                ${e[0]} - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      `:`\n        void main() {\n          ${s} rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ${function(e){return o(e)}(r.slice())};\n          if(${a}){\n            result.g = ${function(e){return e[n-1]="("+e[n-1]+" + 1)",o(e)}(r.slice())};\n          }\n          if(${i}) {\n            result.b = ${function(e){return e[n-2]="("+e[n-2]+" + 1)",o(e)}(r.slice())};\n            if(${a}) {\n              result.a = ${function(e){return e[n-1]="("+e[n-1]+" + 1)",e[n-2]="("+e[n-2]+" + 1)",o(e)}(r.slice())};\n            }\n          }\n          setOutput(result);\n        }\n    `}}(a.shape,o):new class{constructor(e,t){this.variableNames=["x"];let n=e.length;if(n>4)throw new Error(`WebGL backend: Reverse of rank-${n} tensor is not yet supported`);if(this.outputShape=e,1===n)return void(this.userCode=`\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(${e[0]} - coord - 1));\n        }\n      `);let r=e.map(((n,r)=>(n=>-1!==t.indexOf(n)&&1!==e[n]?`${e[n]} - coords[${n}] - 1`:`coords[${n}]`)(r))).join(","),a=s6(n);this.userCode=`\n      void main() {\n        ${a} coords = getOutputCoords();\n        setOutput(getX(${r}));\n      }\n    `}}(a.shape,o);return n.runWebGLProgram(l,[a],a.dtype)}},Zne={kernelName:XC,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{image:r}=e,{radians:a,fillValue:i,center:s}=t,o=n,l=new class{constructor(e,t){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];let n=e[1],r=e[2];this.outputShape=e;let a="";a="number"==typeof t?`float outputValue = ${t.toFixed(2)};`:`\n        vec3 fill = vec3(${t.join(",")});\n        float outputValue = fill[coords[3]];`,this.userCode=`\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - params[0]) * params[3] -\n            (float(y) - params[1]) * params[2];\n          float coordYFloat = (float(x) - params[0]) * params[2] +\n            (float(y) - params[1]) * params[3];\n          int coordX = int(round(coordXFloat + params[0]));\n          int coordY = int(round(coordYFloat + params[1]));\n          ${a}\n          if(coordX >= 0 && coordX < ${r} && coordY >= 0 && coordY < ${n}) {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    `}}(r.shape,i),[u,d]=_P.getImageCenter(s,r.shape[1],r.shape[2]),c=[[u,d,Math.sin(a),Math.cos(a)]];return o.runWebGLProgram(l,[r],r.dtype,c)}},Qne=S7({opSnippet:"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n"}),ere={kernelName:iC,backendName:"webgl",kernelFunc:Qne},tre=S7({opSnippet:"return inversesqrt(x);",cpuKernelImpl:m8}),nre={kernelName:sC,backendName:"webgl",kernelFunc:tre},rre=class{constructor(e,t,n,r,a,i,s=!0,o=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;let l=s6(a.length),u=s6(i.length),d="";1===n?d="i":2===n&&(d="i, j");let c=`getIndices(${d})`,p="";1===r?p="i":2===r&&(p="i, coords[1]");let h=`getUpdates(${p})`,f="";o&&(f="coords[0], coords[1]");let m=`getDefaultValue(${f})`,g=t>1?"strides[j]":"strides";this.userCode=`\n        ${l} strides = ${l}(${a});\n\n        void main() {\n          ${u} coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ${e}; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ${t}; j++) {\n              int index = round(${c});\n              flattenedIndex += index * ${g};\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ${h};\n              found = true;\n            }\n          }\n          setOutput(mix(${m}, sum, float(found)));\n        }\n      `}},are={kernelName:oC,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{indices:a,updates:i}=t,{shape:s}=r,{sliceRank:o,numUpdates:l,sliceSize:u,strides:d,outputSize:c}=_P.calculateShapes(i,a,s),p=[c/u,u];if(0===c)return n.makeTensorInfo(s,a.dtype);let h,f=R7({inputs:{x:a},backend:n,attrs:{shape:[l,o]}}),m=R7({inputs:{x:i},backend:n,attrs:{shape:[l,u]}}),g=n.makeTensorInfo([],"float32",new Float32Array([0]));h=$S().getBool("WEBGL_PACK")?new class{constructor(e,t,n,r,a,i,s=!0,o=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=i;let l=s6(a.length),u=s6(i.length),d="";1===n?d="i":2===n&&(d="i, j");let c=`getIndices(${d})`,p="";1===r?p="i":2===r&&(p="i, coords[1]");let h=`getUpdates(${p})`,f="";o&&(f="coords[0], coords[1]");let m=`getDefaultValue(${f})`,g=t>1?"strides[j]":"strides",b=t>1?"strides[j + 1]":"strides";this.userCode=`\n        ${l} strides = ${l}(${a});\n\n        void main() {\n          ${u} coords = getOutputCoords();\n          vec4 sum = vec4(0.);\n          vec4 found = vec4(0.);\n          for (int i = 0; i < ${e}; i+=2) {\n            ivec2 flattenedIndex = ivec2(0);\n            for (int j = 0; j < ${t}; j+=2) {\n              ivec4 index = round(${c});\n              flattenedIndex += index.xz * ${g};\n              if (j + 1 < ${t}) {\n                flattenedIndex += index.yw * ${b};\n              }\n            }\n            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||\n                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {\n              vec4 updVals = ${h};\n              if (flattenedIndex[0] == coords[0]) {\n                sum.xy += updVals.xy;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[0] == coords[0] + 1) {\n                sum.zw += updVals.xy;\n                found.zw = vec2(1.);\n              }\n              if (flattenedIndex[1] == coords[0]) {\n                sum.xy += updVals.zw;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[1] == coords[0] + 1) {\n                sum.zw += updVals.zw;\n                found.zw = vec2(1.);\n              }\n            }\n          }\n          setOutput(mix(${m}, sum, found));\n        }\n      `}}(l,o,f.shape.length,m.shape.length,d,p):new rre(l,o,f.shape.length,m.shape.length,d,p);let b=n.runWebGLProgram(h,[m,f,g],m.dtype),y=R7({inputs:{x:b},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(g),y}},ire={kernelName:uC,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{sortedSequence:a,values:i}=t,{side:s}=r,o=new class{constructor(e,t,n,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,n];let a=`for (int i = 0; i < ${Math.ceil(Math.log2(t+1))}; ++i) { if (left >= right) break;`,i=2===$S().getNumber("WEBGL_VERSION")?"while (left < right) {":a,s="left"===r?"<":"<=";this.userCode=`\n       int findBound(int batch, float value) {\n         int left = 0;\n         int right = numInputs;\n         int mid;\n         ${i}\n           mid = (left + right) / 2;\n           if (getSortedSequence(batch, mid) ${s} value) {\n             left = mid + 1;\n           } else {\n             right = mid;\n           }\n         }\n         return right;\n       }\n\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int valueIndex = coords[1];\n\n         float value = getValues(batch, valueIndex);\n\n         setOutput(float(findBound(batch, value)));\n       }\n     `}}(a.shape[0],a.shape[1],i.shape[1],s),l=[[a.shape[1]]];return n.runWebGLProgram(o,[a,i],"int32",l)}},sre={kernelName:dC,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{condition:r,t:a,e:i}=t,s=new class{constructor(e,t,n){let r,a;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error(`Where for rank ${n} is not yet supported`);if(1===n)a="resRC",r="resRC";else{let n=["resRC.x","resRC.y","resRC.z","resRC.w"],i=[],s=[];for(let r=0;r<t.length;r++)s.push(`${n[r]}`),r<e&&i.push(`${n[r]}`);r=i.join(),a=s.join()}let i=s6(n);this.userCode=`\n      void main() {\n        ${i} resRC = getOutputCoords();\n        float cVal = getC(${r});\n        if (cVal >= 1.0) {\n          setOutput(getA(${a}));\n        } else {\n          setOutput(getB(${a}));\n        }\n      }\n    `}}(r.shape.length,a.shape,a.shape.length);return n.runWebGLProgram(s,[r,a,i],iE(a.dtype,i.dtype))}},ore=S7({opSnippet:`\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ${_P.SELU_SCALEALPHA};\n  float scale = ${_P.SELU_SCALE};\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n`}),lre={kernelName:cC,backendName:"webgl",kernelFunc:ore},ure=S7({opSnippet:k7+"\n  return 1.0 / (1.0 + exp(-1.0 * x));\n",packedOpSnippet:"\n  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:b8}),dre={kernelName:gC,backendName:"webgl",kernelFunc:ure},cre=S7({opSnippet:"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n"}),pre={kernelName:mC,backendName:"webgl",kernelFunc:cre},hre=S7({opSnippet:k7+"\n  return sin(x);\n",packedOpSnippet:`\n  vec4 result = sin(x);\n  bvec4 isNaN = isnan(x);\n  ${d7}\n  return result;\n`}),fre={kernelName:hC,backendName:"webgl",kernelFunc:hre},mre=S7({opSnippet:"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n"}),gre={kernelName:fC,backendName:"webgl",kernelFunc:mre},bre=S7({opSnippet:"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n"}),yre={kernelName:bC,backendName:"webgl",kernelFunc:bre},vre={kernelName:xC,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:i,paddings:s}=r;pT.assert(a.shape.length<=4,(()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"));let o=i.reduce(((e,t)=>e*t)),l=[[0,0]];l.push(...s);for(let b=1+i.length;b<a.shape.length;++b)l.push([0,0]);let u=[],d=Ane({inputs:{x:a},backend:n,attrs:{paddings:l,constantValue:0}}),c=_P.getReshaped(d.shape,i,o,!1),p=_P.getPermuted(c.length,i.length,!1),h=_P.getReshapedPermuted(d.shape,i,o,!1),f=R7({inputs:{x:d},backend:n,attrs:{shape:c}}),m=V7({inputs:{x:f},backend:n,attrs:{perm:p}}),g=R7({inputs:{x:m},backend:n,attrs:{shape:h}});return u.push(d),u.push(f),u.push(m),u.forEach((e=>n.disposeIntermediateTensorInfo(e))),g}},xre={kernelName:SC,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{indices:r,values:a,denseShape:i,defaultValue:s}=t;if(1!==i.shape.length)throw new Error(`Dense shape must be a vector, saw:\n         ${i.shape}`);if(2!==r.shape.length)throw new Error(`Indices must be a matrix, saw:\n         ${r.shape}`);if(1!==a.shape.length)throw new Error(`Values must be a vector, saw:\n         ${a.shape}`);if(0!==s.shape.length)throw new Error(`Default value must be a scalar, saw:\n        ${s.shape}`);let o=n.readSync(r.dataId),l=n.readSync(a.dataId),u=n.readSync(i.dataId),d=n.readSync(s.dataId)[0],[c,p,h,f,m]=x8(o,r.shape,r.dtype,l,a.dtype,u,d);return[n.makeTensorInfo(p,r.dtype,c),n.makeTensorInfo([p[0]],a.dtype,h),n.makeTensorInfo([f.length],"bool",new Uint8Array(f.map((e=>Number(e))))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}},wre={kernelName:IC,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{inputIndices:r,inputShape:a,newShape:i}=t;if(2!==r.shape.length)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(1!==a.shape.length)throw new Error(`Input shape should be a vector but received shape ${a.shape}`);if(1!==i.shape.length)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);let s=Array.from(n.readSync(a.dataId)),o=n.readSync(r.dataId),l=Array.from(n.readSync(i.dataId)),[u,d,c]=w8(o,r.shape,r.dtype,s,l);return[n.makeTensorInfo(d,r.dtype,u),n.makeTensorInfo([c.length],i.dtype,new Int32Array(c))]}},kre={kernelName:NC,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{data:r,indices:a,segmentIds:i}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error(`Indices should be a vector but received shape\n              ${a.shape}`);if(1!==i.shape.length)throw new Error(`Segment ids should be a vector but received shape\n              ${i.shape}`);let s=n.readSync(r.dataId),o=n.readSync(a.dataId),l=n.readSync(i.dataId),[u,d]=k8(s,r.shape,r.dtype,o,l,!0);return n.makeTensorInfo(d,r.dtype,u)}},Sre={kernelName:CC,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{data:r,indices:a,segmentIds:i}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error(`Indices should be a vector but received shape\n             ${a.shape}`);if(1!==i.shape.length)throw new Error(`Segment ids should be a vector but received shape\n             ${i.shape}`);let s=n.readSync(r.dataId),o=n.readSync(a.dataId),l=n.readSync(i.dataId),[u,d]=k8(s,r.shape,r.dtype,o,l);return n.makeTensorInfo(d,r.dtype,u)}},Ire={kernelName:TC,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{sparseIndices:a,sparseValues:i,defaultValue:s}=t,{outputShape:o}=r,{sliceRank:l,numUpdates:u,sliceSize:d,strides:c,outputSize:p}=_P.calculateShapes(i,a,o);if("string"===i.dtype){let e=n.bufferSync(a),t=n.bufferSync(i),r=pT.decodeString(n.readSync(s.dataId)[0]),h=g8(e,t,o,p,d,u,l,c,r,!1);return n.makeTensorInfo(o,h.dtype,h.values)}let h=new rre(u,l,a.shape.length,i.shape.length,c,[p,1],!1),f=n.runWebGLProgram(h,[i,a,s],i.dtype),m=R7({inputs:{x:f},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(f),m}},Nre={kernelName:wC,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{numOrSizeSplits:i,axis:s}=r,o=pT.parseAxisParam(s,a.shape)[0],l=_P.prepareSplitSize(a,i,o),u=a.shape.length,d=new Array(u).fill(0),c=a.shape.slice();return l.map((e=>{let t=[...c];t[o]=e;let r=D9({inputs:{x:a},backend:n,attrs:{begin:d,size:t}});return d[o]+=e,r}))}},Cre="return sqrt(x);",Tre=S7({opSnippet:Cre,packedOpSnippet:Cre,cpuKernelImpl:S8}),Ere={kernelName:yC,backendName:"webgl",kernelFunc:Tre},_re=S7({opSnippet:"return x * x;"}),$re={kernelName:_C,backendName:"webgl",kernelFunc:_re},Are="return (a - b) * (a - b);",Rre=I7({opSnippet:Are,packedOpSnippet:Are}),Dre={kernelName:EC,backendName:"webgl",kernelFunc:Rre},Fre={kernelName:$C,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t;if("string"!==a.dtype)throw new Error("Input must be of datatype string");let i=n.readSync(a.dataId),s=_P.fromUint8ToStringArray(i),o=I8(s,"string",r);return n.makeTensorInfo(a.shape,"string",o)}},Mre={kernelName:qC,backendName:"webgl",kernelFunc:function({inputs:e,attrs:t,backend:n}){let{x:r}=e,a=W8+`\n    return x > 0.0 ? 1.0 : float(${t.alpha});\n  `,i=new B8(r.shape,a);return n.runWebGLProgram(i,[r],r.dtype)}},Ore={kernelName:AC,backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:r,attrs:a}=e,{x:i}=n,{begin:s,end:o,strides:l,beginMask:u,endMask:d,ellipsisMask:c,newAxisMask:p,shrinkAxisMask:h}=a,{finalShapeSparse:f,finalShape:m,isIdentity:g,sliceDim0:b,isSimpleSlice:y,begin:v,end:x,strides:w}=rP.sliceInfo(i.shape,s,o,l,u,d,c,p,h);if(g)t=R7({inputs:{x:i},backend:r,attrs:{shape:m}});else if(b||y){pT.assert(i.shape.length>=1,(()=>`Input must have rank at least 1, got: ${i.shape.length}`));let e=rP.computeOutShape(v,x,w),n=D9({inputs:{x:i},backend:r,attrs:{begin:v,size:e}});t=R7({inputs:{x:n},backend:r,attrs:{shape:m}}),r.disposeIntermediateTensorInfo(n)}else if(r.shouldExecuteOnCPU([i])){let e=r.readSync(i.dataId),n=R_(i.shape,i.dtype,e),a=N8(f,n,w,v);t=r.makeTensorInfo(m,i.dtype,a.values)}else{let e=new class{constructor(e,t,n){this.variableNames=["x"],this.outputShape=n;let r=n.length,a=s6(n.length),i=s6(n.length),s="";if(1===r)s="coords * strides + begin";else{let e=0;s=n.map(((t,r)=>(e++,1===n.length?`coords * strides[${r}] + begin[${r}]`:`coords[${e-1}] * strides[${r}] + begin[${r}]`))).join(",")}this.userCode=`\n      ${a} begin = ${a}(${e});\n      ${a} strides = ${a}(${t});\n\n      void main() {\n        ${i} coords = getOutputCoords();\n        setOutput(getX(${s}));\n      }\n    `}}(v,w,f);t=r.runWebGLProgram(e,[i],i.dtype)}let k=R7({inputs:{x:t},backend:r,attrs:{shape:m}});return r.disposeIntermediateTensorInfo(t),k}},Pre={kernelName:RC,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{separator:a,nGramWidths:i,leftPad:s,rightPad:o,padWidth:l,preserveShortSequences:u}=r,{data:d,dataSplits:c}=t,p=n.readSync(d.dataId),h=n.readSync(c.dataId),[f,m]=C8(p,h,a,i,s,o,l,u);return[n.makeTensorInfo([f.length],"string",f),n.makeTensorInfo(c.shape,"int32",m)]}},Lre={kernelName:DC,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{skipEmpty:a}=r,{input:i,delimiter:s}=t;if("string"!==i.dtype)throw new Error("Input must be of datatype string");if(1!==i.shape.length)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(0!==s.shape.length)throw new Error(`Delimiter must be a scalar, got shape: ${s.shape}`);let o=n.readSync(i.dataId),l=n.readSync(s.dataId)[0],[u,d,c]=T8(o,l,a),p=d.length;return[n.makeTensorInfo([p,2],"int32",u),n.makeTensorInfo([p],"string",d),n.makeTensorInfo([2],"int32",new Int32Array(c))]}},zre={kernelName:FC,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{numBuckets:a}=r,{input:i}=t;if("string"!==i.dtype)throw new Error("Input must be of datatype string");if(a<=0)throw new Error("Number of buckets must be at least 1");let s=n.readSync(i.dataId),o=E8(s,a);return n.makeTensorInfo(i.shape,"int32",o)}},Bre=S7({opSnippet:"return tan(x);"}),Wre={kernelName:OC,backendName:"webgl",kernelFunc:Bre},Vre=S7({opSnippet:"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n"}),Ure={kernelName:PC,backendName:"webgl",kernelFunc:Vre},jre={kernelName:lC,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{tensor:a,indices:i,updates:s}=t,{sliceRank:o,numUpdates:l,sliceSize:u,strides:d,outputSize:c}=_P.calculateShapes(s,i,a.shape),p=[c/u,u];if(0===c)return n.makeTensorInfo(a.shape,i.dtype);let h=R7({inputs:{x:i},backend:n,attrs:{shape:[l,o]}}),f=R7({inputs:{x:s},backend:n,attrs:{shape:[l,u]}}),m=R7({inputs:{x:a},backend:n,attrs:{shape:p}}),g=new rre(l,o,h.shape.length,f.shape.length,d,p,!1,!0),b=n.runWebGLProgram(g,[f,h,m],m.dtype),y=R7({inputs:{x:b},backend:n,attrs:{shape:a.shape}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(b),y}},Hre=class{constructor(e,t){this.variableNames=["A"];let n=new Array(e.length);for(let i=0;i<n.length;i++)n[i]=e[i]*t[i];this.outputShape=n,this.rank=n.length;let r=s6(this.rank),a=function(e){let t=e.length;if(t>5)throw Error(`Tile for rank ${t} is not yet supported`);if(1===t)return`imod(resRC, ${e[0]})`;let n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let a=0;a<e.length;a++)r.push(`imod(${n[a]}, ${e[a]})`);return r.join()}(e);this.userCode=`\n      void main() {\n        ${r} resRC = getOutputCoords();\n        setOutput(getA(${a}));\n      }\n    `}};function Gre(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{reps:i}=r;if("string"===a.dtype||a.shape.length>5){let e=n.readSync(a.dataId),t="string"===a.dtype?e.map((e=>pT.decodeString(e))):e,r=R_(a.shape,a.dtype,t),s=$8(r,i);return n.makeTensorInfo(s.shape,s.dtype,s.values)}let s=new Hre(a.shape,i);return n.runWebGLProgram(s,[a],a.dtype)}var qre={kernelName:LC,backendName:"webgl",kernelFunc:Gre},Kre=class{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode="\n    void main() {\n         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // The output size is half of the previous size.\n         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),\n         // we only need to output the indices at positions |, the indices at\n         // positions _ can be thrown away, see Figure5(b) After Phase 2\n         // (Merge phase) in the Bitonic Top K paper referenced above.\n         // For example, the paper shows we only need to output the orange bars.\n         // The output sequence should look like this | | | | | | | |.\n         // Because the sequence is halved, to map the output index back\n         // to the previous sequence to find the corresponding value,\n         // we need to double the index. When we double the index,\n         // we basically interpolate a position, so 2i looks like\n         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position\n         // of each 2k positions by - elemIdx % k. E.g. for output at\n         // index 4,5,6,7, we want to get the corresponding element at\n         // original index 8,9,10,11, for output at index 8,9,10,11,\n         // we want to get the corresponding element at original index\n         // 16,17,18,19, so on and so forth.\n\n         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));\n\n         float x0 = getX(batch, i0);\n         float x1 = i1 < n ? getX(batch, i1) : x0;\n\n         setOutput(x0 >= x1 ? float(i0) : float(i1));\n       }\n     "}};function Xre(e,t){null!==t&&e.disposeIntermediateTensorInfo(t)}function Yre(e){let t=1;for(;t<e;)t*=2;return t}var Jre,Zre,Qre,eae={kernelName:zC,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{k:i,sorted:s}=r,o=$S().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=$S().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),u=a.shape,d=u[u.length-1];if(n.shouldExecuteOnCPU([a])||d<o||i>l){let e=n.readSync(a.dataId),[t,r]=A8(e,u,a.dtype,i,s);return[n.makeTensorInfo(t.shape,t.dtype,t.values),n.makeTensorInfo(r.shape,r.dtype,r.values)]}if(0===i)return u[u.length-1]=0,[n.makeTensorInfo(u,a.dtype,[]),n.makeTensorInfo(u,"int32",[])];if(1===d)return[a,rte({attrs:{shape:u,dtype:"int32",value:0},backend:n})];let c=n.texData.get(a.dataId),p=null!==c&&c.isPacked,h=p?n.unpackTensor(a):a,f=pT.sizeFromShape(u)/d,m=R7({inputs:{x:h},attrs:{shape:[f,d]},backend:n});p&&Xre(n,h);let g=Yre(i),b=Yre(d),y=null,v=()=>null===y?[m,m]:[m,y],x=(e,t,r)=>{let a=v(),i=new class{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode="\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // We compare elements pair-wise within a group of size 2 * inc.\n         // The comparing rule for each group alternates between ascending\n         // and descending. Within each group, we compare each pair at\n         // positions i and i+inc. To decide whether an element at position i\n         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than\n         // inc, it is in the first half of the group, we denote it as x0,\n         // otherwise we denote it as x1.\n         // For example, as shown in the Bitonic top K paper referenced above,\n         // Figure5(a) shows that element[1] is in the\n         // second half of the group when group size is 2, but it is in the\n         // first half of the group when group size is 4.\n\n         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;\n         int i = isFirstInPair ? elemIdx : elemIdx - inc;\n\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));\n         float x0 = i0 < n ? getX(batch, i0) : negativeInf;\n         float x1 = i1 < n ? getX(batch, i1) : negativeInf;\n\n         // Denotes which direction indices are in (ascending or descending).\n         bool reverse = imod(elemIdx, 2 * dir) >= dir;\n         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);\n         if (reverse == isGreater) { // Elements in opposite order of direction\n           int iTemp = i0;\n           i0 = i1;\n           i1 = iTemp;\n         }\n         if (isFirstInPair) {\n            setOutput(float(i0));\n         } else {\n            setOutput(float(i1));\n         }\n       }\n     "}}(r),s=[[d],[null===y?1:0],[Number.NEGATIVE_INFINITY],[e],[t]],o=y;y=n.runWebGLProgram(i,a,"int32",s),Xre(n,o)};for(let N=1;N<g;N*=2){let e=2*N;for(let t=N;t>=1;t/=2)x(e,t,[f,b])}for(let N=b;N>g;N/=2){let e=v(),t=new Kre([f,N/2]),r=[[d],[null===y?1:0],[g]],a=y;y=n.runWebGLProgram(t,e,"int32",r),Xre(n,a);let i=g/2,s=2*i;for(let n=i;n>=1;n/=2)x(s,n,y.shape)}let w=y;y=D9({inputs:{x:y},backend:n,attrs:{begin:0,size:[f,i]}}),Xre(n,w);let k=yte({inputs:{x:m,indices:y},backend:n,attrs:{axis:1,batchDims:1}});Xre(n,m);let S=u.slice(0,-1);S.push(i),w=y,y=R7({inputs:{x:y},attrs:{shape:S},backend:n}),Xre(n,w);let I=k;return k=R7({inputs:{x:k},attrs:{shape:S},backend:n}),Xre(n,I),[k,y]}},tae={kernelName:BC,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{image:a,transforms:i}=t,{interpolation:s,fillMode:o,fillValue:l,outputShape:u}=r,[d,c,p,h]=a.shape,[f,m]=null!=u?u:[c,p],g=[d,f,m,h],b=new class{constructor(e,t,n,r,a,i){this.variableNames=["Image","Transforms"],this.outputShape=i;let s,o="nearest"===n?1:2;switch(r){case"constant":default:s=1;break;case"reflect":s=2;break;case"wrap":s=3;break;case"nearest":s=4}this.userCode=`\n            float mapCoord(float outCoord, float len) {\n              float inCoord = outCoord;\n              if(${s} == 2) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    if (inCoord < sz2) {\n                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +\n                      inCoord;\n                    }\n                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    inCoord -= sz2 * float(int(float(inCoord / sz2)));\n                    if (inCoord >= len) {\n                      inCoord = sz2 - inCoord - 1.0;\n                    }\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (${s} == 3) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord -= len * float(int(float(inCoord / sz)));\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (${s} == 4) {\n                return clamp(outCoord, 0.0, len - 1.0);\n              } else {\n                return outCoord;\n              }\n            }\n\n            float readWithFillValue(int batch, int coordY, int coordX,\n              int channel) {\n              float outputValue;\n              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${t}) {\n                  outputValue = getImage(batch, coordY, coordX, channel);\n              } else {\n                outputValue = float(${a});\n              }\n              return outputValue;\n            }\n\n            void main() {\n              ivec4 coords = getOutputCoords();\n              float outputValue;\n              int batch = coords[0];\n              int x = coords[2];\n              int y = coords[1];\n              int channel = coords[3];\n              float xf = float(x);\n              float yf = float(y);\n              float a1 = getTransforms(batch, 0);\n              float a2 = getTransforms(batch, 1);\n              float a3 = getTransforms(batch, 2);\n              float b1 = getTransforms(batch, 3);\n              float b2 = getTransforms(batch, 4);\n              float b3 = getTransforms(batch, 5);\n              float c1 = getTransforms(batch, 6);\n              float c2 = getTransforms(batch, 7);\n              float projection = c1 * xf + c2 * yf + 1.0;\n              if (projection == 0.0) {\n                outputValue = float(${a});\n              } else {\n                float inX = (a1 * xf + a2 * yf + a3) / projection;\n                float inY = (b1 * xf + b2 * yf + b3) / projection;\n                float mapX = mapCoord(inX, float(${t}));\n                float mapY = mapCoord(inY, float(${e}));\n\n                if (${o} == 1) {\n                  int coordY = int(round(mapY));\n                  int coordX = int(round(mapX));\n                  outputValue = readWithFillValue(batch, coordY, coordX,\n                    channel);\n                } else {\n                  float yFloor = floor(mapY);\n                  float xFloor = floor(mapX);\n                  float yCeil = yFloor + 1.0;\n                  float xCeil = xFloor + 1.0;\n                  float valueYFloor = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);\n                  float valueYCeil = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);\n                  outputValue = (yCeil - mapY) * valueYFloor +\n                  (mapY - yFloor) * valueYCeil;\n                }\n              }\n              setOutput(outputValue);\n            }\n        `}}(c,p,s,o,l,g);return n.runWebGLProgram(b,[a,i],"float32")}},nae={kernelName:VC,backendName:"webgl",kernelFunc:function(e){let{inputs:t,attrs:n,backend:r}=e,{axis:a}=n,{x:i}=t;V5(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");let s=r.readSync(i.dataId),{outputValues:o,outputShape:l,indices:u}=D8(s,a,i.shape,i.dtype);return[r.makeTensorInfo(l,i.dtype,o),r.makeTensorInfo([u.length],"int32",u)]}},rae={kernelName:UC,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{value:a}=t,{axis:i}=r;i<0&&(i+=a.shape.length);let s=a,o=s.shape.length,l=a.shape[i],u=new Array(o-1),d=0;for(let m=0;m<o;m++)m!==i&&(u[d++]=s.shape[m]);let c=[],p=new Array(o).fill(0),h=s.shape.slice();h[i]=1;let f=new Array(l);for(let m=0;m<f.length;m++){p[i]=m;let e=D9({inputs:{x:s},backend:n,attrs:{begin:p,size:h}}),t=R7({inputs:{x:e},backend:n,attrs:{shape:u}});f[m]=t,c.push(e)}return c.forEach((e=>n.disposeIntermediateTensorInfo(e))),f}},aae={kernelName:jC,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,segmentIds:i}=t,{numSegments:s}=r,o=a.shape.length,l=[],u=0,d=_P.getAxesPermutation([u],o),c=a;null!=d&&(c=V7({inputs:{x:a},backend:n,attrs:{perm:d}}),l.push(c),u=_P.getInnerMostAxes(1,o)[0]);let p=_P.segment_util.computeOutShape(c.shape,u,s),h=pT.sizeFromShape([c.shape[u]]),f=R7({inputs:{x:c},backend:n,attrs:{shape:[-1,h]}});l.push(f);let m=sE(a.dtype),g=(e,t,r,a,i)=>{let s=e.shape[0],o=e.shape[1],u=_P.segment_util.segOpComputeOptimalWindowSize(o,i),d={windowSize:u,inSize:o,batchSize:s,numSegments:i},c=new class{constructor(e,t){this.variableNames=["x","segmentIds"];let n=e.windowSize,r=e.batchSize,a=e.inSize,i=e.numSegments,s=i*Math.ceil(a/n);this.outputShape=[r,s];let o=4*Math.floor(n/4),l=n%4,u="\n        sumValue += dot(values, segFilter);\n    ",d="";a%n>0&&(d=`\n        if (inIdx < 0 || inIdx >= ${a}) {\n          return initializationValue;\n        }\n      `);let c="";a%n>0&&(c=`\n        if (inIdx < 0 || inIdx >= ${a}) {\n          return -1.0;\n        }\n      `),this.userCode=`\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        ${d}\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ${c}\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ${i})) * float(${n}));\n        int currentSeg = int(mod(float(outIdx), float(${i})));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ${o}; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ${u}\n        }\n\n        int inIdx = inOffset + ${o};\n        if (${1===l}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ${u}\n        } else if (${2===l}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ${u}\n        } else if (${3===l}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ${u}\n        }\n        setOutput(sumValue);\n      }\n    `}}(d,t),p=n.compileAndRun(c,[e,r],a);if(l.push(p),p.shape[1]===i)return p;let h=zne({backend:n,attrs:{start:0,stop:i,step:1,dtype:"float32"}}),f=Gre({inputs:{x:h},backend:n,attrs:{reps:[o/u]}});return l.push(h),l.push(f),g(p,t,f,a,i)},b=R7({inputs:{x:g(f,"unsortedSegmentSum",i,m,s)},backend:n,attrs:{shape:p}}),y=b;if(null!=d){l.push(b);let e=_P.getUndoAxesPermutation(d);y=V7({inputs:{x:y},backend:n,attrs:{perm:e}})}return l.forEach((e=>n.disposeIntermediateTensorInfo(e))),y}},iae=[G7,K7,Y7,Z7,t9,n9,r9,a9,d9,c9,h9,m9,b9,v9,w9,I9,N9,C9,T9,E9,_9,M9,O9,P9,L9,j9,q9,K9,m7,Y9,aee,pee,hee,fee,mee,gee,bee,vee,wee,kee,Tee,Eee,_ee,$ee,Dee,Fee,Mee,Oee,Pee,Lee,Bee,Wee,Uee,Hee,qee,Xee,Zee,tte,ite,ste,ute,cte,pte,fte,mte,gte,vte,wte,Ste,h7,Ite,tee,Cte,Ete,$te,y7,Rte,Fte,Mte,Pte,zte,Wte,Ute,Hte,Gte,qte,Xte,Jte,Zte,Qte,ene,tne,nne,rne,ane,sne,one,une,bne,A7,vne,wne,Sne,Nne,B9,Cne,_ne,$ne,Rne,Fne,w7,Mne,One,Pne,Lne,Bne,V9,cne,Vne,jne,Gne,D7,qne,Kne,Xne,Yne,Jne,Zne,ere,nre,are,ire,sre,lre,dre,pre,fre,gre,F9,gne,yre,vre,xre,wre,kre,Sre,Ire,Nre,Ere,$re,Dre,Fre,Mre,Ore,Pre,Lre,zre,fne,W7,Wre,Ure,jre,qre,eae,tae,U7,nae,rae,aae,Ene];for(let e of iae)sT(e);!function(e){e[e.float32=0]="float32",e[e.int32=1]="int32",e[e.bool=2]="bool",e[e.string=3]="string",e[e.complex64=4]="complex64"}(Jre||(Jre={})),function(e){e[e.linear=0]="linear",e[e.relu=1]="relu",e[e.relu6=2]="relu6",e[e.prelu=3]="prelu",e[e.leakyrelu=4]="leakyrelu",e[e.sigmoid=5]="sigmoid",e[e.elu=6]="elu"}(Zre||(Zre={}));var sae={kernelName:YC,backendName:"wasm",setupFunc:function(e){Qre=e.wasm.cwrap(YC,null,["number","array","number","number","array","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{a:a,b:i,bias:s,preluActivationWeights:o}=t;if("float32"!==a.dtype||"float32"!==i.dtype)throw new Error("_FusedMatMul for non non-float32 tensors not yet supported.");let{transposeA:l,transposeB:u,activation:d,leakyreluAlpha:c}=r,p=n.dataIdMap.get(a.dataId).id,h=n.dataIdMap.get(i.dataId).id,f=0;if(null!=s){let e=n.dataIdMap.get(s.dataId);if(1!==e.shape.length)throw new Error(`_FusedMatMul only supports rank-1 bias but got rank ${e.shape.length}.`);f=e.id}let m=null==o?0:n.dataIdMap.get(o.dataId).id,g=Zre[d];if(null==g)throw new Error(`${d} activation not yet supported for FusedConv2D in the wasm backend.`);let b=l?a.shape[2]:a.shape[1],y=u?i.shape[1]:i.shape[2],v=SA.assertAndGetBroadcastShape(a.shape.slice(0,-2),i.shape.slice(0,-2)),x=n.makeOutput([...v,b,y],a.dtype),w=n.dataIdMap.get(x.dataId).id,k=new Uint8Array(new Int32Array(a.shape).buffer),S=new Uint8Array(new Int32Array(i.shape).buffer);return Qre(p,k,a.shape.length,h,S,i.shape.length,l,u,g,f,m,c||0,w),x}};function oae(e,t){let n;return{kernelName:e,backendName:"wasm",setupFunc:function(t){n=t.wasm.cwrap(e,null,["number","number","number"])},kernelFunc:function(e){let{backend:r,inputs:{x:a}}=e,i=r.dataIdMap.get(a.dataId).id,s=r.makeOutput(a.shape,t||a.dtype),o=r.dataIdMap.get(s.dataId).id;return 0===pT.sizeFromShape(s.shape)||n(i,Jre[a.dtype],o),s}}}var lae=oae(MS),uae=oae(OS),dae=oae(PS);function cae(e,t,n){let r;return{kernelName:e,backendName:"wasm",setupFunc:function(t){r=t.wasm.cwrap(e,null,["number","array","number","number","array","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:a}=e,{a:i,b:s}=a,o=t.dataIdMap.get(i.dataId).id,l=t.dataIdMap.get(s.dataId).id,u=null!=n?n:i.dtype,d=_P.assertAndGetBroadcastShape(i.shape,s.shape),c=t.makeOutput(d,u);if(0===pT.sizeFromShape(d))return c;let p=new Uint8Array(new Int32Array(i.shape).buffer),h=new Uint8Array(new Int32Array(s.shape).buffer),f=t.dataIdMap.get(c.dataId).id;return r(o,p,i.shape.length,l,h,s.shape.length,Jre[i.dtype],f),c}}}var pae,hae=cae(LS),fae={kernelName:zS,backendName:"wasm",setupFunc:function(e){pae=e.wasm.cwrap(zS,null,["array","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n}=e,r=n.makeOutput(t[0].shape,t[0].dtype);if(0===pT.sizeFromShape(r.shape))return r;let a=t.map((e=>n.dataIdMap.get(e.dataId).id)),i=new Uint8Array(new Int32Array(a).buffer),s=n.dataIdMap.get(r.dataId).id;return pae(i,a.length,Jre[r.dtype],s),r}};function mae(e){let{inputs:{x:t},backend:n}=e;if("string"===t.dtype)return ME(n.readSync(t.dataId),t.shape,t.dtype);let r=n.makeOutput(t.shape,t.dtype),a=n.typedArrayFromHeap(t);return n.typedArrayFromHeap(r).set(a),r}var gae,bae={kernelName:JI,backendName:"wasm",kernelFunc:mae};function yae(e){let{inputs:t,backend:n,attrs:r}=e,[a,i]=function(e,t){let n=[],r=[];for(let a=0;a<e.length;++a)1!==e[a]&&n.push(e[a]),1!==e[t[a]]&&r.push(t[a]);for(let a=0;a<r.length;++a){let e=-1;for(let t=0;t<r.length;++t)r[t]>=a&&(-1===e||r[e]>r[t])&&(e=t);r[e]=a}return[n,r]}(t.x.shape,r.perm),s=!0;for(let f=0;f<i.length;f++)i[f]!==f&&(s=!1);let o=function(e,t){let n=new Array(e.length);for(let r=0;r<n.length;r++)n[r]=e[t[r]];return n}(t.x.shape,r.perm),l={dataId:t.x.dataId,shape:a,dtype:t.x.dtype};if(s){let e=mae({inputs:t,backend:n});return e.shape=o,e}let u=n.makeOutput(o,l.dtype),d=n.dataIdMap.get(l.dataId).id,c=n.dataIdMap.get(u.dataId).id,p=new Uint8Array(new Int32Array(i).buffer),h=new Uint8Array(new Int32Array(l.shape).buffer);return gae(d,h,l.shape.length,Jre[l.dtype],c,p,i.length),u}var vae,xae={kernelName:WC,backendName:"wasm",kernelFunc:yae,setupFunc:function(e){gae=e.wasm.cwrap(WC,null,["number","array","number","number","number","array","number"])}};function wae(e,t,n){let r=e.shape,a=e.shape.length,i=pT.parseAxisParam(t,r),s=i,o=_P.getAxesPermutation(s,a),l=null,u=!1;if(null!=o){let t=new Array(a);for(let e=0;e<t.length;e++)t[e]=r[o[e]];s=_P.getInnerMostAxes(s.length,a),l=yae({inputs:{x:e},attrs:{perm:o},backend:n});let i=n.dataIdMap.get(e.dataId).id;n.dataIdMap.get(l.dataId).id!==i&&(u=!0)}return{transposed:l,originalAxes:i,axes:s,inputWasTransposed:u}}var kae,Sae={kernelName:BS,backendName:"wasm",setupFunc:function(e){vae=e.wasm.cwrap(BS,null,["number, number, number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:r}=e,{axis:a,keepDims:i}=r,{x:s}=n,o=t.dataIdMap.get(s.dataId).id,l=s,{transposed:u,axes:d,originalAxes:c,inputWasTransposed:p}=wae(s,a,t);p&&(l=u,o=t.dataIdMap.get(u.dataId).id);let h=l.shape.length;_P.assertAxesAreInnerMostDims("all",d,h);let[f,m]=_P.computeOutAndReduceShapes(l.shape,d),g=pT.sizeFromShape(m),b=t.makeOutput(f,s.dtype);if(0!==pT.sizeFromShape(l.shape)){let e=t.dataIdMap.get(b.dataId).id;vae(o,g,e)}if(p&&t.disposeData(u.dataId),i){let e=_P.expandShapeToKeepDim(b.shape,c);b.shape=e}return b}},Iae={kernelName:WS,backendName:"wasm",setupFunc:function(e){kae=e.wasm.cwrap(WS,null,["number, number, number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:r}=e,{axis:a,keepDims:i}=r,{x:s}=n,o=t.dataIdMap.get(s.dataId).id,l=s,{transposed:u,axes:d,originalAxes:c,inputWasTransposed:p}=wae(s,a,t);p&&(l=u,o=t.dataIdMap.get(u.dataId).id);let h=l.shape.length;_P.assertAxesAreInnerMostDims("any",d,h);let[f,m]=_P.computeOutAndReduceShapes(l.shape,d),g=pT.sizeFromShape(m),b=t.makeOutput(f,s.dtype);if(0!==pT.sizeFromShape(l.shape)){let e=t.dataIdMap.get(b.dataId).id;kae(o,g,e)}if(p&&t.disposeData(u.dataId),i){let e=_P.expandShapeToKeepDim(b.shape,c);b.shape=e}return b}};function Nae(e){let t;return{kernelName:e,backendName:"wasm",setupFunc:function(n){t=n.wasm.cwrap(e,null,["number","number","number","number","number"])},kernelFunc:function(e){let{backend:n,inputs:r,attrs:a}=e,{axis:i}=a,{x:s}=r,o=n.dataIdMap.get(s.dataId).id,l=o,u=s,{transposed:d,axes:c,inputWasTransposed:p}=wae(s,i,n);if(p){let e=n.dataIdMap.get(d.dataId).id;e!==o&&(u=d,l=e)}let h=u.shape.slice(0,-1),f=n.makeOutput(h,"int32"),m=n.dataIdMap.get(f.dataId).id,g=pT.sizeFromShape(f.shape),b=u.shape[c[0]];return t(l,Jre[u.dtype],g,b,m),p&&n.disposeData(d.dataId),f}}}var Cae,Tae,Eae,_ae,$ae=Nae(VS),Aae=Nae(US),Rae=oae(jS),Dae=oae(HS),Fae=oae(GS),Mae=cae(KS),Oae=oae(qS),Pae={kernelName:XS,backendName:"wasm",setupFunc:function(e){Cae=e.wasm.cwrap(XS,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,attrs:n,backend:r}=e,a=t.x,i=r.dataIdMap.get(a.dataId).id,{filterSize:s,strides:o,pad:l,dimRoundingMode:u}=n,d=_P.computePool2DInfo(a.shape,s,o,1,l,u),c=d.filterHeight,p=d.filterWidth,h=d.padInfo.top,f=d.padInfo.right,m=d.padInfo.bottom,g=d.padInfo.left,b=d.strideHeight,y=d.strideWidth,v=d.inChannels;if("channelsLast"!==d.dataFormat)throw new Error(`wasm backend does not support dataFormat:'${d.dataFormat}'. Please use 'channelsLast'.`);if(1!==d.dilationWidth||1!==d.dilationHeight)throw new Error(`was backend only supports average pooling with dilation = [1, 1], got [${d.dilationHeight}, ${d.dilationWidth}].`);let x=r.makeOutput(d.outShape,"float32"),w=r.dataIdMap.get(x.dataId).id;return Cae(i,a.shape[0],a.shape[1],a.shape[2],c,p,h,f,m,g,b,y,v,w),x}},Lae={kernelName:JS,backendName:"wasm",setupFunc:function(e){Tae=e.wasm.cwrap("AvgPool3D",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:i,strides:s,pad:o,dimRoundingMode:l,dataFormat:u}=r,d=_P.computePool3DInfo(a.shape,i,s,1,o,l,u),c=n.makeOutput(d.outShape,a.dtype);return Tae(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(c.dataId).id,d.batchSize,d.inChannels,d.inDepth,d.inHeight,d.inWidth,d.outDepth,d.outHeight,d.outWidth,d.strideDepth,d.strideHeight,d.strideWidth,d.dilationDepth,d.dilationHeight,d.dilationWidth,d.effectiveFilterDepth,d.effectiveFilterHeight,d.effectiveFilterWidth,d.padInfo.front,d.padInfo.top,d.padInfo.left),c}},zae={kernelName:ZS,backendName:"wasm",setupFunc:function(e){Eae=e.wasm.cwrap("AvgPool3DGrad",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,{filterSize:s,strides:o,pad:l,dimRoundingMode:u}=r,d=_P.computePool3DInfo(i.shape,s,o,1,l,u),c=n.makeOutput(i.shape,i.dtype);return Eae(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(c.dataId).id,d.batchSize,d.inChannels,d.inDepth,d.inHeight,d.inWidth,d.outDepth,d.outHeight,d.outWidth,d.strideDepth,d.strideHeight,d.strideWidth,d.dilationDepth,d.dilationHeight,d.dilationWidth,d.effectiveFilterDepth,d.effectiveFilterHeight,d.effectiveFilterWidth,d.padInfo.front,d.padInfo.top,d.padInfo.left,d.filterDepth,d.filterHeight,d.filterWidth),c}},Bae={kernelName:YS,backendName:"wasm",setupFunc:function(e){_ae=e.wasm.cwrap("AvgPoolGrad",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,{filterSize:s,strides:o,pad:l}=r,u=_P.computePool2DInfo(i.shape,s,o,1,l),d=n.makeOutput(i.shape,i.dtype);return _ae(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(d.dataId).id,u.batchSize,u.inChannels,u.inHeight,u.inWidth,u.outHeight,u.outWidth,u.strideHeight,u.strideWidth,u.dilationHeight,u.dilationWidth,u.effectiveFilterHeight,u.effectiveFilterWidth,u.padInfo.top,u.padInfo.left,u.filterHeight,u.filterWidth),d}};function Wae(e){let{inputs:t,attrs:n}=e,{x:r}=t,{shape:a}=n,i=pT.sizeFromShape(r.shape),s=pT.inferFromImplicitShape(a,i);return pT.assert(i===pT.sizeFromShape(s),(()=>`new shape: ${s}, old shape: ${r.shape}. New shape and old shape must have the same number of elements.`)),e.backend.incRef(r.dataId),{dataId:r.dataId,shape:s,dtype:r.dtype}}var Vae,Uae={kernelName:ZN,backendName:"wasm",kernelFunc:Wae},jae={kernelName:QS,backendName:"wasm",setupFunc:function(e){Vae=e.wasm.cwrap(QS,null,["number","array","number","number","array","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{a:a,b:i}=t,{transposeA:s,transposeB:o}=r;if("float32"!==a.dtype||"float32"!==i.dtype)throw new Error("BatchMatMul for non non-float32 tensors not yet supported.");let l=a.shape.length,u=i.shape.length,d=s?a.shape[l-2]:a.shape[l-1],c=o?i.shape[u-1]:i.shape[u-2],p=s?a.shape[l-1]:a.shape[l-2],h=o?i.shape[u-2]:i.shape[u-1],f=a.shape.slice(0,-2),m=i.shape.slice(0,-2),g=pT.sizeFromShape(f),b=pT.sizeFromShape(m),y=SA.assertAndGetBroadcastShape(a.shape.slice(0,-2),i.shape.slice(0,-2)).concat([p,h]);pT.assert(d===c,(()=>`Error in matMul: inner shapes (${d}) and (${c}) of Tensors with shapes ${a.shape} and ${i.shape} and transposeA=${s} and transposeB=${o} must match.`));let v=o?[b,h,c]:[b,c,h],x=Wae({inputs:{x:a},backend:n,attrs:{shape:s?[g,d,p]:[g,p,d]}}),w=Wae({inputs:{x:i},backend:n,attrs:{shape:v}}),k=n.dataIdMap.get(x.dataId).id,S=n.dataIdMap.get(w.dataId).id,I=s?x.shape[2]:x.shape[1],N=o?w.shape[1]:w.shape[2],C=Math.max(g,b),T=n.makeOutput([C,I,N],x.dtype),E=n.dataIdMap.get(T.dataId).id,_=new Uint8Array(new Int32Array(x.shape).buffer),$=new Uint8Array(new Int32Array(w.shape).buffer);return Vae(k,_,x.shape.length,S,$,w.shape.length,s,o,E),n.disposeData(x.dataId),n.disposeData(w.dataId),T.shape=y,T}};function Hae(e){let{inputs:{x:t},attrs:{begin:n,size:r},backend:a}=e,[i,s]=rP.parseSliceParams(t,n,r),o=rP.isSliceContinous(t.shape,i,s),l=a.readSync(t.dataId),u=a.makeOutput(s,t.dtype),d=pT.computeStrides(t.shape),c=a.dataIdMap.get(u.dataId);if(o){let e=rP.computeFlatOffset(i,d);return"string"===t.dtype?c.stringBytes=l.slice(e,e+pT.sizeFromShape(s)):a.typedArrayFromHeap(u).set(l.subarray(e,e+pT.sizeFromShape(s))),u}if("string"===t.dtype){let e=YQ(l,i,s,t.shape,t.dtype);return c.stringBytes=e,u}let p=a.typedArrayFromHeap(u),h=t.shape.length;if(2===h)!function(e,t,n,r,a){let i=0,s=r[0],o=r[1],l=s+a[0];for(let u=s;u<l;u++){let r=u*t+o;n.set(e.subarray(r,r+a[1]),i),i+=a[1]}}(l,d[0],p,i,s);else if(3===h)!function(e,t,n,r,a,i){let s=0,o=a[0],l=a[1],u=a[2],d=o+i[0],c=l+i[1];for(let p=o;p<d;p++)for(let a=l;a<c;a++){let o=p*t+a*n+u;r.set(e.subarray(o,o+i[2]),s),s+=i[2]}}(l,d[0],d[1],p,i,s);else if(4===h)!function(e,t,n,r,a,i,s){let o=0,l=i[0],u=i[1],d=i[2],c=l+s[0],p=u+s[1],h=d+s[2],f=i[3];for(let m=l;m<c;m++)for(let i=u;i<p;i++)for(let l=d;l<h;l++){let u=m*t+i*n+l*r+f;a.set(e.subarray(u,u+s[3]),o),o+=s[3]}}(l,d[0],d[1],d[2],p,i,s);else{let e=YQ(l,i,s,t.shape,t.dtype);p.set(e)}return u}var Gae,qae={kernelName:pC,backendName:"wasm",kernelFunc:Hae},Kae={kernelName:eI,backendName:"wasm",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:i,crops:s}=r,o=i.reduce(((e,t)=>e*t)),l=_P.getReshaped(a.shape,i,o),u=_P.getPermuted(l.length,i.length),d=_P.getReshapedPermuted(a.shape,i,o),c=_P.getSliceBeginCoords(s,i.length),p=_P.getSliceSize(d,s,i.length),h=Wae({inputs:{x:a},backend:n,attrs:{shape:l}}),f=yae({inputs:{x:h},backend:n,attrs:{perm:u}}),m=Hae({inputs:{x:Wae({inputs:{x:f},backend:n,attrs:{shape:d}})},backend:n,attrs:{begin:c,size:p}});return n.disposeData(h.dataId),n.disposeData(f.dataId),n.disposeData(h.dataId),m}},Xae={kernelName:tI,backendName:"wasm",setupFunc:function(e){Gae=e.wasm.cwrap(tI,null,["number","number","boolean","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:r}=e,{x:a,weights:i}=n,{size:s}=r,o=0!==i.shape.reduce(((e,t)=>e*t),1),l=1===a.shape.length?[s]:[a.shape[0],s],u=t.makeOutput(l,i.dtype);function d(e){return t.dataIdMap.get(e.dataId).id}return Gae(d(a),s,o,d(i),Jre[i.dtype],d(u)),u}},Yae=cae(nI),Jae={kernelName:aI,backendName:"wasm",kernelFunc:function(e){let{inputs:t,backend:n}=e,{s0:r,s1:a}=t,i=n.typedArrayFromHeap(r),s=n.typedArrayFromHeap(a),o=_P.assertAndGetBroadcastShape(Array.from(i),Array.from(s));return n.makeOutput([o.length],"int32",void 0,new Int32Array(o))}};function Zae(e){let{inputs:{x:t},attrs:{dtype:n},backend:r}=e,a=r.makeOutput(t.shape,n),i=r.typedArrayFromHeap(t);return r.typedArrayFromHeap(a).set(i),a}var Qae,eie={kernelName:iI,backendName:"wasm",kernelFunc:Zae},tie=oae(sI),nie={kernelName:oI,backendName:"wasm",setupFunc:function(e){Qae=e.wasm.cwrap(oI,null,["number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{clipValueMin:i,clipValueMax:s}=r,o=n.dataIdMap.get(a.dataId).id,l=n.makeOutput(a.shape,a.dtype),u=n.dataIdMap.get(l.dataId).id;return Qae(o,i,s,u),l}};function rie(e){let{inputs:t,backend:n}=e,r=pT.parseAxisParam(e.attrs.axis,t[0].shape)[0],a=t.map((e=>e.shape));_P.assertParamsConsistent(a,r);let i=_P.computeOutShape(t.map((e=>e.shape)),r),s=t.filter((e=>pT.sizeFromShape(e.shape)>0));if(1===s.length)return mae({inputs:{x:s[0]},backend:n});let o=n.makeOutput(i,t[0].dtype);if(0===pT.sizeFromShape(i))return o;if("string"===s[0].dtype){let e=s.map((e=>{let t=[-1,pT.sizeFromShape(e.shape.slice(r))];return Wae({inputs:{x:e},backend:n,attrs:{shape:t}})})),a=e.map((e=>({vals:n.readSync(e.dataId),shape:e.shape})));i=_P.computeOutShape(e.map((e=>e.shape)),1);let l=1===e[0].shape[0],u=$Z(a,i,t[0].dtype,l),d=_P.computeOutShape(s.map((e=>e.shape)),r);return o.shape=d,n.dataIdMap.get(o.dataId).stringBytes=_P.fromStringArrayToUint8(u),e.forEach((e=>n.disposeData(e.dataId))),o}let l=pT.sizeFromShape(s[0].shape.slice(0,r)),u=0,d=s.map((e=>{let t=pT.sizeFromShape(e.shape.slice(r));return u+=t,t})),c=s.map((e=>n.typedArrayFromHeap(e))),p=n.typedArrayFromHeap(o);for(let h=0;h<l;h++){let e=h*u;for(let t=0;t<c.length;t++){let n=d[t],r=h*n,a=c[t].subarray(r,r+n);p.set(a,e),e+=n}}return o}var aie,iie,sie,oie,lie,uie,die,cie={kernelName:dI,backendName:"wasm",kernelFunc:rie},pie={kernelName:cI,backendName:"wasm",setupFunc:function(e){aie=e.wasm.cwrap(cI,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,attrs:n,backend:r}=e,{x:a,filter:i}=t,s=r.dataIdMap.get(a.dataId).id,o=r.dataIdMap.get(i.dataId).id,{strides:l,dilations:u,pad:d,dimRoundingMode:c,dataFormat:p}=n,h=_P.convertConv2DDataFormat(p),f=_P.computeConv2DInfo(a.shape,i.shape,l,u,d,c,!1,h),m=f.filterHeight,g=f.filterWidth,b=f.padInfo.top,y=f.padInfo.right,v=f.padInfo.bottom,x=f.padInfo.left,w=f.dilationHeight,k=f.dilationWidth,S=f.strideHeight,I=f.strideWidth,N=f.inChannels,C=f.outChannels,T="SAME"===f.padInfo.type?1:0;if("channelsLast"!==f.dataFormat)throw new Error(`wasm backend Conv2D does not support dataFormat:'${f.dataFormat}'. Please use 'channelsLast'.`);let E=r.makeOutput(f.outShape,"float32"),_=r.dataIdMap.get(E.dataId).id;return aie(s,a.shape[0],a.shape[1],a.shape[2],o,m,g,b,y,v,x,T,w,k,S,I,N,C,_),E}},hie={kernelName:hI,backendName:"wasm",setupFunc:function(e){iie=e.wasm.cwrap(hI,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:r}=e,{dy:a,filter:i}=n,{strides:s,pad:o,dataFormat:l,dimRoundingMode:u,inputShape:d}=r,c=_P.convertConv2DDataFormat(l),p=_P.computeConv2DInfo(d,i.shape,s,1,o,u,!1,c),{batchSize:h,filterHeight:f,filterWidth:m,inChannels:g,inHeight:b,inWidth:y,outChannels:v,outHeight:x,outWidth:w,strideHeight:k,strideWidth:S}=p,I=f-1-p.padInfo.top,N=m-1-p.padInfo.left,C="channelsLast"===p.dataFormat,T=pT.computeStrides(p.inShape),E=pT.computeStrides(a.shape),[_,$,A]=pT.computeStrides(i.shape),R=T[0],D=C?T[1]:T[2],F=C?T[2]:1,M=C?1:T[1],O=E[0],P=C?E[1]:E[2],L=C?E[2]:1,z=C?1:E[1],B=t.makeOutput(p.inShape,"float32"),W=t.dataIdMap.get(B.dataId).id,V=t.dataIdMap.get(a.dataId).id,U=t.dataIdMap.get(i.dataId).id;return iie(V,U,h,f,m,b,y,g,x,w,v,k,S,I,N,_,$,A,R,D,F,M,O,P,L,z,W),B}},fie={kernelName:fI,backendName:"wasm",setupFunc:function(e){sie=e.wasm.cwrap(fI,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:s,pad:o,dilations:l}=r;if("float32"!==a.dtype)throw new Error(`Tensor x must have dtype float32, got ${a.dtype}`);if("float32"!==i.dtype)throw new Error(`Tensor filter must have dtype float32, got ${i.dtype}`);let u=_P.computeConv3DInfo(a.shape,i.shape,s,l,o),d=n.makeOutput(u.outShape,a.dtype);return sie(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(d.dataId).id,u.batchSize,u.inDepth,u.inHeight,u.inWidth,u.inChannels,u.outDepth,u.outHeight,u.outWidth,u.outChannels,u.strideDepth,u.strideHeight,u.strideWidth,u.dilationDepth,u.dilationHeight,u.dilationWidth,u.filterDepth,u.filterHeight,u.filterWidth,u.padInfo.front,u.padInfo.top,u.padInfo.left),d}},mie={kernelName:mI,backendName:"wasm",setupFunc:function(e){oie=e.wasm.cwrap(mI,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,dy:i}=t,{strides:s,pad:o,filterShape:l}=r;if("float32"!==a.dtype)throw new Error(`Tensor dy must have dtype float32, got ${a.dtype}`);if("float32"!==i.dtype)throw new Error(`Tensor filter must have dtype float32, got ${i.dtype}`);let u=_P.computeConv3DInfo(a.shape,l,s,1,o),d=n.makeOutput(u.filterShape,i.dtype);return oie(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(d.dataId).id,u.batchSize,u.inDepth,u.inHeight,u.inWidth,u.inChannels,u.outDepth,u.outHeight,u.outWidth,u.outChannels,u.strideDepth,u.strideHeight,u.strideWidth,u.dilationDepth,u.dilationHeight,u.dilationWidth,u.filterDepth,u.filterHeight,u.filterWidth,u.padInfo.front,u.padInfo.top,u.padInfo.left),d}},gie={kernelName:gI,backendName:"wasm",setupFunc:function(e){lie=e.wasm.cwrap(gI,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:i}=t,{pad:s,strides:o,inputShape:l}=r;if("float32"!==a.dtype)throw new Error(`Tensor dy must have dtype float32, got ${a.dtype}`);if("float32"!==i.dtype)throw new Error(`Tensor filter must have dtype float32, got ${i.dtype}`);let u=_P.computeConv3DInfo(l,i.shape,o,1,s),d=n.makeOutput(u.inShape,a.dtype);return lie(n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(d.dataId).id,u.batchSize,u.inDepth,u.inHeight,u.inWidth,u.inChannels,u.outDepth,u.outHeight,u.outWidth,u.outChannels,u.strideDepth,u.strideHeight,u.strideWidth,u.dilationDepth,u.dilationHeight,u.dilationWidth,u.filterDepth,u.filterHeight,u.filterWidth,u.padInfo.front,u.padInfo.top,u.padInfo.left),d}},bie=oae(bI),yie=oae(yI);!function(e){e[e.bilinear=0]="bilinear",e[e.nearest=1]="nearest"}(uie||(uie={}));var vie,xie,wie,kie,Sie,Iie,Nie,Cie,Tie,Eie,_ie={kernelName:wI,backendName:"wasm",setupFunc:function(e){die=e.wasm.cwrap(wI,null,["number","number","number","number","array","number","number","number","number","number"])},kernelFunc:function(e){let t,{backend:n,inputs:r,attrs:a}=e,{method:i,extrapolationValue:s,cropSize:o}=a,{image:l,boxes:u,boxInd:d}=r,c=u.shape[0],[p,h]=o,f=[c,p,h,l.shape[3]],m=n.dataIdMap.get(l.dataId);"float32"!==l.dtype&&(t=Zae({backend:n,inputs:{x:l},attrs:{dtype:"float32"}}),m=n.dataIdMap.get(t.dataId));let g=m.id,b=n.dataIdMap.get(u.dataId).id,y=n.dataIdMap.get(d.dataId).id,v=n.makeOutput(f,"float32"),x=n.dataIdMap.get(v.dataId).id,w=new Uint8Array(new Int32Array(l.shape).buffer);return die(g,b,y,c,w,p,h,uie[i],s,x),null!=t&&n.disposeData(t.dataId),v}},$ie={kernelName:vI,backendName:"wasm",setupFunc:function(e){vie=e.wasm.cwrap(vI,null,["number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,exclusive:s,reverse:o}=r,l=a.shape.length;pT.assert("float32"===a.dtype||"int32"===a.dtype,(()=>`cumprod does not support ${a.dtype} tensors in the WASM backend`));let u=_P.getAxesPermutation([i],l),d=a;null!==u&&(d=yae({inputs:{x:a},attrs:{perm:u},backend:n}));let c=_P.getInnerMostAxes(1,l)[0];_P.assertAxesAreInnerMostDims("cumprod",[c],l);let p=n.makeOutput(d.shape,d.dtype),h=d.shape[c],f=n.dataIdMap.get(d.dataId).id,m=n.dataIdMap.get(p.dataId).id;vie(f,s?1:0,o?1:0,h,m,Jre[a.dtype]);let g=p;return null!==u&&(g=yae({inputs:{x:p},attrs:{perm:_P.getUndoAxesPermutation(u)},backend:n}),n.disposeData(d.dataId),n.disposeData(p.dataId)),g}},Aie={kernelName:xI,backendName:"wasm",setupFunc:function(e){xie=e.wasm.cwrap(xI,null,["number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,exclusive:s,reverse:o}=r,l=a.shape.length;pT.assert("float32"===a.dtype||"int32"===a.dtype,(()=>`cumsum does not support ${a.dtype} tensors in the WASM backend`));let u=_P.getAxesPermutation([i],l),d=a;null!==u&&(d=yae({inputs:{x:a},attrs:{perm:u},backend:n}));let c=_P.getInnerMostAxes(1,l)[0];_P.assertAxesAreInnerMostDims("cumsum",[c],l);let p=n.makeOutput(d.shape,d.dtype),h=d.shape[c],f=n.dataIdMap.get(d.dataId).id,m=n.dataIdMap.get(p.dataId).id;xie(f,s?1:0,o?1:0,h,m,Jre[a.dtype]);let g=p;return null!==u&&(g=yae({inputs:{x:p},attrs:{perm:_P.getUndoAxesPermutation(u)},backend:n}),n.disposeData(d.dataId),n.disposeData(p.dataId)),g}},Rie={kernelName:kI,backendName:"wasm",setupFunc:function(e){wie=e.wasm.cwrap("DenseBincount",null,["number","array","number","number","boolean","number","number","boolean","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:r}=e,{x:a,weights:i}=n,{size:s,binaryOutput:o}=r,l=0!==i.shape.reduce(((e,t)=>e*t),1),u=1===a.shape.length?[s]:[a.shape[0],s],d=t.makeOutput(u,i.dtype);function c(e){return t.dataIdMap.get(e.dataId).id}return wie(c(a),new Uint8Array(new Int32Array(a.shape).buffer),a.shape.length,s,l,c(i),Jre[i.dtype],o,c(d)),d}},Die={kernelName:SI,backendName:"wasm",setupFunc:function(e){kie=e.wasm.cwrap(SI,null,["number","number","number","array","number","array","array","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:r}=e,{x:a}=n,{blockSize:i,dataFormat:s}=r,o=a.shape[0],l=("NHWC"===s?a.shape[1]:a.shape[2])*i,u=("NHWC"===s?a.shape[2]:a.shape[3])*i,d=("NHWC"===s?a.shape[3]:a.shape[1])/(i*i),c="NHWC"===s?[o,l,u,d]:[o,d,l,u],p=t.makeOutput(c,"float32"),h=t.dataIdMap.get(a.dataId).id,f=new Uint8Array(new Int32Array(pT.computeStrides(a.shape)).buffer),m=new Uint8Array(new Int32Array(c).buffer),g=new Uint8Array(new Int32Array(pT.computeStrides(c)).buffer),b=t.dataIdMap.get(p.dataId).id;return kie(h,i,"NHWC"===s?1:0,f,a.shape.length-1,m,g,c.length,b),p}},Fie={kernelName:II,backendName:"wasm",setupFunc:function(e){Sie=e.wasm.cwrap(II,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,attrs:n,backend:r}=e,{x:a,filter:i}=t,s=r.dataIdMap.get(a.dataId).id,o=r.dataIdMap.get(i.dataId).id,{strides:l,dilations:u,pad:d,dimRoundingMode:c}=n,p=null==u?[1,1]:u,h=_P.computeConv2DInfo(a.shape,i.shape,l,p,d,c,!0),f=h.filterHeight,m=h.filterWidth,g=h.padInfo.top,b=h.padInfo.right,y=h.padInfo.bottom,v=h.padInfo.left,x=h.dilationHeight,w=h.dilationWidth,k=h.strideHeight,S=h.strideWidth,I=h.inChannels,N=h.outChannels,C="SAME"===h.padInfo.type?1:0;if("channelsLast"!==h.dataFormat)throw new Error(`wasm backend DepthwiseConv2dNative does not support dataFormat:'${h.dataFormat}'. Please use 'channelsLast'.`);let T=r.makeOutput(h.outShape,"float32"),E=r.dataIdMap.get(T.dataId).id;return Sie(s,a.shape[0],a.shape[1],a.shape[2],o,f,m,g,b,y,v,C,x,w,k,S,I,N,E),T}},Mie={kernelName:TI,backendName:"wasm",setupFunc:function(e){Iie=e.wasm.cwrap("Diag",null,["number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n}=e,{x:r}=t,a=pT.sizeFromShape(r.shape),i=n.makeOutput([...r.shape,...r.shape],r.dtype);return Iie(n.dataIdMap.get(r.dataId).id,Jre[r.dtype],a,n.dataIdMap.get(i.dataId).id),i}},Oie={kernelName:EI,backendName:"wasm",setupFunc:function(e){Nie=e.wasm.cwrap(EI,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:s,pad:o,dilations:l}=r;if(a.dtype!==i.dtype)throw new Error(`Dilation2D error: x must have the same dtype as filter. Got ${a.dtype} and ${i.dtype}`);let u=_P.computeDilation2DInfo(a.shape,i.shape,s,o,"NHWC",l),d=n.makeOutput(u.outShape,a.dtype);return Nie(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(d.dataId).id,Jre[a.dtype],u.batchSize,u.inChannels,u.inHeight,u.inWidth,u.outHeight,u.outWidth,u.strideHeight,u.strideWidth,u.dilationHeight,u.dilationWidth,u.filterHeight,u.filterWidth,u.padInfo.top,u.padInfo.left),d}},Pie={kernelName:$I,backendName:"wasm",setupFunc:function(e){Cie=e.wasm.cwrap($I,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i,dy:s}=t,{strides:o,pad:l,dilations:u}=r;if(a.dtype!==i.dtype||a.dtype!==s.dtype)throw new Error(`Dilation2DBackpropFilter error: x must have the same dtype as filter and dy. Got ${a.dtype}, ${i.dtype}, and ${s.dtype}`);let d=_P.computeDilation2DInfo(a.shape,i.shape,o,l,"NHWC",u),c=n.makeOutput(i.shape,i.dtype);return Cie(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(c.dataId).id,Jre[a.dtype],d.batchSize,d.inChannels,d.inHeight,d.inWidth,d.outHeight,d.outWidth,d.strideHeight,d.strideWidth,d.dilationHeight,d.dilationWidth,d.filterHeight,d.filterWidth,d.padInfo.top,d.padInfo.left),c}},Lie={kernelName:_I,backendName:"wasm",setupFunc:function(e){Tie=e.wasm.cwrap(_I,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i,dy:s}=t,{strides:o,pad:l,dilations:u}=r;if(a.dtype!==i.dtype||a.dtype!==s.dtype)throw new Error(`Dilation2DBackpropInput error: x must have the same dtype as filter and dy. Got ${a.dtype}, ${i.dtype}, and ${s.dtype}`);let d=_P.computeDilation2DInfo(a.shape,i.shape,o,l,"NHWC",u),c=n.makeOutput(a.shape,a.dtype);return Tie(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(c.dataId).id,Jre[a.dtype],d.batchSize,d.inChannels,d.inHeight,d.inWidth,d.outHeight,d.outWidth,d.strideHeight,d.strideWidth,d.dilationHeight,d.dilationWidth,d.filterHeight,d.filterWidth,d.padInfo.top,d.padInfo.left),c}},zie=oae(FI),Bie={kernelName:MI,backendName:"wasm",setupFunc:function(e){Eie=e.wasm.cwrap(MI,null,["number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n}=e,{dy:r,y:a}=t,i=n.makeOutput(a.shape,"float32"),s=e=>n.dataIdMap.get(e.dataId).id;return Eie(s(a),s(r),s(i)),i}},Wie=cae(PI,0,"bool"),Vie=oae(OI),Uie=oae(LI,"float32");function jie(e){let{inputs:t,attrs:n,backend:r}=e,{input:a}=t,{dim:i}=n,s=a.shape.length,o=a.shape.slice(),l=i;return i<0&&(pT.assert(-(s+1)<=i,(()=>`Axis must be in the interval [${-(s+1)}, ${s}]`)),l=s+i+1),o.splice(l,0,1),Wae({inputs:{x:a},backend:r,attrs:{shape:o}})}var Hie={kernelName:zI,backendName:"wasm",kernelFunc:jie},Gie=oae(BI,"float32");function qie(e){let{attrs:{shape:t,value:n,dtype:r},backend:a}=e,i=a.makeOutput(t,r);return a.typedArrayFromHeap(i).fill(n),i}var Kie,Xie,Yie,Jie,Zie,Qie,ese,tse,nse,rse,ase,ise,sse,ose,lse,use,dse,cse,pse,hse,fse={kernelName:VI,backendName:"wasm",kernelFunc:qie},mse={kernelName:UI,backendName:"wasm",kernelFunc:function(e){let{inputs:t,backend:n}=e,{image:r}=t,a=n.makeOutput(r.shape,r.dtype),i=n.dataIdMap.get(r.dataId).id,s=n.dataIdMap.get(a.dataId).id,[o,l,u,d]=r.shape;return Kie(i,o,l,u,d,s),a},setupFunc:function(e){Kie=e.wasm.cwrap(UI,null,["number","number","number","number","number","number"])}},gse=oae(jI),bse=cae(HI),yse={kernelName:GI,backendName:"wasm",setupFunc:function(e){Xie=e.wasm.cwrap(GI,null,["number","number","number","number","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:r}=e,{varianceEpsilon:a}=r,{x:i,mean:s,variance:o,offset:l,scale:u}=n,d=t.dataIdMap.get(i.dataId).id,c=t.dataIdMap.get(s.dataId).id,p=t.dataIdMap.get(o.dataId).id,h=null!=l?t.dataIdMap.get(l.dataId).id:0,f=null!=u?t.dataIdMap.get(u.dataId).id:0,m=t.makeOutput(i.shape,i.dtype);if(0===pT.sizeFromShape(i.shape))return m;let g=t.dataIdMap.get(m.dataId).id;return Xie(d,c,p,h,f,a,g),m}},vse={kernelName:JC,backendName:"wasm",setupFunc:function(e){Yie=e.wasm.cwrap(JC,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,attrs:n,backend:r}=e,{x:a,filter:i,bias:s,preluActivationWeights:o}=t,{strides:l,pad:u,dilations:d,dataFormat:c,dimRoundingMode:p,activation:h,leakyreluAlpha:f}=n,m=_P.computeConv2DInfo(a.shape,i.shape,l,d,u,p),g=Zre[h];if(null==g)throw new Error(`${h} activation not yet supported for FusedConv2D in the wasm backend.`);let b=r.dataIdMap.get(a.dataId).id,y=r.dataIdMap.get(i.dataId).id,v=m.outChannels,x=0;if(null!=s){let e=r.dataIdMap.get(s.dataId);if(1!==e.shape.length)throw new Error(`FusedConv2D only supports rank-1 bias but got rank ${e.shape.length}.`);if(e.shape[0]!==v)throw new Error(`FusedConv2D bias shape (${e.shape}) does not match the number of output channels (${v})`);x=e.id}let w=m.filterHeight,k=m.filterWidth,S=m.padInfo.top,I=m.padInfo.right,N=m.padInfo.bottom,C=m.padInfo.left,T=m.dilationHeight,E=m.dilationWidth,_=m.strideHeight,$=m.strideWidth,A=m.inChannels,R="SAME"===m.padInfo.type?1:0,D=m.batchSize,F=m.inHeight,M=m.inWidth;if("NHWC"!==c)throw new Error(`wasm backend FusedConv2D does not support dataFormat:'${c}'. Please use 'NHWC'.`);let O=r.makeOutput(m.outShape,"float32"),P=r.dataIdMap.get(O.dataId).id,L=null==o?0:r.dataIdMap.get(o.dataId).id;return Yie(b,D,F,M,y,w,k,x,S,I,N,C,R,T,E,_,$,A,v,g,L,f||0,P),O}},xse={kernelName:ZC,backendName:"wasm",setupFunc:function(e){Jie=e.wasm.cwrap(ZC,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,attrs:n,backend:r}=e,{x:a,filter:i,bias:s,preluActivationWeights:o}=t,{strides:l,pad:u,dilations:d,dataFormat:c,dimRoundingMode:p,activation:h,leakyreluAlpha:f}=n,m=_P.computeConv2DInfo(a.shape,i.shape,l,d,u,p,!0),g=Zre[h];if(null==g)throw new Error(`${h} activation not yet supported for FusedDepthwiseConv2D in the wasm backend.`);let b=r.dataIdMap.get(a.dataId).id,y=r.dataIdMap.get(i.dataId).id,v=m.outChannels,x=0;if(null!=s){let e=r.dataIdMap.get(s.dataId);if(1!==e.shape.length)throw new Error(`FusedDepthwiseConv2D only supports rank-1 bias but got rank ${e.shape.length}.`);if(e.shape[0]!==v)throw new Error(`FusedDepthwiseConv2D bias shape (${e.shape}) does not match the number of output channels (${v})`);x=e.id}let w=m.filterHeight,k=m.filterWidth,S=m.padInfo.top,I=m.padInfo.right,N=m.padInfo.bottom,C=m.padInfo.left,T=m.dilationHeight,E=m.dilationWidth,_=m.strideHeight,$=m.strideWidth,A=m.inChannels,R="SAME"===m.padInfo.type?1:0,D=m.batchSize,F=m.inHeight,M=m.inWidth;if("NHWC"!==c)throw new Error(`wasm backend FusedDepthwiseConv2D does not support dataFormat:'${c}'. Please use 'NHWC'.`);let O=r.makeOutput(m.outShape,"float32"),P=r.dataIdMap.get(O.dataId).id,L=null==o?0:r.dataIdMap.get(o.dataId).id;return Jie(b,D,F,M,y,w,k,x,S,I,N,C,R,T,E,_,$,A,v,g,L,f||0,P),O}},wse={kernelName:KI,backendName:"wasm",setupFunc:function(e){Zie=e.wasm.cwrap(KI,null,["number","number","number","number","number","number","array","number"])},kernelFunc:function(e){let{backend:t,inputs:n}=e,{params:r,indices:a}=n,[i,s,o,l]=tP.prepareAndValidate(r,a),u=t.makeOutput(i,r.dtype);if(0===s)return u;let d=a.shape,c=d[d.length-1],p=t.dataIdMap.get(r.dataId).id,h=t.dataIdMap.get(a.dataId).id,f=new Uint8Array(new Int32Array(l).buffer),m=t.dataIdMap.get(u.dataId).id;return Zie(p,Jre[r.dtype],h,s,c,o,f,m),u}},kse={kernelName:qI,backendName:"wasm",setupFunc:function(e){Qie=e.wasm.cwrap("Gather",null,["number","number","array","number","number","number","array","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:r}=e,{x:a,indices:i}=n,{axis:s,batchDims:o}=r,l=pT.parseAxisParam(s,a.shape)[0],u=t.readSync(i.dataId),d=a.shape[l];for(let S=0;S<u.length;++S){let e=u[S];pT.assert(e<=d-1&&e>=0,(()=>`GatherV2: the index value ${e} is not in [0, ${d-1}]`))}let c=_P.segment_util.collectGatherOpShapeInfo(a,i,l,o),p=Wae({inputs:{x:a},attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]},backend:t}),h=pT.sizeFromShape(i.shape),f=Wae({inputs:{x:i},attrs:{shape:[c.batchSize,h/c.batchSize]},backend:t}),m=[c.batchSize,c.outerSize,h/c.batchSize,c.sliceSize],g=t.makeOutput(m,a.dtype);if(0===pT.sizeFromShape(a.shape))return g;let b=p.shape.length-1,y=t.dataIdMap.get(p.dataId).id,v=t.dataIdMap.get(f.dataId).id,x=t.dataIdMap.get(g.dataId).id,w=new Uint8Array(new Int32Array(pT.computeStrides(p.shape)).buffer),k=new Uint8Array(new Int32Array(pT.computeStrides(m)).buffer);return Qie(y,Jre[a.dtype],w,b,v,c.batchSize,k,x),t.disposeData(p.dataId),t.disposeData(f.dataId),g.shape=c.outputShape,g}},Sse=cae(XI,0,"bool"),Ise=cae(YI,0,"bool"),Nse=oae(eN,"bool"),Cse=oae(tN,"bool"),Tse=oae(nN,"bool"),Ese={kernelName:rN,backendName:"wasm",setupFunc:function(e){ese=e.wasm.cwrap(rN,null,["number","number","number","number"])},kernelFunc:function(e){let{inputs:{x:t},attrs:{alpha:n},backend:r}=e,a=r.dataIdMap.get(t.dataId).id,i=r.makeOutput(t.shape,"float32");if(0!==pT.sizeFromShape(t.shape)){let e=r.dataIdMap.get(i.dataId).id;ese(a,Jre[t.dtype],n,e)}return i}},_se=cae(aN,0,"bool"),$se=cae(iN,0,"bool"),Ase={kernelName:sN,backendName:"wasm",setupFunc:function(e){tse=e.wasm.cwrap(sN,null,["number","number","number","number"])},kernelFunc:function(e){let{attrs:t,backend:n}=e,{start:r,stop:a,num:i}=t,s=Math.floor(i),o=n.makeOutput([s],"float32");return tse(n.dataIdMap.get(o.dataId).id,r,a,s),o}},Rse=oae(oN),Dse=oae(lN),Fse=cae(uN,0,"bool"),Mse=oae(dN),Ose=cae(cN,0,"bool"),Pse=cae(pN,0,"bool"),Lse={kernelName:mN,backendName:"wasm",setupFunc:function(e){nse=e.wasm.cwrap(mN,null,["number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{depthRadius:i,bias:s,alpha:o,beta:l}=r;if("float32"!==a.dtype)throw new Error("LRN error: x must have dtype float32");let u=n.makeOutput(a.shape,a.dtype);return nse(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(u.dataId).id,a.shape[3],i,s,o,l),u}},zse={kernelName:gN,backendName:"wasm",setupFunc:function(e){rse=e.wasm.cwrap(gN,null,["number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,y:i,dy:s}=t,{depthRadius:o,bias:l,alpha:u,beta:d}=r;if("float32"!==a.dtype||"float32"!==i.dtype||"float32"!==s.dtype)throw new Error("LRNGrad error: x, y, and dy must have dtype float32");let c=n.makeOutput(a.shape,a.dtype);return rse(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(c.dataId).id,s.shape[3],o,l,u,d),c}},Bse={kernelName:yN,backendName:"wasm",setupFunc:function(e){ase=e.wasm.cwrap(yN,null,["number","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:r}=e,{reductionIndices:a,keepDims:i}=r,{x:s}=n,o=t.dataIdMap.get(s.dataId).id,l=s,{transposed:u,axes:d,originalAxes:c,inputWasTransposed:p}=wae(s,a,t);p&&(l=u,o=t.dataIdMap.get(u.dataId).id);let h=l.shape.length;_P.assertAxesAreInnerMostDims("max",d,h);let[f,m]=_P.computeOutAndReduceShapes(l.shape,d),g=pT.sizeFromShape(m),b=t.makeOutput(f,s.dtype);if(0!==pT.sizeFromShape(l.shape)){let e=t.dataIdMap.get(b.dataId).id;ase(o,Jre[s.dtype],g,e)}if(p&&t.disposeData(u.dataId),i){let e=_P.expandShapeToKeepDim(b.shape,c);b.shape=e}return b}},Wse=cae(vN),Vse={kernelName:xN,backendName:"wasm",setupFunc:function(e){ise=e.wasm.cwrap(xN,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,attrs:n,backend:r}=e,a=t.x,i=r.dataIdMap.get(a.dataId).id;pT.assert("float32"===a.dtype,(()=>`Error in MaxPool: only float32 input is supported. Got ${a.dtype}.`));let{filterSize:s,strides:o,pad:l,dimRoundingMode:u}=n,d=_P.computePool2DInfo(a.shape,s,o,1,l,u),c=d.filterHeight,p=d.filterWidth,h=d.padInfo.top,f=d.padInfo.right,m=d.padInfo.bottom,g=d.padInfo.left,b=d.dilationHeight,y=d.dilationWidth,v=d.strideHeight,x=d.strideWidth,w=d.inChannels,k=d.outChannels;if("channelsLast"!==d.dataFormat)throw new Error(`wasm backend does not support dataFormat:'${d.dataFormat}'. Please use 'channelsLast'.`);let S=r.makeOutput(d.outShape,"float32"),I=r.dataIdMap.get(S.dataId).id;return ise(i,a.shape[0],a.shape[1],a.shape[2],c,p,h,f,m,g,b,y,v,x,w,k,I),S}},Use={kernelName:kN,backendName:"wasm",setupFunc:function(e){sse=e.wasm.cwrap("MaxPool3D",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:i,strides:s,pad:o,dimRoundingMode:l,dataFormat:u}=r,d=_P.computePool3DInfo(a.shape,i,s,1,o,l,u),c=n.makeOutput(d.outShape,a.dtype);return sse(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(c.dataId).id,d.batchSize,d.inChannels,d.inDepth,d.inHeight,d.inWidth,d.outDepth,d.outHeight,d.outWidth,d.strideDepth,d.strideHeight,d.strideWidth,d.dilationDepth,d.dilationHeight,d.dilationWidth,d.effectiveFilterDepth,d.effectiveFilterHeight,d.effectiveFilterWidth,d.padInfo.front,d.padInfo.top,d.padInfo.left),c}},jse={kernelName:SN,backendName:"wasm",setupFunc:function(e){ose=e.wasm.cwrap("MaxPool3DGrad",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,{filterSize:s,strides:o,pad:l,dimRoundingMode:u}=r,d=_P.computePool3DInfo(i.shape,s,o,1,l,u),c=n.makeOutput(i.shape,i.dtype);return ose(n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(c.dataId).id,d.batchSize,d.inChannels,d.inDepth,d.inHeight,d.inWidth,d.outDepth,d.outHeight,d.outWidth,d.strideDepth,d.strideHeight,d.strideWidth,d.dilationDepth,d.dilationHeight,d.dilationWidth,d.effectiveFilterDepth,d.effectiveFilterHeight,d.effectiveFilterWidth,d.padInfo.front,d.padInfo.top,d.padInfo.left),c}},Hse={kernelName:wN,backendName:"wasm",setupFunc:function(e){lse=e.wasm.cwrap("MaxPoolGrad",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,{filterSize:s,strides:o,pad:l,dimRoundingMode:u}=r,d=_P.computePool2DInfo(i.shape,s,o,1,l,u),c=n.makeOutput(i.shape,i.dtype);return lse(n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(c.dataId).id,d.batchSize,d.inChannels,d.inHeight,d.inWidth,d.outHeight,d.outWidth,d.strideHeight,d.strideWidth,d.dilationHeight,d.dilationWidth,d.effectiveFilterHeight,d.effectiveFilterWidth,d.padInfo.top,d.padInfo.left),c}},Gse={kernelName:IN,backendName:"wasm",setupFunc:function(e){use=e.wasm.cwrap("MaxPoolWithArgmax",null,["number","number","number","number","boolean","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:i,strides:s,pad:o,includeBatchInIndex:l}=r;pT.assert(4===a.shape.length,(()=>`Error in maxPool: input must be rank 4 but got rank ${a.shape.length}.`));let u=[1,1];pT.assert(_P.eitherStridesOrDilationsAreOne(s,u),(()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${u}'`));let d=_P.computePool2DInfo(a.shape,i,s,[1,1],o),c=n.makeOutput(d.outShape,a.dtype),p=n.makeOutput(d.outShape,"int32");return use(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(c.dataId).id,n.dataIdMap.get(p.dataId).id,Jre[a.dtype],l,d.batchSize,d.inChannels,d.inHeight,d.inWidth,d.outHeight,d.outWidth,d.strideHeight,d.strideWidth,d.dilationHeight,d.dilationWidth,d.effectiveFilterHeight,d.effectiveFilterWidth,d.padInfo.top,d.padInfo.left),[c,p]}},qse={kernelName:NN,backendName:"wasm",setupFunc:function(e){dse=e.wasm.cwrap(NN,null,["number, number, number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:r}=e,{axis:a,keepDims:i}=r,{x:s}=n,o=t.dataIdMap.get(s.dataId).id,l=o,u=s,{transposed:d,axes:c,originalAxes:p,inputWasTransposed:h}=wae(s,a,t),f=c;if(h){let e=t.dataIdMap.get(d.dataId).id;e!==o&&(u=d,l=e,f=_P.getInnerMostAxes(f.length,u.shape.length))}_P.assertAxesAreInnerMostDims("mean",f,u.shape.length);let[m,g]=_P.computeOutAndReduceShapes(u.shape,f),b=pT.sizeFromShape(g),y=u;"float32"!==u.dtype&&(y=Zae({backend:t,inputs:{x:u},attrs:{dtype:"float32"}}),l=t.dataIdMap.get(y.dataId).id);let v=t.makeOutput(m,"float32");if(0!==pT.sizeFromShape(u.shape)){let e=t.dataIdMap.get(v.dataId).id;dse(l,b,e)}if(h&&t.disposeData(d.dataId),i){let e=_P.expandShapeToKeepDim(v.shape,p);v.shape=e}return"float32"!==u.dtype&&t.disposeData(y.dataId),v}},Kse={kernelName:CN,backendName:"wasm",setupFunc:function(e){cse=e.wasm.cwrap(CN,null,["number","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:r}=e,{axis:a,keepDims:i}=r,{x:s}=n,o=t.dataIdMap.get(s.dataId).id,l=o,u=s,{transposed:d,axes:c,originalAxes:p,inputWasTransposed:h}=wae(s,a,t);if(h){let e=t.dataIdMap.get(d.dataId).id;e!==o&&(u=d,l=e)}let f=u.shape.length;_P.assertAxesAreInnerMostDims("min",c,f);let[m,g]=_P.computeOutAndReduceShapes(u.shape,c),b=pT.sizeFromShape(g),y=t.makeOutput(m,u.dtype);if(0!==pT.sizeFromShape(u.shape)){let e=t.dataIdMap.get(y.dataId).id;cse(l,Jre[s.dtype],b,e)}if(h&&t.disposeData(d.dataId),i){let e=_P.expandShapeToKeepDim(y.shape,p);y.shape=e}return y}},Xse=cae(TN);!function(e){e[e.reflect=0]="reflect",e[e.symmetric=1]="symmetric"}(pse||(pse={}));var Yse,Jse={kernelName:EN,backendName:"wasm",kernelFunc:function(e){let{inputs:{x:t},backend:n,attrs:{paddings:r,mode:a}}=e,i=r.map(((e,n)=>e[0]+t.shape[n]+e[1])),s=n.dataIdMap.get(t.dataId).id,o=n.makeOutput(i,t.dtype),l=n.dataIdMap.get(o.dataId).id,u=new Uint8Array(new Int32Array(t.shape).buffer),d=r.map((e=>e[0])),c=r.map((e=>e[1])),p=new Uint8Array(new Int32Array(d).buffer),h=new Uint8Array(new Int32Array(c).buffer);return hse(s,u,t.shape.length,Jre[t.dtype],p,h,pse[a],l),o},setupFunc:function(e){hse=e.wasm.cwrap(EN,null,["number","array","number","number","array","array","number","number"])}};function Zse(e){let{backend:t,inputs:{logits:n},attrs:{dim:r}}=e,a=t.dataIdMap.get(n.dataId).id,i=t.makeOutput(n.shape,n.dtype),s=t.dataIdMap.get(i.dataId).id,o=n.shape[r],l=pT.sizeFromShape(n.shape)/o;return 0===pT.sizeFromShape(i.shape)||Yse(a,s,o,l),i}var Qse,eoe,toe={kernelName:kC,backendName:"wasm",setupFunc:function(e){Yse=e.wasm.cwrap(kC,null,["number","number","number","number"])},kernelFunc:Zse},noe={kernelName:$N,backendName:"wasm",setupFunc:function(e){Qse=e.wasm.cwrap($N,null,["number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{logits:a}=t,{numSamples:i,seed:s,normalized:o}=r;if("float32"!==a.dtype)throw new Error(`Tensor logits must have dtype float32, got ${a.dtype}`);let l=o?a:Zse({inputs:{logits:a},backend:n,attrs:{dim:a.shape.length-1}}),[u,d]=l.shape,c=n.makeOutput([u,i],"int32");return Qse(n.dataIdMap.get(l.dataId).id,u,d,i,s,n.dataIdMap.get(c.dataId).id),o||n.disposeData(l.dataId),c}},roe=cae(_N),aoe=cae(AN),ioe=oae(RN);function soe(e,t){let n=new Int32Array(e.wasm.HEAPU8.buffer,t,4),r=n[0],a=n[1],i=n[2],s=n[3];return e.wasm._free(t),{pSelectedIndices:r,selectedSize:a,pSelectedScores:i,pValidOutputs:s}}var ooe,loe,uoe,doe,coe,poe,hoe,foe,moe,goe,boe,yoe,voe,xoe,woe,koe,Soe,Ioe,Noe,Coe={kernelName:FN,backendName:"wasm",setupFunc:function(e){eoe=e.wasm.cwrap(FN,"number",["number","number","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:r}=e,{iouThreshold:a,maxOutputSize:i,scoreThreshold:s}=r,{boxes:o,scores:l}=n,u=t.dataIdMap.get(o.dataId).id,d=t.dataIdMap.get(l.dataId).id,c=eoe(u,d,i,a,s),{pSelectedIndices:p,selectedSize:h,pSelectedScores:f,pValidOutputs:m}=soe(t,c);return t.wasm._free(f),t.wasm._free(m),t.makeOutput([h],"int32",p)}},Toe={kernelName:MN,backendName:"wasm",setupFunc:function(e){ooe=e.wasm.cwrap(MN,"number",["number","number","number","number","number","bool"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:r}=e,{iouThreshold:a,maxOutputSize:i,scoreThreshold:s,padToMaxOutputSize:o}=r,{boxes:l,scores:u}=n,d=t.dataIdMap.get(l.dataId).id,c=t.dataIdMap.get(u.dataId).id,p=ooe(d,c,i,a,s,o),{pSelectedIndices:h,selectedSize:f,pSelectedScores:m,pValidOutputs:g}=soe(t,p);return t.wasm._free(m),[t.makeOutput([f],"int32",h),t.makeOutput([],"int32",g)]}},Eoe={kernelName:ON,backendName:"wasm",setupFunc:function(e){loe=e.wasm.cwrap(ON,"number",["number","number","number","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:r}=e,{iouThreshold:a,maxOutputSize:i,scoreThreshold:s,softNmsSigma:o}=r,{boxes:l,scores:u}=n,d=t.dataIdMap.get(l.dataId).id,c=t.dataIdMap.get(u.dataId).id,p=loe(d,c,i,a,s,o),{pSelectedIndices:h,selectedSize:f,pSelectedScores:m,pValidOutputs:g}=soe(t,p);return t.wasm._free(g),[t.makeOutput([f],"int32",h),t.makeOutput([f],"float32",m)]}},_oe=cae(DN,0,"bool"),$oe={kernelName:LN,backendName:"wasm",setupFunc:function(e){uoe=e.wasm.cwrap(LN,null,["number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{indices:a}=t,{dtype:i,depth:s,onValue:o,offValue:l}=r,u=n.makeOutput([...a.shape,s],i),d=n.dataIdMap.get(u.dataId).id,c=n.dataIdMap.get(a.dataId).id;return uoe(c,s,o,l,d),u}},Aoe={kernelName:PN,backendName:"wasm",kernelFunc:function(e){let{inputs:{x:t},backend:n}=e,r=n.makeOutput(t.shape,t.dtype);return n.typedArrayFromHeap(r).fill(1),r}},Roe={kernelName:zN,backendName:"wasm",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{axis:a}=r;if(1===t.length)return jie({inputs:{input:t[0]},backend:n,attrs:{dim:a}});let i=t[0].shape,s=t[0].dtype;t.forEach((e=>{pT.assertShapesMatch(i,e.shape,"All tensors passed to stack must have matching shapes"),pT.assert(s===e.dtype,(()=>"All tensors passed to stack must have matching dtypes"))}));let o=[],l=t.map((e=>{let t=jie({inputs:{input:e},backend:n,attrs:{dim:a}});return o.push(t),t})),u=rie({inputs:l,backend:n,attrs:{axis:a}});return o.forEach((e=>n.disposeData(e.dataId))),u}},Doe={kernelName:BN,backendName:"wasm",kernelFunc:function(e){let{inputs:{x:t},backend:n,attrs:{paddings:r,constantValue:a}}=e,i=r.map(((e,n)=>e[0]+t.shape[n]+e[1]));if(0===pT.sizeFromShape(t.shape))return qie({backend:n,attrs:{shape:i,value:a,dtype:t.dtype}});let s=n.dataIdMap.get(t.dataId).id,o=n.makeOutput(i,t.dtype),l=n.dataIdMap.get(o.dataId).id,u=new Uint8Array(new Int32Array(t.shape).buffer),d=r.map((e=>e[0])),c=r.map((e=>e[1])),p=new Uint8Array(new Int32Array(d).buffer),h=new Uint8Array(new Int32Array(c).buffer);return doe(s,u,t.shape.length,Jre[t.dtype],p,h,a,l),o},setupFunc:function(e){doe=e.wasm.cwrap(BN,null,["number","array","number","number","array","array","number","number"])}},Foe=cae(VN),Moe={kernelName:UN,backendName:"wasm",setupFunc:function(e){coe=e.wasm.cwrap(UN,null,["number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n}=e,{x:r,alpha:a}=t,i=n.dataIdMap.get(r.dataId).id,s=n.dataIdMap.get(a.dataId).id,o=i,l=r,u=l;"float32"!==l.dtype&&(u=Zae({backend:n,inputs:{x:r},attrs:{dtype:"float32"}}),o=n.dataIdMap.get(u.dataId).id);let d=n.makeOutput(r.shape,"float32"),c=n.dataIdMap.get(d.dataId).id;return coe(o,s,c),"float32"!==l.dtype&&n.disposeData(u.dataId),d}},Ooe={kernelName:jN,backendName:"wasm",setupFunc:function(e){poe=e.wasm.cwrap(jN,null,["number","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:r}=e,{axis:a,keepDims:i}=r,{x:s}=n,o=t.dataIdMap.get(s.dataId).id,l=o,u=s,{transposed:d,axes:c,originalAxes:p,inputWasTransposed:h}=wae(s,a,t),f=c;if(h){let e=t.dataIdMap.get(d.dataId).id;e!==o&&(u=d,l=e,f=_P.getInnerMostAxes(f.length,u.shape.length))}_P.assertAxesAreInnerMostDims("prod",f,u.shape.length);let[m,g]=_P.computeOutAndReduceShapes(u.shape,f),b=pT.sizeFromShape(g),y=t.makeOutput(m,u.dtype);if(0!==pT.sizeFromShape(u.shape)){let e=t.dataIdMap.get(y.dataId).id;poe(l,b,Jre[y.dtype],e)}if(h&&t.disposeData(d.dataId),i){let e=_P.expandShapeToKeepDim(y.shape,p);y.shape=e}return y}},Poe={kernelName:KN,backendName:"wasm",kernelFunc:e=>{let{backend:t,attrs:n}=e,{start:r,stop:a,step:i,dtype:s}=n,o=VQ(r,a,i,s),l=t.makeOutput([o.length],s);return t.typedArrayFromHeap(l).set(o),l}},Loe=cae(RI),zoe=oae(YN),Boe=oae(JN),Woe=oae(rC),Voe={kernelName:tC,backendName:"wasm",setupFunc:function(e){hoe=e.wasm.cwrap(tC,null,["number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let t,{backend:n,inputs:r,attrs:a}=e,{images:i}=r,{alignCorners:s,halfPixelCenters:o,size:l}=a,[u,d]=l,[c,p,h,f]=i.shape,m=[c,u,d,f],g=n.dataIdMap.get(i.dataId);"float32"!==g.dtype&&(t=Zae({backend:n,inputs:{x:i},attrs:{dtype:"float32"}}),g=n.dataIdMap.get(t.dataId));let b=g.id,y=n.makeOutput(m,"float32");if(0===pT.sizeFromShape(i.shape))return y;let v=n.dataIdMap.get(y.dataId).id;return hoe(b,c,p,h,f,u,d,s?1:0,o?1:0,v),null!=t&&n.disposeData(t.dataId),y}},Uoe={kernelName:nC,backendName:"wasm",setupFunc:function(e){foe=e.wasm.cwrap(nC,null,["number","number","number","array","array","boolean"])},kernelFunc:function(e){let t,{inputs:n,backend:r,attrs:a}=e,{images:i,dy:s}=n,{alignCorners:o}=a,l=r.makeOutput(i.shape,"float32"),u=r.dataIdMap.get(i.dataId);return"float32"!==u.dtype&&(t=Zae({backend:r,inputs:{x:i},attrs:{dtype:"float32"}}),u=r.dataIdMap.get(t.dataId)),foe(r.dataIdMap.get(i.dataId).id,r.dataIdMap.get(s.dataId).id,r.dataIdMap.get(l.dataId).id,new Uint8Array(new Int32Array(i.shape).buffer),new Uint8Array(new Int32Array(s.shape).buffer),o),null!=t&&r.disposeData(t.dataId),l}},joe={kernelName:QN,backendName:"wasm",setupFunc:function(e){moe=e.wasm.cwrap(QN,null,["number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:r}=e,{images:a}=n,{alignCorners:i,halfPixelCenters:s,size:o}=r,[l,u]=o,[d,c,p,h]=a.shape,f=[d,l,u,h],m=t.makeOutput(f,"float32");if(0===pT.sizeFromShape(a.shape))return m;let g,b=t.dataIdMap.get(a.dataId);"float32"!==b.dtype&&(g=Zae({backend:t,inputs:{x:a},attrs:{dtype:"float32"}}),b=t.dataIdMap.get(g.dataId));let y=b.id,v=t.dataIdMap.get(m.dataId).id;return moe(y,d,c,p,h,l,u,i?1:0,s?1:0,v),null!=g&&t.disposeData(g.dataId),m}},Hoe={kernelName:eC,backendName:"wasm",setupFunc:function(e){goe=e.wasm.cwrap(eC,null,["number","number","number","array","array","boolean"])},kernelFunc:function(e){let t,{inputs:n,backend:r,attrs:a}=e,{images:i,dy:s}=n,{alignCorners:o}=a,l=r.makeOutput(i.shape,"float32"),u=r.dataIdMap.get(i.dataId);return"float32"!==u.dtype&&(t=Zae({backend:r,inputs:{x:i},attrs:{dtype:"float32"}}),u=r.dataIdMap.get(t.dataId)),goe(r.dataIdMap.get(i.dataId).id,r.dataIdMap.get(s.dataId).id,r.dataIdMap.get(l.dataId).id,new Uint8Array(new Int32Array(i.shape).buffer),new Uint8Array(new Int32Array(s.shape).buffer),o),null!=t&&r.disposeData(t.dataId),l}},Goe={kernelName:aC,backendName:"wasm",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{dims:i}=r,s=pT.parseAxisParam(i,a.shape);if(0===a.shape.length)return mae({inputs:{x:a},backend:n});let o=n.makeOutput(a.shape,a.dtype),l=n.dataIdMap.get(a.dataId).id,u=n.dataIdMap.get(o.dataId).id,d=new Uint8Array(new Int32Array(s).buffer),c=new Uint8Array(new Int32Array(a.shape).buffer);boe(l,d,s.length,c,a.shape.length,u);let p=Wae({inputs:{x:o},attrs:{shape:a.shape},backend:n});return n.disposeData(o.dataId),p},setupFunc:function(e){boe=e.wasm.cwrap(aC,null,["number","array","number","array","number","number"])}},qoe={kernelName:XC,backendName:"wasm",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{image:a}=t,{radians:i,fillValue:s,center:o}=r,l=n.makeOutput(a.shape,a.dtype),u=n.dataIdMap.get(a.dataId).id,d=n.dataIdMap.get(l.dataId).id,[c,p,h,f]=a.shape,[m,g]=_P.getImageCenter(o,p,h),b="number"==typeof s?[s,s,s,0===s?0:255]:[...s,255],y=new Uint8Array(new Int32Array(b).buffer);return yoe(u,c,p,h,f,i,m,g,y,b.length,d),l},setupFunc:function(e){yoe=e.wasm.cwrap(XC,null,["number","number","number","number","number","number","number","number","array","number","number"])}},Koe=oae(iC),Xoe=oae(sC),Yoe={kernelName:oC,backendName:"wasm",setupFunc:function(e){voe=e.wasm.cwrap(oC,null,["number","number","number","number","number","number","array","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:r}=e,{indices:a,updates:i}=n,{shape:s}=r,o=t.makeOutput(s,i.dtype);if(0===pT.sizeFromShape(s))return o;let{sliceRank:l,numUpdates:u,sliceSize:d,strides:c,outputSize:p}=NF.calculateShapes(i,a,s),h=t.dataIdMap.get(a.dataId).id,f=t.dataIdMap.get(i.dataId).id,m=new Uint8Array(new Int32Array(c).buffer),g=t.dataIdMap.get(o.dataId).id;return voe(h,f,Jre[i.dtype],l,u,d,m,p,g),o}},Joe={kernelName:uC,backendName:"wasm",setupFunc:function(e){xoe=e.wasm.cwrap(uC,null,["number","number","number","number","number","number","bool","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{sortedSequence:a,values:i}=t,{side:s}=r;if(a.dtype!==i.dtype)throw new Error(`SearchSorted error: sorted_sequence must have the same dtype as values. Got ${a.dtype} and ${i.dtype}`);let o=n.makeOutput(i.shape,"int32");function l(e){return n.dataIdMap.get(e.dataId).id}return xoe(l(a),l(i),a.shape[0],a.shape[1],i.shape[1],Jre[a.dtype],"left"===s,l(o)),o}},Zoe={kernelName:dC,backendName:"wasm",kernelFunc:function(e){let{inputs:t,backend:n}=e,{condition:r,t:a,e:i}=t,s=n.dataIdMap.get(r.dataId).id,o=n.dataIdMap.get(a.dataId).id,l=n.dataIdMap.get(i.dataId).id,u=n.makeOutput(a.shape,a.dtype),d=n.dataIdMap.get(u.dataId).id,c=r.shape.length,p=a.shape.length,h=0===c||c>1||1===p?1:pT.sizeFromShape(a.shape.slice(1));return woe(s,o,l,h,d),u},setupFunc:function(e){woe=e.wasm.cwrap("SelectV2",null,["number","number","number","number","number"])}},Qoe=oae(cC),ele={kernelName:"Sigmoid",backendName:"wasm",setupFunc:function(e){koe=e.wasm.cwrap(gC,null,["number","number"])},kernelFunc:function(e){let{backend:t,inputs:{x:n}}=e,r=t.dataIdMap.get(n.dataId).id,a=t.makeOutput(n.shape,n.dtype),i=t.dataIdMap.get(a.dataId).id;return 0===pT.sizeFromShape(a.shape)||koe(r,i),a}},tle=oae(mC),nle=oae(hC),rle=oae(fC),ale=oae(bC),ile={kernelName:xC,backendName:"wasm",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:i,paddings:s}=r,o=pT.sizeFromShape(i),l=[[0,0]];l.push(...s);for(let g=1+i.length;g<a.shape.length;++g)l.push([0,0]);let u=Doe.kernelFunc({inputs:{x:a},backend:n,attrs:{paddings:l,constantValue:0}}),d=_P.getReshaped(u.shape,i,o,!1),c=_P.getPermuted(d.length,i.length,!1),p=_P.getReshapedPermuted(u.shape,i,o,!1),h=Wae({inputs:{x:u},backend:n,attrs:{shape:d}}),f=yae({inputs:{x:h},backend:n,attrs:{perm:c}}),m=Wae({inputs:{x:f},backend:n,attrs:{shape:p}});return n.disposeData(u.dataId),n.disposeData(h.dataId),n.disposeData(f.dataId),m}},sle={kernelName:SC,backendName:"wasm",setupFunc:function(e){Soe=e.wasm.cwrap("SparseFillEmptyRows","number",["number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let t,{backend:n,inputs:r}=e,{indices:a,values:i,denseShape:s,defaultValue:o}=r,l=a.shape[0],u=a.shape[1],d=n.readSync(s.dataId)[0],c=[l+d,u],p=n.dataIdMap.get(a.dataId).id,h=n.dataIdMap.get(i.dataId).id,f=n.dataIdMap.get(o.dataId).id,m=n.makeOutput(c,a.dtype),g=n.dataIdMap.get(m.dataId).id,b=n.makeOutput(c.slice(0,1),i.dtype),y=n.dataIdMap.get(b.dataId).id,v=n.makeOutput([d],"bool"),x=n.dataIdMap.get(v.dataId).id,w=n.makeOutput([l],a.dtype),k=n.dataIdMap.get(w.dataId).id,S=n.makeOutput([4],"int32"),I=n.dataIdMap.get(S.dataId).id,N=Soe(p,h,Jre[i.dtype],l,d,u,f,g,y,x,k,I),C=n.readSync(S.dataId);switch(C[0]){case 1:t=_P.getSparseFillEmptyRowsIndicesDenseShapeMismatch(C[1]);break;case 2:t=_P.getSparseFillEmptyRowsNegativeIndexErrorMessage(C[1],C[2]);break;case 3:t=_P.getSparseFillEmptyRowsOutOfRangeIndexErrorMessage(C[1],C[2],C[3]);break;default:t=""}if(n.disposeData(S.dataId),t)throw n.disposeData(m.dataId),n.disposeData(b.dataId),n.disposeData(v.dataId),n.disposeData(w.dataId),new Error(t);let T=m,E=b;return N!==c[0]&&(T=Hae({inputs:{x:m},attrs:{begin:0,size:[N,u]},backend:n}),E=Hae({inputs:{x:b},attrs:{begin:0,size:N},backend:n}),n.disposeData(m.dataId),n.disposeData(b.dataId)),[T,E,v,w]}},ole={kernelName:IC,backendName:"wasm",setupFunc:function(e){Ioe=e.wasm.cwrap(IC,null,["number","number","number","number","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n}=e,{inputIndices:r,inputShape:a,newShape:i}=n;if(2!==r.shape.length)throw new Error(`Input indices should be a matrix but received shape\n        ${r.shape}`);if(1!==a.shape.length)throw new Error(`Input shape should be a vector but received shape\n        ${a.shape}`);if(1!==i.shape.length)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);let s=t.dataIdMap.get(r.dataId).id,o=t.dataIdMap.get(a.dataId).id,l=t.dataIdMap.get(i.dataId).id,u=r.shape[0],d=pT.sizeFromShape(i.shape),c=t.makeOutput([u,d],r.dtype),p=t.dataIdMap.get(c.dataId).id,h=t.makeOutput([d],i.dtype),f=t.dataIdMap.get(h.dataId).id,m=t.makeOutput([3],"int32"),g=t.dataIdMap.get(m.dataId).id;Ioe(s,o,l,u,p,f,g);let b,y=t.readSync(m.dataId);switch(y[0]){case 0:b=_P.getSparseReshapeMultipleNegativeOneOutputDimErrorMessage(y[1],y[2]);break;case 1:b=_P.getSparseReshapeNegativeOutputDimErrorMessage(y[1],y[2]);break;case 2:b=_P.getSparseReshapeEmptyTensorZeroOutputDimErrorMessage();break;case 3:{let e=Array.from(t.readSync(a.dataId)),n=Array.from(t.readSync(h.dataId));b=_P.getSparseReshapeInputOutputMultipleErrorMessage(e,n);break}case 4:{let e=Array.from(t.readSync(a.dataId)),n=Array.from(t.readSync(h.dataId));b=_P.getSparseReshapeInputOutputMismatchErrorMessage(e,n);break}default:b=""}if(t.disposeData(m.dataId),b)throw t.disposeData(c.dataId),t.disposeData(h.dataId),new Error(b);return[c,h]}};function lle(e){Noe=e.wasm.cwrap("SparseSegmentReduction",null,["number","number","number","number","number","number","number","number","number"])}function ule(e,t){let{backend:n,inputs:r}=e,{data:a,indices:i,segmentIds:s}=r,o=i.shape[0],l=n.readSync(s.dataId,o-1,o)[0],u=o>0?l+1:0;if(u<0)throw new Error(_P.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let d=a.shape.slice();d[0]=u;let c=n.dataIdMap.get(a.dataId).id,p=n.dataIdMap.get(i.dataId).id,h=n.dataIdMap.get(s.dataId).id,f=n.makeOutput(d,a.dtype),m=n.dataIdMap.get(f.dataId).id,g=n.makeOutput([4],"int32"),b=n.dataIdMap.get(g.dataId).id;Noe(c,Jre[a.dtype],a.shape[0],p,h,m,b,t,0);let y,v=n.readSync(g.dataId);switch(v[0]){case 0:y=_P.getSparseSegmentReductionNegativeSegmentIdsErrorMessage();break;case 1:y=_P.getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage();break;case 2:y=_P.getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage(v[1],v[2]);break;case 3:y=_P.getSparseSegmentReductionIndicesOutOfRangeErrorMessage(v[1],v[2],v[3]);break;default:y=""}if(n.disposeData(g.dataId),y)throw n.disposeData(f.dataId),new Error(y);return f}var dle,cle,ple,hle,fle,mle,gle,ble,yle={kernelName:NC,backendName:"wasm",setupFunc:lle,kernelFunc:function(e){return ule(e,!0)}},vle={kernelName:CC,backendName:"wasm",setupFunc:lle,kernelFunc:function(e){return ule(e,!1)}},xle={kernelName:TC,backendName:"wasm",setupFunc:function(e){dle=e.wasm.cwrap(TC,null,["number","number","number","number","number","number","number","number","array","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:r}=e,{sparseIndices:a,sparseValues:i,defaultValue:s}=n,{outputShape:o}=r,l=t.makeOutput(o,s.dtype);if(0===pT.sizeFromShape(o))return l;let{sliceRank:u,numUpdates:d,sliceSize:c,strides:p,outputSize:h}=_P.calculateShapes(i,a,o),f=t.dataIdMap.get(a.dataId).id,m=t.dataIdMap.get(i.dataId).id,g=t.dataIdMap.get(s.dataId).id,b=new Uint8Array(new Int32Array(p).buffer),y=t.dataIdMap.get(l.dataId).id;return dle(f,m,i.shape.length,g,Jre[s.dtype],u,d,c,b,h,y),l}},wle={kernelName:wC,backendName:"wasm",kernelFunc:function(e){let{inputs:t,attrs:n,backend:r}=e,{x:a}=t,{numOrSizeSplits:i,axis:s}=n,o=pT.parseAxisParam(s,a.shape)[0],l=_P.prepareSplitSize(a,i,o),u=new Array(a.shape.length).fill(0),d=a.shape.slice();return l.map((e=>{let t=[...d];t[o]=e;let n=Hae({inputs:{x:a},attrs:{begin:u,size:t},backend:r});return u[o]+=e,n}))}},kle=oae(yC),Sle=oae(_C),Ile=cae(EC),Nle={kernelName:qC,backendName:"wasm",setupFunc:function(e){cle=e.wasm.cwrap(qC,null,["number","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:r}=e,{alpha:a}=r,{x:i}=n,s=t.dataIdMap.get(i.dataId).id,o=t.makeOutput(i.shape,i.dtype),l=t.dataIdMap.get(o.dataId).id;return cle(s,a,Jre[i.dtype],l),o}},Cle={kernelName:AC,backendName:"wasm",setupFunc:function(e){ple=e.wasm.cwrap(AC,null,["number","array","number","array","array","array","array","array","number","number"])},kernelFunc:function(e){let t,{backend:n,inputs:r,attrs:a}=e,{x:i}=r,{begin:s,end:o,strides:l,beginMask:u,endMask:d,ellipsisMask:c,newAxisMask:p,shrinkAxisMask:h}=a,{finalShapeSparse:f,finalShape:m,isIdentity:g,sliceDim0:b,isSimpleSlice:y,begin:v,end:x,strides:w}=rP.sliceInfo(i.shape,s,o,l,u,d,c,p,h);if(g)t=Wae({inputs:{x:i},backend:n,attrs:{shape:m}});else if(b||y){pT.assert(i.shape.length>=1,(()=>`Input must have rank at least 1, got: ${i.shape.length}`));let e=rP.computeOutShape(v,x,w),r=Hae({inputs:{x:i},backend:n,attrs:{begin:v,size:e}});t=Wae({inputs:{x:r},backend:n,attrs:{shape:m}}),n.disposeData(r.dataId)}else{let e=n.makeOutput(f,"float32"),r=n.dataIdMap.get(i.dataId).id,a=new Uint8Array(new Int32Array(pT.computeStrides(i.shape)).buffer),s=new Uint8Array(new Int32Array(v).buffer),o=new Uint8Array(new Int32Array(x).buffer),l=new Uint8Array(new Int32Array(w).buffer),u=new Uint8Array(new Int32Array(f).buffer),d=new Uint8Array(new Int32Array(pT.computeStrides(f)).buffer),c=n.dataIdMap.get(e.dataId).id;ple(r,a,i.shape.length,s,o,l,u,d,f.length,c),t=Wae({inputs:{x:e},backend:n,attrs:{shape:m}}),n.disposeData(e.dataId)}return t}},Tle={kernelName:RC,backendName:"wasm",kernelFunc:function(e){let{backend:t,inputs:n,attrs:r}=e,{data:a,dataSplits:i}=n,{separator:s,nGramWidths:o,leftPad:l,rightPad:u,padWidth:d,preserveShortSequences:c}=r,p=t.readSync(a.dataId),h=t.readSync(i.dataId),[f,m]=h0(p,h,s,o,l,u,d,c),g=t.makeOutput([f.length],"string");t.dataIdMap.get(g.dataId).stringBytes=f;let b=t.makeOutput(i.shape,"int32");return t.typedArrayFromHeap(b).set(m),[g,b]}},Ele={kernelName:DC,backendName:"wasm",kernelFunc:function(e){let{backend:t,inputs:n,attrs:r}=e,{input:a,delimiter:i}=n,{skipEmpty:s}=r,o=t.readSync(a.dataId),l=t.readSync(i.dataId),[u,d,c]=m0(o,l[0],s),p=d.length,h=t.makeOutput([p,2],"int32");t.typedArrayFromHeap(h).set(u);let f=t.makeOutput([p],"string");t.dataIdMap.get(f.dataId).stringBytes=d;let m=t.makeOutput([2],"int32");return t.typedArrayFromHeap(m).set(c),[h,f,m]}},_le={kernelName:FC,backendName:"wasm",kernelFunc:function(e){let{backend:t,inputs:n,attrs:r}=e,{input:a}=n,{numBuckets:i}=r,s=g0(t.readSync(a.dataId),i),o=t.makeOutput(a.shape,"int32");return t.typedArrayFromHeap(o).set(s),o}},$le=cae(MC),Ale={kernelName:vC,backendName:"wasm",setupFunc:function(e){hle=e.wasm.cwrap(vC,null,["number","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:r}=e,{axis:a,keepDims:i}=r,{x:s}=n,o=t.dataIdMap.get(s.dataId).id,l=o,u=s,{transposed:d,axes:c,originalAxes:p,inputWasTransposed:h}=wae(s,a,t),f=c;if(h){let e=t.dataIdMap.get(d.dataId).id;e!==o&&(u=d,l=e,f=_P.getInnerMostAxes(f.length,u.shape.length))}_P.assertAxesAreInnerMostDims("sum",f,u.shape.length);let[m,g]=_P.computeOutAndReduceShapes(u.shape,f),b=pT.sizeFromShape(g),y=t.makeOutput(m,u.dtype);if(0!==pT.sizeFromShape(u.shape)){let e=t.dataIdMap.get(y.dataId).id;hle(l,b,Jre[y.dtype],e)}if(h&&t.disposeData(d.dataId),i){let e=_P.expandShapeToKeepDim(y.shape,p);y.shape=e}return y}},Rle=oae(OC),Dle=oae(PC),Fle={kernelName:lC,backendName:"wasm",setupFunc:function(e){fle=e.wasm.cwrap(lC,null,["number","number","number","number","number","number","array","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:r}=e,{tensor:a,indices:i,updates:s}=n,o=t.makeOutput(a.shape,a.dtype);if(0===pT.sizeFromShape(a.shape))return o;let{sliceRank:l,numUpdates:u,sliceSize:d,strides:c,outputSize:p}=NF.calculateShapes(s,i,a.shape),h=t.dataIdMap.get(i.dataId).id,f=t.dataIdMap.get(s.dataId).id,m=t.dataIdMap.get(a.dataId).id,g=new Uint8Array(new Int32Array(c).buffer),b=t.dataIdMap.get(o.dataId).id;return fle(h,f,Jre[s.dtype],l,u,d,g,p,b,m),o}},Mle={kernelName:LC,backendName:"wasm",setupFunc:function(e){mle=e.wasm.cwrap(LC,null,["number","array","number","array","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,i=n.dataIdMap.get(a.dataId).id,{reps:s}=r,o=new Array(a.shape.length);for(let p=0;p<o.length;p++)o[p]=a.shape[p]*s[p];let l=new Uint8Array(new Int32Array(a.shape).buffer),u=new Uint8Array(new Int32Array(o).buffer),d=n.makeOutput(o,a.dtype),c=n.dataIdMap.get(d.dataId).id;return mle(i,l,a.shape.length,u,o.length,Jre[d.dtype],c),d}},Ole={kernelName:zC,backendName:"wasm",setupFunc:function(e){gle=e.wasm.cwrap(zC,null,["number","array","number","number","number","bool","number","number"])},kernelFunc:({inputs:e,backend:t,attrs:n})=>{let{x:r}=e,{k:a,sorted:i}=n,s=t.dataIdMap.get(r.dataId).id,o=new Uint8Array(new Int32Array(r.shape).buffer),l=r.shape.slice();l[l.length-1]=a;let u=t.makeOutput(l,r.dtype),d=t.dataIdMap.get(u.dataId).id,c=t.makeOutput(l,"int32"),p=t.dataIdMap.get(c.dataId).id;return gle(s,o,r.shape.length,Jre[r.dtype],a,i,d,p),[u,c]}},Ple={kernelName:BC,backendName:"wasm",setupFunc:function(e){ble=e.wasm.cwrap(BC,null,["number","number","bool","number","number","number","number","number","number","array","number","array","number","number","number","number","number"])},kernelFunc:function(e){let t,{backend:n,inputs:r,attrs:a}=e,{image:i,transforms:s}=r,{interpolation:o,fillMode:l,fillValue:u,outputShape:d}=a,[c,p,h,f]=i.shape,[m,g]=null!=d?d:[p,h],b=[c,m,g,f],y=new Uint8Array(new Int32Array(pT.computeStrides(i.shape)).buffer),v=new Uint8Array(new Int32Array(pT.computeStrides(b)).buffer),x=n.makeOutput(b,i.dtype),w=n.dataIdMap.get(x.dataId).id,k=n.dataIdMap.get(i.dataId).id,S=n.dataIdMap.get(s.dataId).id,I="nearest"===o?1:2;switch(l){case"constant":default:t=1;break;case"reflect":t=2;break;case"wrap":t=3;break;case"nearest":t=4}return ble(k,S,s.shape[0]>1,c,m,g,f,h,p,y,i.shape.length-1,v,b.length-1,I,t,u,w),x}},Lle={kernelName:VC,backendName:"wasm",kernelFunc:function(e){let{inputs:t,attrs:n,backend:r}=e,{axis:a}=n,{x:i}=t,{outputValues:s,outputShape:o,indices:l}=N0(r.readSync(i.dataId),a,i.shape,i.dtype);return[r.makeOutput(o,i.dtype,void 0,s),r.makeOutput([l.length],"int32",void 0,l)]}},zle={kernelName:UC,backendName:"wasm",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{value:a}=t,{axis:i}=r;i<0&&(i+=a.shape.length);let s=a.shape[i],o=a.shape.length,l=new Array(o-1),u=0;for(let h=0;h<o;h++)h!==i&&(l[u++]=a.shape[h]);let d=new Array(s),c=new Array(o).fill(0),p=a.shape.slice();p[i]=1;for(let h=0;h<d.length;h++)c[i]=h,d[h]=Hae({inputs:{x:a},attrs:{begin:c,size:p},backend:n});return d.map((({dataId:e,dtype:t})=>({dataId:e,dtype:t,shape:l})))}},Ble={kernelName:GC,backendName:"wasm",kernelFunc:function(e){let{inputs:{x:t},backend:n}=e,r=n.makeOutput(t.shape,t.dtype);return n.typedArrayFromHeap(r).fill(0),r}},Wle=[sae,lae,uae,dae,hae,fae,Sae,Iae,$ae,Aae,Rae,Dae,Fae,Mae,Oae,Pae,Bae,Lae,zae,jae,Kae,Xae,Yae,Jae,eie,tie,nie,cie,pie,hie,fie,mie,gie,bie,yie,_ie,$ie,Aie,Rie,Die,Fie,Mie,Oie,Pie,Lie,zie,Bie,Wie,Vie,Uie,Hie,Gie,fse,mse,gse,bse,yse,vse,xse,wse,kse,Sse,Ise,bae,Nse,Cse,Tse,Ese,_se,$se,Ase,Dse,Rse,Fse,Mse,Ose,Pse,Lse,zse,Bse,Wse,Vse,Use,jse,Hse,Gse,qse,Kse,Xse,Jse,noe,roe,aoe,ioe,Coe,Toe,Eoe,_oe,$oe,Aoe,Roe,Doe,Foe,Moe,Ooe,Poe,Loe,zoe,Boe,Woe,Uae,Voe,Uoe,joe,Hoe,Goe,qoe,Koe,Xoe,Yoe,Joe,Zoe,Qoe,ele,tle,nle,rle,qae,toe,ale,ile,sle,ole,yle,vle,xle,wle,kle,Sle,Ile,Nle,Cle,Tle,Ele,_le,$le,Ale,Rle,Dle,Fle,Mle,Ole,Ple,xae,Lle,zle,Ble];for(let e of Wle)sT(e);var Vle=$S();Vle.registerFlag("WASM_HAS_SIMD_SUPPORT",(async()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]))}catch(kp){return!1}})),Vle.registerFlag("WASM_HAS_MULTITHREAD_SUPPORT",(async()=>{if(Vle.get("IS_NODE"))return!1;try{return(new MessageChannel).port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch(kp){return!1}}));var Ule=lk(Tk()),jle=lk(Ek()),Hle=lk(_k()),Gle=Ule.default||Ule,qle=Hle.default||Hle,Kle=class extends Ak{constructor(e){super(),this.wasm=e,this.dataIdNextNumber=1,this.wasm.tfjs.initWithThreadsCount(iue),sue=this.wasm.tfjs.getThreadsCount(),this.dataIdMap=new $k(this,W_())}write(e,t,n){let r={id:this.dataIdNextNumber++};return this.move(r,e,t,n,1),r}numDataIds(){return this.dataIdMap.numDataIds()}async time(e){let t=pT.now();return e(),{kernelMs:pT.now()-t}}move(e,t,n,r,a){let i=this.dataIdNextNumber++;if("string"===r){let s=t;return void this.dataIdMap.set(e,{id:i,stringBytes:s,shape:n,dtype:r,memoryOffset:null,refCount:a})}let s=pT.sizeFromShape(n),o=s*pT.bytesPerElement(r),l=this.wasm._malloc(o)>>>0;this.dataIdMap.set(e,{id:i,memoryOffset:l,shape:n,dtype:r,refCount:a}),this.wasm.tfjs.registerTensor(i,s,l),null!=t&&this.wasm.HEAPU8.set(new Uint8Array(t.buffer,t.byteOffset,o),l)}async read(e){return this.readSync(e)}readSync(e,t,n){let{memoryOffset:r,dtype:a,shape:i,stringBytes:s}=this.dataIdMap.get(e);if("string"===a)return null!=t&&0!==t||!(null==n||n>=s.length)?s.slice(t,n):s;t=t||0,n=n||pT.sizeFromShape(i);let o=pT.bytesPerElement(a);return function(e,t){switch(t){case"float32":return new Float32Array(e);case"int32":return new Int32Array(e);case"bool":return new Uint8Array(e);default:throw new Error(`Unknown dtype ${t}`)}}(this.wasm.HEAPU8.slice(r+t*o,r+n*o).buffer,a)}disposeData(e,t=!1){if(this.dataIdMap.has(e)){let n=this.dataIdMap.get(e);if(n.refCount--,!t&&n.refCount>0)return!1;this.wasm._free(n.memoryOffset),this.wasm.tfjs.disposeData(n.id),this.dataIdMap.delete(e)}return!0}refCount(e){return this.dataIdMap.has(e)?this.dataIdMap.get(e).refCount:0}incRef(e){let t=this.dataIdMap.get(e);null!=t&&t.refCount++}floatPrecision(){return 32}getMemoryOffset(e){return this.dataIdMap.get(e).memoryOffset}dispose(){this.wasm.tfjs.dispose(),"PThread"in this.wasm&&this.wasm.PThread.terminateAllThreads(),this.wasm=null}memory(){return{unreliable:!1}}makeOutput(e,t,n,r){let a;if(null==n)a=this.write(null!=r?r:null,e,t);else{let r=this.dataIdNextNumber++;a={id:r},this.dataIdMap.set(a,{id:r,memoryOffset:n,shape:e,dtype:t,refCount:1});let i=pT.sizeFromShape(e);this.wasm.tfjs.registerTensor(r,i,n)}return{dataId:a,shape:e,dtype:t}}typedArrayFromHeap({shape:e,dtype:t,dataId:n}){let r=this.wasm.HEAPU8.buffer,{memoryOffset:a}=this.dataIdMap.get(n),i=pT.sizeFromShape(e);switch(t){case"float32":return new Float32Array(r,a,i);case"int32":return new Int32Array(r,a,i);case"bool":return new Uint8Array(r,a,i);default:throw new Error(`Unknown dtype ${t}`)}}};function Xle(e,t,n){if(null!=Zle)return Zle;let r="tfjs-backend-wasm.wasm";return e&&t?r="tfjs-backend-wasm-threaded-simd.wasm":e&&(r="tfjs-backend-wasm-simd.wasm"),null!=eue&&null!=eue[r]?eue[r]:n+r}async function Yle(){let[e,t]=await Promise.all([$S().getAsync("WASM_HAS_SIMD_SUPPORT"),$S().getAsync("WASM_HAS_MULTITHREAD_SUPPORT")]);return new Promise(((n,r)=>{let a={locateFile:(n,r)=>{if(n.endsWith(".worker.js")){let e=jle.wasmWorkerContents.replace(/\n/g,"\\n"),t=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(t)}return n.endsWith(".wasm")?Xle(e,t,null!=Qle?Qle:r):r+n}};nue&&(a.instantiateWasm=function(e){return(t,n)=>(pT.fetch(e,{credentials:"same-origin"}).then((r=>{r.ok||t.env.a(`failed to load wasm binary file at '${e}'`),r.arrayBuffer().then((e=>{WebAssembly.instantiate(e,t).then((e=>{n(e.instance,e.module)}))}))})),{})}(Xle(e,t,null!=Qle?Qle:"")));let i,s=!1;a.onAbort=()=>{s||tue||(tue=!0,r({message:"Make sure the server can serve the `.wasm` file relative to the bundled js file. For more details see https://github.com/tensorflow/tfjs/blob/master/tfjs-backend-wasm/README.md#using-bundlers"}))},t&&e&&null==Zle?(a.mainScriptUrlOrBlob=new Blob(["var WasmBackendModuleThreadedSimd = "+Gle.toString()],{type:"text/javascript"}),i=Gle(a)):i=qle(a),i.then((e=>{s=!0,tue=!1,e.tfjs={init:e.cwrap("init",null,[]),initWithThreadsCount:e.cwrap("init_with_threads_count",null,["number"]),getThreadsCount:e.cwrap("get_threads_count","number",[]),registerTensor:e.cwrap("register_tensor",null,["number","number","number"]),disposeData:e.cwrap("dispose_data",null,["number"]),dispose:e.cwrap("dispose",null,[])},n({wasm:e})})).catch(r)}))}var Jle=["tfjs-backend-wasm.wasm","tfjs-backend-wasm-simd.wasm","tfjs-backend-wasm-threaded-simd.wasm"],Zle=null,Qle=null,eue={},tue=!1,nue=!1;function rue(e,t=!1){if(z_("setWasmPath has been deprecated in favor of setWasmPaths and will be removed in a future release."),tue)throw new Error("The WASM backend was already initialized. Make sure you call `setWasmPath()` before you call `tf.setBackend()` or `tf.ready()`");Zle=e,nue=t}function aue(e,t=!1){if(tue)throw new Error("The WASM backend was already initialized. Make sure you call `setWasmPaths()` before you call `tf.setBackend()` or `tf.ready()`");if("string"==typeof e)Qle=e;else{eue=e;let t=Jle.filter((e=>null==eue[e]));if(t.length>0)throw new Error(`There were no entries found for the following binaries: ${t.join(",")}. Please either call setWasmPaths with a map providing a path for each binary, or with a string indicating the directory where all the binaries can be found.`)}nue=t}var iue=-1,sue=-1;function oue(e){iue=e}function lue(){if(-1===sue)throw new Error("WASM backend not initialized.");return sue}var uue="4.7.0";e$("wasm",(async()=>{let{wasm:e}=await Yle();return new Kle(e)}),2);var due="4.7.0",cue={tfjs:due,"tfjs-core":due,"tfjs-converter":"4.7.0","tfjs-backend-cpu":"4.7.0","tfjs-backend-webgl":"4.7.0","tfjs-backend-wasm":"4.7.0"};function pue(e,t,n=!1){if(e.beginPath(),t.slice(1).forEach((({x:n,y:r},a)=>{let i=t[a];e.moveTo(i.x,i.y),e.lineTo(n,r)})),n){let n=t[t.length-1],r=t[0];if(!n||!r)return;e.moveTo(n.x,n.y),e.lineTo(r.x,r.y)}e.stroke()}Qw({},{AnchorPosition:()=>ede,DrawBox:()=>ade,DrawBoxOptions:()=>rde,DrawFaceLandmarks:()=>Gde,DrawFaceLandmarksOptions:()=>Hde,DrawTextField:()=>nde,DrawTextFieldOptions:()=>tde,drawContour:()=>pue,drawDetections:()=>ide,drawFaceExpressions:()=>Vde,drawFaceLandmarks:()=>qde}),Qw({},{computeReshapedDimensions:()=>Sue,getCenterPoint:()=>Iue,isDimensions:()=>kue,isEven:()=>xue,isFloat:()=>vue,isTensor:()=>fue,isTensor1D:()=>mue,isTensor2D:()=>gue,isTensor3D:()=>bue,isTensor4D:()=>yue,isValidNumber:()=>Cue,isValidProbablitiy:()=>Tue,range:()=>Nue,round:()=>wue});var hue=class{constructor(e,t){if(!Cue(e)||!Cue(t))throw new Error(`Dimensions.constructor - expected width and height to be valid numbers, instead have ${JSON.stringify({width:e,height:t})}`);this._width=e,this._height=t}get width(){return this._width}get height(){return this._height}reverse(){return new hue(1/this.width,1/this.height)}};function fue(e,t){return e instanceof XT&&e.shape.length===t}function mue(e){return fue(e,1)}function gue(e){return fue(e,2)}function bue(e){return fue(e,3)}function yue(e){return fue(e,4)}function vue(e){return e%1!=0}function xue(e){return e%2==0}function wue(e,t=2){let n=10**t;return Math.floor(e*n)/n}function kue(e){return e&&e.width&&e.height}function Sue({width:e,height:t},n){let r=n/Math.max(t,e);return new hue(Math.round(e*r),Math.round(t*r))}function Iue(e){return e.reduce(((e,t)=>e.add(t)),new Eue(0,0)).div(new Eue(e.length,e.length))}function Nue(e,t,n){return Array(e).fill(0).map(((e,r)=>t+r*n))}function Cue(e){return!!e&&e!==1/0&&e!==-1/0&&!Number.isNaN(e)||0===e}function Tue(e){return Cue(e)&&e>=0&&e<=1}var Eue=class{constructor(e,t){this._x=e,this._y=t}get x(){return this._x}get y(){return this._y}add(e){return new Eue(this.x+e.x,this.y+e.y)}sub(e){return new Eue(this.x-e.x,this.y-e.y)}mul(e){return new Eue(this.x*e.x,this.y*e.y)}div(e){return new Eue(this.x/e.x,this.y/e.y)}abs(){return new Eue(Math.abs(this.x),Math.abs(this.y))}magnitude(){return Math.sqrt(this.x**2+this.y**2)}floor(){return new Eue(Math.floor(this.x),Math.floor(this.y))}},_ue=class{static isRect(e){return!!e&&[e.x,e.y,e.width,e.height].every(Cue)}static assertIsValidBox(e,t,n=!1){if(!_ue.isRect(e))throw new Error(`${t} - invalid box: ${JSON.stringify(e)}, expected object with properties x, y, width, height`);if(!n&&(e.width<0||e.height<0))throw new Error(`${t} - width (${e.width}) and height (${e.height}) must be positive numbers`)}constructor(e,t=!0){let n=e||{},r=[n.left,n.top,n.right,n.bottom].every(Cue),a=[n.x,n.y,n.width,n.height].every(Cue);if(!a&&!r)throw new Error(`Box.constructor - expected box to be IBoundingBox | IRect, instead have ${JSON.stringify(n)}`);let[i,s,o,l]=a?[n.x,n.y,n.width,n.height]:[n.left,n.top,n.right-n.left,n.bottom-n.top];_ue.assertIsValidBox({x:i,y:s,width:o,height:l},"Box.constructor",t),this._x=i,this._y=s,this._width=o,this._height=l}get x(){return this._x}get y(){return this._y}get width(){return this._width}get height(){return this._height}get left(){return this.x}get top(){return this.y}get right(){return this.x+this.width}get bottom(){return this.y+this.height}get area(){return this.width*this.height}get topLeft(){return new Eue(this.left,this.top)}get topRight(){return new Eue(this.right,this.top)}get bottomLeft(){return new Eue(this.left,this.bottom)}get bottomRight(){return new Eue(this.right,this.bottom)}round(){let[e,t,n,r]=[this.x,this.y,this.width,this.height].map((e=>Math.round(e)));return new _ue({x:e,y:t,width:n,height:r})}floor(){let[e,t,n,r]=[this.x,this.y,this.width,this.height].map((e=>Math.floor(e)));return new _ue({x:e,y:t,width:n,height:r})}toSquare(){let{x:e,y:t,width:n,height:r}=this,a=Math.abs(n-r);return n<r&&(e-=a/2,n+=a),r<n&&(t-=a/2,r+=a),new _ue({x:e,y:t,width:n,height:r})}rescale(e){let t=kue(e)?e.width:e,n=kue(e)?e.height:e;return new _ue({x:this.x*t,y:this.y*n,width:this.width*t,height:this.height*n})}pad(e,t){let[n,r,a,i]=[this.x-e/2,this.y-t/2,this.width+e,this.height+t];return new _ue({x:n,y:r,width:a,height:i})}clipAtImageBorders(e,t){let{x:n,y:r,right:a,bottom:i}=this,s=Math.max(n,0),o=Math.max(r,0),l=a-s,u=i-o,d=Math.min(l,e-s),c=Math.min(u,t-o);return new _ue({x:s,y:o,width:d,height:c}).floor()}shift(e,t){let{width:n,height:r}=this,a=this.x+e,i=this.y+t;return new _ue({x:a,y:i,width:n,height:r})}padAtBorders(e,t){let n=this.width+1,r=this.height+1,a=n,i=r,s=this.left,o=this.top,l=this.right,u=this.bottom;return l>t&&(a=-l+t+n,l=t),u>e&&(i=-u+e+r,u=e),s<1&&(i=2-s,s=1),o<1&&(i=2-o,o=1),{dy:1,edy:i,dx:1,edx:a,y:o,ey:u,x:s,ex:l,w:n,h:r}}calibrate(e){return new _ue({left:this.left+e.left*this.width,top:this.top+e.top*this.height,right:this.right+e.right*this.width,bottom:this.bottom+e.bottom*this.height}).toSquare().round()}},$ue=class extends _ue{constructor(e,t,n,r,a=!1){super({left:e,top:t,right:n,bottom:r},a)}},Aue=class{constructor(e,t,n,r,a){this._imageDims=new hue(a.width,a.height),this._score=e,this._classScore=t,this._className=n,this._box=new _ue(r).rescale(this._imageDims)}get score(){return this._score}get classScore(){return this._classScore}get className(){return this._className}get box(){return this._box}get imageDims(){return this._imageDims}get imageWidth(){return this.imageDims.width}get imageHeight(){return this.imageDims.height}get relativeBox(){return new _ue(this._box).rescale(this.imageDims.reverse())}forSize(e,t){return new Aue(this.score,this.classScore,this.className,this.relativeBox,{width:e,height:t})}},Rue=class extends Aue{constructor(e,t,n){super(e,e,"",t,n)}forSize(e,t){let{score:n,relativeBox:r,imageDims:a}=super.forSize(e,t);return new Rue(n,r,a)}};function Due(e,t,n=!0){let r=Math.max(0,Math.min(e.right,t.right)-Math.max(e.left,t.left))*Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top));return n?r/(e.area+t.area-r):r/Math.min(e.area,t.area)}function Fue(e,t){return j_((()=>{let[n,r,a]=t,i=tA([...e.shape.slice(0,3),1],n,"float32"),s=tA([...e.shape.slice(0,3),1],r,"float32"),o=tA([...e.shape.slice(0,3),1],a,"float32"),l=L$([i,s,o],3);return $R(e,l)}))}function Mue(e){return 1/(1+Math.exp(-e))}var Oue,Pue=class extends _ue{constructor(e,t,n,r,a=!1){super({x:e,y:t,width:n,height:r},a)}},Lue=class{constructor(e,t,n=new Eue(0,0)){let{width:r,height:a}=t;this._imgDims=new hue(r,a),this._shift=n,this._positions=e.map((e=>e.mul(new Eue(r,a)).add(n)))}get shift(){return new Eue(this._shift.x,this._shift.y)}get imageWidth(){return this._imgDims.width}get imageHeight(){return this._imgDims.height}get positions(){return this._positions}get relativePositions(){return this._positions.map((e=>e.sub(this._shift).div(new Eue(this.imageWidth,this.imageHeight))))}forSize(e,t){return new this.constructor(this.relativePositions,{width:e,height:t})}shiftBy(e,t){return new this.constructor(this.relativePositions,this._imgDims,new Eue(e,t))}shiftByPoint(e){return this.shiftBy(e.x,e.y)}align(e,t={}){if(e){let n=e instanceof Rue?e.box.floor():new _ue(e);return this.shiftBy(n.x,n.y).align(null,t)}let{useDlibAlignment:n,minBoxPadding:r}={useDlibAlignment:!1,minBoxPadding:.2,...t};return n?this.alignDlib():this.alignMinBbox(r)}alignDlib(){let e=this.getRefPointsForAlignment(),[t,n,r]=e,a=e=>r.sub(e).magnitude(),i=(a(t)+a(n))/2,s=Math.floor(i/.45),o=Iue(e),l=Math.floor(Math.max(0,o.x-.5*s)),u=Math.floor(Math.max(0,o.y-.43*s));return new Pue(l,u,Math.min(s,this.imageWidth+l),Math.min(s,this.imageHeight+u))}alignMinBbox(e){let t=function(e){let t=e.map((e=>e.x)),n=e.map((e=>e.y)),r=t.reduce(((e,t)=>t<e?t:e),1/0),a=n.reduce(((e,t)=>t<e?t:e),1/0),i=t.reduce(((e,t)=>e<t?t:e),0),s=n.reduce(((e,t)=>e<t?t:e),0);return new $ue(r,a,i,s)}(this.positions);return t.pad(t.width*e,t.height*e)}getRefPointsForAlignment(){throw new Error("getRefPointsForAlignment not implemented by base class")}},zue=class extends Lue{getJawOutline(){return this.positions.slice(0,17)}getLeftEyeBrow(){return this.positions.slice(17,22)}getRightEyeBrow(){return this.positions.slice(22,27)}getNose(){return this.positions.slice(27,36)}getLeftEye(){return this.positions.slice(36,42)}getRightEye(){return this.positions.slice(42,48)}getMouth(){return this.positions.slice(48,68)}getRefPointsForAlignment(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(Iue)}},Bue=class{constructor(e,t){this._label=e,this._distance=t}get label(){return this._label}get distance(){return this._distance}toString(e=!0){return`${this.label}${e?` (${wue(this.distance)})`:""}`}},Wue=class{constructor(e,t){if("string"!=typeof e)throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(t)||t.some((e=>!(e instanceof Float32Array))))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=e,this._descriptors=t}get label(){return this._label}get descriptors(){return this._descriptors}toJSON(){return{label:this.label,descriptors:this.descriptors.map((e=>Array.from(e)))}}static fromJSON(e){let t=e.descriptors.map((e=>new Float32Array(e)));return new Wue(e.label,t)}};function Vue(e){return e.detection instanceof Rue}function Uue(e,t){return{...e,detection:t}}function jue(){let e=window.fetch;if(!e)throw new Error("fetch - missing fetch implementation for browser environment");return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D:CanvasRenderingContext2D,Image:HTMLImageElement,ImageData:ImageData,Video:HTMLVideoElement,createCanvasElement:()=>document.createElement("canvas"),createImageElement:()=>document.createElement("img"),createVideoElement:()=>document.createElement("video"),fetch:e,readFile:()=>{throw new Error("readFile - filesystem not available for browser environment")}}}function Hue(){return"object"==typeof global&&"undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node}function Gue(e){let t="";if(!e&&Hue())try{e=Zw("fs")}catch(ut){t=ut.toString()}return{readFile:e?t=>new Promise(((n,r)=>{e.readFile(t,((e,t)=>e?r(e):n(t)))})):()=>{throw new Error(`readFile - failed to require fs in nodejs environment with error: ${t}`)}}}function que(){let e=global.Canvas||global.HTMLCanvasElement,t=global.Image||global.HTMLImageElement,n=global.Video||global.HTMLVideoElement,r=global.fetch,a=Gue();return{Canvas:e||class{},CanvasRenderingContext2D:global.CanvasRenderingContext2D||class{},Image:t||class{},ImageData:global.ImageData||class{},Video:global.HTMLVideoElement||class{},createCanvasElement:()=>{if(e)return new e;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},createImageElement:()=>{if(t)return new t;throw new Error("createImageElement - missing Image implementation for nodejs environment")},createVideoElement:()=>{if(n)return new n;throw new Error("createVideoElement - missing Video implementation for nodejs environment")},fetch:r,...a}}function Kue(){return"object"==typeof window&&"undefined"!=typeof document&&"undefined"!=typeof HTMLImageElement&&"undefined"!=typeof HTMLCanvasElement&&"undefined"!=typeof HTMLVideoElement&&"undefined"!=typeof ImageData&&"undefined"!=typeof CanvasRenderingContext2D}function Xue(e){Oue=e}function Yue(){return Kue()?Xue(jue()):Hue()?Xue(que()):null}var Jue={getEnv:function(){if(!Oue)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return Oue},setEnv:Xue,initialize:Yue,createBrowserEnv:jue,createFileSystem:Gue,createNodejsEnv:que,monkeyPatch:function(e){if(Oue||Yue(),!Oue)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");let{Canvas:t=Oue.Canvas,Image:n=Oue.Image}=e;Oue.Canvas=t,Oue.Image=n,Oue.createCanvasElement=e.createCanvasElement||(()=>new t),Oue.createImageElement=e.createImageElement||(()=>new n),Oue.ImageData=e.ImageData||Oue.ImageData,Oue.Video=e.Video||Oue.Video,Oue.fetch=e.fetch||Oue.fetch,Oue.readFile=e.readFile||Oue.readFile},isBrowser:Kue,isNodejs:Hue};function Zue(e){return Jue.isNodejs()||"string"!=typeof e?e:document.getElementById(e)}function Que(e){let{Canvas:t,CanvasRenderingContext2D:n}=Jue.getEnv();if(e instanceof n)return e;let r=Zue(e);if(!(r instanceof t))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");let a=r.getContext("2d",{willReadFrequently:!0});if(!a)throw new Error("resolveContext2d - canvas 2d context is null");return a}Yue();var ede=(e=>(e.TOP_LEFT="TOP_LEFT",e.TOP_RIGHT="TOP_RIGHT",e.BOTTOM_LEFT="BOTTOM_LEFT",e.BOTTOM_RIGHT="BOTTOM_RIGHT",e))(ede||{}),tde=class{constructor(e={}){let{anchorPosition:t,backgroundColor:n,fontColor:r,fontSize:a,fontStyle:i,padding:s}=e;this.anchorPosition=t||"TOP_LEFT",this.backgroundColor=n||"rgba(0, 0, 0, 0.5)",this.fontColor=r||"rgba(255, 255, 255, 1)",this.fontSize=a||14,this.fontStyle=i||"Georgia",this.padding=s||4}},nde=class{constructor(e,t,n={}){this.text="string"==typeof e?[e]:e instanceof nde?e.text:e,this.anchor=t,this.options=new tde(n)}measureWidth(e){let{padding:t}=this.options;return this.text.map((t=>e.measureText(t).width)).reduce(((e,t)=>e<t?t:e),0)+2*t}measureHeight(){let{fontSize:e,padding:t}=this.options;return this.text.length*e+2*t}getUpperLeft(e,t){let{anchorPosition:n}=this.options,r="BOTTOM_RIGHT"===n||"TOP_RIGHT"===n,a="BOTTOM_LEFT"===n||"BOTTOM_RIGHT"===n,i=this.measureWidth(e),s=this.measureHeight(),o=r?this.anchor.x-i:this.anchor.x,l=a?this.anchor.y-s:this.anchor.y;if(t){let{width:e,height:n}=t;return{x:Math.max(Math.min(o,e-i),0),y:Math.max(Math.min(l,n-s),0)}}return{x:o,y:l}}draw(e){let t=Zue(e),n=Que(t),{backgroundColor:r,fontColor:a,fontSize:i,fontStyle:s,padding:o}=this.options;n.font=`${i}px ${s}`;let l=this.measureWidth(n),u=this.measureHeight();n.fillStyle=r;let d=this.getUpperLeft(n,t);n.fillRect(d.x,d.y,l,u),n.fillStyle=a,this.text.forEach(((e,t)=>{let r=o+d.x,a=o+d.y+(t+1)*i;n.fillText(e,r,a)}))}},rde=class{constructor(e={}){let{boxColor:t,lineWidth:n,label:r,drawLabelOptions:a}=e;this.boxColor=t||"rgba(0, 0, 255, 1)",this.lineWidth=n||2,this.label=r;let i={anchorPosition:"BOTTOM_LEFT",backgroundColor:this.boxColor};this.drawLabelOptions=new tde({...i,...a})}},ade=class{constructor(e,t={}){this.box=new _ue(e),this.options=new rde(t)}draw(e){let t=Que(e),{boxColor:n,lineWidth:r}=this.options,{x:a,y:i,width:s,height:o}=this.box;t.strokeStyle=n,t.lineWidth=r,t.strokeRect(a,i,s,o);let{label:l}=this.options;l&&new nde([l],{x:a-r/2,y:i},this.options.drawLabelOptions).draw(e)}};function ide(e,t){(Array.isArray(t)?t:[t]).forEach((t=>{let n=t instanceof Rue?t.score:Vue(t)?t.detection.score:void 0,r=t instanceof Rue?t.box:Vue(t)?t.detection.box:new _ue(t),a=n?`${wue(n)}`:void 0;new ade(r,{label:a}).draw(e)}))}function sde(e){let{Image:t,Video:n}=Jue.getEnv();return e instanceof t&&e.complete||e instanceof n&&e.readyState>=3}function ode(e){let{Image:t,Video:n}=Jue.getEnv();return e instanceof t?new hue(e.naturalWidth,e.naturalHeight):e instanceof n?new hue(e.videoWidth,e.videoHeight):new hue(e.width,e.height)}function lde({width:e,height:t}){let{createCanvasElement:n}=Jue.getEnv(),r=n();return r.width=e,r.height=t,r}function ude(e,t){let{ImageData:n}=Jue.getEnv();if(!(e instanceof n||sde(e)))throw new Error("createCanvasFromMedia - media has not finished loading yet");let{width:r,height:a}=t||ode(e),i=lde({width:r,height:a});return e instanceof n?Que(i).putImageData(e,0,0):Que(i).drawImage(e,0,0,r,a),i}function dde(e){let{Image:t,Canvas:n,Video:r}=Jue.getEnv();return e instanceof t||e instanceof n||e instanceof r}var cde=class{constructor(e,t=!1){if(this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],this._inputSize=0,!Array.isArray(e))throw new Error(`NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have ${e}`);this._treatAsBatchInput=t,this._batchSize=e.length,e.forEach(((e,t)=>{if(bue(e))return this._imageTensors[t]=e,void(this._inputDimensions[t]=e.shape);if(yue(e)){let n=e.shape[0];if(1!==n)throw new Error(`NetInput - tf.Tensor4D with batchSize ${n} passed, but not supported in input array`);return this._imageTensors[t]=e,void(this._inputDimensions[t]=e.shape.slice(1))}let n=e instanceof Jue.getEnv().Canvas?e:ude(e);this._canvases[t]=n,this._inputDimensions[t]=[n.height,n.width,3]}))}get imageTensors(){return this._imageTensors}get canvases(){return this._canvases}get isBatchInput(){return this.batchSize>1||this._treatAsBatchInput}get batchSize(){return this._batchSize}get inputDimensions(){return this._inputDimensions}get inputSize(){return this._inputSize}get reshapedInputDimensions(){return Nue(this.batchSize,0,1).map(((e,t)=>this.getReshapedInputDimensions(t)))}getInput(e){return this.canvases[e]||this.imageTensors[e]}getInputDimensions(e){return this._inputDimensions[e]}getInputHeight(e){return this._inputDimensions[e][0]}getInputWidth(e){return this._inputDimensions[e][1]}getReshapedInputDimensions(e){if("number"!=typeof this.inputSize)throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");return Sue({width:this.getInputWidth(e),height:this.getInputHeight(e)},this.inputSize)}toBatchTensor(e,t=!0){return this._inputSize=e,j_((()=>{let n=Nue(this.batchSize,0,1).map((n=>{let r=this.getInput(n);if(r instanceof XT){let n=yue(r)?r:tR(r);return n=function(e,t=!1){return j_((()=>{let[n,r]=e.shape.slice(1);if(n===r)return e;let a=Math.abs(n-r),i=Math.round(a*(t?.5:1)),s=n>r?2:1,o=t=>{let n=e.shape.slice();return n[s]=t,tA(n,0,"float32")},l=o(i),u=a-l.shape[s],d=[t&&u?o(u):null,e,l].filter((e=>!!e)).map((e=>D_(e,"float32")));return L$(d,s)}))}(n,t),(n.shape[1]!==e||n.shape[2]!==e)&&(n=aO.resizeBilinear(n,[e,e],!1,!1)),n.as3D(e,e,3)}if(r instanceof Jue.getEnv().Canvas)return HO.fromPixels(function(e,t,n=!1){let{Image:r,Canvas:a}=Jue.getEnv();if(!(e instanceof r||e instanceof a))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");if(t<=0)return lde({width:1,height:1});let i=ode(e),s=t/Math.max(i.height,i.width),o=s*i.width,l=s*i.height,u=lde({width:t,height:t}),d=e instanceof a?e:ude(e),c=Math.abs(o-l)/2,p=n&&o<l?c:0,h=n&&l<o?c:0;return d.width>0&&d.height>0&&Que(u).drawImage(d,p,h,o,l),u}(r,e,t));throw new Error(`toBatchTensor - at batchIdx ${n}, expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have ${r}`)}));return mF(n.map((e=>D_(e,"float32")))).as4D(this.batchSize,e,e,3)}))}};async function pde(e){if(e instanceof cde)return e;let t=Array.isArray(e)?e:[e];if(!t.length)throw new Error("toNetInput - empty array passed as input");let n=t=>Array.isArray(e)?` at input index ${t}:`:"",r=t.map(Zue);return r.forEach(((e,r)=>{if(!dde(e)&&!bue(e)&&!yue(e))throw"string"==typeof t[r]?new Error(`toNetInput -${n(r)} string passed, but could not resolve HTMLElement for element id ${t[r]}`):new Error(`toNetInput -${n(r)} expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id`);if(yue(e)){let t=e.shape[0];if(1!==t)throw new Error(`toNetInput -${n(r)} tf.Tensor4D with batchSize ${t} passed, but not supported in input array`)}})),await Promise.all(r.map((e=>dde(e)&&function(e){return new Promise(((t,n)=>{function r(e){e.currentTarget&&(e.currentTarget.removeEventListener("load",a),e.currentTarget.removeEventListener("error",r),n(e))}function a(e){e.currentTarget&&(e.currentTarget.removeEventListener("load",a),e.currentTarget.removeEventListener("error",r),t(e))}(e instanceof Jue.getEnv().Canvas||sde(e))&&t(null),e.addEventListener("load",a),e.addEventListener("error",r)}))}(e)))),new cde(r,Array.isArray(e))}async function hde(e,t){let{Canvas:n}=Jue.getEnv(),r=e;if(!(e instanceof n)){let t=await pde(e);if(t.batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");let a=t.getInput(0);r=a instanceof n?a:await async function(e,t){let n=t||Jue.getEnv().createCanvasElement(),[r,a,i]=e.shape.slice(yue(e)?1:0),s=j_((()=>e.as3D(r,a,i).toInt()));return await HO.toPixels(s,n),s.dispose(),n}(a)}let a=Que(r);return t.map((e=>e instanceof Rue?e.forSize(r.width,r.height).box.floor():e)).map((e=>e.clipAtImageBorders(r.width,r.height))).map((({x:e,y:t,width:n,height:r})=>{let i=lde({width:n,height:r});return n>0&&r>0&&Que(i).putImageData(a.getImageData(e,t,n,r),0,0),i}))}async function fde(e,t){if(!bue(e)&&!yue(e))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(yue(e)&&e.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return j_((()=>{let[n,r,a]=e.shape.slice(yue(e)?1:0);return t.map((e=>e instanceof Rue?e.forSize(r,n).box:e)).map((e=>e.clipAtImageBorders(r,n))).filter((e=>e.width>0&&e.height>0)).map((({x:t,y:i,width:s,height:o})=>iF(e.as3D(n,r,a),[i,t,0],[o,s,a])))}))}async function mde(e,t){let{fetch:n}=Jue.getEnv(),r=await n(e,t);if(!(r.status<400))throw new Error(`failed to fetch: (${r.status}) ${r.statusText}, from url: ${r.url}`);return r}async function gde(e){let t=await mde(e),n=await t.blob();if(!n.type.startsWith("image/"))throw new Error(`fetchImage - expected blob type to be of type image/*, instead have: ${n.type}, for url: ${t.url}`);return function(e){return new Promise(((t,n)=>{e instanceof Blob||n(new Error("bufferToImage - expected buf to be of type: Blob"));let r=new FileReader;r.onload=()=>{"string"!=typeof r.result&&n(new Error("bufferToImage - expected reader.result to be a string, in onload"));let e=Jue.getEnv().createImageElement();e.onload=()=>t(e),e.onerror=n,e.src=r.result},r.onerror=n,r.readAsDataURL(e)}))}(n)}function bde(e,t){let n=`${t}-weights_manifest.json`;if(!e)return{modelBaseUri:"",manifestUri:n};if("/"===e)return{modelBaseUri:"/",manifestUri:`/${n}`};let r=e.startsWith("http://")?"http://":e.startsWith("https://")?"https://":"",a=(e=e.replace(r,"")).split("/").filter((e=>e)),i=e.endsWith(".json")?a[a.length-1]:n,s=r+(e.endsWith(".json")?a.slice(0,a.length-1):a).join("/");return s=e.startsWith("/")?`/${s}`:s,{modelBaseUri:s,manifestUri:"/"===s?`/${i}`:`${s}/${i}`}}async function yde(e,t){let{manifestUri:n,modelBaseUri:r}=bde(e,t),a=await async function(e){return(await mde(e)).json()}(n);return kO.loadWeights(a,r)}var vde=class{constructor(e){this._params=void 0,this._paramMappings=[],this._name=e}get params(){return this._params}get paramMappings(){return this._paramMappings}get isLoaded(){return!!this.params}getParamFromPath(e){let{obj:t,objProp:n}=this.traversePropertyPath(e);return t[n]}reassignParamFromPath(e,t){let{obj:n,objProp:r}=this.traversePropertyPath(e);n[r].dispose(),n[r]=t}getParamList(){return this._paramMappings.map((({paramPath:e})=>({path:e,tensor:this.getParamFromPath(e)})))}getTrainableParams(){return this.getParamList().filter((e=>e.tensor instanceof JT))}getFrozenParams(){return this.getParamList().filter((e=>!(e.tensor instanceof JT)))}variable(){this.getFrozenParams().forEach((({path:e,tensor:t})=>{this.reassignParamFromPath(e,t.variable())}))}freeze(){this.getTrainableParams().forEach((({path:e,tensor:t})=>{let n=ME(t.dataSync());t.dispose(),this.reassignParamFromPath(e,n)}))}dispose(e=!0){this.getParamList().forEach((t=>{if(e&&t.tensor.isDisposed)throw new Error(`param tensor has already been disposed for path ${t.path}`);t.tensor.dispose()})),this._params=void 0}serializeParams(){return new Float32Array(this.getParamList().map((({tensor:e})=>Array.from(e.dataSync()))).reduce(((e,t)=>e.concat(t))))}async load(e){e instanceof Float32Array?this.extractWeights(e):await this.loadFromUri(e)}async loadFromUri(e){if(e&&"string"!=typeof e)throw new Error(`${this._name}.loadFromUri - expected model uri`);let t=await yde(e,this.getDefaultModelName());this.loadFromWeightMap(t)}async loadFromDisk(e){if(e&&"string"!=typeof e)throw new Error(`${this._name}.loadFromDisk - expected model file path`);let{readFile:t}=Jue.getEnv(),{manifestUri:n,modelBaseUri:r}=bde(e,this.getDefaultModelName()),a=kO.weightsLoaderFactory((e=>Promise.all(e.map((e=>t(e).then((e=>e.buffer))))))),i=JSON.parse((await t(n)).toString()),s=await a(i,r);this.loadFromWeightMap(s)}loadFromWeightMap(e){let{paramMappings:t,params:n}=this.extractParamsFromWeightMap(e);this._paramMappings=t,this._params=n}extractWeights(e){let{paramMappings:t,params:n}=this.extractParams(e);this._paramMappings=t,this._params=n}traversePropertyPath(e){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");let t=e.split("/").reduce(((t,n)=>{if(!t.nextObj.hasOwnProperty(n))throw new Error(`traversePropertyPath - object does not have property ${n}, for path ${e}`);return{obj:t.nextObj,objProp:n,nextObj:t.nextObj[n]}}),{nextObj:this.params}),{obj:n,objProp:r}=t;if(!(n&&r&&n[r]instanceof XT))throw new Error(`traversePropertyPath - parameter is not a tensor, for path ${e}`);return{obj:n,objProp:r}}};function xde(e,t,n){return j_((()=>{let r=ZD(e,t.depthwise_filter,t.pointwise_filter,n,"same");return r=r$(r,t.bias),r}))}function wde(e,t,n=!1){return j_((()=>{let r=VD(n?r$(oA(e,t.conv0.filters,[2,2],"same"),t.conv0.bias):xde(e,t.conv0,[2,2])),a=xde(r,t.conv1,[1,1]),i=xde(VD(r$(r,a)),t.conv2,[1,1]);return VD(r$(r,r$(a,i)))}))}function kde(e,t,n=!1,r=!0){return j_((()=>{let a=VD(n?r$(oA(e,t.conv0.filters,r?[2,2]:[1,1],"same"),t.conv0.bias):xde(e,t.conv0,r?[2,2]:[1,1])),i=xde(a,t.conv1,[1,1]),s=xde(VD(r$(a,i)),t.conv2,[1,1]),o=xde(VD(r$(a,r$(i,s))),t.conv3,[1,1]);return VD(r$(a,r$(i,r$(s,o))))}))}function Sde(e,t,n="same",r=!1){return j_((()=>{let a=r$(oA(e,t.filters,[1,1],n),t.bias);return r?VD(a):a}))}function Ide(e,t){Object.keys(e).forEach((n=>{t.some((e=>e.originalPath===n))||e[n].dispose()}))}function Nde(e,t){return(n,r,a,i)=>{let s=kF(e(n*r*a*a),[a,a,n,r]),o=vF(e(r));return t.push({paramPath:`${i}/filters`},{paramPath:`${i}/bias`}),{filters:s,bias:o}}}function Cde(e,t){return(n,r,a)=>{let i=xF(e(n*r),[n,r]),s=vF(e(r));return t.push({paramPath:`${a}/weights`},{paramPath:`${a}/bias`}),{weights:i,bias:s}}}var Tde=class{constructor(e,t,n){this.depthwise_filter=e,this.pointwise_filter=t,this.bias=n}};function Ede(e,t){return(n,r,a)=>{let i=kF(e(9*n),[3,3,n,1]),s=kF(e(n*r),[1,1,n,r]),o=vF(e(r));return t.push({paramPath:`${a}/depthwise_filter`},{paramPath:`${a}/pointwise_filter`},{paramPath:`${a}/bias`}),new Tde(i,s,o)}}function _de(e){return t=>{let n=e(`${t}/depthwise_filter`,4),r=e(`${t}/pointwise_filter`,4),a=e(`${t}/bias`,1);return new Tde(n,r,a)}}function $de(e,t){return(n,r,a)=>{let i=e[n];if(!fue(i,r))throw new Error(`expected weightMap[${n}] to be a Tensor${r}D, instead have ${i}`);return t.push({originalPath:n,paramPath:a||n}),i}}function Ade(e){let t=e;return{extractWeights:function(e){let n=t.slice(0,e);return t=t.slice(e),n},getRemainingWeights:function(){return t}}}function Rde(e,t){let n=Nde(e,t),r=Ede(e,t);function a(e,t,a,i=!1){return{conv0:i?n(e,t,3,`${a}/conv0`):r(e,t,`${a}/conv0`),conv1:r(t,t,`${a}/conv1`),conv2:r(t,t,`${a}/conv2`)}}return{extractDenseBlock3Params:a,extractDenseBlock4Params:function(e,t,n,i=!1){let{conv0:s,conv1:o,conv2:l}=a(e,t,n,i);return{conv0:s,conv1:o,conv2:l,conv3:r(t,t,`${n}/conv3`)}}}}function Dde(e){return t=>({filters:e(`${t}/filters`,4),bias:e(`${t}/bias`,1)})}function Fde(e,t){let n=$de(e,t),r=Dde(n),a=_de(n);return{extractDenseBlock3Params:function(e,t=!1){return{conv0:t?r(`${e}/conv0`):a(`${e}/conv0`),conv1:a(`${e}/conv1`),conv2:a(`${e}/conv2`)}},extractDenseBlock4Params:function(e,t=!1){return{conv0:t?r(`${e}/conv0`):a(`${e}/conv0`),conv1:a(`${e}/conv1`),conv2:a(`${e}/conv2`),conv3:a(`${e}/conv3`)}}}}var Mde=class extends vde{constructor(){super("FaceFeatureExtractor")}forwardInput(e){let{params:t}=this;if(!t)throw new Error("FaceFeatureExtractor - load model before inference");return j_((()=>{let n=kde(Fue(D_(e.toBatchTensor(112,!0),"float32"),[122.782,117.001,104.298]).div(255),t.dense0,!0);return n=kde(n,t.dense1),n=kde(n,t.dense2),n=kde(n,t.dense3),n=O$(n,[7,7],[2,2],"valid"),n}))}async forward(e){return this.forwardInput(await pde(e))}getDefaultModelName(){return"face_feature_extractor_model"}extractParamsFromWeightMap(e){return function(e){let t=[],{extractDenseBlock4Params:n}=Fde(e,t),r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2"),dense3:n("dense3")};return Ide(e,t),{params:r,paramMappings:t}}(e)}extractParams(e){return function(e){let t=[],{extractWeights:n,getRemainingWeights:r}=Ade(e),{extractDenseBlock4Params:a}=Rde(n,t),i=a(3,32,"dense0",!0),s=a(32,64,"dense1"),o=a(64,128,"dense2"),l=a(128,256,"dense3");if(0!==r().length)throw new Error(`weights remaing after extract: ${r().length}`);return{paramMappings:t,params:{dense0:i,dense1:s,dense2:o,dense3:l}}}(e)}};function Ode(e,t){return j_((()=>r$(z$(e,t.weights),t.bias)))}function Pde(e){let t={},n={};return Object.keys(e).forEach((r=>{(r.startsWith("fc")?n:t)[r]=e[r]})),{featureExtractorMap:t,classifierMap:n}}var Lde=class extends vde{constructor(e,t){super(e),this._faceFeatureExtractor=t}get faceFeatureExtractor(){return this._faceFeatureExtractor}runNet(e){let{params:t}=this;if(!t)throw new Error(`${this._name} - load model before inference`);return j_((()=>{let n=e instanceof cde?this.faceFeatureExtractor.forwardInput(e):e;return Ode(n.as2D(n.shape[0],-1),t.fc)}))}dispose(e=!0){this.faceFeatureExtractor.dispose(e),super.dispose(e)}loadClassifierParams(e){let{params:t,paramMappings:n}=this.extractClassifierParams(e);this._params=t,this._paramMappings=n}extractClassifierParams(e){return function(e,t,n){let r=[],{extractWeights:a,getRemainingWeights:i}=Ade(e),s=Cde(a,r)(t,n,"fc");if(0!==i().length)throw new Error(`weights remaing after extract: ${i().length}`);return{paramMappings:r,params:{fc:s}}}(e,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())}extractParamsFromWeightMap(e){let{featureExtractorMap:t,classifierMap:n}=Pde(e);return this.faceFeatureExtractor.loadFromWeightMap(t),function(e){let t=[],n=$de(e,t),r={fc:(a="fc",{weights:n(`${a}/weights`,2),bias:n(`${a}/bias`,1)})};var a;return Ide(e,t),{params:r,paramMappings:t}}(n)}extractParams(e){let t=this.getClassifierChannelsIn(),n=this.getClassifierChannelsOut(),r=n*t+n,a=e.slice(0,e.length-r),i=e.slice(e.length-r);return this.faceFeatureExtractor.extractWeights(a),this.extractClassifierParams(i)}},zde=["neutral","happy","sad","angry","fearful","disgusted","surprised"],Bde=class{constructor(e){if(this.neutral=0,this.happy=0,this.sad=0,this.angry=0,this.fearful=0,this.disgusted=0,this.surprised=0,7!==e.length)throw new Error(`FaceExpressions.constructor - expected probabilities.length to be 7, have: ${e.length}`);zde.forEach(((t,n)=>{this[t]=e[n]}))}asSortedArray(){return zde.map((e=>({expression:e,probability:this[e]}))).sort(((e,t)=>t.probability-e.probability))}};function Wde(e,t){return{...e,expressions:t}}function Vde(e,t,n=.1,r){(Array.isArray(t)?t:[t]).forEach((t=>{let a=t instanceof Bde?t:function(e){return e.expressions instanceof Bde}(t)?t.expressions:void 0;if(!a)throw new Error("drawFaceExpressions - expected faceExpressions to be FaceExpressions | WithFaceExpressions<{}> or array thereof");let i=a.asSortedArray().filter((e=>e.probability>n)),s=Vue(t)?t.detection.box.bottomLeft:r||new Eue(0,0);new nde(i.map((e=>`${e.expression} (${wue(e.probability)})`)),s).draw(e)}))}function Ude(e){return Vue(e)&&e.landmarks instanceof Lue&&e.unshiftedLandmarks instanceof Lue&&e.alignedRect instanceof Rue}function jde(e,t){let{box:n}=e.detection,r=t.shiftBy(n.x,n.y),a=r.align(),{imageDims:i}=e.detection,s=new Rue(e.detection.score,a.rescale(i.reverse()),i),o=function(e){let t=e=>180*e/Math.PI,n=(e,t)=>Math.sqrt((e._x-t._x)**2+(e._y-t._y)**2),r={roll:void 0,pitch:void 0,yaw:void 0};if(!e||!e._positions||68!==e._positions.length)return r;let a=e._positions;return r.roll=((e,n)=>{let r=Math.hypot(n._x-e._x,n._y-e._y),a=n._y-e._y,i=Math.asin(a/r),s=t(i);return Math.floor(90-s)*(n._x-e._x<0?-1:1)})(a[27],a[66]),r.pitch=((e,r,a)=>{let i=n(e,a),s={_x:(e._x+a._x)/2,_y:(e._y+a._y)/2},o=n(r,s),l=Math.atan(o/i);return Math.floor(t(l))*(s._y-r._y<0?-1:1)})(a[14],a[30],a[2]),r.yaw=((e,t,n)=>Math.floor(e._x-t._x)-Math.floor(t._x-n._x))(a[14],a[33],a[2]),r}(t);return{...e,landmarks:r,unshiftedLandmarks:t,alignedRect:s,angle:o}}var Hde=class{constructor(e={}){let{drawLines:t=!0,drawPoints:n=!0,lineWidth:r,lineColor:a,pointSize:i,pointColor:s}=e;this.drawLines=t,this.drawPoints=n,this.lineWidth=r||1,this.pointSize=i||2,this.lineColor=a||"rgba(0, 255, 255, 1)",this.pointColor=s||"rgba(255, 0, 255, 1)"}},Gde=class{constructor(e,t={}){this.faceLandmarks=e,this.options=new Hde(t)}draw(e){let t=Que(e),{drawLines:n,drawPoints:r,lineWidth:a,lineColor:i,pointSize:s,pointColor:o}=this.options;if(n&&this.faceLandmarks instanceof zue&&(t.strokeStyle=i,t.lineWidth=a,pue(t,this.faceLandmarks.getJawOutline()),pue(t,this.faceLandmarks.getLeftEyeBrow()),pue(t,this.faceLandmarks.getRightEyeBrow()),pue(t,this.faceLandmarks.getNose()),pue(t,this.faceLandmarks.getLeftEye(),!0),pue(t,this.faceLandmarks.getRightEye(),!0),pue(t,this.faceLandmarks.getMouth(),!0)),r){t.strokeStyle=o,t.fillStyle=o;let e=e=>{t.beginPath(),t.arc(e.x,e.y,s,0,2*Math.PI),t.fill()};this.faceLandmarks.positions.forEach(e)}}};function qde(e,t){(Array.isArray(t)?t:[t]).forEach((t=>{let n=t instanceof Lue?t:Ude(t)?t.landmarks:void 0;if(!n)throw new Error("drawFaceLandmarks - expected faceExpressions to be FaceLandmarks | WithFaceLandmarks<WithFaceDetection<{}>> or array thereof");new Gde(n).draw(e)}))}function Kde(e,t){let n=[],{extractWeights:r,getRemainingWeights:a}=Ade(e),{extractConvParams:i,extractSeparableConvParams:s,extractReductionBlockParams:o,extractMainBlockParams:l}=function(e,t){let n=Nde(e,t),r=Ede(e,t);return{extractConvParams:n,extractSeparableConvParams:r,extractReductionBlockParams:function(e,t,a){return{separable_conv0:r(e,t,`${a}/separable_conv0`),separable_conv1:r(t,t,`${a}/separable_conv1`),expansion_conv:n(e,t,1,`${a}/expansion_conv`)}},extractMainBlockParams:function(e,t){return{separable_conv0:r(e,e,`${t}/separable_conv0`),separable_conv1:r(e,e,`${t}/separable_conv1`),separable_conv2:r(e,e,`${t}/separable_conv2`)}}}}(r,n),u={conv_in:i(3,32,3,"entry_flow/conv_in"),reduction_block_0:o(32,64,"entry_flow/reduction_block_0"),reduction_block_1:o(64,128,"entry_flow/reduction_block_1")},d={};Nue(t,0,1).forEach((e=>{d[`main_block_${e}`]=l(128,`middle_flow/main_block_${e}`)}));let c={reduction_block:o(128,256,"exit_flow/reduction_block"),separable_conv:s(256,512,"exit_flow/separable_conv")};if(0!==a().length)throw new Error(`weights remaing after extract: ${a().length}`);return{paramMappings:n,params:{entry_flow:u,middle_flow:d,exit_flow:c}}}function Xde(e,t){let n=[],{extractConvParams:r,extractSeparableConvParams:a,extractReductionBlockParams:i,extractMainBlockParams:s}=function(e,t){let n=$de(e,t),r=Dde(n),a=_de(n);return{extractConvParams:r,extractSeparableConvParams:a,extractReductionBlockParams:function(e){return{separable_conv0:a(`${e}/separable_conv0`),separable_conv1:a(`${e}/separable_conv1`),expansion_conv:r(`${e}/expansion_conv`)}},extractMainBlockParams:function(e){return{separable_conv0:a(`${e}/separable_conv0`),separable_conv1:a(`${e}/separable_conv1`),separable_conv2:a(`${e}/separable_conv2`)}}}}(e,n),o={conv_in:r("entry_flow/conv_in"),reduction_block_0:i("entry_flow/reduction_block_0"),reduction_block_1:i("entry_flow/reduction_block_1")},l={};Nue(t,0,1).forEach((e=>{l[`main_block_${e}`]=s(`middle_flow/main_block_${e}`)}));let u={reduction_block:i("exit_flow/reduction_block"),separable_conv:a("exit_flow/separable_conv")};return Ide(e,n),{params:{entry_flow:o,middle_flow:l,exit_flow:u},paramMappings:n}}function Yde(e,t,n){return r$(oA(e,t.filters,n,"same"),t.bias)}function Jde(e,t,n=!0){let r=n?VD(e):e;return r=xde(r,t.separable_conv0,[1,1]),r=xde(VD(r),t.separable_conv1,[1,1]),r=BR(r,[3,3],[2,2],"same"),r=r$(r,Yde(e,t.expansion_conv,[2,2])),r}var Zde=class extends vde{constructor(e){super("TinyXception"),this._numMainBlocks=e}forwardInput(e){let{params:t}=this;if(!t)throw new Error("TinyXception - load model before inference");return j_((()=>{let n=Fue(D_(e.toBatchTensor(112,!0),"float32"),[122.782,117.001,104.298]).div(255),r=VD(Yde(n,t.entry_flow.conv_in,[2,2]));return r=Jde(r,t.entry_flow.reduction_block_0,!1),r=Jde(r,t.entry_flow.reduction_block_1),Nue(this._numMainBlocks,0,1).forEach((e=>{r=function(e,t){let n=xde(VD(e),t.separable_conv0,[1,1]);return n=xde(VD(n),t.separable_conv1,[1,1]),n=xde(VD(n),t.separable_conv2,[1,1]),n=r$(n,e),n}(r,t.middle_flow[`main_block_${e}`])})),r=Jde(r,t.exit_flow.reduction_block),r=VD(xde(r,t.exit_flow.separable_conv,[1,1])),r}))}async forward(e){return this.forwardInput(await pde(e))}getDefaultModelName(){return"tiny_xception_model"}extractParamsFromWeightMap(e){return Xde(e,this._numMainBlocks)}extractParams(e){return Kde(e,this._numMainBlocks)}},Qde=(e=>(e.FEMALE="female",e.MALE="male",e))(Qde||{}),ece=class extends Lde{postProcess(e,t,n){let r=n.map((({width:e,height:n})=>{let r=t/Math.max(n,e);return{width:e*r,height:n*r}})),a=r.length;return j_((()=>{let n=(e,t)=>mF([tA([68],e,"float32"),tA([68],t,"float32")],1).as2D(1,136).as1D(),i=(e,t)=>{let{width:n,height:a}=r[e];return t(n,a)?Math.abs(n-a)/2:0};return e.mul(tA([a,136],t,"float32")).sub(mF(Array.from(Array(a),((e,t)=>n((e=>i(e,((e,t)=>e<t)))(t),(e=>i(e,((e,t)=>t<e)))(t)))))).div(mF(Array.from(Array(a),((e,t)=>n(r[t].width,r[t].height)))))}))}forwardInput(e){return j_((()=>{let t=this.runNet(e);return this.postProcess(t,e.inputSize,e.inputDimensions.map((([e,t])=>({height:e,width:t}))))}))}async forward(e){return this.forwardInput(await pde(e))}async detectLandmarks(e){let t=await pde(e),n=j_((()=>FF(this.forwardInput(t)))),r=await Promise.all(n.map((async(e,n)=>{let r=Array.from(e.dataSync()),a=r.filter(((e,t)=>xue(t))),i=r.filter(((e,t)=>!xue(t)));return new zue(Array(68).fill(0).map(((e,t)=>new Eue(a[t],i[t]))),{height:t.getInputHeight(n),width:t.getInputWidth(n)})})));return n.forEach((e=>e.dispose())),t.isBatchInput?r:r[0]}getClassifierChannelsOut(){return 136}},tce=class extends vde{constructor(){super("TinyFaceFeatureExtractor")}forwardInput(e){let{params:t}=this;if(!t)throw new Error("TinyFaceFeatureExtractor - load model before inference");return j_((()=>{let n=wde(Fue(D_(e.toBatchTensor(112,!0),"float32"),[122.782,117.001,104.298]).div(255),t.dense0,!0);return n=wde(n,t.dense1),n=wde(n,t.dense2),n=O$(n,[14,14],[2,2],"valid"),n}))}async forward(e){return this.forwardInput(await pde(e))}getDefaultModelName(){return"face_feature_extractor_tiny_model"}extractParamsFromWeightMap(e){return function(e){let t=[],{extractDenseBlock3Params:n}=Fde(e,t),r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2")};return Ide(e,t),{params:r,paramMappings:t}}(e)}extractParams(e){return function(e){let t=[],{extractWeights:n,getRemainingWeights:r}=Ade(e),{extractDenseBlock3Params:a}=Rde(n,t),i=a(3,32,"dense0",!0),s=a(32,64,"dense1"),o=a(64,128,"dense2");if(0!==r().length)throw new Error(`weights remaing after extract: ${r().length}`);return{paramMappings:t,params:{dense0:i,dense1:s,dense2:o}}}(e)}};function nce(e,t,n,r,a="same"){let{filters:i,bias:s}=t.conv,o=oA(e,i,n,a);return o=r$(o,s),o=function(e,t){return r$(s$(e,t.weights),t.biases)}(o,t.scale),r?VD(o):o}function rce(e,t){return nce(e,t,[1,1],!1)}function ace(e,t){return nce(e,t,[2,2],!0,"valid")}function ice(e,t){function n(n,r,a,i){let s=function(t,n,r){let a=e(t),i=a.length/(n*r*r);if(vue(i))throw new Error(`depth has to be an integer: ${i}, weights.length: ${a.length}, numFilters: ${n}, filterSize: ${r}`);return j_((()=>BF(kF(a,[n,i,r,r]),[2,3,1,0])))}(n,r,a),o=vF(e(r));return t.push({paramPath:`${i}/filters`},{paramPath:`${i}/bias`}),{filters:s,bias:o}}function r(r,a,i,s){let o=n(r,a,i,`${s}/conv`),l=function(n,r){let a=vF(e(n)),i=vF(e(n));return t.push({paramPath:`${r}/weights`},{paramPath:`${r}/biases`}),{weights:a,biases:i}}(a,`${s}/scale`);return{conv:o,scale:l}}return{extractConvLayerParams:r,extractResidualLayerParams:function(e,t,n,a,i=!1){return{conv1:r((i?.5:1)*e,t,n,`${a}/conv1`),conv2:r(e,t,n,`${a}/conv2`)}}}}function sce(e,t){let n=$de(e,t);function r(e){let t=n(`${e}/conv/filters`,4),r=n(`${e}/conv/bias`,1),a=function(e){return{weights:n(`${e}/scale/weights`,1),biases:n(`${e}/scale/biases`,1)}}(e);return{conv:{filters:t,bias:r},scale:a}}return{extractConvLayerParams:r,extractResidualLayerParams:function(e){return{conv1:r(`${e}/conv1`),conv2:r(`${e}/conv2`)}}}}function oce(e,t){let n=function(e,t){return nce(e,t,[1,1],!0)}(e,t.conv1);return n=rce(n,t.conv2),n=r$(n,e),n=VD(n),n}function lce(e,t){let n=ace(e,t.conv1);n=rce(n,t.conv2);let r=O$(e,2,2,"valid"),a=HR(r.shape),i=r.shape[3]!==n.shape[3];if(r.shape[1]!==n.shape[1]||r.shape[2]!==n.shape[2]){let e=[...n.shape];e[1]=1;let t=HR(e);n=L$([n,t],1);let r=[...n.shape];r[2]=1;let a=HR(r);n=L$([n,a],2)}return r=i?L$([r,a],3):r,n=r$(r,n),n=VD(n),n}function uce(e,t){return{...e,descriptor:t}}function dce(e,t){return{...e,age:t}}function cce(e,t,n){return{...e,gender:t,genderProbability:n}}function pce(e,t){function n(n,r,a,i,s){let o=kF(e(n*r*a*a),[a,a,n,r]),l=vF(e(r));return t.push({paramPath:`${i}/filters`},{paramPath:`${i}/${s?"batch_norm_offset":"bias"}`}),{filters:o,bias:l}}function r(e,t,r,a){let{filters:i,bias:s}=n(e,t,r,a,!0);return{filters:i,batch_norm_offset:s}}function a(n,a,i){let s=function(n,r){let a=kF(e(9*n),[3,3,n,1]),i=vF(e(n)),s=vF(e(n)),o=vF(e(n)),l=vF(e(n));return t.push({paramPath:`${r}/filters`},{paramPath:`${r}/batch_norm_scale`},{paramPath:`${r}/batch_norm_offset`},{paramPath:`${r}/batch_norm_mean`},{paramPath:`${r}/batch_norm_variance`}),{filters:a,batch_norm_scale:i,batch_norm_offset:s,batch_norm_mean:o,batch_norm_variance:l}}(n,`${i}/depthwise_conv`);return{depthwise_conv:s,pointwise_conv:r(n,a,1,`${i}/pointwise_conv`)}}return{extractMobilenetV1Params:function(){return{conv_0:r(3,32,3,"mobilenetv1/conv_0"),conv_1:a(32,64,"mobilenetv1/conv_1"),conv_2:a(64,128,"mobilenetv1/conv_2"),conv_3:a(128,128,"mobilenetv1/conv_3"),conv_4:a(128,256,"mobilenetv1/conv_4"),conv_5:a(256,256,"mobilenetv1/conv_5"),conv_6:a(256,512,"mobilenetv1/conv_6"),conv_7:a(512,512,"mobilenetv1/conv_7"),conv_8:a(512,512,"mobilenetv1/conv_8"),conv_9:a(512,512,"mobilenetv1/conv_9"),conv_10:a(512,512,"mobilenetv1/conv_10"),conv_11:a(512,512,"mobilenetv1/conv_11"),conv_12:a(512,1024,"mobilenetv1/conv_12"),conv_13:a(1024,1024,"mobilenetv1/conv_13")}},extractPredictionLayerParams:function(){return{conv_0:r(1024,256,1,"prediction_layer/conv_0"),conv_1:r(256,512,3,"prediction_layer/conv_1"),conv_2:r(512,128,1,"prediction_layer/conv_2"),conv_3:r(128,256,3,"prediction_layer/conv_3"),conv_4:r(256,128,1,"prediction_layer/conv_4"),conv_5:r(128,256,3,"prediction_layer/conv_5"),conv_6:r(256,64,1,"prediction_layer/conv_6"),conv_7:r(64,128,3,"prediction_layer/conv_7"),box_predictor_0:{box_encoding_predictor:n(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),class_predictor:n(512,9,1,"prediction_layer/box_predictor_0/class_predictor")},box_predictor_1:{box_encoding_predictor:n(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),class_predictor:n(1024,18,1,"prediction_layer/box_predictor_1/class_predictor")},box_predictor_2:{box_encoding_predictor:n(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),class_predictor:n(512,18,1,"prediction_layer/box_predictor_2/class_predictor")},box_predictor_3:{box_encoding_predictor:n(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),class_predictor:n(256,18,1,"prediction_layer/box_predictor_3/class_predictor")},box_predictor_4:{box_encoding_predictor:n(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),class_predictor:n(256,18,1,"prediction_layer/box_predictor_4/class_predictor")},box_predictor_5:{box_encoding_predictor:n(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),class_predictor:n(128,18,1,"prediction_layer/box_predictor_5/class_predictor")}}}}}function hce(e){let t=[],{extractMobilenetV1Params:n,extractPredictionLayerParams:r}=function(e,t){let n=$de(e,t);function r(e,t,r){return{filters:n(`${e}/Conv2d_${t}_pointwise/weights`,4,`${r}/filters`),batch_norm_offset:n(`${e}/Conv2d_${t}_pointwise/convolution_bn_offset`,1,`${r}/batch_norm_offset`)}}function a(e){let t=`mobilenetv1/conv_${e}`,a=`MobilenetV1/Conv2d_${e}_depthwise`,i=`${t}/depthwise_conv`,s=`${t}/pointwise_conv`;return{depthwise_conv:{filters:n(`${a}/depthwise_weights`,4,`${i}/filters`),batch_norm_scale:n(`${a}/BatchNorm/gamma`,1,`${i}/batch_norm_scale`),batch_norm_offset:n(`${a}/BatchNorm/beta`,1,`${i}/batch_norm_offset`),batch_norm_mean:n(`${a}/BatchNorm/moving_mean`,1,`${i}/batch_norm_mean`),batch_norm_variance:n(`${a}/BatchNorm/moving_variance`,1,`${i}/batch_norm_variance`)},pointwise_conv:r("MobilenetV1",e,s)}}function i(e,t){return{filters:n(`${e}/weights`,4,`${t}/filters`),bias:n(`${e}/biases`,1,`${t}/bias`)}}function s(e){return{box_encoding_predictor:i(`Prediction/BoxPredictor_${e}/BoxEncodingPredictor`,`prediction_layer/box_predictor_${e}/box_encoding_predictor`),class_predictor:i(`Prediction/BoxPredictor_${e}/ClassPredictor`,`prediction_layer/box_predictor_${e}/class_predictor`)}}return{extractMobilenetV1Params:function(){return{conv_0:r("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:a(1),conv_2:a(2),conv_3:a(3),conv_4:a(4),conv_5:a(5),conv_6:a(6),conv_7:a(7),conv_8:a(8),conv_9:a(9),conv_10:a(10),conv_11:a(11),conv_12:a(12),conv_13:a(13)}},extractPredictionLayerParams:function(){return{conv_0:r("Prediction",0,"prediction_layer/conv_0"),conv_1:r("Prediction",1,"prediction_layer/conv_1"),conv_2:r("Prediction",2,"prediction_layer/conv_2"),conv_3:r("Prediction",3,"prediction_layer/conv_3"),conv_4:r("Prediction",4,"prediction_layer/conv_4"),conv_5:r("Prediction",5,"prediction_layer/conv_5"),conv_6:r("Prediction",6,"prediction_layer/conv_6"),conv_7:r("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:s(0),box_predictor_1:s(1),box_predictor_2:s(2),box_predictor_3:s(3),box_predictor_4:s(4),box_predictor_5:s(5)}}}}(e,t),a=e["Output/extra_dim"];if(t.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!bue(a))throw new Error(`expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have ${a}`);let i={mobilenetv1:n(),prediction_layer:r(),output_layer:{extra_dim:a}};return Ide(e,t),{params:i,paramMappings:t}}function fce(e,t,n){return j_((()=>{let r=oA(e,t.filters,n,"same");return r=r$(r,t.batch_norm_offset),nA(r,0,6)}))}var mce=.0010000000474974513;function gce(e,t){return j_((()=>{let n,r=fce(e,t.conv_0,[2,2]);if([t.conv_1,t.conv_2,t.conv_3,t.conv_4,t.conv_5,t.conv_6,t.conv_7,t.conv_8,t.conv_9,t.conv_10,t.conv_11,t.conv_12,t.conv_13].forEach(((e,t)=>{let a=t+1,i=function(e){return[2,4,6,12].some((t=>t===e))?[2,2]:[1,1]}(a);r=function(e,t,n){return j_((()=>{let r=xA(e,t.filters,n,"same");return r=G$(r,t.batch_norm_mean,t.batch_norm_variance,t.batch_norm_offset,t.batch_norm_scale,mce),nA(r,0,6)}))}(r,e.depthwise_conv,i),r=fce(r,e.pointwise_conv,[1,1]),11===a&&(n=r)})),null===n)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:r,conv11:n}}))}function bce(e,t,n){let r=e.arraySync(),a=Math.min(r[t][0],r[t][2]),i=Math.min(r[t][1],r[t][3]),s=Math.max(r[t][0],r[t][2]),o=Math.max(r[t][1],r[t][3]),l=Math.min(r[n][0],r[n][2]),u=Math.min(r[n][1],r[n][3]),d=Math.max(r[n][0],r[n][2]),c=Math.max(r[n][1],r[n][3]),p=(s-a)*(o-i),h=(d-l)*(c-u);if(p<=0||h<=0)return 0;let f=Math.max(a,l),m=Math.max(i,u),g=Math.min(s,d),b=Math.min(o,c),y=Math.max(g-f,0)*Math.max(b-m,0);return y/(p+h-y)}function yce(e,t){let{sizes:n,centers:r}=function(e){let t=FF(BF(e,[1,0])),n=[$R(t[2],t[0]),$R(t[3],t[1])];return{sizes:n,centers:[r$(t[0],i$(n[0],2)),r$(t[1],i$(n[1],2))]}}(e),a=FF(BF(t,[1,0])),i=i$(s$(eR(i$(a[2],5)),n[0]),2),s=r$(s$(i$(a[0],10),n[0]),r[0]),o=i$(s$(eR(i$(a[3],5)),n[1]),2),l=r$(s$(i$(a[1],10),n[1]),r[1]);return BF(mF([$R(s,i),$R(l,o),r$(s,i),r$(l,o)]),[1,0])}function vce(e,t){return j_((()=>{let n=e.shape[0];return{boxPredictionEncoding:M$(Sde(e,t.box_encoding_predictor),[n,-1,1,4]),classPrediction:M$(Sde(e,t.class_predictor),[n,-1,3])}}))}var xce=class{constructor({minConfidence:e,maxResults:t}={}){if(this._name="SsdMobilenetv1Options",this._minConfidence=e||.5,this._maxResults=t||100,"number"!=typeof this._minConfidence||this._minConfidence<=0||this._minConfidence>=1)throw new Error(`${this._name} - expected minConfidence to be a number between 0 and 1`);if("number"!=typeof this._maxResults)throw new Error(`${this._name} - expected maxResults to be a number`)}get minConfidence(){return this._minConfidence}get maxResults(){return this._maxResults}},wce=[new Eue(.738768,.874946),new Eue(2.42204,2.65704),new Eue(4.30971,7.04493),new Eue(10.246,4.59428),new Eue(12.6868,11.8741)],kce=[new Eue(1.603231,2.094468),new Eue(6.041143,7.080126),new Eue(2.882459,3.518061),new Eue(4.266906,5.178857),new Eue(9.041765,10.66308)],Sce=[117.001,114.697,97.404],Ice=e=>"number"==typeof e;function Nce(e){return j_((()=>{let t=s$(e,qA(.10000000149011612));return r$(VD($R(e,t)),t)}))}function Cce(e,t){return j_((()=>{let n=aD(e,[[0,0],[1,1],[1,1],[0,0]]);return n=oA(n,t.conv.filters,[1,1],"valid"),n=$R(n,t.bn.sub),n=s$(n,t.bn.truediv),n=r$(n,t.conv.bias),Nce(n)}))}function Tce(e,t){return j_((()=>{let n=aD(e,[[0,0],[1,1],[1,1],[0,0]]);return n=ZD(n,t.depthwise_filter,t.pointwise_filter,[1,1],"valid"),n=r$(n,t.bias),Nce(n)}))}function Ece(e,t){let n=Nde(e,t),r=Ede(e,t);return{extractConvParams:n,extractConvWithBatchNormParams:function(r,a,i){let s=n(r,a,3,`${i}/conv`),o=function(n,r){let a=vF(e(n)),i=vF(e(n));return t.push({paramPath:`${r}/sub`},{paramPath:`${r}/truediv`}),{sub:a,truediv:i}}(a,`${i}/bn`);return{conv:s,bn:o}},extractSeparableConvParams:r}}function _ce(e,t){let n=$de(e,t);function r(e){return{filters:n(`${e}/filters`,4),bias:n(`${e}/bias`,1)}}return{extractConvParams:r,extractConvWithBatchNormParams:function(e){let t=r(`${e}/conv`),a=function(e){return{sub:n(`${e}/sub`,1),truediv:n(`${e}/truediv`,1)}}(`${e}/bn`);return{conv:t,bn:a}},extractSeparableConvParams:_de(n)}}var $ce=class{constructor({inputSize:e,scoreThreshold:t}={}){if(this._name="TinyYolov2Options",this._inputSize=e||416,this._scoreThreshold=t||.5,"number"!=typeof this._inputSize||this._inputSize%32!=0)throw new Error(`${this._name} - expected inputSize to be a number divisible by 32`);if("number"!=typeof this._scoreThreshold||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(`${this._name} - expected scoreThreshold to be a number between 0 and 1`)}get inputSize(){return this._inputSize}get scoreThreshold(){return this._scoreThreshold}},Ace=class extends vde{constructor(e){super("TinyYolov2"),function(e){if(!e)throw new Error(`invalid config: ${e}`);if("boolean"!=typeof e.withSeparableConvs)throw new Error(`config.withSeparableConvs has to be a boolean, have: ${e.withSeparableConvs}`);if(!Ice(e.iouThreshold)||e.iouThreshold<0||e.iouThreshold>1)throw new Error(`config.iouThreshold has to be a number between [0, 1], have: ${e.iouThreshold}`);if(!Array.isArray(e.classes)||!e.classes.length||!e.classes.every((e=>"string"==typeof e)))throw new Error(`config.classes has to be an array class names: string[], have: ${JSON.stringify(e.classes)}`);if(!Array.isArray(e.anchors)||!e.anchors.length||!e.anchors.map((e=>e||{})).every((e=>Ice(e.x)&&Ice(e.y))))throw new Error(`config.anchors has to be an array of { x: number, y: number }, have: ${JSON.stringify(e.anchors)}`);if(e.meanRgb&&(!Array.isArray(e.meanRgb)||3!==e.meanRgb.length||!e.meanRgb.every(Ice)))throw new Error(`config.meanRgb has to be an array of shape [number, number, number], have: ${JSON.stringify(e.meanRgb)}`)}(e),this._config=e}get config(){return this._config}get withClassScores(){return this.config.withClassScores||this.config.classes.length>1}get boxEncodingSize(){return 5+(this.withClassScores?this.config.classes.length:0)}runTinyYolov2(e,t){let n=Cce(e,t.conv0);return n=BR(n,[2,2],[2,2],"same"),n=Cce(n,t.conv1),n=BR(n,[2,2],[2,2],"same"),n=Cce(n,t.conv2),n=BR(n,[2,2],[2,2],"same"),n=Cce(n,t.conv3),n=BR(n,[2,2],[2,2],"same"),n=Cce(n,t.conv4),n=BR(n,[2,2],[2,2],"same"),n=Cce(n,t.conv5),n=BR(n,[2,2],[1,1],"same"),n=Cce(n,t.conv6),n=Cce(n,t.conv7),Sde(n,t.conv8,"valid",!1)}runMobilenet(e,t){let n=this.config.isFirstLayerConv2d?Nce(Sde(e,t.conv0,"valid",!1)):Tce(e,t.conv0);return n=BR(n,[2,2],[2,2],"same"),n=Tce(n,t.conv1),n=BR(n,[2,2],[2,2],"same"),n=Tce(n,t.conv2),n=BR(n,[2,2],[2,2],"same"),n=Tce(n,t.conv3),n=BR(n,[2,2],[2,2],"same"),n=Tce(n,t.conv4),n=BR(n,[2,2],[2,2],"same"),n=Tce(n,t.conv5),n=BR(n,[2,2],[1,1],"same"),n=t.conv6?Tce(n,t.conv6):n,n=t.conv7?Tce(n,t.conv7):n,Sde(n,t.conv8,"valid",!1)}forwardInput(e,t){let{params:n}=this;if(!n)throw new Error("TinyYolov2 - load model before inference");return j_((()=>{let r=D_(e.toBatchTensor(t,!1),"float32");return r=this.config.meanRgb?Fue(r,this.config.meanRgb):r,r=r.div(255),this.config.withSeparableConvs?this.runMobilenet(r,n):this.runTinyYolov2(r,n)}))}async forward(e,t){return this.forwardInput(await pde(e),t)}async detect(e,t={}){let{inputSize:n,scoreThreshold:r}=new $ce(t),a=await pde(e),i=await this.forwardInput(a,n),s=j_((()=>FF(i)[0].expandDims())),o={width:a.getInputWidth(0),height:a.getInputHeight(0)},l=await this.extractBoxes(s,a.getReshapedInputDimensions(0),r);i.dispose(),s.dispose();let u=l.map((e=>e.box)),d=l.map((e=>e.score)),c=l.map((e=>e.classScore)),p=l.map((e=>this.config.classes[e.label]));return function(e,t,n,r=!0){let a=t.map(((e,t)=>({score:e,boxIndex:t}))).sort(((e,t)=>e.score-t.score)).map((e=>e.boxIndex)),i=[];for(;a.length>0;){let t=a.pop();i.push(t);let s=a,o=[];for(let n=0;n<s.length;n++){let a=s[n],i=e[t],l=e[a];o.push(Due(i,l,r))}a=a.filter(((e,t)=>o[t]<=n))}return i}(u.map((e=>e.rescale(n))),d,this.config.iouThreshold,!0).map((e=>new Aue(d[e],c[e],p[e],u[e],o)))}getDefaultModelName(){return""}extractParamsFromWeightMap(e){return function(e,t){let n,r=[],{extractConvParams:a,extractConvWithBatchNormParams:i,extractSeparableConvParams:s}=_ce(e,r);if(t.withSeparableConvs){let e=t.filterSizes&&t.filterSizes.length||9;n={conv0:t.isFirstLayerConv2d?a("conv0"):s("conv0"),conv1:s("conv1"),conv2:s("conv2"),conv3:s("conv3"),conv4:s("conv4"),conv5:s("conv5"),conv6:e>7?s("conv6"):void 0,conv7:e>8?s("conv7"):void 0,conv8:a("conv8")}}else n={conv0:i("conv0"),conv1:i("conv1"),conv2:i("conv2"),conv3:i("conv3"),conv4:i("conv4"),conv5:i("conv5"),conv6:i("conv6"),conv7:i("conv7"),conv8:a("conv8")};return Ide(e,r),{params:n,paramMappings:r}}(e,this.config)}extractParams(e){let t=this.config.filterSizes||Ace.DEFAULT_FILTER_SIZES,n=t?t.length:void 0;if(7!==n&&8!==n&&9!==n)throw new Error(`TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found ${n} filterSizes in config`);return function(e,t,n,r){let a,{extractWeights:i,getRemainingWeights:s}=Ade(e),o=[],{extractConvParams:l,extractConvWithBatchNormParams:u,extractSeparableConvParams:d}=Ece(i,o);if(t.withSeparableConvs){let[e,i,s,o,u,c,p,h,f]=r;a={conv0:t.isFirstLayerConv2d?l(e,i,3,"conv0"):d(e,i,"conv0"),conv1:d(i,s,"conv1"),conv2:d(s,o,"conv2"),conv3:d(o,u,"conv3"),conv4:d(u,c,"conv4"),conv5:d(c,p,"conv5"),conv6:h?d(p,h,"conv6"):void 0,conv7:f?d(h,f,"conv7"):void 0,conv8:l(f||h||p,5*n,1,"conv8")}}else{let[e,t,i,s,o,d,c,p,h]=r;a={conv0:u(e,t,"conv0"),conv1:u(t,i,"conv1"),conv2:u(i,s,"conv2"),conv3:u(s,o,"conv3"),conv4:u(o,d,"conv4"),conv5:u(d,c,"conv5"),conv6:u(c,p,"conv6"),conv7:u(p,h,"conv7"),conv8:l(h,5*n,1,"conv8")}}if(0!==s().length)throw new Error(`weights remaing after extract: ${s().length}`);return{params:a,paramMappings:o}}(e,this.config,this.boxEncodingSize,t)}async extractBoxes(e,t,n){let{width:r,height:a}=t,i=Math.max(r,a),s=i/r,o=i/a,l=e.shape[1],u=this.config.anchors.length,[d,c,p]=j_((()=>{let t=e.reshape([l,l,u,this.boxEncodingSize]);return[t.slice([0,0,0,0],[l,l,u,4]),t.slice([0,0,0,4],[l,l,u,1]),this.withClassScores?oF(t.slice([0,0,0,5],[l,l,u,this.config.classes.length]),3):qA(0)]})),h=[],f=await c.array(),m=await d.array();for(let g=0;g<l;g++)for(let e=0;e<l;e++)for(let t=0;t<u;t++){let r=Mue(f[g][e][t][0]);if(!n||r>n){let n=(e+Mue(m[g][e][t][0]))/l*s,a=(g+Mue(m[g][e][t][1]))/l*o,i=Math.exp(m[g][e][t][2])*this.config.anchors[t].x/l*s,u=Math.exp(m[g][e][t][3])*this.config.anchors[t].y/l*o,d=n-i/2,c=a-u/2,f={row:g,col:e,anchor:t},{classScore:b,label:y}=this.withClassScores?await this.extractPredictedClass(p,f):{classScore:1,label:0};h.push({box:new $ue(d,c,d+i,c+u),score:r,classScore:r*b,label:y,...f})}}return d.dispose(),c.dispose(),p.dispose(),h}async extractPredictedClass(e,t){let{row:n,col:r,anchor:a}=t,i=await e.array();return Array(this.config.classes.length).fill(0).map(((e,t)=>i[n][r][a][t])).map(((e,t)=>({classScore:e,label:t}))).reduce(((e,t)=>e.classScore>t.classScore?e:t))}},Rce=Ace;Rce.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024];var Dce=class extends $ce{constructor(){super(...arguments),this._name="TinyFaceDetectorOptions"}},Fce=class{async then(e){return e(await this.run())}async run(){throw new Error("ComposableTask - run is not implemented")}};async function Mce(e,t,n,r,a=(({alignedRect:e})=>e)){let i=e.map((e=>Ude(e)?a(e):e.detection)),s=r||(t instanceof XT?await fde(t,i):await hde(t,i)),o=await n(s);return s.forEach((e=>e instanceof XT&&e.dispose())),o}async function Oce(e,t,n,r,a){return Mce([e],t,(async e=>n(e[0])),r,a)}var Pce=[new Eue(1.603231,2.094468),new Eue(6.041143,7.080126),new Eue(2.882459,3.518061),new Eue(4.266906,5.178857),new Eue(9.041765,10.66308)],Lce=[117.001,114.697,97.404],zce={ssdMobilenetv1:new class extends vde{constructor(){super("SsdMobilenetv1")}forwardInput(e){let{params:t}=this;if(!t)throw new Error("SsdMobilenetv1 - load model before inference");return j_((()=>{let n=D_(e.toBatchTensor(512,!1),"float32"),r=gce($R(i$(n,127.5),1),t.mobilenetv1),{boxPredictions:a,classPredictions:i}=function(e,t,n){return j_((()=>{let r=fce(e,n.conv_0,[1,1]),a=fce(r,n.conv_1,[2,2]),i=fce(a,n.conv_2,[1,1]),s=fce(i,n.conv_3,[2,2]),o=fce(s,n.conv_4,[1,1]),l=fce(o,n.conv_5,[2,2]),u=fce(l,n.conv_6,[1,1]),d=fce(u,n.conv_7,[2,2]),c=vce(t,n.box_predictor_0),p=vce(e,n.box_predictor_1),h=vce(a,n.box_predictor_2),f=vce(s,n.box_predictor_3),m=vce(l,n.box_predictor_4),g=vce(d,n.box_predictor_5);return{boxPredictions:L$([c.boxPredictionEncoding,p.boxPredictionEncoding,h.boxPredictionEncoding,f.boxPredictionEncoding,m.boxPredictionEncoding,g.boxPredictionEncoding],1),classPredictions:L$([c.classPrediction,p.classPrediction,h.classPrediction,f.classPrediction,m.classPrediction,g.classPrediction],1)}}))}(r.out,r.conv11,t.prediction_layer);return function(e,t,n){return j_((()=>{let r=e.shape[0],a=yce(M$(rR(n.extra_dim,[r,1,1]),[-1,4]),M$(e,[-1,4]));a=M$(a,[r,a.shape[0]/r,4]);let i=B$(W$(t,[0,0,1],[-1,-1,-1])),s=W$(i,[0,0,0],[-1,-1,1]);return s=M$(s,[r,s.shape[1]]),{boxes:FF(a),scores:FF(s)}}))}(a,i,t.output_layer)}))}async forward(e){return this.forwardInput(await pde(e))}async locateFaces(e,t={}){let{maxResults:n,minConfidence:r}=new xce(t),a=await pde(e),{boxes:i,scores:s}=this.forwardInput(a),o=i[0],l=s[0];for(let b=1;b<i.length;b++)i[b].dispose(),s[b].dispose();let u=Array.from(l.dataSync()),d=function(e,t,n,r,a){let i=e.shape[0],s=Math.min(n,i),o=t.map(((e,t)=>({score:e,boxIndex:t}))).filter((e=>e.score>a)).sort(((e,t)=>t.score-e.score)),l=e=>e<=r?1:0,u=[];return o.forEach((t=>{if(u.length>=s)return;let n=t.score;for(let r=u.length-1;r>=0;--r){let n=bce(e,t.boxIndex,u[r]);if(0!==n&&(t.score*=l(n),t.score<=a))break}n===t.score&&u.push(t.boxIndex)})),u}(o,u,n,.5,r),c=a.getReshapedInputDimensions(0),p=a.inputSize,h=p/c.width,f=p/c.height,m=o.arraySync(),g=d.map((e=>{let[t,n]=[Math.max(0,m[e][0]),Math.min(1,m[e][2])].map((e=>e*f)),[r,i]=[Math.max(0,m[e][1]),Math.min(1,m[e][3])].map((e=>e*h));return new Rue(u[e],new Pue(r,t,i-r,n-t),{height:a.getInputHeight(0),width:a.getInputWidth(0)})}));return o.dispose(),l.dispose(),g}getDefaultModelName(){return"ssd_mobilenetv1_model"}extractParamsFromWeightMap(e){return hce(e)}extractParams(e){return function(e){let t=[],{extractWeights:n,getRemainingWeights:r}=Ade(e),{extractMobilenetV1Params:a,extractPredictionLayerParams:i}=pce(n,t),s=a(),o=i(),l={extra_dim:wF(n(20472),[1,5118,4])};if(t.push({paramPath:"output_layer/extra_dim"}),0!==r().length)throw new Error(`weights remaing after extract: ${r().length}`);return{params:{mobilenetv1:s,prediction_layer:o,output_layer:l},paramMappings:t}}(e)}},tinyFaceDetector:new class extends Rce{constructor(){super({withSeparableConvs:!0,iouThreshold:.4,classes:["face"],anchors:Pce,meanRgb:Lce,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]})}get anchors(){return this.config.anchors}async locateFaces(e,t){return(await this.detect(e,t)).map((e=>new Rue(e.score,e.relativeBox,{width:e.imageWidth,height:e.imageHeight})))}getDefaultModelName(){return"tiny_face_detector_model"}extractParamsFromWeightMap(e){return super.extractParamsFromWeightMap(e)}},tinyYolov2:new class extends Rce{constructor(e=!0){super({withSeparableConvs:e,iouThreshold:.4,classes:["face"],...e?{anchors:kce,meanRgb:Sce}:{anchors:wce,withClassScores:!0}})}get withSeparableConvs(){return this.config.withSeparableConvs}get anchors(){return this.config.anchors}async locateFaces(e,t){return(await this.detect(e,t)).map((e=>new Rue(e.score,e.relativeBox,{width:e.imageWidth,height:e.imageHeight})))}getDefaultModelName(){return this.withSeparableConvs?"tiny_yolov2_separable_conv_model":"tiny_yolov2_model"}extractParamsFromWeightMap(e){return super.extractParamsFromWeightMap(e)}},faceLandmark68Net:new class extends ece{constructor(e=new Mde){super("FaceLandmark68Net",e)}getDefaultModelName(){return"face_landmark_68_model"}getClassifierChannelsIn(){return 256}},faceLandmark68TinyNet:new class extends ece{constructor(e=new tce){super("FaceLandmark68TinyNet",e)}getDefaultModelName(){return"face_landmark_68_tiny_model"}getClassifierChannelsIn(){return 128}},faceRecognitionNet:new class extends vde{constructor(){super("FaceRecognitionNet")}forwardInput(e){let{params:t}=this;if(!t)throw new Error("FaceRecognitionNet - load model before inference");return j_((()=>{let n=ace(Fue(D_(e.toBatchTensor(150,!0),"float32"),[122.782,117.001,104.298]).div(255),t.conv32_down);n=BR(n,3,2,"valid"),n=oce(n,t.conv32_1),n=oce(n,t.conv32_2),n=oce(n,t.conv32_3),n=lce(n,t.conv64_down),n=oce(n,t.conv64_1),n=oce(n,t.conv64_2),n=oce(n,t.conv64_3),n=lce(n,t.conv128_down),n=oce(n,t.conv128_1),n=oce(n,t.conv128_2),n=lce(n,t.conv256_down),n=oce(n,t.conv256_1),n=oce(n,t.conv256_2),n=lce(n,t.conv256_down_out);let r=n.mean([1,2]);return z$(r,t.fc)}))}async forward(e){return this.forwardInput(await pde(e))}async computeFaceDescriptor(e){var t;if(null!=(t=null==e?void 0:e.shape)&&t.some((e=>e<=0)))return new Float32Array(128);let n=await pde(e),r=j_((()=>FF(this.forwardInput(n)))),a=await Promise.all(r.map((e=>e.data())));return r.forEach((e=>e.dispose())),n.isBatchInput?a:a[0]}getDefaultModelName(){return"face_recognition_model"}extractParamsFromWeightMap(e){return function(e){let t=[],{extractConvLayerParams:n,extractResidualLayerParams:r}=sce(e,t),a=n("conv32_down"),i=r("conv32_1"),s=r("conv32_2"),o=r("conv32_3"),l=r("conv64_down"),u=r("conv64_1"),d=r("conv64_2"),c=r("conv64_3"),p=r("conv128_down"),h=r("conv128_1"),f=r("conv128_2"),m=r("conv256_down"),g=r("conv256_1"),b=r("conv256_2"),y=r("conv256_down_out"),{fc:v}=e;if(t.push({originalPath:"fc",paramPath:"fc"}),!gue(v))throw new Error(`expected weightMap[fc] to be a Tensor2D, instead have ${v}`);let x={conv32_down:a,conv32_1:i,conv32_2:s,conv32_3:o,conv64_down:l,conv64_1:u,conv64_2:d,conv64_3:c,conv128_down:p,conv128_1:h,conv128_2:f,conv256_down:m,conv256_1:g,conv256_2:b,conv256_down_out:y,fc:v};return Ide(e,t),{params:x,paramMappings:t}}(e)}extractParams(e){return function(e){let{extractWeights:t,getRemainingWeights:n}=Ade(e),r=[],{extractConvLayerParams:a,extractResidualLayerParams:i}=ice(t,r),s=a(4704,32,7,"conv32_down"),o=i(9216,32,3,"conv32_1"),l=i(9216,32,3,"conv32_2"),u=i(9216,32,3,"conv32_3"),d=i(36864,64,3,"conv64_down",!0),c=i(36864,64,3,"conv64_1"),p=i(36864,64,3,"conv64_2"),h=i(36864,64,3,"conv64_3"),f=i(147456,128,3,"conv128_down",!0),m=i(147456,128,3,"conv128_1"),g=i(147456,128,3,"conv128_2"),b=i(589824,256,3,"conv256_down",!0),y=i(589824,256,3,"conv256_1"),v=i(589824,256,3,"conv256_2"),x=i(589824,256,3,"conv256_down_out"),w=j_((()=>BF(xF(t(32768),[128,256]),[1,0])));if(r.push({paramPath:"fc"}),0!==n().length)throw new Error(`weights remaing after extract: ${n().length}`);return{params:{conv32_down:s,conv32_1:o,conv32_2:l,conv32_3:u,conv64_down:d,conv64_1:c,conv64_2:p,conv64_3:h,conv128_down:f,conv128_1:m,conv128_2:g,conv256_down:b,conv256_1:y,conv256_2:v,conv256_down_out:x,fc:w},paramMappings:r}}(e)}},faceExpressionNet:new class extends Lde{constructor(e=new Mde){super("FaceExpressionNet",e)}forwardInput(e){return j_((()=>oF(this.runNet(e))))}async forward(e){return this.forwardInput(await pde(e))}async predictExpressions(e){let t=await pde(e),n=await this.forwardInput(t),r=await Promise.all(FF(n).map((async e=>{let t=e.dataSync();return e.dispose(),t})));n.dispose();let a=r.map((e=>new Bde(e)));return t.isBatchInput?a:a[0]}getDefaultModelName(){return"face_expression_model"}getClassifierChannelsIn(){return 256}getClassifierChannelsOut(){return 7}},ageGenderNet:new class extends vde{constructor(e=new Zde(2)){super("AgeGenderNet"),this._faceFeatureExtractor=e}get faceFeatureExtractor(){return this._faceFeatureExtractor}runNet(e){let{params:t}=this;if(!t)throw new Error(`${this._name} - load model before inference`);return j_((()=>{let n=e instanceof cde?this.faceFeatureExtractor.forwardInput(e):e,r=O$(n,[7,7],[2,2],"valid").as2D(n.shape[0],-1);return{age:Ode(r,t.fc.age).as1D(),gender:Ode(r,t.fc.gender)}}))}forwardInput(e){return j_((()=>{let{age:t,gender:n}=this.runNet(e);return{age:t,gender:oF(n)}}))}async forward(e){return this.forwardInput(await pde(e))}async predictAgeAndGender(e){let t=await pde(e),n=await this.forwardInput(t),r=FF(n.age),a=FF(n.gender),i=r.map(((e,t)=>({ageTensor:e,genderTensor:a[t]}))),s=await Promise.all(i.map((async({ageTensor:e,genderTensor:t})=>{let n=e.dataSync()[0],r=t.dataSync()[0],a=r>.5,i=a?"male":"female",s=a?r:1-r;return e.dispose(),t.dispose(),{age:n,gender:i,genderProbability:s}})));return n.age.dispose(),n.gender.dispose(),t.isBatchInput?s:s[0]}getDefaultModelName(){return"age_gender_model"}dispose(e=!0){this.faceFeatureExtractor.dispose(e),super.dispose(e)}loadClassifierParams(e){let{params:t,paramMappings:n}=this.extractClassifierParams(e);this._params=t,this._paramMappings=n}extractClassifierParams(e){return function(e){let t=[],{extractWeights:n,getRemainingWeights:r}=Ade(e),a=Cde(n,t),i=a(512,1,"fc/age"),s=a(512,2,"fc/gender");if(0!==r().length)throw new Error(`weights remaing after extract: ${r().length}`);return{paramMappings:t,params:{fc:{age:i,gender:s}}}}(e)}extractParamsFromWeightMap(e){let{featureExtractorMap:t,classifierMap:n}=Pde(e);return this.faceFeatureExtractor.loadFromWeightMap(t),function(e){let t=[],n=$de(e,t);function r(e){return{weights:n(`${e}/weights`,2),bias:n(`${e}/bias`,1)}}let a={fc:{age:r("fc/age"),gender:r("fc/gender")}};return Ide(e,t),{params:a,paramMappings:t}}(n)}extractParams(e){let t=e.slice(0,e.length-1539),n=e.slice(e.length-1539);return this.faceFeatureExtractor.extractWeights(t),this.extractClassifierParams(n)}}},Bce=class extends Fce{constructor(e,t,n){super(),this.parentTask=e,this.input=t,this.extractedFaces=n}},Wce=class extends Bce{async run(){let e=await this.parentTask,t=await Mce(e,this.input,(async e=>Promise.all(e.map((e=>zce.faceExpressionNet.predictExpressions(e))))),this.extractedFaces);return e.map(((e,n)=>Wde(e,t[n])))}withAgeAndGender(){return new Gce(this,this.input)}},Vce=class extends Bce{async run(){let e=await this.parentTask;if(!e)return;let t=await Oce(e,this.input,(e=>zce.faceExpressionNet.predictExpressions(e)),this.extractedFaces);return Wde(e,t)}withAgeAndGender(){return new qce(this,this.input)}},Uce=class extends Wce{withAgeAndGender(){return new Kce(this,this.input)}withFaceDescriptors(){return new Jce(this,this.input)}},jce=class extends Vce{withAgeAndGender(){return new Xce(this,this.input)}withFaceDescriptor(){return new Zce(this,this.input)}},Hce=class extends Fce{constructor(e,t,n){super(),this.parentTask=e,this.input=t,this.extractedFaces=n}},Gce=class extends Hce{async run(){let e=await this.parentTask,t=await Mce(e,this.input,(async e=>Promise.all(e.map((e=>zce.ageGenderNet.predictAgeAndGender(e))))),this.extractedFaces);return e.map(((e,n)=>{let{age:r,gender:a,genderProbability:i}=t[n];return dce(cce(e,a,i),r)}))}withFaceExpressions(){return new Wce(this,this.input)}},qce=class extends Hce{async run(){let e=await this.parentTask;if(!e)return;let{age:t,gender:n,genderProbability:r}=await Oce(e,this.input,(e=>zce.ageGenderNet.predictAgeAndGender(e)),this.extractedFaces);return dce(cce(e,n,r),t)}withFaceExpressions(){return new Vce(this,this.input)}},Kce=class extends Gce{withFaceExpressions(){return new Uce(this,this.input)}withFaceDescriptors(){return new Jce(this,this.input)}},Xce=class extends qce{withFaceExpressions(){return new jce(this,this.input)}withFaceDescriptor(){return new Zce(this,this.input)}},Yce=class extends Fce{constructor(e,t){super(),this.parentTask=e,this.input=t}},Jce=class extends Yce{async run(){let e=await this.parentTask;return(await Mce(e,this.input,(e=>Promise.all(e.map((e=>zce.faceRecognitionNet.computeFaceDescriptor(e))))),null,(e=>e.landmarks.align(null,{useDlibAlignment:!0})))).map(((t,n)=>uce(e[n],t)))}withFaceExpressions(){return new Uce(this,this.input)}withAgeAndGender(){return new Kce(this,this.input)}},Zce=class extends Yce{async run(){let e=await this.parentTask;if(!e)return;let t=await Oce(e,this.input,(e=>zce.faceRecognitionNet.computeFaceDescriptor(e)),null,(e=>e.landmarks.align(null,{useDlibAlignment:!0})));return uce(e,t)}withFaceExpressions(){return new jce(this,this.input)}withAgeAndGender(){return new Xce(this,this.input)}},Qce=class extends Fce{constructor(e,t,n){super(),this.parentTask=e,this.input=t,this.useTinyLandmarkNet=n}get landmarkNet(){return this.useTinyLandmarkNet?zce.faceLandmark68TinyNet:zce.faceLandmark68Net}},epe=class extends Qce{async run(){let e=await this.parentTask,t=e.map((e=>e.detection)),n=this.input instanceof XT?await fde(this.input,t):await hde(this.input,t),r=await Promise.all(n.map((e=>this.landmarkNet.detectLandmarks(e))));return n.forEach((e=>e instanceof XT&&e.dispose())),e.filter(((e,t)=>r[t])).map(((e,t)=>jde(e,r[t])))}withFaceExpressions(){return new Uce(this,this.input)}withAgeAndGender(){return new Kce(this,this.input)}withFaceDescriptors(){return new Jce(this,this.input)}},tpe=class extends Qce{async run(){let e=await this.parentTask;if(!e)return;let{detection:t}=e,n=this.input instanceof XT?await fde(this.input,[t]):await hde(this.input,[t]),r=await this.landmarkNet.detectLandmarks(n[0]);return n.forEach((e=>e instanceof XT&&e.dispose())),jde(e,r)}withFaceExpressions(){return new jce(this,this.input)}withAgeAndGender(){return new Xce(this,this.input)}withFaceDescriptor(){return new Zce(this,this.input)}},npe=class extends Fce{constructor(e,t=new xce){super(),this.input=e,this.options=t}},rpe=class extends npe{async run(){let e,{input:t,options:n}=this;if(n instanceof Dce)e=zce.tinyFaceDetector.locateFaces(t,n);else if(n instanceof xce)e=zce.ssdMobilenetv1.locateFaces(t,n);else{if(!(n instanceof $ce))throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | TinyYolov2Options");e=zce.tinyYolov2.locateFaces(t,n)}return e}runAndExtendWithFaceDetections(){return new Promise(((e,t)=>{this.run().then((t=>e(t.map((e=>Uue({},e)))))).catch((e=>t(e)))}))}withFaceLandmarks(e=!1){return new epe(this.runAndExtendWithFaceDetections(),this.input,e)}withFaceExpressions(){return new Wce(this.runAndExtendWithFaceDetections(),this.input)}withAgeAndGender(){return new Gce(this.runAndExtendWithFaceDetections(),this.input)}},ape=class extends npe{async run(){let e=await new rpe(this.input,this.options),t=e[0];return e.forEach((e=>{e.score>t.score&&(t=e)})),t}runAndExtendWithFaceDetection(){return new Promise((async e=>{let t=await this.run();e(t?Uue({},t):void 0)}))}withFaceLandmarks(e=!1){return new tpe(this.runAndExtendWithFaceDetection(),this.input,e)}withFaceExpressions(){return new Vce(this.runAndExtendWithFaceDetection(),this.input)}withAgeAndGender(){return new qce(this.runAndExtendWithFaceDetection(),this.input)}},ipe=class{constructor(e,t=.6){this._distanceThreshold=t;let n=Array.isArray(e)?e:[e];if(!n.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");let r=1,a=()=>"person "+r++;this._labeledDescriptors=n.map((e=>{if(e instanceof Wue)return e;if(e instanceof Float32Array)return new Wue(a(),[e]);if(e.descriptor&&e.descriptor instanceof Float32Array)return new Wue(a(),[e.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")}))}get labeledDescriptors(){return this._labeledDescriptors}get distanceThreshold(){return this._distanceThreshold}computeMeanDistance(e,t){return t.map((t=>function(e,t){if(e.length!==t.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");let n=Array.from(e),r=Array.from(t);return Math.sqrt(n.map(((e,t)=>e-r[t])).reduce(((e,t)=>e+t*t),0))}(t,e))).reduce(((e,t)=>e+t),0)/(t.length||1)}matchDescriptor(e){return this.labeledDescriptors.map((({descriptors:t,label:n})=>new Bue(n,this.computeMeanDistance(e,t)))).reduce(((e,t)=>e.distance<t.distance?e:t))}findBestMatch(e){let t=this.matchDescriptor(e);return t.distance<this._distanceThreshold?t:new Bue("unknown",t.distance)}toJSON(){return{distanceThreshold:this._distanceThreshold,labeledDescriptors:this._labeledDescriptors.map((e=>e.toJSON()))}}static fromJSON(e){let t=e.labeledDescriptors.map((e=>Wue.fromJSON(e)));return new ipe(t,e.distanceThreshold)}};function spe(e,t){let{width:n,height:r}=new hue(t.width,t.height);if(n<=0||r<=0)throw new Error(`resizeResults - invalid dimensions: ${JSON.stringify({width:n,height:r})}`);if(Array.isArray(e))return e.map((e=>spe(e,{width:n,height:r})));if(Ude(e)){let t=e.detection.forSize(n,r),a=e.unshiftedLandmarks.forSize(t.box.width,t.box.height);return jde(Uue(e,t),a)}return Vue(e)?Uue(e,e.detection.forSize(n,r)):e instanceof Lue||e instanceof Rue?e.forSize(n,r):e}const ope=()=>{const e=W.useRef(null),t=W.useRef(null),n=W.useRef(null),r=W.useRef(!1);W.useState(!1),W.useState(null),W.useState(!1);const[a,i]=W.useState(!0),[s,o]=W.useState(!1),[l,u]=W.useState(null);return W.useEffect((()=>{(async()=>{await zce.tinyFaceDetector.loadFromUri("/models"),await zce.faceRecognitionNet.loadFromUri("/models"),await zce.faceLandmark68Net.loadFromUri("/models"),(async()=>{try{const t=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1});e.current&&(e.current.srcObject=t),i(!1),r.current=!0,o(!0)}catch(t){console.error("Error accessing webcam:",t)}})()})()}),[]),Y.jsx("div",{children:a?Y.jsx(nw,{name:"lines"}):Y.jsxs(Y.Fragment,{children:[Y.jsx("video",{ref:e,autoPlay:!0,playsInline:!0,muted:!0}),Y.jsx("canvas",{ref:t,style:{display:"none"}}),Y.jsx("button",{onClick:()=>{if(e.current){var n,r,a;const i=e.current.videoWidth,s=e.current.videoHeight;null===(n=t.current)||void 0===n||n.setAttribute("width",String(i)),null===(r=t.current)||void 0===r||r.setAttribute("height",String(s));const o=t.current;null==o||null===(a=o.getContext("2d"))||void 0===a||a.drawImage(e.current,0,0,i,s);const l=null==o?void 0:o.toDataURL();u(l)}},children:"Take Photo"}),l&&Y.jsx("img",{ref:n,src:l,alt:"Captured",style:{maxWidth:"100%",maxHeight:"300px",marginTop:"20px"}})]})})},lpe=()=>Y.jsxs("div",{children:[Y.jsx("h1",{children:"Face Recognition App"}),Y.jsx(ope,{})]}),upe="/assets/test-03c7e081.svg";function dpe(){const[e,t]=W.useState(window.innerWidth);W.useState(window.innerHeight);const n=()=>{t(window.innerWidth)};return W.useEffect((()=>(window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n)})),[]),Y.jsx(Y.Fragment,{children:window.innerWidth<=window.innerHeight?Y.jsxs(Yx,{style:{border:"0px"},children:[Y.jsx(Qx,{style:{border:"0px"},children:Y.jsx(Kx,{size:"12",style:{border:"0px"},children:Y.jsx("img",{style:{width:"13%",marginLeft:"45%",marginTop:"7.5%"},src:upe,alt:"Logo"})})}),Y.jsx(Qx,{children:Y.jsx(Kx,{style:{border:"0px"},children:Y.jsx("div",{style:{textAlign:"center",fontSize:"180%",fontWeight:700,letterSpacing:"-3.12%",color:"white",marginTop:"2%",marginBottom:"5%"},children:"홀리데이 피트니스클럽(광주효천점)"})})})]}):Y.jsx(Yx,{style:{border:"0px"},children:Y.jsxs(Qx,{style:{border:"0px"},children:[Y.jsx(Kx,{size:"auto",style:{marginLeft:"3%",marginBottom:"18%",border:"0px"},children:Y.jsx("img",{style:{width:"100%",marginLeft:"5%"},src:upe,alt:"Logo"})}),Y.jsx(Kx,{size:"auto",style:{marginLeft:"0.7%",marginBottom:"18%",border:"0px"},children:Y.jsx("div",{style:{textAlign:"center",color:"white",fontWeight:700,letterSpacing:"-3.12%",fontSize:"190%",marginTop:"6%"},children:"홀리데이 피트니스클럽(광주효천점)"})})]})})})}Pw({mode:"md"});const cpe=e=>{const[t,n]=W.useState(!1),[r,a]=W.useState("회원번호 입력 (5자리)"),[i,s]=W.useState(!1),o=n=>{0==t?(e.settypeid(!1),l(n)):1==t&&(e.settypeid(!0),u(n))},l=e=>{0==i&&r.length>=6&&(a(""+e.target.textContent),s(!0)),5==r.length||(r.length>5?a(e.target.textContent):a(r+e.target.textContent))},u=t=>{0==i&&(a(""+t.target.textContent),s(!0)),3==r.length||8==r.length?a(r+"-"+t.target.textContent):r.length>=13?r.length>13&&a(t.target.textContent):a(r+t.target.textContent),e.AlertFunc(r)};return W.useEffect((()=>{e.AlertFunc(r)})),Y.jsxs(Y.Fragment,{children:[Y.jsx(Jx,{}),Y.jsx(Xx,{children:Y.jsxs(Yx,{class:"input_box",children:[Y.jsx(Qx,{class:"input_segment",children:Y.jsxs(ew,{class:"input_segment",onIonChange:e=>(e=>{"clubID"==e?(n(!1),a("회원번호 입력 (5자리)")):"Tel"==e&&(n(!0),a("010-")),s(!1)})(e.target.value),children:[Y.jsx(tw,{class:"input_segment",value:"clubID",children:Y.jsx(Zx,{children:"회원번호"})}),Y.jsx(tw,{class:"input_segment",value:"Tel",children:Y.jsx(Zx,{children:"휴대폰번호"})})]})}),Y.jsx(Qx,{class:"input_div_row",children:Y.jsx(Kx,{class:"input_box",children:Y.jsx("div",{className:"input_div ion-text-center",children:r})})}),Y.jsxs(Qx,{class:"input_desc",children:[Y.jsx("div",{className:"hr"}),Y.jsx("div",{className:"input_desc",children:"만약 얼굴인식이 안되는 경우, \n본인의 회원번호(5자리) 혹은 휴대폰번호를 입력해주세요."})]}),Y.jsxs(Qx,{class:"input_pad",children:[Y.jsx(Qx,{class:"input_row",children:Y.jsxs(Kx,{class:"input_box",children:[Y.jsx(sw,{class:"input_btn",onClick:o,children:"1"}),Y.jsx(sw,{class:"input_btn",onClick:o,children:"2"}),Y.jsx(sw,{class:"input_btn",onClick:o,children:"3"})]})}),Y.jsx(Qx,{class:"input_row",children:Y.jsxs(Kx,{class:"input_box",children:[Y.jsx(sw,{class:"input_btn",onClick:o,children:"4"}),Y.jsx(sw,{class:"input_btn",onClick:o,children:"5"}),Y.jsx(sw,{class:"input_btn",onClick:o,children:"6"})]})}),Y.jsx(Qx,{class:"input_row",children:Y.jsxs(Kx,{class:"input_box",children:[Y.jsx(sw,{class:"input_btn",onClick:o,children:"7"}),Y.jsx(sw,{class:"input_btn",onClick:o,children:"8"}),Y.jsx(sw,{class:"input_btn",onClick:o,children:"9"})]})}),Y.jsx(Qx,{class:"input_row",children:Y.jsxs(Kx,{class:"input_box",children:[Y.jsx(sw,{class:"input_btn",onClick:()=>{a("")},children:"취소"}),Y.jsx(sw,{class:"input_btn",onClick:o,children:"0"}),Y.jsx(sw,{class:"input_btn",onClick:()=>{1!=t||5!=r.length&&10!=r.length?a(r.slice(0,-1)):a(r.slice(0,-2))},children:"←"})]})})]})]})})]})};function ppe(){const[e,t]=W.useState(window.innerWidth);W.useState(window.innerHeight);const n=()=>{t(window.innerWidth)};return W.useEffect((()=>(window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n)})),[]),Y.jsx(Y.Fragment,{children:window.innerWidth<=window.innerHeight?Y.jsx(Yx,{children:Y.jsx(Qx,{style:{height:"280px"},children:Y.jsx(Kx,{style:{border:"0px",margin:"0px auto",padding:"5px 5px"},children:Y.jsxs("div",{style:{width:"710px",height:"300px",backgroundColor:"white",borderRadius:"1.2%",color:"black",textAlign:"left",paddingLeft:"6%",paddingTop:"5%",fontSize:"125%",fontWeight:400,lineHeight:"190%",marginTop:"-5.5%",marginLeft:"-1%"},children:["∙ 여름시즌 다이어트 프로그램 안내",Y.jsx("br",{}),"∙ 이번달 회원 등록시 운동복 무료 이용권 증정"]})})})}):Y.jsx(Yx,{})})}function hpe(e){const[t,n]=W.useState("0000년 00월 00일() 00:00:00"),[r,a]=W.useState("D-"),[i,s]=W.useState("D-"),[o,l]=W.useState("D-"),[u,d]=W.useState(""),[c,p]=W.useState(""),[h,f]=W.useState(""),[m,g]=W.useState("");W.useState(!1),W.useState([]),W.useState(""),W.useState(""),W.useState(""),W.useState(""),W.useState(""),W.useState(""),W.useState(""),W.useState(""),W.useState(""),W.useState("");const b=()=>{(()=>{var t=new Date;const r=t.getHours(),i=String(t.getMinutes()).padStart(2,"0"),o=String(t.getSeconds()).padStart(2,"0"),u=t.getFullYear(),c=t.getMonth()+1,h=t.getDate();let m=["일","월","화","수","목","금","토"][t.getDay()];n(`${u}년 ${c}월 ${h}일(${m}) ${r}:${i}:${o}`);var b=new Date(e.product.substring(0,4),e.product.substring(5,7)-1,e.product.substring(8,10));const y=String(b.getFullYear()),v=String(b.getMonth()+1).padStart(2,"0"),x=String(b.getDate()).padStart(2,"0");var w=b.getTime()-t.getTime(),k=Math.ceil(w/864e5);p(`${y}년 ${v}월 ${x}일`),a(`D-${k}`),d(k>0?"사용중":"미사용");var S=new Date(e.locker.substring(0,4),e.locker.substring(5,7)-1,e.locker.substring(8,10));const I=String(S.getFullYear()),N=String(S.getMonth()+1).padStart(2,"0"),C=String(S.getDate()).padStart(2,"0");var T=S.getTime()-t.getTime(),E=Math.ceil(T/864e5);f(`${I}년 ${N}월 ${C}일`),s(`D-${E}`),d(E>0?"사용중":"미사용");var _=new Date(e.duclass.substring(0,4),e.duclass.substring(5,7)-1,e.duclass.substring(8,10));const $=String(_.getFullYear()),A=String(_.getMonth()+1).padStart(2,"0"),R=String(_.getDate()).padStart(2,"0");var D=_.getTime()-t.getTime(),F=Math.ceil(D/864e5);g(`${$}년 ${A}월 ${R}일`),l(`D-${F}`)})()};let y,v,x;return W.useEffect((()=>{b()}),[]),console.log(e.onCancelButtonClick),null==e.detectedName?y=Y.jsx("p",{style:{fontSize:"27px",color:"#FF6300",marginTop:"4.9%",fontWeight:"700"},children:e.idd}):e.detectedName&&(y=Y.jsx("p",{style:{fontSize:"27px",color:"#FF6300",marginTop:"4.9%",fontWeight:"700"},children:e.detectedName})),console.log(e.profile_img),null==e.selfieURL?v=null!=e.profile_img?Y.jsx("img",{style:{width:"230px",height:"180px",borderRadius:"10px"},src:e.profile_img}):Y.jsx("img",{style:{width:"230px",height:"180px",borderRadius:"10px"},src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANsAAADmCAMAAABruQABAAAAP1BMVEWnp6f///+0tLSkpKShoaG4uLjo6OjOzs7X19f29vbl5eXCwsLKysrU1NTx8fGqqqrd3d3n5+fu7u6vr6+/v78V2MF7AAAHg0lEQVR4nO2d27aqMAxFK60XvB/1/7/1gHgBKQpZKwE69nrbL1vmaJu0aZq4hYHyy/Z8WO93hfb79ea8yi1+deGU///xvM98CMHXVfx93R0uyj+ty3beuQLKRVUSLg9HzZ/XYzsvi9GKc9X4Tms9PCW2y+4n2JMvZGedb9Bh+5f1BKsU/EHjKzTYVtdBZNXgadDR2fJlGAhW0Xn+zGSzrQeP2VMhY3s9LtvlJCVzChOTynYQTUe1oWOyyVZaY+j8ivg9PLYcmY/vodvQPojHdmSQlXB71hfR2C7wfHzB7UifxGLjoRHhOGxHIhpvWlLYctJae8FxHB2FjWIhG3CUDRiDbclGK+AYpzoCG7obieqEfxeBjWtHnvK3KbCdNNCKWbkdn23NX2yV/OhsucqMvLPBLhxlU7CRT8G2EmT7pzZsxcBl47Jd9dCKgQMPcxjbVnHYCoEDh7FlqmjowEFszJNNTH45HttNz0hWClBsCGJTHrZi4NZjsW20h63QWGyqDqASZE0ANr3t1lvQxgtgs5iS0I4ZYFPcSr4VgFtxgM1gSmKWUs6muU2uCdh3ydnUDqVNhTHYTJYb5AXkbDZT0nn5xY6YTSe8FWGTezgxm/LR7a2rPdvBZrkhxkTMtjNjE59zxGzKR+4am9hQitms0Jw8qUbMZmVKnDzZS8pmccB5sIlvUaVsVu4NcXBSNu0QV41NHOySsq3M2OQnASmb2bYE2Jj8sY3KJr76ngFbyuP2x0Zks/MB9v4tZd+d8p4r5b1yymecpM+mdjGFf+ZsdrEgcXqQmM3oOmCUGN7Zik2eJSpms3LeQI7J9O865JeLcjYbNCTlXM6mnhT0YJNnUcrZjC47gEQFOZvNKQdJV/vLU4jKIOUJS3oC2Ex2JkCaAsJmkWACZYcieXgWbMhrMYTNIMMEeiPwlxsal37MRB4rQdn0vQCWRA+x6W+7kK/D2LQnJTYlJ/6uAysFhbEpBxbAR6fgOyrVSYmWEQLZVCN52IsVmE0zIgQ/FUbfZCq6ONCS4GxnvYGTJ4WS2BZqCw6vqQCz6e1N0C8jvMtXmpRAfjmPba8zcPizfEYdDJ1aEYTyLAQ2nZgQ/l2U2iwKA0cp08VgUzCVjNIsnHpBdDRC8ZIFiY29OYGrRFTi1OfKuLOSUglpmrXHwFDCS6SacVwHzvkmWq0/IhnHkCx4bLybRkb1qkq0+pO06AJhI/kQr24oCU2evtX+Itp/4oROWDayFLGWLaUuHhxIqIlapxdfcmjYriFqfWUcjWX+q89h/jN0exKgEjotcWt+Yy8iwLJOLZFrtSP2xDPtSCl2HfodAEf+FH7/ALGx9PTGMvy+D0I4z+9JotDTQsSGVRmLS4FNtGuGL20iUmATOQLe7v8tjR4yAjbeoa0mDTZB9oJKhxwNNkHwBC1/GpUGmyCHjbr/f0qDTRCK1TAlKmwCQ0mJ/39qImzsbfJdKnNy+HqbDZvgsnE2c1KwW56NLRHsS+biAySJh9wg0EMKbJJGEHizgIj4bBtRVAF5m9IlOpswh3kWZ1NpaxIFa8Jmk7c44rs4Ltuqq8NuD/nTlHtJ5jcsZj7dXpKbYc1oo0MXbkw/R2Jb3WCwB53f0wKVFLbNiUP2wLuSWtRScgzZuWo+UAYPZcv3xCGr02Vj99pSIqvoTmgOJcSmR3YX2tcbYDvQ11lLHrolltf8dia1IhA6Idsxs6vPJd6uyNiUF9onnfAdhITtrL/QPhROEo8wnC3H23RL6LLh3nww28F0Or7lh3cZHsiW29mQNt3QynjD2DYjDdpDYTno+DqEbZyVVpcf9JZlANvW3DxGFLL+Q9efbT/2oFUaMHR92fLrBAatUuibrteTbTuuEWnK+3752v3Y1tOYjy/183W92Ea3jy2FPi+terDl8lixnrz/nQD2m82ww8Mg/baXP9kUiwqACr/u7H6xTc2K1PUrd/sHG5J+rK8f1yPf2cDLC3X5r5nAX9mM2g4i+pYv+42N/EJWR1+yE7+wzQLtW/pGN9tM0L7AdbLNBq37qWMX2wzMyFsdBqWDzagwNEvxh/xxtomcsfsr+pgnykZ5OWqrWHZKjM2wZxFNsdIZETa71jdMRTL5Imxjf6VQ7fNcm21Gjq2plidosSmV27LQZ9LzJ9sc7chTn2fVDza7NlMa+lhyH2yzXWyVmgmmTbYZOu2mrp1s8/RsdTVyGhpsJp0cdFWflXW22c9I17SVNbZ528inaqfwGtusjqPdOkXYLNpvWOjt5N5s0kcLk5NvsU33TmOoXlmXL7axv4go/8Eme/00TT0HzqU3bO5ZwcalttpKPcqFu8SMZKWsxjbnE2lMVSzWpbQleamqGOjS2UnW5V9sZj1mzXTfMbv0HECpeyS2ZLPrD28n/2CbcUiyU+U1uEtySlbvxV0KEaCYrnc2owazxgp3ttQcd6XCCzizZtXGKhacS9IDuHswz5l0uxxFBZtqm7MRFQq2BALlUYWL02uWNbL81qV3vnnIb1yiZrI8n7rUwgkv+Z1TbuM5opYuzd1kqcylF0946upSPJhWOrlUtyWlUmZbZ8nqP3tfdfEE2tVdAAAAAElFTkSuQmCC"}):e.selfieURL&&(v=Y.jsx("img",{style:{width:"230px",height:"180px",borderRadius:"10px"},src:e.selfieURL})),null==e.onCancelButtonClick?x=Y.jsx(sw,{size:"large",expand:"block",onClick:()=>e.handleClosebtnModal(),children:"확인"}):e.onCancelButtonClick&&(x=Y.jsx(sw,{size:"large",expand:"block",onClick:()=>e.onCancelButtonClick(),children:"확인"})),console.log(e.detectedName),console.log(e.mile),Y.jsx(Y.Fragment,{children:Y.jsxs(Yx,{children:[Y.jsx(Qx,{children:Y.jsxs("div",{className:"head",children:[Y.jsx(Kx,{size:"auto",children:Y.jsx("div",{children:v})}),Y.jsx(Kx,{size:"auto",children:Y.jsxs("div",{className:"body2",children:[Y.jsxs("div",{className:"body2_name",children:[y,Y.jsx("p",{className:"body2_nim",children:"님,"}),Y.jsx("p",{className:"body2_welcome",children:"환영합니다."})]}),Y.jsx("div",{className:"body2_time",children:t}),Y.jsxs("div",{className:"body2_p1",children:[Y.jsx("p",{className:"body2_mil",children:"보유 마일리지"}),Y.jsxs("p",{className:"body2_score",children:[e.mile.length>3?e.mile.substring(0,1)+","+e.mile.substring(1):e.mile,"점"]})]}),Y.jsxs("div",{className:"body2_p2",children:[Y.jsx("p",{className:"body2_mil",children:"이달 출석횟수"}),Y.jsxs("p",{className:"body2_score",children:[e.come,"회"]})]})]})})]})}),Y.jsx(Qx,{children:Y.jsx(Kx,{size:"auto",children:Y.jsxs("div",{className:"body3",children:[" ",Y.jsx("div",{className:"body3_circle"})," ",Y.jsxs("div",{className:"body3_p1",children:[Y.jsx("p",{className:"body3_p1_finish",children:"회원권 만료일"}),Y.jsxs("div",{className:"body3_p1_r",children:[Y.jsxs("p",{className:"body3_p1_r_date",children:[" ",c]}),Y.jsxs("p",{className:"dday",children:[" ",r]})]})]}),Y.jsxs("div",{className:"body3_p2",children:[" ",Y.jsx("p",{className:"body3_p2_product",children:"회원권 상품명"}),Y.jsxs("div",{className:"body3_p2_r",children:[" ",Y.jsx("p",{className:"body3_p1_r_date",children:e.have})]})]})]})})}),Y.jsx(Qx,{children:Y.jsx(Kx,{size:"auto",children:Y.jsxs("div",{className:"body3",children:[" ",Y.jsx("div",{className:"body3_circle"})," ",Y.jsxs("div",{className:"body3_p1",children:[Y.jsx("p",{className:"body3_p1_finish",children:"개인 락커"}),Y.jsxs("div",{className:"body3_p1_r",children:[Y.jsx("p",{className:"use",children:u}),Y.jsxs("p",{style:{marginTop:"4.2%"},className:"body4_date",children:[" ",h]}),Y.jsxs("p",{className:"dday",style:{marginTop:"4%"},children:[" ",i]})]})]}),Y.jsxs("div",{className:"body3_p2",children:[" ",Y.jsx("p",{className:"body3_p2_product",style:{marginTop:"4%"},children:"운동복"}),Y.jsxs("div",{className:"body3_p2_r",children:[" ",Y.jsx("p",{className:"use",style:{marginTop:"6.7%"},children:u}),Y.jsx("p",{className:"body4_date",style:{marginTop:"5.7%"},children:"운동복이용권"})]})]})]})})}),Y.jsx(Qx,{children:Y.jsx(Kx,{size:"auto",children:Y.jsxs("div",{className:"body5",children:[Y.jsx("div",{className:"body5_circle"})," ",Y.jsxs("div",{className:"body5_p1",children:[Y.jsx("p",{className:"body3_p1_finish",children:"수강권 만료일"}),Y.jsxs("div",{className:"body3_p1_r",children:[Y.jsx("p",{className:"body3_p1_r_date",children:m}),Y.jsx("p",{className:"dday",children:o})]})]}),Y.jsxs("div",{className:"body5_p2",children:[Y.jsx("p",{className:"body3_p1_finish",children:"남은 횟수"}),Y.jsxs("div",{className:"body3_p1_r",children:[Y.jsxs("p",{className:"body5_left",children:[e.left,"회"]}),Y.jsx("p",{className:"body5_left2",children:"남음"})]})]}),Y.jsxs("div",{className:"body5_p2",children:[Y.jsx("p",{className:"body3_p1_finish",children:"수강권 상품권"}),Y.jsx("div",{className:"body3_p1_r",children:Y.jsx("p",{className:"body3_p1_r_date",style:{marginTop:"5%"},children:e.inclass})})]}),Y.jsx("div",{className:"btnn",children:x})]})})})]})})}const fpe=({detectedName:e,mid:t,tel:n,selfieURL:r,mile:a,come:i,product:s,have:o,locker:l,duclass:u,left:d,inclass:c,onClose:p})=>{const[h,f]=W.useState(!1);return Y.jsxs(Y.Fragment,{children:[Y.jsx(Yx,{children:Y.jsx(Qx,{children:Y.jsxs(Kx,{children:[Y.jsx("img",{className:"Check_logo",src:"/assets/check-6c47b649.svg"}),Y.jsxs("div",{className:"modal_text",children:[Y.jsxs("h2",{className:"modal_h2",children:[" ",e,"님"]}),Y.jsx("h2",{className:"modal_h2",children:"인증 완료되었습니다."})]})]})})}),Y.jsx(Yx,{children:Y.jsx(Qx,{children:Y.jsx(Kx,{children:r&&Y.jsx("img",{src:r,className:"selfie",alt:"Captured Selfie",style:{width:"100%",height:"310px"}})})})}),Y.jsx(Yx,{children:Y.jsx(Qx,{children:Y.jsx(Kx,{children:Y.jsxs("div",{className:"btn_block",children:[Y.jsxs("div",{className:"modal_text",children:[Y.jsxs("div",{className:"Member_Number",children:[Y.jsx("div",{className:"num_text",children:"회원번호"}),Y.jsx("div",{className:"real_num",children:t})]}),Y.jsxs("div",{className:"Member_Number",children:[Y.jsx("div",{className:"num_text",children:"전화번호"}),Y.jsxs("div",{className:"real_num",children:[" ",n]})]})]}),Y.jsxs("div",{className:"modal_button",children:[Y.jsx("button",{className:"btn_attandance",onClick:()=>{f(!0)},children:"출석"}),Y.jsx("button",{className:"btn_cancel",onClick:p,children:"취소"})]})]})})})}),h&&Y.jsx(dw,{backdropDismiss:!1,isOpen:!0,onRequestClose:()=>f(!1),contentLabel:"New Modal",style:{content:{width:"640px",height:"710px",margin:"auto",background:"#232323"}},children:Y.jsx(hpe,{detectedName:e,selfieURL:r,mile:a,come:i,product:s,have:o,locker:l,duclass:u,left:d,inclass:c,onRequestClose:()=>f(!1),onCancelButtonClick:()=>{f(!1),p()}})})]})},mpe=e=>e.CapacitorPlatforms=(e=>{const t=new Map;t.set("web",{name:"web"});const n=e.CapacitorPlatforms||{currentPlatform:{name:"web"},platforms:t};return n.addPlatform=(e,t)=>{n.platforms.set(e,t)},n.setPlatform=e=>{n.platforms.has(e)&&(n.currentPlatform=n.platforms.get(e))},n})(e),gpe=mpe("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{});/*! Capacitor: https://capacitorjs.com/ - MIT License */var bpe;gpe.addPlatform,gpe.setPlatform,function(e){e.Unimplemented="UNIMPLEMENTED",e.Unavailable="UNAVAILABLE"}(bpe||(bpe={}));class ype extends Error{constructor(e,t,n){super(e),this.message=e,this.code=t,this.data=n}}const vpe=e=>{var t,n,r,a,i;const s=e.CapacitorCustomPlatform||null,o=e.Capacitor||{},l=o.Plugins=o.Plugins||{},u=e.CapacitorPlatforms,d=(null===(t=null==u?void 0:u.currentPlatform)||void 0===t?void 0:t.getPlatform)||(()=>null!==s?s.name:(e=>{var t,n;return(null==e?void 0:e.androidBridge)?"android":(null===(n=null===(t=null==e?void 0:e.webkit)||void 0===t?void 0:t.messageHandlers)||void 0===n?void 0:n.bridge)?"ios":"web"})(e)),c=(null===(n=null==u?void 0:u.currentPlatform)||void 0===n?void 0:n.isNativePlatform)||(()=>"web"!==d()),p=(null===(r=null==u?void 0:u.currentPlatform)||void 0===r?void 0:r.isPluginAvailable)||(e=>{const t=f.get(e);return!!(null==t?void 0:t.platforms.has(d()))||!!h(e)}),h=(null===(a=null==u?void 0:u.currentPlatform)||void 0===a?void 0:a.getPluginHeader)||(e=>{var t;return null===(t=o.PluginHeaders)||void 0===t?void 0:t.find((t=>t.name===e))}),f=new Map,m=(null===(i=null==u?void 0:u.currentPlatform)||void 0===i?void 0:i.registerPlugin)||((e,t={})=>{const n=f.get(e);if(n)return console.warn(`Capacitor plugin "${e}" already registered. Cannot register plugins twice.`),n.proxy;const r=d(),a=h(e);let i;const u=n=>{let l;const u=(...u)=>{const d=(async()=>(!i&&r in t?i=i="function"==typeof t[r]?await t[r]():t[r]:null!==s&&!i&&"web"in t&&(i=i="function"==typeof t.web?await t.web():t.web),i))().then((t=>{const i=((t,n)=>{var i,s;if(!a){if(t)return null===(s=t[n])||void 0===s?void 0:s.bind(t);throw new ype(`"${e}" plugin is not implemented on ${r}`,bpe.Unimplemented)}{const r=null==a?void 0:a.methods.find((e=>n===e.name));if(r)return"promise"===r.rtype?t=>o.nativePromise(e,n.toString(),t):(t,r)=>o.nativeCallback(e,n.toString(),t,r);if(t)return null===(i=t[n])||void 0===i?void 0:i.bind(t)}})(t,n);if(i){const e=i(...u);return l=null==e?void 0:e.remove,e}throw new ype(`"${e}.${n}()" is not implemented on ${r}`,bpe.Unimplemented)}));return"addListener"===n&&(d.remove=async()=>l()),d};return u.toString=()=>`${n.toString()}() { [capacitor code] }`,Object.defineProperty(u,"name",{value:n,writable:!1,configurable:!1}),u},c=u("addListener"),p=u("removeListener"),m=(e,t)=>{const n=c({eventName:e},t),r=async()=>{const r=await n;p({eventName:e,callbackId:r},t)},a=new Promise((e=>n.then((()=>e({remove:r})))));return a.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await r()},a},g=new Proxy({},{get(e,t){switch(t){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return a?m:c;case"removeListener":return p;default:return u(t)}}});return l[e]=g,f.set(e,{name:e,proxy:g,platforms:new Set([...Object.keys(t),...a?[r]:[]])}),g});return o.convertFileSrc||(o.convertFileSrc=e=>e),o.getPlatform=d,o.handleError=t=>e.console.error(t),o.isNativePlatform=c,o.isPluginAvailable=p,o.pluginMethodNoop=(e,t,n)=>Promise.reject(`${n} does not have an implementation of "${t}".`),o.registerPlugin=m,o.Exception=ype,o.DEBUG=!!o.DEBUG,o.isLoggingEnabled=!!o.isLoggingEnabled,o.platform=o.getPlatform(),o.isNative=o.isNativePlatform(),o},xpe=e=>e.Capacitor=vpe(e),wpe=xpe("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}),kpe=wpe.registerPlugin;wpe.Plugins;class Spe{constructor(e){this.listeners={},this.windowListeners={},e&&(console.warn(`Capacitor WebPlugin "${e.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=e)}addListener(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t);const n=this.windowListeners[e];n&&!n.registered&&this.addWindowListener(n);const r=async()=>this.removeListener(e,t),a=Promise.resolve({remove:r});return Object.defineProperty(a,"remove",{value:async()=>{console.warn("Using addListener() without 'await' is deprecated."),await r()}}),a}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t){const n=this.listeners[e];n&&n.forEach((e=>e(t)))}hasListeners(e){return!!this.listeners[e].length}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:e=>{this.notifyListeners(t,e)}}}unimplemented(e="not implemented"){return new wpe.Exception(e,bpe.Unimplemented)}unavailable(e="not available"){return new wpe.Exception(e,bpe.Unavailable)}async removeListener(e,t){const n=this.listeners[e];if(!n)return;const r=n.indexOf(t);this.listeners[e].splice(r,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}}const Ipe=e=>encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),Npe=e=>e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class Cpe extends Spe{async getCookies(){const e=document.cookie,t={};return e.split(";").forEach((e=>{if(e.length<=0)return;let[n,r]=e.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");n=Npe(n).trim(),r=Npe(r).trim(),t[n]=r})),t}async setCookie(e){try{const t=Ipe(e.key),n=Ipe(e.value),r=`; expires=${(e.expires||"").replace("expires=","")}`,a=(e.path||"/").replace("path=",""),i=null!=e.url&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${n||""}${r}; path=${a}; ${i};`}catch(t){return Promise.reject(t)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,`=;expires=${(new Date).toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}kpe("CapacitorCookies",{web:()=>new Cpe});const Tpe=(e,t={})=>{const n=Object.assign({method:e.method||"GET",headers:e.headers},t),r=((e={})=>{const t=Object.keys(e),n=Object.keys(e).map((e=>e.toLocaleLowerCase())),r=n.reduce(((n,r,a)=>(n[r]=e[t[a]],n)),{});return r})(e.headers),a=r["content-type"]||"";if("string"==typeof e.data)n.body=e.data;else if(a.includes("application/x-www-form-urlencoded")){const t=new URLSearchParams;for(const[n,r]of Object.entries(e.data||{}))t.set(n,r);n.body=t.toString()}else if(a.includes("multipart/form-data")){const t=new FormData;if(e.data instanceof FormData)e.data.forEach(((e,n)=>{t.append(n,e)}));else for(const n of Object.keys(e.data))t.append(n,e.data[n]);n.body=t;const r=new Headers(n.headers);r.delete("content-type"),n.headers=r}else(a.includes("application/json")||"object"==typeof e.data)&&(n.body=JSON.stringify(e.data));return n};class Epe extends Spe{async request(e){const t=Tpe(e,e.webFetchExtra),n=((e,t=!0)=>e?Object.entries(e).reduce(((e,n)=>{const[r,a]=n;let i,s;return Array.isArray(a)?(s="",a.forEach((e=>{i=t?encodeURIComponent(e):e,s+=`${r}=${i}&`})),s.slice(0,-1)):(i=t?encodeURIComponent(a):a,s=`${r}=${i}`),`${e}&${s}`}),"").substr(1):null)(e.params,e.shouldEncodeUrlParams),r=n?`${e.url}?${n}`:e.url,a=await fetch(r,t),i=a.headers.get("content-type")||"";let s,o,{responseType:l="text"}=a.ok?e:{};switch(i.includes("application/json")&&(l="json"),l){case"arraybuffer":case"blob":o=await a.blob(),s=await(async e=>new Promise(((t,n)=>{const r=new FileReader;r.onload=()=>{const e=r.result;t(e.indexOf(",")>=0?e.split(",")[1]:e)},r.onerror=e=>n(e),r.readAsDataURL(e)})))(o);break;case"json":s=await a.json();break;default:s=await a.text()}const u={};return a.headers.forEach(((e,t)=>{u[t]=e})),{data:s,headers:u,status:a.status,url:a.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}const _pe=kpe("CapacitorHttp",{web:()=>new Epe}),$pe=.3,Ape=e=>{const t=W.useRef(null),n=W.useRef(null);W.useRef(null);const r=W.useRef(!1),[a,i]=W.useState(!1),[s,o]=W.useState(null),[l,u]=W.useState(!1),[d,c]=W.useState(!1),[p,h]=W.useState(!1),[f,m]=W.useState(!1);W.useState(null);const[g,b]=W.useState(!1),[y,v]=W.useState([]);W.useState(!1);const[x,w]=W.useState(0),[k,S]=W.useState(""),[I,N]=W.useState(""),[C,T]=W.useState(""),[E,_]=W.useState(""),[$,A]=W.useState(""),[R,D]=W.useState(""),[F,M]=W.useState(""),[O,P]=W.useState(""),[L,z]=W.useState(""),[B,V]=W.useState(""),[U,j]=W.useState(""),[H,G]=W.useState(""),q=async()=>{try{const e=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1});t.current&&(t.current.srcObject=e),r.current=!0,m(!0)}catch(e){console.error("Error accessing webcam:",e)}},K=()=>{var e;const n=null===(e=t.current)||void 0===e?void 0:e.srcObject,a=null==n?void 0:n.getTracks();null==a||a.forEach((e=>e.stop())),t.current.srcObject=null,r.current=!1,m(!1)};W.useEffect((()=>{const e=async()=>Promise.all(["33333","11111","44444","22222"].map((async e=>{const t=[],n=`./labels/gym/${e}.jpg`,r=await gde(n),a=await function(e,t=new xce){return new ape(e,t)}(r).withFaceLandmarks().withFaceDescriptor();return t.push(a.descriptor),new Wue(e,t)}))),a=async()=>{const a=await e(),s=new ipe(a,$pe),l=t.current,u=n.current,d={width:l.width,height:l.height};!function(e,t,n=!1){let{width:r,height:a}=n?ode(t):t;e.width=r,e.height=a}(u,d);const c=setInterval((async()=>{if(r.current&&!l.paused&&!l.ended){const e=await function(e,t=new xce){return new rpe(e,t)}(l).withFaceLandmarks().withFaceDescriptors(),t=spe(e,d);u.getContext("2d").clearRect(0,0,u.width,u.height);const n=t.map((e=>s.findBestMatch(e.descriptor)));n.forEach((async(e,n)=>{t[n].detection.box;let r=e.toString();e.distance>$pe&&(r="Unknown");const a=u.getContext("2d");a.lineWidth=2,a.strokeStyle="red",a.fillStyle="red",a.font="20px Arial",e.distance>$pe&&(w((e=>e+1)),b(!0)),e.distance<=$pe&&(o(r.split(" ")[0]),i(!0))}))}}),1e3);return()=>clearInterval(c)};return Promise.all([zce.ssdMobilenetv1.loadFromUri("/models"),zce.faceRecognitionNet.loadFromUri("/models"),zce.faceLandmark68Net.loadFromUri("/models")]).then((()=>q().then(a))),()=>{r.current&&K()}}),[]),W.useEffect((()=>{let e;return g&&(e=setTimeout((()=>{b(!1)}),3e3)),()=>clearTimeout(e)}),[g]),W.useEffect((()=>{null==s&&localStorage.setItem("shownLabel","null"),localStorage.getItem("shownLabel")===s?u(!0):(u(!1),X(),K())}),[s]),W.useEffect((()=>{e.isbtnopen&&(K(),Z())}),[e.isbtnopen]);const X=()=>{s&&console.log(s),J(),c(!0)},J=async()=>{if(console.log(s),s){const e={url:"http://dev.wisevill.com/ur03/get_page_from_db.php",params:{id:s},data:{}},t=await _pe.post(e);v(JSON.parse(t.data));for(let n=0;n<JSON.parse(t.data).length;n++)console.log(JSON.parse(t.data)[n].id),console.log(JSON.parse(t.data)[n].name),console.log(JSON.parse(t.data)[n].mile),S(JSON.parse(t.data)[n].id),N(JSON.parse(t.data)[n].name),T(JSON.parse(t.data)[n].tel),_(JSON.parse(t.data)[n].profile_img),A(JSON.parse(t.data)[n].mile),D(JSON.parse(t.data)[n].comeinm),M(JSON.parse(t.data)[n].duetoproduct),P(JSON.parse(t.data)[n].haveproduct),z(JSON.parse(t.data)[n].indivlockerinfo),V(JSON.parse(t.data)[n].duetoclass),j(JSON.parse(t.data)[n].leftclasstime),G(JSON.parse(t.data)[n].inclass)}},Z=async()=>{let t="http://dev.wisevill.com/ur03/testget_page_from_db.php";if(e.id)if(e.typeid){if(e.typeid){const n={url:t,params:{tel:e.id},data:{}},r=await _pe.post(n);console.log(JSON.parse(r.data));for(let e=0;e<JSON.parse(r.data).length;e++)console.log(JSON.parse(r.data)[e].id),console.log(JSON.parse(r.data)[e].name),console.log(JSON.parse(r.data)[e].mile),N(JSON.parse(r.data)[e].name),T(JSON.parse(r.data)[e].tel),_(JSON.parse(r.data)[e].profile_img),A(JSON.parse(r.data)[e].mile),D(JSON.parse(r.data)[e].comeinm),M(JSON.parse(r.data)[e].duetoproduct),P(JSON.parse(r.data)[e].haveproduct),z(JSON.parse(r.data)[e].indivlockerinfo),V(JSON.parse(r.data)[e].duetoclass),j(JSON.parse(r.data)[e].leftclasstime),G(JSON.parse(r.data)[e].inclass)}}else{const n={url:t,params:{id:e.id},data:{}},r=await _pe.post(n);console.log(JSON.parse(r.data));for(let e=0;e<JSON.parse(r.data).length;e++)console.log(JSON.parse(r.data)[e].id),console.log(JSON.parse(r.data)[e].name),console.log(JSON.parse(r.data)[e].mile),N(JSON.parse(r.data)[e].name),T(JSON.parse(r.data)[e].tel),_(JSON.parse(r.data)[e].profile_img),A(JSON.parse(r.data)[e].mile),D(JSON.parse(r.data)[e].comeinm),M(JSON.parse(r.data)[e].duetoproduct),P(JSON.parse(r.data)[e].haveproduct),z(JSON.parse(r.data)[e].indivlockerinfo),V(JSON.parse(r.data)[e].duetoclass),j(JSON.parse(r.data)[e].leftclasstime),G(JSON.parse(r.data)[e].inclass)}h(!0)};return Y.jsxs(Y.Fragment,{children:[Y.jsx("video",{ref:t,id:"video",width:"720",height:"560",autoPlay:!0,muted:!0,style:{margin:"0 auto",position:"absolute"}}),Y.jsx("canvas",{ref:n,style:{margin:"0 auto",position:"absolute"}}),Y.jsx("div",{children:g&&Y.jsx("h1",{children:"얼굴 인식 실패. 회원번호나 휴대폰번호를 이용해주십시오."})}),Y.jsx(dw,{isOpen:a&&!l&&d,backdropDismiss:!1,children:Y.jsx(fpe,{detectedName:I,selfieURL:E,mid:k,tel:C,mile:$,come:R,product:F,have:O,locker:L,duclass:B,left:U,inclass:H,onClose:()=>{i(!1),u(!0),localStorage.setItem("shownLabel",null!=s?s:""),c(!1),q()}})}),Y.jsx(dw,{isOpen:e.isbtnopen&&p,children:Y.jsx(hpe,{handleClosebtnModal:()=>{e.setisbtnOpen(!1),h(!1),q()},id:e.id,idd:I,profile_img:E,mile:$,come:R,product:F,have:O,locker:L,duclass:B,left:U,inclass:H})})]})},Rpe=e=>Y.jsx(Y.Fragment,{children:Y.jsxs(Yx,{class:"btns",children:[Y.jsxs(Qx,{children:[Y.jsx(Kx,{class:"out_btn",children:Y.jsx(sw,{class:"out_btn",onClick:function(){0==e.typeid?5!=e.id.length?console.log("id를 다시 확인해주세요."):(console.log(e.id+"님 퇴장 하셨습니다."),e.setisoutOpen(!0)):13!=e.id.length?console.log("id를 다시 확인해주세요."):(console.log(e.id+"님 퇴장 하셨습니다."),e.setisoutOpen(!0))},children:"퇴소하기"})}),Y.jsx(Kx,{class:"call_btn",children:Y.jsx(sw,{class:"call_btn",onClick:function(){console.log("직원 호출 중입니다.")},trigger:e.trigger,children:"직원호출"})})]}),Y.jsx(Qx,{children:Y.jsx(Kx,{class:"in_btn",children:Y.jsx(sw,{class:"in_btn",onClick:function(){0==e.typeid?5!=e.id.length?console.log("id를 다시 확인해주세요."):(console.log(e.id+"님 입장 하셨습니다."),e.setisbtnOpen(!0)):13!=e.id.length?console.log("id를 다시 확인해주세요."):(console.log(e.id+"님 입장 하셨습니다."),e.setisbtnOpen(!0))},trigger:e.trigger,children:"출석하기"})})})]})});function Dpe(){W.useRef(),W.useRef();const[e,t]=W.useState(window.innerWidth);W.useState(window.innerHeight);const n=()=>{t(window.innerWidth)};W.useEffect((()=>(window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n)})),[]),W.useState(!1);const[r,a]=W.useState(!1);W.useState(!1);const[i,s]=W.useState(!1),[o,l]=W.useState("123"),[u,d]=W.useState(!1),[c,p]=W.useState("pw"),[h,f]=W.useState(!1);return W.useState([]),Y.jsx(Y.Fragment,{children:Y.jsxs(Xx,{children:[Y.jsx("div",{className:"background-image-init"}),Y.jsx("div",{className:"background-image-img"}),Y.jsx("div",{className:"background-image-gradient"}),Y.jsx("div",{className:"content",children:Y.jsxs(Yx,{class:"window",children:[Y.jsx(Qx,{class:"title",children:Y.jsx(Kx,{children:Y.jsx(dpe,{})})}),window.innerWidth<=window.innerHeight?Y.jsx(Qx,{class:"announcement",children:Y.jsx(Kx,{class:"announcement",children:Y.jsx(ppe,{})})}):Y.jsx("div",{}),Y.jsxs(Qx,{class:"bottom_side",children:[Y.jsx(Kx,{size:"8",class:"main_input_box",children:Y.jsx("div",{className:"main_input_box",children:Y.jsx(cpe,{AlertFunc:l,settypeid:d})})}),Y.jsx(Kx,{size:"4",class:"btn_and_face",children:Y.jsxs(Yx,{class:"btn_and_face",children:[Y.jsx(Qx,{children:Y.jsx(Kx,{class:"face",children:Y.jsx(Ape,{isbtnopen:r,setisbtnOpen:a,id:o,typeid:u})})}),Y.jsx(Qx,{children:Y.jsx(Kx,{class:"btn",children:Y.jsx(Rpe,{id:o,pw:c,face:h,setisbtnOpen:a,setisoutOpen:s,typeid:u})})})]})})]})]})})]})})}Pw();const Fpe=()=>Y.jsx(yw,{children:Y.jsx(Yw,{children:Y.jsxs(Tw,{children:[Y.jsxs(bh,{exact:!0,path:"/home",children:[Y.jsx(Sw,{root:()=>Y.jsx(lpe,{})}),";"]}),Y.jsx(bh,{exact:!0,path:"/Main",children:Y.jsx(Dpe,{})}),Y.jsx(bh,{exact:!0,path:"/",children:Y.jsx(ph,{to:"/Main"})}),Y.jsx(bh,{exact:!0,path:"/logo",children:Y.jsx(dpe,{})}),Y.jsx(bh,{exact:!0,path:"/announcement",children:Y.jsx(ppe,{})}),Y.jsx(bh,{exact:!0,path:"/numpad",children:Y.jsx(cpe,{})})]})})});sc(document.getElementById("root")).render(Y.jsx(V.StrictMode,{children:Y.jsx(Fpe,{})}))}}}));
